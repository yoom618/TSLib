Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1906685829162598
Epoch: 1, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.8073046207427979
Epoch: 2, Steps: 2 | Train Loss: 0.638 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8175668716430664
Epoch: 3, Steps: 2 | Train Loss: 0.744 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8299551010131836
Epoch: 4, Steps: 2 | Train Loss: 0.194 Vali Loss: 2.162 Vali Acc: 0.200 Test Loss: 2.162 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8044140338897705
Epoch: 5, Steps: 2 | Train Loss: 0.015 Vali Loss: 2.957 Vali Acc: 0.467 Test Loss: 2.957 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8688373565673828
Epoch: 6, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.406 Vali Acc: 0.400 Test Loss: 5.406 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8233926296234131
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.104 Vali Acc: 0.400 Test Loss: 8.104 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8078575134277344
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.633 Vali Acc: 0.400 Test Loss: 10.633 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8324923515319824
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.871 Vali Acc: 0.400 Test Loss: 12.871 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8231260776519775
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 14.847 Vali Acc: 0.400 Test Loss: 14.847 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8230628967285156
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 16.561 Vali Acc: 0.400 Test Loss: 16.561 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8143067359924316
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 18.048 Vali Acc: 0.400 Test Loss: 18.048 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 9107523
model size : 44.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.216139554977417
Epoch: 1, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8886864185333252
Epoch: 2, Steps: 2 | Train Loss: 0.698 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8170533180236816
Epoch: 3, Steps: 2 | Train Loss: 0.781 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7930681705474854
Epoch: 4, Steps: 2 | Train Loss: 0.190 Vali Loss: 2.546 Vali Acc: 0.267 Test Loss: 2.546 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7562730312347412
Epoch: 5, Steps: 2 | Train Loss: 0.127 Vali Loss: 2.418 Vali Acc: 0.400 Test Loss: 2.418 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7993905544281006
Epoch: 6, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.452 Vali Acc: 0.333 Test Loss: 6.452 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8088908195495605
Epoch: 7, Steps: 2 | Train Loss: 0.154 Vali Loss: 8.395 Vali Acc: 0.333 Test Loss: 8.395 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8388357162475586
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.238 Vali Acc: 0.267 Test Loss: 7.238 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8354778289794922
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.683 Vali Acc: 0.200 Test Loss: 6.683 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7813544273376465
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.297 Vali Acc: 0.200 Test Loss: 7.297 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8231010437011719
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.238 Vali Acc: 0.133 Test Loss: 8.238 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 9107523
model size : 44.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1381850242614746
Epoch: 1, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7845337390899658
Epoch: 2, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7628006935119629
Epoch: 3, Steps: 2 | Train Loss: 0.813 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7863152027130127
Epoch: 4, Steps: 2 | Train Loss: 0.393 Vali Loss: 1.742 Vali Acc: 0.400 Test Loss: 1.742 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8110692501068115
Epoch: 5, Steps: 2 | Train Loss: 0.103 Vali Loss: 3.868 Vali Acc: 0.267 Test Loss: 3.868 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7590987682342529
Epoch: 6, Steps: 2 | Train Loss: 0.035 Vali Loss: 4.318 Vali Acc: 0.200 Test Loss: 4.318 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8057634830474854
Epoch: 7, Steps: 2 | Train Loss: 0.001 Vali Loss: 7.308 Vali Acc: 0.267 Test Loss: 7.308 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7807159423828125
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.184 Vali Acc: 0.200 Test Loss: 9.184 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7593123912811279
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.748 Vali Acc: 0.200 Test Loss: 10.748 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7690143585205078
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.045 Vali Acc: 0.200 Test Loss: 12.045 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.795896053314209
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.206 Vali Acc: 0.267 Test Loss: 13.206 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 9107523
model size : 44.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.000903606414795
Epoch: 1, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7317750453948975
Epoch: 2, Steps: 2 | Train Loss: 0.817 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.7513091564178467
Epoch: 3, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7476372718811035
Epoch: 4, Steps: 2 | Train Loss: 0.527 Vali Loss: 2.610 Vali Acc: 0.267 Test Loss: 2.610 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7109932899475098
Epoch: 5, Steps: 2 | Train Loss: 0.336 Vali Loss: 2.422 Vali Acc: 0.200 Test Loss: 2.422 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7621386051177979
Epoch: 6, Steps: 2 | Train Loss: 0.018 Vali Loss: 5.595 Vali Acc: 0.467 Test Loss: 5.595 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7707607746124268
Epoch: 7, Steps: 2 | Train Loss: 1.734 Vali Loss: 8.090 Vali Acc: 0.400 Test Loss: 8.090 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6989586353302002
Epoch: 8, Steps: 2 | Train Loss: 0.394 Vali Loss: 4.926 Vali Acc: 0.333 Test Loss: 4.926 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7173736095428467
Epoch: 9, Steps: 2 | Train Loss: 0.002 Vali Loss: 8.770 Vali Acc: 0.333 Test Loss: 8.770 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7594122886657715
Epoch: 10, Steps: 2 | Train Loss: 0.173 Vali Loss: 8.717 Vali Acc: 0.333 Test Loss: 8.717 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7616910934448242
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.069 Vali Acc: 0.133 Test Loss: 8.069 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8129417896270752
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.556 Vali Acc: 0.200 Test Loss: 8.556 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 9107523
model size : 44.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9931762218475342
Epoch: 1, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7680821418762207
Epoch: 2, Steps: 2 | Train Loss: 0.843 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7633028030395508
Epoch: 3, Steps: 2 | Train Loss: 0.561 Vali Loss: 1.869 Vali Acc: 0.467 Test Loss: 1.869 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466648).  Saving model ...
Epoch: 4 cost time: 0.8049001693725586
Epoch: 4, Steps: 2 | Train Loss: 0.328 Vali Loss: 2.069 Vali Acc: 0.400 Test Loss: 2.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7812061309814453
Epoch: 5, Steps: 2 | Train Loss: 0.008 Vali Loss: 3.044 Vali Acc: 0.400 Test Loss: 3.044 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8147232532501221
Epoch: 6, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.444 Vali Acc: 0.267 Test Loss: 4.444 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8220717906951904
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.072 Vali Acc: 0.067 Test Loss: 6.072 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7813000679016113
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.720 Vali Acc: 0.133 Test Loss: 7.720 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7615401744842529
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.256 Vali Acc: 0.133 Test Loss: 9.256 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8197896480560303
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.628 Vali Acc: 0.133 Test Loss: 10.628 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.818368673324585
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.856 Vali Acc: 0.133 Test Loss: 11.856 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7865831851959229
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.943 Vali Acc: 0.133 Test Loss: 12.943 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8075511455535889
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.872 Vali Acc: 0.133 Test Loss: 13.872 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 7010371
model size : 36.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1251847743988037
Epoch: 1, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7508881092071533
Epoch: 2, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7560193538665771
Epoch: 3, Steps: 2 | Train Loss: 0.621 Vali Loss: 2.118 Vali Acc: 0.467 Test Loss: 2.118 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7172935009002686
Epoch: 4, Steps: 2 | Train Loss: 0.474 Vali Loss: 2.560 Vali Acc: 0.467 Test Loss: 2.560 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7459111213684082
Epoch: 5, Steps: 2 | Train Loss: 0.024 Vali Loss: 2.577 Vali Acc: 0.267 Test Loss: 2.577 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7638463973999023
Epoch: 6, Steps: 2 | Train Loss: 0.011 Vali Loss: 4.443 Vali Acc: 0.133 Test Loss: 4.443 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7164990901947021
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.484 Vali Acc: 0.267 Test Loss: 7.484 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7332205772399902
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.452 Vali Acc: 0.333 Test Loss: 11.452 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7806482315063477
Epoch: 9, Steps: 2 | Train Loss: 0.003 Vali Loss: 11.761 Vali Acc: 0.267 Test Loss: 11.761 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6966891288757324
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.200 Vali Acc: 0.200 Test Loss: 10.200 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7337965965270996
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.493 Vali Acc: 0.267 Test Loss: 9.493 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.736997127532959
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.844 Vali Acc: 0.267 Test Loss: 9.844 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 7010371
model size : 36.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9013111591339111
Epoch: 1, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6741671562194824
Epoch: 2, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7619960308074951
Epoch: 3, Steps: 2 | Train Loss: 0.652 Vali Loss: 1.847 Vali Acc: 0.533 Test Loss: 1.847 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533315).  Saving model ...
Epoch: 4 cost time: 0.7221660614013672
Epoch: 4, Steps: 2 | Train Loss: 0.436 Vali Loss: 1.888 Vali Acc: 0.333 Test Loss: 1.888 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7556610107421875
Epoch: 5, Steps: 2 | Train Loss: 0.021 Vali Loss: 2.980 Vali Acc: 0.200 Test Loss: 2.980 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7369081974029541
Epoch: 6, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.120 Vali Acc: 0.267 Test Loss: 3.120 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7612988948822021
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.462 Vali Acc: 0.333 Test Loss: 4.462 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7640769481658936
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.090 Vali Acc: 0.333 Test Loss: 6.090 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7649955749511719
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.644 Vali Acc: 0.400 Test Loss: 7.644 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7329771518707275
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.079 Vali Acc: 0.400 Test Loss: 9.079 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7863740921020508
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.368 Vali Acc: 0.400 Test Loss: 10.368 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.786780595779419
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.518 Vali Acc: 0.467 Test Loss: 11.518 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7970459461212158
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.504 Vali Acc: 0.467 Test Loss: 12.504 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7010371
model size : 36.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8949644565582275
Epoch: 1, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.676048755645752
Epoch: 2, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7050759792327881
Epoch: 3, Steps: 2 | Train Loss: 0.746 Vali Loss: 1.721 Vali Acc: 0.400 Test Loss: 1.721 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399983).  Saving model ...
Epoch: 4 cost time: 0.7030837535858154
Epoch: 4, Steps: 2 | Train Loss: 0.539 Vali Loss: 1.831 Vali Acc: 0.400 Test Loss: 1.831 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6926145553588867
Epoch: 5, Steps: 2 | Train Loss: 0.146 Vali Loss: 2.215 Vali Acc: 0.133 Test Loss: 2.215 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6534216403961182
Epoch: 6, Steps: 2 | Train Loss: 0.006 Vali Loss: 5.597 Vali Acc: 0.267 Test Loss: 5.597 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6739766597747803
Epoch: 7, Steps: 2 | Train Loss: 0.126 Vali Loss: 5.397 Vali Acc: 0.267 Test Loss: 5.397 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.684248685836792
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 5.022 Vali Acc: 0.133 Test Loss: 5.022 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.736569881439209
Epoch: 9, Steps: 2 | Train Loss: 0.008 Vali Loss: 6.996 Vali Acc: 0.333 Test Loss: 6.996 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6744639873504639
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.152 Vali Acc: 0.267 Test Loss: 10.152 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6762611865997314
Epoch: 11, Steps: 2 | Train Loss: 0.074 Vali Loss: 10.704 Vali Acc: 0.333 Test Loss: 10.704 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7130131721496582
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.481 Vali Acc: 0.267 Test Loss: 9.481 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6393263339996338
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.047 Vali Acc: 0.333 Test Loss: 9.047 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 7010371
model size : 36.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1945834159851074
Epoch: 1, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7848334312438965
Epoch: 2, Steps: 2 | Train Loss: 0.807 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7693502902984619
Epoch: 3, Steps: 2 | Train Loss: 0.630 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8039591312408447
Epoch: 4, Steps: 2 | Train Loss: 0.118 Vali Loss: 1.771 Vali Acc: 0.333 Test Loss: 1.771 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.796919584274292
Epoch: 5, Steps: 2 | Train Loss: 0.005 Vali Loss: 5.267 Vali Acc: 0.200 Test Loss: 5.267 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8225417137145996
Epoch: 6, Steps: 2 | Train Loss: 0.011 Vali Loss: 5.471 Vali Acc: 0.200 Test Loss: 5.471 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.77364182472229
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.796 Vali Acc: 0.200 Test Loss: 5.796 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.786060094833374
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.360 Vali Acc: 0.267 Test Loss: 6.360 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.828089714050293
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.102 Vali Acc: 0.200 Test Loss: 7.102 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8137476444244385
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.838 Vali Acc: 0.200 Test Loss: 7.838 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8241777420043945
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.555 Vali Acc: 0.200 Test Loss: 8.555 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8215696811676025
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.217 Vali Acc: 0.267 Test Loss: 9.217 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5961795
model size : 32.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1614186763763428
Epoch: 1, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7979896068572998
Epoch: 2, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7823903560638428
Epoch: 3, Steps: 2 | Train Loss: 0.679 Vali Loss: 1.250 Vali Acc: 0.467 Test Loss: 1.250 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7811119556427002
Epoch: 4, Steps: 2 | Train Loss: 0.149 Vali Loss: 2.054 Vali Acc: 0.267 Test Loss: 2.054 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8403909206390381
Epoch: 5, Steps: 2 | Train Loss: 0.021 Vali Loss: 2.535 Vali Acc: 0.333 Test Loss: 2.535 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8375945091247559
Epoch: 6, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.652 Vali Acc: 0.400 Test Loss: 3.652 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7575125694274902
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.740 Vali Acc: 0.467 Test Loss: 4.740 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7897226810455322
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.797 Vali Acc: 0.533 Test Loss: 5.797 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533275).  Saving model ...
Epoch: 9 cost time: 0.766711950302124
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.778 Vali Acc: 0.533 Test Loss: 6.778 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7857153415679932
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.677 Vali Acc: 0.533 Test Loss: 7.677 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7859172821044922
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.478 Vali Acc: 0.533 Test Loss: 8.478 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7820377349853516
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.187 Vali Acc: 0.533 Test Loss: 9.187 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7824783325195312
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.803 Vali Acc: 0.533 Test Loss: 9.803 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7917351722717285
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.341 Vali Acc: 0.533 Test Loss: 10.341 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7580118179321289
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.805 Vali Acc: 0.533 Test Loss: 10.805 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7577149868011475
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.225 Vali Acc: 0.533 Test Loss: 11.225 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7741043567657471
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.564 Vali Acc: 0.533 Test Loss: 11.564 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8038241863250732
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.857 Vali Acc: 0.533 Test Loss: 11.857 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5961795
model size : 32.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8805248737335205
Epoch: 1, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7377960681915283
Epoch: 2, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7279956340789795
Epoch: 3, Steps: 2 | Train Loss: 0.731 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.7347369194030762
Epoch: 4, Steps: 2 | Train Loss: 0.199 Vali Loss: 3.635 Vali Acc: 0.333 Test Loss: 3.635 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.758589506149292
Epoch: 5, Steps: 2 | Train Loss: 0.458 Vali Loss: 2.959 Vali Acc: 0.200 Test Loss: 2.959 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6966795921325684
Epoch: 6, Steps: 2 | Train Loss: 0.026 Vali Loss: 4.263 Vali Acc: 0.267 Test Loss: 4.263 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7352540493011475
Epoch: 7, Steps: 2 | Train Loss: 0.014 Vali Loss: 5.192 Vali Acc: 0.333 Test Loss: 5.192 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6880698204040527
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.708 Vali Acc: 0.267 Test Loss: 7.708 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6979124546051025
Epoch: 9, Steps: 2 | Train Loss: 0.007 Vali Loss: 8.325 Vali Acc: 0.267 Test Loss: 8.325 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7229700088500977
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.657 Vali Acc: 0.267 Test Loss: 7.657 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6863746643066406
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.110 Vali Acc: 0.200 Test Loss: 8.110 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7169764041900635
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.816 Vali Acc: 0.267 Test Loss: 9.816 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6751997470855713
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.106 Vali Acc: 0.267 Test Loss: 12.106 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5961795
model size : 32.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9696168899536133
Epoch: 1, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6970946788787842
Epoch: 2, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6305475234985352
Epoch: 3, Steps: 2 | Train Loss: 0.810 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6955692768096924
Epoch: 4, Steps: 2 | Train Loss: 0.259 Vali Loss: 3.666 Vali Acc: 0.333 Test Loss: 3.666 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7127642631530762
Epoch: 5, Steps: 2 | Train Loss: 0.608 Vali Loss: 2.506 Vali Acc: 0.200 Test Loss: 2.506 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.63081955909729
Epoch: 6, Steps: 2 | Train Loss: 0.283 Vali Loss: 4.044 Vali Acc: 0.267 Test Loss: 4.044 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7269864082336426
Epoch: 7, Steps: 2 | Train Loss: 0.370 Vali Loss: 3.723 Vali Acc: 0.267 Test Loss: 3.723 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7174234390258789
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 5.654 Vali Acc: 0.267 Test Loss: 5.654 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6667726039886475
Epoch: 9, Steps: 2 | Train Loss: 0.089 Vali Loss: 6.493 Vali Acc: 0.200 Test Loss: 6.493 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.645918607711792
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.967 Vali Acc: 0.133 Test Loss: 6.967 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6900389194488525
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.200 Vali Acc: 0.333 Test Loss: 10.200 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7248044013977051
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 6.147 Vali Acc: 0.067 Test Loss: 6.147 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5961795
model size : 32.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9672958850860596
Epoch: 1, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7420971393585205
Epoch: 2, Steps: 2 | Train Loss: 0.692 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.7564208507537842
Epoch: 3, Steps: 2 | Train Loss: 0.586 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7710635662078857
Epoch: 4, Steps: 2 | Train Loss: 0.146 Vali Loss: 2.313 Vali Acc: 0.400 Test Loss: 2.313 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7201347351074219
Epoch: 5, Steps: 2 | Train Loss: 0.012 Vali Loss: 2.687 Vali Acc: 0.333 Test Loss: 2.687 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7692487239837646
Epoch: 6, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.979 Vali Acc: 0.467 Test Loss: 3.979 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7545092105865479
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.036 Vali Acc: 0.467 Test Loss: 5.036 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7640845775604248
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.044 Vali Acc: 0.400 Test Loss: 6.044 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8153221607208252
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.965 Vali Acc: 0.400 Test Loss: 6.965 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7857460975646973
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.793 Vali Acc: 0.400 Test Loss: 7.793 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7234280109405518
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.537 Vali Acc: 0.467 Test Loss: 8.537 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.779998779296875
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.173 Vali Acc: 0.467 Test Loss: 9.173 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5437507
model size : 30.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.041506290435791
Epoch: 1, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7166564464569092
Epoch: 2, Steps: 2 | Train Loss: 0.785 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.7098324298858643
Epoch: 3, Steps: 2 | Train Loss: 0.631 Vali Loss: 1.234 Vali Acc: 0.133 Test Loss: 1.234 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7768356800079346
Epoch: 4, Steps: 2 | Train Loss: 0.185 Vali Loss: 2.012 Vali Acc: 0.400 Test Loss: 2.012 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7605574131011963
Epoch: 5, Steps: 2 | Train Loss: 0.028 Vali Loss: 2.477 Vali Acc: 0.400 Test Loss: 2.477 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7341883182525635
Epoch: 6, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.320 Vali Acc: 0.400 Test Loss: 4.320 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7833688259124756
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.133 Vali Acc: 0.400 Test Loss: 6.133 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7735857963562012
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.893 Vali Acc: 0.467 Test Loss: 7.893 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7659032344818115
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.496 Vali Acc: 0.467 Test Loss: 9.496 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7697856426239014
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.948 Vali Acc: 0.467 Test Loss: 10.948 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.747459888458252
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.241 Vali Acc: 0.467 Test Loss: 12.241 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7351949214935303
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.367 Vali Acc: 0.400 Test Loss: 13.367 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5437507
model size : 30.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9545772075653076
Epoch: 1, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7106289863586426
Epoch: 2, Steps: 2 | Train Loss: 0.879 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6744668483734131
Epoch: 3, Steps: 2 | Train Loss: 0.704 Vali Loss: 1.306 Vali Acc: 0.200 Test Loss: 1.306 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6823599338531494
Epoch: 4, Steps: 2 | Train Loss: 0.222 Vali Loss: 2.593 Vali Acc: 0.333 Test Loss: 2.593 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.687800407409668
Epoch: 5, Steps: 2 | Train Loss: 0.196 Vali Loss: 2.492 Vali Acc: 0.467 Test Loss: 2.492 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466642).  Saving model ...
Epoch: 6 cost time: 0.7515466213226318
Epoch: 6, Steps: 2 | Train Loss: 0.020 Vali Loss: 3.423 Vali Acc: 0.400 Test Loss: 3.423 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7079014778137207
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.883 Vali Acc: 0.333 Test Loss: 4.883 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6873481273651123
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.978 Vali Acc: 0.200 Test Loss: 6.978 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7299351692199707
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.101 Vali Acc: 0.200 Test Loss: 9.101 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.742257833480835
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.968 Vali Acc: 0.200 Test Loss: 10.968 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7735302448272705
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.441 Vali Acc: 0.200 Test Loss: 12.441 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7721171379089355
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.687 Vali Acc: 0.200 Test Loss: 13.687 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7249877452850342
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 14.662 Vali Acc: 0.200 Test Loss: 14.662 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.666987419128418
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 15.476 Vali Acc: 0.200 Test Loss: 15.476 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6917524337768555
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 16.190 Vali Acc: 0.200 Test Loss: 16.190 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5437507
model size : 30.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.085745096206665
Epoch: 1, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6521303653717041
Epoch: 2, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7136251926422119
Epoch: 3, Steps: 2 | Train Loss: 0.807 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.66143798828125
Epoch: 4, Steps: 2 | Train Loss: 0.249 Vali Loss: 3.354 Vali Acc: 0.333 Test Loss: 3.354 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6947803497314453
Epoch: 5, Steps: 2 | Train Loss: 0.766 Vali Loss: 2.705 Vali Acc: 0.200 Test Loss: 2.705 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7031004428863525
Epoch: 6, Steps: 2 | Train Loss: 0.241 Vali Loss: 4.224 Vali Acc: 0.267 Test Loss: 4.224 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7107183933258057
Epoch: 7, Steps: 2 | Train Loss: 0.196 Vali Loss: 4.278 Vali Acc: 0.200 Test Loss: 4.278 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6669106483459473
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.885 Vali Acc: 0.267 Test Loss: 9.885 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6576294898986816
Epoch: 9, Steps: 2 | Train Loss: 0.176 Vali Loss: 9.604 Vali Acc: 0.267 Test Loss: 9.604 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6970419883728027
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.410 Vali Acc: 0.267 Test Loss: 8.410 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6794061660766602
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.896 Vali Acc: 0.200 Test Loss: 7.896 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7090375423431396
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.596 Vali Acc: 0.267 Test Loss: 8.596 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 5437507
model size : 30.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0430798530578613
Epoch: 1, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.794013500213623
Epoch: 2, Steps: 2 | Train Loss: 0.655 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7214176654815674
Epoch: 3, Steps: 2 | Train Loss: 0.547 Vali Loss: 1.519 Vali Acc: 0.333 Test Loss: 1.519 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8028604984283447
Epoch: 4, Steps: 2 | Train Loss: 0.214 Vali Loss: 1.883 Vali Acc: 0.200 Test Loss: 1.883 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7954766750335693
Epoch: 5, Steps: 2 | Train Loss: 0.007 Vali Loss: 3.950 Vali Acc: 0.400 Test Loss: 3.950 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7907929420471191
Epoch: 6, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.325 Vali Acc: 0.333 Test Loss: 6.325 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7852208614349365
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.279 Vali Acc: 0.333 Test Loss: 8.279 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7721269130706787
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.001 Vali Acc: 0.333 Test Loss: 10.001 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7395009994506836
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.551 Vali Acc: 0.333 Test Loss: 11.551 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.774024486541748
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.923 Vali Acc: 0.333 Test Loss: 12.923 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7518296241760254
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 14.143 Vali Acc: 0.333 Test Loss: 14.143 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5175363
model size : 29.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.00032901763916
Epoch: 1, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7671153545379639
Epoch: 2, Steps: 2 | Train Loss: 0.669 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7502484321594238
Epoch: 3, Steps: 2 | Train Loss: 0.605 Vali Loss: 1.609 Vali Acc: 0.333 Test Loss: 1.609 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7631845474243164
Epoch: 4, Steps: 2 | Train Loss: 0.249 Vali Loss: 1.823 Vali Acc: 0.267 Test Loss: 1.823 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7558629512786865
Epoch: 5, Steps: 2 | Train Loss: 0.022 Vali Loss: 3.723 Vali Acc: 0.400 Test Loss: 3.723 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399963).  Saving model ...
Epoch: 6 cost time: 0.7539172172546387
Epoch: 6, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.587 Vali Acc: 0.333 Test Loss: 4.587 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7090990543365479
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.735 Vali Acc: 0.200 Test Loss: 5.735 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7189638614654541
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.912 Vali Acc: 0.200 Test Loss: 6.912 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7441020011901855
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.009 Vali Acc: 0.200 Test Loss: 8.009 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7678284645080566
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.001 Vali Acc: 0.200 Test Loss: 9.001 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7917947769165039
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.878 Vali Acc: 0.200 Test Loss: 9.878 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7672519683837891
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.655 Vali Acc: 0.200 Test Loss: 10.655 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7454054355621338
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.325 Vali Acc: 0.200 Test Loss: 11.325 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7184498310089111
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.913 Vali Acc: 0.200 Test Loss: 11.913 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8308143615722656
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.427 Vali Acc: 0.200 Test Loss: 12.427 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5175363
model size : 29.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9690892696380615
Epoch: 1, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.686598539352417
Epoch: 2, Steps: 2 | Train Loss: 0.716 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7687451839447021
Epoch: 3, Steps: 2 | Train Loss: 0.641 Vali Loss: 1.511 Vali Acc: 0.333 Test Loss: 1.511 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6898279190063477
Epoch: 4, Steps: 2 | Train Loss: 0.293 Vali Loss: 1.655 Vali Acc: 0.333 Test Loss: 1.655 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7253983020782471
Epoch: 5, Steps: 2 | Train Loss: 0.099 Vali Loss: 3.321 Vali Acc: 0.467 Test Loss: 3.321 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466633).  Saving model ...
Epoch: 6 cost time: 0.7199337482452393
Epoch: 6, Steps: 2 | Train Loss: 0.006 Vali Loss: 5.137 Vali Acc: 0.200 Test Loss: 5.137 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7351269721984863
Epoch: 7, Steps: 2 | Train Loss: 0.014 Vali Loss: 6.635 Vali Acc: 0.200 Test Loss: 6.635 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.71274733543396
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.950 Vali Acc: 0.133 Test Loss: 6.950 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.731520414352417
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.099 Vali Acc: 0.267 Test Loss: 8.099 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7385909557342529
Epoch: 10, Steps: 2 | Train Loss: 0.004 Vali Loss: 8.183 Vali Acc: 0.133 Test Loss: 8.183 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6973221302032471
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.363 Vali Acc: 0.200 Test Loss: 11.363 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7270870208740234
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 15.307 Vali Acc: 0.200 Test Loss: 15.307 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7318968772888184
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 18.250 Vali Acc: 0.200 Test Loss: 18.250 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7571272850036621
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 18.203 Vali Acc: 0.200 Test Loss: 18.203 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7719860076904297
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 18.164 Vali Acc: 0.200 Test Loss: 18.164 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5175363
model size : 29.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9986324310302734
Epoch: 1, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6708629131317139
Epoch: 2, Steps: 2 | Train Loss: 0.864 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6544713973999023
Epoch: 3, Steps: 2 | Train Loss: 0.761 Vali Loss: 1.546 Vali Acc: 0.400 Test Loss: 1.546 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7454636096954346
Epoch: 4, Steps: 2 | Train Loss: 0.401 Vali Loss: 1.608 Vali Acc: 0.333 Test Loss: 1.608 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6691548824310303
Epoch: 5, Steps: 2 | Train Loss: 0.836 Vali Loss: 3.481 Vali Acc: 0.267 Test Loss: 3.481 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6907756328582764
Epoch: 6, Steps: 2 | Train Loss: 0.228 Vali Loss: 4.263 Vali Acc: 0.200 Test Loss: 4.263 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6838977336883545
Epoch: 7, Steps: 2 | Train Loss: 0.160 Vali Loss: 5.982 Vali Acc: 0.333 Test Loss: 5.982 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6395711898803711
Epoch: 8, Steps: 2 | Train Loss: 0.045 Vali Loss: 5.596 Vali Acc: 0.200 Test Loss: 5.596 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6643311977386475
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.396 Vali Acc: 0.200 Test Loss: 7.396 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6305496692657471
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.837 Vali Acc: 0.333 Test Loss: 8.837 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6885552406311035
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 9.108 Vali Acc: 0.333 Test Loss: 9.108 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5175363
model size : 29.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1385338306427
Epoch: 1, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8074948787689209
Epoch: 2, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7973325252532959
Epoch: 3, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.833 Vali Acc: 0.333 Test Loss: 1.833 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8112235069274902
Epoch: 4, Steps: 2 | Train Loss: 0.155 Vali Loss: 2.513 Vali Acc: 0.200 Test Loss: 2.513 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8314993381500244
Epoch: 5, Steps: 2 | Train Loss: 0.433 Vali Loss: 5.037 Vali Acc: 0.267 Test Loss: 5.037 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8129599094390869
Epoch: 6, Steps: 2 | Train Loss: 0.119 Vali Loss: 4.175 Vali Acc: 0.400 Test Loss: 4.175 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8189375400543213
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.971 Vali Acc: 0.333 Test Loss: 5.971 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7780382633209229
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.433 Vali Acc: 0.333 Test Loss: 9.433 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7800273895263672
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.818 Vali Acc: 0.333 Test Loss: 12.818 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8166587352752686
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 15.374 Vali Acc: 0.333 Test Loss: 15.374 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7798182964324951
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 17.621 Vali Acc: 0.333 Test Loss: 17.621 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.783581018447876
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 19.596 Vali Acc: 0.333 Test Loss: 19.596 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5044291
model size : 29.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0391035079956055
Epoch: 1, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7236342430114746
Epoch: 2, Steps: 2 | Train Loss: 0.835 Vali Loss: 1.047 Vali Acc: 0.267 Test Loss: 1.047 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7296833992004395
Epoch: 3, Steps: 2 | Train Loss: 0.617 Vali Loss: 1.856 Vali Acc: 0.333 Test Loss: 1.856 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7430148124694824
Epoch: 4, Steps: 2 | Train Loss: 0.280 Vali Loss: 2.482 Vali Acc: 0.333 Test Loss: 2.482 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7157342433929443
Epoch: 5, Steps: 2 | Train Loss: 0.753 Vali Loss: 4.236 Vali Acc: 0.267 Test Loss: 4.236 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7765030860900879
Epoch: 6, Steps: 2 | Train Loss: 0.276 Vali Loss: 3.116 Vali Acc: 0.333 Test Loss: 3.116 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7337071895599365
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.950 Vali Acc: 0.400 Test Loss: 4.950 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399951).  Saving model ...
Epoch: 8 cost time: 0.7748780250549316
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.904 Vali Acc: 0.400 Test Loss: 7.904 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7428069114685059
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.778 Vali Acc: 0.400 Test Loss: 10.778 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.771247148513794
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.425 Vali Acc: 0.467 Test Loss: 13.425 Test Acc: 0.467
Validation loss decreased (-0.399951 --> -0.466532).  Saving model ...
Epoch: 11 cost time: 0.7593836784362793
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 15.771 Vali Acc: 0.467 Test Loss: 15.771 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7678737640380859
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 17.599 Vali Acc: 0.467 Test Loss: 17.599 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7652854919433594
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 18.694 Vali Acc: 0.467 Test Loss: 18.694 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.757688045501709
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 19.368 Vali Acc: 0.467 Test Loss: 19.368 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8278863430023193
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 19.895 Vali Acc: 0.467 Test Loss: 19.895 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7421634197235107
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 20.337 Vali Acc: 0.400 Test Loss: 20.337 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7763381004333496
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 20.724 Vali Acc: 0.400 Test Loss: 20.724 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7123730182647705
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 21.057 Vali Acc: 0.400 Test Loss: 21.057 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7595169544219971
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 21.340 Vali Acc: 0.400 Test Loss: 21.340 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7076308727264404
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 21.576 Vali Acc: 0.400 Test Loss: 21.576 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5044291
model size : 29.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1537842750549316
Epoch: 1, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7550947666168213
Epoch: 2, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7236294746398926
Epoch: 3, Steps: 2 | Train Loss: 0.706 Vali Loss: 2.138 Vali Acc: 0.333 Test Loss: 2.138 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6745548248291016
Epoch: 4, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.792 Vali Acc: 0.267 Test Loss: 1.792 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.744452953338623
Epoch: 5, Steps: 2 | Train Loss: 0.691 Vali Loss: 3.806 Vali Acc: 0.333 Test Loss: 3.806 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7362232208251953
Epoch: 6, Steps: 2 | Train Loss: 0.286 Vali Loss: 2.826 Vali Acc: 0.400 Test Loss: 2.826 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7561769485473633
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.222 Vali Acc: 0.467 Test Loss: 6.222 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466604).  Saving model ...
Epoch: 8 cost time: 0.7575368881225586
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.839 Vali Acc: 0.467 Test Loss: 9.839 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7382776737213135
Epoch: 9, Steps: 2 | Train Loss: 0.002 Vali Loss: 10.355 Vali Acc: 0.533 Test Loss: 10.355 Test Acc: 0.533
Validation loss decreased (-0.466604 --> -0.533230).  Saving model ...
Epoch: 10 cost time: 0.7351257801055908
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.901 Vali Acc: 0.467 Test Loss: 10.901 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7545351982116699
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.528 Vali Acc: 0.400 Test Loss: 11.528 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7368152141571045
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.182 Vali Acc: 0.400 Test Loss: 12.182 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7209641933441162
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.818 Vali Acc: 0.400 Test Loss: 12.818 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7217762470245361
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.389 Vali Acc: 0.333 Test Loss: 13.389 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7547454833984375
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.893 Vali Acc: 0.333 Test Loss: 13.893 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6865899562835693
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 14.347 Vali Acc: 0.333 Test Loss: 14.347 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7629005908966064
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 14.729 Vali Acc: 0.333 Test Loss: 14.729 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7389323711395264
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 15.061 Vali Acc: 0.333 Test Loss: 15.061 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7252018451690674
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 15.346 Vali Acc: 0.333 Test Loss: 15.346 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5044291
model size : 29.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0492749214172363
Epoch: 1, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7992639541625977
Epoch: 2, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7207603454589844
Epoch: 3, Steps: 2 | Train Loss: 0.800 Vali Loss: 2.025 Vali Acc: 0.333 Test Loss: 2.025 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.668602705001831
Epoch: 4, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.907 Vali Acc: 0.200 Test Loss: 1.907 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6713142395019531
Epoch: 5, Steps: 2 | Train Loss: 0.847 Vali Loss: 4.689 Vali Acc: 0.333 Test Loss: 4.689 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6833596229553223
Epoch: 6, Steps: 2 | Train Loss: 0.550 Vali Loss: 2.860 Vali Acc: 0.333 Test Loss: 2.860 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5995323657989502
Epoch: 7, Steps: 2 | Train Loss: 0.097 Vali Loss: 3.259 Vali Acc: 0.267 Test Loss: 3.259 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7856423854827881
Epoch: 8, Steps: 2 | Train Loss: 0.004 Vali Loss: 7.172 Vali Acc: 0.333 Test Loss: 7.172 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7140352725982666
Epoch: 9, Steps: 2 | Train Loss: 0.051 Vali Loss: 7.919 Vali Acc: 0.333 Test Loss: 7.919 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7391419410705566
Epoch: 10, Steps: 2 | Train Loss: 0.002 Vali Loss: 6.758 Vali Acc: 0.200 Test Loss: 6.758 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7312123775482178
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.697 Vali Acc: 0.200 Test Loss: 6.697 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6578633785247803
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.869 Vali Acc: 0.267 Test Loss: 7.869 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 5044291
model size : 29.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.952664852142334
Epoch: 1, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6710286140441895
Epoch: 2, Steps: 2 | Train Loss: 0.686 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.6324286460876465
Epoch: 3, Steps: 2 | Train Loss: 0.610 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.625929594039917
Epoch: 4, Steps: 2 | Train Loss: 0.314 Vali Loss: 1.429 Vali Acc: 0.267 Test Loss: 1.429 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6430840492248535
Epoch: 5, Steps: 2 | Train Loss: 0.058 Vali Loss: 2.038 Vali Acc: 0.333 Test Loss: 2.038 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333313).  Saving model ...
Epoch: 6 cost time: 0.6703052520751953
Epoch: 6, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.628 Vali Acc: 0.400 Test Loss: 2.628 Test Acc: 0.400
Validation loss decreased (-0.333313 --> -0.399974).  Saving model ...
Epoch: 7 cost time: 0.6814727783203125
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.309 Vali Acc: 0.333 Test Loss: 3.309 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6710283756256104
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.949 Vali Acc: 0.267 Test Loss: 3.949 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.682065486907959
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.536 Vali Acc: 0.267 Test Loss: 4.536 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.678441047668457
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.060 Vali Acc: 0.267 Test Loss: 5.060 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7055251598358154
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.535 Vali Acc: 0.333 Test Loss: 5.535 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6555051803588867
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.959 Vali Acc: 0.333 Test Loss: 5.959 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6348340511322021
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.332 Vali Acc: 0.333 Test Loss: 6.332 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5874261856079102
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.648 Vali Acc: 0.333 Test Loss: 6.648 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6092104911804199
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.932 Vali Acc: 0.333 Test Loss: 6.932 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5970017910003662
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.171 Vali Acc: 0.333 Test Loss: 7.171 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4291651
model size : 21.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.995819091796875
Epoch: 1, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.239 Vali Acc: 0.200 Test Loss: 1.239 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6270923614501953
Epoch: 2, Steps: 2 | Train Loss: 0.761 Vali Loss: 1.239 Vali Acc: 0.200 Test Loss: 1.239 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.6546323299407959
Epoch: 3, Steps: 2 | Train Loss: 0.660 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5926649570465088
Epoch: 4, Steps: 2 | Train Loss: 0.356 Vali Loss: 1.486 Vali Acc: 0.333 Test Loss: 1.486 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333318).  Saving model ...
Epoch: 5 cost time: 0.6596999168395996
Epoch: 5, Steps: 2 | Train Loss: 0.125 Vali Loss: 1.831 Vali Acc: 0.467 Test Loss: 1.831 Test Acc: 0.467
Validation loss decreased (-0.333318 --> -0.466648).  Saving model ...
Epoch: 6 cost time: 0.6155900955200195
Epoch: 6, Steps: 2 | Train Loss: 0.014 Vali Loss: 2.329 Vali Acc: 0.333 Test Loss: 2.329 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.653761625289917
Epoch: 7, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.740 Vali Acc: 0.333 Test Loss: 2.740 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6255691051483154
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.158 Vali Acc: 0.267 Test Loss: 3.158 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6669344902038574
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.593 Vali Acc: 0.267 Test Loss: 3.593 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6539945602416992
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.979 Vali Acc: 0.267 Test Loss: 3.979 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6551015377044678
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.331 Vali Acc: 0.333 Test Loss: 4.331 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6948351860046387
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.663 Vali Acc: 0.333 Test Loss: 4.663 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6105237007141113
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.957 Vali Acc: 0.333 Test Loss: 4.957 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.611335277557373
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.241 Vali Acc: 0.333 Test Loss: 5.241 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6428825855255127
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.491 Vali Acc: 0.333 Test Loss: 5.491 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4291651
model size : 21.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8334412574768066
Epoch: 1, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.635493278503418
Epoch: 2, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5976078510284424
Epoch: 3, Steps: 2 | Train Loss: 0.692 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5750885009765625
Epoch: 4, Steps: 2 | Train Loss: 0.507 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.6209330558776855
Epoch: 5, Steps: 2 | Train Loss: 0.139 Vali Loss: 1.845 Vali Acc: 0.333 Test Loss: 1.845 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5993180274963379
Epoch: 6, Steps: 2 | Train Loss: 0.031 Vali Loss: 2.118 Vali Acc: 0.333 Test Loss: 2.118 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6365306377410889
Epoch: 7, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.975 Vali Acc: 0.200 Test Loss: 2.975 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6590843200683594
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.961 Vali Acc: 0.200 Test Loss: 3.961 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5656862258911133
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.837 Vali Acc: 0.200 Test Loss: 4.837 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5819492340087891
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.609 Vali Acc: 0.200 Test Loss: 5.609 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6068744659423828
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.298 Vali Acc: 0.200 Test Loss: 6.298 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6456718444824219
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.885 Vali Acc: 0.200 Test Loss: 6.885 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6089339256286621
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.414 Vali Acc: 0.200 Test Loss: 7.414 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6233856678009033
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.894 Vali Acc: 0.200 Test Loss: 7.894 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4291651
model size : 21.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6313567161560059
Epoch: 1, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.64080810546875
Epoch: 2, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6189248561859131
Epoch: 3, Steps: 2 | Train Loss: 0.809 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6348893642425537
Epoch: 4, Steps: 2 | Train Loss: 0.581 Vali Loss: 1.326 Vali Acc: 0.267 Test Loss: 1.326 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5808298587799072
Epoch: 5, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.590 Vali Acc: 0.267 Test Loss: 1.590 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5839269161224365
Epoch: 6, Steps: 2 | Train Loss: 0.087 Vali Loss: 1.747 Vali Acc: 0.267 Test Loss: 1.747 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5958380699157715
Epoch: 7, Steps: 2 | Train Loss: 0.025 Vali Loss: 2.363 Vali Acc: 0.133 Test Loss: 2.363 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5630090236663818
Epoch: 8, Steps: 2 | Train Loss: 0.012 Vali Loss: 3.363 Vali Acc: 0.200 Test Loss: 3.363 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5557537078857422
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.010 Vali Acc: 0.200 Test Loss: 4.010 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5348446369171143
Epoch: 10, Steps: 2 | Train Loss: 0.003 Vali Loss: 4.153 Vali Acc: 0.333 Test Loss: 4.153 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5998480319976807
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.074 Vali Acc: 0.267 Test Loss: 4.074 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.609180212020874
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.264 Vali Acc: 0.267 Test Loss: 4.264 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4291651
model size : 21.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9988617897033691
Epoch: 1, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6210112571716309
Epoch: 2, Steps: 2 | Train Loss: 0.751 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6572051048278809
Epoch: 3, Steps: 2 | Train Loss: 0.527 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6957764625549316
Epoch: 4, Steps: 2 | Train Loss: 0.221 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6197631359100342
Epoch: 5, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.995 Vali Acc: 0.333 Test Loss: 1.995 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.67368483543396
Epoch: 6, Steps: 2 | Train Loss: 0.011 Vali Loss: 2.975 Vali Acc: 0.400 Test Loss: 2.975 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6297595500946045
Epoch: 7, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.468 Vali Acc: 0.400 Test Loss: 3.468 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6065826416015625
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.911 Vali Acc: 0.400 Test Loss: 3.911 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6456382274627686
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.314 Vali Acc: 0.467 Test Loss: 4.314 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6399283409118652
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.699 Vali Acc: 0.400 Test Loss: 4.699 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6083600521087646
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.068 Vali Acc: 0.400 Test Loss: 5.068 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6369211673736572
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.414 Vali Acc: 0.400 Test Loss: 5.414 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3243075
model size : 17.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9893767833709717
Epoch: 1, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.5000500679016113
Epoch: 2, Steps: 2 | Train Loss: 0.818 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.5728216171264648
Epoch: 3, Steps: 2 | Train Loss: 0.569 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5547480583190918
Epoch: 4, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.516465425491333
Epoch: 5, Steps: 2 | Train Loss: 0.096 Vali Loss: 1.921 Vali Acc: 0.467 Test Loss: 1.921 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5375561714172363
Epoch: 6, Steps: 2 | Train Loss: 0.028 Vali Loss: 3.039 Vali Acc: 0.333 Test Loss: 3.039 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5671486854553223
Epoch: 7, Steps: 2 | Train Loss: 0.006 Vali Loss: 2.930 Vali Acc: 0.400 Test Loss: 2.930 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5670351982116699
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.481 Vali Acc: 0.267 Test Loss: 3.481 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5861072540283203
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.327 Vali Acc: 0.200 Test Loss: 4.327 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5648787021636963
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.246 Vali Acc: 0.267 Test Loss: 5.246 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6315104961395264
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 6.017 Vali Acc: 0.267 Test Loss: 6.017 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5907261371612549
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.530 Vali Acc: 0.200 Test Loss: 6.530 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5570492744445801
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.988 Vali Acc: 0.267 Test Loss: 6.988 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.574840784072876
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.382 Vali Acc: 0.267 Test Loss: 7.382 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3243075
model size : 17.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9109439849853516
Epoch: 1, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6327121257781982
Epoch: 2, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6273560523986816
Epoch: 3, Steps: 2 | Train Loss: 0.674 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6322627067565918
Epoch: 4, Steps: 2 | Train Loss: 0.337 Vali Loss: 1.269 Vali Acc: 0.200 Test Loss: 1.269 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6266710758209229
Epoch: 5, Steps: 2 | Train Loss: 0.142 Vali Loss: 1.932 Vali Acc: 0.467 Test Loss: 1.932 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6139321327209473
Epoch: 6, Steps: 2 | Train Loss: 0.115 Vali Loss: 2.944 Vali Acc: 0.467 Test Loss: 2.944 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.631380558013916
Epoch: 7, Steps: 2 | Train Loss: 0.023 Vali Loss: 2.450 Vali Acc: 0.267 Test Loss: 2.450 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6205253601074219
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.970 Vali Acc: 0.267 Test Loss: 3.970 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6339921951293945
Epoch: 9, Steps: 2 | Train Loss: 0.080 Vali Loss: 4.990 Vali Acc: 0.267 Test Loss: 4.990 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6255080699920654
Epoch: 10, Steps: 2 | Train Loss: 0.006 Vali Loss: 5.080 Vali Acc: 0.200 Test Loss: 5.080 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6172559261322021
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.106 Vali Acc: 0.267 Test Loss: 6.106 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3243075
model size : 17.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.882035732269287
Epoch: 1, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.5670919418334961
Epoch: 2, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5567853450775146
Epoch: 3, Steps: 2 | Train Loss: 0.745 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.577692985534668
Epoch: 4, Steps: 2 | Train Loss: 0.452 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6058249473571777
Epoch: 5, Steps: 2 | Train Loss: 0.268 Vali Loss: 1.591 Vali Acc: 0.467 Test Loss: 1.591 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6200006008148193
Epoch: 6, Steps: 2 | Train Loss: 0.311 Vali Loss: 2.019 Vali Acc: 0.467 Test Loss: 2.019 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5990655422210693
Epoch: 7, Steps: 2 | Train Loss: 0.070 Vali Loss: 2.368 Vali Acc: 0.267 Test Loss: 2.368 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5643153190612793
Epoch: 8, Steps: 2 | Train Loss: 0.012 Vali Loss: 2.934 Vali Acc: 0.200 Test Loss: 2.934 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5369596481323242
Epoch: 9, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.926 Vali Acc: 0.200 Test Loss: 2.926 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5495955944061279
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.150 Vali Acc: 0.333 Test Loss: 3.150 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5581426620483398
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.741 Vali Acc: 0.333 Test Loss: 3.741 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3243075
model size : 17.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8572053909301758
Epoch: 1, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5734550952911377
Epoch: 2, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6235635280609131
Epoch: 3, Steps: 2 | Train Loss: 0.716 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6333653926849365
Epoch: 4, Steps: 2 | Train Loss: 0.252 Vali Loss: 1.443 Vali Acc: 0.400 Test Loss: 1.443 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.679673433303833
Epoch: 5, Steps: 2 | Train Loss: 0.077 Vali Loss: 1.652 Vali Acc: 0.400 Test Loss: 1.652 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6707394123077393
Epoch: 6, Steps: 2 | Train Loss: 0.015 Vali Loss: 2.471 Vali Acc: 0.400 Test Loss: 2.471 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6918644905090332
Epoch: 7, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.765 Vali Acc: 0.200 Test Loss: 3.765 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6671090126037598
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.366 Vali Acc: 0.200 Test Loss: 4.366 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6918597221374512
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.888 Vali Acc: 0.133 Test Loss: 4.888 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6151447296142578
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.352 Vali Acc: 0.133 Test Loss: 5.352 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6737637519836426
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.762 Vali Acc: 0.133 Test Loss: 5.762 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6421430110931396
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.116 Vali Acc: 0.133 Test Loss: 6.116 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2718787
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.064465284347534
Epoch: 1, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6436738967895508
Epoch: 2, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6380758285522461
Epoch: 3, Steps: 2 | Train Loss: 0.767 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6130852699279785
Epoch: 4, Steps: 2 | Train Loss: 0.274 Vali Loss: 1.563 Vali Acc: 0.467 Test Loss: 1.563 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6341383457183838
Epoch: 5, Steps: 2 | Train Loss: 0.102 Vali Loss: 1.646 Vali Acc: 0.267 Test Loss: 1.646 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6483480930328369
Epoch: 6, Steps: 2 | Train Loss: 0.018 Vali Loss: 2.358 Vali Acc: 0.400 Test Loss: 2.358 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6494724750518799
Epoch: 7, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.338 Vali Acc: 0.200 Test Loss: 3.338 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6227016448974609
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.716 Vali Acc: 0.133 Test Loss: 3.716 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6378531455993652
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.248 Vali Acc: 0.200 Test Loss: 4.248 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6566810607910156
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.883 Vali Acc: 0.133 Test Loss: 4.883 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6545717716217041
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.516 Vali Acc: 0.200 Test Loss: 5.516 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6041290760040283
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.104 Vali Acc: 0.200 Test Loss: 6.104 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2718787
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1320855617523193
Epoch: 1, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6227011680603027
Epoch: 2, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5865523815155029
Epoch: 3, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6252763271331787
Epoch: 4, Steps: 2 | Train Loss: 0.353 Vali Loss: 1.700 Vali Acc: 0.333 Test Loss: 1.700 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5966677665710449
Epoch: 5, Steps: 2 | Train Loss: 0.192 Vali Loss: 1.717 Vali Acc: 0.333 Test Loss: 1.717 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5801506042480469
Epoch: 6, Steps: 2 | Train Loss: 0.054 Vali Loss: 2.154 Vali Acc: 0.133 Test Loss: 2.154 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6241044998168945
Epoch: 7, Steps: 2 | Train Loss: 0.005 Vali Loss: 3.381 Vali Acc: 0.200 Test Loss: 3.381 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6098554134368896
Epoch: 8, Steps: 2 | Train Loss: 0.002 Vali Loss: 4.847 Vali Acc: 0.200 Test Loss: 4.847 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5871865749359131
Epoch: 9, Steps: 2 | Train Loss: 0.002 Vali Loss: 5.573 Vali Acc: 0.200 Test Loss: 5.573 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6252386569976807
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.760 Vali Acc: 0.200 Test Loss: 5.760 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.619560956954956
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.939 Vali Acc: 0.267 Test Loss: 5.939 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6113696098327637
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.153 Vali Acc: 0.333 Test Loss: 6.153 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2718787
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9957308769226074
Epoch: 1, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5813169479370117
Epoch: 2, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6043782234191895
Epoch: 3, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5702791213989258
Epoch: 4, Steps: 2 | Train Loss: 0.441 Vali Loss: 1.558 Vali Acc: 0.267 Test Loss: 1.558 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5926456451416016
Epoch: 5, Steps: 2 | Train Loss: 0.345 Vali Loss: 1.569 Vali Acc: 0.267 Test Loss: 1.569 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5996840000152588
Epoch: 6, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.864 Vali Acc: 0.333 Test Loss: 1.864 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5960228443145752
Epoch: 7, Steps: 2 | Train Loss: 0.032 Vali Loss: 2.619 Vali Acc: 0.200 Test Loss: 2.619 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6162126064300537
Epoch: 8, Steps: 2 | Train Loss: 0.021 Vali Loss: 2.793 Vali Acc: 0.133 Test Loss: 2.793 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6004726886749268
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.327 Vali Acc: 0.267 Test Loss: 3.327 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6001901626586914
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.211 Vali Acc: 0.267 Test Loss: 4.211 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5967576503753662
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.932 Vali Acc: 0.267 Test Loss: 4.932 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2718787
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.16135311126709
Epoch: 1, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.6861827373504639
Epoch: 2, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.999 Vali Acc: 0.667 Test Loss: 0.999 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 0.6719441413879395
Epoch: 3, Steps: 2 | Train Loss: 0.618 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6262931823730469
Epoch: 4, Steps: 2 | Train Loss: 0.313 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6554055213928223
Epoch: 5, Steps: 2 | Train Loss: 0.082 Vali Loss: 1.703 Vali Acc: 0.200 Test Loss: 1.703 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7117059230804443
Epoch: 6, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.411 Vali Acc: 0.267 Test Loss: 2.411 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6597836017608643
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.811 Vali Acc: 0.333 Test Loss: 3.811 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6950211524963379
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.152 Vali Acc: 0.333 Test Loss: 5.152 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6917428970336914
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.389 Vali Acc: 0.400 Test Loss: 6.389 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.707634449005127
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.513 Vali Acc: 0.400 Test Loss: 7.513 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6712346076965332
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.513 Vali Acc: 0.400 Test Loss: 8.513 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7103538513183594
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.384 Vali Acc: 0.400 Test Loss: 9.384 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 2456643
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1529295444488525
Epoch: 1, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.610623836517334
Epoch: 2, Steps: 2 | Train Loss: 0.868 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.594369649887085
Epoch: 3, Steps: 2 | Train Loss: 0.683 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5825483798980713
Epoch: 4, Steps: 2 | Train Loss: 0.379 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.600733757019043
Epoch: 5, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.933 Vali Acc: 0.200 Test Loss: 1.933 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6381974220275879
Epoch: 6, Steps: 2 | Train Loss: 0.019 Vali Loss: 2.549 Vali Acc: 0.333 Test Loss: 2.549 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6238534450531006
Epoch: 7, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.753 Vali Acc: 0.333 Test Loss: 3.753 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6372637748718262
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 5.098 Vali Acc: 0.333 Test Loss: 5.098 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5793623924255371
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 5.974 Vali Acc: 0.333 Test Loss: 5.974 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6063098907470703
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 6.364 Vali Acc: 0.333 Test Loss: 6.364 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6383490562438965
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.667 Vali Acc: 0.333 Test Loss: 6.667 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2456643
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1590728759765625
Epoch: 1, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6072320938110352
Epoch: 2, Steps: 2 | Train Loss: 0.876 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6051747798919678
Epoch: 3, Steps: 2 | Train Loss: 0.730 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6114866733551025
Epoch: 4, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.329 Vali Acc: 0.333 Test Loss: 1.329 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5773570537567139
Epoch: 5, Steps: 2 | Train Loss: 0.230 Vali Loss: 1.976 Vali Acc: 0.200 Test Loss: 1.976 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.573854923248291
Epoch: 6, Steps: 2 | Train Loss: 0.056 Vali Loss: 2.813 Vali Acc: 0.267 Test Loss: 2.813 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5886979103088379
Epoch: 7, Steps: 2 | Train Loss: 0.008 Vali Loss: 3.055 Vali Acc: 0.267 Test Loss: 3.055 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6090347766876221
Epoch: 8, Steps: 2 | Train Loss: 0.004 Vali Loss: 3.273 Vali Acc: 0.267 Test Loss: 3.273 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.609644889831543
Epoch: 9, Steps: 2 | Train Loss: 0.003 Vali Loss: 4.101 Vali Acc: 0.333 Test Loss: 4.101 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6432883739471436
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.306 Vali Acc: 0.200 Test Loss: 5.306 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6187567710876465
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.488 Vali Acc: 0.200 Test Loss: 6.488 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6782147884368896
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.608 Vali Acc: 0.200 Test Loss: 7.608 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2456643
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1654152870178223
Epoch: 1, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6102337837219238
Epoch: 2, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.128 Vali Acc: 0.133 Test Loss: 1.128 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6092309951782227
Epoch: 3, Steps: 2 | Train Loss: 0.806 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6269645690917969
Epoch: 4, Steps: 2 | Train Loss: 0.548 Vali Loss: 1.341 Vali Acc: 0.333 Test Loss: 1.341 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.6318254470825195
Epoch: 5, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.887 Vali Acc: 0.333 Test Loss: 1.887 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6164932250976562
Epoch: 6, Steps: 2 | Train Loss: 0.138 Vali Loss: 1.923 Vali Acc: 0.400 Test Loss: 1.923 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399981).  Saving model ...
Epoch: 7 cost time: 0.6317446231842041
Epoch: 7, Steps: 2 | Train Loss: 0.148 Vali Loss: 2.828 Vali Acc: 0.267 Test Loss: 2.828 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5515737533569336
Epoch: 8, Steps: 2 | Train Loss: 0.026 Vali Loss: 2.382 Vali Acc: 0.200 Test Loss: 2.382 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5984995365142822
Epoch: 9, Steps: 2 | Train Loss: 0.007 Vali Loss: 2.913 Vali Acc: 0.200 Test Loss: 2.913 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5885922908782959
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.700 Vali Acc: 0.200 Test Loss: 3.700 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6090166568756104
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.443 Vali Acc: 0.200 Test Loss: 4.443 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5990235805511475
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.079 Vali Acc: 0.267 Test Loss: 5.079 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6323869228363037
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.649 Vali Acc: 0.267 Test Loss: 5.649 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.625638484954834
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.141 Vali Acc: 0.267 Test Loss: 6.141 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6041250228881836
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.544 Vali Acc: 0.267 Test Loss: 6.544 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.666085958480835
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.868 Vali Acc: 0.267 Test Loss: 6.868 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2456643
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.162367582321167
Epoch: 1, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6797356605529785
Epoch: 2, Steps: 2 | Train Loss: 0.749 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7034757137298584
Epoch: 3, Steps: 2 | Train Loss: 0.585 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7223680019378662
Epoch: 4, Steps: 2 | Train Loss: 0.255 Vali Loss: 1.398 Vali Acc: 0.600 Test Loss: 1.398 Test Acc: 0.600
Validation loss decreased (-0.399988 --> -0.599986).  Saving model ...
Epoch: 5 cost time: 0.73655104637146
Epoch: 5, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.976 Vali Acc: 0.333 Test Loss: 1.976 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.769719123840332
Epoch: 6, Steps: 2 | Train Loss: 0.035 Vali Loss: 2.095 Vali Acc: 0.200 Test Loss: 2.095 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.699763298034668
Epoch: 7, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.538 Vali Acc: 0.333 Test Loss: 2.538 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7260229587554932
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.456 Vali Acc: 0.333 Test Loss: 3.456 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6868655681610107
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.488 Vali Acc: 0.400 Test Loss: 4.488 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7037887573242188
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.523 Vali Acc: 0.400 Test Loss: 5.523 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6905684471130371
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.488 Vali Acc: 0.400 Test Loss: 6.488 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6834416389465332
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.364 Vali Acc: 0.400 Test Loss: 7.364 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6741933822631836
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.136 Vali Acc: 0.333 Test Loss: 8.136 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6910274028778076
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.817 Vali Acc: 0.333 Test Loss: 8.817 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2325571
model size : 13.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0305216312408447
Epoch: 1, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6371731758117676
Epoch: 2, Steps: 2 | Train Loss: 0.801 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6250977516174316
Epoch: 3, Steps: 2 | Train Loss: 0.635 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6750478744506836
Epoch: 4, Steps: 2 | Train Loss: 0.313 Vali Loss: 1.450 Vali Acc: 0.400 Test Loss: 1.450 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 0.6658980846405029
Epoch: 5, Steps: 2 | Train Loss: 0.144 Vali Loss: 2.062 Vali Acc: 0.267 Test Loss: 2.062 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6526377201080322
Epoch: 6, Steps: 2 | Train Loss: 0.079 Vali Loss: 2.118 Vali Acc: 0.133 Test Loss: 2.118 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.665663480758667
Epoch: 7, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.526 Vali Acc: 0.400 Test Loss: 2.526 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6012845039367676
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.760 Vali Acc: 0.333 Test Loss: 3.760 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6505715847015381
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.955 Vali Acc: 0.333 Test Loss: 4.955 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6413149833679199
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.002 Vali Acc: 0.400 Test Loss: 6.002 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6097068786621094
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.908 Vali Acc: 0.400 Test Loss: 6.908 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6344423294067383
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.681 Vali Acc: 0.400 Test Loss: 7.681 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6615395545959473
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.330 Vali Acc: 0.400 Test Loss: 8.330 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6866049766540527
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.860 Vali Acc: 0.400 Test Loss: 8.860 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2325571
model size : 13.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2102434635162354
Epoch: 1, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5937807559967041
Epoch: 2, Steps: 2 | Train Loss: 0.846 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6303470134735107
Epoch: 3, Steps: 2 | Train Loss: 0.722 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6405229568481445
Epoch: 4, Steps: 2 | Train Loss: 0.371 Vali Loss: 1.366 Vali Acc: 0.400 Test Loss: 1.366 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6923713684082031
Epoch: 5, Steps: 2 | Train Loss: 0.174 Vali Loss: 2.063 Vali Acc: 0.267 Test Loss: 2.063 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6170883178710938
Epoch: 6, Steps: 2 | Train Loss: 0.128 Vali Loss: 2.271 Vali Acc: 0.200 Test Loss: 2.271 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5792486667633057
Epoch: 7, Steps: 2 | Train Loss: 0.022 Vali Loss: 2.648 Vali Acc: 0.333 Test Loss: 2.648 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6101434230804443
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.026 Vali Acc: 0.400 Test Loss: 4.026 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6200182437896729
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 5.194 Vali Acc: 0.400 Test Loss: 5.194 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6543276309967041
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 5.740 Vali Acc: 0.400 Test Loss: 5.740 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5938320159912109
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.130 Vali Acc: 0.400 Test Loss: 6.130 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6271750926971436
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.462 Vali Acc: 0.400 Test Loss: 6.462 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2325571
model size : 13.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.113170623779297
Epoch: 1, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.6447098255157471
Epoch: 2, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6059038639068604
Epoch: 3, Steps: 2 | Train Loss: 0.804 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.585115909576416
Epoch: 4, Steps: 2 | Train Loss: 0.462 Vali Loss: 1.400 Vali Acc: 0.267 Test Loss: 1.400 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5968797206878662
Epoch: 5, Steps: 2 | Train Loss: 0.240 Vali Loss: 2.117 Vali Acc: 0.333 Test Loss: 2.117 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333312).  Saving model ...
Epoch: 6 cost time: 0.6536483764648438
Epoch: 6, Steps: 2 | Train Loss: 0.173 Vali Loss: 2.495 Vali Acc: 0.333 Test Loss: 2.495 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6176280975341797
Epoch: 7, Steps: 2 | Train Loss: 0.110 Vali Loss: 2.495 Vali Acc: 0.333 Test Loss: 2.495 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6859309673309326
Epoch: 8, Steps: 2 | Train Loss: 0.018 Vali Loss: 3.127 Vali Acc: 0.333 Test Loss: 3.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.626413106918335
Epoch: 9, Steps: 2 | Train Loss: 0.011 Vali Loss: 2.943 Vali Acc: 0.333 Test Loss: 2.943 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6474385261535645
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.417 Vali Acc: 0.200 Test Loss: 3.417 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6712090969085693
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.361 Vali Acc: 0.200 Test Loss: 4.361 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6439757347106934
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 4.692 Vali Acc: 0.200 Test Loss: 4.692 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6171250343322754
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.026 Vali Acc: 0.200 Test Loss: 5.026 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6213438510894775
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.342 Vali Acc: 0.200 Test Loss: 5.342 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6122519969940186
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.642 Vali Acc: 0.200 Test Loss: 5.642 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2325571
model size : 13.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.103144407272339
Epoch: 1, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6765134334564209
Epoch: 2, Steps: 2 | Train Loss: 0.696 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
Validation loss decreased (-0.199988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.6819329261779785
Epoch: 3, Steps: 2 | Train Loss: 0.625 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6676986217498779
Epoch: 4, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.446 Vali Acc: 0.267 Test Loss: 1.446 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6800510883331299
Epoch: 5, Steps: 2 | Train Loss: 0.056 Vali Loss: 2.281 Vali Acc: 0.400 Test Loss: 2.281 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6882739067077637
Epoch: 6, Steps: 2 | Train Loss: 0.006 Vali Loss: 2.586 Vali Acc: 0.200 Test Loss: 2.586 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7016589641571045
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.183 Vali Acc: 0.200 Test Loss: 3.183 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7304508686065674
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.993 Vali Acc: 0.267 Test Loss: 3.993 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7193892002105713
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.819 Vali Acc: 0.267 Test Loss: 4.819 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.742673397064209
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.337 Vali Acc: 0.267 Test Loss: 5.337 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6752586364746094
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.796 Vali Acc: 0.267 Test Loss: 5.796 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6704556941986084
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.184 Vali Acc: 0.267 Test Loss: 6.184 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2260035
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.249248743057251
Epoch: 1, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6497912406921387
Epoch: 2, Steps: 2 | Train Loss: 0.754 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.618868350982666
Epoch: 3, Steps: 2 | Train Loss: 0.710 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6782875061035156
Epoch: 4, Steps: 2 | Train Loss: 0.401 Vali Loss: 1.417 Vali Acc: 0.333 Test Loss: 1.417 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 0.6981182098388672
Epoch: 5, Steps: 2 | Train Loss: 0.095 Vali Loss: 2.080 Vali Acc: 0.333 Test Loss: 2.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6810574531555176
Epoch: 6, Steps: 2 | Train Loss: 0.013 Vali Loss: 2.224 Vali Acc: 0.133 Test Loss: 2.224 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7256045341491699
Epoch: 7, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.283 Vali Acc: 0.267 Test Loss: 3.283 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6670026779174805
Epoch: 8, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.439 Vali Acc: 0.133 Test Loss: 3.439 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6805398464202881
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.778 Vali Acc: 0.067 Test Loss: 3.778 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7040050029754639
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.278 Vali Acc: 0.267 Test Loss: 4.278 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.637852668762207
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.852 Vali Acc: 0.267 Test Loss: 4.852 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6816411018371582
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.380 Vali Acc: 0.267 Test Loss: 5.380 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6452455520629883
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.873 Vali Acc: 0.267 Test Loss: 5.873 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6863994598388672
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.299 Vali Acc: 0.267 Test Loss: 6.299 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2260035
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1834847927093506
Epoch: 1, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6392619609832764
Epoch: 2, Steps: 2 | Train Loss: 0.813 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7184939384460449
Epoch: 3, Steps: 2 | Train Loss: 0.743 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6292521953582764
Epoch: 4, Steps: 2 | Train Loss: 0.472 Vali Loss: 1.425 Vali Acc: 0.267 Test Loss: 1.425 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6333894729614258
Epoch: 5, Steps: 2 | Train Loss: 0.155 Vali Loss: 1.990 Vali Acc: 0.333 Test Loss: 1.990 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6543924808502197
Epoch: 6, Steps: 2 | Train Loss: 0.033 Vali Loss: 2.527 Vali Acc: 0.200 Test Loss: 2.527 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6246912479400635
Epoch: 7, Steps: 2 | Train Loss: 0.034 Vali Loss: 3.636 Vali Acc: 0.200 Test Loss: 3.636 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6197738647460938
Epoch: 8, Steps: 2 | Train Loss: 0.004 Vali Loss: 3.500 Vali Acc: 0.200 Test Loss: 3.500 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6279137134552002
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.998 Vali Acc: 0.400 Test Loss: 3.998 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399960).  Saving model ...
Epoch: 10 cost time: 0.5939862728118896
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.986 Vali Acc: 0.333 Test Loss: 4.986 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6775953769683838
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.244 Vali Acc: 0.467 Test Loss: 6.244 Test Acc: 0.467
Validation loss decreased (-0.399960 --> -0.466604).  Saving model ...
Epoch: 12 cost time: 0.6356027126312256
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.311 Vali Acc: 0.400 Test Loss: 7.311 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6014437675476074
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 7.789 Vali Acc: 0.400 Test Loss: 7.789 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6019425392150879
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.996 Vali Acc: 0.400 Test Loss: 7.996 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6105191707611084
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.215 Vali Acc: 0.400 Test Loss: 8.215 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6269199848175049
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.466 Vali Acc: 0.333 Test Loss: 8.466 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6305015087127686
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.732 Vali Acc: 0.400 Test Loss: 8.732 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6539912223815918
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.984 Vali Acc: 0.400 Test Loss: 8.984 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6454160213470459
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.226 Vali Acc: 0.400 Test Loss: 9.226 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6386804580688477
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.441 Vali Acc: 0.400 Test Loss: 9.441 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6628429889678955
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.636 Vali Acc: 0.400 Test Loss: 9.636 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2260035
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0725185871124268
Epoch: 1, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6634500026702881
Epoch: 2, Steps: 2 | Train Loss: 0.902 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6295206546783447
Epoch: 3, Steps: 2 | Train Loss: 0.815 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6154727935791016
Epoch: 4, Steps: 2 | Train Loss: 0.517 Vali Loss: 1.454 Vali Acc: 0.200 Test Loss: 1.454 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6040256023406982
Epoch: 5, Steps: 2 | Train Loss: 0.268 Vali Loss: 1.652 Vali Acc: 0.267 Test Loss: 1.652 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5704388618469238
Epoch: 6, Steps: 2 | Train Loss: 0.090 Vali Loss: 2.162 Vali Acc: 0.133 Test Loss: 2.162 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6165132522583008
Epoch: 7, Steps: 2 | Train Loss: 0.083 Vali Loss: 2.753 Vali Acc: 0.200 Test Loss: 2.753 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6448354721069336
Epoch: 8, Steps: 2 | Train Loss: 0.009 Vali Loss: 2.528 Vali Acc: 0.333 Test Loss: 2.528 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6332082748413086
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.310 Vali Acc: 0.267 Test Loss: 3.310 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5847322940826416
Epoch: 10, Steps: 2 | Train Loss: 0.016 Vali Loss: 3.573 Vali Acc: 0.333 Test Loss: 3.573 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6322891712188721
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.808 Vali Acc: 0.267 Test Loss: 5.808 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2260035
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1209397315979004
Epoch: 1, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5686619281768799
Epoch: 2, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5603671073913574
Epoch: 3, Steps: 2 | Train Loss: 0.762 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5789554119110107
Epoch: 4, Steps: 2 | Train Loss: 0.471 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6503040790557861
Epoch: 5, Steps: 2 | Train Loss: 0.270 Vali Loss: 1.597 Vali Acc: 0.333 Test Loss: 1.597 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5762550830841064
Epoch: 6, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.768 Vali Acc: 0.200 Test Loss: 1.768 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5868260860443115
Epoch: 7, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.430 Vali Acc: 0.333 Test Loss: 2.430 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6055705547332764
Epoch: 8, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.152 Vali Acc: 0.333 Test Loss: 3.152 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5665521621704102
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.721 Vali Acc: 0.400 Test Loss: 3.721 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399963).  Saving model ...
Epoch: 10 cost time: 0.5543296337127686
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.222 Vali Acc: 0.400 Test Loss: 4.222 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5744879245758057
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.644 Vali Acc: 0.400 Test Loss: 4.644 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5923910140991211
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.992 Vali Acc: 0.400 Test Loss: 4.992 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5704123973846436
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.311 Vali Acc: 0.400 Test Loss: 5.311 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5844662189483643
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.583 Vali Acc: 0.400 Test Loss: 5.583 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6079616546630859
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.820 Vali Acc: 0.400 Test Loss: 5.820 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6147580146789551
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.037 Vali Acc: 0.400 Test Loss: 6.037 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.599830150604248
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.225 Vali Acc: 0.400 Test Loss: 6.225 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6285383701324463
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.368 Vali Acc: 0.400 Test Loss: 6.368 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5952012538909912
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.504 Vali Acc: 0.400 Test Loss: 6.504 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2080323
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.090653896331787
Epoch: 1, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5900225639343262
Epoch: 2, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.5959792137145996
Epoch: 3, Steps: 2 | Train Loss: 0.798 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6135208606719971
Epoch: 4, Steps: 2 | Train Loss: 0.517 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5952508449554443
Epoch: 5, Steps: 2 | Train Loss: 0.344 Vali Loss: 1.467 Vali Acc: 0.467 Test Loss: 1.467 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5794200897216797
Epoch: 6, Steps: 2 | Train Loss: 0.120 Vali Loss: 1.598 Vali Acc: 0.267 Test Loss: 1.598 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5756478309631348
Epoch: 7, Steps: 2 | Train Loss: 0.020 Vali Loss: 2.201 Vali Acc: 0.333 Test Loss: 2.201 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5897128582000732
Epoch: 8, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.696 Vali Acc: 0.333 Test Loss: 2.696 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6145927906036377
Epoch: 9, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.064 Vali Acc: 0.400 Test Loss: 3.064 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5821223258972168
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.430 Vali Acc: 0.400 Test Loss: 3.430 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5604226589202881
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.808 Vali Acc: 0.333 Test Loss: 3.808 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5838017463684082
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.144 Vali Acc: 0.333 Test Loss: 4.144 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2080323
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0809032917022705
Epoch: 1, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6036548614501953
Epoch: 2, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5715665817260742
Epoch: 3, Steps: 2 | Train Loss: 0.812 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5794005393981934
Epoch: 4, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.291 Vali Acc: 0.467 Test Loss: 1.291 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466654).  Saving model ...
Epoch: 5 cost time: 0.5762405395507812
Epoch: 5, Steps: 2 | Train Loss: 0.404 Vali Loss: 1.479 Vali Acc: 0.267 Test Loss: 1.479 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5487666130065918
Epoch: 6, Steps: 2 | Train Loss: 0.152 Vali Loss: 1.751 Vali Acc: 0.333 Test Loss: 1.751 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6336014270782471
Epoch: 7, Steps: 2 | Train Loss: 0.042 Vali Loss: 2.119 Vali Acc: 0.400 Test Loss: 2.119 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5896527767181396
Epoch: 8, Steps: 2 | Train Loss: 0.009 Vali Loss: 2.488 Vali Acc: 0.333 Test Loss: 2.488 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5662777423858643
Epoch: 9, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.770 Vali Acc: 0.267 Test Loss: 2.770 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.561943531036377
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.013 Vali Acc: 0.200 Test Loss: 3.013 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6122424602508545
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.258 Vali Acc: 0.200 Test Loss: 3.258 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5481357574462891
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.517 Vali Acc: 0.200 Test Loss: 3.517 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5421791076660156
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.765 Vali Acc: 0.200 Test Loss: 3.765 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5488944053649902
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.996 Vali Acc: 0.200 Test Loss: 3.996 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2080323
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9904792308807373
Epoch: 1, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5543653964996338
Epoch: 2, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4435544013977051
Epoch: 3, Steps: 2 | Train Loss: 0.870 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.56791090965271
Epoch: 4, Steps: 2 | Train Loss: 0.656 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5615723133087158
Epoch: 5, Steps: 2 | Train Loss: 0.567 Vali Loss: 1.300 Vali Acc: 0.333 Test Loss: 1.300 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5634171962738037
Epoch: 6, Steps: 2 | Train Loss: 0.289 Vali Loss: 1.377 Vali Acc: 0.267 Test Loss: 1.377 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6602928638458252
Epoch: 7, Steps: 2 | Train Loss: 0.114 Vali Loss: 1.529 Vali Acc: 0.333 Test Loss: 1.529 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6131591796875
Epoch: 8, Steps: 2 | Train Loss: 0.053 Vali Loss: 1.659 Vali Acc: 0.333 Test Loss: 1.659 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5645439624786377
Epoch: 9, Steps: 2 | Train Loss: 0.036 Vali Loss: 1.946 Vali Acc: 0.267 Test Loss: 1.946 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.55594801902771
Epoch: 10, Steps: 2 | Train Loss: 0.007 Vali Loss: 2.037 Vali Acc: 0.267 Test Loss: 2.037 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5934162139892578
Epoch: 11, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.350 Vali Acc: 0.267 Test Loss: 2.350 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.521028995513916
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.732 Vali Acc: 0.200 Test Loss: 2.732 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2080323
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.198690176010132
Epoch: 1, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6301307678222656
Epoch: 2, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6089606285095215
Epoch: 3, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5981354713439941
Epoch: 4, Steps: 2 | Train Loss: 0.541 Vali Loss: 1.594 Vali Acc: 0.400 Test Loss: 1.594 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 0.6178922653198242
Epoch: 5, Steps: 2 | Train Loss: 0.180 Vali Loss: 1.465 Vali Acc: 0.333 Test Loss: 1.465 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6384341716766357
Epoch: 6, Steps: 2 | Train Loss: 0.095 Vali Loss: 1.701 Vali Acc: 0.400 Test Loss: 1.701 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6758947372436523
Epoch: 7, Steps: 2 | Train Loss: 0.022 Vali Loss: 2.211 Vali Acc: 0.333 Test Loss: 2.211 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5954654216766357
Epoch: 8, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.813 Vali Acc: 0.333 Test Loss: 2.813 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5812597274780273
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.439 Vali Acc: 0.400 Test Loss: 3.439 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6290428638458252
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.982 Vali Acc: 0.400 Test Loss: 3.982 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6020264625549316
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.478 Vali Acc: 0.400 Test Loss: 4.478 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6191442012786865
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.905 Vali Acc: 0.400 Test Loss: 4.905 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6080195903778076
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.276 Vali Acc: 0.400 Test Loss: 5.276 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6159636974334717
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.607 Vali Acc: 0.400 Test Loss: 5.607 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1556035
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.22218918800354
Epoch: 1, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.604712963104248
Epoch: 2, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6207442283630371
Epoch: 3, Steps: 2 | Train Loss: 0.760 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5953860282897949
Epoch: 4, Steps: 2 | Train Loss: 0.669 Vali Loss: 1.672 Vali Acc: 0.333 Test Loss: 1.672 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5814187526702881
Epoch: 5, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.570 Vali Acc: 0.333 Test Loss: 1.570 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6165976524353027
Epoch: 6, Steps: 2 | Train Loss: 0.125 Vali Loss: 1.883 Vali Acc: 0.267 Test Loss: 1.883 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5518527030944824
Epoch: 7, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.937 Vali Acc: 0.200 Test Loss: 1.937 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.562260627746582
Epoch: 8, Steps: 2 | Train Loss: 0.021 Vali Loss: 2.330 Vali Acc: 0.400 Test Loss: 2.330 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6116695404052734
Epoch: 9, Steps: 2 | Train Loss: 0.004 Vali Loss: 3.258 Vali Acc: 0.333 Test Loss: 3.258 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5730476379394531
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.270 Vali Acc: 0.267 Test Loss: 4.270 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6094772815704346
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.123 Vali Acc: 0.267 Test Loss: 5.123 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5764570236206055
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.805 Vali Acc: 0.333 Test Loss: 5.805 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6003239154815674
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.324 Vali Acc: 0.333 Test Loss: 6.324 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1556035
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.050959348678589
Epoch: 1, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5546920299530029
Epoch: 2, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5634105205535889
Epoch: 3, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5431561470031738
Epoch: 4, Steps: 2 | Train Loss: 0.755 Vali Loss: 1.536 Vali Acc: 0.333 Test Loss: 1.536 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5624752044677734
Epoch: 5, Steps: 2 | Train Loss: 0.339 Vali Loss: 1.570 Vali Acc: 0.333 Test Loss: 1.570 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5128557682037354
Epoch: 6, Steps: 2 | Train Loss: 0.182 Vali Loss: 1.954 Vali Acc: 0.267 Test Loss: 1.954 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5423924922943115
Epoch: 7, Steps: 2 | Train Loss: 0.267 Vali Loss: 1.958 Vali Acc: 0.267 Test Loss: 1.958 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5240097045898438
Epoch: 8, Steps: 2 | Train Loss: 0.059 Vali Loss: 1.980 Vali Acc: 0.333 Test Loss: 1.980 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5324673652648926
Epoch: 9, Steps: 2 | Train Loss: 0.013 Vali Loss: 2.811 Vali Acc: 0.333 Test Loss: 2.811 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5190749168395996
Epoch: 10, Steps: 2 | Train Loss: 0.004 Vali Loss: 3.513 Vali Acc: 0.400 Test Loss: 3.513 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5198886394500732
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.838 Vali Acc: 0.333 Test Loss: 3.838 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1556035
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2071263790130615
Epoch: 1, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5787665843963623
Epoch: 2, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5477390289306641
Epoch: 3, Steps: 2 | Train Loss: 0.909 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5604522228240967
Epoch: 4, Steps: 2 | Train Loss: 0.782 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5350868701934814
Epoch: 5, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.415 Vali Acc: 0.267 Test Loss: 1.415 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5460529327392578
Epoch: 6, Steps: 2 | Train Loss: 0.263 Vali Loss: 1.590 Vali Acc: 0.333 Test Loss: 1.590 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5582013130187988
Epoch: 7, Steps: 2 | Train Loss: 0.204 Vali Loss: 1.560 Vali Acc: 0.333 Test Loss: 1.560 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.542949914932251
Epoch: 8, Steps: 2 | Train Loss: 0.083 Vali Loss: 1.829 Vali Acc: 0.267 Test Loss: 1.829 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5268194675445557
Epoch: 9, Steps: 2 | Train Loss: 0.054 Vali Loss: 2.141 Vali Acc: 0.200 Test Loss: 2.141 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5605916976928711
Epoch: 10, Steps: 2 | Train Loss: 0.007 Vali Loss: 2.466 Vali Acc: 0.200 Test Loss: 2.466 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6002495288848877
Epoch: 11, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.707 Vali Acc: 0.200 Test Loss: 2.707 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6063909530639648
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.940 Vali Acc: 0.200 Test Loss: 2.940 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5545275211334229
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.224 Vali Acc: 0.200 Test Loss: 3.224 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5940611362457275
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.501 Vali Acc: 0.200 Test Loss: 3.501 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1556035
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.074732542037964
Epoch: 1, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5360860824584961
Epoch: 2, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5654098987579346
Epoch: 3, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5808060169219971
Epoch: 4, Steps: 2 | Train Loss: 0.438 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5701050758361816
Epoch: 5, Steps: 2 | Train Loss: 0.295 Vali Loss: 1.826 Vali Acc: 0.400 Test Loss: 1.826 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5994791984558105
Epoch: 6, Steps: 2 | Train Loss: 0.115 Vali Loss: 1.691 Vali Acc: 0.333 Test Loss: 1.691 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5521113872528076
Epoch: 7, Steps: 2 | Train Loss: 0.012 Vali Loss: 2.270 Vali Acc: 0.133 Test Loss: 2.270 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5114622116088867
Epoch: 8, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.925 Vali Acc: 0.133 Test Loss: 2.925 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5840103626251221
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.543 Vali Acc: 0.133 Test Loss: 3.543 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5848517417907715
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.040 Vali Acc: 0.133 Test Loss: 4.040 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5694806575775146
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.494 Vali Acc: 0.200 Test Loss: 4.494 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6317009925842285
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.879 Vali Acc: 0.200 Test Loss: 4.879 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5436334609985352
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.223 Vali Acc: 0.200 Test Loss: 5.223 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1293891
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1108598709106445
Epoch: 1, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5994353294372559
Epoch: 2, Steps: 2 | Train Loss: 0.973 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5412271022796631
Epoch: 3, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5107541084289551
Epoch: 4, Steps: 2 | Train Loss: 0.501 Vali Loss: 1.254 Vali Acc: 0.400 Test Loss: 1.254 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5126612186431885
Epoch: 5, Steps: 2 | Train Loss: 0.349 Vali Loss: 1.876 Vali Acc: 0.400 Test Loss: 1.876 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.547264575958252
Epoch: 6, Steps: 2 | Train Loss: 0.191 Vali Loss: 1.494 Vali Acc: 0.333 Test Loss: 1.494 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5165119171142578
Epoch: 7, Steps: 2 | Train Loss: 0.022 Vali Loss: 2.269 Vali Acc: 0.333 Test Loss: 2.269 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.50189208984375
Epoch: 8, Steps: 2 | Train Loss: 0.021 Vali Loss: 2.869 Vali Acc: 0.267 Test Loss: 2.869 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4835524559020996
Epoch: 9, Steps: 2 | Train Loss: 0.005 Vali Loss: 3.003 Vali Acc: 0.267 Test Loss: 3.003 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5151777267456055
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.093 Vali Acc: 0.267 Test Loss: 3.093 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5653760433197021
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.356 Vali Acc: 0.200 Test Loss: 3.356 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5485577583312988
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.731 Vali Acc: 0.333 Test Loss: 3.731 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5649230480194092
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.150 Vali Acc: 0.267 Test Loss: 4.150 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1293891
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.091722249984741
Epoch: 1, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5400762557983398
Epoch: 2, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5080316066741943
Epoch: 3, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.199989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5111031532287598
Epoch: 4, Steps: 2 | Train Loss: 0.554 Vali Loss: 1.287 Vali Acc: 0.467 Test Loss: 1.287 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 5 cost time: 0.5686120986938477
Epoch: 5, Steps: 2 | Train Loss: 0.448 Vali Loss: 1.846 Vali Acc: 0.400 Test Loss: 1.846 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5204715728759766
Epoch: 6, Steps: 2 | Train Loss: 0.249 Vali Loss: 1.500 Vali Acc: 0.333 Test Loss: 1.500 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.562941312789917
Epoch: 7, Steps: 2 | Train Loss: 0.050 Vali Loss: 2.065 Vali Acc: 0.267 Test Loss: 2.065 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5312964916229248
Epoch: 8, Steps: 2 | Train Loss: 0.037 Vali Loss: 2.616 Vali Acc: 0.267 Test Loss: 2.616 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5057163238525391
Epoch: 9, Steps: 2 | Train Loss: 0.013 Vali Loss: 2.784 Vali Acc: 0.267 Test Loss: 2.784 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.49872469902038574
Epoch: 10, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.070 Vali Acc: 0.333 Test Loss: 3.070 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5606110095977783
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.669 Vali Acc: 0.400 Test Loss: 3.669 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5350430011749268
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 4.023 Vali Acc: 0.400 Test Loss: 4.023 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5464651584625244
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.263 Vali Acc: 0.400 Test Loss: 4.263 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5170552730560303
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.503 Vali Acc: 0.400 Test Loss: 4.503 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1293891
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8836095333099365
Epoch: 1, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5109610557556152
Epoch: 2, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.620790958404541
Epoch: 3, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.555647611618042
Epoch: 4, Steps: 2 | Train Loss: 0.635 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5302166938781738
Epoch: 5, Steps: 2 | Train Loss: 0.621 Vali Loss: 1.665 Vali Acc: 0.333 Test Loss: 1.665 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5932612419128418
Epoch: 6, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.477 Vali Acc: 0.200 Test Loss: 1.477 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5448877811431885
Epoch: 7, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.884 Vali Acc: 0.200 Test Loss: 1.884 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5330743789672852
Epoch: 8, Steps: 2 | Train Loss: 0.129 Vali Loss: 2.294 Vali Acc: 0.267 Test Loss: 2.294 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5515460968017578
Epoch: 9, Steps: 2 | Train Loss: 0.185 Vali Loss: 2.696 Vali Acc: 0.400 Test Loss: 2.696 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399973).  Saving model ...
Epoch: 10 cost time: 0.5298449993133545
Epoch: 10, Steps: 2 | Train Loss: 0.122 Vali Loss: 2.983 Vali Acc: 0.333 Test Loss: 2.983 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4924328327178955
Epoch: 11, Steps: 2 | Train Loss: 0.029 Vali Loss: 2.339 Vali Acc: 0.200 Test Loss: 2.339 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5080580711364746
Epoch: 12, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.133 Vali Acc: 0.133 Test Loss: 3.133 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5260653495788574
Epoch: 13, Steps: 2 | Train Loss: 0.052 Vali Loss: 3.835 Vali Acc: 0.200 Test Loss: 3.835 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.48583149909973145
Epoch: 14, Steps: 2 | Train Loss: 0.010 Vali Loss: 3.453 Vali Acc: 0.200 Test Loss: 3.453 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5428266525268555
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.350 Vali Acc: 0.267 Test Loss: 3.350 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5319457054138184
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.196 Vali Acc: 0.400 Test Loss: 4.196 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5324540138244629
Epoch: 17, Steps: 2 | Train Loss: 0.006 Vali Loss: 4.796 Vali Acc: 0.400 Test Loss: 4.796 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6030731201171875
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.926 Vali Acc: 0.333 Test Loss: 4.926 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5627708435058594
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.345 Vali Acc: 0.267 Test Loss: 5.345 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1293891
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.038661003112793
Epoch: 1, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5691428184509277
Epoch: 2, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.577282190322876
Epoch: 3, Steps: 2 | Train Loss: 0.780 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5495498180389404
Epoch: 4, Steps: 2 | Train Loss: 0.525 Vali Loss: 1.524 Vali Acc: 0.333 Test Loss: 1.524 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5253803730010986
Epoch: 5, Steps: 2 | Train Loss: 0.164 Vali Loss: 1.706 Vali Acc: 0.067 Test Loss: 1.706 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5692138671875
Epoch: 6, Steps: 2 | Train Loss: 0.062 Vali Loss: 2.000 Vali Acc: 0.333 Test Loss: 2.000 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5664072036743164
Epoch: 7, Steps: 2 | Train Loss: 0.019 Vali Loss: 2.437 Vali Acc: 0.333 Test Loss: 2.437 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6087653636932373
Epoch: 8, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.305 Vali Acc: 0.333 Test Loss: 3.305 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5820648670196533
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.209 Vali Acc: 0.400 Test Loss: 4.209 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5948107242584229
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.957 Vali Acc: 0.400 Test Loss: 4.957 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5563814640045166
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.563 Vali Acc: 0.400 Test Loss: 5.563 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5797853469848633
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.081 Vali Acc: 0.400 Test Loss: 6.081 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5850605964660645
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.528 Vali Acc: 0.400 Test Loss: 6.528 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1162819
model size : 6.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0173046588897705
Epoch: 1, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5474600791931152
Epoch: 2, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5099737644195557
Epoch: 3, Steps: 2 | Train Loss: 0.836 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5589993000030518
Epoch: 4, Steps: 2 | Train Loss: 0.554 Vali Loss: 1.376 Vali Acc: 0.400 Test Loss: 1.376 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5354268550872803
Epoch: 5, Steps: 2 | Train Loss: 0.215 Vali Loss: 1.526 Vali Acc: 0.067 Test Loss: 1.526 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5679483413696289
Epoch: 6, Steps: 2 | Train Loss: 0.069 Vali Loss: 1.718 Vali Acc: 0.333 Test Loss: 1.718 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5321557521820068
Epoch: 7, Steps: 2 | Train Loss: 0.025 Vali Loss: 2.279 Vali Acc: 0.400 Test Loss: 2.279 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5633203983306885
Epoch: 8, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.960 Vali Acc: 0.400 Test Loss: 2.960 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6117699146270752
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.476 Vali Acc: 0.400 Test Loss: 3.476 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5361950397491455
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.888 Vali Acc: 0.400 Test Loss: 3.888 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4971444606781006
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.235 Vali Acc: 0.400 Test Loss: 4.235 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5266177654266357
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.534 Vali Acc: 0.400 Test Loss: 4.534 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5491178035736084
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.803 Vali Acc: 0.333 Test Loss: 4.803 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1162819
model size : 6.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.061383008956909
Epoch: 1, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.581341028213501
Epoch: 2, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5302929878234863
Epoch: 3, Steps: 2 | Train Loss: 0.841 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5533297061920166
Epoch: 4, Steps: 2 | Train Loss: 0.606 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5678324699401855
Epoch: 5, Steps: 2 | Train Loss: 0.262 Vali Loss: 1.500 Vali Acc: 0.200 Test Loss: 1.500 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5805082321166992
Epoch: 6, Steps: 2 | Train Loss: 0.109 Vali Loss: 1.627 Vali Acc: 0.200 Test Loss: 1.627 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5768487453460693
Epoch: 7, Steps: 2 | Train Loss: 0.044 Vali Loss: 2.251 Vali Acc: 0.333 Test Loss: 2.251 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.581214427947998
Epoch: 8, Steps: 2 | Train Loss: 0.017 Vali Loss: 2.458 Vali Acc: 0.333 Test Loss: 2.458 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5733814239501953
Epoch: 9, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.678 Vali Acc: 0.333 Test Loss: 2.678 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5565824508666992
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.072 Vali Acc: 0.200 Test Loss: 3.072 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5442681312561035
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.520 Vali Acc: 0.200 Test Loss: 3.520 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5718317031860352
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.934 Vali Acc: 0.200 Test Loss: 3.934 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5485572814941406
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.297 Vali Acc: 0.200 Test Loss: 4.297 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1162819
model size : 6.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.027869462966919
Epoch: 1, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.49926042556762695
Epoch: 2, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5448200702667236
Epoch: 3, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5347552299499512
Epoch: 4, Steps: 2 | Train Loss: 0.732 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5399160385131836
Epoch: 5, Steps: 2 | Train Loss: 0.366 Vali Loss: 1.472 Vali Acc: 0.200 Test Loss: 1.472 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5469810962677002
Epoch: 6, Steps: 2 | Train Loss: 0.261 Vali Loss: 1.400 Vali Acc: 0.200 Test Loss: 1.400 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.533278226852417
Epoch: 7, Steps: 2 | Train Loss: 0.135 Vali Loss: 1.710 Vali Acc: 0.333 Test Loss: 1.710 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5586071014404297
Epoch: 8, Steps: 2 | Train Loss: 0.073 Vali Loss: 1.781 Vali Acc: 0.333 Test Loss: 1.781 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.530095100402832
Epoch: 9, Steps: 2 | Train Loss: 0.030 Vali Loss: 2.320 Vali Acc: 0.200 Test Loss: 2.320 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5153090953826904
Epoch: 10, Steps: 2 | Train Loss: 0.081 Vali Loss: 2.763 Vali Acc: 0.200 Test Loss: 2.763 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4849522113800049
Epoch: 11, Steps: 2 | Train Loss: 0.014 Vali Loss: 2.325 Vali Acc: 0.067 Test Loss: 2.325 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.506544828414917
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.490 Vali Acc: 0.267 Test Loss: 2.490 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1162819
model size : 6.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0315136909484863
Epoch: 1, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5959961414337158
Epoch: 2, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6333024501800537
Epoch: 3, Steps: 2 | Train Loss: 0.658 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6631972789764404
Epoch: 4, Steps: 2 | Train Loss: 0.473 Vali Loss: 1.328 Vali Acc: 0.467 Test Loss: 1.328 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466653).  Saving model ...
Epoch: 5 cost time: 0.6035034656524658
Epoch: 5, Steps: 2 | Train Loss: 0.256 Vali Loss: 1.641 Vali Acc: 0.333 Test Loss: 1.641 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.580176830291748
Epoch: 6, Steps: 2 | Train Loss: 0.093 Vali Loss: 1.708 Vali Acc: 0.267 Test Loss: 1.708 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6060009002685547
Epoch: 7, Steps: 2 | Train Loss: 0.022 Vali Loss: 2.352 Vali Acc: 0.133 Test Loss: 2.352 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6001486778259277
Epoch: 8, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.853 Vali Acc: 0.133 Test Loss: 2.853 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5368621349334717
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.389 Vali Acc: 0.267 Test Loss: 3.389 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.564784049987793
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.919 Vali Acc: 0.333 Test Loss: 3.919 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5816736221313477
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.445 Vali Acc: 0.333 Test Loss: 4.445 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5773599147796631
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.936 Vali Acc: 0.333 Test Loss: 4.936 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5837845802307129
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.386 Vali Acc: 0.333 Test Loss: 5.386 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5715606212615967
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.792 Vali Acc: 0.333 Test Loss: 5.792 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1097283
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0124127864837646
Epoch: 1, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5708894729614258
Epoch: 2, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5981051921844482
Epoch: 3, Steps: 2 | Train Loss: 0.727 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5802569389343262
Epoch: 4, Steps: 2 | Train Loss: 0.598 Vali Loss: 1.275 Vali Acc: 0.533 Test Loss: 1.275 Test Acc: 0.533
Validation loss decreased (-0.399988 --> -0.533321).  Saving model ...
Epoch: 5 cost time: 0.550055980682373
Epoch: 5, Steps: 2 | Train Loss: 0.335 Vali Loss: 1.660 Vali Acc: 0.533 Test Loss: 1.660 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5417492389678955
Epoch: 6, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.547 Vali Acc: 0.267 Test Loss: 1.547 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5542593002319336
Epoch: 7, Steps: 2 | Train Loss: 0.052 Vali Loss: 2.026 Vali Acc: 0.200 Test Loss: 2.026 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5884230136871338
Epoch: 8, Steps: 2 | Train Loss: 0.020 Vali Loss: 2.269 Vali Acc: 0.200 Test Loss: 2.269 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5488975048065186
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.810 Vali Acc: 0.267 Test Loss: 2.810 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6034228801727295
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.450 Vali Acc: 0.267 Test Loss: 3.450 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5685803890228271
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.065 Vali Acc: 0.267 Test Loss: 4.065 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6265320777893066
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.629 Vali Acc: 0.267 Test Loss: 4.629 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6600229740142822
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.127 Vali Acc: 0.333 Test Loss: 5.127 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6952590942382812
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.576 Vali Acc: 0.333 Test Loss: 5.576 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1097283
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.203806161880493
Epoch: 1, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6357705593109131
Epoch: 2, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6208462715148926
Epoch: 3, Steps: 2 | Train Loss: 0.785 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.619492769241333
Epoch: 4, Steps: 2 | Train Loss: 0.642 Vali Loss: 1.255 Vali Acc: 0.400 Test Loss: 1.255 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.5309514999389648
Epoch: 5, Steps: 2 | Train Loss: 0.396 Vali Loss: 1.676 Vali Acc: 0.533 Test Loss: 1.676 Test Acc: 0.533
Validation loss decreased (-0.399987 --> -0.533317).  Saving model ...
Epoch: 6 cost time: 0.5449357032775879
Epoch: 6, Steps: 2 | Train Loss: 0.210 Vali Loss: 1.600 Vali Acc: 0.467 Test Loss: 1.600 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5413987636566162
Epoch: 7, Steps: 2 | Train Loss: 0.078 Vali Loss: 2.050 Vali Acc: 0.200 Test Loss: 2.050 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5527389049530029
Epoch: 8, Steps: 2 | Train Loss: 0.069 Vali Loss: 2.083 Vali Acc: 0.200 Test Loss: 2.083 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6178843975067139
Epoch: 9, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.908 Vali Acc: 0.333 Test Loss: 2.908 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5890696048736572
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.072 Vali Acc: 0.400 Test Loss: 4.072 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5604934692382812
Epoch: 11, Steps: 2 | Train Loss: 0.003 Vali Loss: 4.603 Vali Acc: 0.400 Test Loss: 4.603 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5905659198760986
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.806 Vali Acc: 0.400 Test Loss: 4.806 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5821442604064941
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.954 Vali Acc: 0.400 Test Loss: 4.954 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.587334394454956
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.075 Vali Acc: 0.400 Test Loss: 5.075 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.599478006362915
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.200 Vali Acc: 0.400 Test Loss: 5.200 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1097283
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.345324993133545
Epoch: 1, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5206663608551025
Epoch: 2, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5340046882629395
Epoch: 3, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5619471073150635
Epoch: 4, Steps: 2 | Train Loss: 0.802 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.581620454788208
Epoch: 5, Steps: 2 | Train Loss: 0.525 Vali Loss: 1.674 Vali Acc: 0.400 Test Loss: 1.674 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399983).  Saving model ...
Epoch: 6 cost time: 0.5955297946929932
Epoch: 6, Steps: 2 | Train Loss: 0.398 Vali Loss: 1.530 Vali Acc: 0.467 Test Loss: 1.530 Test Acc: 0.467
Validation loss decreased (-0.399983 --> -0.466651).  Saving model ...
Epoch: 7 cost time: 0.5413980484008789
Epoch: 7, Steps: 2 | Train Loss: 0.221 Vali Loss: 1.776 Vali Acc: 0.200 Test Loss: 1.776 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5608577728271484
Epoch: 8, Steps: 2 | Train Loss: 0.192 Vali Loss: 1.677 Vali Acc: 0.200 Test Loss: 1.677 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5804996490478516
Epoch: 9, Steps: 2 | Train Loss: 0.057 Vali Loss: 2.273 Vali Acc: 0.267 Test Loss: 2.273 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5571930408477783
Epoch: 10, Steps: 2 | Train Loss: 0.027 Vali Loss: 2.819 Vali Acc: 0.200 Test Loss: 2.819 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5561203956604004
Epoch: 11, Steps: 2 | Train Loss: 0.031 Vali Loss: 2.651 Vali Acc: 0.200 Test Loss: 2.651 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5848574638366699
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.322 Vali Acc: 0.133 Test Loss: 2.322 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5813314914703369
Epoch: 13, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.467 Vali Acc: 0.200 Test Loss: 2.467 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5878791809082031
Epoch: 14, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.652 Vali Acc: 0.133 Test Loss: 2.652 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.563946008682251
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.169 Vali Acc: 0.267 Test Loss: 3.169 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.544184684753418
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.722 Vali Acc: 0.200 Test Loss: 3.722 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1097283
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.307471513748169
Epoch: 1, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6088089942932129
Epoch: 2, Steps: 2 | Train Loss: 0.817 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6069595813751221
Epoch: 3, Steps: 2 | Train Loss: 0.697 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6177685260772705
Epoch: 4, Steps: 2 | Train Loss: 0.358 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6205880641937256
Epoch: 5, Steps: 2 | Train Loss: 0.284 Vali Loss: 1.442 Vali Acc: 0.400 Test Loss: 1.442 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6148052215576172
Epoch: 6, Steps: 2 | Train Loss: 0.088 Vali Loss: 1.577 Vali Acc: 0.400 Test Loss: 1.577 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6190919876098633
Epoch: 7, Steps: 2 | Train Loss: 0.031 Vali Loss: 2.077 Vali Acc: 0.533 Test Loss: 2.077 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533313).  Saving model ...
Epoch: 8 cost time: 0.607144832611084
Epoch: 8, Steps: 2 | Train Loss: 0.014 Vali Loss: 2.566 Vali Acc: 0.333 Test Loss: 2.566 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.639998197555542
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.337 Vali Acc: 0.333 Test Loss: 3.337 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.644390344619751
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.553 Vali Acc: 0.200 Test Loss: 4.553 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6052045822143555
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.767 Vali Acc: 0.200 Test Loss: 5.767 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6371328830718994
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 6.721 Vali Acc: 0.200 Test Loss: 6.721 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6155824661254883
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 7.289 Vali Acc: 0.200 Test Loss: 7.289 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6350469589233398
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.680 Vali Acc: 0.200 Test Loss: 7.680 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6806068420410156
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.926 Vali Acc: 0.200 Test Loss: 7.926 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6993370056152344
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.109 Vali Acc: 0.200 Test Loss: 8.109 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6470773220062256
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.264 Vali Acc: 0.200 Test Loss: 8.264 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1064515
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.367418050765991
Epoch: 1, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5618188381195068
Epoch: 2, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.597769021987915
Epoch: 3, Steps: 2 | Train Loss: 0.764 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6187183856964111
Epoch: 4, Steps: 2 | Train Loss: 0.394 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5814182758331299
Epoch: 5, Steps: 2 | Train Loss: 0.270 Vali Loss: 1.284 Vali Acc: 0.533 Test Loss: 1.284 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533320).  Saving model ...
Epoch: 6 cost time: 0.6108338832855225
Epoch: 6, Steps: 2 | Train Loss: 0.117 Vali Loss: 1.465 Vali Acc: 0.333 Test Loss: 1.465 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5753576755523682
Epoch: 7, Steps: 2 | Train Loss: 0.035 Vali Loss: 2.023 Vali Acc: 0.400 Test Loss: 2.023 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6052312850952148
Epoch: 8, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.725 Vali Acc: 0.400 Test Loss: 2.725 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6458282470703125
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.678 Vali Acc: 0.333 Test Loss: 3.678 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6548798084259033
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.589 Vali Acc: 0.200 Test Loss: 4.589 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6307010650634766
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 5.259 Vali Acc: 0.200 Test Loss: 5.259 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.659074068069458
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.746 Vali Acc: 0.200 Test Loss: 5.746 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6483750343322754
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.081 Vali Acc: 0.200 Test Loss: 6.081 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6105220317840576
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.315 Vali Acc: 0.200 Test Loss: 6.315 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6337239742279053
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.482 Vali Acc: 0.200 Test Loss: 6.482 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1064515
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.390354633331299
Epoch: 1, Steps: 2 | Train Loss: 0.970 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6203842163085938
Epoch: 2, Steps: 2 | Train Loss: 0.879 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5915024280548096
Epoch: 3, Steps: 2 | Train Loss: 0.794 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6294302940368652
Epoch: 4, Steps: 2 | Train Loss: 0.449 Vali Loss: 1.291 Vali Acc: 0.267 Test Loss: 1.291 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6409130096435547
Epoch: 5, Steps: 2 | Train Loss: 0.345 Vali Loss: 1.370 Vali Acc: 0.467 Test Loss: 1.370 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466653).  Saving model ...
Epoch: 6 cost time: 0.6358795166015625
Epoch: 6, Steps: 2 | Train Loss: 0.186 Vali Loss: 1.563 Vali Acc: 0.267 Test Loss: 1.563 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6380274295806885
Epoch: 7, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.884 Vali Acc: 0.267 Test Loss: 1.884 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6213796138763428
Epoch: 8, Steps: 2 | Train Loss: 0.021 Vali Loss: 2.488 Vali Acc: 0.333 Test Loss: 2.488 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6526448726654053
Epoch: 9, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.315 Vali Acc: 0.267 Test Loss: 3.315 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6528627872467041
Epoch: 10, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.660 Vali Acc: 0.200 Test Loss: 3.660 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6471037864685059
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.922 Vali Acc: 0.200 Test Loss: 3.922 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6502363681793213
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.146 Vali Acc: 0.267 Test Loss: 4.146 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6056180000305176
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.347 Vali Acc: 0.267 Test Loss: 4.347 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6532816886901855
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.513 Vali Acc: 0.267 Test Loss: 4.513 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6056416034698486
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.650 Vali Acc: 0.267 Test Loss: 4.650 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1064515
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3448314666748047
Epoch: 1, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5834174156188965
Epoch: 2, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5681607723236084
Epoch: 3, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5879864692687988
Epoch: 4, Steps: 2 | Train Loss: 0.546 Vali Loss: 1.271 Vali Acc: 0.200 Test Loss: 1.271 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5661938190460205
Epoch: 5, Steps: 2 | Train Loss: 0.445 Vali Loss: 1.316 Vali Acc: 0.333 Test Loss: 1.316 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5744249820709229
Epoch: 6, Steps: 2 | Train Loss: 0.261 Vali Loss: 1.437 Vali Acc: 0.400 Test Loss: 1.437 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5770621299743652
Epoch: 7, Steps: 2 | Train Loss: 0.169 Vali Loss: 1.571 Vali Acc: 0.267 Test Loss: 1.571 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5772726535797119
Epoch: 8, Steps: 2 | Train Loss: 0.064 Vali Loss: 1.930 Vali Acc: 0.200 Test Loss: 1.930 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5848791599273682
Epoch: 9, Steps: 2 | Train Loss: 0.034 Vali Loss: 2.077 Vali Acc: 0.200 Test Loss: 2.077 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5748655796051025
Epoch: 10, Steps: 2 | Train Loss: 0.020 Vali Loss: 2.041 Vali Acc: 0.267 Test Loss: 2.041 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5703842639923096
Epoch: 11, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.654 Vali Acc: 0.267 Test Loss: 2.654 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1064515
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.268637180328369
Epoch: 1, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6361966133117676
Epoch: 2, Steps: 2 | Train Loss: 0.950 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5814213752746582
Epoch: 3, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5811126232147217
Epoch: 4, Steps: 2 | Train Loss: 0.587 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5743744373321533
Epoch: 5, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6034657955169678
Epoch: 6, Steps: 2 | Train Loss: 0.211 Vali Loss: 1.325 Vali Acc: 0.267 Test Loss: 1.325 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6245505809783936
Epoch: 7, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.352 Vali Acc: 0.467 Test Loss: 1.352 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6474857330322266
Epoch: 8, Steps: 2 | Train Loss: 0.066 Vali Loss: 1.475 Vali Acc: 0.333 Test Loss: 1.475 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5761923789978027
Epoch: 9, Steps: 2 | Train Loss: 0.019 Vali Loss: 1.839 Vali Acc: 0.333 Test Loss: 1.839 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6547038555145264
Epoch: 10, Steps: 2 | Train Loss: 0.006 Vali Loss: 2.233 Vali Acc: 0.400 Test Loss: 2.233 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6391551494598389
Epoch: 11, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.556 Vali Acc: 0.333 Test Loss: 2.556 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1023811
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3295347690582275
Epoch: 1, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5187735557556152
Epoch: 2, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5247213840484619
Epoch: 3, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5099096298217773
Epoch: 4, Steps: 2 | Train Loss: 0.662 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5473024845123291
Epoch: 5, Steps: 2 | Train Loss: 0.401 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5306916236877441
Epoch: 6, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.48032474517822266
Epoch: 7, Steps: 2 | Train Loss: 0.191 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5430905818939209
Epoch: 8, Steps: 2 | Train Loss: 0.095 Vali Loss: 1.269 Vali Acc: 0.533 Test Loss: 1.269 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533321).  Saving model ...
Epoch: 9 cost time: 0.5190553665161133
Epoch: 9, Steps: 2 | Train Loss: 0.035 Vali Loss: 1.531 Vali Acc: 0.400 Test Loss: 1.531 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5368046760559082
Epoch: 10, Steps: 2 | Train Loss: 0.011 Vali Loss: 1.888 Vali Acc: 0.400 Test Loss: 1.888 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5409467220306396
Epoch: 11, Steps: 2 | Train Loss: 0.006 Vali Loss: 2.119 Vali Acc: 0.333 Test Loss: 2.119 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5028369426727295
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.149 Vali Acc: 0.333 Test Loss: 2.149 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5422971248626709
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.201 Vali Acc: 0.333 Test Loss: 2.201 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.534198522567749
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.283 Vali Acc: 0.400 Test Loss: 2.283 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5128135681152344
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.377 Vali Acc: 0.467 Test Loss: 2.377 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5306649208068848
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.443 Vali Acc: 0.467 Test Loss: 2.443 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4936068058013916
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.533 Vali Acc: 0.467 Test Loss: 2.533 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5138602256774902
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.600 Vali Acc: 0.467 Test Loss: 2.600 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1023811
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.388040065765381
Epoch: 1, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5496129989624023
Epoch: 2, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5186748504638672
Epoch: 3, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5425839424133301
Epoch: 4, Steps: 2 | Train Loss: 0.732 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.5483005046844482
Epoch: 5, Steps: 2 | Train Loss: 0.420 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5272607803344727
Epoch: 6, Steps: 2 | Train Loss: 0.338 Vali Loss: 1.347 Vali Acc: 0.267 Test Loss: 1.347 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.55739426612854
Epoch: 7, Steps: 2 | Train Loss: 0.249 Vali Loss: 1.339 Vali Acc: 0.333 Test Loss: 1.339 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5428953170776367
Epoch: 8, Steps: 2 | Train Loss: 0.127 Vali Loss: 1.383 Vali Acc: 0.467 Test Loss: 1.383 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.57547926902771
Epoch: 9, Steps: 2 | Train Loss: 0.065 Vali Loss: 1.579 Vali Acc: 0.333 Test Loss: 1.579 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.557248592376709
Epoch: 10, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.866 Vali Acc: 0.333 Test Loss: 1.866 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5569069385528564
Epoch: 11, Steps: 2 | Train Loss: 0.013 Vali Loss: 2.138 Vali Acc: 0.200 Test Loss: 2.138 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5746767520904541
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.219 Vali Acc: 0.200 Test Loss: 2.219 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5604593753814697
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.345 Vali Acc: 0.200 Test Loss: 2.345 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5580692291259766
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.479 Vali Acc: 0.200 Test Loss: 2.479 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1023811
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.225067377090454
Epoch: 1, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5835819244384766
Epoch: 2, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5538020133972168
Epoch: 3, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5652446746826172
Epoch: 4, Steps: 2 | Train Loss: 0.801 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5903067588806152
Epoch: 5, Steps: 2 | Train Loss: 0.558 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.604135274887085
Epoch: 6, Steps: 2 | Train Loss: 0.422 Vali Loss: 1.329 Vali Acc: 0.267 Test Loss: 1.329 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5654146671295166
Epoch: 7, Steps: 2 | Train Loss: 0.356 Vali Loss: 1.403 Vali Acc: 0.267 Test Loss: 1.403 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5491557121276855
Epoch: 8, Steps: 2 | Train Loss: 0.205 Vali Loss: 1.410 Vali Acc: 0.333 Test Loss: 1.410 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5644340515136719
Epoch: 9, Steps: 2 | Train Loss: 0.157 Vali Loss: 1.571 Vali Acc: 0.267 Test Loss: 1.571 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.576502799987793
Epoch: 10, Steps: 2 | Train Loss: 0.075 Vali Loss: 1.719 Vali Acc: 0.267 Test Loss: 1.719 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5647194385528564
Epoch: 11, Steps: 2 | Train Loss: 0.075 Vali Loss: 2.125 Vali Acc: 0.200 Test Loss: 2.125 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5354907512664795
Epoch: 12, Steps: 2 | Train Loss: 0.030 Vali Loss: 2.018 Vali Acc: 0.200 Test Loss: 2.018 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1023811
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3107495307922363
Epoch: 1, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5558128356933594
Epoch: 2, Steps: 2 | Train Loss: 0.838 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5785367488861084
Epoch: 3, Steps: 2 | Train Loss: 0.719 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5462620258331299
Epoch: 4, Steps: 2 | Train Loss: 0.525 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5433719158172607
Epoch: 5, Steps: 2 | Train Loss: 0.301 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5552489757537842
Epoch: 6, Steps: 2 | Train Loss: 0.174 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5965545177459717
Epoch: 7, Steps: 2 | Train Loss: 0.096 Vali Loss: 1.492 Vali Acc: 0.400 Test Loss: 1.492 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5492806434631348
Epoch: 8, Steps: 2 | Train Loss: 0.038 Vali Loss: 1.496 Vali Acc: 0.467 Test Loss: 1.496 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466652).  Saving model ...
Epoch: 9 cost time: 0.544877290725708
Epoch: 9, Steps: 2 | Train Loss: 0.013 Vali Loss: 1.795 Vali Acc: 0.467 Test Loss: 1.795 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5628831386566162
Epoch: 10, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.148 Vali Acc: 0.467 Test Loss: 2.148 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5424270629882812
Epoch: 11, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.487 Vali Acc: 0.400 Test Loss: 2.487 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5658266544342041
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.808 Vali Acc: 0.400 Test Loss: 2.808 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5984311103820801
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.108 Vali Acc: 0.400 Test Loss: 3.108 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.567662239074707
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.388 Vali Acc: 0.333 Test Loss: 3.388 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5262176990509033
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.639 Vali Acc: 0.333 Test Loss: 3.639 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5351722240447998
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.867 Vali Acc: 0.267 Test Loss: 3.867 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5647261142730713
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.073 Vali Acc: 0.200 Test Loss: 4.073 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5778934955596924
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.226 Vali Acc: 0.200 Test Loss: 4.226 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 761667
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.422606945037842
Epoch: 1, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5558862686157227
Epoch: 2, Steps: 2 | Train Loss: 0.902 Vali Loss: 1.194 Vali Acc: 0.133 Test Loss: 1.194 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5725851058959961
Epoch: 3, Steps: 2 | Train Loss: 0.804 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5743567943572998
Epoch: 4, Steps: 2 | Train Loss: 0.580 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5754671096801758
Epoch: 5, Steps: 2 | Train Loss: 0.377 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.58636474609375
Epoch: 6, Steps: 2 | Train Loss: 0.221 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5653016567230225
Epoch: 7, Steps: 2 | Train Loss: 0.127 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5748798847198486
Epoch: 8, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.284 Vali Acc: 0.600 Test Loss: 1.284 Test Acc: 0.600
Validation loss decreased (-0.399988 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 0.6241130828857422
Epoch: 9, Steps: 2 | Train Loss: 0.035 Vali Loss: 1.539 Vali Acc: 0.400 Test Loss: 1.539 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.554389238357544
Epoch: 10, Steps: 2 | Train Loss: 0.010 Vali Loss: 1.898 Vali Acc: 0.400 Test Loss: 1.898 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6077797412872314
Epoch: 11, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.222 Vali Acc: 0.333 Test Loss: 2.222 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5917377471923828
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.479 Vali Acc: 0.333 Test Loss: 2.479 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5829718112945557
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.673 Vali Acc: 0.333 Test Loss: 2.673 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5836570262908936
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.814 Vali Acc: 0.333 Test Loss: 2.814 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5342271327972412
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.940 Vali Acc: 0.333 Test Loss: 2.940 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5778155326843262
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.077 Vali Acc: 0.333 Test Loss: 3.077 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5602216720581055
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.167 Vali Acc: 0.333 Test Loss: 3.167 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5894904136657715
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.242 Vali Acc: 0.333 Test Loss: 3.242 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 761667
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.289520502090454
Epoch: 1, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5362265110015869
Epoch: 2, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5621893405914307
Epoch: 3, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5622844696044922
Epoch: 4, Steps: 2 | Train Loss: 0.652 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5414376258850098
Epoch: 5, Steps: 2 | Train Loss: 0.457 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.5478999614715576
Epoch: 6, Steps: 2 | Train Loss: 0.265 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.545274019241333
Epoch: 7, Steps: 2 | Train Loss: 0.198 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5604779720306396
Epoch: 8, Steps: 2 | Train Loss: 0.111 Vali Loss: 1.411 Vali Acc: 0.400 Test Loss: 1.411 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5621387958526611
Epoch: 9, Steps: 2 | Train Loss: 0.046 Vali Loss: 1.665 Vali Acc: 0.333 Test Loss: 1.665 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5682077407836914
Epoch: 10, Steps: 2 | Train Loss: 0.022 Vali Loss: 1.872 Vali Acc: 0.333 Test Loss: 1.872 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5799851417541504
Epoch: 11, Steps: 2 | Train Loss: 0.007 Vali Loss: 2.009 Vali Acc: 0.467 Test Loss: 2.009 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466647).  Saving model ...
Epoch: 12 cost time: 0.5735762119293213
Epoch: 12, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.215 Vali Acc: 0.400 Test Loss: 2.215 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5679428577423096
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.444 Vali Acc: 0.333 Test Loss: 2.444 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5597915649414062
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.678 Vali Acc: 0.267 Test Loss: 2.678 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5664594173431396
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.911 Vali Acc: 0.267 Test Loss: 2.911 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5879533290863037
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.148 Vali Acc: 0.267 Test Loss: 3.148 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5894153118133545
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.356 Vali Acc: 0.267 Test Loss: 3.356 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.56258225440979
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.534 Vali Acc: 0.267 Test Loss: 3.534 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5555310249328613
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.683 Vali Acc: 0.267 Test Loss: 3.683 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5486805438995361
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.791 Vali Acc: 0.267 Test Loss: 3.791 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5306355953216553
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.859 Vali Acc: 0.267 Test Loss: 3.859 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 761667
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2504749298095703
Epoch: 1, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.5518333911895752
Epoch: 2, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5351765155792236
Epoch: 3, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5631356239318848
Epoch: 4, Steps: 2 | Train Loss: 0.791 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5423309803009033
Epoch: 5, Steps: 2 | Train Loss: 0.621 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5674681663513184
Epoch: 6, Steps: 2 | Train Loss: 0.403 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5947232246398926
Epoch: 7, Steps: 2 | Train Loss: 0.314 Vali Loss: 1.404 Vali Acc: 0.267 Test Loss: 1.404 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5556128025054932
Epoch: 8, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.461 Vali Acc: 0.267 Test Loss: 1.461 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6243453025817871
Epoch: 9, Steps: 2 | Train Loss: 0.131 Vali Loss: 1.566 Vali Acc: 0.267 Test Loss: 1.566 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5679121017456055
Epoch: 10, Steps: 2 | Train Loss: 0.101 Vali Loss: 1.688 Vali Acc: 0.267 Test Loss: 1.688 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5918896198272705
Epoch: 11, Steps: 2 | Train Loss: 0.039 Vali Loss: 1.722 Vali Acc: 0.267 Test Loss: 1.722 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5939233303070068
Epoch: 12, Steps: 2 | Train Loss: 0.025 Vali Loss: 1.937 Vali Acc: 0.267 Test Loss: 1.937 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.573265552520752
Epoch: 13, Steps: 2 | Train Loss: 0.013 Vali Loss: 2.436 Vali Acc: 0.267 Test Loss: 2.436 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5719821453094482
Epoch: 14, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.787 Vali Acc: 0.333 Test Loss: 2.787 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 761667
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.241962194442749
Epoch: 1, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5626356601715088
Epoch: 2, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5581982135772705
Epoch: 3, Steps: 2 | Train Loss: 0.825 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 0.5637252330780029
Epoch: 4, Steps: 2 | Train Loss: 0.586 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5736186504364014
Epoch: 5, Steps: 2 | Train Loss: 0.382 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5640358924865723
Epoch: 6, Steps: 2 | Train Loss: 0.257 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.6070694923400879
Epoch: 7, Steps: 2 | Train Loss: 0.096 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5994100570678711
Epoch: 8, Steps: 2 | Train Loss: 0.053 Vali Loss: 1.782 Vali Acc: 0.400 Test Loss: 1.782 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6357438564300537
Epoch: 9, Steps: 2 | Train Loss: 0.020 Vali Loss: 2.066 Vali Acc: 0.400 Test Loss: 2.066 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6184618473052979
Epoch: 10, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.276 Vali Acc: 0.400 Test Loss: 2.276 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5604259967803955
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.451 Vali Acc: 0.400 Test Loss: 2.451 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5633704662322998
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.616 Vali Acc: 0.333 Test Loss: 2.616 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5677340030670166
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.752 Vali Acc: 0.333 Test Loss: 2.752 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5607566833496094
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.891 Vali Acc: 0.333 Test Loss: 2.891 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5646035671234131
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.003 Vali Acc: 0.333 Test Loss: 3.003 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5873963832855225
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.101 Vali Acc: 0.333 Test Loss: 3.101 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 630595
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2601358890533447
Epoch: 1, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5629804134368896
Epoch: 2, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5307352542877197
Epoch: 3, Steps: 2 | Train Loss: 0.842 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5760369300842285
Epoch: 4, Steps: 2 | Train Loss: 0.605 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5674042701721191
Epoch: 5, Steps: 2 | Train Loss: 0.423 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.580869197845459
Epoch: 6, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5878853797912598
Epoch: 7, Steps: 2 | Train Loss: 0.129 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5722177028656006
Epoch: 8, Steps: 2 | Train Loss: 0.071 Vali Loss: 1.542 Vali Acc: 0.400 Test Loss: 1.542 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5696675777435303
Epoch: 9, Steps: 2 | Train Loss: 0.031 Vali Loss: 1.825 Vali Acc: 0.400 Test Loss: 1.825 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5596945285797119
Epoch: 10, Steps: 2 | Train Loss: 0.011 Vali Loss: 1.844 Vali Acc: 0.400 Test Loss: 1.844 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5834081172943115
Epoch: 11, Steps: 2 | Train Loss: 0.003 Vali Loss: 1.905 Vali Acc: 0.333 Test Loss: 1.905 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5705811977386475
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.038 Vali Acc: 0.333 Test Loss: 2.038 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5842287540435791
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.333 Test Loss: 2.158 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6115481853485107
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.290 Vali Acc: 0.333 Test Loss: 2.290 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 630595
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4394335746765137
Epoch: 1, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5094623565673828
Epoch: 2, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5313339233398438
Epoch: 3, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5205411911010742
Epoch: 4, Steps: 2 | Train Loss: 0.685 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.502349853515625
Epoch: 5, Steps: 2 | Train Loss: 0.483 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5224390029907227
Epoch: 6, Steps: 2 | Train Loss: 0.384 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5275921821594238
Epoch: 7, Steps: 2 | Train Loss: 0.202 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.513953447341919
Epoch: 8, Steps: 2 | Train Loss: 0.147 Vali Loss: 1.451 Vali Acc: 0.467 Test Loss: 1.451 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5126667022705078
Epoch: 9, Steps: 2 | Train Loss: 0.060 Vali Loss: 1.704 Vali Acc: 0.467 Test Loss: 1.704 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5077090263366699
Epoch: 10, Steps: 2 | Train Loss: 0.028 Vali Loss: 1.765 Vali Acc: 0.467 Test Loss: 1.765 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5748755931854248
Epoch: 11, Steps: 2 | Train Loss: 0.015 Vali Loss: 1.895 Vali Acc: 0.267 Test Loss: 1.895 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5239176750183105
Epoch: 12, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.024 Vali Acc: 0.200 Test Loss: 2.024 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5246055126190186
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.182 Vali Acc: 0.333 Test Loss: 2.182 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5204205513000488
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.356 Vali Acc: 0.267 Test Loss: 2.356 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 630595
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.330021381378174
Epoch: 1, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5802955627441406
Epoch: 2, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.562340259552002
Epoch: 3, Steps: 2 | Train Loss: 0.945 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5501823425292969
Epoch: 4, Steps: 2 | Train Loss: 0.824 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6262049674987793
Epoch: 5, Steps: 2 | Train Loss: 0.665 Vali Loss: 1.277 Vali Acc: 0.333 Test Loss: 1.277 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5356318950653076
Epoch: 6, Steps: 2 | Train Loss: 0.534 Vali Loss: 1.311 Vali Acc: 0.200 Test Loss: 1.311 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5580661296844482
Epoch: 7, Steps: 2 | Train Loss: 0.317 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.5376901626586914
Epoch: 8, Steps: 2 | Train Loss: 0.231 Vali Loss: 1.530 Vali Acc: 0.267 Test Loss: 1.530 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5782632827758789
Epoch: 9, Steps: 2 | Train Loss: 0.155 Vali Loss: 1.700 Vali Acc: 0.333 Test Loss: 1.700 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5907611846923828
Epoch: 10, Steps: 2 | Train Loss: 0.098 Vali Loss: 1.855 Vali Acc: 0.267 Test Loss: 1.855 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5478212833404541
Epoch: 11, Steps: 2 | Train Loss: 0.080 Vali Loss: 1.963 Vali Acc: 0.200 Test Loss: 1.963 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5370655059814453
Epoch: 12, Steps: 2 | Train Loss: 0.020 Vali Loss: 1.947 Vali Acc: 0.200 Test Loss: 1.947 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5435628890991211
Epoch: 13, Steps: 2 | Train Loss: 0.011 Vali Loss: 2.105 Vali Acc: 0.200 Test Loss: 2.105 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5710508823394775
Epoch: 14, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.375 Vali Acc: 0.200 Test Loss: 2.375 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5556066036224365
Epoch: 15, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.561 Vali Acc: 0.200 Test Loss: 2.561 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5471415519714355
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.714 Vali Acc: 0.200 Test Loss: 2.714 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.546985387802124
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.846 Vali Acc: 0.200 Test Loss: 2.846 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 630595
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3153724670410156
Epoch: 1, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6013939380645752
Epoch: 2, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5887668132781982
Epoch: 3, Steps: 2 | Train Loss: 0.848 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5995931625366211
Epoch: 4, Steps: 2 | Train Loss: 0.611 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6120483875274658
Epoch: 5, Steps: 2 | Train Loss: 0.343 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5851025581359863
Epoch: 6, Steps: 2 | Train Loss: 0.260 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5784642696380615
Epoch: 7, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.429 Vali Acc: 0.333 Test Loss: 1.429 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5616166591644287
Epoch: 8, Steps: 2 | Train Loss: 0.028 Vali Loss: 1.671 Vali Acc: 0.333 Test Loss: 1.671 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5632503032684326
Epoch: 9, Steps: 2 | Train Loss: 0.013 Vali Loss: 1.761 Vali Acc: 0.400 Test Loss: 1.761 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.594393253326416
Epoch: 10, Steps: 2 | Train Loss: 0.003 Vali Loss: 1.918 Vali Acc: 0.467 Test Loss: 1.918 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5935969352722168
Epoch: 11, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.109 Vali Acc: 0.467 Test Loss: 2.109 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5475466251373291
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.330 Vali Acc: 0.533 Test Loss: 2.330 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533310).  Saving model ...
Epoch: 13 cost time: 0.6146900653839111
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.544 Vali Acc: 0.533 Test Loss: 2.544 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5719871520996094
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.743 Vali Acc: 0.533 Test Loss: 2.743 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.580951452255249
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.931 Vali Acc: 0.467 Test Loss: 2.931 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5407536029815674
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.098 Vali Acc: 0.400 Test Loss: 3.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5582611560821533
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.254 Vali Acc: 0.333 Test Loss: 3.254 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5461978912353516
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.385 Vali Acc: 0.333 Test Loss: 3.385 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5738837718963623
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.499 Vali Acc: 0.333 Test Loss: 3.499 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5792591571807861
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.597 Vali Acc: 0.333 Test Loss: 3.597 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5774636268615723
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.682 Vali Acc: 0.333 Test Loss: 3.682 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5749237537384033
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.754 Vali Acc: 0.333 Test Loss: 3.754 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 565059
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2136635780334473
Epoch: 1, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.512277364730835
Epoch: 2, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5124936103820801
Epoch: 3, Steps: 2 | Train Loss: 0.884 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5413870811462402
Epoch: 4, Steps: 2 | Train Loss: 0.672 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.5306048393249512
Epoch: 5, Steps: 2 | Train Loss: 0.415 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5838603973388672
Epoch: 6, Steps: 2 | Train Loss: 0.292 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5175280570983887
Epoch: 7, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.440 Vali Acc: 0.400 Test Loss: 1.440 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5141797065734863
Epoch: 8, Steps: 2 | Train Loss: 0.044 Vali Loss: 1.591 Vali Acc: 0.467 Test Loss: 1.591 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5802054405212402
Epoch: 9, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.536 Vali Acc: 0.400 Test Loss: 1.536 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5098388195037842
Epoch: 10, Steps: 2 | Train Loss: 0.009 Vali Loss: 1.665 Vali Acc: 0.533 Test Loss: 1.665 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533317).  Saving model ...
Epoch: 11 cost time: 0.5284409523010254
Epoch: 11, Steps: 2 | Train Loss: 0.005 Vali Loss: 1.924 Vali Acc: 0.400 Test Loss: 1.924 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5671429634094238
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.295 Vali Acc: 0.333 Test Loss: 2.295 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.506472110748291
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.686 Vali Acc: 0.267 Test Loss: 2.686 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5415081977844238
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.049 Vali Acc: 0.267 Test Loss: 3.049 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5336015224456787
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.337 Vali Acc: 0.200 Test Loss: 3.337 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.557574987411499
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.578 Vali Acc: 0.200 Test Loss: 3.578 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5398294925689697
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.759 Vali Acc: 0.200 Test Loss: 3.759 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5421466827392578
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.890 Vali Acc: 0.200 Test Loss: 3.890 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5393171310424805
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.988 Vali Acc: 0.200 Test Loss: 3.988 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5441217422485352
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.059 Vali Acc: 0.200 Test Loss: 4.059 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 565059
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.159613609313965
Epoch: 1, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.116 Vali Acc: 0.533 Test Loss: 1.116 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5616774559020996
Epoch: 2, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5516297817230225
Epoch: 3, Steps: 2 | Train Loss: 0.885 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6024410724639893
Epoch: 4, Steps: 2 | Train Loss: 0.693 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6437079906463623
Epoch: 5, Steps: 2 | Train Loss: 0.511 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5746250152587891
Epoch: 6, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5943686962127686
Epoch: 7, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.503 Vali Acc: 0.400 Test Loss: 1.503 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.59535813331604
Epoch: 8, Steps: 2 | Train Loss: 0.082 Vali Loss: 1.674 Vali Acc: 0.467 Test Loss: 1.674 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6077430248260498
Epoch: 9, Steps: 2 | Train Loss: 0.070 Vali Loss: 1.639 Vali Acc: 0.333 Test Loss: 1.639 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6059989929199219
Epoch: 10, Steps: 2 | Train Loss: 0.025 Vali Loss: 1.829 Vali Acc: 0.400 Test Loss: 1.829 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6356067657470703
Epoch: 11, Steps: 2 | Train Loss: 0.013 Vali Loss: 2.083 Vali Acc: 0.267 Test Loss: 2.083 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 565059
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2483811378479004
Epoch: 1, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5772824287414551
Epoch: 2, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6132211685180664
Epoch: 3, Steps: 2 | Train Loss: 0.970 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5793840885162354
Epoch: 4, Steps: 2 | Train Loss: 0.785 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5736088752746582
Epoch: 5, Steps: 2 | Train Loss: 0.626 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5760505199432373
Epoch: 6, Steps: 2 | Train Loss: 0.478 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5628683567047119
Epoch: 7, Steps: 2 | Train Loss: 0.248 Vali Loss: 1.346 Vali Acc: 0.333 Test Loss: 1.346 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6092042922973633
Epoch: 8, Steps: 2 | Train Loss: 0.155 Vali Loss: 1.435 Vali Acc: 0.333 Test Loss: 1.435 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5608150959014893
Epoch: 9, Steps: 2 | Train Loss: 0.166 Vali Loss: 1.465 Vali Acc: 0.333 Test Loss: 1.465 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6254754066467285
Epoch: 10, Steps: 2 | Train Loss: 0.111 Vali Loss: 1.614 Vali Acc: 0.333 Test Loss: 1.614 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6296234130859375
Epoch: 11, Steps: 2 | Train Loss: 0.079 Vali Loss: 1.732 Vali Acc: 0.200 Test Loss: 1.732 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 565059
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.518613576889038
Epoch: 1, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6965181827545166
Epoch: 2, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6339929103851318
Epoch: 3, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6388485431671143
Epoch: 4, Steps: 2 | Train Loss: 0.745 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.6085283756256104
Epoch: 5, Steps: 2 | Train Loss: 0.411 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6231129169464111
Epoch: 6, Steps: 2 | Train Loss: 0.226 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6520984172821045
Epoch: 7, Steps: 2 | Train Loss: 0.129 Vali Loss: 1.338 Vali Acc: 0.267 Test Loss: 1.338 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6845662593841553
Epoch: 8, Steps: 2 | Train Loss: 0.053 Vali Loss: 1.597 Vali Acc: 0.267 Test Loss: 1.597 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6502120494842529
Epoch: 9, Steps: 2 | Train Loss: 0.015 Vali Loss: 1.987 Vali Acc: 0.267 Test Loss: 1.987 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5786218643188477
Epoch: 10, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.452 Vali Acc: 0.267 Test Loss: 2.452 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6111562252044678
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.863 Vali Acc: 0.267 Test Loss: 2.863 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6629095077514648
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.196 Vali Acc: 0.267 Test Loss: 3.196 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6264469623565674
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.455 Vali Acc: 0.267 Test Loss: 3.455 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6329917907714844
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.683 Vali Acc: 0.267 Test Loss: 3.683 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 532291
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3085172176361084
Epoch: 1, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5560507774353027
Epoch: 2, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5633213520050049
Epoch: 3, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5723404884338379
Epoch: 4, Steps: 2 | Train Loss: 0.790 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6093902587890625
Epoch: 5, Steps: 2 | Train Loss: 0.472 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5763289928436279
Epoch: 6, Steps: 2 | Train Loss: 0.277 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.6027135848999023
Epoch: 7, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6112024784088135
Epoch: 8, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5798683166503906
Epoch: 9, Steps: 2 | Train Loss: 0.030 Vali Loss: 1.676 Vali Acc: 0.400 Test Loss: 1.676 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5478599071502686
Epoch: 10, Steps: 2 | Train Loss: 0.015 Vali Loss: 2.141 Vali Acc: 0.333 Test Loss: 2.141 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5226054191589355
Epoch: 11, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.579 Vali Acc: 0.333 Test Loss: 2.579 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5892105102539062
Epoch: 12, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.927 Vali Acc: 0.267 Test Loss: 2.927 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6250858306884766
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.069 Vali Acc: 0.267 Test Loss: 3.069 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6281628608703613
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.147 Vali Acc: 0.200 Test Loss: 3.147 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5867447853088379
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.189 Vali Acc: 0.200 Test Loss: 3.189 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5840165615081787
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.225 Vali Acc: 0.267 Test Loss: 3.225 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 532291
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.30218243598938
Epoch: 1, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5167398452758789
Epoch: 2, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5213391780853271
Epoch: 3, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5187902450561523
Epoch: 4, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5209567546844482
Epoch: 5, Steps: 2 | Train Loss: 0.532 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5360403060913086
Epoch: 6, Steps: 2 | Train Loss: 0.375 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5330867767333984
Epoch: 7, Steps: 2 | Train Loss: 0.223 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5287456512451172
Epoch: 8, Steps: 2 | Train Loss: 0.151 Vali Loss: 1.313 Vali Acc: 0.267 Test Loss: 1.313 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5256280899047852
Epoch: 9, Steps: 2 | Train Loss: 0.064 Vali Loss: 1.549 Vali Acc: 0.400 Test Loss: 1.549 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5601553916931152
Epoch: 10, Steps: 2 | Train Loss: 0.041 Vali Loss: 1.888 Vali Acc: 0.400 Test Loss: 1.888 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5585453510284424
Epoch: 11, Steps: 2 | Train Loss: 0.011 Vali Loss: 2.200 Vali Acc: 0.267 Test Loss: 2.200 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5175619125366211
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 2.486 Vali Acc: 0.333 Test Loss: 2.486 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5289516448974609
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.523 Vali Acc: 0.267 Test Loss: 2.523 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5437121391296387
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.556 Vali Acc: 0.200 Test Loss: 2.556 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 532291
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.311674118041992
Epoch: 1, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.6311922073364258
Epoch: 2, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5976612567901611
Epoch: 3, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5672073364257812
Epoch: 4, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6011209487915039
Epoch: 5, Steps: 2 | Train Loss: 0.687 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6040856838226318
Epoch: 6, Steps: 2 | Train Loss: 0.525 Vali Loss: 1.377 Vali Acc: 0.267 Test Loss: 1.377 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6387884616851807
Epoch: 7, Steps: 2 | Train Loss: 0.327 Vali Loss: 1.380 Vali Acc: 0.267 Test Loss: 1.380 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5752875804901123
Epoch: 8, Steps: 2 | Train Loss: 0.266 Vali Loss: 1.463 Vali Acc: 0.333 Test Loss: 1.463 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5911839008331299
Epoch: 9, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.614 Vali Acc: 0.333 Test Loss: 1.614 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6625707149505615
Epoch: 10, Steps: 2 | Train Loss: 0.140 Vali Loss: 1.755 Vali Acc: 0.333 Test Loss: 1.755 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.614530086517334
Epoch: 11, Steps: 2 | Train Loss: 0.051 Vali Loss: 2.052 Vali Acc: 0.200 Test Loss: 2.052 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 532291
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.280505657196045
Epoch: 1, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5863111019134521
Epoch: 2, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5410315990447998
Epoch: 3, Steps: 2 | Train Loss: 0.810 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.583470344543457
Epoch: 4, Steps: 2 | Train Loss: 0.550 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6127455234527588
Epoch: 5, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5905323028564453
Epoch: 6, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.5971322059631348
Epoch: 7, Steps: 2 | Train Loss: 0.080 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6122052669525146
Epoch: 8, Steps: 2 | Train Loss: 0.031 Vali Loss: 1.415 Vali Acc: 0.467 Test Loss: 1.415 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6183774471282959
Epoch: 9, Steps: 2 | Train Loss: 0.017 Vali Loss: 1.762 Vali Acc: 0.333 Test Loss: 1.762 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5915305614471436
Epoch: 10, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.173 Vali Acc: 0.400 Test Loss: 2.173 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.689624547958374
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.599 Vali Acc: 0.333 Test Loss: 2.599 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5689468383789062
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.969 Vali Acc: 0.267 Test Loss: 2.969 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5784049034118652
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.240 Vali Acc: 0.267 Test Loss: 3.240 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6153175830841064
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.447 Vali Acc: 0.200 Test Loss: 3.447 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6022849082946777
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.617 Vali Acc: 0.200 Test Loss: 3.617 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6433618068695068
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.764 Vali Acc: 0.200 Test Loss: 3.764 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 515907
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.374016761779785
Epoch: 1, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5591089725494385
Epoch: 2, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.5841095447540283
Epoch: 3, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.5440974235534668
Epoch: 4, Steps: 2 | Train Loss: 0.629 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5485274791717529
Epoch: 5, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.970 Vali Acc: 0.467 Test Loss: 0.970 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5571625232696533
Epoch: 6, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5613970756530762
Epoch: 7, Steps: 2 | Train Loss: 0.106 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5575346946716309
Epoch: 8, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.174 Vali Acc: 0.533 Test Loss: 1.174 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.574152946472168
Epoch: 9, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.451 Vali Acc: 0.467 Test Loss: 1.451 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5638339519500732
Epoch: 10, Steps: 2 | Train Loss: 0.006 Vali Loss: 1.826 Vali Acc: 0.400 Test Loss: 1.826 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.596360445022583
Epoch: 11, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.180 Vali Acc: 0.333 Test Loss: 2.180 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.561455249786377
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.371 Vali Acc: 0.333 Test Loss: 2.371 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.566213846206665
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.436 Vali Acc: 0.333 Test Loss: 2.436 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 515907
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4017014503479004
Epoch: 1, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.534536600112915
Epoch: 2, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5922083854675293
Epoch: 3, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.5902812480926514
Epoch: 4, Steps: 2 | Train Loss: 0.728 Vali Loss: 1.026 Vali Acc: 0.333 Test Loss: 1.026 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.618361234664917
Epoch: 5, Steps: 2 | Train Loss: 0.498 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5947654247283936
Epoch: 6, Steps: 2 | Train Loss: 0.286 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5671899318695068
Epoch: 7, Steps: 2 | Train Loss: 0.170 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5371913909912109
Epoch: 8, Steps: 2 | Train Loss: 0.098 Vali Loss: 1.223 Vali Acc: 0.467 Test Loss: 1.223 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5322520732879639
Epoch: 9, Steps: 2 | Train Loss: 0.069 Vali Loss: 1.510 Vali Acc: 0.467 Test Loss: 1.510 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5340578556060791
Epoch: 10, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.996 Vali Acc: 0.467 Test Loss: 1.996 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5822789669036865
Epoch: 11, Steps: 2 | Train Loss: 0.028 Vali Loss: 2.504 Vali Acc: 0.400 Test Loss: 2.504 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5490961074829102
Epoch: 12, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.476 Vali Acc: 0.333 Test Loss: 2.476 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5242800712585449
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.238 Vali Acc: 0.400 Test Loss: 2.238 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 515907
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.319420099258423
Epoch: 1, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5195271968841553
Epoch: 2, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5163252353668213
Epoch: 3, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5289745330810547
Epoch: 4, Steps: 2 | Train Loss: 0.804 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.538240909576416
Epoch: 5, Steps: 2 | Train Loss: 0.598 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5527889728546143
Epoch: 6, Steps: 2 | Train Loss: 0.401 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5711343288421631
Epoch: 7, Steps: 2 | Train Loss: 0.296 Vali Loss: 1.319 Vali Acc: 0.267 Test Loss: 1.319 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5603954792022705
Epoch: 8, Steps: 2 | Train Loss: 0.185 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5485506057739258
Epoch: 9, Steps: 2 | Train Loss: 0.188 Vali Loss: 1.474 Vali Acc: 0.333 Test Loss: 1.474 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5425772666931152
Epoch: 10, Steps: 2 | Train Loss: 0.097 Vali Loss: 1.694 Vali Acc: 0.267 Test Loss: 1.694 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5546367168426514
Epoch: 11, Steps: 2 | Train Loss: 0.087 Vali Loss: 2.266 Vali Acc: 0.333 Test Loss: 2.266 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5659327507019043
Epoch: 12, Steps: 2 | Train Loss: 0.054 Vali Loss: 2.078 Vali Acc: 0.267 Test Loss: 2.078 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.534980058670044
Epoch: 13, Steps: 2 | Train Loss: 0.025 Vali Loss: 1.854 Vali Acc: 0.200 Test Loss: 1.854 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 515907
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.456711769104004
Epoch: 1, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6346035003662109
Epoch: 2, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6381103992462158
Epoch: 3, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7060081958770752
Epoch: 4, Steps: 2 | Train Loss: 0.758 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6236696243286133
Epoch: 5, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6204211711883545
Epoch: 6, Steps: 2 | Train Loss: 0.347 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6517152786254883
Epoch: 7, Steps: 2 | Train Loss: 0.340 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6171424388885498
Epoch: 8, Steps: 2 | Train Loss: 0.158 Vali Loss: 1.218 Vali Acc: 0.467 Test Loss: 1.218 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6233961582183838
Epoch: 9, Steps: 2 | Train Loss: 0.090 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5729384422302246
Epoch: 10, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.337 Vali Acc: 0.267 Test Loss: 1.337 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6063623428344727
Epoch: 11, Steps: 2 | Train Loss: 0.022 Vali Loss: 1.503 Vali Acc: 0.333 Test Loss: 1.503 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5945477485656738
Epoch: 12, Steps: 2 | Train Loss: 0.012 Vali Loss: 1.654 Vali Acc: 0.400 Test Loss: 1.654 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5909473896026611
Epoch: 13, Steps: 2 | Train Loss: 0.006 Vali Loss: 1.809 Vali Acc: 0.333 Test Loss: 1.809 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5884692668914795
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 1.946 Vali Acc: 0.267 Test Loss: 1.946 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6594116687774658
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.095 Vali Acc: 0.333 Test Loss: 2.095 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 507843
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.284318208694458
Epoch: 1, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6274852752685547
Epoch: 2, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6294300556182861
Epoch: 3, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6354429721832275
Epoch: 4, Steps: 2 | Train Loss: 0.855 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5874061584472656
Epoch: 5, Steps: 2 | Train Loss: 0.638 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.5675153732299805
Epoch: 6, Steps: 2 | Train Loss: 0.418 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5467355251312256
Epoch: 7, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5341017246246338
Epoch: 8, Steps: 2 | Train Loss: 0.201 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5318636894226074
Epoch: 9, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6180498600006104
Epoch: 10, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.239 Vali Acc: 0.533 Test Loss: 1.239 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6079847812652588
Epoch: 11, Steps: 2 | Train Loss: 0.032 Vali Loss: 1.345 Vali Acc: 0.467 Test Loss: 1.345 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.535926342010498
Epoch: 12, Steps: 2 | Train Loss: 0.023 Vali Loss: 1.454 Vali Acc: 0.333 Test Loss: 1.454 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.602362871170044
Epoch: 13, Steps: 2 | Train Loss: 0.010 Vali Loss: 1.576 Vali Acc: 0.333 Test Loss: 1.576 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6345293521881104
Epoch: 14, Steps: 2 | Train Loss: 0.006 Vali Loss: 1.686 Vali Acc: 0.333 Test Loss: 1.686 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.568934440612793
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 1.798 Vali Acc: 0.400 Test Loss: 1.798 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 507843
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.309291362762451
Epoch: 1, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6160628795623779
Epoch: 2, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5484144687652588
Epoch: 3, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5396299362182617
Epoch: 4, Steps: 2 | Train Loss: 0.908 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5658767223358154
Epoch: 5, Steps: 2 | Train Loss: 0.687 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5807547569274902
Epoch: 6, Steps: 2 | Train Loss: 0.460 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5617427825927734
Epoch: 7, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5785031318664551
Epoch: 8, Steps: 2 | Train Loss: 0.228 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5783448219299316
Epoch: 9, Steps: 2 | Train Loss: 0.161 Vali Loss: 1.184 Vali Acc: 0.467 Test Loss: 1.184 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5601012706756592
Epoch: 10, Steps: 2 | Train Loss: 0.135 Vali Loss: 1.279 Vali Acc: 0.467 Test Loss: 1.279 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5773968696594238
Epoch: 11, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.412 Vali Acc: 0.467 Test Loss: 1.412 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5542538166046143
Epoch: 12, Steps: 2 | Train Loss: 0.041 Vali Loss: 1.521 Vali Acc: 0.400 Test Loss: 1.521 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5385313034057617
Epoch: 13, Steps: 2 | Train Loss: 0.019 Vali Loss: 1.649 Vali Acc: 0.467 Test Loss: 1.649 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5573694705963135
Epoch: 14, Steps: 2 | Train Loss: 0.010 Vali Loss: 1.782 Vali Acc: 0.467 Test Loss: 1.782 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5508527755737305
Epoch: 15, Steps: 2 | Train Loss: 0.006 Vali Loss: 1.936 Vali Acc: 0.400 Test Loss: 1.936 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 507843
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.29830002784729
Epoch: 1, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5392234325408936
Epoch: 2, Steps: 2 | Train Loss: 0.999 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6315922737121582
Epoch: 3, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5126481056213379
Epoch: 4, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5125484466552734
Epoch: 5, Steps: 2 | Train Loss: 0.750 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5372331142425537
Epoch: 6, Steps: 2 | Train Loss: 0.530 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5526249408721924
Epoch: 7, Steps: 2 | Train Loss: 0.545 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5113890171051025
Epoch: 8, Steps: 2 | Train Loss: 0.335 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5328273773193359
Epoch: 9, Steps: 2 | Train Loss: 0.267 Vali Loss: 1.344 Vali Acc: 0.133 Test Loss: 1.344 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5117723941802979
Epoch: 10, Steps: 2 | Train Loss: 0.255 Vali Loss: 1.437 Vali Acc: 0.200 Test Loss: 1.437 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5078549385070801
Epoch: 11, Steps: 2 | Train Loss: 0.129 Vali Loss: 1.599 Vali Acc: 0.267 Test Loss: 1.599 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5028820037841797
Epoch: 12, Steps: 2 | Train Loss: 0.105 Vali Loss: 1.737 Vali Acc: 0.267 Test Loss: 1.737 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 507843
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2943174839019775
Epoch: 1, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5358963012695312
Epoch: 2, Steps: 2 | Train Loss: 0.973 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.537714958190918
Epoch: 3, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6111221313476562
Epoch: 4, Steps: 2 | Train Loss: 0.731 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.6014230251312256
Epoch: 5, Steps: 2 | Train Loss: 0.551 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5749778747558594
Epoch: 6, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6029284000396729
Epoch: 7, Steps: 2 | Train Loss: 0.270 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5746011734008789
Epoch: 8, Steps: 2 | Train Loss: 0.138 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5445454120635986
Epoch: 9, Steps: 2 | Train Loss: 0.094 Vali Loss: 1.270 Vali Acc: 0.467 Test Loss: 1.270 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5687017440795898
Epoch: 10, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.345 Vali Acc: 0.400 Test Loss: 1.345 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5801346302032471
Epoch: 11, Steps: 2 | Train Loss: 0.026 Vali Loss: 1.412 Vali Acc: 0.400 Test Loss: 1.412 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5612523555755615
Epoch: 12, Steps: 2 | Train Loss: 0.015 Vali Loss: 1.484 Vali Acc: 0.467 Test Loss: 1.484 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5513734817504883
Epoch: 13, Steps: 2 | Train Loss: 0.009 Vali Loss: 1.596 Vali Acc: 0.467 Test Loss: 1.596 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5765187740325928
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 1.763 Vali Acc: 0.400 Test Loss: 1.763 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5753574371337891
Epoch: 15, Steps: 2 | Train Loss: 0.002 Vali Loss: 1.943 Vali Acc: 0.333 Test Loss: 1.943 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5881180763244629
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.083 Vali Acc: 0.333 Test Loss: 2.083 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 376771
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4443585872650146
Epoch: 1, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6520349979400635
Epoch: 2, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5764384269714355
Epoch: 3, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.62131667137146
Epoch: 4, Steps: 2 | Train Loss: 0.794 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.600090742111206
Epoch: 5, Steps: 2 | Train Loss: 0.594 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6418321132659912
Epoch: 6, Steps: 2 | Train Loss: 0.422 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.6476361751556396
Epoch: 7, Steps: 2 | Train Loss: 0.319 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7085607051849365
Epoch: 8, Steps: 2 | Train Loss: 0.187 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6238036155700684
Epoch: 9, Steps: 2 | Train Loss: 0.125 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6233675479888916
Epoch: 10, Steps: 2 | Train Loss: 0.077 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6215910911560059
Epoch: 11, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.318 Vali Acc: 0.467 Test Loss: 1.318 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6483175754547119
Epoch: 12, Steps: 2 | Train Loss: 0.027 Vali Loss: 1.372 Vali Acc: 0.333 Test Loss: 1.372 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6301796436309814
Epoch: 13, Steps: 2 | Train Loss: 0.013 Vali Loss: 1.475 Vali Acc: 0.333 Test Loss: 1.475 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6511037349700928
Epoch: 14, Steps: 2 | Train Loss: 0.008 Vali Loss: 1.635 Vali Acc: 0.400 Test Loss: 1.635 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5935111045837402
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 1.771 Vali Acc: 0.333 Test Loss: 1.771 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6076319217681885
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 1.902 Vali Acc: 0.333 Test Loss: 1.902 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 376771
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4329824447631836
Epoch: 1, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.651153564453125
Epoch: 2, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6098041534423828
Epoch: 3, Steps: 2 | Train Loss: 0.912 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6258492469787598
Epoch: 4, Steps: 2 | Train Loss: 0.783 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5835158824920654
Epoch: 5, Steps: 2 | Train Loss: 0.671 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5615136623382568
Epoch: 6, Steps: 2 | Train Loss: 0.456 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5625839233398438
Epoch: 7, Steps: 2 | Train Loss: 0.383 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6246893405914307
Epoch: 8, Steps: 2 | Train Loss: 0.256 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5711143016815186
Epoch: 9, Steps: 2 | Train Loss: 0.166 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5502381324768066
Epoch: 10, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5232267379760742
Epoch: 11, Steps: 2 | Train Loss: 0.096 Vali Loss: 1.409 Vali Acc: 0.467 Test Loss: 1.409 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5804378986358643
Epoch: 12, Steps: 2 | Train Loss: 0.053 Vali Loss: 1.471 Vali Acc: 0.400 Test Loss: 1.471 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5527589321136475
Epoch: 13, Steps: 2 | Train Loss: 0.037 Vali Loss: 1.622 Vali Acc: 0.467 Test Loss: 1.622 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5733115673065186
Epoch: 14, Steps: 2 | Train Loss: 0.019 Vali Loss: 1.888 Vali Acc: 0.333 Test Loss: 1.888 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 376771
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.215549945831299
Epoch: 1, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5119948387145996
Epoch: 2, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5262799263000488
Epoch: 3, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.553903341293335
Epoch: 4, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.549159049987793
Epoch: 5, Steps: 2 | Train Loss: 0.730 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5310614109039307
Epoch: 6, Steps: 2 | Train Loss: 0.618 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5289409160614014
Epoch: 7, Steps: 2 | Train Loss: 0.435 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5439977645874023
Epoch: 8, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5327029228210449
Epoch: 9, Steps: 2 | Train Loss: 0.238 Vali Loss: 1.359 Vali Acc: 0.333 Test Loss: 1.359 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5376906394958496
Epoch: 10, Steps: 2 | Train Loss: 0.215 Vali Loss: 1.412 Vali Acc: 0.267 Test Loss: 1.412 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5251288414001465
Epoch: 11, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.478 Vali Acc: 0.267 Test Loss: 1.478 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5095107555389404
Epoch: 12, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.520 Vali Acc: 0.267 Test Loss: 1.520 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 376771
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.372227191925049
Epoch: 1, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5306851863861084
Epoch: 2, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5068480968475342
Epoch: 3, Steps: 2 | Train Loss: 0.739 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5485599040985107
Epoch: 4, Steps: 2 | Train Loss: 0.710 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5361232757568359
Epoch: 5, Steps: 2 | Train Loss: 0.450 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5455443859100342
Epoch: 6, Steps: 2 | Train Loss: 0.478 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.530632495880127
Epoch: 7, Steps: 2 | Train Loss: 0.303 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5187842845916748
Epoch: 8, Steps: 2 | Train Loss: 0.185 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.513951301574707
Epoch: 9, Steps: 2 | Train Loss: 0.132 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5045933723449707
Epoch: 10, Steps: 2 | Train Loss: 0.050 Vali Loss: 1.238 Vali Acc: 0.533 Test Loss: 1.238 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5091695785522461
Epoch: 11, Steps: 2 | Train Loss: 0.025 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5061137676239014
Epoch: 12, Steps: 2 | Train Loss: 0.019 Vali Loss: 1.422 Vali Acc: 0.467 Test Loss: 1.422 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5378615856170654
Epoch: 13, Steps: 2 | Train Loss: 0.009 Vali Loss: 1.559 Vali Acc: 0.333 Test Loss: 1.559 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5021588802337646
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 1.739 Vali Acc: 0.400 Test Loss: 1.739 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5191597938537598
Epoch: 15, Steps: 2 | Train Loss: 0.002 Vali Loss: 1.926 Vali Acc: 0.400 Test Loss: 1.926 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.518355131149292
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.095 Vali Acc: 0.333 Test Loss: 2.095 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 311235
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.25422739982605
Epoch: 1, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6358561515808105
Epoch: 2, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.630141019821167
Epoch: 3, Steps: 2 | Train Loss: 0.826 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5964806079864502
Epoch: 4, Steps: 2 | Train Loss: 0.742 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5892894268035889
Epoch: 5, Steps: 2 | Train Loss: 0.557 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.5703070163726807
Epoch: 6, Steps: 2 | Train Loss: 0.566 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.5799973011016846
Epoch: 7, Steps: 2 | Train Loss: 0.340 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.583404541015625
Epoch: 8, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6086258888244629
Epoch: 9, Steps: 2 | Train Loss: 0.211 Vali Loss: 1.204 Vali Acc: 0.467 Test Loss: 1.204 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.575160026550293
Epoch: 10, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5842933654785156
Epoch: 11, Steps: 2 | Train Loss: 0.050 Vali Loss: 1.216 Vali Acc: 0.467 Test Loss: 1.216 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6108584403991699
Epoch: 12, Steps: 2 | Train Loss: 0.031 Vali Loss: 1.281 Vali Acc: 0.467 Test Loss: 1.281 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5650315284729004
Epoch: 13, Steps: 2 | Train Loss: 0.019 Vali Loss: 1.403 Vali Acc: 0.533 Test Loss: 1.403 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6434037685394287
Epoch: 14, Steps: 2 | Train Loss: 0.008 Vali Loss: 1.610 Vali Acc: 0.467 Test Loss: 1.610 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.651477575302124
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 1.835 Vali Acc: 0.467 Test Loss: 1.835 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6082518100738525
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.037 Vali Acc: 0.467 Test Loss: 2.037 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.595883846282959
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.183 Vali Acc: 0.467 Test Loss: 2.183 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 311235
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.401536464691162
Epoch: 1, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.590998649597168
Epoch: 2, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5970175266265869
Epoch: 3, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6111040115356445
Epoch: 4, Steps: 2 | Train Loss: 0.823 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6440482139587402
Epoch: 5, Steps: 2 | Train Loss: 0.634 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5899937152862549
Epoch: 6, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6201913356781006
Epoch: 7, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6089305877685547
Epoch: 8, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5834770202636719
Epoch: 9, Steps: 2 | Train Loss: 0.337 Vali Loss: 1.339 Vali Acc: 0.333 Test Loss: 1.339 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6840236186981201
Epoch: 10, Steps: 2 | Train Loss: 0.157 Vali Loss: 1.342 Vali Acc: 0.467 Test Loss: 1.342 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466653).  Saving model ...
Epoch: 11 cost time: 0.581378698348999
Epoch: 11, Steps: 2 | Train Loss: 0.097 Vali Loss: 1.392 Vali Acc: 0.467 Test Loss: 1.392 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.616938591003418
Epoch: 12, Steps: 2 | Train Loss: 0.070 Vali Loss: 1.474 Vali Acc: 0.400 Test Loss: 1.474 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5843014717102051
Epoch: 13, Steps: 2 | Train Loss: 0.058 Vali Loss: 1.583 Vali Acc: 0.400 Test Loss: 1.583 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6146755218505859
Epoch: 14, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.859 Vali Acc: 0.267 Test Loss: 1.859 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6680121421813965
Epoch: 15, Steps: 2 | Train Loss: 0.012 Vali Loss: 2.091 Vali Acc: 0.333 Test Loss: 2.091 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5908098220825195
Epoch: 16, Steps: 2 | Train Loss: 0.009 Vali Loss: 2.231 Vali Acc: 0.267 Test Loss: 2.231 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5473887920379639
Epoch: 17, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.262 Vali Acc: 0.267 Test Loss: 2.262 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5543506145477295
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.261 Vali Acc: 0.267 Test Loss: 2.261 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5554568767547607
Epoch: 19, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.260 Vali Acc: 0.267 Test Loss: 2.260 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5118629932403564
Epoch: 20, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.261 Vali Acc: 0.267 Test Loss: 2.261 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 311235
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.334254503250122
Epoch: 1, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.49546098709106445
Epoch: 2, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5068960189819336
Epoch: 3, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5596191883087158
Epoch: 4, Steps: 2 | Train Loss: 0.867 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5841424465179443
Epoch: 5, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5283350944519043
Epoch: 6, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5274147987365723
Epoch: 7, Steps: 2 | Train Loss: 0.523 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5410714149475098
Epoch: 8, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.560633659362793
Epoch: 9, Steps: 2 | Train Loss: 0.410 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5287201404571533
Epoch: 10, Steps: 2 | Train Loss: 0.250 Vali Loss: 1.291 Vali Acc: 0.333 Test Loss: 1.291 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5409421920776367
Epoch: 11, Steps: 2 | Train Loss: 0.176 Vali Loss: 1.308 Vali Acc: 0.267 Test Loss: 1.308 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 311235
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3705127239227295
Epoch: 1, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5701920986175537
Epoch: 2, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.196 Vali Acc: 0.133 Test Loss: 1.196 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.531135082244873
Epoch: 3, Steps: 2 | Train Loss: 0.882 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.496309757232666
Epoch: 4, Steps: 2 | Train Loss: 0.793 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5100536346435547
Epoch: 5, Steps: 2 | Train Loss: 0.570 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.49413037300109863
Epoch: 6, Steps: 2 | Train Loss: 0.447 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6213006973266602
Epoch: 7, Steps: 2 | Train Loss: 0.301 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.493152379989624
Epoch: 8, Steps: 2 | Train Loss: 0.178 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5123422145843506
Epoch: 9, Steps: 2 | Train Loss: 0.130 Vali Loss: 1.236 Vali Acc: 0.467 Test Loss: 1.236 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 10 cost time: 0.5033977031707764
Epoch: 10, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.383 Vali Acc: 0.333 Test Loss: 1.383 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.48300862312316895
Epoch: 11, Steps: 2 | Train Loss: 0.037 Vali Loss: 1.541 Vali Acc: 0.267 Test Loss: 1.541 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4874711036682129
Epoch: 12, Steps: 2 | Train Loss: 0.016 Vali Loss: 1.694 Vali Acc: 0.267 Test Loss: 1.694 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5190849304199219
Epoch: 13, Steps: 2 | Train Loss: 0.008 Vali Loss: 1.882 Vali Acc: 0.400 Test Loss: 1.882 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4993729591369629
Epoch: 14, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.085 Vali Acc: 0.267 Test Loss: 2.085 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5524401664733887
Epoch: 15, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.197 Vali Acc: 0.267 Test Loss: 2.197 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4830598831176758
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.209 Vali Acc: 0.267 Test Loss: 2.209 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4784531593322754
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.198 Vali Acc: 0.333 Test Loss: 2.198 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4917788505554199
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.175 Vali Acc: 0.400 Test Loss: 2.175 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.501746416091919
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.168 Vali Acc: 0.333 Test Loss: 2.168 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 278467
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3328709602355957
Epoch: 1, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6137428283691406
Epoch: 2, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.212 Vali Acc: 0.133 Test Loss: 1.212 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6318376064300537
Epoch: 3, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.5388753414154053
Epoch: 4, Steps: 2 | Train Loss: 0.836 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.56722092628479
Epoch: 5, Steps: 2 | Train Loss: 0.600 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.5591566562652588
Epoch: 6, Steps: 2 | Train Loss: 0.478 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.6336166858673096
Epoch: 7, Steps: 2 | Train Loss: 0.353 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5707602500915527
Epoch: 8, Steps: 2 | Train Loss: 0.243 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.5960938930511475
Epoch: 9, Steps: 2 | Train Loss: 0.170 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5857193470001221
Epoch: 10, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.591456413269043
Epoch: 11, Steps: 2 | Train Loss: 0.060 Vali Loss: 1.393 Vali Acc: 0.467 Test Loss: 1.393 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466653).  Saving model ...
Epoch: 12 cost time: 0.591700553894043
Epoch: 12, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.535 Vali Acc: 0.467 Test Loss: 1.535 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5968828201293945
Epoch: 13, Steps: 2 | Train Loss: 0.015 Vali Loss: 1.713 Vali Acc: 0.333 Test Loss: 1.713 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5841238498687744
Epoch: 14, Steps: 2 | Train Loss: 0.010 Vali Loss: 1.862 Vali Acc: 0.333 Test Loss: 1.862 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5666229724884033
Epoch: 15, Steps: 2 | Train Loss: 0.007 Vali Loss: 1.878 Vali Acc: 0.333 Test Loss: 1.878 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.61612868309021
Epoch: 16, Steps: 2 | Train Loss: 0.004 Vali Loss: 1.868 Vali Acc: 0.333 Test Loss: 1.868 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.61397385597229
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 1.859 Vali Acc: 0.400 Test Loss: 1.859 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6477334499359131
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 1.895 Vali Acc: 0.400 Test Loss: 1.895 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5931699275970459
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 1.915 Vali Acc: 0.333 Test Loss: 1.915 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5646603107452393
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 1.943 Vali Acc: 0.333 Test Loss: 1.943 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5772311687469482
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 1.977 Vali Acc: 0.333 Test Loss: 1.977 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 278467
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.377115249633789
Epoch: 1, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5349061489105225
Epoch: 2, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5582923889160156
Epoch: 3, Steps: 2 | Train Loss: 0.945 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5714805126190186
Epoch: 4, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5603466033935547
Epoch: 5, Steps: 2 | Train Loss: 0.623 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5629415512084961
Epoch: 6, Steps: 2 | Train Loss: 0.547 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5275425910949707
Epoch: 7, Steps: 2 | Train Loss: 0.441 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5279309749603271
Epoch: 8, Steps: 2 | Train Loss: 0.305 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5414304733276367
Epoch: 9, Steps: 2 | Train Loss: 0.277 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.547196626663208
Epoch: 10, Steps: 2 | Train Loss: 0.238 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5380828380584717
Epoch: 11, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.411 Vali Acc: 0.400 Test Loss: 1.411 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5094349384307861
Epoch: 12, Steps: 2 | Train Loss: 0.065 Vali Loss: 1.520 Vali Acc: 0.400 Test Loss: 1.520 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5474228858947754
Epoch: 13, Steps: 2 | Train Loss: 0.038 Vali Loss: 1.677 Vali Acc: 0.333 Test Loss: 1.677 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5128655433654785
Epoch: 14, Steps: 2 | Train Loss: 0.031 Vali Loss: 1.796 Vali Acc: 0.333 Test Loss: 1.796 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.531003475189209
Epoch: 15, Steps: 2 | Train Loss: 0.018 Vali Loss: 1.753 Vali Acc: 0.400 Test Loss: 1.753 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5057976245880127
Epoch: 16, Steps: 2 | Train Loss: 0.010 Vali Loss: 1.763 Vali Acc: 0.467 Test Loss: 1.763 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466649).  Saving model ...
Epoch: 17 cost time: 0.5034551620483398
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 1.824 Vali Acc: 0.400 Test Loss: 1.824 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5042440891265869
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 1.912 Vali Acc: 0.400 Test Loss: 1.912 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4847140312194824
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.010 Vali Acc: 0.400 Test Loss: 2.010 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5106849670410156
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.118 Vali Acc: 0.467 Test Loss: 2.118 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.47245240211486816
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.241 Vali Acc: 0.400 Test Loss: 2.241 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4954967498779297
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.367 Vali Acc: 0.333 Test Loss: 2.367 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5143208503723145
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.489 Vali Acc: 0.333 Test Loss: 2.489 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4832429885864258
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.589 Vali Acc: 0.333 Test Loss: 2.589 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5171539783477783
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.687 Vali Acc: 0.333 Test Loss: 2.687 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5356295108795166
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.774 Vali Acc: 0.333 Test Loss: 2.774 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 278467
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1479413509368896
Epoch: 1, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5159916877746582
Epoch: 2, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.114 Vali Acc: 0.133 Test Loss: 1.114 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5138132572174072
Epoch: 3, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.48768067359924316
Epoch: 4, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5032052993774414
Epoch: 5, Steps: 2 | Train Loss: 0.730 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5657737255096436
Epoch: 6, Steps: 2 | Train Loss: 0.681 Vali Loss: 1.139 Vali Acc: 0.133 Test Loss: 1.139 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5985057353973389
Epoch: 7, Steps: 2 | Train Loss: 0.494 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5249824523925781
Epoch: 8, Steps: 2 | Train Loss: 0.389 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.49274420738220215
Epoch: 9, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5076558589935303
Epoch: 10, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5080313682556152
Epoch: 11, Steps: 2 | Train Loss: 0.248 Vali Loss: 1.357 Vali Acc: 0.267 Test Loss: 1.357 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5295147895812988
Epoch: 12, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.422 Vali Acc: 0.267 Test Loss: 1.422 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4897181987762451
Epoch: 13, Steps: 2 | Train Loss: 0.093 Vali Loss: 1.531 Vali Acc: 0.267 Test Loss: 1.531 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 278467
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3458683490753174
Epoch: 1, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5212275981903076
Epoch: 2, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5178642272949219
Epoch: 3, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5597221851348877
Epoch: 4, Steps: 2 | Train Loss: 0.729 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5567343235015869
Epoch: 5, Steps: 2 | Train Loss: 0.482 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5498943328857422
Epoch: 6, Steps: 2 | Train Loss: 0.318 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.49634480476379395
Epoch: 7, Steps: 2 | Train Loss: 0.222 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5275065898895264
Epoch: 8, Steps: 2 | Train Loss: 0.190 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5400621891021729
Epoch: 9, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.553032636642456
Epoch: 10, Steps: 2 | Train Loss: 0.050 Vali Loss: 1.452 Vali Acc: 0.400 Test Loss: 1.452 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5699777603149414
Epoch: 11, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.711 Vali Acc: 0.400 Test Loss: 1.711 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5664150714874268
Epoch: 12, Steps: 2 | Train Loss: 0.015 Vali Loss: 1.782 Vali Acc: 0.400 Test Loss: 1.782 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5234520435333252
Epoch: 13, Steps: 2 | Train Loss: 0.006 Vali Loss: 1.781 Vali Acc: 0.467 Test Loss: 1.781 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5246975421905518
Epoch: 14, Steps: 2 | Train Loss: 0.003 Vali Loss: 1.805 Vali Acc: 0.333 Test Loss: 1.805 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5574650764465332
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 1.846 Vali Acc: 0.333 Test Loss: 1.846 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5237877368927002
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 1.898 Vali Acc: 0.333 Test Loss: 1.898 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 262083
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4686391353607178
Epoch: 1, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5557801723480225
Epoch: 2, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5667145252227783
Epoch: 3, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5565547943115234
Epoch: 4, Steps: 2 | Train Loss: 0.818 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5506563186645508
Epoch: 5, Steps: 2 | Train Loss: 0.532 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6530880928039551
Epoch: 6, Steps: 2 | Train Loss: 0.392 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6107578277587891
Epoch: 7, Steps: 2 | Train Loss: 0.286 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6062040328979492
Epoch: 8, Steps: 2 | Train Loss: 0.241 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.648862361907959
Epoch: 9, Steps: 2 | Train Loss: 0.138 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.556687593460083
Epoch: 10, Steps: 2 | Train Loss: 0.087 Vali Loss: 1.295 Vali Acc: 0.400 Test Loss: 1.295 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6547365188598633
Epoch: 11, Steps: 2 | Train Loss: 0.044 Vali Loss: 1.482 Vali Acc: 0.400 Test Loss: 1.482 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6039154529571533
Epoch: 12, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.575 Vali Acc: 0.400 Test Loss: 1.575 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5802969932556152
Epoch: 13, Steps: 2 | Train Loss: 0.012 Vali Loss: 1.612 Vali Acc: 0.333 Test Loss: 1.612 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6258749961853027
Epoch: 14, Steps: 2 | Train Loss: 0.007 Vali Loss: 1.652 Vali Acc: 0.400 Test Loss: 1.652 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.566112756729126
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.400 Test Loss: 1.720 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5610287189483643
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 1.793 Vali Acc: 0.400 Test Loss: 1.793 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5501666069030762
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 1.863 Vali Acc: 0.400 Test Loss: 1.863 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5657551288604736
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 1.937 Vali Acc: 0.400 Test Loss: 1.937 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5589032173156738
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.004 Vali Acc: 0.333 Test Loss: 2.004 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 262083
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2007193565368652
Epoch: 1, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5019574165344238
Epoch: 2, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5249803066253662
Epoch: 3, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5024974346160889
Epoch: 4, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5416276454925537
Epoch: 5, Steps: 2 | Train Loss: 0.585 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5348184108734131
Epoch: 6, Steps: 2 | Train Loss: 0.480 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5001130104064941
Epoch: 7, Steps: 2 | Train Loss: 0.379 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5569841861724854
Epoch: 8, Steps: 2 | Train Loss: 0.314 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.520164966583252
Epoch: 9, Steps: 2 | Train Loss: 0.254 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7701840400695801
Epoch: 10, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5107533931732178
Epoch: 11, Steps: 2 | Train Loss: 0.089 Vali Loss: 1.500 Vali Acc: 0.333 Test Loss: 1.500 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5572102069854736
Epoch: 12, Steps: 2 | Train Loss: 0.063 Vali Loss: 1.519 Vali Acc: 0.333 Test Loss: 1.519 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5701582431793213
Epoch: 13, Steps: 2 | Train Loss: 0.032 Vali Loss: 1.583 Vali Acc: 0.400 Test Loss: 1.583 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 262083
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3396458625793457
Epoch: 1, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.534127950668335
Epoch: 2, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47226548194885254
Epoch: 3, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.49123382568359375
Epoch: 4, Steps: 2 | Train Loss: 0.926 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5646705627441406
Epoch: 5, Steps: 2 | Train Loss: 0.720 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5186893939971924
Epoch: 6, Steps: 2 | Train Loss: 0.615 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5033726692199707
Epoch: 7, Steps: 2 | Train Loss: 0.485 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5479981899261475
Epoch: 8, Steps: 2 | Train Loss: 0.439 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5337274074554443
Epoch: 9, Steps: 2 | Train Loss: 0.380 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5240960121154785
Epoch: 10, Steps: 2 | Train Loss: 0.237 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5394959449768066
Epoch: 11, Steps: 2 | Train Loss: 0.193 Vali Loss: 1.417 Vali Acc: 0.267 Test Loss: 1.417 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5080525875091553
Epoch: 12, Steps: 2 | Train Loss: 0.178 Vali Loss: 1.473 Vali Acc: 0.200 Test Loss: 1.473 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5234775543212891
Epoch: 13, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.483 Vali Acc: 0.267 Test Loss: 1.483 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 262083
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.303297519683838
Epoch: 1, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5237951278686523
Epoch: 2, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.549147367477417
Epoch: 3, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5132694244384766
Epoch: 4, Steps: 2 | Train Loss: 0.804 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5158689022064209
Epoch: 5, Steps: 2 | Train Loss: 0.590 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.5245943069458008
Epoch: 6, Steps: 2 | Train Loss: 0.450 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5328068733215332
Epoch: 7, Steps: 2 | Train Loss: 0.307 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5527033805847168
Epoch: 8, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5475931167602539
Epoch: 9, Steps: 2 | Train Loss: 0.102 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.528435468673706
Epoch: 10, Steps: 2 | Train Loss: 0.059 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5275187492370605
Epoch: 11, Steps: 2 | Train Loss: 0.061 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5228698253631592
Epoch: 12, Steps: 2 | Train Loss: 0.021 Vali Loss: 1.511 Vali Acc: 0.400 Test Loss: 1.511 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5489077568054199
Epoch: 13, Steps: 2 | Train Loss: 0.009 Vali Loss: 1.750 Vali Acc: 0.400 Test Loss: 1.750 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5094053745269775
Epoch: 14, Steps: 2 | Train Loss: 0.006 Vali Loss: 1.926 Vali Acc: 0.400 Test Loss: 1.926 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5846507549285889
Epoch: 15, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.043 Vali Acc: 0.400 Test Loss: 2.043 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 253891
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3111443519592285
Epoch: 1, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5070569515228271
Epoch: 2, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5034580230712891
Epoch: 3, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.543203592300415
Epoch: 4, Steps: 2 | Train Loss: 0.823 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5736010074615479
Epoch: 5, Steps: 2 | Train Loss: 0.640 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5924808979034424
Epoch: 6, Steps: 2 | Train Loss: 0.517 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.5226383209228516
Epoch: 7, Steps: 2 | Train Loss: 0.382 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5149335861206055
Epoch: 8, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.511608362197876
Epoch: 9, Steps: 2 | Train Loss: 0.155 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5734591484069824
Epoch: 10, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5755972862243652
Epoch: 11, Steps: 2 | Train Loss: 0.076 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5727291107177734
Epoch: 12, Steps: 2 | Train Loss: 0.047 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.543341875076294
Epoch: 13, Steps: 2 | Train Loss: 0.017 Vali Loss: 1.520 Vali Acc: 0.400 Test Loss: 1.520 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5437569618225098
Epoch: 14, Steps: 2 | Train Loss: 0.011 Vali Loss: 1.668 Vali Acc: 0.400 Test Loss: 1.668 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5545206069946289
Epoch: 15, Steps: 2 | Train Loss: 0.006 Vali Loss: 1.808 Vali Acc: 0.467 Test Loss: 1.808 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5620203018188477
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 1.920 Vali Acc: 0.467 Test Loss: 1.920 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 253891
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.467444658279419
Epoch: 1, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5465037822723389
Epoch: 2, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5371222496032715
Epoch: 3, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5528285503387451
Epoch: 4, Steps: 2 | Train Loss: 0.882 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5520777702331543
Epoch: 5, Steps: 2 | Train Loss: 0.732 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6040966510772705
Epoch: 6, Steps: 2 | Train Loss: 0.590 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5714297294616699
Epoch: 7, Steps: 2 | Train Loss: 0.487 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5804159641265869
Epoch: 8, Steps: 2 | Train Loss: 0.281 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5834925174713135
Epoch: 9, Steps: 2 | Train Loss: 0.212 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5723493099212646
Epoch: 10, Steps: 2 | Train Loss: 0.173 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6318404674530029
Epoch: 11, Steps: 2 | Train Loss: 0.137 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5944077968597412
Epoch: 12, Steps: 2 | Train Loss: 0.107 Vali Loss: 1.385 Vali Acc: 0.333 Test Loss: 1.385 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 253891
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3120524883270264
Epoch: 1, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5438759326934814
Epoch: 2, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5454535484313965
Epoch: 3, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5761823654174805
Epoch: 4, Steps: 2 | Train Loss: 0.867 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.534916877746582
Epoch: 5, Steps: 2 | Train Loss: 0.783 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5599219799041748
Epoch: 6, Steps: 2 | Train Loss: 0.661 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.560605525970459
Epoch: 7, Steps: 2 | Train Loss: 0.569 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5328562259674072
Epoch: 8, Steps: 2 | Train Loss: 0.347 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5597712993621826
Epoch: 9, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5359377861022949
Epoch: 10, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5399844646453857
Epoch: 11, Steps: 2 | Train Loss: 0.226 Vali Loss: 1.324 Vali Acc: 0.267 Test Loss: 1.324 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5205385684967041
Epoch: 12, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.376 Vali Acc: 0.267 Test Loss: 1.376 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 253891
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.699748992919922
Epoch: 1, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.7863936424255371
Epoch: 2, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7662396430969238
Epoch: 3, Steps: 2 | Train Loss: 0.502 Vali Loss: 1.280 Vali Acc: 0.533 Test Loss: 1.280 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7802190780639648
Epoch: 4, Steps: 2 | Train Loss: 0.259 Vali Loss: 2.005 Vali Acc: 0.267 Test Loss: 2.005 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8370325565338135
Epoch: 5, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.459 Vali Acc: 0.267 Test Loss: 3.459 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.79923415184021
Epoch: 6, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.276 Vali Acc: 0.400 Test Loss: 5.276 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.690758228302002
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.238 Vali Acc: 0.400 Test Loss: 7.238 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7681481838226318
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.232 Vali Acc: 0.333 Test Loss: 9.232 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6621816158294678
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.092 Vali Acc: 0.333 Test Loss: 11.092 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6710269451141357
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.774 Vali Acc: 0.333 Test Loss: 12.774 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6840107440948486
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 14.268 Vali Acc: 0.333 Test Loss: 14.268 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7489027976989746
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 15.576 Vali Acc: 0.333 Test Loss: 15.576 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6477859
model size : 34.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.360865354537964
Epoch: 1, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.761946439743042
Epoch: 2, Steps: 2 | Train Loss: 0.868 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7469699382781982
Epoch: 3, Steps: 2 | Train Loss: 0.548 Vali Loss: 1.331 Vali Acc: 0.533 Test Loss: 1.331 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533320).  Saving model ...
Epoch: 4 cost time: 0.7735381126403809
Epoch: 4, Steps: 2 | Train Loss: 0.360 Vali Loss: 2.057 Vali Acc: 0.267 Test Loss: 2.057 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7712535858154297
Epoch: 5, Steps: 2 | Train Loss: 0.011 Vali Loss: 3.305 Vali Acc: 0.333 Test Loss: 3.305 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.791658878326416
Epoch: 6, Steps: 2 | Train Loss: 0.004 Vali Loss: 4.667 Vali Acc: 0.267 Test Loss: 4.667 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7549662590026855
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.414 Vali Acc: 0.333 Test Loss: 5.414 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7725574970245361
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.340 Vali Acc: 0.267 Test Loss: 7.340 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7411799430847168
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.484 Vali Acc: 0.267 Test Loss: 9.484 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7707538604736328
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.467 Vali Acc: 0.267 Test Loss: 11.467 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.757918119430542
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.237 Vali Acc: 0.267 Test Loss: 13.237 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7856943607330322
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 14.773 Vali Acc: 0.267 Test Loss: 14.773 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7590057849884033
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 16.091 Vali Acc: 0.267 Test Loss: 16.091 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6477859
model size : 34.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3951845169067383
Epoch: 1, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6742684841156006
Epoch: 2, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6638991832733154
Epoch: 3, Steps: 2 | Train Loss: 0.596 Vali Loss: 1.417 Vali Acc: 0.533 Test Loss: 1.417 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 0.6728224754333496
Epoch: 4, Steps: 2 | Train Loss: 0.498 Vali Loss: 1.989 Vali Acc: 0.200 Test Loss: 1.989 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7160727977752686
Epoch: 5, Steps: 2 | Train Loss: 0.055 Vali Loss: 3.340 Vali Acc: 0.333 Test Loss: 3.340 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6964259147644043
Epoch: 6, Steps: 2 | Train Loss: 0.060 Vali Loss: 3.848 Vali Acc: 0.267 Test Loss: 3.848 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6539568901062012
Epoch: 7, Steps: 2 | Train Loss: 0.002 Vali Loss: 6.545 Vali Acc: 0.200 Test Loss: 6.545 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7023799419403076
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 7.365 Vali Acc: 0.200 Test Loss: 7.365 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6651554107666016
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.016 Vali Acc: 0.133 Test Loss: 8.016 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7171785831451416
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.653 Vali Acc: 0.133 Test Loss: 8.653 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6646866798400879
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.257 Vali Acc: 0.133 Test Loss: 9.257 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7130348682403564
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.840 Vali Acc: 0.133 Test Loss: 9.840 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7103087902069092
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.407 Vali Acc: 0.200 Test Loss: 10.407 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6477859
model size : 34.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4582936763763428
Epoch: 1, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6678690910339355
Epoch: 2, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7004067897796631
Epoch: 3, Steps: 2 | Train Loss: 0.744 Vali Loss: 1.388 Vali Acc: 0.400 Test Loss: 1.388 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.7180202007293701
Epoch: 4, Steps: 2 | Train Loss: 0.696 Vali Loss: 1.906 Vali Acc: 0.200 Test Loss: 1.906 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6839680671691895
Epoch: 5, Steps: 2 | Train Loss: 0.164 Vali Loss: 3.725 Vali Acc: 0.267 Test Loss: 3.725 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.740372896194458
Epoch: 6, Steps: 2 | Train Loss: 1.179 Vali Loss: 2.699 Vali Acc: 0.267 Test Loss: 2.699 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6711838245391846
Epoch: 7, Steps: 2 | Train Loss: 0.050 Vali Loss: 5.451 Vali Acc: 0.200 Test Loss: 5.451 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7052431106567383
Epoch: 8, Steps: 2 | Train Loss: 0.433 Vali Loss: 6.457 Vali Acc: 0.400 Test Loss: 6.457 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7018845081329346
Epoch: 9, Steps: 2 | Train Loss: 0.372 Vali Loss: 4.904 Vali Acc: 0.200 Test Loss: 4.904 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7005641460418701
Epoch: 10, Steps: 2 | Train Loss: 0.002 Vali Loss: 5.863 Vali Acc: 0.267 Test Loss: 5.863 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6942358016967773
Epoch: 11, Steps: 2 | Train Loss: 0.006 Vali Loss: 5.076 Vali Acc: 0.267 Test Loss: 5.076 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7648608684539795
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.471 Vali Acc: 0.267 Test Loss: 5.471 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7184922695159912
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.041 Vali Acc: 0.267 Test Loss: 7.041 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6477859
model size : 34.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.465496778488159
Epoch: 1, Steps: 2 | Train Loss: 1.137 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.7765202522277832
Epoch: 2, Steps: 2 | Train Loss: 0.622 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7698564529418945
Epoch: 3, Steps: 2 | Train Loss: 0.484 Vali Loss: 1.700 Vali Acc: 0.333 Test Loss: 1.700 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8036611080169678
Epoch: 4, Steps: 2 | Train Loss: 0.337 Vali Loss: 2.013 Vali Acc: 0.467 Test Loss: 2.013 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8391828536987305
Epoch: 5, Steps: 2 | Train Loss: 0.032 Vali Loss: 2.732 Vali Acc: 0.333 Test Loss: 2.732 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8057892322540283
Epoch: 6, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.791 Vali Acc: 0.267 Test Loss: 3.791 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7933921813964844
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.931 Vali Acc: 0.267 Test Loss: 4.931 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9063282012939453
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.021 Vali Acc: 0.200 Test Loss: 6.021 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.745856523513794
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.029 Vali Acc: 0.200 Test Loss: 7.029 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7808883190155029
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.940 Vali Acc: 0.200 Test Loss: 7.940 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7499074935913086
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.751 Vali Acc: 0.133 Test Loss: 8.751 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 5429283
model size : 30.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5083839893341064
Epoch: 1, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7740817070007324
Epoch: 2, Steps: 2 | Train Loss: 0.608 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7987937927246094
Epoch: 3, Steps: 2 | Train Loss: 0.522 Vali Loss: 1.646 Vali Acc: 0.333 Test Loss: 1.646 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7275066375732422
Epoch: 4, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.974 Vali Acc: 0.333 Test Loss: 1.974 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7964825630187988
Epoch: 5, Steps: 2 | Train Loss: 0.060 Vali Loss: 2.611 Vali Acc: 0.267 Test Loss: 2.611 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7864365577697754
Epoch: 6, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.893 Vali Acc: 0.333 Test Loss: 3.893 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8501112461090088
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.253 Vali Acc: 0.267 Test Loss: 5.253 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7981746196746826
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.380 Vali Acc: 0.267 Test Loss: 6.380 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7152719497680664
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.395 Vali Acc: 0.267 Test Loss: 7.395 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7438831329345703
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.307 Vali Acc: 0.267 Test Loss: 8.307 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.735022783279419
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.115 Vali Acc: 0.267 Test Loss: 9.115 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5429283
model size : 30.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.393078565597534
Epoch: 1, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6745133399963379
Epoch: 2, Steps: 2 | Train Loss: 0.682 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6971337795257568
Epoch: 3, Steps: 2 | Train Loss: 0.550 Vali Loss: 1.645 Vali Acc: 0.400 Test Loss: 1.645 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7050473690032959
Epoch: 4, Steps: 2 | Train Loss: 0.419 Vali Loss: 2.156 Vali Acc: 0.267 Test Loss: 2.156 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6558160781860352
Epoch: 5, Steps: 2 | Train Loss: 0.117 Vali Loss: 3.242 Vali Acc: 0.267 Test Loss: 3.242 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7082405090332031
Epoch: 6, Steps: 2 | Train Loss: 0.072 Vali Loss: 3.810 Vali Acc: 0.200 Test Loss: 3.810 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6889400482177734
Epoch: 7, Steps: 2 | Train Loss: 0.003 Vali Loss: 4.219 Vali Acc: 0.267 Test Loss: 4.219 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7530517578125
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.708 Vali Acc: 0.200 Test Loss: 5.708 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7111063003540039
Epoch: 9, Steps: 2 | Train Loss: 0.003 Vali Loss: 6.513 Vali Acc: 0.200 Test Loss: 6.513 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7264513969421387
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.867 Vali Acc: 0.267 Test Loss: 7.867 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7019405364990234
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.288 Vali Acc: 0.200 Test Loss: 10.288 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5429283
model size : 30.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.373537063598633
Epoch: 1, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6560242176055908
Epoch: 2, Steps: 2 | Train Loss: 0.767 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6997594833374023
Epoch: 3, Steps: 2 | Train Loss: 0.724 Vali Loss: 1.530 Vali Acc: 0.400 Test Loss: 1.530 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6680529117584229
Epoch: 4, Steps: 2 | Train Loss: 0.557 Vali Loss: 1.588 Vali Acc: 0.333 Test Loss: 1.588 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6741580963134766
Epoch: 5, Steps: 2 | Train Loss: 0.301 Vali Loss: 2.554 Vali Acc: 0.333 Test Loss: 2.554 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7119183540344238
Epoch: 6, Steps: 2 | Train Loss: 0.129 Vali Loss: 3.572 Vali Acc: 0.333 Test Loss: 3.572 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7084619998931885
Epoch: 7, Steps: 2 | Train Loss: 0.142 Vali Loss: 3.306 Vali Acc: 0.200 Test Loss: 3.306 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7531864643096924
Epoch: 8, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.992 Vali Acc: 0.200 Test Loss: 3.992 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7085511684417725
Epoch: 9, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.967 Vali Acc: 0.200 Test Loss: 3.967 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6776833534240723
Epoch: 10, Steps: 2 | Train Loss: 0.010 Vali Loss: 4.392 Vali Acc: 0.333 Test Loss: 4.392 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6653223037719727
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.871 Vali Acc: 0.200 Test Loss: 5.871 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6687769889831543
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.006 Vali Acc: 0.200 Test Loss: 8.006 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5429283
model size : 30.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4645862579345703
Epoch: 1, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.238 Vali Acc: 0.467 Test Loss: 1.238 Test Acc: 0.467
Validation loss decreased (inf --> -0.466654).  Saving model ...
Epoch: 2 cost time: 0.7302327156066895
Epoch: 2, Steps: 2 | Train Loss: 0.760 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.7498900890350342
Epoch: 3, Steps: 2 | Train Loss: 0.631 Vali Loss: 1.216 Vali Acc: 0.467 Test Loss: 1.216 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7973616123199463
Epoch: 4, Steps: 2 | Train Loss: 0.349 Vali Loss: 1.977 Vali Acc: 0.333 Test Loss: 1.977 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7403907775878906
Epoch: 5, Steps: 2 | Train Loss: 0.032 Vali Loss: 2.992 Vali Acc: 0.400 Test Loss: 2.992 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7799465656280518
Epoch: 6, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.990 Vali Acc: 0.333 Test Loss: 3.990 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7210557460784912
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.044 Vali Acc: 0.400 Test Loss: 5.044 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8425259590148926
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.080 Vali Acc: 0.400 Test Loss: 6.080 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8057701587677002
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.040 Vali Acc: 0.333 Test Loss: 7.040 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8556008338928223
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.905 Vali Acc: 0.333 Test Loss: 7.905 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8356695175170898
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.677 Vali Acc: 0.333 Test Loss: 8.677 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8001110553741455
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.357 Vali Acc: 0.333 Test Loss: 9.357 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4904995
model size : 28.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.432373046875
Epoch: 1, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.226 Vali Acc: 0.467 Test Loss: 1.226 Test Acc: 0.467
Validation loss decreased (inf --> -0.466654).  Saving model ...
Epoch: 2 cost time: 0.7324995994567871
Epoch: 2, Steps: 2 | Train Loss: 0.785 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7564563751220703
Epoch: 3, Steps: 2 | Train Loss: 0.656 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7807974815368652
Epoch: 4, Steps: 2 | Train Loss: 0.419 Vali Loss: 1.971 Vali Acc: 0.333 Test Loss: 1.971 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7147457599639893
Epoch: 5, Steps: 2 | Train Loss: 0.060 Vali Loss: 2.768 Vali Acc: 0.333 Test Loss: 2.768 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.761390209197998
Epoch: 6, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.579 Vali Acc: 0.333 Test Loss: 3.579 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7741298675537109
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.717 Vali Acc: 0.200 Test Loss: 4.717 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7900104522705078
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.857 Vali Acc: 0.200 Test Loss: 5.857 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7608709335327148
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.937 Vali Acc: 0.133 Test Loss: 6.937 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7293887138366699
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.933 Vali Acc: 0.200 Test Loss: 7.933 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7150945663452148
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.828 Vali Acc: 0.200 Test Loss: 8.828 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4904995
model size : 28.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4762423038482666
Epoch: 1, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.266 Vali Acc: 0.467 Test Loss: 1.266 Test Acc: 0.467
Validation loss decreased (inf --> -0.466654).  Saving model ...
Epoch: 2 cost time: 0.7210443019866943
Epoch: 2, Steps: 2 | Train Loss: 0.847 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7128055095672607
Epoch: 3, Steps: 2 | Train Loss: 0.704 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7388246059417725
Epoch: 4, Steps: 2 | Train Loss: 0.417 Vali Loss: 1.896 Vali Acc: 0.400 Test Loss: 1.896 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6742987632751465
Epoch: 5, Steps: 2 | Train Loss: 0.403 Vali Loss: 3.452 Vali Acc: 0.267 Test Loss: 3.452 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7194383144378662
Epoch: 6, Steps: 2 | Train Loss: 0.068 Vali Loss: 3.907 Vali Acc: 0.133 Test Loss: 3.907 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7262585163116455
Epoch: 7, Steps: 2 | Train Loss: 0.011 Vali Loss: 5.818 Vali Acc: 0.133 Test Loss: 5.818 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.68479323387146
Epoch: 8, Steps: 2 | Train Loss: 0.002 Vali Loss: 6.651 Vali Acc: 0.333 Test Loss: 6.651 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7054257392883301
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.633 Vali Acc: 0.267 Test Loss: 8.633 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6851553916931152
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 9.448 Vali Acc: 0.267 Test Loss: 9.448 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7011616230010986
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.426 Vali Acc: 0.267 Test Loss: 9.426 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4904995
model size : 28.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.430847406387329
Epoch: 1, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6346626281738281
Epoch: 2, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6500918865203857
Epoch: 3, Steps: 2 | Train Loss: 0.836 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.6663484573364258
Epoch: 4, Steps: 2 | Train Loss: 0.437 Vali Loss: 1.893 Vali Acc: 0.267 Test Loss: 1.893 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.654890775680542
Epoch: 5, Steps: 2 | Train Loss: 0.258 Vali Loss: 2.681 Vali Acc: 0.400 Test Loss: 2.681 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6739785671234131
Epoch: 6, Steps: 2 | Train Loss: 0.186 Vali Loss: 4.086 Vali Acc: 0.267 Test Loss: 4.086 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7084383964538574
Epoch: 7, Steps: 2 | Train Loss: 0.787 Vali Loss: 3.711 Vali Acc: 0.267 Test Loss: 3.711 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6326909065246582
Epoch: 8, Steps: 2 | Train Loss: 0.115 Vali Loss: 3.459 Vali Acc: 0.267 Test Loss: 3.459 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.662438154220581
Epoch: 9, Steps: 2 | Train Loss: 0.015 Vali Loss: 4.855 Vali Acc: 0.200 Test Loss: 4.855 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6691632270812988
Epoch: 10, Steps: 2 | Train Loss: 0.156 Vali Loss: 7.272 Vali Acc: 0.267 Test Loss: 7.272 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6654202938079834
Epoch: 11, Steps: 2 | Train Loss: 0.024 Vali Loss: 4.914 Vali Acc: 0.200 Test Loss: 4.914 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6784512996673584
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.375 Vali Acc: 0.200 Test Loss: 6.375 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6713156700134277
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 8.728 Vali Acc: 0.200 Test Loss: 8.728 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4904995
model size : 28.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2013261318206787
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5460829734802246
Epoch: 2, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5327756404876709
Epoch: 3, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5375959873199463
Epoch: 4, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.038 Vali Acc: 0.267 Test Loss: 1.038 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5577309131622314
Epoch: 5, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5750763416290283
Epoch: 6, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.440 Vali Acc: 0.400 Test Loss: 1.440 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6195328235626221
Epoch: 7, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.752 Vali Acc: 0.533 Test Loss: 1.752 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533316).  Saving model ...
Epoch: 8 cost time: 0.6401915550231934
Epoch: 8, Steps: 1 | Train Loss: 0.008 Vali Loss: 2.620 Vali Acc: 0.400 Test Loss: 2.620 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5645339488983154
Epoch: 9, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.717 Vali Acc: 0.333 Test Loss: 3.717 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5771832466125488
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.880 Vali Acc: 0.333 Test Loss: 4.880 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5580894947052002
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.046 Vali Acc: 0.333 Test Loss: 6.046 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5423755645751953
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.190 Vali Acc: 0.333 Test Loss: 7.190 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5776817798614502
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.299 Vali Acc: 0.333 Test Loss: 8.299 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5731279850006104
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.365 Vali Acc: 0.333 Test Loss: 9.365 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5729961395263672
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.383 Vali Acc: 0.333 Test Loss: 10.383 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5845232009887695
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 11.352 Vali Acc: 0.333 Test Loss: 11.352 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5593111515045166
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 12.272 Vali Acc: 0.333 Test Loss: 12.272 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4642851
model size : 27.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4482429027557373
Epoch: 1, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7013654708862305
Epoch: 2, Steps: 2 | Train Loss: 0.839 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7203090190887451
Epoch: 3, Steps: 2 | Train Loss: 0.520 Vali Loss: 1.513 Vali Acc: 0.400 Test Loss: 1.513 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7217690944671631
Epoch: 4, Steps: 2 | Train Loss: 0.222 Vali Loss: 3.168 Vali Acc: 0.333 Test Loss: 3.168 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7019660472869873
Epoch: 5, Steps: 2 | Train Loss: 0.324 Vali Loss: 3.769 Vali Acc: 0.267 Test Loss: 3.769 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.749056339263916
Epoch: 6, Steps: 2 | Train Loss: 0.023 Vali Loss: 4.483 Vali Acc: 0.267 Test Loss: 4.483 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6982593536376953
Epoch: 7, Steps: 2 | Train Loss: 0.004 Vali Loss: 5.607 Vali Acc: 0.333 Test Loss: 5.607 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6886253356933594
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.953 Vali Acc: 0.267 Test Loss: 6.953 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6889967918395996
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.869 Vali Acc: 0.267 Test Loss: 8.869 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7360436916351318
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.822 Vali Acc: 0.133 Test Loss: 10.822 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6729128360748291
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.670 Vali Acc: 0.133 Test Loss: 12.670 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4642851
model size : 27.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4520201683044434
Epoch: 1, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7134361267089844
Epoch: 2, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.7092392444610596
Epoch: 3, Steps: 2 | Train Loss: 0.586 Vali Loss: 1.395 Vali Acc: 0.400 Test Loss: 1.395 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7466678619384766
Epoch: 4, Steps: 2 | Train Loss: 0.245 Vali Loss: 2.796 Vali Acc: 0.267 Test Loss: 2.796 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7331969738006592
Epoch: 5, Steps: 2 | Train Loss: 0.303 Vali Loss: 3.225 Vali Acc: 0.333 Test Loss: 3.225 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7150170803070068
Epoch: 6, Steps: 2 | Train Loss: 0.092 Vali Loss: 4.259 Vali Acc: 0.267 Test Loss: 4.259 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7089738845825195
Epoch: 7, Steps: 2 | Train Loss: 0.060 Vali Loss: 4.956 Vali Acc: 0.333 Test Loss: 4.956 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7143337726593018
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.795 Vali Acc: 0.267 Test Loss: 5.795 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6850097179412842
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.870 Vali Acc: 0.133 Test Loss: 7.870 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7675700187683105
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.994 Vali Acc: 0.133 Test Loss: 9.994 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7037928104400635
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.759 Vali Acc: 0.200 Test Loss: 11.759 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7546131610870361
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.801 Vali Acc: 0.200 Test Loss: 12.801 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4642851
model size : 27.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.414261817932129
Epoch: 1, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6565537452697754
Epoch: 2, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.7020645141601562
Epoch: 3, Steps: 2 | Train Loss: 0.736 Vali Loss: 1.550 Vali Acc: 0.333 Test Loss: 1.550 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333318).  Saving model ...
Epoch: 4 cost time: 0.7561452388763428
Epoch: 4, Steps: 2 | Train Loss: 0.418 Vali Loss: 3.273 Vali Acc: 0.333 Test Loss: 3.273 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6784636974334717
Epoch: 5, Steps: 2 | Train Loss: 0.745 Vali Loss: 3.701 Vali Acc: 0.333 Test Loss: 3.701 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6493515968322754
Epoch: 6, Steps: 2 | Train Loss: 0.610 Vali Loss: 3.273 Vali Acc: 0.200 Test Loss: 3.273 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6776578426361084
Epoch: 7, Steps: 2 | Train Loss: 1.838 Vali Loss: 9.842 Vali Acc: 0.333 Test Loss: 9.842 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6697204113006592
Epoch: 8, Steps: 2 | Train Loss: 1.701 Vali Loss: 6.094 Vali Acc: 0.267 Test Loss: 6.094 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6669270992279053
Epoch: 9, Steps: 2 | Train Loss: 0.142 Vali Loss: 8.744 Vali Acc: 0.333 Test Loss: 8.744 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6683979034423828
Epoch: 10, Steps: 2 | Train Loss: 0.551 Vali Loss: 9.190 Vali Acc: 0.200 Test Loss: 9.190 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.741020679473877
Epoch: 11, Steps: 2 | Train Loss: 0.716 Vali Loss: 9.460 Vali Acc: 0.267 Test Loss: 9.460 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6998121738433838
Epoch: 12, Steps: 2 | Train Loss: 0.047 Vali Loss: 7.702 Vali Acc: 0.267 Test Loss: 7.702 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.715933084487915
Epoch: 13, Steps: 2 | Train Loss: 0.013 Vali Loss: 12.102 Vali Acc: 0.333 Test Loss: 12.102 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4642851
model size : 27.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6337430477142334
Epoch: 1, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.7208857536315918
Epoch: 2, Steps: 2 | Train Loss: 0.791 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7351400852203369
Epoch: 3, Steps: 2 | Train Loss: 0.658 Vali Loss: 1.290 Vali Acc: 0.467 Test Loss: 1.290 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7550797462463379
Epoch: 4, Steps: 2 | Train Loss: 0.138 Vali Loss: 2.916 Vali Acc: 0.267 Test Loss: 2.916 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7879734039306641
Epoch: 5, Steps: 2 | Train Loss: 0.754 Vali Loss: 4.892 Vali Acc: 0.267 Test Loss: 4.892 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7403011322021484
Epoch: 6, Steps: 2 | Train Loss: 0.060 Vali Loss: 5.496 Vali Acc: 0.267 Test Loss: 5.496 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7473289966583252
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.820 Vali Acc: 0.333 Test Loss: 10.820 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7592923641204834
Epoch: 8, Steps: 2 | Train Loss: 1.004 Vali Loss: 12.169 Vali Acc: 0.333 Test Loss: 12.169 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7625117301940918
Epoch: 9, Steps: 2 | Train Loss: 0.010 Vali Loss: 8.350 Vali Acc: 0.400 Test Loss: 8.350 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7646682262420654
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.452 Vali Acc: 0.133 Test Loss: 11.452 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7299273014068604
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 16.082 Vali Acc: 0.133 Test Loss: 16.082 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4511779
model size : 26.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4886434078216553
Epoch: 1, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6951916217803955
Epoch: 2, Steps: 2 | Train Loss: 0.841 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7197113037109375
Epoch: 3, Steps: 2 | Train Loss: 0.698 Vali Loss: 1.271 Vali Acc: 0.267 Test Loss: 1.271 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7371039390563965
Epoch: 4, Steps: 2 | Train Loss: 0.198 Vali Loss: 2.198 Vali Acc: 0.133 Test Loss: 2.198 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7508583068847656
Epoch: 5, Steps: 2 | Train Loss: 0.469 Vali Loss: 3.974 Vali Acc: 0.267 Test Loss: 3.974 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7462747097015381
Epoch: 6, Steps: 2 | Train Loss: 0.025 Vali Loss: 6.890 Vali Acc: 0.333 Test Loss: 6.890 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7690649032592773
Epoch: 7, Steps: 2 | Train Loss: 0.018 Vali Loss: 7.256 Vali Acc: 0.267 Test Loss: 7.256 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7294745445251465
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.787 Vali Acc: 0.267 Test Loss: 7.787 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7602591514587402
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.445 Vali Acc: 0.400 Test Loss: 8.445 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399916).  Saving model ...
Epoch: 10 cost time: 0.730144739151001
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.164 Vali Acc: 0.400 Test Loss: 9.164 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7712228298187256
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.886 Vali Acc: 0.400 Test Loss: 9.886 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7435126304626465
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.588 Vali Acc: 0.333 Test Loss: 10.588 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.812291145324707
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.231 Vali Acc: 0.333 Test Loss: 11.231 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7585015296936035
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.810 Vali Acc: 0.333 Test Loss: 11.810 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7537884712219238
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.322 Vali Acc: 0.333 Test Loss: 12.322 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7557284832000732
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 12.769 Vali Acc: 0.333 Test Loss: 12.769 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7243661880493164
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.157 Vali Acc: 0.333 Test Loss: 13.157 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7372791767120361
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.495 Vali Acc: 0.333 Test Loss: 13.495 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7649571895599365
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 13.782 Vali Acc: 0.333 Test Loss: 13.782 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4511779
model size : 26.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3502745628356934
Epoch: 1, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.7615764141082764
Epoch: 2, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.739633321762085
Epoch: 3, Steps: 2 | Train Loss: 0.796 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7170088291168213
Epoch: 4, Steps: 2 | Train Loss: 0.347 Vali Loss: 1.852 Vali Acc: 0.400 Test Loss: 1.852 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7596836090087891
Epoch: 5, Steps: 2 | Train Loss: 0.570 Vali Loss: 4.176 Vali Acc: 0.267 Test Loss: 4.176 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7436606884002686
Epoch: 6, Steps: 2 | Train Loss: 0.198 Vali Loss: 4.285 Vali Acc: 0.200 Test Loss: 4.285 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8164553642272949
Epoch: 7, Steps: 2 | Train Loss: 0.002 Vali Loss: 4.992 Vali Acc: 0.200 Test Loss: 4.992 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7535343170166016
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.439 Vali Acc: 0.200 Test Loss: 5.439 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.739037275314331
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.910 Vali Acc: 0.267 Test Loss: 5.910 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7613654136657715
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.605 Vali Acc: 0.267 Test Loss: 6.605 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.714261531829834
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.392 Vali Acc: 0.267 Test Loss: 7.392 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4511779
model size : 26.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2378532886505127
Epoch: 1, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7206072807312012
Epoch: 2, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.205 Vali Acc: 0.133 Test Loss: 1.205 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7607195377349854
Epoch: 3, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.365 Vali Acc: 0.267 Test Loss: 1.365 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7134182453155518
Epoch: 4, Steps: 2 | Train Loss: 0.591 Vali Loss: 1.802 Vali Acc: 0.267 Test Loss: 1.802 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7377743721008301
Epoch: 5, Steps: 2 | Train Loss: 0.525 Vali Loss: 2.334 Vali Acc: 0.133 Test Loss: 2.334 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7607312202453613
Epoch: 6, Steps: 2 | Train Loss: 0.167 Vali Loss: 2.733 Vali Acc: 0.267 Test Loss: 2.733 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7141828536987305
Epoch: 7, Steps: 2 | Train Loss: 0.074 Vali Loss: 3.538 Vali Acc: 0.133 Test Loss: 3.538 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7404422760009766
Epoch: 8, Steps: 2 | Train Loss: 0.009 Vali Loss: 3.495 Vali Acc: 0.200 Test Loss: 3.495 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6995894908905029
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.487 Vali Acc: 0.200 Test Loss: 4.487 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7006070613861084
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.549 Vali Acc: 0.133 Test Loss: 5.549 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7288141250610352
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.262 Vali Acc: 0.133 Test Loss: 6.262 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4511779
model size : 26.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3123879432678223
Epoch: 1, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7520911693572998
Epoch: 2, Steps: 2 | Train Loss: 0.852 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7602357864379883
Epoch: 3, Steps: 2 | Train Loss: 0.537 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7766423225402832
Epoch: 4, Steps: 2 | Train Loss: 0.236 Vali Loss: 1.930 Vali Acc: 0.467 Test Loss: 1.930 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466647).  Saving model ...
Epoch: 5 cost time: 0.7868552207946777
Epoch: 5, Steps: 2 | Train Loss: 0.032 Vali Loss: 2.551 Vali Acc: 0.400 Test Loss: 2.551 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7812011241912842
Epoch: 6, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.557 Vali Acc: 0.200 Test Loss: 3.557 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7807576656341553
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.865 Vali Acc: 0.267 Test Loss: 4.865 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8297774791717529
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.120 Vali Acc: 0.333 Test Loss: 6.120 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7681872844696045
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.262 Vali Acc: 0.333 Test Loss: 7.262 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7915639877319336
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.283 Vali Acc: 0.333 Test Loss: 8.283 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7696669101715088
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.182 Vali Acc: 0.333 Test Loss: 9.182 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7731783390045166
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.958 Vali Acc: 0.333 Test Loss: 9.958 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7355973720550537
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 10.640 Vali Acc: 0.333 Test Loss: 10.640 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7634046077728271
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 11.233 Vali Acc: 0.333 Test Loss: 11.233 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4446243
model size : 26.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.478308916091919
Epoch: 1, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7056684494018555
Epoch: 2, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6963248252868652
Epoch: 3, Steps: 2 | Train Loss: 0.586 Vali Loss: 1.405 Vali Acc: 0.333 Test Loss: 1.405 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7699284553527832
Epoch: 4, Steps: 2 | Train Loss: 0.281 Vali Loss: 1.764 Vali Acc: 0.267 Test Loss: 1.764 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.756915807723999
Epoch: 5, Steps: 2 | Train Loss: 0.060 Vali Loss: 2.573 Vali Acc: 0.333 Test Loss: 2.573 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6741158962249756
Epoch: 6, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.658 Vali Acc: 0.333 Test Loss: 3.658 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6870224475860596
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.682 Vali Acc: 0.333 Test Loss: 4.682 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8431499004364014
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.637 Vali Acc: 0.333 Test Loss: 5.637 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7395312786102295
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.506 Vali Acc: 0.333 Test Loss: 6.506 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7262749671936035
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.289 Vali Acc: 0.333 Test Loss: 7.289 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7099759578704834
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.983 Vali Acc: 0.333 Test Loss: 7.983 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4446243
model size : 26.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.513833999633789
Epoch: 1, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6754856109619141
Epoch: 2, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6782236099243164
Epoch: 3, Steps: 2 | Train Loss: 0.666 Vali Loss: 1.464 Vali Acc: 0.400 Test Loss: 1.464 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 0.6996796131134033
Epoch: 4, Steps: 2 | Train Loss: 0.368 Vali Loss: 1.655 Vali Acc: 0.333 Test Loss: 1.655 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6997499465942383
Epoch: 5, Steps: 2 | Train Loss: 0.128 Vali Loss: 2.144 Vali Acc: 0.267 Test Loss: 2.144 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6931760311126709
Epoch: 6, Steps: 2 | Train Loss: 0.029 Vali Loss: 3.049 Vali Acc: 0.267 Test Loss: 3.049 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6801755428314209
Epoch: 7, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.213 Vali Acc: 0.267 Test Loss: 4.213 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7148001194000244
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.613 Vali Acc: 0.200 Test Loss: 5.613 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6633925437927246
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.425 Vali Acc: 0.200 Test Loss: 6.425 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6734964847564697
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.014 Vali Acc: 0.267 Test Loss: 7.014 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7186005115509033
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.500 Vali Acc: 0.267 Test Loss: 7.500 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.660407543182373
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.940 Vali Acc: 0.267 Test Loss: 7.940 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6711475849151611
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.329 Vali Acc: 0.267 Test Loss: 8.329 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4446243
model size : 26.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5126662254333496
Epoch: 1, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6980292797088623
Epoch: 2, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.175 Vali Acc: 0.133 Test Loss: 1.175 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7154488563537598
Epoch: 3, Steps: 2 | Train Loss: 0.786 Vali Loss: 1.655 Vali Acc: 0.333 Test Loss: 1.655 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.73663330078125
Epoch: 4, Steps: 2 | Train Loss: 0.665 Vali Loss: 1.797 Vali Acc: 0.267 Test Loss: 1.797 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.704089879989624
Epoch: 5, Steps: 2 | Train Loss: 0.532 Vali Loss: 1.836 Vali Acc: 0.333 Test Loss: 1.836 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7155892848968506
Epoch: 6, Steps: 2 | Train Loss: 0.572 Vali Loss: 3.649 Vali Acc: 0.333 Test Loss: 3.649 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7109520435333252
Epoch: 7, Steps: 2 | Train Loss: 0.294 Vali Loss: 3.670 Vali Acc: 0.267 Test Loss: 3.670 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7759168148040771
Epoch: 8, Steps: 2 | Train Loss: 0.194 Vali Loss: 5.388 Vali Acc: 0.200 Test Loss: 5.388 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.713951826095581
Epoch: 9, Steps: 2 | Train Loss: 0.129 Vali Loss: 3.637 Vali Acc: 0.200 Test Loss: 3.637 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7089009284973145
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.455 Vali Acc: 0.200 Test Loss: 6.455 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.706538200378418
Epoch: 11, Steps: 2 | Train Loss: 0.003 Vali Loss: 7.052 Vali Acc: 0.133 Test Loss: 7.052 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4446243
model size : 26.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.381295919418335
Epoch: 1, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6646685600280762
Epoch: 2, Steps: 2 | Train Loss: 0.774 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7099800109863281
Epoch: 3, Steps: 2 | Train Loss: 0.599 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6906840801239014
Epoch: 4, Steps: 2 | Train Loss: 0.350 Vali Loss: 1.351 Vali Acc: 0.333 Test Loss: 1.351 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6836202144622803
Epoch: 5, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.751 Vali Acc: 0.400 Test Loss: 1.751 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399982).  Saving model ...
Epoch: 6 cost time: 0.7240166664123535
Epoch: 6, Steps: 2 | Train Loss: 0.015 Vali Loss: 3.035 Vali Acc: 0.333 Test Loss: 3.035 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7206764221191406
Epoch: 7, Steps: 2 | Train Loss: 0.031 Vali Loss: 3.446 Vali Acc: 0.333 Test Loss: 3.446 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6801788806915283
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.638 Vali Acc: 0.400 Test Loss: 3.638 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6934249401092529
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.409 Vali Acc: 0.467 Test Loss: 4.409 Test Acc: 0.467
Validation loss decreased (-0.399982 --> -0.466623).  Saving model ...
Epoch: 10 cost time: 0.6830849647521973
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.402 Vali Acc: 0.400 Test Loss: 5.402 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6412012577056885
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.264 Vali Acc: 0.400 Test Loss: 6.264 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6919176578521729
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.756 Vali Acc: 0.400 Test Loss: 6.756 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7433485984802246
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.098 Vali Acc: 0.400 Test Loss: 7.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7557215690612793
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.345 Vali Acc: 0.400 Test Loss: 7.345 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.695610523223877
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.553 Vali Acc: 0.400 Test Loss: 7.553 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6491906642913818
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.732 Vali Acc: 0.400 Test Loss: 7.732 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.664766788482666
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.890 Vali Acc: 0.400 Test Loss: 7.890 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6166319847106934
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.031 Vali Acc: 0.400 Test Loss: 8.031 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6369411945343018
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.154 Vali Acc: 0.467 Test Loss: 8.154 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3107875
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.381340742111206
Epoch: 1, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5724375247955322
Epoch: 2, Steps: 2 | Train Loss: 0.838 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6538600921630859
Epoch: 3, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6411337852478027
Epoch: 4, Steps: 2 | Train Loss: 0.393 Vali Loss: 1.341 Vali Acc: 0.333 Test Loss: 1.341 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6926226615905762
Epoch: 5, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.625 Vali Acc: 0.333 Test Loss: 1.625 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6445300579071045
Epoch: 6, Steps: 2 | Train Loss: 0.046 Vali Loss: 2.415 Vali Acc: 0.267 Test Loss: 2.415 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6349766254425049
Epoch: 7, Steps: 2 | Train Loss: 0.023 Vali Loss: 3.078 Vali Acc: 0.200 Test Loss: 3.078 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6610629558563232
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.361 Vali Acc: 0.200 Test Loss: 3.361 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6211967468261719
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.932 Vali Acc: 0.333 Test Loss: 3.932 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6798043251037598
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.807 Vali Acc: 0.400 Test Loss: 4.807 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6574413776397705
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.714 Vali Acc: 0.267 Test Loss: 5.714 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3107875
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3046464920043945
Epoch: 1, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5899906158447266
Epoch: 2, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6442382335662842
Epoch: 3, Steps: 2 | Train Loss: 0.689 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6144766807556152
Epoch: 4, Steps: 2 | Train Loss: 0.456 Vali Loss: 1.382 Vali Acc: 0.200 Test Loss: 1.382 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.635042667388916
Epoch: 5, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.588 Vali Acc: 0.333 Test Loss: 1.588 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333317).  Saving model ...
Epoch: 6 cost time: 0.6431667804718018
Epoch: 6, Steps: 2 | Train Loss: 0.054 Vali Loss: 2.438 Vali Acc: 0.333 Test Loss: 2.438 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6198043823242188
Epoch: 7, Steps: 2 | Train Loss: 0.099 Vali Loss: 2.587 Vali Acc: 0.267 Test Loss: 2.587 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6499850749969482
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.623 Vali Acc: 0.333 Test Loss: 2.623 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6178667545318604
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.125 Vali Acc: 0.333 Test Loss: 3.125 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6339912414550781
Epoch: 10, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.319 Vali Acc: 0.333 Test Loss: 3.319 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6100306510925293
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.638 Vali Acc: 0.333 Test Loss: 3.638 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6371767520904541
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.146 Vali Acc: 0.200 Test Loss: 4.146 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.577345609664917
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.704 Vali Acc: 0.200 Test Loss: 4.704 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6852517127990723
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.253 Vali Acc: 0.267 Test Loss: 5.253 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6832189559936523
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.761 Vali Acc: 0.267 Test Loss: 5.761 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3107875
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.355339288711548
Epoch: 1, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.165 Vali Acc: 0.067 Test Loss: 1.165 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.5321331024169922
Epoch: 2, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
Validation loss decreased (-0.066655 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5854525566101074
Epoch: 3, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.334 Vali Acc: 0.267 Test Loss: 1.334 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266653).  Saving model ...
Epoch: 4 cost time: 0.568079948425293
Epoch: 4, Steps: 2 | Train Loss: 0.685 Vali Loss: 1.328 Vali Acc: 0.200 Test Loss: 1.328 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5586850643157959
Epoch: 5, Steps: 2 | Train Loss: 0.279 Vali Loss: 1.468 Vali Acc: 0.200 Test Loss: 1.468 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5601861476898193
Epoch: 6, Steps: 2 | Train Loss: 0.277 Vali Loss: 1.810 Vali Acc: 0.267 Test Loss: 1.810 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5462512969970703
Epoch: 7, Steps: 2 | Train Loss: 0.233 Vali Loss: 2.136 Vali Acc: 0.200 Test Loss: 2.136 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5947484970092773
Epoch: 8, Steps: 2 | Train Loss: 0.443 Vali Loss: 2.793 Vali Acc: 0.200 Test Loss: 2.793 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5808422565460205
Epoch: 9, Steps: 2 | Train Loss: 0.176 Vali Loss: 3.571 Vali Acc: 0.267 Test Loss: 3.571 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5701065063476562
Epoch: 10, Steps: 2 | Train Loss: 0.204 Vali Loss: 2.712 Vali Acc: 0.200 Test Loss: 2.712 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5760695934295654
Epoch: 11, Steps: 2 | Train Loss: 0.030 Vali Loss: 3.828 Vali Acc: 0.267 Test Loss: 3.828 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5470900535583496
Epoch: 12, Steps: 2 | Train Loss: 0.016 Vali Loss: 3.725 Vali Acc: 0.333 Test Loss: 3.725 Test Acc: 0.333
Validation loss decreased (-0.266653 --> -0.333296).  Saving model ...
Epoch: 13 cost time: 0.5785374641418457
Epoch: 13, Steps: 2 | Train Loss: 0.040 Vali Loss: 3.381 Vali Acc: 0.133 Test Loss: 3.381 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5406365394592285
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.106 Vali Acc: 0.333 Test Loss: 4.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.569049596786499
Epoch: 15, Steps: 2 | Train Loss: 0.061 Vali Loss: 4.063 Vali Acc: 0.333 Test Loss: 4.063 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5823705196380615
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.757 Vali Acc: 0.200 Test Loss: 3.757 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5781879425048828
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.938 Vali Acc: 0.267 Test Loss: 4.938 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6352336406707764
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.352 Vali Acc: 0.267 Test Loss: 6.352 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6215932369232178
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 6.307 Vali Acc: 0.267 Test Loss: 6.307 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6093413829803467
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.197 Vali Acc: 0.200 Test Loss: 5.197 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5584516525268555
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.756 Vali Acc: 0.133 Test Loss: 4.756 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5936794281005859
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.049 Vali Acc: 0.267 Test Loss: 5.049 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3107875
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3958380222320557
Epoch: 1, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6287014484405518
Epoch: 2, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6086246967315674
Epoch: 3, Steps: 2 | Train Loss: 0.681 Vali Loss: 1.259 Vali Acc: 0.400 Test Loss: 1.259 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6192827224731445
Epoch: 4, Steps: 2 | Train Loss: 0.401 Vali Loss: 1.457 Vali Acc: 0.400 Test Loss: 1.457 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5958094596862793
Epoch: 5, Steps: 2 | Train Loss: 0.365 Vali Loss: 2.137 Vali Acc: 0.333 Test Loss: 2.137 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6370913982391357
Epoch: 6, Steps: 2 | Train Loss: 0.051 Vali Loss: 2.899 Vali Acc: 0.133 Test Loss: 2.899 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.651921272277832
Epoch: 7, Steps: 2 | Train Loss: 0.031 Vali Loss: 4.382 Vali Acc: 0.200 Test Loss: 4.382 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6247196197509766
Epoch: 8, Steps: 2 | Train Loss: 0.025 Vali Loss: 3.915 Vali Acc: 0.200 Test Loss: 3.915 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6406600475311279
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.803 Vali Acc: 0.333 Test Loss: 4.803 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6217658519744873
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.533 Vali Acc: 0.267 Test Loss: 6.533 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6309623718261719
Epoch: 11, Steps: 2 | Train Loss: 0.004 Vali Loss: 6.667 Vali Acc: 0.400 Test Loss: 6.667 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.667360782623291
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.635 Vali Acc: 0.333 Test Loss: 6.635 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2583587
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.360062837600708
Epoch: 1, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6042954921722412
Epoch: 2, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.587104082107544
Epoch: 3, Steps: 2 | Train Loss: 0.724 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6231207847595215
Epoch: 4, Steps: 2 | Train Loss: 0.459 Vali Loss: 1.350 Vali Acc: 0.333 Test Loss: 1.350 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.624321699142456
Epoch: 5, Steps: 2 | Train Loss: 0.439 Vali Loss: 2.046 Vali Acc: 0.267 Test Loss: 2.046 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6413216590881348
Epoch: 6, Steps: 2 | Train Loss: 0.081 Vali Loss: 2.688 Vali Acc: 0.267 Test Loss: 2.688 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6187038421630859
Epoch: 7, Steps: 2 | Train Loss: 0.053 Vali Loss: 4.134 Vali Acc: 0.267 Test Loss: 4.134 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6078038215637207
Epoch: 8, Steps: 2 | Train Loss: 0.097 Vali Loss: 3.645 Vali Acc: 0.133 Test Loss: 3.645 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5804049968719482
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.333 Vali Acc: 0.267 Test Loss: 4.333 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6413509845733643
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 5.656 Vali Acc: 0.333 Test Loss: 5.656 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5438797473907471
Epoch: 11, Steps: 2 | Train Loss: 0.004 Vali Loss: 5.323 Vali Acc: 0.333 Test Loss: 5.323 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6197493076324463
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.197 Vali Acc: 0.200 Test Loss: 6.197 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2583587
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4250218868255615
Epoch: 1, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5624661445617676
Epoch: 2, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.555056095123291
Epoch: 3, Steps: 2 | Train Loss: 0.801 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5201871395111084
Epoch: 4, Steps: 2 | Train Loss: 0.496 Vali Loss: 1.416 Vali Acc: 0.400 Test Loss: 1.416 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5489251613616943
Epoch: 5, Steps: 2 | Train Loss: 0.533 Vali Loss: 1.938 Vali Acc: 0.333 Test Loss: 1.938 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5195193290710449
Epoch: 6, Steps: 2 | Train Loss: 0.101 Vali Loss: 2.964 Vali Acc: 0.267 Test Loss: 2.964 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5440881252288818
Epoch: 7, Steps: 2 | Train Loss: 0.229 Vali Loss: 4.402 Vali Acc: 0.333 Test Loss: 4.402 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5548827648162842
Epoch: 8, Steps: 2 | Train Loss: 0.384 Vali Loss: 3.259 Vali Acc: 0.133 Test Loss: 3.259 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5347630977630615
Epoch: 9, Steps: 2 | Train Loss: 0.008 Vali Loss: 4.125 Vali Acc: 0.267 Test Loss: 4.125 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5183401107788086
Epoch: 10, Steps: 2 | Train Loss: 0.030 Vali Loss: 4.795 Vali Acc: 0.267 Test Loss: 4.795 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5396337509155273
Epoch: 11, Steps: 2 | Train Loss: 0.028 Vali Loss: 4.061 Vali Acc: 0.267 Test Loss: 4.061 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2583587
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.400174379348755
Epoch: 1, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5232739448547363
Epoch: 2, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5264933109283447
Epoch: 3, Steps: 2 | Train Loss: 0.926 Vali Loss: 1.364 Vali Acc: 0.267 Test Loss: 1.364 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5433077812194824
Epoch: 4, Steps: 2 | Train Loss: 0.634 Vali Loss: 1.707 Vali Acc: 0.267 Test Loss: 1.707 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5144045352935791
Epoch: 5, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.603 Vali Acc: 0.333 Test Loss: 1.603 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333317).  Saving model ...
Epoch: 6 cost time: 0.5241391658782959
Epoch: 6, Steps: 2 | Train Loss: 0.200 Vali Loss: 3.041 Vali Acc: 0.400 Test Loss: 3.041 Test Acc: 0.400
Validation loss decreased (-0.333317 --> -0.399970).  Saving model ...
Epoch: 7 cost time: 0.525083065032959
Epoch: 7, Steps: 2 | Train Loss: 0.516 Vali Loss: 3.575 Vali Acc: 0.333 Test Loss: 3.575 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5440154075622559
Epoch: 8, Steps: 2 | Train Loss: 0.613 Vali Loss: 2.162 Vali Acc: 0.133 Test Loss: 2.162 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.527942419052124
Epoch: 9, Steps: 2 | Train Loss: 0.303 Vali Loss: 4.020 Vali Acc: 0.267 Test Loss: 4.020 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5232267379760742
Epoch: 10, Steps: 2 | Train Loss: 0.507 Vali Loss: 3.678 Vali Acc: 0.267 Test Loss: 3.678 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.521660566329956
Epoch: 11, Steps: 2 | Train Loss: 0.234 Vali Loss: 3.016 Vali Acc: 0.133 Test Loss: 3.016 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5704078674316406
Epoch: 12, Steps: 2 | Train Loss: 0.003 Vali Loss: 4.529 Vali Acc: 0.267 Test Loss: 4.529 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5389983654022217
Epoch: 13, Steps: 2 | Train Loss: 0.041 Vali Loss: 4.198 Vali Acc: 0.133 Test Loss: 4.198 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5213909149169922
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.951 Vali Acc: 0.067 Test Loss: 3.951 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5269925594329834
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.233 Vali Acc: 0.267 Test Loss: 4.233 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5625581741333008
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 4.095 Vali Acc: 0.200 Test Loss: 4.095 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2583587
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.495093822479248
Epoch: 1, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6000652313232422
Epoch: 2, Steps: 2 | Train Loss: 0.841 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6561768054962158
Epoch: 3, Steps: 2 | Train Loss: 0.581 Vali Loss: 1.326 Vali Acc: 0.333 Test Loss: 1.326 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5730087757110596
Epoch: 4, Steps: 2 | Train Loss: 0.335 Vali Loss: 1.406 Vali Acc: 0.267 Test Loss: 1.406 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6351451873779297
Epoch: 5, Steps: 2 | Train Loss: 0.120 Vali Loss: 1.842 Vali Acc: 0.333 Test Loss: 1.842 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6477437019348145
Epoch: 6, Steps: 2 | Train Loss: 0.028 Vali Loss: 2.209 Vali Acc: 0.400 Test Loss: 2.209 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399978).  Saving model ...
Epoch: 7 cost time: 0.6518681049346924
Epoch: 7, Steps: 2 | Train Loss: 0.004 Vali Loss: 3.182 Vali Acc: 0.333 Test Loss: 3.182 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6528754234313965
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.016 Vali Acc: 0.400 Test Loss: 4.016 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6290497779846191
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.746 Vali Acc: 0.267 Test Loss: 4.746 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6338028907775879
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.328 Vali Acc: 0.200 Test Loss: 5.328 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6918895244598389
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.848 Vali Acc: 0.200 Test Loss: 5.848 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6631462574005127
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.299 Vali Acc: 0.200 Test Loss: 6.299 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6360573768615723
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.692 Vali Acc: 0.200 Test Loss: 6.692 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6233251094818115
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.037 Vali Acc: 0.200 Test Loss: 7.037 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6143782138824463
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.339 Vali Acc: 0.200 Test Loss: 7.339 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6810882091522217
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.599 Vali Acc: 0.200 Test Loss: 7.599 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2321443
model size : 13.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.416865825653076
Epoch: 1, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6154687404632568
Epoch: 2, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6230525970458984
Epoch: 3, Steps: 2 | Train Loss: 0.642 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.6469600200653076
Epoch: 4, Steps: 2 | Train Loss: 0.353 Vali Loss: 1.432 Vali Acc: 0.200 Test Loss: 1.432 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6190850734710693
Epoch: 5, Steps: 2 | Train Loss: 0.142 Vali Loss: 1.765 Vali Acc: 0.267 Test Loss: 1.765 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6679649353027344
Epoch: 6, Steps: 2 | Train Loss: 0.048 Vali Loss: 2.092 Vali Acc: 0.400 Test Loss: 2.092 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399979).  Saving model ...
Epoch: 7 cost time: 0.6869668960571289
Epoch: 7, Steps: 2 | Train Loss: 0.011 Vali Loss: 2.741 Vali Acc: 0.267 Test Loss: 2.741 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6696271896362305
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.238 Vali Acc: 0.200 Test Loss: 3.238 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6090700626373291
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.715 Vali Acc: 0.200 Test Loss: 3.715 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7386975288391113
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.159 Vali Acc: 0.133 Test Loss: 4.159 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6451406478881836
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.563 Vali Acc: 0.133 Test Loss: 4.563 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6034872531890869
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.926 Vali Acc: 0.133 Test Loss: 4.926 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6100015640258789
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.247 Vali Acc: 0.133 Test Loss: 5.247 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5825052261352539
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.529 Vali Acc: 0.133 Test Loss: 5.529 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5882828235626221
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.776 Vali Acc: 0.133 Test Loss: 5.776 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5904109477996826
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.991 Vali Acc: 0.133 Test Loss: 5.991 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2321443
model size : 13.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.379685878753662
Epoch: 1, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.110 Vali Acc: 0.133 Test Loss: 1.110 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.5573692321777344
Epoch: 2, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5077049732208252
Epoch: 3, Steps: 2 | Train Loss: 0.693 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5680947303771973
Epoch: 4, Steps: 2 | Train Loss: 0.401 Vali Loss: 1.374 Vali Acc: 0.200 Test Loss: 1.374 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5097706317901611
Epoch: 5, Steps: 2 | Train Loss: 0.184 Vali Loss: 1.552 Vali Acc: 0.333 Test Loss: 1.552 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333318).  Saving model ...
Epoch: 6 cost time: 0.5296688079833984
Epoch: 6, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.793 Vali Acc: 0.267 Test Loss: 1.793 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5627753734588623
Epoch: 7, Steps: 2 | Train Loss: 0.048 Vali Loss: 2.555 Vali Acc: 0.267 Test Loss: 2.555 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5139179229736328
Epoch: 8, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.579 Vali Acc: 0.333 Test Loss: 2.579 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.539334774017334
Epoch: 9, Steps: 2 | Train Loss: 0.025 Vali Loss: 2.840 Vali Acc: 0.333 Test Loss: 2.840 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.562263011932373
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.474 Vali Acc: 0.267 Test Loss: 3.474 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5502395629882812
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.682 Vali Acc: 0.267 Test Loss: 4.682 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5395278930664062
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.919 Vali Acc: 0.200 Test Loss: 5.919 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5498471260070801
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.954 Vali Acc: 0.200 Test Loss: 6.954 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5886020660400391
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 7.472 Vali Acc: 0.200 Test Loss: 7.472 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5861873626708984
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.732 Vali Acc: 0.200 Test Loss: 7.732 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2321443
model size : 13.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.310335159301758
Epoch: 1, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.540705680847168
Epoch: 2, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5010616779327393
Epoch: 3, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6162965297698975
Epoch: 4, Steps: 2 | Train Loss: 0.493 Vali Loss: 1.406 Vali Acc: 0.333 Test Loss: 1.406 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 0.5553476810455322
Epoch: 5, Steps: 2 | Train Loss: 0.324 Vali Loss: 1.392 Vali Acc: 0.333 Test Loss: 1.392 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 0.574934720993042
Epoch: 6, Steps: 2 | Train Loss: 0.253 Vali Loss: 1.555 Vali Acc: 0.267 Test Loss: 1.555 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5633206367492676
Epoch: 7, Steps: 2 | Train Loss: 0.325 Vali Loss: 2.071 Vali Acc: 0.267 Test Loss: 2.071 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5429880619049072
Epoch: 8, Steps: 2 | Train Loss: 0.113 Vali Loss: 2.348 Vali Acc: 0.333 Test Loss: 2.348 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5725312232971191
Epoch: 9, Steps: 2 | Train Loss: 0.199 Vali Loss: 2.091 Vali Acc: 0.200 Test Loss: 2.091 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5342466831207275
Epoch: 10, Steps: 2 | Train Loss: 0.040 Vali Loss: 3.142 Vali Acc: 0.267 Test Loss: 3.142 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5308668613433838
Epoch: 11, Steps: 2 | Train Loss: 0.054 Vali Loss: 2.756 Vali Acc: 0.200 Test Loss: 2.756 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5585184097290039
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.157 Vali Acc: 0.267 Test Loss: 3.157 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5641562938690186
Epoch: 13, Steps: 2 | Train Loss: 0.026 Vali Loss: 2.949 Vali Acc: 0.200 Test Loss: 2.949 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5525393486022949
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.678 Vali Acc: 0.267 Test Loss: 3.678 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5806436538696289
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.147 Vali Acc: 0.267 Test Loss: 5.147 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2321443
model size : 13.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3321354389190674
Epoch: 1, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.638554573059082
Epoch: 2, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.644514799118042
Epoch: 3, Steps: 2 | Train Loss: 0.785 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6368963718414307
Epoch: 4, Steps: 2 | Train Loss: 0.392 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.65309739112854
Epoch: 5, Steps: 2 | Train Loss: 0.343 Vali Loss: 2.140 Vali Acc: 0.333 Test Loss: 2.140 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6530246734619141
Epoch: 6, Steps: 2 | Train Loss: 0.113 Vali Loss: 2.112 Vali Acc: 0.333 Test Loss: 2.112 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6329913139343262
Epoch: 7, Steps: 2 | Train Loss: 0.014 Vali Loss: 2.646 Vali Acc: 0.400 Test Loss: 2.646 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6408357620239258
Epoch: 8, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.839 Vali Acc: 0.400 Test Loss: 3.839 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6375231742858887
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.987 Vali Acc: 0.400 Test Loss: 4.987 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6660332679748535
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.933 Vali Acc: 0.400 Test Loss: 5.933 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6372299194335938
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.684 Vali Acc: 0.400 Test Loss: 6.684 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6560261249542236
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.218 Vali Acc: 0.400 Test Loss: 7.218 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2190371
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5073816776275635
Epoch: 1, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6064891815185547
Epoch: 2, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6158690452575684
Epoch: 3, Steps: 2 | Train Loss: 0.828 Vali Loss: 1.287 Vali Acc: 0.333 Test Loss: 1.287 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6398236751556396
Epoch: 4, Steps: 2 | Train Loss: 0.423 Vali Loss: 1.330 Vali Acc: 0.333 Test Loss: 1.330 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.586920976638794
Epoch: 5, Steps: 2 | Train Loss: 0.432 Vali Loss: 1.781 Vali Acc: 0.267 Test Loss: 1.781 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.596858024597168
Epoch: 6, Steps: 2 | Train Loss: 0.116 Vali Loss: 2.417 Vali Acc: 0.333 Test Loss: 2.417 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6166040897369385
Epoch: 7, Steps: 2 | Train Loss: 0.102 Vali Loss: 2.383 Vali Acc: 0.400 Test Loss: 2.383 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5849297046661377
Epoch: 8, Steps: 2 | Train Loss: 0.003 Vali Loss: 4.221 Vali Acc: 0.333 Test Loss: 4.221 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5599832534790039
Epoch: 9, Steps: 2 | Train Loss: 0.034 Vali Loss: 4.517 Vali Acc: 0.267 Test Loss: 4.517 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6042685508728027
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.300 Vali Acc: 0.200 Test Loss: 4.300 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.598268985748291
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.296 Vali Acc: 0.200 Test Loss: 4.296 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2190371
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3613524436950684
Epoch: 1, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5386059284210205
Epoch: 2, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5260567665100098
Epoch: 3, Steps: 2 | Train Loss: 0.784 Vali Loss: 1.340 Vali Acc: 0.267 Test Loss: 1.340 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5528743267059326
Epoch: 4, Steps: 2 | Train Loss: 0.451 Vali Loss: 1.448 Vali Acc: 0.267 Test Loss: 1.448 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5460963249206543
Epoch: 5, Steps: 2 | Train Loss: 0.457 Vali Loss: 1.752 Vali Acc: 0.200 Test Loss: 1.752 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5595426559448242
Epoch: 6, Steps: 2 | Train Loss: 0.124 Vali Loss: 2.490 Vali Acc: 0.333 Test Loss: 2.490 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.570868730545044
Epoch: 7, Steps: 2 | Train Loss: 0.250 Vali Loss: 2.203 Vali Acc: 0.333 Test Loss: 2.203 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5834701061248779
Epoch: 8, Steps: 2 | Train Loss: 0.017 Vali Loss: 4.548 Vali Acc: 0.267 Test Loss: 4.548 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5710554122924805
Epoch: 9, Steps: 2 | Train Loss: 0.158 Vali Loss: 5.576 Vali Acc: 0.333 Test Loss: 5.576 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5787014961242676
Epoch: 10, Steps: 2 | Train Loss: 0.143 Vali Loss: 4.075 Vali Acc: 0.200 Test Loss: 4.075 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5255801677703857
Epoch: 11, Steps: 2 | Train Loss: 0.002 Vali Loss: 5.394 Vali Acc: 0.267 Test Loss: 5.394 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2190371
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2177047729492188
Epoch: 1, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5250325202941895
Epoch: 2, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5349264144897461
Epoch: 3, Steps: 2 | Train Loss: 0.842 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5685923099517822
Epoch: 4, Steps: 2 | Train Loss: 0.596 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5665321350097656
Epoch: 5, Steps: 2 | Train Loss: 0.746 Vali Loss: 1.807 Vali Acc: 0.400 Test Loss: 1.807 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5589568614959717
Epoch: 6, Steps: 2 | Train Loss: 0.259 Vali Loss: 2.507 Vali Acc: 0.333 Test Loss: 2.507 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5469670295715332
Epoch: 7, Steps: 2 | Train Loss: 0.662 Vali Loss: 2.379 Vali Acc: 0.267 Test Loss: 2.379 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5475139617919922
Epoch: 8, Steps: 2 | Train Loss: 0.275 Vali Loss: 2.756 Vali Acc: 0.333 Test Loss: 2.756 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6604301929473877
Epoch: 9, Steps: 2 | Train Loss: 0.159 Vali Loss: 3.088 Vali Acc: 0.267 Test Loss: 3.088 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5503768920898438
Epoch: 10, Steps: 2 | Train Loss: 0.107 Vali Loss: 2.876 Vali Acc: 0.333 Test Loss: 2.876 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5322270393371582
Epoch: 11, Steps: 2 | Train Loss: 0.066 Vali Loss: 2.817 Vali Acc: 0.200 Test Loss: 2.817 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.536876916885376
Epoch: 12, Steps: 2 | Train Loss: 0.025 Vali Loss: 3.548 Vali Acc: 0.267 Test Loss: 3.548 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2190371
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2759175300598145
Epoch: 1, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.569887638092041
Epoch: 2, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6424765586853027
Epoch: 3, Steps: 2 | Train Loss: 0.813 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6049211025238037
Epoch: 4, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.501 Vali Acc: 0.200 Test Loss: 1.501 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5938775539398193
Epoch: 5, Steps: 2 | Train Loss: 0.107 Vali Loss: 2.014 Vali Acc: 0.200 Test Loss: 2.014 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6004238128662109
Epoch: 6, Steps: 2 | Train Loss: 0.026 Vali Loss: 2.682 Vali Acc: 0.267 Test Loss: 2.682 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5839436054229736
Epoch: 7, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.272 Vali Acc: 0.333 Test Loss: 3.272 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6220972537994385
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.946 Vali Acc: 0.400 Test Loss: 3.946 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399961).  Saving model ...
Epoch: 9 cost time: 0.5768091678619385
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.639 Vali Acc: 0.400 Test Loss: 4.639 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6517915725708008
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.309 Vali Acc: 0.400 Test Loss: 5.309 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.592120885848999
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.934 Vali Acc: 0.400 Test Loss: 5.934 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5489075183868408
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.502 Vali Acc: 0.333 Test Loss: 6.502 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6386072635650635
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.009 Vali Acc: 0.333 Test Loss: 7.009 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6012585163116455
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.457 Vali Acc: 0.267 Test Loss: 7.457 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6264557838439941
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.850 Vali Acc: 0.267 Test Loss: 7.850 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5778069496154785
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.191 Vali Acc: 0.267 Test Loss: 8.191 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5780034065246582
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.487 Vali Acc: 0.267 Test Loss: 8.487 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5673856735229492
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.742 Vali Acc: 0.267 Test Loss: 8.742 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2124835
model size : 13.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.372845411300659
Epoch: 1, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.602311372756958
Epoch: 2, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6375863552093506
Epoch: 3, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6313250064849854
Epoch: 4, Steps: 2 | Train Loss: 0.348 Vali Loss: 1.468 Vali Acc: 0.267 Test Loss: 1.468 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6546752452850342
Epoch: 5, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.880 Vali Acc: 0.200 Test Loss: 1.880 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6138918399810791
Epoch: 6, Steps: 2 | Train Loss: 0.068 Vali Loss: 2.528 Vali Acc: 0.200 Test Loss: 2.528 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5890483856201172
Epoch: 7, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.040 Vali Acc: 0.200 Test Loss: 3.040 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5993773937225342
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.198 Vali Acc: 0.267 Test Loss: 4.198 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6729917526245117
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.489 Vali Acc: 0.333 Test Loss: 5.489 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6273787021636963
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 6.591 Vali Acc: 0.400 Test Loss: 6.591 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399934).  Saving model ...
Epoch: 11 cost time: 0.6190700531005859
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.330 Vali Acc: 0.400 Test Loss: 7.330 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.621906042098999
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 7.891 Vali Acc: 0.400 Test Loss: 7.891 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5837466716766357
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.316 Vali Acc: 0.400 Test Loss: 8.316 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6009249687194824
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.660 Vali Acc: 0.400 Test Loss: 8.660 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6290061473846436
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 8.943 Vali Acc: 0.400 Test Loss: 8.943 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5657651424407959
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.193 Vali Acc: 0.400 Test Loss: 9.193 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6445395946502686
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.403 Vali Acc: 0.400 Test Loss: 9.403 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6093192100524902
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.588 Vali Acc: 0.400 Test Loss: 9.588 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6195070743560791
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.746 Vali Acc: 0.400 Test Loss: 9.746 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6271066665649414
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 9.881 Vali Acc: 0.400 Test Loss: 9.881 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2124835
model size : 13.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4080982208251953
Epoch: 1, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6192202568054199
Epoch: 2, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6050879955291748
Epoch: 3, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5944211483001709
Epoch: 4, Steps: 2 | Train Loss: 0.425 Vali Loss: 1.502 Vali Acc: 0.267 Test Loss: 1.502 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.654818058013916
Epoch: 5, Steps: 2 | Train Loss: 0.201 Vali Loss: 1.863 Vali Acc: 0.200 Test Loss: 1.863 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6026406288146973
Epoch: 6, Steps: 2 | Train Loss: 0.151 Vali Loss: 2.510 Vali Acc: 0.200 Test Loss: 2.510 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6242468357086182
Epoch: 7, Steps: 2 | Train Loss: 0.031 Vali Loss: 2.674 Vali Acc: 0.200 Test Loss: 2.674 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6195900440216064
Epoch: 8, Steps: 2 | Train Loss: 0.005 Vali Loss: 3.794 Vali Acc: 0.333 Test Loss: 3.794 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6285967826843262
Epoch: 9, Steps: 2 | Train Loss: 0.002 Vali Loss: 4.164 Vali Acc: 0.267 Test Loss: 4.164 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5998904705047607
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.677 Vali Acc: 0.267 Test Loss: 4.677 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5615732669830322
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.218 Vali Acc: 0.267 Test Loss: 5.218 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.60178542137146
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.723 Vali Acc: 0.267 Test Loss: 5.723 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6148645877838135
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.176 Vali Acc: 0.267 Test Loss: 6.176 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2124835
model size : 13.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2763278484344482
Epoch: 1, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5298714637756348
Epoch: 2, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5057806968688965
Epoch: 3, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5791192054748535
Epoch: 4, Steps: 2 | Train Loss: 0.583 Vali Loss: 1.388 Vali Acc: 0.267 Test Loss: 1.388 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5039138793945312
Epoch: 5, Steps: 2 | Train Loss: 0.329 Vali Loss: 1.600 Vali Acc: 0.133 Test Loss: 1.600 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5329782962799072
Epoch: 6, Steps: 2 | Train Loss: 0.454 Vali Loss: 2.342 Vali Acc: 0.267 Test Loss: 2.342 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5332281589508057
Epoch: 7, Steps: 2 | Train Loss: 0.255 Vali Loss: 2.364 Vali Acc: 0.333 Test Loss: 2.364 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5900797843933105
Epoch: 8, Steps: 2 | Train Loss: 0.162 Vali Loss: 2.677 Vali Acc: 0.267 Test Loss: 2.677 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5144729614257812
Epoch: 9, Steps: 2 | Train Loss: 0.046 Vali Loss: 3.616 Vali Acc: 0.267 Test Loss: 3.616 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5105838775634766
Epoch: 10, Steps: 2 | Train Loss: 0.070 Vali Loss: 3.958 Vali Acc: 0.267 Test Loss: 3.958 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.541231632232666
Epoch: 11, Steps: 2 | Train Loss: 0.064 Vali Loss: 3.876 Vali Acc: 0.267 Test Loss: 3.876 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2124835
model size : 13.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3507354259490967
Epoch: 1, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5777175426483154
Epoch: 2, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5931365489959717
Epoch: 3, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.273 Vali Acc: 0.400 Test Loss: 1.273 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6101038455963135
Epoch: 4, Steps: 2 | Train Loss: 0.337 Vali Loss: 1.559 Vali Acc: 0.200 Test Loss: 1.559 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6015455722808838
Epoch: 5, Steps: 2 | Train Loss: 0.157 Vali Loss: 2.224 Vali Acc: 0.200 Test Loss: 2.224 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6037349700927734
Epoch: 6, Steps: 2 | Train Loss: 0.083 Vali Loss: 2.477 Vali Acc: 0.267 Test Loss: 2.477 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5796754360198975
Epoch: 7, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.176 Vali Acc: 0.333 Test Loss: 3.176 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5748040676116943
Epoch: 8, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.710 Vali Acc: 0.267 Test Loss: 3.710 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5633029937744141
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.324 Vali Acc: 0.333 Test Loss: 4.324 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5969691276550293
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.962 Vali Acc: 0.267 Test Loss: 4.962 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6033673286437988
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.584 Vali Acc: 0.200 Test Loss: 5.584 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5728938579559326
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.163 Vali Acc: 0.200 Test Loss: 6.163 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2092067
model size : 12.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3103630542755127
Epoch: 1, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5570945739746094
Epoch: 2, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5498354434967041
Epoch: 3, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6122949123382568
Epoch: 4, Steps: 2 | Train Loss: 0.372 Vali Loss: 1.455 Vali Acc: 0.267 Test Loss: 1.455 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5826866626739502
Epoch: 5, Steps: 2 | Train Loss: 0.202 Vali Loss: 2.031 Vali Acc: 0.200 Test Loss: 2.031 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5654964447021484
Epoch: 6, Steps: 2 | Train Loss: 0.131 Vali Loss: 2.100 Vali Acc: 0.267 Test Loss: 2.100 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5588290691375732
Epoch: 7, Steps: 2 | Train Loss: 0.021 Vali Loss: 2.764 Vali Acc: 0.333 Test Loss: 2.764 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5838899612426758
Epoch: 8, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.142 Vali Acc: 0.267 Test Loss: 3.142 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5498907566070557
Epoch: 9, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.216 Vali Acc: 0.200 Test Loss: 4.216 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5855066776275635
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.560 Vali Acc: 0.200 Test Loss: 5.560 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5768027305603027
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 6.784 Vali Acc: 0.200 Test Loss: 6.784 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2092067
model size : 12.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.476921558380127
Epoch: 1, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6051726341247559
Epoch: 2, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6452419757843018
Epoch: 3, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5647938251495361
Epoch: 4, Steps: 2 | Train Loss: 0.415 Vali Loss: 1.518 Vali Acc: 0.267 Test Loss: 1.518 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6158931255340576
Epoch: 5, Steps: 2 | Train Loss: 0.257 Vali Loss: 1.854 Vali Acc: 0.200 Test Loss: 1.854 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6117963790893555
Epoch: 6, Steps: 2 | Train Loss: 0.161 Vali Loss: 1.945 Vali Acc: 0.333 Test Loss: 1.945 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6177940368652344
Epoch: 7, Steps: 2 | Train Loss: 0.040 Vali Loss: 2.267 Vali Acc: 0.267 Test Loss: 2.267 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6247513294219971
Epoch: 8, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.985 Vali Acc: 0.133 Test Loss: 2.985 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6065108776092529
Epoch: 9, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.458 Vali Acc: 0.267 Test Loss: 3.458 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6016371250152588
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.909 Vali Acc: 0.267 Test Loss: 3.909 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5956637859344482
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.347 Vali Acc: 0.333 Test Loss: 4.347 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5973217487335205
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.756 Vali Acc: 0.267 Test Loss: 4.756 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2092067
model size : 12.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3724124431610107
Epoch: 1, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5865962505340576
Epoch: 2, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5865540504455566
Epoch: 3, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6313629150390625
Epoch: 4, Steps: 2 | Train Loss: 0.592 Vali Loss: 1.422 Vali Acc: 0.333 Test Loss: 1.422 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5584049224853516
Epoch: 5, Steps: 2 | Train Loss: 0.385 Vali Loss: 1.447 Vali Acc: 0.333 Test Loss: 1.447 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.580704927444458
Epoch: 6, Steps: 2 | Train Loss: 0.396 Vali Loss: 2.311 Vali Acc: 0.267 Test Loss: 2.311 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5676379203796387
Epoch: 7, Steps: 2 | Train Loss: 0.362 Vali Loss: 1.685 Vali Acc: 0.200 Test Loss: 1.685 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5767395496368408
Epoch: 8, Steps: 2 | Train Loss: 0.054 Vali Loss: 2.369 Vali Acc: 0.267 Test Loss: 2.369 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5834813117980957
Epoch: 9, Steps: 2 | Train Loss: 0.124 Vali Loss: 2.197 Vali Acc: 0.200 Test Loss: 2.197 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.558640718460083
Epoch: 10, Steps: 2 | Train Loss: 0.007 Vali Loss: 2.976 Vali Acc: 0.333 Test Loss: 2.976 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5605373382568359
Epoch: 11, Steps: 2 | Train Loss: 0.241 Vali Loss: 2.962 Vali Acc: 0.333 Test Loss: 2.962 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5654594898223877
Epoch: 12, Steps: 2 | Train Loss: 0.021 Vali Loss: 3.954 Vali Acc: 0.267 Test Loss: 3.954 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2092067
model size : 12.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.291306972503662
Epoch: 1, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5383131504058838
Epoch: 2, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5263633728027344
Epoch: 3, Steps: 2 | Train Loss: 0.673 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5600485801696777
Epoch: 4, Steps: 2 | Train Loss: 0.489 Vali Loss: 1.292 Vali Acc: 0.333 Test Loss: 1.292 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6284565925598145
Epoch: 5, Steps: 2 | Train Loss: 0.275 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5857791900634766
Epoch: 6, Steps: 2 | Train Loss: 0.106 Vali Loss: 1.758 Vali Acc: 0.400 Test Loss: 1.758 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5660190582275391
Epoch: 7, Steps: 2 | Train Loss: 0.035 Vali Loss: 2.382 Vali Acc: 0.400 Test Loss: 2.382 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5460844039916992
Epoch: 8, Steps: 2 | Train Loss: 0.009 Vali Loss: 2.991 Vali Acc: 0.333 Test Loss: 2.991 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5542259216308594
Epoch: 9, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.789 Vali Acc: 0.200 Test Loss: 3.789 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5824940204620361
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.398 Vali Acc: 0.200 Test Loss: 4.398 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5536141395568848
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.889 Vali Acc: 0.200 Test Loss: 4.889 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6025874614715576
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.266 Vali Acc: 0.200 Test Loss: 5.266 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1521187
model size : 8.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2995853424072266
Epoch: 1, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5255019664764404
Epoch: 2, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5118229389190674
Epoch: 3, Steps: 2 | Train Loss: 0.702 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.552509069442749
Epoch: 4, Steps: 2 | Train Loss: 0.516 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5366020202636719
Epoch: 5, Steps: 2 | Train Loss: 0.312 Vali Loss: 1.401 Vali Acc: 0.400 Test Loss: 1.401 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.5790231227874756
Epoch: 6, Steps: 2 | Train Loss: 0.118 Vali Loss: 1.644 Vali Acc: 0.333 Test Loss: 1.644 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.526836633682251
Epoch: 7, Steps: 2 | Train Loss: 0.062 Vali Loss: 2.141 Vali Acc: 0.333 Test Loss: 2.141 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5335769653320312
Epoch: 8, Steps: 2 | Train Loss: 0.017 Vali Loss: 2.612 Vali Acc: 0.333 Test Loss: 2.612 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.512728214263916
Epoch: 9, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.041 Vali Acc: 0.200 Test Loss: 3.041 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5238077640533447
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.348 Vali Acc: 0.200 Test Loss: 3.348 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5265507698059082
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.620 Vali Acc: 0.200 Test Loss: 3.620 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.55245041847229
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.870 Vali Acc: 0.267 Test Loss: 3.870 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5754938125610352
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.103 Vali Acc: 0.267 Test Loss: 4.103 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.549285888671875
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.319 Vali Acc: 0.200 Test Loss: 4.319 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.547346830368042
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.514 Vali Acc: 0.200 Test Loss: 4.514 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1521187
model size : 8.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.324801445007324
Epoch: 1, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4988853931427002
Epoch: 2, Steps: 2 | Train Loss: 0.909 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5395100116729736
Epoch: 3, Steps: 2 | Train Loss: 0.760 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5381488800048828
Epoch: 4, Steps: 2 | Train Loss: 0.590 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5675122737884521
Epoch: 5, Steps: 2 | Train Loss: 0.365 Vali Loss: 1.341 Vali Acc: 0.333 Test Loss: 1.341 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5070054531097412
Epoch: 6, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.519 Vali Acc: 0.267 Test Loss: 1.519 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5490927696228027
Epoch: 7, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.863 Vali Acc: 0.267 Test Loss: 1.863 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5578091144561768
Epoch: 8, Steps: 2 | Train Loss: 0.041 Vali Loss: 2.169 Vali Acc: 0.200 Test Loss: 2.169 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5414550304412842
Epoch: 9, Steps: 2 | Train Loss: 0.031 Vali Loss: 2.286 Vali Acc: 0.133 Test Loss: 2.286 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5449559688568115
Epoch: 10, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.508 Vali Acc: 0.267 Test Loss: 2.508 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5531344413757324
Epoch: 11, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.839 Vali Acc: 0.200 Test Loss: 2.839 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.49252986907958984
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.068 Vali Acc: 0.267 Test Loss: 3.068 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1521187
model size : 8.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2721025943756104
Epoch: 1, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4584798812866211
Epoch: 2, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4565715789794922
Epoch: 3, Steps: 2 | Train Loss: 0.888 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.48037171363830566
Epoch: 4, Steps: 2 | Train Loss: 0.722 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4850165843963623
Epoch: 5, Steps: 2 | Train Loss: 0.509 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5232563018798828
Epoch: 6, Steps: 2 | Train Loss: 0.274 Vali Loss: 1.327 Vali Acc: 0.200 Test Loss: 1.327 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.459031343460083
Epoch: 7, Steps: 2 | Train Loss: 0.289 Vali Loss: 1.564 Vali Acc: 0.333 Test Loss: 1.564 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4590775966644287
Epoch: 8, Steps: 2 | Train Loss: 0.156 Vali Loss: 1.606 Vali Acc: 0.267 Test Loss: 1.606 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5116021633148193
Epoch: 9, Steps: 2 | Train Loss: 0.154 Vali Loss: 1.707 Vali Acc: 0.333 Test Loss: 1.707 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4568183422088623
Epoch: 10, Steps: 2 | Train Loss: 0.063 Vali Loss: 1.805 Vali Acc: 0.200 Test Loss: 1.805 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.47278785705566406
Epoch: 11, Steps: 2 | Train Loss: 0.045 Vali Loss: 2.181 Vali Acc: 0.200 Test Loss: 2.181 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1521187
model size : 8.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3590023517608643
Epoch: 1, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5519533157348633
Epoch: 2, Steps: 2 | Train Loss: 0.893 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.52858567237854
Epoch: 3, Steps: 2 | Train Loss: 0.644 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5186522006988525
Epoch: 4, Steps: 2 | Train Loss: 0.439 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5573022365570068
Epoch: 5, Steps: 2 | Train Loss: 0.278 Vali Loss: 1.425 Vali Acc: 0.333 Test Loss: 1.425 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5508654117584229
Epoch: 6, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.753 Vali Acc: 0.267 Test Loss: 1.753 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5417182445526123
Epoch: 7, Steps: 2 | Train Loss: 0.026 Vali Loss: 2.340 Vali Acc: 0.267 Test Loss: 2.340 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5875227451324463
Epoch: 8, Steps: 2 | Train Loss: 0.004 Vali Loss: 3.300 Vali Acc: 0.267 Test Loss: 3.300 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5546746253967285
Epoch: 9, Steps: 2 | Train Loss: 0.003 Vali Loss: 4.011 Vali Acc: 0.267 Test Loss: 4.011 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4979703426361084
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.521 Vali Acc: 0.267 Test Loss: 4.521 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5631096363067627
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.947 Vali Acc: 0.267 Test Loss: 4.947 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1259043
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2285428047180176
Epoch: 1, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5317118167877197
Epoch: 2, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5346100330352783
Epoch: 3, Steps: 2 | Train Loss: 0.656 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.517378568649292
Epoch: 4, Steps: 2 | Train Loss: 0.454 Vali Loss: 1.340 Vali Acc: 0.467 Test Loss: 1.340 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5090277194976807
Epoch: 5, Steps: 2 | Train Loss: 0.354 Vali Loss: 1.346 Vali Acc: 0.200 Test Loss: 1.346 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5276765823364258
Epoch: 6, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.666 Vali Acc: 0.267 Test Loss: 1.666 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5139508247375488
Epoch: 7, Steps: 2 | Train Loss: 0.057 Vali Loss: 2.036 Vali Acc: 0.267 Test Loss: 2.036 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5186214447021484
Epoch: 8, Steps: 2 | Train Loss: 0.009 Vali Loss: 2.830 Vali Acc: 0.267 Test Loss: 2.830 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.49729061126708984
Epoch: 9, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.282 Vali Acc: 0.267 Test Loss: 3.282 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4944636821746826
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.563 Vali Acc: 0.267 Test Loss: 3.563 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5286920070648193
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.913 Vali Acc: 0.333 Test Loss: 3.913 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1259043
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3564517498016357
Epoch: 1, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.46504807472229004
Epoch: 2, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4721391201019287
Epoch: 3, Steps: 2 | Train Loss: 0.702 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5028107166290283
Epoch: 4, Steps: 2 | Train Loss: 0.515 Vali Loss: 1.323 Vali Acc: 0.333 Test Loss: 1.323 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5229525566101074
Epoch: 5, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47301316261291504
Epoch: 6, Steps: 2 | Train Loss: 0.259 Vali Loss: 1.569 Vali Acc: 0.333 Test Loss: 1.569 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.49464917182922363
Epoch: 7, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.749 Vali Acc: 0.200 Test Loss: 1.749 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.49388837814331055
Epoch: 8, Steps: 2 | Train Loss: 0.039 Vali Loss: 2.229 Vali Acc: 0.400 Test Loss: 2.229 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4674994945526123
Epoch: 9, Steps: 2 | Train Loss: 0.026 Vali Loss: 2.219 Vali Acc: 0.333 Test Loss: 2.219 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.47371339797973633
Epoch: 10, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.573 Vali Acc: 0.200 Test Loss: 2.573 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4889042377471924
Epoch: 11, Steps: 2 | Train Loss: 0.006 Vali Loss: 2.990 Vali Acc: 0.133 Test Loss: 2.990 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1259043
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3572988510131836
Epoch: 1, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4933328628540039
Epoch: 2, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5300619602203369
Epoch: 3, Steps: 2 | Train Loss: 0.825 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5175719261169434
Epoch: 4, Steps: 2 | Train Loss: 0.644 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5292854309082031
Epoch: 5, Steps: 2 | Train Loss: 0.567 Vali Loss: 1.309 Vali Acc: 0.267 Test Loss: 1.309 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4784214496612549
Epoch: 6, Steps: 2 | Train Loss: 0.333 Vali Loss: 1.419 Vali Acc: 0.333 Test Loss: 1.419 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5176281929016113
Epoch: 7, Steps: 2 | Train Loss: 0.269 Vali Loss: 1.491 Vali Acc: 0.267 Test Loss: 1.491 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5103042125701904
Epoch: 8, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.815 Vali Acc: 0.200 Test Loss: 1.815 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5169422626495361
Epoch: 9, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.790 Vali Acc: 0.267 Test Loss: 1.790 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5018365383148193
Epoch: 10, Steps: 2 | Train Loss: 0.056 Vali Loss: 1.935 Vali Acc: 0.267 Test Loss: 1.935 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5554955005645752
Epoch: 11, Steps: 2 | Train Loss: 0.042 Vali Loss: 2.104 Vali Acc: 0.267 Test Loss: 2.104 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1259043
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.293719530105591
Epoch: 1, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5362584590911865
Epoch: 2, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5079343318939209
Epoch: 3, Steps: 2 | Train Loss: 0.731 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.5479652881622314
Epoch: 4, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.636 Vali Acc: 0.467 Test Loss: 1.636 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5663304328918457
Epoch: 5, Steps: 2 | Train Loss: 0.417 Vali Loss: 1.516 Vali Acc: 0.333 Test Loss: 1.516 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5306870937347412
Epoch: 6, Steps: 2 | Train Loss: 0.128 Vali Loss: 2.134 Vali Acc: 0.267 Test Loss: 2.134 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5425794124603271
Epoch: 7, Steps: 2 | Train Loss: 0.087 Vali Loss: 2.557 Vali Acc: 0.267 Test Loss: 2.557 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6070206165313721
Epoch: 8, Steps: 2 | Train Loss: 0.015 Vali Loss: 2.695 Vali Acc: 0.333 Test Loss: 2.695 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5929505825042725
Epoch: 9, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.822 Vali Acc: 0.333 Test Loss: 3.822 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5849349498748779
Epoch: 10, Steps: 2 | Train Loss: 0.003 Vali Loss: 4.717 Vali Acc: 0.400 Test Loss: 4.717 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5925214290618896
Epoch: 11, Steps: 2 | Train Loss: 0.003 Vali Loss: 5.374 Vali Acc: 0.400 Test Loss: 5.374 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5724642276763916
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 5.613 Vali Acc: 0.400 Test Loss: 5.613 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5701267719268799
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.767 Vali Acc: 0.400 Test Loss: 5.767 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1127971
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4136481285095215
Epoch: 1, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5688652992248535
Epoch: 2, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.548469066619873
Epoch: 3, Steps: 2 | Train Loss: 0.777 Vali Loss: 1.171 Vali Acc: 0.533 Test Loss: 1.171 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.5792396068572998
Epoch: 4, Steps: 2 | Train Loss: 0.769 Vali Loss: 1.568 Vali Acc: 0.467 Test Loss: 1.568 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5387840270996094
Epoch: 5, Steps: 2 | Train Loss: 0.452 Vali Loss: 1.458 Vali Acc: 0.267 Test Loss: 1.458 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.557185173034668
Epoch: 6, Steps: 2 | Train Loss: 0.201 Vali Loss: 2.133 Vali Acc: 0.267 Test Loss: 2.133 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.514976978302002
Epoch: 7, Steps: 2 | Train Loss: 0.157 Vali Loss: 2.416 Vali Acc: 0.267 Test Loss: 2.416 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5784163475036621
Epoch: 8, Steps: 2 | Train Loss: 0.028 Vali Loss: 2.532 Vali Acc: 0.333 Test Loss: 2.532 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5161733627319336
Epoch: 9, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.668 Vali Acc: 0.333 Test Loss: 3.668 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5429940223693848
Epoch: 10, Steps: 2 | Train Loss: 0.011 Vali Loss: 3.960 Vali Acc: 0.333 Test Loss: 3.960 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5455222129821777
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.162 Vali Acc: 0.267 Test Loss: 4.162 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5610427856445312
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.326 Vali Acc: 0.267 Test Loss: 4.326 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5543363094329834
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.491 Vali Acc: 0.267 Test Loss: 4.491 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1127971
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.279418468475342
Epoch: 1, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5008304119110107
Epoch: 2, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5238978862762451
Epoch: 3, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.5307445526123047
Epoch: 4, Steps: 2 | Train Loss: 0.826 Vali Loss: 1.435 Vali Acc: 0.400 Test Loss: 1.435 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.48781442642211914
Epoch: 5, Steps: 2 | Train Loss: 0.475 Vali Loss: 1.457 Vali Acc: 0.267 Test Loss: 1.457 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4911072254180908
Epoch: 6, Steps: 2 | Train Loss: 0.390 Vali Loss: 2.084 Vali Acc: 0.200 Test Loss: 2.084 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5179874897003174
Epoch: 7, Steps: 2 | Train Loss: 0.217 Vali Loss: 1.939 Vali Acc: 0.200 Test Loss: 1.939 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5010669231414795
Epoch: 8, Steps: 2 | Train Loss: 0.049 Vali Loss: 2.355 Vali Acc: 0.200 Test Loss: 2.355 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4887521266937256
Epoch: 9, Steps: 2 | Train Loss: 0.034 Vali Loss: 2.679 Vali Acc: 0.200 Test Loss: 2.679 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4890756607055664
Epoch: 10, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.763 Vali Acc: 0.133 Test Loss: 2.763 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4999220371246338
Epoch: 11, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.156 Vali Acc: 0.267 Test Loss: 3.156 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4870929718017578
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.560 Vali Acc: 0.200 Test Loss: 3.560 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5090758800506592
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.870 Vali Acc: 0.133 Test Loss: 3.870 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1127971
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2686288356781006
Epoch: 1, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4701669216156006
Epoch: 2, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5302982330322266
Epoch: 3, Steps: 2 | Train Loss: 0.908 Vali Loss: 1.178 Vali Acc: 0.467 Test Loss: 1.178 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4974946975708008
Epoch: 4, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.430 Vali Acc: 0.400 Test Loss: 1.430 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5465545654296875
Epoch: 5, Steps: 2 | Train Loss: 0.617 Vali Loss: 1.338 Vali Acc: 0.200 Test Loss: 1.338 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5127832889556885
Epoch: 6, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.947 Vali Acc: 0.200 Test Loss: 1.947 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.49169921875
Epoch: 7, Steps: 2 | Train Loss: 0.522 Vali Loss: 1.683 Vali Acc: 0.067 Test Loss: 1.683 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5091862678527832
Epoch: 8, Steps: 2 | Train Loss: 0.190 Vali Loss: 1.847 Vali Acc: 0.267 Test Loss: 1.847 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.512470006942749
Epoch: 9, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.985 Vali Acc: 0.267 Test Loss: 1.985 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.505521297454834
Epoch: 10, Steps: 2 | Train Loss: 0.108 Vali Loss: 2.084 Vali Acc: 0.133 Test Loss: 2.084 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5354831218719482
Epoch: 11, Steps: 2 | Train Loss: 0.053 Vali Loss: 2.219 Vali Acc: 0.133 Test Loss: 2.219 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4950408935546875
Epoch: 12, Steps: 2 | Train Loss: 0.074 Vali Loss: 2.470 Vali Acc: 0.200 Test Loss: 2.470 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1127971
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.218151330947876
Epoch: 1, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5140833854675293
Epoch: 2, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5216403007507324
Epoch: 3, Steps: 2 | Train Loss: 0.770 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.509573221206665
Epoch: 4, Steps: 2 | Train Loss: 0.437 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49947333335876465
Epoch: 5, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.581 Vali Acc: 0.200 Test Loss: 1.581 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4979236125946045
Epoch: 6, Steps: 2 | Train Loss: 0.166 Vali Loss: 1.737 Vali Acc: 0.333 Test Loss: 1.737 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5098769664764404
Epoch: 7, Steps: 2 | Train Loss: 0.046 Vali Loss: 2.315 Vali Acc: 0.333 Test Loss: 2.315 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5189106464385986
Epoch: 8, Steps: 2 | Train Loss: 0.014 Vali Loss: 2.526 Vali Acc: 0.267 Test Loss: 2.526 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5484375953674316
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.170 Vali Acc: 0.133 Test Loss: 3.170 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4531216621398926
Epoch: 10, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.866 Vali Acc: 0.133 Test Loss: 3.866 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5683410167694092
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 4.318 Vali Acc: 0.133 Test Loss: 4.318 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1062435
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.325289011001587
Epoch: 1, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.466139554977417
Epoch: 2, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4821925163269043
Epoch: 3, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5128355026245117
Epoch: 4, Steps: 2 | Train Loss: 0.459 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49271678924560547
Epoch: 5, Steps: 2 | Train Loss: 0.516 Vali Loss: 1.598 Vali Acc: 0.200 Test Loss: 1.598 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5303828716278076
Epoch: 6, Steps: 2 | Train Loss: 0.215 Vali Loss: 1.624 Vali Acc: 0.333 Test Loss: 1.624 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5294747352600098
Epoch: 7, Steps: 2 | Train Loss: 0.077 Vali Loss: 1.987 Vali Acc: 0.400 Test Loss: 1.987 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.471721887588501
Epoch: 8, Steps: 2 | Train Loss: 0.024 Vali Loss: 2.233 Vali Acc: 0.267 Test Loss: 2.233 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.49390459060668945
Epoch: 9, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.934 Vali Acc: 0.133 Test Loss: 2.934 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4880337715148926
Epoch: 10, Steps: 2 | Train Loss: 0.006 Vali Loss: 3.489 Vali Acc: 0.133 Test Loss: 3.489 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5123801231384277
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.776 Vali Acc: 0.267 Test Loss: 3.776 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1062435
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3114781379699707
Epoch: 1, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5003204345703125
Epoch: 2, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4940154552459717
Epoch: 3, Steps: 2 | Train Loss: 0.793 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5222558975219727
Epoch: 4, Steps: 2 | Train Loss: 0.523 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4925956726074219
Epoch: 5, Steps: 2 | Train Loss: 0.573 Vali Loss: 1.461 Vali Acc: 0.200 Test Loss: 1.461 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.509798526763916
Epoch: 6, Steps: 2 | Train Loss: 0.257 Vali Loss: 1.477 Vali Acc: 0.267 Test Loss: 1.477 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5039634704589844
Epoch: 7, Steps: 2 | Train Loss: 0.156 Vali Loss: 1.768 Vali Acc: 0.333 Test Loss: 1.768 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5785949230194092
Epoch: 8, Steps: 2 | Train Loss: 0.059 Vali Loss: 1.945 Vali Acc: 0.267 Test Loss: 1.945 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5192718505859375
Epoch: 9, Steps: 2 | Train Loss: 0.023 Vali Loss: 2.287 Vali Acc: 0.200 Test Loss: 2.287 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5007927417755127
Epoch: 10, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.499 Vali Acc: 0.200 Test Loss: 2.499 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.49837231636047363
Epoch: 11, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.813 Vali Acc: 0.200 Test Loss: 2.813 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5030360221862793
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.228 Vali Acc: 0.267 Test Loss: 3.228 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1062435
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.228902816772461
Epoch: 1, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.537604808807373
Epoch: 2, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5556368827819824
Epoch: 3, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.563798189163208
Epoch: 4, Steps: 2 | Train Loss: 0.639 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5095090866088867
Epoch: 5, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.336 Vali Acc: 0.267 Test Loss: 1.336 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5401647090911865
Epoch: 6, Steps: 2 | Train Loss: 0.356 Vali Loss: 1.357 Vali Acc: 0.333 Test Loss: 1.357 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5867512226104736
Epoch: 7, Steps: 2 | Train Loss: 0.310 Vali Loss: 1.496 Vali Acc: 0.267 Test Loss: 1.496 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5069396495819092
Epoch: 8, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.673 Vali Acc: 0.333 Test Loss: 1.673 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5232338905334473
Epoch: 9, Steps: 2 | Train Loss: 0.090 Vali Loss: 1.770 Vali Acc: 0.267 Test Loss: 1.770 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6108813285827637
Epoch: 10, Steps: 2 | Train Loss: 0.061 Vali Loss: 1.868 Vali Acc: 0.267 Test Loss: 1.868 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5987570285797119
Epoch: 11, Steps: 2 | Train Loss: 0.032 Vali Loss: 2.409 Vali Acc: 0.333 Test Loss: 2.409 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6308581829071045
Epoch: 12, Steps: 2 | Train Loss: 0.037 Vali Loss: 2.491 Vali Acc: 0.333 Test Loss: 2.491 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1062435
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1863038539886475
Epoch: 1, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5681829452514648
Epoch: 2, Steps: 2 | Train Loss: 0.811 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5439059734344482
Epoch: 3, Steps: 2 | Train Loss: 0.730 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.535149335861206
Epoch: 4, Steps: 2 | Train Loss: 0.428 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5611217021942139
Epoch: 5, Steps: 2 | Train Loss: 0.257 Vali Loss: 1.438 Vali Acc: 0.200 Test Loss: 1.438 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5335407257080078
Epoch: 6, Steps: 2 | Train Loss: 0.066 Vali Loss: 1.929 Vali Acc: 0.133 Test Loss: 1.929 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5646617412567139
Epoch: 7, Steps: 2 | Train Loss: 0.067 Vali Loss: 2.445 Vali Acc: 0.333 Test Loss: 2.445 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5534069538116455
Epoch: 8, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.647 Vali Acc: 0.333 Test Loss: 2.647 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5365021228790283
Epoch: 9, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.319 Vali Acc: 0.333 Test Loss: 3.319 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5091583728790283
Epoch: 10, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.773 Vali Acc: 0.267 Test Loss: 3.773 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5309522151947021
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.975 Vali Acc: 0.267 Test Loss: 3.975 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5576756000518799
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.218 Vali Acc: 0.267 Test Loss: 4.218 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5121057033538818
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.502 Vali Acc: 0.200 Test Loss: 4.502 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1029667
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2273736000061035
Epoch: 1, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5032837390899658
Epoch: 2, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5014262199401855
Epoch: 3, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.5436363220214844
Epoch: 4, Steps: 2 | Train Loss: 0.487 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5071594715118408
Epoch: 5, Steps: 2 | Train Loss: 0.272 Vali Loss: 1.417 Vali Acc: 0.267 Test Loss: 1.417 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5447936058044434
Epoch: 6, Steps: 2 | Train Loss: 0.093 Vali Loss: 1.781 Vali Acc: 0.200 Test Loss: 1.781 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5332844257354736
Epoch: 7, Steps: 2 | Train Loss: 0.080 Vali Loss: 2.180 Vali Acc: 0.267 Test Loss: 2.180 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5204451084136963
Epoch: 8, Steps: 2 | Train Loss: 0.013 Vali Loss: 2.505 Vali Acc: 0.333 Test Loss: 2.505 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4913017749786377
Epoch: 9, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.821 Vali Acc: 0.267 Test Loss: 2.821 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5157790184020996
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.261 Vali Acc: 0.133 Test Loss: 3.261 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.527799129486084
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.757 Vali Acc: 0.133 Test Loss: 3.757 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5221824645996094
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.242 Vali Acc: 0.133 Test Loss: 4.242 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5158133506774902
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.686 Vali Acc: 0.133 Test Loss: 4.686 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1029667
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2904984951019287
Epoch: 1, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.48428797721862793
Epoch: 2, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47089505195617676
Epoch: 3, Steps: 2 | Train Loss: 0.825 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4889204502105713
Epoch: 4, Steps: 2 | Train Loss: 0.581 Vali Loss: 1.285 Vali Acc: 0.333 Test Loss: 1.285 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49520158767700195
Epoch: 5, Steps: 2 | Train Loss: 0.381 Vali Loss: 1.408 Vali Acc: 0.267 Test Loss: 1.408 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5314838886260986
Epoch: 6, Steps: 2 | Train Loss: 0.165 Vali Loss: 1.666 Vali Acc: 0.200 Test Loss: 1.666 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5113475322723389
Epoch: 7, Steps: 2 | Train Loss: 0.199 Vali Loss: 1.927 Vali Acc: 0.267 Test Loss: 1.927 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5177183151245117
Epoch: 8, Steps: 2 | Train Loss: 0.051 Vali Loss: 2.086 Vali Acc: 0.267 Test Loss: 2.086 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.47690534591674805
Epoch: 9, Steps: 2 | Train Loss: 0.017 Vali Loss: 2.507 Vali Acc: 0.133 Test Loss: 2.507 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4833950996398926
Epoch: 10, Steps: 2 | Train Loss: 0.007 Vali Loss: 2.873 Vali Acc: 0.133 Test Loss: 2.873 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.47708749771118164
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.048 Vali Acc: 0.200 Test Loss: 3.048 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1029667
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2223563194274902
Epoch: 1, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.49243664741516113
Epoch: 2, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.48484134674072266
Epoch: 3, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5367457866668701
Epoch: 4, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.316 Vali Acc: 0.200 Test Loss: 1.316 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4891970157623291
Epoch: 5, Steps: 2 | Train Loss: 0.496 Vali Loss: 1.437 Vali Acc: 0.067 Test Loss: 1.437 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4935934543609619
Epoch: 6, Steps: 2 | Train Loss: 0.300 Vali Loss: 1.668 Vali Acc: 0.200 Test Loss: 1.668 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.49342846870422363
Epoch: 7, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.778 Vali Acc: 0.200 Test Loss: 1.778 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4919140338897705
Epoch: 8, Steps: 2 | Train Loss: 0.185 Vali Loss: 2.000 Vali Acc: 0.267 Test Loss: 2.000 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.47291088104248047
Epoch: 9, Steps: 2 | Train Loss: 0.108 Vali Loss: 2.035 Vali Acc: 0.133 Test Loss: 2.035 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.49605298042297363
Epoch: 10, Steps: 2 | Train Loss: 0.103 Vali Loss: 2.472 Vali Acc: 0.200 Test Loss: 2.472 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5102589130401611
Epoch: 11, Steps: 2 | Train Loss: 0.064 Vali Loss: 2.372 Vali Acc: 0.133 Test Loss: 2.372 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4780855178833008
Epoch: 12, Steps: 2 | Train Loss: 0.013 Vali Loss: 2.651 Vali Acc: 0.267 Test Loss: 2.651 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1029667
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2189371585845947
Epoch: 1, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5427300930023193
Epoch: 2, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.555274486541748
Epoch: 3, Steps: 2 | Train Loss: 0.753 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.550178050994873
Epoch: 4, Steps: 2 | Train Loss: 0.373 Vali Loss: 1.316 Vali Acc: 0.467 Test Loss: 1.316 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5895698070526123
Epoch: 5, Steps: 2 | Train Loss: 0.190 Vali Loss: 1.651 Vali Acc: 0.400 Test Loss: 1.651 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5613081455230713
Epoch: 6, Steps: 2 | Train Loss: 0.065 Vali Loss: 2.179 Vali Acc: 0.333 Test Loss: 2.179 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6184380054473877
Epoch: 7, Steps: 2 | Train Loss: 0.018 Vali Loss: 2.596 Vali Acc: 0.333 Test Loss: 2.596 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5575330257415771
Epoch: 8, Steps: 2 | Train Loss: 0.003 Vali Loss: 3.104 Vali Acc: 0.267 Test Loss: 3.104 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5503783226013184
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.592 Vali Acc: 0.200 Test Loss: 3.592 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5380063056945801
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.028 Vali Acc: 0.200 Test Loss: 4.028 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5440731048583984
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.421 Vali Acc: 0.200 Test Loss: 4.421 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5508732795715332
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.769 Vali Acc: 0.200 Test Loss: 4.769 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5342023372650146
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 5.070 Vali Acc: 0.200 Test Loss: 5.070 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1013283
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1936964988708496
Epoch: 1, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5461921691894531
Epoch: 2, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5370059013366699
Epoch: 3, Steps: 2 | Train Loss: 0.775 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5355291366577148
Epoch: 4, Steps: 2 | Train Loss: 0.412 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5679183006286621
Epoch: 5, Steps: 2 | Train Loss: 0.220 Vali Loss: 1.546 Vali Acc: 0.333 Test Loss: 1.546 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.553781270980835
Epoch: 6, Steps: 2 | Train Loss: 0.090 Vali Loss: 1.961 Vali Acc: 0.333 Test Loss: 1.961 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5153942108154297
Epoch: 7, Steps: 2 | Train Loss: 0.034 Vali Loss: 2.401 Vali Acc: 0.333 Test Loss: 2.401 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5165379047393799
Epoch: 8, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.714 Vali Acc: 0.333 Test Loss: 2.714 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5438888072967529
Epoch: 9, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.033 Vali Acc: 0.333 Test Loss: 3.033 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.49674344062805176
Epoch: 10, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.355 Vali Acc: 0.333 Test Loss: 3.355 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5189285278320312
Epoch: 11, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.655 Vali Acc: 0.333 Test Loss: 3.655 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5356781482696533
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.928 Vali Acc: 0.333 Test Loss: 3.928 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5457727909088135
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 4.172 Vali Acc: 0.333 Test Loss: 4.172 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1013283
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4164328575134277
Epoch: 1, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.484360933303833
Epoch: 2, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5167970657348633
Epoch: 3, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5312325954437256
Epoch: 4, Steps: 2 | Train Loss: 0.483 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4912846088409424
Epoch: 5, Steps: 2 | Train Loss: 0.286 Vali Loss: 1.417 Vali Acc: 0.267 Test Loss: 1.417 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5148766040802002
Epoch: 6, Steps: 2 | Train Loss: 0.147 Vali Loss: 1.606 Vali Acc: 0.267 Test Loss: 1.606 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5107512474060059
Epoch: 7, Steps: 2 | Train Loss: 0.074 Vali Loss: 1.885 Vali Acc: 0.200 Test Loss: 1.885 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5326628684997559
Epoch: 8, Steps: 2 | Train Loss: 0.029 Vali Loss: 2.098 Vali Acc: 0.200 Test Loss: 2.098 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5899322032928467
Epoch: 9, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.311 Vali Acc: 0.200 Test Loss: 2.311 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.48491644859313965
Epoch: 10, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.586 Vali Acc: 0.200 Test Loss: 2.586 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4992523193359375
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.853 Vali Acc: 0.200 Test Loss: 2.853 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1013283
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1950907707214355
Epoch: 1, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.524883508682251
Epoch: 2, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.510265588760376
Epoch: 3, Steps: 2 | Train Loss: 0.912 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5386583805084229
Epoch: 4, Steps: 2 | Train Loss: 0.636 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5303301811218262
Epoch: 5, Steps: 2 | Train Loss: 0.451 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.554255485534668
Epoch: 6, Steps: 2 | Train Loss: 0.300 Vali Loss: 1.422 Vali Acc: 0.200 Test Loss: 1.422 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5594758987426758
Epoch: 7, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.554 Vali Acc: 0.200 Test Loss: 1.554 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5292506217956543
Epoch: 8, Steps: 2 | Train Loss: 0.123 Vali Loss: 1.650 Vali Acc: 0.333 Test Loss: 1.650 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5400993824005127
Epoch: 9, Steps: 2 | Train Loss: 0.113 Vali Loss: 1.712 Vali Acc: 0.267 Test Loss: 1.712 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5405747890472412
Epoch: 10, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.993 Vali Acc: 0.200 Test Loss: 1.993 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5307700634002686
Epoch: 11, Steps: 2 | Train Loss: 0.028 Vali Loss: 1.960 Vali Acc: 0.333 Test Loss: 1.960 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1013283
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2967584133148193
Epoch: 1, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.45819830894470215
Epoch: 2, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.43279242515563965
Epoch: 3, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4508321285247803
Epoch: 4, Steps: 2 | Train Loss: 0.817 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4434323310852051
Epoch: 5, Steps: 2 | Train Loss: 0.405 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4540989398956299
Epoch: 6, Steps: 2 | Train Loss: 0.293 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.4395763874053955
Epoch: 7, Steps: 2 | Train Loss: 0.145 Vali Loss: 1.378 Vali Acc: 0.267 Test Loss: 1.378 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4989128112792969
Epoch: 8, Steps: 2 | Train Loss: 0.066 Vali Loss: 1.560 Vali Acc: 0.267 Test Loss: 1.560 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4448580741882324
Epoch: 9, Steps: 2 | Train Loss: 0.056 Vali Loss: 1.767 Vali Acc: 0.200 Test Loss: 1.767 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.42893195152282715
Epoch: 10, Steps: 2 | Train Loss: 0.013 Vali Loss: 1.867 Vali Acc: 0.533 Test Loss: 1.867 Test Acc: 0.533
Validation loss decreased (-0.399987 --> -0.533315).  Saving model ...
Epoch: 11 cost time: 0.4723780155181885
Epoch: 11, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.138 Vali Acc: 0.467 Test Loss: 2.138 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5073418617248535
Epoch: 12, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.519 Vali Acc: 0.400 Test Loss: 2.519 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.47715234756469727
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.825 Vali Acc: 0.333 Test Loss: 2.825 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4918079376220703
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 3.071 Vali Acc: 0.333 Test Loss: 3.071 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5012650489807129
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.237 Vali Acc: 0.400 Test Loss: 3.237 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4897904396057129
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.372 Vali Acc: 0.400 Test Loss: 3.372 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4917433261871338
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.506 Vali Acc: 0.333 Test Loss: 3.506 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4972994327545166
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.631 Vali Acc: 0.333 Test Loss: 3.631 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.49341392517089844
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.743 Vali Acc: 0.333 Test Loss: 3.743 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4760115146636963
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.845 Vali Acc: 0.333 Test Loss: 3.845 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 752419
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2738239765167236
Epoch: 1, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5003747940063477
Epoch: 2, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.514204740524292
Epoch: 3, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5154640674591064
Epoch: 4, Steps: 2 | Train Loss: 0.849 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4915471076965332
Epoch: 5, Steps: 2 | Train Loss: 0.401 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5338470935821533
Epoch: 6, Steps: 2 | Train Loss: 0.312 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5227434635162354
Epoch: 7, Steps: 2 | Train Loss: 0.166 Vali Loss: 1.342 Vali Acc: 0.333 Test Loss: 1.342 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5016589164733887
Epoch: 8, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.491 Vali Acc: 0.333 Test Loss: 1.491 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.45418548583984375
Epoch: 9, Steps: 2 | Train Loss: 0.090 Vali Loss: 1.695 Vali Acc: 0.267 Test Loss: 1.695 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4878559112548828
Epoch: 10, Steps: 2 | Train Loss: 0.036 Vali Loss: 1.763 Vali Acc: 0.267 Test Loss: 1.763 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4919869899749756
Epoch: 11, Steps: 2 | Train Loss: 0.006 Vali Loss: 1.958 Vali Acc: 0.333 Test Loss: 1.958 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5696816444396973
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.308 Vali Acc: 0.400 Test Loss: 2.308 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5310559272766113
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.595 Vali Acc: 0.400 Test Loss: 2.595 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5075557231903076
Epoch: 14, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.821 Vali Acc: 0.400 Test Loss: 2.821 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.49906444549560547
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 3.001 Vali Acc: 0.333 Test Loss: 3.001 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.48589229583740234
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.168 Vali Acc: 0.333 Test Loss: 3.168 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 752419
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1985111236572266
Epoch: 1, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5107386112213135
Epoch: 2, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5057718753814697
Epoch: 3, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49591517448425293
Epoch: 4, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5027744770050049
Epoch: 5, Steps: 2 | Train Loss: 0.454 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5292336940765381
Epoch: 6, Steps: 2 | Train Loss: 0.371 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5154259204864502
Epoch: 7, Steps: 2 | Train Loss: 0.219 Vali Loss: 1.312 Vali Acc: 0.333 Test Loss: 1.312 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5192766189575195
Epoch: 8, Steps: 2 | Train Loss: 0.129 Vali Loss: 1.444 Vali Acc: 0.333 Test Loss: 1.444 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.47557735443115234
Epoch: 9, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.647 Vali Acc: 0.267 Test Loss: 1.647 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.48595428466796875
Epoch: 10, Steps: 2 | Train Loss: 0.102 Vali Loss: 1.636 Vali Acc: 0.267 Test Loss: 1.636 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5144994258880615
Epoch: 11, Steps: 2 | Train Loss: 0.029 Vali Loss: 1.669 Vali Acc: 0.267 Test Loss: 1.669 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4899907112121582
Epoch: 12, Steps: 2 | Train Loss: 0.014 Vali Loss: 1.972 Vali Acc: 0.267 Test Loss: 1.972 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.47373342514038086
Epoch: 13, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.110 Vali Acc: 0.333 Test Loss: 2.110 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5141782760620117
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.271 Vali Acc: 0.333 Test Loss: 2.271 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5015718936920166
Epoch: 15, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.400 Vali Acc: 0.333 Test Loss: 2.400 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4946103096008301
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.520 Vali Acc: 0.267 Test Loss: 2.520 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 752419
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2539637088775635
Epoch: 1, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.49133825302124023
Epoch: 2, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47519516944885254
Epoch: 3, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4982874393463135
Epoch: 4, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49953198432922363
Epoch: 5, Steps: 2 | Train Loss: 0.625 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47873592376708984
Epoch: 6, Steps: 2 | Train Loss: 0.573 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.46558690071105957
Epoch: 7, Steps: 2 | Train Loss: 0.416 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4883098602294922
Epoch: 8, Steps: 2 | Train Loss: 0.292 Vali Loss: 1.321 Vali Acc: 0.267 Test Loss: 1.321 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.492840051651001
Epoch: 9, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.441 Vali Acc: 0.267 Test Loss: 1.441 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4935872554779053
Epoch: 10, Steps: 2 | Train Loss: 0.284 Vali Loss: 1.435 Vali Acc: 0.267 Test Loss: 1.435 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5079731941223145
Epoch: 11, Steps: 2 | Train Loss: 0.194 Vali Loss: 1.405 Vali Acc: 0.333 Test Loss: 1.405 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4537065029144287
Epoch: 12, Steps: 2 | Train Loss: 0.148 Vali Loss: 1.437 Vali Acc: 0.333 Test Loss: 1.437 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4884011745452881
Epoch: 13, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.512 Vali Acc: 0.333 Test Loss: 1.512 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5310046672821045
Epoch: 14, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.577 Vali Acc: 0.267 Test Loss: 1.577 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5133209228515625
Epoch: 15, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.694 Vali Acc: 0.333 Test Loss: 1.694 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4962918758392334
Epoch: 16, Steps: 2 | Train Loss: 0.028 Vali Loss: 1.926 Vali Acc: 0.267 Test Loss: 1.926 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 752419
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2022593021392822
Epoch: 1, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5159764289855957
Epoch: 2, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4845895767211914
Epoch: 3, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5107426643371582
Epoch: 4, Steps: 2 | Train Loss: 0.604 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49049806594848633
Epoch: 5, Steps: 2 | Train Loss: 0.423 Vali Loss: 1.292 Vali Acc: 0.267 Test Loss: 1.292 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4840364456176758
Epoch: 6, Steps: 2 | Train Loss: 0.305 Vali Loss: 1.428 Vali Acc: 0.333 Test Loss: 1.428 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4893763065338135
Epoch: 7, Steps: 2 | Train Loss: 0.157 Vali Loss: 1.508 Vali Acc: 0.333 Test Loss: 1.508 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5226001739501953
Epoch: 8, Steps: 2 | Train Loss: 0.103 Vali Loss: 1.810 Vali Acc: 0.467 Test Loss: 1.810 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466649).  Saving model ...
Epoch: 9 cost time: 0.4809291362762451
Epoch: 9, Steps: 2 | Train Loss: 0.037 Vali Loss: 1.937 Vali Acc: 0.467 Test Loss: 1.937 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4820244312286377
Epoch: 10, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.156 Vali Acc: 0.400 Test Loss: 2.156 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.463533878326416
Epoch: 11, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.442 Vali Acc: 0.400 Test Loss: 2.442 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.47029614448547363
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.689 Vali Acc: 0.400 Test Loss: 2.689 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.45716118812561035
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.878 Vali Acc: 0.400 Test Loss: 2.878 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5154354572296143
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.997 Vali Acc: 0.400 Test Loss: 2.997 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4797663688659668
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.094 Vali Acc: 0.400 Test Loss: 3.094 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4884676933288574
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.179 Vali Acc: 0.400 Test Loss: 3.179 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4823935031890869
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.256 Vali Acc: 0.333 Test Loss: 3.256 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.444136381149292
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.325 Vali Acc: 0.400 Test Loss: 3.325 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 621347
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2571308612823486
Epoch: 1, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.184 Vali Acc: 0.467 Test Loss: 1.184 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5031650066375732
Epoch: 2, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.496626615524292
Epoch: 3, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5373165607452393
Epoch: 4, Steps: 2 | Train Loss: 0.642 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49352121353149414
Epoch: 5, Steps: 2 | Train Loss: 0.450 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.500723123550415
Epoch: 6, Steps: 2 | Train Loss: 0.350 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.49730587005615234
Epoch: 7, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.421 Vali Acc: 0.467 Test Loss: 1.421 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5114643573760986
Epoch: 8, Steps: 2 | Train Loss: 0.135 Vali Loss: 1.642 Vali Acc: 0.400 Test Loss: 1.642 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.49197888374328613
Epoch: 9, Steps: 2 | Train Loss: 0.055 Vali Loss: 1.741 Vali Acc: 0.333 Test Loss: 1.741 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.474276065826416
Epoch: 10, Steps: 2 | Train Loss: 0.018 Vali Loss: 1.950 Vali Acc: 0.400 Test Loss: 1.950 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5150275230407715
Epoch: 11, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.202 Vali Acc: 0.400 Test Loss: 2.202 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 621347
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3382017612457275
Epoch: 1, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5122280120849609
Epoch: 2, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48363351821899414
Epoch: 3, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47348809242248535
Epoch: 4, Steps: 2 | Train Loss: 0.726 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4853222370147705
Epoch: 5, Steps: 2 | Train Loss: 0.511 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47313690185546875
Epoch: 6, Steps: 2 | Train Loss: 0.449 Vali Loss: 1.306 Vali Acc: 0.333 Test Loss: 1.306 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.47306227684020996
Epoch: 7, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4799799919128418
Epoch: 8, Steps: 2 | Train Loss: 0.199 Vali Loss: 1.439 Vali Acc: 0.333 Test Loss: 1.439 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.47681736946105957
Epoch: 9, Steps: 2 | Train Loss: 0.100 Vali Loss: 1.486 Vali Acc: 0.400 Test Loss: 1.486 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4654428958892822
Epoch: 10, Steps: 2 | Train Loss: 0.043 Vali Loss: 1.642 Vali Acc: 0.333 Test Loss: 1.642 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5021095275878906
Epoch: 11, Steps: 2 | Train Loss: 0.023 Vali Loss: 1.802 Vali Acc: 0.333 Test Loss: 1.802 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 621347
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.134113311767578
Epoch: 1, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4655900001525879
Epoch: 2, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4961676597595215
Epoch: 3, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5036044120788574
Epoch: 4, Steps: 2 | Train Loss: 0.868 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.496929407119751
Epoch: 5, Steps: 2 | Train Loss: 0.711 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47641515731811523
Epoch: 6, Steps: 2 | Train Loss: 0.655 Vali Loss: 1.343 Vali Acc: 0.267 Test Loss: 1.343 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4716811180114746
Epoch: 7, Steps: 2 | Train Loss: 0.531 Vali Loss: 1.427 Vali Acc: 0.133 Test Loss: 1.427 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5326800346374512
Epoch: 8, Steps: 2 | Train Loss: 0.403 Vali Loss: 1.465 Vali Acc: 0.267 Test Loss: 1.465 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4663269519805908
Epoch: 9, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.413 Vali Acc: 0.267 Test Loss: 1.413 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.45286035537719727
Epoch: 10, Steps: 2 | Train Loss: 0.164 Vali Loss: 1.486 Vali Acc: 0.267 Test Loss: 1.486 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4649665355682373
Epoch: 11, Steps: 2 | Train Loss: 0.141 Vali Loss: 1.639 Vali Acc: 0.333 Test Loss: 1.639 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 621347
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3240890502929688
Epoch: 1, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.423814058303833
Epoch: 2, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.45058202743530273
Epoch: 3, Steps: 2 | Train Loss: 0.910 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.43926405906677246
Epoch: 4, Steps: 2 | Train Loss: 0.701 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.44636988639831543
Epoch: 5, Steps: 2 | Train Loss: 0.378 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.43666839599609375
Epoch: 6, Steps: 2 | Train Loss: 0.270 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.47969698905944824
Epoch: 7, Steps: 2 | Train Loss: 0.212 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4541747570037842
Epoch: 8, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.396 Vali Acc: 0.467 Test Loss: 1.396 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.43039584159851074
Epoch: 9, Steps: 2 | Train Loss: 0.050 Vali Loss: 1.679 Vali Acc: 0.400 Test Loss: 1.679 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4259610176086426
Epoch: 10, Steps: 2 | Train Loss: 0.019 Vali Loss: 1.861 Vali Acc: 0.400 Test Loss: 1.861 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.458935022354126
Epoch: 11, Steps: 2 | Train Loss: 0.007 Vali Loss: 2.017 Vali Acc: 0.400 Test Loss: 2.017 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4364633560180664
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.142 Vali Acc: 0.400 Test Loss: 2.142 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.41326165199279785
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.267 Vali Acc: 0.467 Test Loss: 2.267 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 555811
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2490451335906982
Epoch: 1, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.063 Vali Acc: 0.267 Test Loss: 1.063 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5425024032592773
Epoch: 2, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.056 Vali Acc: 0.200 Test Loss: 1.056 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5452718734741211
Epoch: 3, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.48552656173706055
Epoch: 4, Steps: 2 | Train Loss: 0.727 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5099217891693115
Epoch: 5, Steps: 2 | Train Loss: 0.421 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5273222923278809
Epoch: 6, Steps: 2 | Train Loss: 0.284 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5101771354675293
Epoch: 7, Steps: 2 | Train Loss: 0.230 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4734463691711426
Epoch: 8, Steps: 2 | Train Loss: 0.116 Vali Loss: 1.366 Vali Acc: 0.400 Test Loss: 1.366 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5052509307861328
Epoch: 9, Steps: 2 | Train Loss: 0.074 Vali Loss: 1.672 Vali Acc: 0.400 Test Loss: 1.672 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4928476810455322
Epoch: 10, Steps: 2 | Train Loss: 0.035 Vali Loss: 1.824 Vali Acc: 0.333 Test Loss: 1.824 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.43524837493896484
Epoch: 11, Steps: 2 | Train Loss: 0.013 Vali Loss: 1.902 Vali Acc: 0.333 Test Loss: 1.902 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.48747944831848145
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 1.956 Vali Acc: 0.400 Test Loss: 1.956 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4926149845123291
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.068 Vali Acc: 0.333 Test Loss: 2.068 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 555811
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3795084953308105
Epoch: 1, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4686238765716553
Epoch: 2, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.4935336112976074
Epoch: 3, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.455704927444458
Epoch: 4, Steps: 2 | Train Loss: 0.809 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.46828269958496094
Epoch: 5, Steps: 2 | Train Loss: 0.473 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.45984983444213867
Epoch: 6, Steps: 2 | Train Loss: 0.335 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.46577978134155273
Epoch: 7, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4735705852508545
Epoch: 8, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4973111152648926
Epoch: 9, Steps: 2 | Train Loss: 0.112 Vali Loss: 1.467 Vali Acc: 0.400 Test Loss: 1.467 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4677145481109619
Epoch: 10, Steps: 2 | Train Loss: 0.074 Vali Loss: 1.554 Vali Acc: 0.400 Test Loss: 1.554 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.44174647331237793
Epoch: 11, Steps: 2 | Train Loss: 0.029 Vali Loss: 1.576 Vali Acc: 0.400 Test Loss: 1.576 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.49463677406311035
Epoch: 12, Steps: 2 | Train Loss: 0.013 Vali Loss: 1.649 Vali Acc: 0.333 Test Loss: 1.649 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4567849636077881
Epoch: 13, Steps: 2 | Train Loss: 0.012 Vali Loss: 1.829 Vali Acc: 0.267 Test Loss: 1.829 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 555811
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1678435802459717
Epoch: 1, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4524376392364502
Epoch: 2, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4533114433288574
Epoch: 3, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5290277004241943
Epoch: 4, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4743306636810303
Epoch: 5, Steps: 2 | Train Loss: 0.672 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.49428582191467285
Epoch: 6, Steps: 2 | Train Loss: 0.502 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.475846529006958
Epoch: 7, Steps: 2 | Train Loss: 0.472 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.48719120025634766
Epoch: 8, Steps: 2 | Train Loss: 0.306 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 9 cost time: 0.4708528518676758
Epoch: 9, Steps: 2 | Train Loss: 0.335 Vali Loss: 1.284 Vali Acc: 0.467 Test Loss: 1.284 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4844982624053955
Epoch: 10, Steps: 2 | Train Loss: 0.263 Vali Loss: 1.416 Vali Acc: 0.267 Test Loss: 1.416 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.482757568359375
Epoch: 11, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.417 Vali Acc: 0.400 Test Loss: 1.417 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4918694496154785
Epoch: 12, Steps: 2 | Train Loss: 0.137 Vali Loss: 1.490 Vali Acc: 0.467 Test Loss: 1.490 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.45737457275390625
Epoch: 13, Steps: 2 | Train Loss: 0.192 Vali Loss: 1.532 Vali Acc: 0.467 Test Loss: 1.532 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4357914924621582
Epoch: 14, Steps: 2 | Train Loss: 0.118 Vali Loss: 1.602 Vali Acc: 0.333 Test Loss: 1.602 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.45584678649902344
Epoch: 15, Steps: 2 | Train Loss: 0.038 Vali Loss: 1.963 Vali Acc: 0.267 Test Loss: 1.963 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4880354404449463
Epoch: 16, Steps: 2 | Train Loss: 0.035 Vali Loss: 2.260 Vali Acc: 0.267 Test Loss: 2.260 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.46043920516967773
Epoch: 17, Steps: 2 | Train Loss: 0.035 Vali Loss: 2.158 Vali Acc: 0.267 Test Loss: 2.158 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4735398292541504
Epoch: 18, Steps: 2 | Train Loss: 0.014 Vali Loss: 1.962 Vali Acc: 0.267 Test Loss: 1.962 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 555811
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2570788860321045
Epoch: 1, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4893343448638916
Epoch: 2, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4705846309661865
Epoch: 3, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5146059989929199
Epoch: 4, Steps: 2 | Train Loss: 0.655 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.49625492095947266
Epoch: 5, Steps: 2 | Train Loss: 0.475 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5449318885803223
Epoch: 6, Steps: 2 | Train Loss: 0.353 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.529801607131958
Epoch: 7, Steps: 2 | Train Loss: 0.175 Vali Loss: 1.262 Vali Acc: 0.467 Test Loss: 1.262 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 8 cost time: 0.5412027835845947
Epoch: 8, Steps: 2 | Train Loss: 0.072 Vali Loss: 1.432 Vali Acc: 0.333 Test Loss: 1.432 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5457429885864258
Epoch: 9, Steps: 2 | Train Loss: 0.033 Vali Loss: 1.607 Vali Acc: 0.467 Test Loss: 1.607 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5763359069824219
Epoch: 10, Steps: 2 | Train Loss: 0.013 Vali Loss: 1.840 Vali Acc: 0.467 Test Loss: 1.840 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5717401504516602
Epoch: 11, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.086 Vali Acc: 0.467 Test Loss: 2.086 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5425088405609131
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.349 Vali Acc: 0.333 Test Loss: 2.349 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5620646476745605
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.604 Vali Acc: 0.267 Test Loss: 2.604 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5577747821807861
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.837 Vali Acc: 0.200 Test Loss: 2.837 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5378448963165283
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.029 Vali Acc: 0.200 Test Loss: 3.029 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5130224227905273
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.188 Vali Acc: 0.200 Test Loss: 3.188 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5073165893554688
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.320 Vali Acc: 0.200 Test Loss: 3.320 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 523043
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.264350414276123
Epoch: 1, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5106339454650879
Epoch: 2, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5465095043182373
Epoch: 3, Steps: 2 | Train Loss: 0.828 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4786720275878906
Epoch: 4, Steps: 2 | Train Loss: 0.669 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5337696075439453
Epoch: 5, Steps: 2 | Train Loss: 0.500 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.49080538749694824
Epoch: 6, Steps: 2 | Train Loss: 0.375 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5258350372314453
Epoch: 7, Steps: 2 | Train Loss: 0.205 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5344994068145752
Epoch: 8, Steps: 2 | Train Loss: 0.102 Vali Loss: 1.370 Vali Acc: 0.333 Test Loss: 1.370 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5479006767272949
Epoch: 9, Steps: 2 | Train Loss: 0.057 Vali Loss: 1.490 Vali Acc: 0.333 Test Loss: 1.490 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5094730854034424
Epoch: 10, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.716 Vali Acc: 0.333 Test Loss: 1.716 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5168673992156982
Epoch: 11, Steps: 2 | Train Loss: 0.008 Vali Loss: 1.925 Vali Acc: 0.333 Test Loss: 1.925 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.553570032119751
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.125 Vali Acc: 0.333 Test Loss: 2.125 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5490477085113525
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.318 Vali Acc: 0.333 Test Loss: 2.318 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5093817710876465
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.497 Vali Acc: 0.333 Test Loss: 2.497 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5110366344451904
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.634 Vali Acc: 0.333 Test Loss: 2.634 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5032186508178711
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.748 Vali Acc: 0.333 Test Loss: 2.748 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 523043
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2438888549804688
Epoch: 1, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4584484100341797
Epoch: 2, Steps: 2 | Train Loss: 0.910 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46465301513671875
Epoch: 3, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.199989 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.4708592891693115
Epoch: 4, Steps: 2 | Train Loss: 0.711 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.45960021018981934
Epoch: 5, Steps: 2 | Train Loss: 0.542 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4544954299926758
Epoch: 6, Steps: 2 | Train Loss: 0.440 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.48671936988830566
Epoch: 7, Steps: 2 | Train Loss: 0.236 Vali Loss: 1.304 Vali Acc: 0.267 Test Loss: 1.304 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4806358814239502
Epoch: 8, Steps: 2 | Train Loss: 0.155 Vali Loss: 1.377 Vali Acc: 0.267 Test Loss: 1.377 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4655735492706299
Epoch: 9, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.432 Vali Acc: 0.267 Test Loss: 1.432 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4807248115539551
Epoch: 10, Steps: 2 | Train Loss: 0.060 Vali Loss: 1.594 Vali Acc: 0.333 Test Loss: 1.594 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4758880138397217
Epoch: 11, Steps: 2 | Train Loss: 0.020 Vali Loss: 1.726 Vali Acc: 0.267 Test Loss: 1.726 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.48551130294799805
Epoch: 12, Steps: 2 | Train Loss: 0.012 Vali Loss: 1.946 Vali Acc: 0.333 Test Loss: 1.946 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4958066940307617
Epoch: 13, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.190 Vali Acc: 0.267 Test Loss: 2.190 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 523043
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.101667642593384
Epoch: 1, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5416533946990967
Epoch: 2, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4772026538848877
Epoch: 3, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5045926570892334
Epoch: 4, Steps: 2 | Train Loss: 0.827 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.511925458908081
Epoch: 5, Steps: 2 | Train Loss: 0.741 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5023705959320068
Epoch: 6, Steps: 2 | Train Loss: 0.677 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5060122013092041
Epoch: 7, Steps: 2 | Train Loss: 0.444 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5379748344421387
Epoch: 8, Steps: 2 | Train Loss: 0.385 Vali Loss: 1.362 Vali Acc: 0.267 Test Loss: 1.362 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5421054363250732
Epoch: 9, Steps: 2 | Train Loss: 0.262 Vali Loss: 1.393 Vali Acc: 0.267 Test Loss: 1.393 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5324544906616211
Epoch: 10, Steps: 2 | Train Loss: 0.259 Vali Loss: 1.432 Vali Acc: 0.200 Test Loss: 1.432 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5725414752960205
Epoch: 11, Steps: 2 | Train Loss: 0.194 Vali Loss: 1.551 Vali Acc: 0.200 Test Loss: 1.551 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5819230079650879
Epoch: 12, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.560 Vali Acc: 0.333 Test Loss: 1.560 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5313012599945068
Epoch: 13, Steps: 2 | Train Loss: 0.111 Vali Loss: 1.641 Vali Acc: 0.333 Test Loss: 1.641 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 523043
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.327873945236206
Epoch: 1, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4535031318664551
Epoch: 2, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.46209120750427246
Epoch: 3, Steps: 2 | Train Loss: 0.620 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.4710671901702881
Epoch: 4, Steps: 2 | Train Loss: 0.568 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4752798080444336
Epoch: 5, Steps: 2 | Train Loss: 0.402 Vali Loss: 1.285 Vali Acc: 0.333 Test Loss: 1.285 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4450647830963135
Epoch: 6, Steps: 2 | Train Loss: 0.201 Vali Loss: 1.407 Vali Acc: 0.333 Test Loss: 1.407 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.43239569664001465
Epoch: 7, Steps: 2 | Train Loss: 0.132 Vali Loss: 1.565 Vali Acc: 0.333 Test Loss: 1.565 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4236280918121338
Epoch: 8, Steps: 2 | Train Loss: 0.068 Vali Loss: 1.599 Vali Acc: 0.333 Test Loss: 1.599 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.45494651794433594
Epoch: 9, Steps: 2 | Train Loss: 0.028 Vali Loss: 1.696 Vali Acc: 0.533 Test Loss: 1.696 Test Acc: 0.533
Validation loss decreased (-0.399988 --> -0.533316).  Saving model ...
Epoch: 10 cost time: 0.4436030387878418
Epoch: 10, Steps: 2 | Train Loss: 0.015 Vali Loss: 1.923 Vali Acc: 0.600 Test Loss: 1.923 Test Acc: 0.600
Validation loss decreased (-0.533316 --> -0.599981).  Saving model ...
Epoch: 11 cost time: 0.42706871032714844
Epoch: 11, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.218 Vali Acc: 0.467 Test Loss: 2.218 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4451284408569336
Epoch: 12, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.516 Vali Acc: 0.400 Test Loss: 2.516 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.41606926918029785
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.803 Vali Acc: 0.400 Test Loss: 2.803 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4598207473754883
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.050 Vali Acc: 0.400 Test Loss: 3.050 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.44249439239501953
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.265 Vali Acc: 0.400 Test Loss: 3.265 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.45946764945983887
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.441 Vali Acc: 0.333 Test Loss: 3.441 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5004258155822754
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.586 Vali Acc: 0.333 Test Loss: 3.586 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.48720622062683105
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.706 Vali Acc: 0.333 Test Loss: 3.706 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.49941253662109375
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.802 Vali Acc: 0.333 Test Loss: 3.802 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4740772247314453
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.877 Vali Acc: 0.333 Test Loss: 3.877 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 506659
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.270366668701172
Epoch: 1, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5657408237457275
Epoch: 2, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5245928764343262
Epoch: 3, Steps: 2 | Train Loss: 0.706 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4655435085296631
Epoch: 4, Steps: 2 | Train Loss: 0.597 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.4829707145690918
Epoch: 5, Steps: 2 | Train Loss: 0.420 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.48926806449890137
Epoch: 6, Steps: 2 | Train Loss: 0.232 Vali Loss: 1.324 Vali Acc: 0.333 Test Loss: 1.324 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.48914027214050293
Epoch: 7, Steps: 2 | Train Loss: 0.175 Vali Loss: 1.442 Vali Acc: 0.400 Test Loss: 1.442 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.49761033058166504
Epoch: 8, Steps: 2 | Train Loss: 0.103 Vali Loss: 1.490 Vali Acc: 0.333 Test Loss: 1.490 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5080928802490234
Epoch: 9, Steps: 2 | Train Loss: 0.052 Vali Loss: 1.559 Vali Acc: 0.400 Test Loss: 1.559 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5080404281616211
Epoch: 10, Steps: 2 | Train Loss: 0.025 Vali Loss: 1.769 Vali Acc: 0.400 Test Loss: 1.769 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.48532938957214355
Epoch: 11, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.086 Vali Acc: 0.333 Test Loss: 2.086 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5156650543212891
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.343 Vali Acc: 0.333 Test Loss: 2.343 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.49459385871887207
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.555 Vali Acc: 0.400 Test Loss: 2.555 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5116958618164062
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.703 Vali Acc: 0.400 Test Loss: 2.703 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 506659
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3025341033935547
Epoch: 1, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5331528186798096
Epoch: 2, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5516278743743896
Epoch: 3, Steps: 2 | Train Loss: 0.722 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.505622386932373
Epoch: 4, Steps: 2 | Train Loss: 0.657 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5346460342407227
Epoch: 5, Steps: 2 | Train Loss: 0.494 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5236523151397705
Epoch: 6, Steps: 2 | Train Loss: 0.282 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5165238380432129
Epoch: 7, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.522214412689209
Epoch: 8, Steps: 2 | Train Loss: 0.148 Vali Loss: 1.361 Vali Acc: 0.333 Test Loss: 1.361 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5064244270324707
Epoch: 9, Steps: 2 | Train Loss: 0.106 Vali Loss: 1.450 Vali Acc: 0.400 Test Loss: 1.450 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.50246262550354
Epoch: 10, Steps: 2 | Train Loss: 0.056 Vali Loss: 1.571 Vali Acc: 0.267 Test Loss: 1.571 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.47863101959228516
Epoch: 11, Steps: 2 | Train Loss: 0.021 Vali Loss: 1.836 Vali Acc: 0.333 Test Loss: 1.836 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 506659
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1957428455352783
Epoch: 1, Steps: 2 | Train Loss: 1.038 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.49095630645751953
Epoch: 2, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.47202634811401367
Epoch: 3, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5096631050109863
Epoch: 4, Steps: 2 | Train Loss: 0.825 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.44521069526672363
Epoch: 5, Steps: 2 | Train Loss: 0.666 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.457308292388916
Epoch: 6, Steps: 2 | Train Loss: 0.436 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5058176517486572
Epoch: 7, Steps: 2 | Train Loss: 0.383 Vali Loss: 1.316 Vali Acc: 0.333 Test Loss: 1.316 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4589390754699707
Epoch: 8, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.47827672958374023
Epoch: 9, Steps: 2 | Train Loss: 0.332 Vali Loss: 1.430 Vali Acc: 0.267 Test Loss: 1.430 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.47498250007629395
Epoch: 10, Steps: 2 | Train Loss: 0.245 Vali Loss: 1.407 Vali Acc: 0.267 Test Loss: 1.407 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5030174255371094
Epoch: 11, Steps: 2 | Train Loss: 0.134 Vali Loss: 1.508 Vali Acc: 0.333 Test Loss: 1.508 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4891197681427002
Epoch: 12, Steps: 2 | Train Loss: 0.145 Vali Loss: 1.534 Vali Acc: 0.267 Test Loss: 1.534 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.48010945320129395
Epoch: 13, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.652 Vali Acc: 0.267 Test Loss: 1.652 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 506659
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.429835319519043
Epoch: 1, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5087683200836182
Epoch: 2, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.063 Vali Acc: 0.267 Test Loss: 1.063 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5282468795776367
Epoch: 3, Steps: 2 | Train Loss: 0.885 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5163276195526123
Epoch: 4, Steps: 2 | Train Loss: 0.653 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.503899097442627
Epoch: 5, Steps: 2 | Train Loss: 0.389 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5059554576873779
Epoch: 6, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.238 Vali Acc: 0.533 Test Loss: 1.238 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533321).  Saving model ...
Epoch: 7 cost time: 0.48575520515441895
Epoch: 7, Steps: 2 | Train Loss: 0.134 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
Validation loss decreased (-0.533321 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 0.47626328468322754
Epoch: 8, Steps: 2 | Train Loss: 0.066 Vali Loss: 1.536 Vali Acc: 0.400 Test Loss: 1.536 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.47985076904296875
Epoch: 9, Steps: 2 | Train Loss: 0.023 Vali Loss: 1.694 Vali Acc: 0.533 Test Loss: 1.694 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5117480754852295
Epoch: 10, Steps: 2 | Train Loss: 0.007 Vali Loss: 1.935 Vali Acc: 0.533 Test Loss: 1.935 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.48812007904052734
Epoch: 11, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.206 Vali Acc: 0.400 Test Loss: 2.206 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4843268394470215
Epoch: 12, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.488 Vali Acc: 0.333 Test Loss: 2.488 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4830965995788574
Epoch: 13, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.740 Vali Acc: 0.333 Test Loss: 2.740 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5188469886779785
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 2.952 Vali Acc: 0.333 Test Loss: 2.952 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5169298648834229
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.142 Vali Acc: 0.333 Test Loss: 3.142 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.49092721939086914
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.300 Vali Acc: 0.333 Test Loss: 3.300 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4760720729827881
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 3.435 Vali Acc: 0.333 Test Loss: 3.435 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 498467
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3301949501037598
Epoch: 1, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5082352161407471
Epoch: 2, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5005371570587158
Epoch: 3, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4761838912963867
Epoch: 4, Steps: 2 | Train Loss: 0.693 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.513235330581665
Epoch: 5, Steps: 2 | Train Loss: 0.409 Vali Loss: 1.184 Vali Acc: 0.467 Test Loss: 1.184 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4617280960083008
Epoch: 6, Steps: 2 | Train Loss: 0.270 Vali Loss: 1.261 Vali Acc: 0.467 Test Loss: 1.261 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4694855213165283
Epoch: 7, Steps: 2 | Train Loss: 0.169 Vali Loss: 1.362 Vali Acc: 0.467 Test Loss: 1.362 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5505964756011963
Epoch: 8, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.502 Vali Acc: 0.400 Test Loss: 1.502 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5276036262512207
Epoch: 9, Steps: 2 | Train Loss: 0.047 Vali Loss: 1.614 Vali Acc: 0.400 Test Loss: 1.614 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5278913974761963
Epoch: 10, Steps: 2 | Train Loss: 0.017 Vali Loss: 1.794 Vali Acc: 0.333 Test Loss: 1.794 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4722425937652588
Epoch: 11, Steps: 2 | Train Loss: 0.009 Vali Loss: 2.136 Vali Acc: 0.400 Test Loss: 2.136 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4947233200073242
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.532 Vali Acc: 0.333 Test Loss: 2.532 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.502678632736206
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.852 Vali Acc: 0.333 Test Loss: 2.852 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 498467
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.227736234664917
Epoch: 1, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.48764705657958984
Epoch: 2, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.504051923751831
Epoch: 3, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.4898104667663574
Epoch: 4, Steps: 2 | Train Loss: 0.750 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.49010491371154785
Epoch: 5, Steps: 2 | Train Loss: 0.467 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5279662609100342
Epoch: 6, Steps: 2 | Train Loss: 0.327 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4796147346496582
Epoch: 7, Steps: 2 | Train Loss: 0.222 Vali Loss: 1.341 Vali Acc: 0.333 Test Loss: 1.341 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4575071334838867
Epoch: 8, Steps: 2 | Train Loss: 0.134 Vali Loss: 1.451 Vali Acc: 0.400 Test Loss: 1.451 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5049540996551514
Epoch: 9, Steps: 2 | Train Loss: 0.140 Vali Loss: 1.582 Vali Acc: 0.333 Test Loss: 1.582 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.45374083518981934
Epoch: 10, Steps: 2 | Train Loss: 0.089 Vali Loss: 1.662 Vali Acc: 0.333 Test Loss: 1.662 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4825403690338135
Epoch: 11, Steps: 2 | Train Loss: 0.030 Vali Loss: 1.842 Vali Acc: 0.333 Test Loss: 1.842 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4806709289550781
Epoch: 12, Steps: 2 | Train Loss: 0.015 Vali Loss: 2.193 Vali Acc: 0.200 Test Loss: 2.193 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4918217658996582
Epoch: 13, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.302 Vali Acc: 0.333 Test Loss: 2.302 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 498467
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1830599308013916
Epoch: 1, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.47882509231567383
Epoch: 2, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.44292426109313965
Epoch: 3, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.43408989906311035
Epoch: 4, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5116608142852783
Epoch: 5, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.47092199325561523
Epoch: 6, Steps: 2 | Train Loss: 0.529 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.45523619651794434
Epoch: 7, Steps: 2 | Train Loss: 0.428 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.48104166984558105
Epoch: 8, Steps: 2 | Train Loss: 0.291 Vali Loss: 1.405 Vali Acc: 0.267 Test Loss: 1.405 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.44745492935180664
Epoch: 9, Steps: 2 | Train Loss: 0.417 Vali Loss: 1.680 Vali Acc: 0.400 Test Loss: 1.680 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4509584903717041
Epoch: 10, Steps: 2 | Train Loss: 0.384 Vali Loss: 1.653 Vali Acc: 0.267 Test Loss: 1.653 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5608389377593994
Epoch: 11, Steps: 2 | Train Loss: 0.219 Vali Loss: 1.476 Vali Acc: 0.333 Test Loss: 1.476 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.43500208854675293
Epoch: 12, Steps: 2 | Train Loss: 0.135 Vali Loss: 1.599 Vali Acc: 0.200 Test Loss: 1.599 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.42826271057128906
Epoch: 13, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.619 Vali Acc: 0.267 Test Loss: 1.619 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 498467
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2387735843658447
Epoch: 1, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.44936347007751465
Epoch: 2, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.4487874507904053
Epoch: 3, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.45055556297302246
Epoch: 4, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4495229721069336
Epoch: 5, Steps: 2 | Train Loss: 0.780 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4533822536468506
Epoch: 6, Steps: 2 | Train Loss: 0.430 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4366025924682617
Epoch: 7, Steps: 2 | Train Loss: 0.339 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.4735758304595947
Epoch: 8, Steps: 2 | Train Loss: 0.296 Vali Loss: 1.355 Vali Acc: 0.467 Test Loss: 1.355 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466653).  Saving model ...
Epoch: 9 cost time: 0.4935171604156494
Epoch: 9, Steps: 2 | Train Loss: 0.184 Vali Loss: 1.439 Vali Acc: 0.467 Test Loss: 1.439 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.46425795555114746
Epoch: 10, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.481 Vali Acc: 0.333 Test Loss: 1.481 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.48502016067504883
Epoch: 11, Steps: 2 | Train Loss: 0.100 Vali Loss: 1.545 Vali Acc: 0.267 Test Loss: 1.545 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4842526912689209
Epoch: 12, Steps: 2 | Train Loss: 0.063 Vali Loss: 1.643 Vali Acc: 0.400 Test Loss: 1.643 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.45804548263549805
Epoch: 13, Steps: 2 | Train Loss: 0.029 Vali Loss: 1.767 Vali Acc: 0.400 Test Loss: 1.767 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5080850124359131
Epoch: 14, Steps: 2 | Train Loss: 0.014 Vali Loss: 1.943 Vali Acc: 0.400 Test Loss: 1.943 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.49680018424987793
Epoch: 15, Steps: 2 | Train Loss: 0.006 Vali Loss: 2.136 Vali Acc: 0.333 Test Loss: 2.136 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.49329590797424316
Epoch: 16, Steps: 2 | Train Loss: 0.006 Vali Loss: 2.311 Vali Acc: 0.333 Test Loss: 2.311 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4903225898742676
Epoch: 17, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.437 Vali Acc: 0.333 Test Loss: 2.437 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.45764994621276855
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.532 Vali Acc: 0.333 Test Loss: 2.532 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 374179
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.339251756668091
Epoch: 1, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4929473400115967
Epoch: 2, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4957914352416992
Epoch: 3, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5074081420898438
Epoch: 4, Steps: 2 | Train Loss: 0.830 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5123255252838135
Epoch: 5, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5118789672851562
Epoch: 6, Steps: 2 | Train Loss: 0.482 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.5270984172821045
Epoch: 7, Steps: 2 | Train Loss: 0.368 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4851217269897461
Epoch: 8, Steps: 2 | Train Loss: 0.356 Vali Loss: 1.275 Vali Acc: 0.467 Test Loss: 1.275 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5338850021362305
Epoch: 9, Steps: 2 | Train Loss: 0.229 Vali Loss: 1.345 Vali Acc: 0.467 Test Loss: 1.345 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4720759391784668
Epoch: 10, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.365 Vali Acc: 0.467 Test Loss: 1.365 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.563981294631958
Epoch: 11, Steps: 2 | Train Loss: 0.162 Vali Loss: 1.403 Vali Acc: 0.400 Test Loss: 1.403 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5400257110595703
Epoch: 12, Steps: 2 | Train Loss: 0.101 Vali Loss: 1.447 Vali Acc: 0.333 Test Loss: 1.447 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.49394893646240234
Epoch: 13, Steps: 2 | Train Loss: 0.052 Vali Loss: 1.542 Vali Acc: 0.400 Test Loss: 1.542 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.500105619430542
Epoch: 14, Steps: 2 | Train Loss: 0.024 Vali Loss: 1.680 Vali Acc: 0.400 Test Loss: 1.680 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5120387077331543
Epoch: 15, Steps: 2 | Train Loss: 0.013 Vali Loss: 1.827 Vali Acc: 0.400 Test Loss: 1.827 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.503413200378418
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 1.963 Vali Acc: 0.400 Test Loss: 1.963 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 374179
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1405632495880127
Epoch: 1, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5369985103607178
Epoch: 2, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5555882453918457
Epoch: 3, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5291495323181152
Epoch: 4, Steps: 2 | Train Loss: 0.896 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5137264728546143
Epoch: 5, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.48215651512145996
Epoch: 6, Steps: 2 | Train Loss: 0.563 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4873514175415039
Epoch: 7, Steps: 2 | Train Loss: 0.462 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4985835552215576
Epoch: 8, Steps: 2 | Train Loss: 0.472 Vali Loss: 1.275 Vali Acc: 0.467 Test Loss: 1.275 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 9 cost time: 0.49718141555786133
Epoch: 9, Steps: 2 | Train Loss: 0.296 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4952816963195801
Epoch: 10, Steps: 2 | Train Loss: 0.227 Vali Loss: 1.319 Vali Acc: 0.333 Test Loss: 1.319 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5197939872741699
Epoch: 11, Steps: 2 | Train Loss: 0.271 Vali Loss: 1.396 Vali Acc: 0.267 Test Loss: 1.396 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6004981994628906
Epoch: 12, Steps: 2 | Train Loss: 0.184 Vali Loss: 1.454 Vali Acc: 0.400 Test Loss: 1.454 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5333871841430664
Epoch: 13, Steps: 2 | Train Loss: 0.120 Vali Loss: 1.488 Vali Acc: 0.400 Test Loss: 1.488 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4828603267669678
Epoch: 14, Steps: 2 | Train Loss: 0.083 Vali Loss: 1.551 Vali Acc: 0.267 Test Loss: 1.551 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5445096492767334
Epoch: 15, Steps: 2 | Train Loss: 0.040 Vali Loss: 1.653 Vali Acc: 0.267 Test Loss: 1.653 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5332376956939697
Epoch: 16, Steps: 2 | Train Loss: 0.043 Vali Loss: 1.809 Vali Acc: 0.200 Test Loss: 1.809 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5003907680511475
Epoch: 17, Steps: 2 | Train Loss: 0.023 Vali Loss: 1.899 Vali Acc: 0.267 Test Loss: 1.899 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5162050724029541
Epoch: 18, Steps: 2 | Train Loss: 0.017 Vali Loss: 1.969 Vali Acc: 0.267 Test Loss: 1.969 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 374179
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2161924839019775
Epoch: 1, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.47147393226623535
Epoch: 2, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5276088714599609
Epoch: 3, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.47933125495910645
Epoch: 4, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5027472972869873
Epoch: 5, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4413118362426758
Epoch: 6, Steps: 2 | Train Loss: 0.738 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4840223789215088
Epoch: 7, Steps: 2 | Train Loss: 0.626 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4627668857574463
Epoch: 8, Steps: 2 | Train Loss: 0.654 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4609682559967041
Epoch: 9, Steps: 2 | Train Loss: 0.443 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4629244804382324
Epoch: 10, Steps: 2 | Train Loss: 0.389 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.489077091217041
Epoch: 11, Steps: 2 | Train Loss: 0.465 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4484834671020508
Epoch: 12, Steps: 2 | Train Loss: 0.375 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.455427885055542
Epoch: 13, Steps: 2 | Train Loss: 0.304 Vali Loss: 1.330 Vali Acc: 0.267 Test Loss: 1.330 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5262181758880615
Epoch: 14, Steps: 2 | Train Loss: 0.238 Vali Loss: 1.380 Vali Acc: 0.267 Test Loss: 1.380 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 374179
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.271085739135742
Epoch: 1, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4682042598724365
Epoch: 2, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48357176780700684
Epoch: 3, Steps: 2 | Train Loss: 0.798 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5148999691009521
Epoch: 4, Steps: 2 | Train Loss: 0.620 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.43146419525146484
Epoch: 5, Steps: 2 | Train Loss: 0.582 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.49954915046691895
Epoch: 6, Steps: 2 | Train Loss: 0.482 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5338830947875977
Epoch: 7, Steps: 2 | Train Loss: 0.306 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.4911167621612549
Epoch: 8, Steps: 2 | Train Loss: 0.231 Vali Loss: 1.352 Vali Acc: 0.267 Test Loss: 1.352 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.455524206161499
Epoch: 9, Steps: 2 | Train Loss: 0.170 Vali Loss: 1.446 Vali Acc: 0.267 Test Loss: 1.446 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5051624774932861
Epoch: 10, Steps: 2 | Train Loss: 0.120 Vali Loss: 1.552 Vali Acc: 0.267 Test Loss: 1.552 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4751923084259033
Epoch: 11, Steps: 2 | Train Loss: 0.052 Vali Loss: 1.639 Vali Acc: 0.400 Test Loss: 1.639 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399984).  Saving model ...
Epoch: 12 cost time: 0.44876837730407715
Epoch: 12, Steps: 2 | Train Loss: 0.033 Vali Loss: 1.769 Vali Acc: 0.400 Test Loss: 1.769 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.45373034477233887
Epoch: 13, Steps: 2 | Train Loss: 0.011 Vali Loss: 1.964 Vali Acc: 0.333 Test Loss: 1.964 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.508852481842041
Epoch: 14, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.179 Vali Acc: 0.267 Test Loss: 2.179 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5324962139129639
Epoch: 15, Steps: 2 | Train Loss: 0.006 Vali Loss: 2.341 Vali Acc: 0.267 Test Loss: 2.341 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5188686847686768
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 2.466 Vali Acc: 0.267 Test Loss: 2.466 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.45552492141723633
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.568 Vali Acc: 0.267 Test Loss: 2.568 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.44350481033325195
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.652 Vali Acc: 0.267 Test Loss: 2.652 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4949824810028076
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.716 Vali Acc: 0.267 Test Loss: 2.716 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5012800693511963
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.768 Vali Acc: 0.333 Test Loss: 2.768 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.48931097984313965
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.811 Vali Acc: 0.333 Test Loss: 2.811 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 308643
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2578134536743164
Epoch: 1, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.46382975578308105
Epoch: 2, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.47621774673461914
Epoch: 3, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4488239288330078
Epoch: 4, Steps: 2 | Train Loss: 0.647 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4566640853881836
Epoch: 5, Steps: 2 | Train Loss: 0.610 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.525280237197876
Epoch: 6, Steps: 2 | Train Loss: 0.501 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4821360111236572
Epoch: 7, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.43604588508605957
Epoch: 8, Steps: 2 | Train Loss: 0.260 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.45598435401916504
Epoch: 9, Steps: 2 | Train Loss: 0.212 Vali Loss: 1.356 Vali Acc: 0.333 Test Loss: 1.356 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 0.4405994415283203
Epoch: 10, Steps: 2 | Train Loss: 0.181 Vali Loss: 1.429 Vali Acc: 0.333 Test Loss: 1.429 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45383763313293457
Epoch: 11, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.491 Vali Acc: 0.267 Test Loss: 1.491 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.45763611793518066
Epoch: 12, Steps: 2 | Train Loss: 0.058 Vali Loss: 1.604 Vali Acc: 0.400 Test Loss: 1.604 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399984).  Saving model ...
Epoch: 13 cost time: 0.45392441749572754
Epoch: 13, Steps: 2 | Train Loss: 0.022 Vali Loss: 1.783 Vali Acc: 0.400 Test Loss: 1.783 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4406712055206299
Epoch: 14, Steps: 2 | Train Loss: 0.018 Vali Loss: 1.968 Vali Acc: 0.400 Test Loss: 1.968 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.47710394859313965
Epoch: 15, Steps: 2 | Train Loss: 0.011 Vali Loss: 2.055 Vali Acc: 0.333 Test Loss: 2.055 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4583737850189209
Epoch: 16, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.136 Vali Acc: 0.333 Test Loss: 2.136 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.46059417724609375
Epoch: 17, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.215 Vali Acc: 0.333 Test Loss: 2.215 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.44385433197021484
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.292 Vali Acc: 0.333 Test Loss: 2.292 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.45804858207702637
Epoch: 19, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.362 Vali Acc: 0.333 Test Loss: 2.362 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.45310187339782715
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.422 Vali Acc: 0.333 Test Loss: 2.422 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.48641252517700195
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.469 Vali Acc: 0.333 Test Loss: 2.469 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4560127258300781
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.523 Vali Acc: 0.333 Test Loss: 2.523 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 308643
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.188401222229004
Epoch: 1, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4373459815979004
Epoch: 2, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4319496154785156
Epoch: 3, Steps: 2 | Train Loss: 0.834 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.45190978050231934
Epoch: 4, Steps: 2 | Train Loss: 0.706 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4404458999633789
Epoch: 5, Steps: 2 | Train Loss: 0.708 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4769306182861328
Epoch: 6, Steps: 2 | Train Loss: 0.587 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.46197056770324707
Epoch: 7, Steps: 2 | Train Loss: 0.391 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4496736526489258
Epoch: 8, Steps: 2 | Train Loss: 0.356 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5063846111297607
Epoch: 9, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.324 Vali Acc: 0.333 Test Loss: 1.324 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 0.4702630043029785
Epoch: 10, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.397 Vali Acc: 0.333 Test Loss: 1.397 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.47423434257507324
Epoch: 11, Steps: 2 | Train Loss: 0.156 Vali Loss: 1.441 Vali Acc: 0.333 Test Loss: 1.441 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.47609448432922363
Epoch: 12, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.516 Vali Acc: 0.333 Test Loss: 1.516 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5557076930999756
Epoch: 13, Steps: 2 | Train Loss: 0.059 Vali Loss: 1.649 Vali Acc: 0.267 Test Loss: 1.649 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4586670398712158
Epoch: 14, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.792 Vali Acc: 0.267 Test Loss: 1.792 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4769585132598877
Epoch: 15, Steps: 2 | Train Loss: 0.040 Vali Loss: 1.844 Vali Acc: 0.333 Test Loss: 1.844 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4783492088317871
Epoch: 16, Steps: 2 | Train Loss: 0.019 Vali Loss: 1.974 Vali Acc: 0.333 Test Loss: 1.974 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.42945051193237305
Epoch: 17, Steps: 2 | Train Loss: 0.011 Vali Loss: 2.124 Vali Acc: 0.333 Test Loss: 2.124 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.46747493743896484
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.283 Vali Acc: 0.333 Test Loss: 2.283 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.45494532585144043
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.396 Vali Acc: 0.333 Test Loss: 2.396 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 308643
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.243990182876587
Epoch: 1, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4732377529144287
Epoch: 2, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4890317916870117
Epoch: 3, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4361436367034912
Epoch: 4, Steps: 2 | Train Loss: 0.836 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4623427391052246
Epoch: 5, Steps: 2 | Train Loss: 0.893 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.46072864532470703
Epoch: 6, Steps: 2 | Train Loss: 0.776 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4657127857208252
Epoch: 7, Steps: 2 | Train Loss: 0.602 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4833855628967285
Epoch: 8, Steps: 2 | Train Loss: 0.559 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4691808223724365
Epoch: 9, Steps: 2 | Train Loss: 0.549 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.48349475860595703
Epoch: 10, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.47990894317626953
Epoch: 11, Steps: 2 | Train Loss: 0.366 Vali Loss: 1.277 Vali Acc: 0.267 Test Loss: 1.277 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 308643
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.265796422958374
Epoch: 1, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5146706104278564
Epoch: 2, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.47954869270324707
Epoch: 3, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5261142253875732
Epoch: 4, Steps: 2 | Train Loss: 0.844 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5109052658081055
Epoch: 5, Steps: 2 | Train Loss: 0.678 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5262243747711182
Epoch: 6, Steps: 2 | Train Loss: 0.448 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5552985668182373
Epoch: 7, Steps: 2 | Train Loss: 0.383 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.49192047119140625
Epoch: 8, Steps: 2 | Train Loss: 0.260 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.47270894050598145
Epoch: 9, Steps: 2 | Train Loss: 0.186 Vali Loss: 1.239 Vali Acc: 0.467 Test Loss: 1.239 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4752371311187744
Epoch: 10, Steps: 2 | Train Loss: 0.138 Vali Loss: 1.333 Vali Acc: 0.467 Test Loss: 1.333 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4747922420501709
Epoch: 11, Steps: 2 | Train Loss: 0.075 Vali Loss: 1.439 Vali Acc: 0.400 Test Loss: 1.439 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5156407356262207
Epoch: 12, Steps: 2 | Train Loss: 0.032 Vali Loss: 1.661 Vali Acc: 0.333 Test Loss: 1.661 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 275875
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3104841709136963
Epoch: 1, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.47586774826049805
Epoch: 2, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4884004592895508
Epoch: 3, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4614131450653076
Epoch: 4, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47704410552978516
Epoch: 5, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.44909238815307617
Epoch: 6, Steps: 2 | Train Loss: 0.473 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.44193220138549805
Epoch: 7, Steps: 2 | Train Loss: 0.445 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4642014503479004
Epoch: 8, Steps: 2 | Train Loss: 0.300 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.499849796295166
Epoch: 9, Steps: 2 | Train Loss: 0.252 Vali Loss: 1.226 Vali Acc: 0.467 Test Loss: 1.226 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.43350672721862793
Epoch: 10, Steps: 2 | Train Loss: 0.185 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4309711456298828
Epoch: 11, Steps: 2 | Train Loss: 0.114 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4147775173187256
Epoch: 12, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.616 Vali Acc: 0.333 Test Loss: 1.616 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 275875
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1953420639038086
Epoch: 1, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.4169270992279053
Epoch: 2, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.448256254196167
Epoch: 3, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4204888343811035
Epoch: 4, Steps: 2 | Train Loss: 0.919 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4309577941894531
Epoch: 5, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.041 Vali Acc: 0.267 Test Loss: 1.041 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.47101664543151855
Epoch: 6, Steps: 2 | Train Loss: 0.529 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.44638848304748535
Epoch: 7, Steps: 2 | Train Loss: 0.512 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4432101249694824
Epoch: 8, Steps: 2 | Train Loss: 0.392 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.440626859664917
Epoch: 9, Steps: 2 | Train Loss: 0.343 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.43166613578796387
Epoch: 10, Steps: 2 | Train Loss: 0.274 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.46530890464782715
Epoch: 11, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.322 Vali Acc: 0.267 Test Loss: 1.322 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4508025646209717
Epoch: 12, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.463 Vali Acc: 0.267 Test Loss: 1.463 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 275875
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2593235969543457
Epoch: 1, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.44335150718688965
Epoch: 2, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4536581039428711
Epoch: 3, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.42993807792663574
Epoch: 4, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.45957469940185547
Epoch: 5, Steps: 2 | Train Loss: 0.852 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4532179832458496
Epoch: 6, Steps: 2 | Train Loss: 0.667 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4868204593658447
Epoch: 7, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4313066005706787
Epoch: 8, Steps: 2 | Train Loss: 0.569 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4332571029663086
Epoch: 9, Steps: 2 | Train Loss: 0.566 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.549823522567749
Epoch: 10, Steps: 2 | Train Loss: 0.491 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.44919633865356445
Epoch: 11, Steps: 2 | Train Loss: 0.441 Vali Loss: 1.241 Vali Acc: 0.133 Test Loss: 1.241 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4865438938140869
Epoch: 12, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5340919494628906
Epoch: 13, Steps: 2 | Train Loss: 0.386 Vali Loss: 1.386 Vali Acc: 0.333 Test Loss: 1.386 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 275875
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.34572434425354
Epoch: 1, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5485355854034424
Epoch: 2, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.50284743309021
Epoch: 3, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.225 Vali Acc: 0.067 Test Loss: 1.225 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.49175477027893066
Epoch: 4, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4877204895019531
Epoch: 5, Steps: 2 | Train Loss: 0.691 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4773714542388916
Epoch: 6, Steps: 2 | Train Loss: 0.384 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5019500255584717
Epoch: 7, Steps: 2 | Train Loss: 0.306 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4874532222747803
Epoch: 8, Steps: 2 | Train Loss: 0.295 Vali Loss: 1.381 Vali Acc: 0.333 Test Loss: 1.381 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5677289962768555
Epoch: 9, Steps: 2 | Train Loss: 0.173 Vali Loss: 1.428 Vali Acc: 0.400 Test Loss: 1.428 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.5031204223632812
Epoch: 10, Steps: 2 | Train Loss: 0.117 Vali Loss: 1.515 Vali Acc: 0.400 Test Loss: 1.515 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5216710567474365
Epoch: 11, Steps: 2 | Train Loss: 0.084 Vali Loss: 1.604 Vali Acc: 0.333 Test Loss: 1.604 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.48253655433654785
Epoch: 12, Steps: 2 | Train Loss: 0.042 Vali Loss: 1.746 Vali Acc: 0.400 Test Loss: 1.746 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4796566963195801
Epoch: 13, Steps: 2 | Train Loss: 0.019 Vali Loss: 1.918 Vali Acc: 0.333 Test Loss: 1.918 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.47452473640441895
Epoch: 14, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.105 Vali Acc: 0.333 Test Loss: 2.105 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4960000514984131
Epoch: 15, Steps: 2 | Train Loss: 0.009 Vali Loss: 2.276 Vali Acc: 0.333 Test Loss: 2.276 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4913210868835449
Epoch: 16, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.395 Vali Acc: 0.333 Test Loss: 2.395 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.49340200424194336
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.492 Vali Acc: 0.333 Test Loss: 2.492 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4800708293914795
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.575 Vali Acc: 0.400 Test Loss: 2.575 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5394599437713623
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.649 Vali Acc: 0.400 Test Loss: 2.649 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 259491
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2439966201782227
Epoch: 1, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.533858060836792
Epoch: 2, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.4705181121826172
Epoch: 3, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.483135461807251
Epoch: 4, Steps: 2 | Train Loss: 0.835 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.49365687370300293
Epoch: 5, Steps: 2 | Train Loss: 0.703 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.48286914825439453
Epoch: 6, Steps: 2 | Train Loss: 0.404 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5086207389831543
Epoch: 7, Steps: 2 | Train Loss: 0.324 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.4671194553375244
Epoch: 8, Steps: 2 | Train Loss: 0.327 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.48011302947998047
Epoch: 9, Steps: 2 | Train Loss: 0.200 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.43488073348999023
Epoch: 10, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4393656253814697
Epoch: 11, Steps: 2 | Train Loss: 0.112 Vali Loss: 1.431 Vali Acc: 0.400 Test Loss: 1.431 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.43786096572875977
Epoch: 12, Steps: 2 | Train Loss: 0.069 Vali Loss: 1.554 Vali Acc: 0.467 Test Loss: 1.554 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466651).  Saving model ...
Epoch: 13 cost time: 0.474520206451416
Epoch: 13, Steps: 2 | Train Loss: 0.035 Vali Loss: 1.694 Vali Acc: 0.400 Test Loss: 1.694 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4337918758392334
Epoch: 14, Steps: 2 | Train Loss: 0.019 Vali Loss: 1.858 Vali Acc: 0.400 Test Loss: 1.858 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.45909810066223145
Epoch: 15, Steps: 2 | Train Loss: 0.016 Vali Loss: 2.025 Vali Acc: 0.333 Test Loss: 2.025 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.45779967308044434
Epoch: 16, Steps: 2 | Train Loss: 0.008 Vali Loss: 2.128 Vali Acc: 0.400 Test Loss: 2.128 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.49704790115356445
Epoch: 17, Steps: 2 | Train Loss: 0.005 Vali Loss: 2.211 Vali Acc: 0.400 Test Loss: 2.211 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4608588218688965
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.278 Vali Acc: 0.400 Test Loss: 2.278 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.46510863304138184
Epoch: 19, Steps: 2 | Train Loss: 0.002 Vali Loss: 2.354 Vali Acc: 0.333 Test Loss: 2.354 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.47576284408569336
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.430 Vali Acc: 0.333 Test Loss: 2.430 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.479229211807251
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.496 Vali Acc: 0.333 Test Loss: 2.496 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4543442726135254
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 2.557 Vali Acc: 0.267 Test Loss: 2.557 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 259491
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2733211517333984
Epoch: 1, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4754471778869629
Epoch: 2, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4804539680480957
Epoch: 3, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4340245723724365
Epoch: 4, Steps: 2 | Train Loss: 0.854 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.433513879776001
Epoch: 5, Steps: 2 | Train Loss: 0.827 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4379549026489258
Epoch: 6, Steps: 2 | Train Loss: 0.467 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4198441505432129
Epoch: 7, Steps: 2 | Train Loss: 0.399 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.42210984230041504
Epoch: 8, Steps: 2 | Train Loss: 0.390 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4485146999359131
Epoch: 9, Steps: 2 | Train Loss: 0.278 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4447779655456543
Epoch: 10, Steps: 2 | Train Loss: 0.242 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4356076717376709
Epoch: 11, Steps: 2 | Train Loss: 0.215 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.46538686752319336
Epoch: 12, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.412 Vali Acc: 0.267 Test Loss: 1.412 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.45866990089416504
Epoch: 13, Steps: 2 | Train Loss: 0.089 Vali Loss: 1.524 Vali Acc: 0.267 Test Loss: 1.524 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.45903635025024414
Epoch: 14, Steps: 2 | Train Loss: 0.059 Vali Loss: 1.636 Vali Acc: 0.200 Test Loss: 1.636 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 259491
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2432265281677246
Epoch: 1, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4671299457550049
Epoch: 2, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5383927822113037
Epoch: 3, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5264537334442139
Epoch: 4, Steps: 2 | Train Loss: 0.924 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4334440231323242
Epoch: 5, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4576401710510254
Epoch: 6, Steps: 2 | Train Loss: 0.649 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.46785736083984375
Epoch: 7, Steps: 2 | Train Loss: 0.551 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.45156264305114746
Epoch: 8, Steps: 2 | Train Loss: 0.546 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4615440368652344
Epoch: 9, Steps: 2 | Train Loss: 0.493 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4571261405944824
Epoch: 10, Steps: 2 | Train Loss: 0.475 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4679136276245117
Epoch: 11, Steps: 2 | Train Loss: 0.448 Vali Loss: 1.330 Vali Acc: 0.333 Test Loss: 1.330 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 259491
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.287142515182495
Epoch: 1, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.46045613288879395
Epoch: 2, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46239447593688965
Epoch: 3, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47962141036987305
Epoch: 4, Steps: 2 | Train Loss: 0.777 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48139190673828125
Epoch: 5, Steps: 2 | Train Loss: 0.589 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.483964204788208
Epoch: 6, Steps: 2 | Train Loss: 0.471 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5080552101135254
Epoch: 7, Steps: 2 | Train Loss: 0.299 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5575876235961914
Epoch: 8, Steps: 2 | Train Loss: 0.222 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4811112880706787
Epoch: 9, Steps: 2 | Train Loss: 0.166 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4871792793273926
Epoch: 10, Steps: 2 | Train Loss: 0.089 Vali Loss: 1.445 Vali Acc: 0.400 Test Loss: 1.445 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5102627277374268
Epoch: 11, Steps: 2 | Train Loss: 0.054 Vali Loss: 1.563 Vali Acc: 0.400 Test Loss: 1.563 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 251299
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.232609272003174
Epoch: 1, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5035266876220703
Epoch: 2, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.5412161350250244
Epoch: 3, Steps: 2 | Train Loss: 0.883 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5289273262023926
Epoch: 4, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5303258895874023
Epoch: 5, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.48547816276550293
Epoch: 6, Steps: 2 | Train Loss: 0.485 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4950542449951172
Epoch: 7, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5165717601776123
Epoch: 8, Steps: 2 | Train Loss: 0.250 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.519813060760498
Epoch: 9, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5151584148406982
Epoch: 10, Steps: 2 | Train Loss: 0.115 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5127692222595215
Epoch: 11, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.478 Vali Acc: 0.333 Test Loss: 1.478 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.56105637550354
Epoch: 12, Steps: 2 | Train Loss: 0.047 Vali Loss: 1.543 Vali Acc: 0.400 Test Loss: 1.543 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 251299
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1880710124969482
Epoch: 1, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5723838806152344
Epoch: 2, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.4161369800567627
Epoch: 3, Steps: 2 | Train Loss: 0.866 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.45489025115966797
Epoch: 4, Steps: 2 | Train Loss: 0.820 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4078664779663086
Epoch: 5, Steps: 2 | Train Loss: 0.664 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.44829583168029785
Epoch: 6, Steps: 2 | Train Loss: 0.539 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4699897766113281
Epoch: 7, Steps: 2 | Train Loss: 0.399 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.48869967460632324
Epoch: 8, Steps: 2 | Train Loss: 0.301 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4730992317199707
Epoch: 9, Steps: 2 | Train Loss: 0.301 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.45656633377075195
Epoch: 10, Steps: 2 | Train Loss: 0.162 Vali Loss: 1.375 Vali Acc: 0.333 Test Loss: 1.375 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4519500732421875
Epoch: 11, Steps: 2 | Train Loss: 0.137 Vali Loss: 1.451 Vali Acc: 0.267 Test Loss: 1.451 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4410264492034912
Epoch: 12, Steps: 2 | Train Loss: 0.087 Vali Loss: 1.545 Vali Acc: 0.267 Test Loss: 1.545 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 251299
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1774935722351074
Epoch: 1, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.43974804878234863
Epoch: 2, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4054546356201172
Epoch: 3, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4209170341491699
Epoch: 4, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.41001200675964355
Epoch: 5, Steps: 2 | Train Loss: 0.835 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.41822004318237305
Epoch: 6, Steps: 2 | Train Loss: 0.724 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4997696876525879
Epoch: 7, Steps: 2 | Train Loss: 0.615 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4226558208465576
Epoch: 8, Steps: 2 | Train Loss: 0.514 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.457791805267334
Epoch: 9, Steps: 2 | Train Loss: 0.539 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4888434410095215
Epoch: 10, Steps: 2 | Train Loss: 0.375 Vali Loss: 1.253 Vali Acc: 0.200 Test Loss: 1.253 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4610474109649658
Epoch: 11, Steps: 2 | Train Loss: 0.319 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4308967590332031
Epoch: 12, Steps: 2 | Train Loss: 0.270 Vali Loss: 1.340 Vali Acc: 0.267 Test Loss: 1.340 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 251299
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.202198028564453
Epoch: 1, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4697089195251465
Epoch: 2, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.47435712814331055
Epoch: 3, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4626457691192627
Epoch: 4, Steps: 2 | Train Loss: 0.731 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47991418838500977
Epoch: 5, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.43660402297973633
Epoch: 6, Steps: 2 | Train Loss: 0.499 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.4754221439361572
Epoch: 7, Steps: 2 | Train Loss: 0.372 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4752054214477539
Epoch: 8, Steps: 2 | Train Loss: 0.347 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.45198845863342285
Epoch: 9, Steps: 2 | Train Loss: 0.199 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.48834872245788574
Epoch: 10, Steps: 2 | Train Loss: 0.094 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4461178779602051
Epoch: 11, Steps: 2 | Train Loss: 0.080 Vali Loss: 1.402 Vali Acc: 0.533 Test Loss: 1.402 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.41887736320495605
Epoch: 12, Steps: 2 | Train Loss: 0.044 Vali Loss: 1.511 Vali Acc: 0.400 Test Loss: 1.511 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.47977614402770996
Epoch: 13, Steps: 2 | Train Loss: 0.020 Vali Loss: 1.673 Vali Acc: 0.333 Test Loss: 1.673 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4518570899963379
Epoch: 14, Steps: 2 | Train Loss: 0.012 Vali Loss: 1.880 Vali Acc: 0.267 Test Loss: 1.880 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4748191833496094
Epoch: 15, Steps: 2 | Train Loss: 0.010 Vali Loss: 2.041 Vali Acc: 0.267 Test Loss: 2.041 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.45057201385498047
Epoch: 16, Steps: 2 | Train Loss: 0.004 Vali Loss: 2.154 Vali Acc: 0.267 Test Loss: 2.154 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 247203
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.211794137954712
Epoch: 1, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.5173265933990479
Epoch: 2, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5438055992126465
Epoch: 3, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5163586139678955
Epoch: 4, Steps: 2 | Train Loss: 0.804 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49524545669555664
Epoch: 5, Steps: 2 | Train Loss: 0.641 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5570571422576904
Epoch: 6, Steps: 2 | Train Loss: 0.538 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5152254104614258
Epoch: 7, Steps: 2 | Train Loss: 0.423 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5917446613311768
Epoch: 8, Steps: 2 | Train Loss: 0.411 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4940304756164551
Epoch: 9, Steps: 2 | Train Loss: 0.260 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5250289440155029
Epoch: 10, Steps: 2 | Train Loss: 0.130 Vali Loss: 1.227 Vali Acc: 0.467 Test Loss: 1.227 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5330953598022461
Epoch: 11, Steps: 2 | Train Loss: 0.124 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 247203
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.270249366760254
Epoch: 1, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5318138599395752
Epoch: 2, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47064638137817383
Epoch: 3, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5177099704742432
Epoch: 4, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4513418674468994
Epoch: 5, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4763178825378418
Epoch: 6, Steps: 2 | Train Loss: 0.602 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.46840381622314453
Epoch: 7, Steps: 2 | Train Loss: 0.502 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5356299877166748
Epoch: 8, Steps: 2 | Train Loss: 0.469 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.49433207511901855
Epoch: 9, Steps: 2 | Train Loss: 0.339 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.49117183685302734
Epoch: 10, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.46666932106018066
Epoch: 11, Steps: 2 | Train Loss: 0.205 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 247203
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.236729621887207
Epoch: 1, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.48697805404663086
Epoch: 2, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5384664535522461
Epoch: 3, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5537950992584229
Epoch: 4, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4990804195404053
Epoch: 5, Steps: 2 | Train Loss: 0.848 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5391387939453125
Epoch: 6, Steps: 2 | Train Loss: 0.753 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5095641613006592
Epoch: 7, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4816715717315674
Epoch: 8, Steps: 2 | Train Loss: 0.627 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5029616355895996
Epoch: 9, Steps: 2 | Train Loss: 0.537 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4650685787200928
Epoch: 10, Steps: 2 | Train Loss: 0.385 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.46354031562805176
Epoch: 11, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5104115009307861
Epoch: 12, Steps: 2 | Train Loss: 0.379 Vali Loss: 1.314 Vali Acc: 0.200 Test Loss: 1.314 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_ETSformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 247203
model size : 1.56MB
