Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8741164207458496
Epoch: 1, Steps: 8 | Train Loss: 1.739 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
Validation loss decreased (inf --> -0.799993).  Saving model ...
Epoch: 2 cost time: 2.0724756717681885
Epoch: 2, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.807 Vali Acc: 0.809 Test Loss: 0.807 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809367).  Saving model ...
Epoch: 3 cost time: 2.2184555530548096
Epoch: 3, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.948 Vali Acc: 0.853 Test Loss: 0.948 Test Acc: 0.853
Validation loss decreased (-0.809367 --> -0.853116).  Saving model ...
Epoch: 4 cost time: 2.060469150543213
Epoch: 4, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.216 Vali Acc: 0.838 Test Loss: 1.216 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1417741775512695
Epoch: 5, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.263 Vali Acc: 0.831 Test Loss: 1.263 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8626766204833984
Epoch: 6, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.259 Vali Acc: 0.841 Test Loss: 1.259 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.965033769607544
Epoch: 7, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.783 Vali Acc: 0.822 Test Loss: 1.783 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.968397855758667
Epoch: 8, Steps: 8 | Train Loss: 0.100 Vali Loss: 2.310 Vali Acc: 0.816 Test Loss: 2.310 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.950275182723999
Epoch: 9, Steps: 8 | Train Loss: 0.049 Vali Loss: 2.353 Vali Acc: 0.819 Test Loss: 2.353 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.090864658355713
Epoch: 10, Steps: 8 | Train Loss: 0.069 Vali Loss: 2.044 Vali Acc: 0.816 Test Loss: 2.044 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1803081035614014
Epoch: 11, Steps: 8 | Train Loss: 0.178 Vali Loss: 2.193 Vali Acc: 0.816 Test Loss: 2.193 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3062496185302734
Epoch: 12, Steps: 8 | Train Loss: 0.229 Vali Loss: 3.009 Vali Acc: 0.759 Test Loss: 3.009 Test Acc: 0.759
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5170280933380127
Epoch: 13, Steps: 8 | Train Loss: 0.179 Vali Loss: 3.003 Vali Acc: 0.809 Test Loss: 3.003 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 6554176
model size : 34.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.772666931152344
Epoch: 1, Steps: 8 | Train Loss: 1.727 Vali Loss: 0.670 Vali Acc: 0.791 Test Loss: 0.670 Test Acc: 0.791
Validation loss decreased (inf --> -0.790618).  Saving model ...
Epoch: 2 cost time: 2.5546913146972656
Epoch: 2, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.791 Vali Acc: 0.812 Test Loss: 0.791 Test Acc: 0.812
Validation loss decreased (-0.790618 --> -0.812492).  Saving model ...
Epoch: 3 cost time: 2.1125423908233643
Epoch: 3, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.967 Vali Acc: 0.844 Test Loss: 0.967 Test Acc: 0.844
Validation loss decreased (-0.812492 --> -0.843740).  Saving model ...
Epoch: 4 cost time: 2.8319334983825684
Epoch: 4, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.222 Vali Acc: 0.819 Test Loss: 1.222 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5531198978424072
Epoch: 5, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.262 Vali Acc: 0.844 Test Loss: 1.262 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7737181186676025
Epoch: 6, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.671 Vali Acc: 0.809 Test Loss: 1.671 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4864211082458496
Epoch: 7, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.008 Vali Acc: 0.816 Test Loss: 2.008 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5624513626098633
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.398 Vali Acc: 0.797 Test Loss: 2.398 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.79671049118042
Epoch: 9, Steps: 8 | Train Loss: 0.105 Vali Loss: 2.601 Vali Acc: 0.825 Test Loss: 2.601 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4277830123901367
Epoch: 10, Steps: 8 | Train Loss: 0.252 Vali Loss: 2.658 Vali Acc: 0.816 Test Loss: 2.658 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6514220237731934
Epoch: 11, Steps: 8 | Train Loss: 0.085 Vali Loss: 2.752 Vali Acc: 0.822 Test Loss: 2.752 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2093491554260254
Epoch: 12, Steps: 8 | Train Loss: 0.102 Vali Loss: 3.427 Vali Acc: 0.797 Test Loss: 3.427 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.758784294128418
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 4.491 Vali Acc: 0.781 Test Loss: 4.491 Test Acc: 0.781
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 6554176
model size : 34.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.822675943374634
Epoch: 1, Steps: 8 | Train Loss: 1.710 Vali Loss: 0.653 Vali Acc: 0.791 Test Loss: 0.653 Test Acc: 0.791
Validation loss decreased (inf --> -0.790618).  Saving model ...
Epoch: 2 cost time: 2.364405632019043
Epoch: 2, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.757 Vali Acc: 0.809 Test Loss: 0.757 Test Acc: 0.809
Validation loss decreased (-0.790618 --> -0.809367).  Saving model ...
Epoch: 3 cost time: 2.6392874717712402
Epoch: 3, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.939 Vali Acc: 0.859 Test Loss: 0.939 Test Acc: 0.859
Validation loss decreased (-0.809367 --> -0.859366).  Saving model ...
Epoch: 4 cost time: 2.492781639099121
Epoch: 4, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.117 Vali Acc: 0.859 Test Loss: 1.117 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.661328077316284
Epoch: 5, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.254 Vali Acc: 0.853 Test Loss: 1.254 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1015260219573975
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.327 Vali Acc: 0.844 Test Loss: 1.327 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.59938645362854
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.680 Vali Acc: 0.831 Test Loss: 1.680 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.972672939300537
Epoch: 8, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.737 Vali Acc: 0.850 Test Loss: 1.737 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.076223134994507
Epoch: 9, Steps: 8 | Train Loss: 0.093 Vali Loss: 2.525 Vali Acc: 0.809 Test Loss: 2.525 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.798095464706421
Epoch: 10, Steps: 8 | Train Loss: 0.195 Vali Loss: 2.921 Vali Acc: 0.822 Test Loss: 2.921 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.8914008140563965
Epoch: 11, Steps: 8 | Train Loss: 0.170 Vali Loss: 2.604 Vali Acc: 0.812 Test Loss: 2.604 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7970755100250244
Epoch: 12, Steps: 8 | Train Loss: 0.064 Vali Loss: 2.665 Vali Acc: 0.828 Test Loss: 2.665 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.308483362197876
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 4.790 Vali Acc: 0.713 Test Loss: 4.790 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 6554176
model size : 34.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.6615283489227295
Epoch: 1, Steps: 8 | Train Loss: 1.717 Vali Loss: 0.657 Vali Acc: 0.806 Test Loss: 0.657 Test Acc: 0.806
Validation loss decreased (inf --> -0.806243).  Saving model ...
Epoch: 2 cost time: 2.0063116550445557
Epoch: 2, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.631 Vali Acc: 0.853 Test Loss: 0.631 Test Acc: 0.853
Validation loss decreased (-0.806243 --> -0.853119).  Saving model ...
Epoch: 3 cost time: 2.364927291870117
Epoch: 3, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.965 Vali Acc: 0.850 Test Loss: 0.965 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3560335636138916
Epoch: 4, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.232 Vali Acc: 0.838 Test Loss: 1.232 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.521623134613037
Epoch: 5, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.131 Vali Acc: 0.847 Test Loss: 1.131 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3109068870544434
Epoch: 6, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.548 Vali Acc: 0.838 Test Loss: 1.548 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.634504795074463
Epoch: 7, Steps: 8 | Train Loss: 0.157 Vali Loss: 2.090 Vali Acc: 0.800 Test Loss: 2.090 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.449201822280884
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.797 Vali Acc: 0.812 Test Loss: 1.797 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4794604778289795
Epoch: 9, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.720 Vali Acc: 0.853 Test Loss: 1.720 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.572341203689575
Epoch: 10, Steps: 8 | Train Loss: 0.031 Vali Loss: 2.030 Vali Acc: 0.856 Test Loss: 2.030 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856230).  Saving model ...
Epoch: 11 cost time: 2.2585201263427734
Epoch: 11, Steps: 8 | Train Loss: 0.044 Vali Loss: 2.149 Vali Acc: 0.838 Test Loss: 2.149 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.518759250640869
Epoch: 12, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.957 Vali Acc: 0.844 Test Loss: 1.957 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.277743101119995
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.113 Vali Acc: 0.831 Test Loss: 2.113 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.823835849761963
Epoch: 14, Steps: 8 | Train Loss: 0.089 Vali Loss: 2.691 Vali Acc: 0.844 Test Loss: 2.691 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6347343921661377
Epoch: 15, Steps: 8 | Train Loss: 0.368 Vali Loss: 2.959 Vali Acc: 0.831 Test Loss: 2.959 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.306542158126831
Epoch: 16, Steps: 8 | Train Loss: 0.493 Vali Loss: 3.105 Vali Acc: 0.825 Test Loss: 3.105 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.473245620727539
Epoch: 17, Steps: 8 | Train Loss: 0.254 Vali Loss: 3.323 Vali Acc: 0.838 Test Loss: 3.323 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.356043577194214
Epoch: 18, Steps: 8 | Train Loss: 0.338 Vali Loss: 3.064 Vali Acc: 0.847 Test Loss: 3.064 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.688331127166748
Epoch: 19, Steps: 8 | Train Loss: 0.068 Vali Loss: 3.079 Vali Acc: 0.853 Test Loss: 3.079 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5504820346832275
Epoch: 20, Steps: 8 | Train Loss: 0.244 Vali Loss: 3.062 Vali Acc: 0.866 Test Loss: 3.062 Test Acc: 0.866
Validation loss decreased (-0.856230 --> -0.865594).  Saving model ...
Epoch: 21 cost time: 2.684291124343872
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 5.335 Vali Acc: 0.819 Test Loss: 5.335 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9640083312988281
Epoch: 22, Steps: 8 | Train Loss: 0.608 Vali Loss: 4.452 Vali Acc: 0.806 Test Loss: 4.452 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5093231201171875
Epoch: 23, Steps: 8 | Train Loss: 0.192 Vali Loss: 5.194 Vali Acc: 0.834 Test Loss: 5.194 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.594456911087036
Epoch: 24, Steps: 8 | Train Loss: 0.134 Vali Loss: 4.958 Vali Acc: 0.856 Test Loss: 4.958 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.62663197517395
Epoch: 25, Steps: 8 | Train Loss: 0.294 Vali Loss: 5.026 Vali Acc: 0.859 Test Loss: 5.026 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.7018039226531982
Epoch: 26, Steps: 8 | Train Loss: 0.071 Vali Loss: 4.825 Vali Acc: 0.850 Test Loss: 4.825 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.4028732776641846
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 5.463 Vali Acc: 0.841 Test Loss: 5.463 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.0302445888519287
Epoch: 28, Steps: 8 | Train Loss: 0.023 Vali Loss: 6.046 Vali Acc: 0.834 Test Loss: 6.046 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.341933250427246
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 7.022 Vali Acc: 0.834 Test Loss: 7.022 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.502537727355957
Epoch: 30, Steps: 8 | Train Loss: 0.015 Vali Loss: 6.657 Vali Acc: 0.831 Test Loss: 6.657 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 6554176
model size : 34.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.8406267166137695
Epoch: 1, Steps: 8 | Train Loss: 1.772 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
Validation loss decreased (inf --> -0.803118).  Saving model ...
Epoch: 2 cost time: 2.54536771774292
Epoch: 2, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.689 Vali Acc: 0.828 Test Loss: 0.689 Test Acc: 0.828
Validation loss decreased (-0.803118 --> -0.828118).  Saving model ...
Epoch: 3 cost time: 2.654019594192505
Epoch: 3, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.178 Vali Acc: 0.806 Test Loss: 1.178 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5565006732940674
Epoch: 4, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.164 Vali Acc: 0.838 Test Loss: 1.164 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837488).  Saving model ...
Epoch: 5 cost time: 2.547358512878418
Epoch: 5, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.476 Vali Acc: 0.847 Test Loss: 1.476 Test Acc: 0.847
Validation loss decreased (-0.837488 --> -0.846860).  Saving model ...
Epoch: 6 cost time: 2.647430658340454
Epoch: 6, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.943 Vali Acc: 0.828 Test Loss: 1.943 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2679314613342285
Epoch: 7, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.897 Vali Acc: 0.800 Test Loss: 1.897 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7412705421447754
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.374 Vali Acc: 0.781 Test Loss: 2.374 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.517714262008667
Epoch: 9, Steps: 8 | Train Loss: 0.076 Vali Loss: 2.099 Vali Acc: 0.800 Test Loss: 2.099 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7745399475097656
Epoch: 10, Steps: 8 | Train Loss: 0.119 Vali Loss: 2.379 Vali Acc: 0.816 Test Loss: 2.379 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5492875576019287
Epoch: 11, Steps: 8 | Train Loss: 0.109 Vali Loss: 2.620 Vali Acc: 0.800 Test Loss: 2.620 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.819016695022583
Epoch: 12, Steps: 8 | Train Loss: 0.153 Vali Loss: 4.133 Vali Acc: 0.769 Test Loss: 4.133 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4785282611846924
Epoch: 13, Steps: 8 | Train Loss: 0.132 Vali Loss: 4.120 Vali Acc: 0.772 Test Loss: 4.120 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.387826442718506
Epoch: 14, Steps: 8 | Train Loss: 0.201 Vali Loss: 4.645 Vali Acc: 0.753 Test Loss: 4.645 Test Acc: 0.753
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2153985500335693
Epoch: 15, Steps: 8 | Train Loss: 0.450 Vali Loss: 3.791 Vali Acc: 0.806 Test Loss: 3.791 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 4457024
model size : 26.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.525085210800171
Epoch: 1, Steps: 8 | Train Loss: 1.746 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
Validation loss decreased (inf --> -0.803118).  Saving model ...
Epoch: 2 cost time: 2.528172254562378
Epoch: 2, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.670 Vali Acc: 0.834 Test Loss: 0.670 Test Acc: 0.834
Validation loss decreased (-0.803118 --> -0.834368).  Saving model ...
Epoch: 3 cost time: 2.355731964111328
Epoch: 3, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.132 Vali Acc: 0.806 Test Loss: 1.132 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5466763973236084
Epoch: 4, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.394 Vali Acc: 0.831 Test Loss: 1.394 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.248403549194336
Epoch: 5, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.595 Vali Acc: 0.844 Test Loss: 1.595 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843734).  Saving model ...
Epoch: 6 cost time: 2.690584421157837
Epoch: 6, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.919 Vali Acc: 0.812 Test Loss: 1.919 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8038132190704346
Epoch: 7, Steps: 8 | Train Loss: 0.453 Vali Loss: 1.845 Vali Acc: 0.816 Test Loss: 1.845 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0511701107025146
Epoch: 8, Steps: 8 | Train Loss: 0.155 Vali Loss: 2.654 Vali Acc: 0.784 Test Loss: 2.654 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6154062747955322
Epoch: 9, Steps: 8 | Train Loss: 0.082 Vali Loss: 2.394 Vali Acc: 0.797 Test Loss: 2.394 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5945370197296143
Epoch: 10, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.976 Vali Acc: 0.831 Test Loss: 1.976 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.588247537612915
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.196 Vali Acc: 0.819 Test Loss: 2.196 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0500786304473877
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 2.513 Vali Acc: 0.828 Test Loss: 2.513 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.519063949584961
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 2.964 Vali Acc: 0.787 Test Loss: 2.964 Test Acc: 0.787
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.426032304763794
Epoch: 14, Steps: 8 | Train Loss: 0.190 Vali Loss: 3.282 Vali Acc: 0.841 Test Loss: 3.282 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.813772439956665
Epoch: 15, Steps: 8 | Train Loss: 0.177 Vali Loss: 3.702 Vali Acc: 0.828 Test Loss: 3.702 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 4457024
model size : 26.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.8379504680633545
Epoch: 1, Steps: 8 | Train Loss: 1.730 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
Validation loss decreased (inf --> -0.809369).  Saving model ...
Epoch: 2 cost time: 2.05015230178833
Epoch: 2, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 3 cost time: 2.313992500305176
Epoch: 3, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.022 Vali Acc: 0.834 Test Loss: 1.022 Test Acc: 0.834
Validation loss decreased (-0.815619 --> -0.834365).  Saving model ...
Epoch: 4 cost time: 2.278520345687866
Epoch: 4, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.304 Vali Acc: 0.825 Test Loss: 1.304 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9429633617401123
Epoch: 5, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.386 Vali Acc: 0.853 Test Loss: 1.386 Test Acc: 0.853
Validation loss decreased (-0.834365 --> -0.853111).  Saving model ...
Epoch: 6 cost time: 2.4858391284942627
Epoch: 6, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.466 Vali Acc: 0.850 Test Loss: 1.466 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3237032890319824
Epoch: 7, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.761 Vali Acc: 0.847 Test Loss: 1.761 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.286193370819092
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.465 Vali Acc: 0.806 Test Loss: 2.465 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1013853549957275
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.279 Vali Acc: 0.806 Test Loss: 2.279 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1453442573547363
Epoch: 10, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.666 Vali Acc: 0.828 Test Loss: 2.666 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3519787788391113
Epoch: 11, Steps: 8 | Train Loss: 0.148 Vali Loss: 2.744 Vali Acc: 0.828 Test Loss: 2.744 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9065234661102295
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 3.816 Vali Acc: 0.806 Test Loss: 3.816 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2490975856781006
Epoch: 13, Steps: 8 | Train Loss: 0.211 Vali Loss: 3.157 Vali Acc: 0.809 Test Loss: 3.157 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2768328189849854
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 3.337 Vali Acc: 0.806 Test Loss: 3.337 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2840566635131836
Epoch: 15, Steps: 8 | Train Loss: 0.069 Vali Loss: 4.625 Vali Acc: 0.794 Test Loss: 4.625 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 4457024
model size : 26.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.438579082489014
Epoch: 1, Steps: 8 | Train Loss: 1.734 Vali Loss: 0.650 Vali Acc: 0.819 Test Loss: 0.650 Test Acc: 0.819
Validation loss decreased (inf --> -0.818743).  Saving model ...
Epoch: 2 cost time: 2.4581215381622314
Epoch: 2, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.561 Vali Acc: 0.863 Test Loss: 0.561 Test Acc: 0.863
Validation loss decreased (-0.818743 --> -0.862494).  Saving model ...
Epoch: 3 cost time: 1.8609392642974854
Epoch: 3, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.960 Vali Acc: 0.859 Test Loss: 0.960 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.292116403579712
Epoch: 4, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.086 Vali Acc: 0.825 Test Loss: 1.086 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.598069190979004
Epoch: 5, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.285 Vali Acc: 0.822 Test Loss: 1.285 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7338743209838867
Epoch: 6, Steps: 8 | Train Loss: 0.066 Vali Loss: 2.155 Vali Acc: 0.787 Test Loss: 2.155 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2591543197631836
Epoch: 7, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.803 Vali Acc: 0.834 Test Loss: 1.803 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1932170391082764
Epoch: 8, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.520 Vali Acc: 0.881 Test Loss: 1.520 Test Acc: 0.881
Validation loss decreased (-0.862494 --> -0.881235).  Saving model ...
Epoch: 9 cost time: 2.392908811569214
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.646 Vali Acc: 0.881 Test Loss: 1.646 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.331763744354248
Epoch: 10, Steps: 8 | Train Loss: 0.023 Vali Loss: 2.266 Vali Acc: 0.850 Test Loss: 2.266 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4402658939361572
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.884 Vali Acc: 0.853 Test Loss: 1.884 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2506957054138184
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.308 Vali Acc: 0.856 Test Loss: 2.308 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1601486206054688
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 3.384 Vali Acc: 0.841 Test Loss: 3.384 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.059629440307617
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 3.110 Vali Acc: 0.856 Test Loss: 3.110 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.448235034942627
Epoch: 15, Steps: 8 | Train Loss: 0.045 Vali Loss: 3.436 Vali Acc: 0.831 Test Loss: 3.436 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5505857467651367
Epoch: 16, Steps: 8 | Train Loss: 0.133 Vali Loss: 3.545 Vali Acc: 0.803 Test Loss: 3.545 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.220646858215332
Epoch: 17, Steps: 8 | Train Loss: 0.150 Vali Loss: 5.130 Vali Acc: 0.787 Test Loss: 5.130 Test Acc: 0.787
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2595527172088623
Epoch: 18, Steps: 8 | Train Loss: 0.111 Vali Loss: 4.833 Vali Acc: 0.775 Test Loss: 4.833 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 4457024
model size : 26.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.938681125640869
Epoch: 1, Steps: 8 | Train Loss: 1.681 Vali Loss: 0.656 Vali Acc: 0.784 Test Loss: 0.656 Test Acc: 0.784
Validation loss decreased (inf --> -0.784368).  Saving model ...
Epoch: 2 cost time: 2.7532968521118164
Epoch: 2, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.687 Vali Acc: 0.850 Test Loss: 0.687 Test Acc: 0.850
Validation loss decreased (-0.784368 --> -0.849993).  Saving model ...
Epoch: 3 cost time: 2.3286101818084717
Epoch: 3, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.235 Vali Acc: 0.803 Test Loss: 1.235 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5877881050109863
Epoch: 4, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.439 Vali Acc: 0.772 Test Loss: 1.439 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0988447666168213
Epoch: 5, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.699 Vali Acc: 0.803 Test Loss: 1.699 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6673178672790527
Epoch: 6, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.974 Vali Acc: 0.809 Test Loss: 1.974 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.452134847640991
Epoch: 7, Steps: 8 | Train Loss: 0.032 Vali Loss: 2.146 Vali Acc: 0.797 Test Loss: 2.146 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.602437734603882
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.639 Vali Acc: 0.803 Test Loss: 2.639 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6718194484710693
Epoch: 9, Steps: 8 | Train Loss: 0.056 Vali Loss: 2.227 Vali Acc: 0.822 Test Loss: 2.227 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5015904903411865
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 3.007 Vali Acc: 0.781 Test Loss: 3.007 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.672985792160034
Epoch: 11, Steps: 8 | Train Loss: 0.233 Vali Loss: 3.460 Vali Acc: 0.772 Test Loss: 3.460 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5644145011901855
Epoch: 12, Steps: 8 | Train Loss: 0.077 Vali Loss: 2.157 Vali Acc: 0.812 Test Loss: 2.157 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 3408448
model size : 22.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.458186864852905
Epoch: 1, Steps: 8 | Train Loss: 1.675 Vali Loss: 0.650 Vali Acc: 0.787 Test Loss: 0.650 Test Acc: 0.787
Validation loss decreased (inf --> -0.787493).  Saving model ...
Epoch: 2 cost time: 2.3067398071289062
Epoch: 2, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
Validation loss decreased (-0.787493 --> -0.849993).  Saving model ...
Epoch: 3 cost time: 2.282470703125
Epoch: 3, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.227 Vali Acc: 0.809 Test Loss: 1.227 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3007748126983643
Epoch: 4, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.396 Vali Acc: 0.781 Test Loss: 1.396 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3602237701416016
Epoch: 5, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.677 Vali Acc: 0.803 Test Loss: 1.677 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.114652395248413
Epoch: 6, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.836 Vali Acc: 0.816 Test Loss: 1.836 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.248819589614868
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.843 Vali Acc: 0.822 Test Loss: 1.843 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9628827571868896
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.825 Test Loss: 1.983 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6650841236114502
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.436 Vali Acc: 0.806 Test Loss: 2.436 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.659912109375
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.435 Vali Acc: 0.803 Test Loss: 2.435 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.974968671798706
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.509 Vali Acc: 0.806 Test Loss: 2.509 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8626952171325684
Epoch: 12, Steps: 8 | Train Loss: 0.335 Vali Loss: 3.204 Vali Acc: 0.778 Test Loss: 3.204 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 3408448
model size : 22.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.522639274597168
Epoch: 1, Steps: 8 | Train Loss: 1.677 Vali Loss: 0.655 Vali Acc: 0.778 Test Loss: 0.655 Test Acc: 0.778
Validation loss decreased (inf --> -0.778118).  Saving model ...
Epoch: 2 cost time: 2.3859200477600098
Epoch: 2, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.680 Vali Acc: 0.844 Test Loss: 0.680 Test Acc: 0.844
Validation loss decreased (-0.778118 --> -0.843743).  Saving model ...
Epoch: 3 cost time: 2.3138034343719482
Epoch: 3, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.210 Vali Acc: 0.816 Test Loss: 1.210 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.495971202850342
Epoch: 4, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.180 Vali Acc: 0.831 Test Loss: 1.180 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3499598503112793
Epoch: 5, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.631 Vali Acc: 0.800 Test Loss: 1.631 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.467097520828247
Epoch: 6, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.031 Vali Acc: 0.812 Test Loss: 2.031 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.16850209236145
Epoch: 7, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.988 Vali Acc: 0.816 Test Loss: 1.988 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.209240198135376
Epoch: 8, Steps: 8 | Train Loss: 0.127 Vali Loss: 2.151 Vali Acc: 0.844 Test Loss: 2.151 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.353522777557373
Epoch: 9, Steps: 8 | Train Loss: 0.046 Vali Loss: 2.243 Vali Acc: 0.822 Test Loss: 2.243 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5022757053375244
Epoch: 10, Steps: 8 | Train Loss: 0.150 Vali Loss: 2.696 Vali Acc: 0.828 Test Loss: 2.696 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5005619525909424
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.533 Vali Acc: 0.787 Test Loss: 2.533 Test Acc: 0.787
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.441661834716797
Epoch: 12, Steps: 8 | Train Loss: 0.346 Vali Loss: 2.501 Vali Acc: 0.797 Test Loss: 2.501 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 3408448
model size : 22.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.445782423019409
Epoch: 1, Steps: 8 | Train Loss: 1.705 Vali Loss: 0.663 Vali Acc: 0.797 Test Loss: 0.663 Test Acc: 0.797
Validation loss decreased (inf --> -0.796868).  Saving model ...
Epoch: 2 cost time: 1.821742057800293
Epoch: 2, Steps: 8 | Train Loss: 0.694 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
Validation loss decreased (-0.796868 --> -0.862494).  Saving model ...
Epoch: 3 cost time: 2.0698180198669434
Epoch: 3, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.951 Vali Acc: 0.841 Test Loss: 0.951 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.282531976699829
Epoch: 4, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.033 Vali Acc: 0.869 Test Loss: 1.033 Test Acc: 0.869
Validation loss decreased (-0.862494 --> -0.868740).  Saving model ...
Epoch: 5 cost time: 1.9676597118377686
Epoch: 5, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.303 Vali Acc: 0.816 Test Loss: 1.303 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2256431579589844
Epoch: 6, Steps: 8 | Train Loss: 0.109 Vali Loss: 2.051 Vali Acc: 0.828 Test Loss: 2.051 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7996246814727783
Epoch: 7, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.959 Vali Acc: 0.850 Test Loss: 1.959 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9304022789001465
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.396 Vali Acc: 0.872 Test Loss: 1.396 Test Acc: 0.872
Validation loss decreased (-0.868740 --> -0.871861).  Saving model ...
Epoch: 9 cost time: 2.131345272064209
Epoch: 9, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.481 Vali Acc: 0.872 Test Loss: 1.481 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9558966159820557
Epoch: 10, Steps: 8 | Train Loss: 0.184 Vali Loss: 2.948 Vali Acc: 0.809 Test Loss: 2.948 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.603095293045044
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 3.068 Vali Acc: 0.797 Test Loss: 3.068 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.107717752456665
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 3.092 Vali Acc: 0.781 Test Loss: 3.092 Test Acc: 0.781
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0587387084960938
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 3.201 Vali Acc: 0.822 Test Loss: 3.201 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5096707344055176
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 3.203 Vali Acc: 0.816 Test Loss: 3.203 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8301804065704346
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 3.065 Vali Acc: 0.859 Test Loss: 3.065 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.388184070587158
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 3.141 Vali Acc: 0.841 Test Loss: 3.141 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.023599147796631
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 3.631 Vali Acc: 0.816 Test Loss: 3.631 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.294732093811035
Epoch: 18, Steps: 8 | Train Loss: 0.135 Vali Loss: 3.691 Vali Acc: 0.844 Test Loss: 3.691 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 3408448
model size : 22.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.646483659744263
Epoch: 1, Steps: 8 | Train Loss: 1.728 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
Validation loss decreased (inf --> -0.799994).  Saving model ...
Epoch: 2 cost time: 1.677882194519043
Epoch: 2, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.758 Vali Acc: 0.825 Test Loss: 0.758 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824992).  Saving model ...
Epoch: 3 cost time: 2.7544314861297607
Epoch: 3, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.673 Vali Acc: 0.778 Test Loss: 1.673 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.452639579772949
Epoch: 4, Steps: 8 | Train Loss: 0.481 Vali Loss: 1.608 Vali Acc: 0.831 Test Loss: 1.608 Test Acc: 0.831
Validation loss decreased (-0.824992 --> -0.831234).  Saving model ...
Epoch: 5 cost time: 2.769047498703003
Epoch: 5, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.516 Vali Acc: 0.834 Test Loss: 1.516 Test Acc: 0.834
Validation loss decreased (-0.831234 --> -0.834360).  Saving model ...
Epoch: 6 cost time: 2.6456055641174316
Epoch: 6, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.947 Vali Acc: 0.812 Test Loss: 1.947 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.313448190689087
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.772 Vali Acc: 0.856 Test Loss: 1.772 Test Acc: 0.856
Validation loss decreased (-0.834360 --> -0.856232).  Saving model ...
Epoch: 8 cost time: 2.4104866981506348
Epoch: 8, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.999 Vali Acc: 0.859 Test Loss: 1.999 Test Acc: 0.859
Validation loss decreased (-0.856232 --> -0.859355).  Saving model ...
Epoch: 9 cost time: 2.6466543674468994
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.612 Vali Acc: 0.825 Test Loss: 2.612 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.306735038757324
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.632 Vali Acc: 0.819 Test Loss: 2.632 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.240129232406616
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.265 Vali Acc: 0.838 Test Loss: 2.265 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9164884090423584
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.486 Vali Acc: 0.816 Test Loss: 2.486 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0018362998962402
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.327 Vali Acc: 0.822 Test Loss: 2.327 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.466121196746826
Epoch: 14, Steps: 8 | Train Loss: 0.119 Vali Loss: 2.738 Vali Acc: 0.797 Test Loss: 2.738 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4711203575134277
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 3.249 Vali Acc: 0.797 Test Loss: 3.249 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.516988515853882
Epoch: 16, Steps: 8 | Train Loss: 0.244 Vali Loss: 3.543 Vali Acc: 0.819 Test Loss: 3.543 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.824713945388794
Epoch: 17, Steps: 8 | Train Loss: 0.180 Vali Loss: 4.332 Vali Acc: 0.794 Test Loss: 4.332 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5328991413116455
Epoch: 18, Steps: 8 | Train Loss: 0.443 Vali Loss: 3.954 Vali Acc: 0.787 Test Loss: 3.954 Test Acc: 0.787
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 2884160
model size : 20.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.919263601303101
Epoch: 1, Steps: 8 | Train Loss: 1.746 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
Validation loss decreased (inf --> -0.799994).  Saving model ...
Epoch: 2 cost time: 2.2178428173065186
Epoch: 2, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.753 Vali Acc: 0.844 Test Loss: 0.753 Test Acc: 0.844
Validation loss decreased (-0.799994 --> -0.843742).  Saving model ...
Epoch: 3 cost time: 2.455866575241089
Epoch: 3, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.633 Vali Acc: 0.787 Test Loss: 1.633 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.763958692550659
Epoch: 4, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.640 Vali Acc: 0.822 Test Loss: 1.640 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5975265502929688
Epoch: 5, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.577 Vali Acc: 0.834 Test Loss: 1.577 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.308206081390381
Epoch: 6, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.925 Vali Acc: 0.822 Test Loss: 1.925 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4942030906677246
Epoch: 7, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.945 Vali Acc: 0.819 Test Loss: 1.945 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8819503784179688
Epoch: 8, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.945 Vali Acc: 0.816 Test Loss: 1.945 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.608689308166504
Epoch: 9, Steps: 8 | Train Loss: 0.033 Vali Loss: 2.324 Vali Acc: 0.838 Test Loss: 2.324 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.101499080657959
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 3.272 Vali Acc: 0.775 Test Loss: 3.272 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5991039276123047
Epoch: 11, Steps: 8 | Train Loss: 0.099 Vali Loss: 4.087 Vali Acc: 0.787 Test Loss: 4.087 Test Acc: 0.787
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.307732105255127
Epoch: 12, Steps: 8 | Train Loss: 0.190 Vali Loss: 5.462 Vali Acc: 0.759 Test Loss: 5.462 Test Acc: 0.759
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 2884160
model size : 20.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.663592576980591
Epoch: 1, Steps: 8 | Train Loss: 1.739 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (inf --> -0.818744).  Saving model ...
Epoch: 2 cost time: 2.0119588375091553
Epoch: 2, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824992).  Saving model ...
Epoch: 3 cost time: 2.320702314376831
Epoch: 3, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.592 Vali Acc: 0.794 Test Loss: 1.592 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3740177154541016
Epoch: 4, Steps: 8 | Train Loss: 0.457 Vali Loss: 1.611 Vali Acc: 0.831 Test Loss: 1.611 Test Acc: 0.831
Validation loss decreased (-0.824992 --> -0.831234).  Saving model ...
Epoch: 5 cost time: 2.063751220703125
Epoch: 5, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.498 Vali Acc: 0.838 Test Loss: 1.498 Test Acc: 0.838
Validation loss decreased (-0.831234 --> -0.837485).  Saving model ...
Epoch: 6 cost time: 2.112980365753174
Epoch: 6, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.683 Vali Acc: 0.844 Test Loss: 1.683 Test Acc: 0.844
Validation loss decreased (-0.837485 --> -0.843733).  Saving model ...
Epoch: 7 cost time: 1.7890162467956543
Epoch: 7, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.713 Vali Acc: 0.847 Test Loss: 1.713 Test Acc: 0.847
Validation loss decreased (-0.843733 --> -0.846858).  Saving model ...
Epoch: 8 cost time: 2.2500410079956055
Epoch: 8, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.988 Vali Acc: 0.822 Test Loss: 1.988 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.092349052429199
Epoch: 9, Steps: 8 | Train Loss: 0.066 Vali Loss: 2.965 Vali Acc: 0.775 Test Loss: 2.965 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1853671073913574
Epoch: 10, Steps: 8 | Train Loss: 0.243 Vali Loss: 2.728 Vali Acc: 0.809 Test Loss: 2.728 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.40743088722229
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.591 Vali Acc: 0.822 Test Loss: 2.591 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.390747547149658
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.820 Vali Acc: 0.838 Test Loss: 2.820 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1667330265045166
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 3.368 Vali Acc: 0.778 Test Loss: 3.368 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3403844833374023
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 3.208 Vali Acc: 0.838 Test Loss: 3.208 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9951553344726562
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 3.490 Vali Acc: 0.831 Test Loss: 3.490 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.432868719100952
Epoch: 16, Steps: 8 | Train Loss: 0.171 Vali Loss: 4.190 Vali Acc: 0.834 Test Loss: 4.190 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8140416145324707
Epoch: 17, Steps: 8 | Train Loss: 0.061 Vali Loss: 4.322 Vali Acc: 0.828 Test Loss: 4.322 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 2884160
model size : 20.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.546011209487915
Epoch: 1, Steps: 8 | Train Loss: 1.761 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
Validation loss decreased (inf --> -0.828119).  Saving model ...
Epoch: 2 cost time: 2.3142857551574707
Epoch: 2, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.646 Vali Acc: 0.853 Test Loss: 0.646 Test Acc: 0.853
Validation loss decreased (-0.828119 --> -0.853119).  Saving model ...
Epoch: 3 cost time: 2.0663821697235107
Epoch: 3, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.600 Vali Acc: 0.781 Test Loss: 1.600 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.227351427078247
Epoch: 4, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.433 Vali Acc: 0.834 Test Loss: 1.433 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.122144937515259
Epoch: 5, Steps: 8 | Train Loss: 0.202 Vali Loss: 1.185 Vali Acc: 0.875 Test Loss: 1.185 Test Acc: 0.875
Validation loss decreased (-0.853119 --> -0.874988).  Saving model ...
Epoch: 6 cost time: 2.138549327850342
Epoch: 6, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.347 Vali Acc: 0.844 Test Loss: 1.347 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3753840923309326
Epoch: 7, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.692 Vali Acc: 0.844 Test Loss: 1.692 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0477824211120605
Epoch: 8, Steps: 8 | Train Loss: 0.335 Vali Loss: 1.748 Vali Acc: 0.834 Test Loss: 1.748 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9517672061920166
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.184 Vali Acc: 0.816 Test Loss: 2.184 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.027064323425293
Epoch: 10, Steps: 8 | Train Loss: 0.261 Vali Loss: 1.625 Vali Acc: 0.863 Test Loss: 1.625 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0112712383270264
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.677 Vali Acc: 0.816 Test Loss: 2.677 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1113102436065674
Epoch: 12, Steps: 8 | Train Loss: 0.089 Vali Loss: 3.172 Vali Acc: 0.800 Test Loss: 3.172 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2857072353363037
Epoch: 13, Steps: 8 | Train Loss: 0.105 Vali Loss: 2.731 Vali Acc: 0.822 Test Loss: 2.731 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.243077278137207
Epoch: 14, Steps: 8 | Train Loss: 0.210 Vali Loss: 2.812 Vali Acc: 0.841 Test Loss: 2.812 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.26761531829834
Epoch: 15, Steps: 8 | Train Loss: 0.211 Vali Loss: 2.574 Vali Acc: 0.847 Test Loss: 2.574 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 2884160
model size : 20.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.017667770385742
Epoch: 1, Steps: 8 | Train Loss: 1.633 Vali Loss: 0.630 Vali Acc: 0.787 Test Loss: 0.630 Test Acc: 0.787
Validation loss decreased (inf --> -0.787494).  Saving model ...
Epoch: 2 cost time: 2.1966869831085205
Epoch: 2, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.715 Vali Acc: 0.847 Test Loss: 0.715 Test Acc: 0.847
Validation loss decreased (-0.787494 --> -0.846868).  Saving model ...
Epoch: 3 cost time: 2.2060606479644775
Epoch: 3, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.098 Vali Acc: 0.844 Test Loss: 1.098 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.283491373062134
Epoch: 4, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.274 Vali Acc: 0.838 Test Loss: 1.274 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1729166507720947
Epoch: 5, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.565 Vali Acc: 0.803 Test Loss: 1.565 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6106271743774414
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.825 Test Loss: 1.455 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4188239574432373
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.634 Vali Acc: 0.828 Test Loss: 1.634 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5772905349731445
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.155 Vali Acc: 0.800 Test Loss: 2.155 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3642427921295166
Epoch: 9, Steps: 8 | Train Loss: 0.108 Vali Loss: 2.206 Vali Acc: 0.794 Test Loss: 2.206 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.2771832942962646
Epoch: 10, Steps: 8 | Train Loss: 0.396 Vali Loss: 2.104 Vali Acc: 0.806 Test Loss: 2.104 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4940073490142822
Epoch: 11, Steps: 8 | Train Loss: 0.209 Vali Loss: 2.087 Vali Acc: 0.831 Test Loss: 2.087 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1393046379089355
Epoch: 12, Steps: 8 | Train Loss: 0.095 Vali Loss: 2.562 Vali Acc: 0.791 Test Loss: 2.562 Test Acc: 0.791
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 2622016
model size : 19.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.998393535614014
Epoch: 1, Steps: 8 | Train Loss: 1.616 Vali Loss: 0.626 Vali Acc: 0.797 Test Loss: 0.626 Test Acc: 0.797
Validation loss decreased (inf --> -0.796869).  Saving model ...
Epoch: 2 cost time: 2.271805763244629
Epoch: 2, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.715 Vali Acc: 0.844 Test Loss: 0.715 Test Acc: 0.844
Validation loss decreased (-0.796869 --> -0.843743).  Saving model ...
Epoch: 3 cost time: 2.3680102825164795
Epoch: 3, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.160 Vali Acc: 0.838 Test Loss: 1.160 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.342864990234375
Epoch: 4, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.430 Vali Acc: 0.816 Test Loss: 1.430 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.264539957046509
Epoch: 5, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.494 Vali Acc: 0.825 Test Loss: 1.494 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.318751335144043
Epoch: 6, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.708 Vali Acc: 0.809 Test Loss: 1.708 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3057496547698975
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.945 Vali Acc: 0.816 Test Loss: 1.945 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2131810188293457
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.134 Vali Acc: 0.822 Test Loss: 2.134 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4184048175811768
Epoch: 9, Steps: 8 | Train Loss: 0.062 Vali Loss: 2.385 Vali Acc: 0.778 Test Loss: 2.385 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5314760208129883
Epoch: 10, Steps: 8 | Train Loss: 0.141 Vali Loss: 2.128 Vali Acc: 0.806 Test Loss: 2.128 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4601898193359375
Epoch: 11, Steps: 8 | Train Loss: 0.243 Vali Loss: 2.639 Vali Acc: 0.781 Test Loss: 2.639 Test Acc: 0.781
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4373624324798584
Epoch: 12, Steps: 8 | Train Loss: 0.067 Vali Loss: 3.530 Vali Acc: 0.778 Test Loss: 3.530 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 2622016
model size : 19.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.338061571121216
Epoch: 1, Steps: 8 | Train Loss: 1.605 Vali Loss: 0.619 Vali Acc: 0.791 Test Loss: 0.619 Test Acc: 0.791
Validation loss decreased (inf --> -0.790619).  Saving model ...
Epoch: 2 cost time: 2.261225700378418
Epoch: 2, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.694 Vali Acc: 0.844 Test Loss: 0.694 Test Acc: 0.844
Validation loss decreased (-0.790619 --> -0.843743).  Saving model ...
Epoch: 3 cost time: 1.930727481842041
Epoch: 3, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.129 Vali Acc: 0.838 Test Loss: 1.129 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6164894104003906
Epoch: 4, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.394 Vali Acc: 0.834 Test Loss: 1.394 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5409436225891113
Epoch: 5, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.459 Vali Acc: 0.856 Test Loss: 1.459 Test Acc: 0.856
Validation loss decreased (-0.843743 --> -0.856235).  Saving model ...
Epoch: 6 cost time: 2.1315343379974365
Epoch: 6, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.367 Vali Acc: 0.853 Test Loss: 1.367 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.481248378753662
Epoch: 7, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.918 Vali Acc: 0.803 Test Loss: 1.918 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0089519023895264
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.952 Vali Acc: 0.784 Test Loss: 2.952 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4049129486083984
Epoch: 9, Steps: 8 | Train Loss: 0.041 Vali Loss: 2.261 Vali Acc: 0.816 Test Loss: 2.261 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3306193351745605
Epoch: 10, Steps: 8 | Train Loss: 0.083 Vali Loss: 2.612 Vali Acc: 0.803 Test Loss: 2.612 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.557340621948242
Epoch: 11, Steps: 8 | Train Loss: 0.278 Vali Loss: 3.094 Vali Acc: 0.791 Test Loss: 3.094 Test Acc: 0.791
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.151505947113037
Epoch: 12, Steps: 8 | Train Loss: 0.266 Vali Loss: 2.681 Vali Acc: 0.809 Test Loss: 2.681 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5611164569854736
Epoch: 13, Steps: 8 | Train Loss: 0.059 Vali Loss: 3.388 Vali Acc: 0.762 Test Loss: 3.388 Test Acc: 0.762
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.222529649734497
Epoch: 14, Steps: 8 | Train Loss: 0.176 Vali Loss: 3.421 Vali Acc: 0.803 Test Loss: 3.421 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3378007411956787
Epoch: 15, Steps: 8 | Train Loss: 0.060 Vali Loss: 3.362 Vali Acc: 0.822 Test Loss: 3.362 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 2622016
model size : 19.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.122901201248169
Epoch: 1, Steps: 8 | Train Loss: 1.621 Vali Loss: 0.622 Vali Acc: 0.794 Test Loss: 0.622 Test Acc: 0.794
Validation loss decreased (inf --> -0.793744).  Saving model ...
Epoch: 2 cost time: 1.7454679012298584
Epoch: 2, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.671 Vali Acc: 0.844 Test Loss: 0.671 Test Acc: 0.844
Validation loss decreased (-0.793744 --> -0.843743).  Saving model ...
Epoch: 3 cost time: 1.7469801902770996
Epoch: 3, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.240 Vali Acc: 0.812 Test Loss: 1.240 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9615349769592285
Epoch: 4, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.475 Vali Acc: 0.828 Test Loss: 1.475 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.63311767578125
Epoch: 5, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.314 Vali Acc: 0.853 Test Loss: 1.314 Test Acc: 0.853
Validation loss decreased (-0.843743 --> -0.853112).  Saving model ...
Epoch: 6 cost time: 2.025808572769165
Epoch: 6, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.195 Vali Acc: 0.869 Test Loss: 1.195 Test Acc: 0.869
Validation loss decreased (-0.853112 --> -0.868738).  Saving model ...
Epoch: 7 cost time: 2.1381049156188965
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.550 Vali Acc: 0.859 Test Loss: 1.550 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.170790910720825
Epoch: 8, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.616 Vali Acc: 0.853 Test Loss: 1.616 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8932721614837646
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.944 Vali Acc: 0.863 Test Loss: 1.944 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0193071365356445
Epoch: 10, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.735 Vali Acc: 0.853 Test Loss: 1.735 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9468955993652344
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.772 Vali Acc: 0.856 Test Loss: 1.772 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.093543291091919
Epoch: 12, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.986 Vali Acc: 0.863 Test Loss: 1.986 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8343939781188965
Epoch: 13, Steps: 8 | Train Loss: 0.065 Vali Loss: 2.972 Vali Acc: 0.834 Test Loss: 2.972 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.843733549118042
Epoch: 14, Steps: 8 | Train Loss: 0.183 Vali Loss: 2.712 Vali Acc: 0.819 Test Loss: 2.712 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9292283058166504
Epoch: 15, Steps: 8 | Train Loss: 0.115 Vali Loss: 3.449 Vali Acc: 0.784 Test Loss: 3.449 Test Acc: 0.784
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.966665267944336
Epoch: 16, Steps: 8 | Train Loss: 0.185 Vali Loss: 3.516 Vali Acc: 0.775 Test Loss: 3.516 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 2622016
model size : 19.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.9004387855529785
Epoch: 1, Steps: 8 | Train Loss: 1.812 Vali Loss: 0.660 Vali Acc: 0.781 Test Loss: 0.660 Test Acc: 0.781
Validation loss decreased (inf --> -0.781243).  Saving model ...
Epoch: 2 cost time: 2.5842974185943604
Epoch: 2, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.753 Vali Acc: 0.809 Test Loss: 0.753 Test Acc: 0.809
Validation loss decreased (-0.781243 --> -0.809367).  Saving model ...
Epoch: 3 cost time: 2.49648380279541
Epoch: 3, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.996 Vali Acc: 0.834 Test Loss: 0.996 Test Acc: 0.834
Validation loss decreased (-0.809367 --> -0.834365).  Saving model ...
Epoch: 4 cost time: 2.3279154300689697
Epoch: 4, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.495 Vali Acc: 0.806 Test Loss: 1.495 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2871861457824707
Epoch: 5, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.371 Vali Acc: 0.859 Test Loss: 1.371 Test Acc: 0.859
Validation loss decreased (-0.834365 --> -0.859361).  Saving model ...
Epoch: 6 cost time: 2.258237838745117
Epoch: 6, Steps: 8 | Train Loss: 0.174 Vali Loss: 2.023 Vali Acc: 0.803 Test Loss: 2.023 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3622632026672363
Epoch: 7, Steps: 8 | Train Loss: 0.451 Vali Loss: 2.373 Vali Acc: 0.778 Test Loss: 2.373 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5379419326782227
Epoch: 8, Steps: 8 | Train Loss: 0.092 Vali Loss: 2.104 Vali Acc: 0.806 Test Loss: 2.104 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1959095001220703
Epoch: 9, Steps: 8 | Train Loss: 0.129 Vali Loss: 2.547 Vali Acc: 0.800 Test Loss: 2.547 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5641121864318848
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.764 Vali Acc: 0.772 Test Loss: 2.764 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9635610580444336
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.669 Vali Acc: 0.816 Test Loss: 2.669 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9237260818481445
Epoch: 12, Steps: 8 | Train Loss: 0.133 Vali Loss: 3.947 Vali Acc: 0.753 Test Loss: 3.947 Test Acc: 0.753
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.557879686355591
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 3.204 Vali Acc: 0.816 Test Loss: 3.204 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4225125312805176
Epoch: 14, Steps: 8 | Train Loss: 0.043 Vali Loss: 3.579 Vali Acc: 0.816 Test Loss: 3.579 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.568525552749634
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 4.273 Vali Acc: 0.781 Test Loss: 4.273 Test Acc: 0.781
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 2490944
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.561310052871704
Epoch: 1, Steps: 8 | Train Loss: 1.788 Vali Loss: 0.652 Vali Acc: 0.791 Test Loss: 0.652 Test Acc: 0.791
Validation loss decreased (inf --> -0.790618).  Saving model ...
Epoch: 2 cost time: 1.9006571769714355
Epoch: 2, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.777 Vali Acc: 0.812 Test Loss: 0.777 Test Acc: 0.812
Validation loss decreased (-0.790618 --> -0.812492).  Saving model ...
Epoch: 3 cost time: 2.382650375366211
Epoch: 3, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.945 Vali Acc: 0.838 Test Loss: 0.945 Test Acc: 0.838
Validation loss decreased (-0.812492 --> -0.837491).  Saving model ...
Epoch: 4 cost time: 2.487276077270508
Epoch: 4, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.531 Vali Acc: 0.819 Test Loss: 1.531 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.25927472114563
Epoch: 5, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.474 Vali Acc: 0.847 Test Loss: 1.474 Test Acc: 0.847
Validation loss decreased (-0.837491 --> -0.846860).  Saving model ...
Epoch: 6 cost time: 2.3850653171539307
Epoch: 6, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.513 Vali Acc: 0.803 Test Loss: 1.513 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.087477445602417
Epoch: 7, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.724 Vali Acc: 0.841 Test Loss: 1.724 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.31796932220459
Epoch: 8, Steps: 8 | Train Loss: 0.083 Vali Loss: 2.226 Vali Acc: 0.816 Test Loss: 2.226 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1394550800323486
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.720 Vali Acc: 0.794 Test Loss: 2.720 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4152252674102783
Epoch: 10, Steps: 8 | Train Loss: 0.237 Vali Loss: 3.134 Vali Acc: 0.791 Test Loss: 3.134 Test Acc: 0.791
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.491441249847412
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.045 Vali Acc: 0.759 Test Loss: 3.045 Test Acc: 0.759
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.528507947921753
Epoch: 12, Steps: 8 | Train Loss: 0.062 Vali Loss: 3.376 Vali Acc: 0.791 Test Loss: 3.376 Test Acc: 0.791
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.223418712615967
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 4.108 Vali Acc: 0.762 Test Loss: 4.108 Test Acc: 0.762
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3692097663879395
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 3.239 Vali Acc: 0.800 Test Loss: 3.239 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.455648183822632
Epoch: 15, Steps: 8 | Train Loss: 0.108 Vali Loss: 3.104 Vali Acc: 0.800 Test Loss: 3.104 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 2490944
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.548498630523682
Epoch: 1, Steps: 8 | Train Loss: 1.797 Vali Loss: 0.646 Vali Acc: 0.778 Test Loss: 0.646 Test Acc: 0.778
Validation loss decreased (inf --> -0.778119).  Saving model ...
Epoch: 2 cost time: 2.1371028423309326
Epoch: 2, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.749 Vali Acc: 0.812 Test Loss: 0.749 Test Acc: 0.812
Validation loss decreased (-0.778119 --> -0.812493).  Saving model ...
Epoch: 3 cost time: 1.9206464290618896
Epoch: 3, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.983 Vali Acc: 0.825 Test Loss: 0.983 Test Acc: 0.825
Validation loss decreased (-0.812493 --> -0.824990).  Saving model ...
Epoch: 4 cost time: 1.8994042873382568
Epoch: 4, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.274 Vali Acc: 0.825 Test Loss: 1.274 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.297978639602661
Epoch: 5, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.385 Vali Acc: 0.841 Test Loss: 1.385 Test Acc: 0.841
Validation loss decreased (-0.824990 --> -0.840611).  Saving model ...
Epoch: 6 cost time: 2.2558741569519043
Epoch: 6, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.687 Vali Acc: 0.828 Test Loss: 1.687 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4540369510650635
Epoch: 7, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.769 Vali Acc: 0.834 Test Loss: 1.769 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5767321586608887
Epoch: 8, Steps: 8 | Train Loss: 0.045 Vali Loss: 2.334 Vali Acc: 0.812 Test Loss: 2.334 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.151015520095825
Epoch: 9, Steps: 8 | Train Loss: 0.118 Vali Loss: 3.261 Vali Acc: 0.753 Test Loss: 3.261 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.579946756362915
Epoch: 10, Steps: 8 | Train Loss: 0.368 Vali Loss: 2.737 Vali Acc: 0.800 Test Loss: 2.737 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3005716800689697
Epoch: 11, Steps: 8 | Train Loss: 0.134 Vali Loss: 3.206 Vali Acc: 0.803 Test Loss: 3.206 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2849411964416504
Epoch: 12, Steps: 8 | Train Loss: 0.156 Vali Loss: 2.845 Vali Acc: 0.856 Test Loss: 2.845 Test Acc: 0.856
Validation loss decreased (-0.840611 --> -0.856222).  Saving model ...
Epoch: 13 cost time: 1.9516489505767822
Epoch: 13, Steps: 8 | Train Loss: 0.118 Vali Loss: 3.381 Vali Acc: 0.825 Test Loss: 3.381 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.291414260864258
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 3.680 Vali Acc: 0.819 Test Loss: 3.680 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.356421709060669
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 4.101 Vali Acc: 0.809 Test Loss: 4.101 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9638347625732422
Epoch: 16, Steps: 8 | Train Loss: 0.035 Vali Loss: 4.766 Vali Acc: 0.787 Test Loss: 4.766 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3561813831329346
Epoch: 17, Steps: 8 | Train Loss: 0.514 Vali Loss: 4.594 Vali Acc: 0.797 Test Loss: 4.594 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2831976413726807
Epoch: 18, Steps: 8 | Train Loss: 0.116 Vali Loss: 4.499 Vali Acc: 0.816 Test Loss: 4.499 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1876354217529297
Epoch: 19, Steps: 8 | Train Loss: 0.050 Vali Loss: 4.261 Vali Acc: 0.806 Test Loss: 4.261 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.506747007369995
Epoch: 20, Steps: 8 | Train Loss: 0.037 Vali Loss: 5.624 Vali Acc: 0.775 Test Loss: 5.624 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5150907039642334
Epoch: 21, Steps: 8 | Train Loss: 0.293 Vali Loss: 3.638 Vali Acc: 0.856 Test Loss: 3.638 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.139561414718628
Epoch: 22, Steps: 8 | Train Loss: 0.132 Vali Loss: 4.717 Vali Acc: 0.834 Test Loss: 4.717 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 2490944
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.328593730926514
Epoch: 1, Steps: 8 | Train Loss: 1.776 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
Validation loss decreased (inf --> -0.799994).  Saving model ...
Epoch: 2 cost time: 1.7520945072174072
Epoch: 2, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.644 Vali Acc: 0.853 Test Loss: 0.644 Test Acc: 0.853
Validation loss decreased (-0.799994 --> -0.853119).  Saving model ...
Epoch: 3 cost time: 2.1794352531433105
Epoch: 3, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.009 Vali Acc: 0.809 Test Loss: 1.009 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9226579666137695
Epoch: 4, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.151 Vali Acc: 0.831 Test Loss: 1.151 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.221979856491089
Epoch: 5, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.125 Vali Acc: 0.856 Test Loss: 1.125 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856239).  Saving model ...
Epoch: 6 cost time: 2.149587631225586
Epoch: 6, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.233 Vali Acc: 0.856 Test Loss: 1.233 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.976346731185913
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.312 Vali Acc: 0.872 Test Loss: 1.312 Test Acc: 0.872
Validation loss decreased (-0.856239 --> -0.871862).  Saving model ...
Epoch: 8 cost time: 2.2232043743133545
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.707 Vali Acc: 0.878 Test Loss: 1.707 Test Acc: 0.878
Validation loss decreased (-0.871862 --> -0.878108).  Saving model ...
Epoch: 9 cost time: 1.758880615234375
Epoch: 9, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.813 Vali Acc: 0.847 Test Loss: 1.813 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0512948036193848
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.487 Vali Acc: 0.853 Test Loss: 1.487 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9396398067474365
Epoch: 11, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.760 Vali Acc: 0.872 Test Loss: 1.760 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7103421688079834
Epoch: 12, Steps: 8 | Train Loss: 0.365 Vali Loss: 2.173 Vali Acc: 0.853 Test Loss: 2.173 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0027785301208496
Epoch: 13, Steps: 8 | Train Loss: 0.175 Vali Loss: 2.408 Vali Acc: 0.812 Test Loss: 2.408 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2052392959594727
Epoch: 14, Steps: 8 | Train Loss: 0.283 Vali Loss: 3.479 Vali Acc: 0.775 Test Loss: 3.479 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.154315948486328
Epoch: 15, Steps: 8 | Train Loss: 0.041 Vali Loss: 3.655 Vali Acc: 0.794 Test Loss: 3.655 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8607635498046875
Epoch: 16, Steps: 8 | Train Loss: 0.374 Vali Loss: 2.903 Vali Acc: 0.856 Test Loss: 2.903 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7021806240081787
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 3.438 Vali Acc: 0.838 Test Loss: 3.438 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7689299583435059
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 3.347 Vali Acc: 0.812 Test Loss: 3.347 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 2490944
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5815467834472656
Epoch: 1, Steps: 8 | Train Loss: 1.861 Vali Loss: 0.910 Vali Acc: 0.762 Test Loss: 0.910 Test Acc: 0.762
Validation loss decreased (inf --> -0.762491).  Saving model ...
Epoch: 2 cost time: 1.9629220962524414
Epoch: 2, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
Validation loss decreased (-0.762491 --> -0.815620).  Saving model ...
Epoch: 3 cost time: 1.918860912322998
Epoch: 3, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.689 Vali Acc: 0.841 Test Loss: 0.689 Test Acc: 0.841
Validation loss decreased (-0.815620 --> -0.840618).  Saving model ...
Epoch: 4 cost time: 1.9896609783172607
Epoch: 4, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.879 Vali Acc: 0.812 Test Loss: 0.879 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8020961284637451
Epoch: 5, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.100 Vali Acc: 0.822 Test Loss: 1.100 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8622500896453857
Epoch: 6, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.146 Vali Acc: 0.844 Test Loss: 1.146 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843739).  Saving model ...
Epoch: 7 cost time: 1.9682190418243408
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.080 Vali Acc: 0.838 Test Loss: 1.080 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9829885959625244
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.043 Vali Acc: 0.834 Test Loss: 1.043 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9546189308166504
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.538 Vali Acc: 0.816 Test Loss: 1.538 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0419106483459473
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.488 Vali Acc: 0.816 Test Loss: 1.488 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1387431621551514
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.256 Vali Acc: 0.838 Test Loss: 1.256 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7128875255584717
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.748 Vali Acc: 0.797 Test Loss: 1.748 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.119485378265381
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.494 Vali Acc: 0.816 Test Loss: 1.494 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.155406951904297
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.816 Test Loss: 1.416 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.066276788711548
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.834 Test Loss: 1.385 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.157209873199463
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.834 Test Loss: 1.537 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 3014976
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.4465203285217285
Epoch: 1, Steps: 8 | Train Loss: 1.852 Vali Loss: 0.894 Vali Acc: 0.781 Test Loss: 0.894 Test Acc: 0.781
Validation loss decreased (inf --> -0.781241).  Saving model ...
Epoch: 2 cost time: 2.049400806427002
Epoch: 2, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
Validation loss decreased (-0.781241 --> -0.824995).  Saving model ...
Epoch: 3 cost time: 1.8092985153198242
Epoch: 3, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.680 Vali Acc: 0.844 Test Loss: 0.680 Test Acc: 0.844
Validation loss decreased (-0.824995 --> -0.843743).  Saving model ...
Epoch: 4 cost time: 1.643104076385498
Epoch: 4, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.883 Vali Acc: 0.819 Test Loss: 0.883 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.796830177307129
Epoch: 5, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.131 Vali Acc: 0.825 Test Loss: 1.131 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.012362241744995
Epoch: 6, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.195 Vali Acc: 0.847 Test Loss: 1.195 Test Acc: 0.847
Validation loss decreased (-0.843743 --> -0.846863).  Saving model ...
Epoch: 7 cost time: 1.5659539699554443
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.251 Vali Acc: 0.794 Test Loss: 1.251 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.078944683074951
Epoch: 8, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.539 Vali Acc: 0.794 Test Loss: 1.539 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.271949052810669
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.668 Vali Acc: 0.781 Test Loss: 1.668 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4910223484039307
Epoch: 10, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.819 Vali Acc: 0.784 Test Loss: 1.819 Test Acc: 0.784
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7764017581939697
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.582 Vali Acc: 0.828 Test Loss: 1.582 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9757018089294434
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.740 Vali Acc: 0.825 Test Loss: 1.740 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9674773216247559
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.002 Vali Acc: 0.819 Test Loss: 2.002 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8995401859283447
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.081 Vali Acc: 0.803 Test Loss: 2.081 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9953808784484863
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.999 Vali Acc: 0.816 Test Loss: 1.999 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0278372764587402
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.822 Test Loss: 1.967 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 3014976
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.467032194137573
Epoch: 1, Steps: 8 | Train Loss: 1.841 Vali Loss: 0.888 Vali Acc: 0.794 Test Loss: 0.888 Test Acc: 0.794
Validation loss decreased (inf --> -0.793741).  Saving model ...
Epoch: 2 cost time: 1.9368093013763428
Epoch: 2, Steps: 8 | Train Loss: 0.571 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
Validation loss decreased (-0.793741 --> -0.824995).  Saving model ...
Epoch: 3 cost time: 1.9536874294281006
Epoch: 3, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.650 Vali Acc: 0.856 Test Loss: 0.650 Test Acc: 0.856
Validation loss decreased (-0.824995 --> -0.856244).  Saving model ...
Epoch: 4 cost time: 1.951012134552002
Epoch: 4, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.856 Vali Acc: 0.816 Test Loss: 0.856 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6807401180267334
Epoch: 5, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.111 Vali Acc: 0.822 Test Loss: 1.111 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9261186122894287
Epoch: 6, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.148 Vali Acc: 0.853 Test Loss: 1.148 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7631590366363525
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.188 Vali Acc: 0.812 Test Loss: 1.188 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0272293090820312
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.313 Vali Acc: 0.831 Test Loss: 1.313 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7654666900634766
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.816 Test Loss: 1.468 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7885613441467285
Epoch: 10, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.539 Vali Acc: 0.819 Test Loss: 1.539 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6119725704193115
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.816 Test Loss: 1.434 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8884410858154297
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.825 Test Loss: 1.417 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.878967046737671
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.825 Test Loss: 1.440 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 3014976
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.097961664199829
Epoch: 1, Steps: 8 | Train Loss: 1.853 Vali Loss: 0.926 Vali Acc: 0.781 Test Loss: 0.926 Test Acc: 0.781
Validation loss decreased (inf --> -0.781241).  Saving model ...
Epoch: 2 cost time: 1.7421987056732178
Epoch: 2, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
Validation loss decreased (-0.781241 --> -0.846870).  Saving model ...
Epoch: 3 cost time: 1.5941295623779297
Epoch: 3, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.606 Vali Acc: 0.853 Test Loss: 0.606 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853119).  Saving model ...
Epoch: 4 cost time: 1.4369304180145264
Epoch: 4, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5828289985656738
Epoch: 5, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.890 Vali Acc: 0.863 Test Loss: 0.890 Test Acc: 0.863
Validation loss decreased (-0.853119 --> -0.862491).  Saving model ...
Epoch: 6 cost time: 1.428699254989624
Epoch: 6, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.959 Vali Acc: 0.878 Test Loss: 0.959 Test Acc: 0.878
Validation loss decreased (-0.862491 --> -0.878115).  Saving model ...
Epoch: 7 cost time: 1.7737834453582764
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.853 Test Loss: 0.916 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5527868270874023
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.051 Vali Acc: 0.869 Test Loss: 1.051 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9225306510925293
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.069 Vali Acc: 0.884 Test Loss: 1.069 Test Acc: 0.884
Validation loss decreased (-0.878115 --> -0.884364).  Saving model ...
Epoch: 10 cost time: 1.9970149993896484
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.872 Test Loss: 1.056 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.079784393310547
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.847 Test Loss: 1.089 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.89518141746521
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.116 Vali Acc: 0.863 Test Loss: 1.116 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6200213432312012
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.118 Vali Acc: 0.844 Test Loss: 1.118 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.056361198425293
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.136 Vali Acc: 0.856 Test Loss: 1.136 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5858397483825684
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.209 Vali Acc: 0.856 Test Loss: 1.209 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8594062328338623
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.139 Vali Acc: 0.853 Test Loss: 1.139 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.691725730895996
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.119 Vali Acc: 0.853 Test Loss: 1.119 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8944547176361084
Epoch: 18, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.561 Vali Acc: 0.828 Test Loss: 1.561 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0232198238372803
Epoch: 19, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.703 Vali Acc: 0.806 Test Loss: 1.703 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 3014976
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.073707580566406
Epoch: 1, Steps: 8 | Train Loss: 1.876 Vali Loss: 0.912 Vali Acc: 0.775 Test Loss: 0.912 Test Acc: 0.775
Validation loss decreased (inf --> -0.774991).  Saving model ...
Epoch: 2 cost time: 1.3315956592559814
Epoch: 2, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
Validation loss decreased (-0.774991 --> -0.837495).  Saving model ...
Epoch: 3 cost time: 1.7168536186218262
Epoch: 3, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.795 Vali Acc: 0.816 Test Loss: 0.795 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8095958232879639
Epoch: 4, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.772 Vali Acc: 0.838 Test Loss: 0.772 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.929912805557251
Epoch: 5, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.956 Vali Acc: 0.834 Test Loss: 0.956 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7023310661315918
Epoch: 6, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.964 Vali Acc: 0.853 Test Loss: 0.964 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853115).  Saving model ...
Epoch: 7 cost time: 1.7845633029937744
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.339 Vali Acc: 0.816 Test Loss: 1.339 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4539785385131836
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.332 Vali Acc: 0.841 Test Loss: 1.332 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9957983493804932
Epoch: 9, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.480 Vali Acc: 0.841 Test Loss: 1.480 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.10802960395813
Epoch: 10, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.057 Vali Acc: 0.772 Test Loss: 2.057 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8502228260040283
Epoch: 11, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.491 Vali Acc: 0.828 Test Loss: 1.491 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.258129358291626
Epoch: 12, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.563 Vali Acc: 0.809 Test Loss: 1.563 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.754183053970337
Epoch: 13, Steps: 8 | Train Loss: 0.228 Vali Loss: 2.342 Vali Acc: 0.778 Test Loss: 2.342 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7146787643432617
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.998 Vali Acc: 0.847 Test Loss: 1.998 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.672342300415039
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.255 Vali Acc: 0.800 Test Loss: 2.255 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7080204486846924
Epoch: 16, Steps: 8 | Train Loss: 0.048 Vali Loss: 2.277 Vali Acc: 0.809 Test Loss: 2.277 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 1966400
model size : 12.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.485928058624268
Epoch: 1, Steps: 8 | Train Loss: 1.862 Vali Loss: 0.907 Vali Acc: 0.769 Test Loss: 0.907 Test Acc: 0.769
Validation loss decreased (inf --> -0.768741).  Saving model ...
Epoch: 2 cost time: 1.8865807056427002
Epoch: 2, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.768741 --> -0.831245).  Saving model ...
Epoch: 3 cost time: 1.8115932941436768
Epoch: 3, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.785 Vali Acc: 0.812 Test Loss: 0.785 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9454379081726074
Epoch: 4, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.771 Vali Acc: 0.834 Test Loss: 0.771 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834367).  Saving model ...
Epoch: 5 cost time: 1.8954222202301025
Epoch: 5, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.969 Vali Acc: 0.844 Test Loss: 0.969 Test Acc: 0.844
Validation loss decreased (-0.834367 --> -0.843740).  Saving model ...
Epoch: 6 cost time: 1.6474363803863525
Epoch: 6, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.002 Vali Acc: 0.834 Test Loss: 1.002 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6149230003356934
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.360 Vali Acc: 0.809 Test Loss: 1.360 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6608221530914307
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.317 Vali Acc: 0.841 Test Loss: 1.317 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9315502643585205
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.434 Vali Acc: 0.838 Test Loss: 1.434 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.880455732345581
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.391 Vali Acc: 0.825 Test Loss: 1.391 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8978455066680908
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.334 Vali Acc: 0.822 Test Loss: 1.334 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8827743530273438
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.614 Vali Acc: 0.809 Test Loss: 1.614 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8519837856292725
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.679 Vali Acc: 0.809 Test Loss: 1.679 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.110771894454956
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.788 Vali Acc: 0.797 Test Loss: 1.788 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1957709789276123
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.669 Vali Acc: 0.812 Test Loss: 1.669 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1966400
model size : 12.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.136016130447388
Epoch: 1, Steps: 8 | Train Loss: 1.840 Vali Loss: 0.888 Vali Acc: 0.781 Test Loss: 0.888 Test Acc: 0.781
Validation loss decreased (inf --> -0.781241).  Saving model ...
Epoch: 2 cost time: 1.6931984424591064
Epoch: 2, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.781241 --> -0.843745).  Saving model ...
Epoch: 3 cost time: 1.7371530532836914
Epoch: 3, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.764 Vali Acc: 0.819 Test Loss: 0.764 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5623648166656494
Epoch: 4, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.773 Vali Acc: 0.841 Test Loss: 0.773 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.348066806793213
Epoch: 5, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.974 Vali Acc: 0.856 Test Loss: 0.974 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856240).  Saving model ...
Epoch: 6 cost time: 1.79075288772583
Epoch: 6, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.977 Vali Acc: 0.863 Test Loss: 0.977 Test Acc: 0.863
Validation loss decreased (-0.856240 --> -0.862490).  Saving model ...
Epoch: 7 cost time: 1.8258564472198486
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.293 Vali Acc: 0.825 Test Loss: 1.293 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5712566375732422
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.407 Vali Acc: 0.838 Test Loss: 1.407 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8555357456207275
Epoch: 9, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.481 Vali Acc: 0.841 Test Loss: 1.481 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7098205089569092
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.525 Vali Acc: 0.828 Test Loss: 1.525 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9693841934204102
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.346 Vali Acc: 0.838 Test Loss: 1.346 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6110584735870361
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.642 Vali Acc: 0.822 Test Loss: 1.642 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7009696960449219
Epoch: 13, Steps: 8 | Train Loss: 0.043 Vali Loss: 2.048 Vali Acc: 0.787 Test Loss: 2.048 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6258282661437988
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.908 Vali Acc: 0.828 Test Loss: 1.908 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0018885135650635
Epoch: 15, Steps: 8 | Train Loss: 0.029 Vali Loss: 2.169 Vali Acc: 0.812 Test Loss: 2.169 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7927730083465576
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.847 Vali Acc: 0.781 Test Loss: 2.847 Test Acc: 0.781
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1966400
model size : 12.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.838742971420288
Epoch: 1, Steps: 8 | Train Loss: 1.842 Vali Loss: 0.942 Vali Acc: 0.778 Test Loss: 0.942 Test Acc: 0.778
Validation loss decreased (inf --> -0.778116).  Saving model ...
Epoch: 2 cost time: 1.4508154392242432
Epoch: 2, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.778116 --> -0.849995).  Saving model ...
Epoch: 3 cost time: 1.5708937644958496
Epoch: 3, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.701 Vali Acc: 0.816 Test Loss: 0.701 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4801325798034668
Epoch: 4, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.692 Vali Acc: 0.853 Test Loss: 0.692 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853118).  Saving model ...
Epoch: 5 cost time: 1.416872262954712
Epoch: 5, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.936 Vali Acc: 0.856 Test Loss: 0.936 Test Acc: 0.856
Validation loss decreased (-0.853118 --> -0.856241).  Saving model ...
Epoch: 6 cost time: 1.5688230991363525
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.873 Vali Acc: 0.872 Test Loss: 0.873 Test Acc: 0.872
Validation loss decreased (-0.856241 --> -0.871866).  Saving model ...
Epoch: 7 cost time: 1.5770001411437988
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.051 Vali Acc: 0.853 Test Loss: 1.051 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6651694774627686
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.834 Test Loss: 1.279 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8256726264953613
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.272 Vali Acc: 0.844 Test Loss: 1.272 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7984139919281006
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.218 Vali Acc: 0.853 Test Loss: 1.218 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8596737384796143
Epoch: 11, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.118 Vali Acc: 0.853 Test Loss: 1.118 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7959821224212646
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.315 Vali Acc: 0.856 Test Loss: 1.315 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6638178825378418
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.511 Vali Acc: 0.834 Test Loss: 1.511 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8217556476593018
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.568 Vali Acc: 0.838 Test Loss: 1.568 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6512632369995117
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.838 Test Loss: 1.562 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6457738876342773
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.838 Test Loss: 1.509 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1966400
model size : 12.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4134650230407715
Epoch: 1, Steps: 8 | Train Loss: 1.924 Vali Loss: 0.903 Vali Acc: 0.738 Test Loss: 0.903 Test Acc: 0.738
Validation loss decreased (inf --> -0.737491).  Saving model ...
Epoch: 2 cost time: 1.9545555114746094
Epoch: 2, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
Validation loss decreased (-0.737491 --> -0.840620).  Saving model ...
Epoch: 3 cost time: 2.137934446334839
Epoch: 3, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.693 Vali Acc: 0.841 Test Loss: 0.693 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9728286266326904
Epoch: 4, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.754 Vali Acc: 0.844 Test Loss: 0.754 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843742).  Saving model ...
Epoch: 5 cost time: 1.9809441566467285
Epoch: 5, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.047 Vali Acc: 0.819 Test Loss: 1.047 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8033432960510254
Epoch: 6, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.916 Vali Acc: 0.841 Test Loss: 0.916 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6207969188690186
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.965 Vali Acc: 0.834 Test Loss: 0.965 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2260241508483887
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.822 Test Loss: 1.109 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.060187816619873
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.816 Test Loss: 1.162 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.188218593597412
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.164 Vali Acc: 0.822 Test Loss: 1.164 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.064340591430664
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.825 Test Loss: 1.149 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3132214546203613
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.828 Test Loss: 1.137 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1567604541778564
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.831 Test Loss: 1.132 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.251671552658081
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.831 Test Loss: 1.128 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1442112
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.827737331390381
Epoch: 1, Steps: 8 | Train Loss: 1.922 Vali Loss: 0.903 Vali Acc: 0.753 Test Loss: 0.903 Test Acc: 0.753
Validation loss decreased (inf --> -0.753116).  Saving model ...
Epoch: 2 cost time: 1.8502142429351807
Epoch: 2, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
Validation loss decreased (-0.753116 --> -0.837495).  Saving model ...
Epoch: 3 cost time: 1.5339210033416748
Epoch: 3, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.714 Vali Acc: 0.841 Test Loss: 0.714 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840618).  Saving model ...
Epoch: 4 cost time: 1.8947563171386719
Epoch: 4, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.741 Vali Acc: 0.850 Test Loss: 0.741 Test Acc: 0.850
Validation loss decreased (-0.840618 --> -0.849993).  Saving model ...
Epoch: 5 cost time: 1.7224483489990234
Epoch: 5, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.043 Vali Acc: 0.828 Test Loss: 1.043 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1823132038116455
Epoch: 6, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9131977558135986
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.969 Vali Acc: 0.828 Test Loss: 0.969 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.867638111114502
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.825 Test Loss: 1.087 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8418917655944824
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.234 Vali Acc: 0.819 Test Loss: 1.234 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9249236583709717
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.128 Vali Acc: 0.831 Test Loss: 1.128 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9349894523620605
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.080 Vali Acc: 0.847 Test Loss: 1.080 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5524554252624512
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.155 Vali Acc: 0.847 Test Loss: 1.155 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9753539562225342
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.165 Vali Acc: 0.841 Test Loss: 1.165 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8576900959014893
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.838 Test Loss: 1.192 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1442112
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.513683557510376
Epoch: 1, Steps: 8 | Train Loss: 1.921 Vali Loss: 0.890 Vali Acc: 0.762 Test Loss: 0.890 Test Acc: 0.762
Validation loss decreased (inf --> -0.762491).  Saving model ...
Epoch: 2 cost time: 1.594071388244629
Epoch: 2, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
Validation loss decreased (-0.762491 --> -0.843745).  Saving model ...
Epoch: 3 cost time: 1.8238310813903809
Epoch: 3, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.721 Vali Acc: 0.850 Test Loss: 0.721 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849993).  Saving model ...
Epoch: 4 cost time: 1.6385724544525146
Epoch: 4, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.730 Vali Acc: 0.853 Test Loss: 0.730 Test Acc: 0.853
Validation loss decreased (-0.849993 --> -0.853118).  Saving model ...
Epoch: 5 cost time: 1.5792632102966309
Epoch: 5, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.075 Vali Acc: 0.809 Test Loss: 1.075 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7881340980529785
Epoch: 6, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.993 Vali Acc: 0.847 Test Loss: 0.993 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.520157814025879
Epoch: 7, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.939 Vali Acc: 0.856 Test Loss: 0.939 Test Acc: 0.856
Validation loss decreased (-0.853118 --> -0.856241).  Saving model ...
Epoch: 8 cost time: 1.8685872554779053
Epoch: 8, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.116 Vali Acc: 0.834 Test Loss: 1.116 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4538168907165527
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.134 Vali Acc: 0.825 Test Loss: 1.134 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8737397193908691
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.584 Vali Acc: 0.822 Test Loss: 1.584 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0801398754119873
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.519 Vali Acc: 0.787 Test Loss: 1.519 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6356160640716553
Epoch: 12, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.386 Vali Acc: 0.822 Test Loss: 1.386 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8662409782409668
Epoch: 13, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.469 Vali Acc: 0.828 Test Loss: 1.469 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8302443027496338
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.859 Test Loss: 1.398 Test Acc: 0.859
Validation loss decreased (-0.856241 --> -0.859361).  Saving model ...
Epoch: 15 cost time: 2.040496587753296
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.831 Test Loss: 1.547 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0086045265197754
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.694 Vali Acc: 0.853 Test Loss: 1.694 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0563406944274902
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.955 Vali Acc: 0.841 Test Loss: 1.955 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.101118564605713
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.769 Vali Acc: 0.847 Test Loss: 1.769 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8158411979675293
Epoch: 19, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.768 Vali Acc: 0.828 Test Loss: 1.768 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7750542163848877
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.741 Vali Acc: 0.822 Test Loss: 1.741 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7140719890594482
Epoch: 21, Steps: 8 | Train Loss: 0.072 Vali Loss: 2.313 Vali Acc: 0.803 Test Loss: 2.313 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.853062391281128
Epoch: 22, Steps: 8 | Train Loss: 0.113 Vali Loss: 2.570 Vali Acc: 0.806 Test Loss: 2.570 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.015679121017456
Epoch: 23, Steps: 8 | Train Loss: 0.294 Vali Loss: 2.801 Vali Acc: 0.803 Test Loss: 2.801 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.0295190811157227
Epoch: 24, Steps: 8 | Train Loss: 0.232 Vali Loss: 2.824 Vali Acc: 0.828 Test Loss: 2.824 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1442112
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.164100170135498
Epoch: 1, Steps: 8 | Train Loss: 1.992 Vali Loss: 0.945 Vali Acc: 0.784 Test Loss: 0.945 Test Acc: 0.784
Validation loss decreased (inf --> -0.784366).  Saving model ...
Epoch: 2 cost time: 1.6264872550964355
Epoch: 2, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.784366 --> -0.840620).  Saving model ...
Epoch: 3 cost time: 1.318547010421753
Epoch: 3, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.654 Vali Acc: 0.841 Test Loss: 0.654 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6719245910644531
Epoch: 4, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856244).  Saving model ...
Epoch: 5 cost time: 1.604292631149292
Epoch: 5, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.794 Vali Acc: 0.828 Test Loss: 0.794 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.896385908126831
Epoch: 6, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.851 Vali Acc: 0.863 Test Loss: 0.851 Test Acc: 0.863
Validation loss decreased (-0.856244 --> -0.862491).  Saving model ...
Epoch: 7 cost time: 1.9854443073272705
Epoch: 7, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.876 Vali Acc: 0.866 Test Loss: 0.876 Test Acc: 0.866
Validation loss decreased (-0.862491 --> -0.865616).  Saving model ...
Epoch: 8 cost time: 1.738379955291748
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.797 Vali Acc: 0.856 Test Loss: 0.797 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6496262550354004
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.083 Vali Acc: 0.850 Test Loss: 1.083 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9562983512878418
Epoch: 10, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.097 Vali Acc: 0.881 Test Loss: 1.097 Test Acc: 0.881
Validation loss decreased (-0.865616 --> -0.881239).  Saving model ...
Epoch: 11 cost time: 1.6900076866149902
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.831 Test Loss: 1.309 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7559335231781006
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.620 Vali Acc: 0.838 Test Loss: 1.620 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8727366924285889
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.232 Vali Acc: 0.819 Test Loss: 1.232 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7443828582763672
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.284 Vali Acc: 0.847 Test Loss: 1.284 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5609612464904785
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.143 Vali Acc: 0.856 Test Loss: 1.143 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.847658634185791
Epoch: 16, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.308 Vali Acc: 0.859 Test Loss: 1.308 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7273216247558594
Epoch: 17, Steps: 8 | Train Loss: 0.053 Vali Loss: 2.409 Vali Acc: 0.825 Test Loss: 2.409 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9127202033996582
Epoch: 18, Steps: 8 | Train Loss: 0.134 Vali Loss: 2.675 Vali Acc: 0.787 Test Loss: 2.675 Test Acc: 0.787
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5567986965179443
Epoch: 19, Steps: 8 | Train Loss: 0.130 Vali Loss: 2.522 Vali Acc: 0.825 Test Loss: 2.522 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9848408699035645
Epoch: 20, Steps: 8 | Train Loss: 0.127 Vali Loss: 3.033 Vali Acc: 0.825 Test Loss: 3.033 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 1442112
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.589002847671509
Epoch: 1, Steps: 8 | Train Loss: 1.973 Vali Loss: 0.945 Vali Acc: 0.741 Test Loss: 0.945 Test Acc: 0.741
Validation loss decreased (inf --> -0.740616).  Saving model ...
Epoch: 2 cost time: 1.7592229843139648
Epoch: 2, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
Validation loss decreased (-0.740616 --> -0.846870).  Saving model ...
Epoch: 3 cost time: 1.7414169311523438
Epoch: 3, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.666 Vali Acc: 0.844 Test Loss: 0.666 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5929570198059082
Epoch: 4, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.998 Vali Acc: 0.809 Test Loss: 0.998 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8789262771606445
Epoch: 5, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.814 Vali Acc: 0.850 Test Loss: 0.814 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 1.9781031608581543
Epoch: 6, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.163 Vali Acc: 0.831 Test Loss: 1.163 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9643380641937256
Epoch: 7, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.377 Vali Acc: 0.816 Test Loss: 1.377 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6421465873718262
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.239 Vali Acc: 0.831 Test Loss: 1.239 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9756596088409424
Epoch: 9, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.352 Vali Acc: 0.825 Test Loss: 1.352 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0033082962036133
Epoch: 10, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.359 Vali Acc: 0.816 Test Loss: 1.359 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6644771099090576
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.433 Vali Acc: 0.825 Test Loss: 1.433 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1488678455352783
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.493 Vali Acc: 0.834 Test Loss: 1.493 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9683802127838135
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.828 Test Loss: 1.524 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.075087547302246
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.831 Test Loss: 1.520 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9066157341003418
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.831 Test Loss: 1.494 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1179968
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.1053571701049805
Epoch: 1, Steps: 8 | Train Loss: 1.974 Vali Loss: 0.941 Vali Acc: 0.738 Test Loss: 0.941 Test Acc: 0.738
Validation loss decreased (inf --> -0.737491).  Saving model ...
Epoch: 2 cost time: 2.081904411315918
Epoch: 2, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
Validation loss decreased (-0.737491 --> -0.834370).  Saving model ...
Epoch: 3 cost time: 1.5706837177276611
Epoch: 3, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.656 Vali Acc: 0.847 Test Loss: 0.656 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846868).  Saving model ...
Epoch: 4 cost time: 1.8541107177734375
Epoch: 4, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.028 Vali Acc: 0.812 Test Loss: 1.028 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.037581205368042
Epoch: 5, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.808 Vali Acc: 0.844 Test Loss: 0.808 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9503889083862305
Epoch: 6, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.149 Vali Acc: 0.838 Test Loss: 1.149 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5998148918151855
Epoch: 7, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.283 Vali Acc: 0.834 Test Loss: 1.283 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6577367782592773
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.351 Vali Acc: 0.819 Test Loss: 1.351 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.695272445678711
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.745 Vali Acc: 0.812 Test Loss: 1.745 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9291491508483887
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.483 Vali Acc: 0.819 Test Loss: 1.483 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.831913709640503
Epoch: 11, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.500 Vali Acc: 0.828 Test Loss: 1.500 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9687037467956543
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.825 Test Loss: 1.603 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7303390502929688
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.838 Test Loss: 1.641 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 1179968
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.276477575302124
Epoch: 1, Steps: 8 | Train Loss: 1.949 Vali Loss: 0.929 Vali Acc: 0.781 Test Loss: 0.929 Test Acc: 0.781
Validation loss decreased (inf --> -0.781241).  Saving model ...
Epoch: 2 cost time: 1.8673803806304932
Epoch: 2, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
Validation loss decreased (-0.781241 --> -0.837495).  Saving model ...
Epoch: 3 cost time: 1.8726110458374023
Epoch: 3, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849994).  Saving model ...
Epoch: 4 cost time: 1.8544700145721436
Epoch: 4, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.038 Vali Acc: 0.825 Test Loss: 1.038 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.92922043800354
Epoch: 5, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.797 Vali Acc: 0.847 Test Loss: 0.797 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.836134672164917
Epoch: 6, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.949 Vali Acc: 0.853 Test Loss: 0.949 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853116).  Saving model ...
Epoch: 7 cost time: 1.8564927577972412
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.167 Vali Acc: 0.856 Test Loss: 1.167 Test Acc: 0.856
Validation loss decreased (-0.853116 --> -0.856238).  Saving model ...
Epoch: 8 cost time: 1.8907701969146729
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.126 Vali Acc: 0.844 Test Loss: 1.126 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7024919986724854
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.207 Vali Acc: 0.841 Test Loss: 1.207 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.839097499847412
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.844 Test Loss: 1.284 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6085608005523682
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.847 Test Loss: 1.344 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.610959529876709
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.853 Test Loss: 1.360 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4485883712768555
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.856 Test Loss: 1.331 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8089759349822998
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.856 Test Loss: 1.315 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7702736854553223
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.863 Test Loss: 1.302 Test Acc: 0.863
Validation loss decreased (-0.856238 --> -0.862487).  Saving model ...
Epoch: 16 cost time: 1.5238053798675537
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.863 Test Loss: 1.297 Test Acc: 0.863
Validation loss decreased (-0.862487 --> -0.862487).  Saving model ...
Epoch: 17 cost time: 1.6623938083648682
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.859 Test Loss: 1.295 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6883549690246582
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.859 Test Loss: 1.295 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8337647914886475
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.296 Vali Acc: 0.859 Test Loss: 1.296 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8511226177215576
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.859 Test Loss: 1.297 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0192389488220215
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.859 Test Loss: 1.295 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7878382205963135
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.293 Vali Acc: 0.859 Test Loss: 1.293 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9151465892791748
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.859 Test Loss: 1.292 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9151625633239746
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.859 Test Loss: 1.291 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.0813710689544678
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.859 Test Loss: 1.291 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9427342414855957
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.859 Test Loss: 1.289 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1179968
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.926835536956787
Epoch: 1, Steps: 8 | Train Loss: 1.902 Vali Loss: 0.953 Vali Acc: 0.769 Test Loss: 0.953 Test Acc: 0.769
Validation loss decreased (inf --> -0.768740).  Saving model ...
Epoch: 2 cost time: 1.6407825946807861
Epoch: 2, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
Validation loss decreased (-0.768740 --> -0.856245).  Saving model ...
Epoch: 3 cost time: 1.6206905841827393
Epoch: 3, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.643 Vali Acc: 0.838 Test Loss: 0.643 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.817335605621338
Epoch: 4, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.919 Vali Acc: 0.825 Test Loss: 0.919 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5513830184936523
Epoch: 5, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.710 Vali Acc: 0.859 Test Loss: 0.710 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859368).  Saving model ...
Epoch: 6 cost time: 1.577942132949829
Epoch: 6, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.982 Vali Acc: 0.856 Test Loss: 0.982 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5929079055786133
Epoch: 7, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.205 Vali Acc: 0.825 Test Loss: 1.205 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.55015230178833
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.047 Vali Acc: 0.831 Test Loss: 1.047 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7572541236877441
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.383 Vali Acc: 0.850 Test Loss: 1.383 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.835111379623413
Epoch: 10, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.396 Vali Acc: 0.844 Test Loss: 1.396 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7121901512145996
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.242 Vali Acc: 0.872 Test Loss: 1.242 Test Acc: 0.872
Validation loss decreased (-0.859368 --> -0.871863).  Saving model ...
Epoch: 12 cost time: 1.6445119380950928
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.334 Vali Acc: 0.853 Test Loss: 1.334 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.438429832458496
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.822 Vali Acc: 0.828 Test Loss: 1.822 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4565181732177734
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.085 Vali Acc: 0.809 Test Loss: 2.085 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5138626098632812
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.792 Vali Acc: 0.850 Test Loss: 1.792 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4742591381072998
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.792 Vali Acc: 0.847 Test Loss: 1.792 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6731204986572266
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.727 Vali Acc: 0.850 Test Loss: 1.727 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.677830696105957
Epoch: 18, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.923 Vali Acc: 0.828 Test Loss: 1.923 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7340826988220215
Epoch: 19, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.905 Vali Acc: 0.831 Test Loss: 1.905 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.666283130645752
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.853 Vali Acc: 0.841 Test Loss: 1.853 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3897247314453125
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.977 Vali Acc: 0.828 Test Loss: 1.977 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1179968
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.20750617980957
Epoch: 1, Steps: 8 | Train Loss: 1.930 Vali Loss: 0.902 Vali Acc: 0.797 Test Loss: 0.902 Test Acc: 0.797
Validation loss decreased (inf --> -0.796866).  Saving model ...
Epoch: 2 cost time: 1.8615453243255615
Epoch: 2, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
Validation loss decreased (-0.796866 --> -0.831245).  Saving model ...
Epoch: 3 cost time: 1.8126461505889893
Epoch: 3, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.693 Vali Acc: 0.863 Test Loss: 0.693 Test Acc: 0.863
Validation loss decreased (-0.831245 --> -0.862493).  Saving model ...
Epoch: 4 cost time: 1.8857274055480957
Epoch: 4, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.865 Vali Acc: 0.838 Test Loss: 0.865 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7578940391540527
Epoch: 5, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.822 Vali Acc: 0.841 Test Loss: 0.822 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8331401348114014
Epoch: 6, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.085 Vali Acc: 0.819 Test Loss: 1.085 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.767427921295166
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.114 Vali Acc: 0.841 Test Loss: 1.114 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5182685852050781
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.159 Vali Acc: 0.850 Test Loss: 1.159 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8257668018341064
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.151 Vali Acc: 0.856 Test Loss: 1.151 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3333194255828857
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.850 Test Loss: 1.169 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.691188097000122
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.850 Test Loss: 1.184 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5867464542388916
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.847 Test Loss: 1.198 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.625563621520996
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.847 Test Loss: 1.210 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1048896
model size : 8.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9066169261932373
Epoch: 1, Steps: 8 | Train Loss: 1.929 Vali Loss: 0.904 Vali Acc: 0.784 Test Loss: 0.904 Test Acc: 0.784
Validation loss decreased (inf --> -0.784366).  Saving model ...
Epoch: 2 cost time: 1.7751038074493408
Epoch: 2, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
Validation loss decreased (-0.784366 --> -0.831245).  Saving model ...
Epoch: 3 cost time: 1.9175848960876465
Epoch: 3, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.713 Vali Acc: 0.853 Test Loss: 0.713 Test Acc: 0.853
Validation loss decreased (-0.831245 --> -0.853118).  Saving model ...
Epoch: 4 cost time: 1.7505466938018799
Epoch: 4, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.872 Vali Acc: 0.838 Test Loss: 0.872 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5898685455322266
Epoch: 5, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.809 Vali Acc: 0.853 Test Loss: 0.809 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9573850631713867
Epoch: 6, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.114 Vali Acc: 0.819 Test Loss: 1.114 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7429373264312744
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.147 Vali Acc: 0.828 Test Loss: 1.147 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.018024206161499
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.024 Vali Acc: 0.856 Test Loss: 1.024 Test Acc: 0.856
Validation loss decreased (-0.853118 --> -0.856240).  Saving model ...
Epoch: 9 cost time: 2.0305521488189697
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.866 Test Loss: 1.104 Test Acc: 0.866
Validation loss decreased (-0.856240 --> -0.865614).  Saving model ...
Epoch: 10 cost time: 1.929628610610962
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.226 Vali Acc: 0.844 Test Loss: 1.226 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1937055587768555
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.193 Vali Acc: 0.850 Test Loss: 1.193 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0709846019744873
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.859 Test Loss: 1.165 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1464595794677734
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.872 Test Loss: 1.167 Test Acc: 0.872
Validation loss decreased (-0.865614 --> -0.871863).  Saving model ...
Epoch: 14 cost time: 1.6837942600250244
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.859 Test Loss: 1.184 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1642510890960693
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.853 Test Loss: 1.203 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2561378479003906
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.856 Test Loss: 1.212 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8967504501342773
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.856 Test Loss: 1.214 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1023752689361572
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.856 Test Loss: 1.212 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.025399684906006
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.856 Test Loss: 1.210 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9670140743255615
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.856 Test Loss: 1.208 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8824336528778076
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.859 Test Loss: 1.201 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.908231496810913
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.856 Test Loss: 1.195 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6702680587768555
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.859 Test Loss: 1.191 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1048896
model size : 8.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.765256404876709
Epoch: 1, Steps: 8 | Train Loss: 1.910 Vali Loss: 0.894 Vali Acc: 0.797 Test Loss: 0.894 Test Acc: 0.797
Validation loss decreased (inf --> -0.796866).  Saving model ...
Epoch: 2 cost time: 1.5316619873046875
Epoch: 2, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
Validation loss decreased (-0.796866 --> -0.837495).  Saving model ...
Epoch: 3 cost time: 1.7021434307098389
Epoch: 3, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.703 Vali Acc: 0.869 Test Loss: 0.703 Test Acc: 0.869
Validation loss decreased (-0.837495 --> -0.868743).  Saving model ...
Epoch: 4 cost time: 1.8185820579528809
Epoch: 4, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.868 Vali Acc: 0.841 Test Loss: 0.868 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6100387573242188
Epoch: 5, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.811 Vali Acc: 0.844 Test Loss: 0.811 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.644425868988037
Epoch: 6, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.192 Vali Acc: 0.819 Test Loss: 1.192 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7297184467315674
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.161 Vali Acc: 0.841 Test Loss: 1.161 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.582113265991211
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.439 Vali Acc: 0.828 Test Loss: 1.439 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7882447242736816
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.401 Vali Acc: 0.825 Test Loss: 1.401 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7163076400756836
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.433 Vali Acc: 0.831 Test Loss: 1.433 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.804166316986084
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.445 Vali Acc: 0.834 Test Loss: 1.445 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.746297836303711
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.309 Vali Acc: 0.863 Test Loss: 1.309 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7102644443511963
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.302 Vali Acc: 0.872 Test Loss: 1.302 Test Acc: 0.872
Validation loss decreased (-0.868743 --> -0.871862).  Saving model ...
Epoch: 14 cost time: 1.6186213493347168
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.869 Test Loss: 1.338 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6076996326446533
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.340 Vali Acc: 0.878 Test Loss: 1.340 Test Acc: 0.878
Validation loss decreased (-0.871862 --> -0.878112).  Saving model ...
Epoch: 16 cost time: 1.333881139755249
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.853 Test Loss: 1.544 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5193002223968506
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.668 Vali Acc: 0.844 Test Loss: 1.668 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7412171363830566
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.364 Vali Acc: 0.869 Test Loss: 1.364 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8332195281982422
Epoch: 19, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.398 Vali Acc: 0.869 Test Loss: 1.398 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7501246929168701
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.653 Vali Acc: 0.841 Test Loss: 1.653 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6589808464050293
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.877 Vali Acc: 0.831 Test Loss: 1.877 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.800889253616333
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.841 Test Loss: 1.840 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7028067111968994
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.844 Test Loss: 1.804 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8345434665679932
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.844 Test Loss: 1.801 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8483905792236328
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.847 Test Loss: 1.801 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 1048896
model size : 8.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.204503059387207
Epoch: 1, Steps: 8 | Train Loss: 1.863 Vali Loss: 0.943 Vali Acc: 0.775 Test Loss: 0.943 Test Acc: 0.775
Validation loss decreased (inf --> -0.774991).  Saving model ...
Epoch: 2 cost time: 1.5252931118011475
Epoch: 2, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824995).  Saving model ...
Epoch: 3 cost time: 1.6634628772735596
Epoch: 3, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.636 Vali Acc: 0.863 Test Loss: 0.636 Test Acc: 0.863
Validation loss decreased (-0.824995 --> -0.862494).  Saving model ...
Epoch: 4 cost time: 1.4392969608306885
Epoch: 4, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.793 Vali Acc: 0.831 Test Loss: 0.793 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4724822044372559
Epoch: 5, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.763 Vali Acc: 0.863 Test Loss: 0.763 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3310887813568115
Epoch: 6, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.100 Vali Acc: 0.838 Test Loss: 1.100 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6303775310516357
Epoch: 7, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.922 Vali Acc: 0.844 Test Loss: 0.922 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.419605016708374
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.208 Vali Acc: 0.850 Test Loss: 1.208 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7417538166046143
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.336 Vali Acc: 0.853 Test Loss: 1.336 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.709191083908081
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.227 Vali Acc: 0.878 Test Loss: 1.227 Test Acc: 0.878
Validation loss decreased (-0.862494 --> -0.878113).  Saving model ...
Epoch: 11 cost time: 1.5626213550567627
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.225 Vali Acc: 0.881 Test Loss: 1.225 Test Acc: 0.881
Validation loss decreased (-0.878113 --> -0.881238).  Saving model ...
Epoch: 12 cost time: 1.7655096054077148
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.286 Vali Acc: 0.859 Test Loss: 1.286 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6591885089874268
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.856 Test Loss: 1.325 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5253300666809082
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.856 Test Loss: 1.332 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7182936668395996
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.863 Test Loss: 1.326 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3508179187774658
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.866 Test Loss: 1.315 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.659045934677124
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.869 Test Loss: 1.292 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5671055316925049
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.869 Test Loss: 1.273 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5350971221923828
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.872 Test Loss: 1.263 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.551213026046753
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.869 Test Loss: 1.258 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4887056350708008
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.872 Test Loss: 1.254 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 1048896
model size : 8.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4079344272613525
Epoch: 1, Steps: 8 | Train Loss: 1.836 Vali Loss: 0.910 Vali Acc: 0.753 Test Loss: 0.910 Test Acc: 0.753
Validation loss decreased (inf --> -0.753116).  Saving model ...
Epoch: 2 cost time: 1.7223045825958252
Epoch: 2, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.753116 --> -0.843745).  Saving model ...
Epoch: 3 cost time: 1.6529021263122559
Epoch: 3, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849993).  Saving model ...
Epoch: 4 cost time: 1.7912802696228027
Epoch: 4, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.897 Vali Acc: 0.838 Test Loss: 0.897 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.832808256149292
Epoch: 5, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.870 Vali Acc: 0.831 Test Loss: 0.870 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8233163356781006
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.880 Vali Acc: 0.853 Test Loss: 0.880 Test Acc: 0.853
Validation loss decreased (-0.849993 --> -0.853116).  Saving model ...
Epoch: 7 cost time: 1.7456638813018799
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.838 Test Loss: 0.947 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8444998264312744
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.062 Vali Acc: 0.831 Test Loss: 1.062 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.891021966934204
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.831 Test Loss: 1.127 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6724014282226562
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.145 Vali Acc: 0.838 Test Loss: 1.145 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7962074279785156
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.841 Test Loss: 1.139 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.741776943206787
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.838 Test Loss: 1.128 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7380812168121338
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.117 Vali Acc: 0.838 Test Loss: 1.117 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7605617046356201
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.841 Test Loss: 1.109 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7733778953552246
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.106 Vali Acc: 0.841 Test Loss: 1.106 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8550398349761963
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.841 Test Loss: 1.104 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 983360
model size : 8.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8969621658325195
Epoch: 1, Steps: 8 | Train Loss: 1.833 Vali Loss: 0.895 Vali Acc: 0.744 Test Loss: 0.895 Test Acc: 0.744
Validation loss decreased (inf --> -0.743741).  Saving model ...
Epoch: 2 cost time: 1.6804888248443604
Epoch: 2, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
Validation loss decreased (-0.743741 --> -0.856245).  Saving model ...
Epoch: 3 cost time: 1.5928428173065186
Epoch: 3, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7970974445343018
Epoch: 4, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.919 Vali Acc: 0.831 Test Loss: 0.919 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.742725133895874
Epoch: 5, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.850 Vali Acc: 0.844 Test Loss: 0.850 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.696441650390625
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.869 Vali Acc: 0.841 Test Loss: 0.869 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6704134941101074
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.863 Test Loss: 0.973 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862490).  Saving model ...
Epoch: 8 cost time: 1.9667046070098877
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.841 Test Loss: 1.091 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8329064846038818
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.154 Vali Acc: 0.834 Test Loss: 1.154 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4129292964935303
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.251 Vali Acc: 0.828 Test Loss: 1.251 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7489430904388428
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.111 Vali Acc: 0.831 Test Loss: 1.111 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.92012357711792
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.844 Test Loss: 1.077 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4482202529907227
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.088 Vali Acc: 0.850 Test Loss: 1.088 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.751460075378418
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.853 Test Loss: 1.087 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.841508150100708
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.844 Test Loss: 1.096 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8577568531036377
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.841 Test Loss: 1.113 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5635972023010254
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.841 Test Loss: 1.125 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 983360
model size : 8.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.494464159011841
Epoch: 1, Steps: 8 | Train Loss: 1.811 Vali Loss: 0.886 Vali Acc: 0.753 Test Loss: 0.886 Test Acc: 0.753
Validation loss decreased (inf --> -0.753116).  Saving model ...
Epoch: 2 cost time: 1.4636046886444092
Epoch: 2, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.516 Vali Acc: 0.859 Test Loss: 0.516 Test Acc: 0.859
Validation loss decreased (-0.753116 --> -0.859370).  Saving model ...
Epoch: 3 cost time: 1.3774971961975098
Epoch: 3, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9389562606811523
Epoch: 4, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.929 Vali Acc: 0.834 Test Loss: 0.929 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.620253562927246
Epoch: 5, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.796 Vali Acc: 0.866 Test Loss: 0.796 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865617).  Saving model ...
Epoch: 6 cost time: 1.847461223602295
Epoch: 6, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.846 Vali Acc: 0.856 Test Loss: 0.846 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8136703968048096
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.930 Vali Acc: 0.844 Test Loss: 0.930 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7707936763763428
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.951 Vali Acc: 0.831 Test Loss: 0.951 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.615339994430542
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.869 Test Loss: 0.899 Test Acc: 0.869
Validation loss decreased (-0.865617 --> -0.868741).  Saving model ...
Epoch: 10 cost time: 1.6975431442260742
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.084 Vali Acc: 0.853 Test Loss: 1.084 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7181661128997803
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.124 Vali Acc: 0.847 Test Loss: 1.124 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6201684474945068
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.154 Vali Acc: 0.850 Test Loss: 1.154 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7841265201568604
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.300 Vali Acc: 0.831 Test Loss: 1.300 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3791790008544922
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.202 Vali Acc: 0.869 Test Loss: 1.202 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.99458646774292
Epoch: 15, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.677 Vali Acc: 0.819 Test Loss: 1.677 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7116386890411377
Epoch: 16, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.574 Vali Acc: 0.838 Test Loss: 1.574 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6950452327728271
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.641 Vali Acc: 0.825 Test Loss: 1.641 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7619225978851318
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.750 Vali Acc: 0.822 Test Loss: 1.750 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7830581665039062
Epoch: 19, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.764 Vali Acc: 0.838 Test Loss: 1.764 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 983360
model size : 8.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.037215232849121
Epoch: 1, Steps: 8 | Train Loss: 1.809 Vali Loss: 0.918 Vali Acc: 0.769 Test Loss: 0.918 Test Acc: 0.769
Validation loss decreased (inf --> -0.768741).  Saving model ...
Epoch: 2 cost time: 1.4272878170013428
Epoch: 2, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
Validation loss decreased (-0.768741 --> -0.856245).  Saving model ...
Epoch: 3 cost time: 1.4522573947906494
Epoch: 3, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.643 Vali Acc: 0.831 Test Loss: 0.643 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6171526908874512
Epoch: 4, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.841 Vali Acc: 0.834 Test Loss: 0.841 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5432896614074707
Epoch: 5, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.772 Vali Acc: 0.863 Test Loss: 0.772 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862492).  Saving model ...
Epoch: 6 cost time: 1.4291291236877441
Epoch: 6, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.850 Vali Acc: 0.853 Test Loss: 0.850 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5767557621002197
Epoch: 7, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.879 Vali Acc: 0.847 Test Loss: 0.879 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4379820823669434
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.880 Vali Acc: 0.866 Test Loss: 0.880 Test Acc: 0.866
Validation loss decreased (-0.862492 --> -0.865616).  Saving model ...
Epoch: 9 cost time: 1.5033130645751953
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.885 Vali Acc: 0.863 Test Loss: 0.885 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6836440563201904
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.873 Vali Acc: 0.887 Test Loss: 0.873 Test Acc: 0.887
Validation loss decreased (-0.865616 --> -0.887491).  Saving model ...
Epoch: 11 cost time: 1.4614124298095703
Epoch: 11, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.977 Vali Acc: 0.859 Test Loss: 0.977 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6356580257415771
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.292 Vali Acc: 0.847 Test Loss: 1.292 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5579252243041992
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.287 Vali Acc: 0.859 Test Loss: 1.287 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.692664623260498
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.863 Test Loss: 1.328 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6710121631622314
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.869 Test Loss: 1.329 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7520363330841064
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.875 Test Loss: 1.294 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5792641639709473
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.881 Test Loss: 1.263 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.508016586303711
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.881 Test Loss: 1.244 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5355541706085205
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.881 Test Loss: 1.236 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5878417491912842
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.881 Test Loss: 1.235 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8875
model parameter : 983360
model size : 8.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.869361639022827
Epoch: 1, Steps: 8 | Train Loss: 2.027 Vali Loss: 1.277 Vali Acc: 0.697 Test Loss: 1.277 Test Acc: 0.697
Validation loss decreased (inf --> -0.696862).  Saving model ...
Epoch: 2 cost time: 1.8242793083190918
Epoch: 2, Steps: 8 | Train Loss: 0.818 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
Validation loss decreased (-0.696862 --> -0.812494).  Saving model ...
Epoch: 3 cost time: 1.7081868648529053
Epoch: 3, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.557 Vali Acc: 0.841 Test Loss: 0.557 Test Acc: 0.841
Validation loss decreased (-0.812494 --> -0.840619).  Saving model ...
Epoch: 4 cost time: 1.738736629486084
Epoch: 4, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 1.803598403930664
Epoch: 5, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.708 Vali Acc: 0.841 Test Loss: 0.708 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.703824758529663
Epoch: 6, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.807 Vali Acc: 0.816 Test Loss: 0.807 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8018066883087158
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.866 Vali Acc: 0.825 Test Loss: 0.866 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7010276317596436
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.902 Vali Acc: 0.819 Test Loss: 0.902 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4547297954559326
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.889 Vali Acc: 0.822 Test Loss: 0.889 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.553398847579956
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.843 Vali Acc: 0.834 Test Loss: 0.843 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6324515342712402
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.834 Test Loss: 0.844 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5330939292907715
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.831 Test Loss: 0.863 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8940927982330322
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.834 Test Loss: 0.877 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6810886859893799
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.834 Test Loss: 0.891 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1441984
model size : 7.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7873330116271973
Epoch: 1, Steps: 8 | Train Loss: 1.995 Vali Loss: 1.259 Vali Acc: 0.697 Test Loss: 1.259 Test Acc: 0.697
Validation loss decreased (inf --> -0.696862).  Saving model ...
Epoch: 2 cost time: 1.5500166416168213
Epoch: 2, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
Validation loss decreased (-0.696862 --> -0.824995).  Saving model ...
Epoch: 3 cost time: 1.3999202251434326
Epoch: 3, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 1.6294496059417725
Epoch: 4, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.544 Vali Acc: 0.866 Test Loss: 0.544 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865620).  Saving model ...
Epoch: 5 cost time: 1.3776249885559082
Epoch: 5, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.698 Vali Acc: 0.834 Test Loss: 0.698 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6710388660430908
Epoch: 6, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4810128211975098
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.821 Vali Acc: 0.831 Test Loss: 0.821 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.415811538696289
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.865 Vali Acc: 0.825 Test Loss: 0.865 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3105974197387695
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.869 Vali Acc: 0.822 Test Loss: 0.869 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5101358890533447
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.831 Test Loss: 0.843 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6412937641143799
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.831 Test Loss: 0.837 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4593842029571533
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.831 Test Loss: 0.840 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5957551002502441
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.831 Test Loss: 0.842 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.758216381072998
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.834 Test Loss: 0.845 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 1441984
model size : 7.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.421025276184082
Epoch: 1, Steps: 8 | Train Loss: 1.965 Vali Loss: 1.251 Vali Acc: 0.719 Test Loss: 1.251 Test Acc: 0.719
Validation loss decreased (inf --> -0.718737).  Saving model ...
Epoch: 2 cost time: 1.5824663639068604
Epoch: 2, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
Validation loss decreased (-0.718737 --> -0.831245).  Saving model ...
Epoch: 3 cost time: 1.4274015426635742
Epoch: 3, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.831245 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 1.7455048561096191
Epoch: 4, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.524 Vali Acc: 0.866 Test Loss: 0.524 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865620).  Saving model ...
Epoch: 5 cost time: 1.5143957138061523
Epoch: 5, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.663 Vali Acc: 0.847 Test Loss: 0.663 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6659486293792725
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.735 Vali Acc: 0.831 Test Loss: 0.735 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.630033254623413
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.769 Vali Acc: 0.841 Test Loss: 0.769 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.500997543334961
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.838 Test Loss: 0.800 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6309170722961426
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.819037914276123
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.847 Test Loss: 0.786 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8465452194213867
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.847 Test Loss: 0.777 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4200468063354492
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.853 Test Loss: 0.779 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.769939661026001
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.863 Test Loss: 0.780 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5866122245788574
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.863 Test Loss: 0.783 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 1441984
model size : 7.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8022525310516357
Epoch: 1, Steps: 8 | Train Loss: 1.984 Vali Loss: 1.300 Vali Acc: 0.703 Test Loss: 1.300 Test Acc: 0.703
Validation loss decreased (inf --> -0.703112).  Saving model ...
Epoch: 2 cost time: 1.436798334121704
Epoch: 2, Steps: 8 | Train Loss: 0.867 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
Validation loss decreased (-0.703112 --> -0.831245).  Saving model ...
Epoch: 3 cost time: 1.4186692237854004
Epoch: 3, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 4 cost time: 1.6008245944976807
Epoch: 4, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.479 Vali Acc: 0.881 Test Loss: 0.479 Test Acc: 0.881
Validation loss decreased (-0.840620 --> -0.881245).  Saving model ...
Epoch: 5 cost time: 1.481222152709961
Epoch: 5, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.631 Vali Acc: 0.834 Test Loss: 0.631 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3179352283477783
Epoch: 6, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.693 Vali Acc: 0.841 Test Loss: 0.693 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4323451519012451
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.706 Vali Acc: 0.856 Test Loss: 0.706 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5600106716156006
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.707 Vali Acc: 0.869 Test Loss: 0.707 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4714696407318115
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.872 Test Loss: 0.710 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3090598583221436
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.875 Test Loss: 0.724 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2911875247955322
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.875 Test Loss: 0.723 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3171679973602295
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.869 Test Loss: 0.719 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3792691230773926
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.872 Test Loss: 0.709 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3458092212677002
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.881 Test Loss: 0.708 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 1441984
model size : 7.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.900186538696289
Epoch: 1, Steps: 8 | Train Loss: 2.208 Vali Loss: 1.392 Vali Acc: 0.588 Test Loss: 1.392 Test Acc: 0.588
Validation loss decreased (inf --> -0.587486).  Saving model ...
Epoch: 2 cost time: 1.4000520706176758
Epoch: 2, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
Validation loss decreased (-0.587486 --> -0.821869).  Saving model ...
Epoch: 3 cost time: 1.6579627990722656
Epoch: 3, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.531 Vali Acc: 0.853 Test Loss: 0.531 Test Acc: 0.853
Validation loss decreased (-0.821869 --> -0.853120).  Saving model ...
Epoch: 4 cost time: 1.5367915630340576
Epoch: 4, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2804317474365234
Epoch: 5, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3877489566802979
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.743 Vali Acc: 0.834 Test Loss: 0.743 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6403274536132812
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.799 Vali Acc: 0.831 Test Loss: 0.799 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.387894868850708
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.811 Vali Acc: 0.838 Test Loss: 0.811 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4836759567260742
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.831 Test Loss: 0.863 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6312720775604248
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.825 Test Loss: 0.926 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.540055274963379
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.822 Test Loss: 0.917 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4786784648895264
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.831 Test Loss: 0.905 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6302027702331543
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.904 Vali Acc: 0.831 Test Loss: 0.904 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 917696
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.37473726272583
Epoch: 1, Steps: 8 | Train Loss: 2.208 Vali Loss: 1.388 Vali Acc: 0.600 Test Loss: 1.388 Test Acc: 0.600
Validation loss decreased (inf --> -0.599986).  Saving model ...
Epoch: 2 cost time: 1.38496732711792
Epoch: 2, Steps: 8 | Train Loss: 0.872 Vali Loss: 0.563 Vali Acc: 0.831 Test Loss: 0.563 Test Acc: 0.831
Validation loss decreased (-0.599986 --> -0.831244).  Saving model ...
Epoch: 3 cost time: 1.3765666484832764
Epoch: 3, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.527 Vali Acc: 0.859 Test Loss: 0.527 Test Acc: 0.859
Validation loss decreased (-0.831244 --> -0.859370).  Saving model ...
Epoch: 4 cost time: 1.603813648223877
Epoch: 4, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.617 Vali Acc: 0.847 Test Loss: 0.617 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.444845199584961
Epoch: 5, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.677 Vali Acc: 0.847 Test Loss: 0.677 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.363809585571289
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.733 Vali Acc: 0.838 Test Loss: 0.733 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2313644886016846
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.802 Vali Acc: 0.834 Test Loss: 0.802 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2301597595214844
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.834 Test Loss: 0.795 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3842747211456299
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3727190494537354
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.919 Vali Acc: 0.825 Test Loss: 0.919 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7497644424438477
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.941 Vali Acc: 0.825 Test Loss: 0.941 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.491182565689087
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.922 Vali Acc: 0.828 Test Loss: 0.922 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7347311973571777
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.909 Vali Acc: 0.828 Test Loss: 0.909 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 917696
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7362096309661865
Epoch: 1, Steps: 8 | Train Loss: 2.163 Vali Loss: 1.381 Vali Acc: 0.613 Test Loss: 1.381 Test Acc: 0.613
Validation loss decreased (inf --> -0.612486).  Saving model ...
Epoch: 2 cost time: 1.4892375469207764
Epoch: 2, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
Validation loss decreased (-0.612486 --> -0.828120).  Saving model ...
Epoch: 3 cost time: 1.5405125617980957
Epoch: 3, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.500 Vali Acc: 0.863 Test Loss: 0.500 Test Acc: 0.863
Validation loss decreased (-0.828120 --> -0.862495).  Saving model ...
Epoch: 4 cost time: 1.5187311172485352
Epoch: 4, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.579 Vali Acc: 0.859 Test Loss: 0.579 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5807108879089355
Epoch: 5, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.631 Vali Acc: 0.853 Test Loss: 0.631 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6580007076263428
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.692 Vali Acc: 0.838 Test Loss: 0.692 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.248114824295044
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.703 Vali Acc: 0.853 Test Loss: 0.703 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7323641777038574
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.736 Vali Acc: 0.859 Test Loss: 0.736 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.461139440536499
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.761 Vali Acc: 0.856 Test Loss: 0.761 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.596954107284546
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.853 Test Loss: 0.841 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5477502346038818
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.850 Test Loss: 0.860 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.421766757965088
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.844 Test Loss: 0.838 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6436705589294434
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.844 Test Loss: 0.829 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 917696
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4156060218811035
Epoch: 1, Steps: 8 | Train Loss: 2.128 Vali Loss: 1.388 Vali Acc: 0.600 Test Loss: 1.388 Test Acc: 0.600
Validation loss decreased (inf --> -0.599986).  Saving model ...
Epoch: 2 cost time: 1.2118618488311768
Epoch: 2, Steps: 8 | Train Loss: 0.916 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
Validation loss decreased (-0.599986 --> -0.818744).  Saving model ...
Epoch: 3 cost time: 1.4253129959106445
Epoch: 3, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.487 Vali Acc: 0.863 Test Loss: 0.487 Test Acc: 0.863
Validation loss decreased (-0.818744 --> -0.862495).  Saving model ...
Epoch: 4 cost time: 1.2274811267852783
Epoch: 4, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.589 Vali Acc: 0.847 Test Loss: 0.589 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.248694896697998
Epoch: 5, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.563 Vali Acc: 0.863 Test Loss: 0.563 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3326706886291504
Epoch: 6, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2060189247131348
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.646 Vali Acc: 0.869 Test Loss: 0.646 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868744).  Saving model ...
Epoch: 8 cost time: 1.376661777496338
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.869 Test Loss: 0.681 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.510401964187622
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.703 Vali Acc: 0.859 Test Loss: 0.703 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.542529821395874
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.856 Test Loss: 0.813 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4249510765075684
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.796 Vali Acc: 0.859 Test Loss: 0.796 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5669965744018555
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.863 Test Loss: 0.771 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5705912113189697
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.866 Test Loss: 0.776 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.591048002243042
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.863 Test Loss: 0.791 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.253239393234253
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.863 Test Loss: 0.797 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3584084510803223
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.804 Vali Acc: 0.869 Test Loss: 0.804 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4730534553527832
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.869 Test Loss: 0.803 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 917696
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8653972148895264
Epoch: 1, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.258 Vali Acc: 0.684 Test Loss: 1.258 Test Acc: 0.684
Validation loss decreased (inf --> -0.684362).  Saving model ...
Epoch: 2 cost time: 1.6930232048034668
Epoch: 2, Steps: 8 | Train Loss: 0.793 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
Validation loss decreased (-0.684362 --> -0.815619).  Saving model ...
Epoch: 3 cost time: 1.6022531986236572
Epoch: 3, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
Validation loss decreased (-0.815619 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 1.5092463493347168
Epoch: 4, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.612 Vali Acc: 0.847 Test Loss: 0.612 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7121169567108154
Epoch: 5, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.586010217666626
Epoch: 6, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.738 Vali Acc: 0.841 Test Loss: 0.738 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6247448921203613
Epoch: 7, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.776 Vali Acc: 0.847 Test Loss: 0.776 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5820930004119873
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.854 Vali Acc: 0.812 Test Loss: 0.854 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.335923671722412
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.951 Vali Acc: 0.806 Test Loss: 0.951 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5659778118133545
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.946 Vali Acc: 0.822 Test Loss: 0.946 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.481694221496582
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.897 Vali Acc: 0.828 Test Loss: 0.897 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5181336402893066
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.838 Test Loss: 0.869 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6510200500488281
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.850 Test Loss: 0.858 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 655552
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5572824478149414
Epoch: 1, Steps: 8 | Train Loss: 1.996 Vali Loss: 1.269 Vali Acc: 0.703 Test Loss: 1.269 Test Acc: 0.703
Validation loss decreased (inf --> -0.703112).  Saving model ...
Epoch: 2 cost time: 1.3692905902862549
Epoch: 2, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
Validation loss decreased (-0.703112 --> -0.818744).  Saving model ...
Epoch: 3 cost time: 1.5719611644744873
Epoch: 3, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.818744 --> -0.843745).  Saving model ...
Epoch: 4 cost time: 1.4198355674743652
Epoch: 4, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.618 Vali Acc: 0.838 Test Loss: 0.618 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5165369510650635
Epoch: 5, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6886756420135498
Epoch: 6, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.733 Vali Acc: 0.844 Test Loss: 0.733 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4027214050292969
Epoch: 7, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 1.4989190101623535
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.818 Vali Acc: 0.831 Test Loss: 0.818 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4947433471679688
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.819 Test Loss: 0.899 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6140410900115967
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.816 Test Loss: 0.945 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.632021427154541
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.822 Test Loss: 0.910 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5588057041168213
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.831 Test Loss: 0.869 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6539371013641357
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.844 Test Loss: 0.845 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6248610019683838
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.844 Test Loss: 0.853 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.753566026687622
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.844 Test Loss: 0.873 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6885778903961182
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.841 Test Loss: 0.881 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6853134632110596
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.838 Test Loss: 0.880 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 655552
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.552084445953369
Epoch: 1, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.251 Vali Acc: 0.703 Test Loss: 1.251 Test Acc: 0.703
Validation loss decreased (inf --> -0.703112).  Saving model ...
Epoch: 2 cost time: 1.2574737071990967
Epoch: 2, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.703112 --> -0.831244).  Saving model ...
Epoch: 3 cost time: 1.6677837371826172
Epoch: 3, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 1.5231175422668457
Epoch: 4, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 1.6049940586090088
Epoch: 5, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.610217809677124
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.710 Vali Acc: 0.850 Test Loss: 0.710 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3340330123901367
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.728 Vali Acc: 0.872 Test Loss: 0.728 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.871868).  Saving model ...
Epoch: 8 cost time: 1.580070972442627
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.850 Test Loss: 0.792 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6039319038391113
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.861 Vali Acc: 0.838 Test Loss: 0.861 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5620412826538086
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.887 Vali Acc: 0.838 Test Loss: 0.887 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5740840435028076
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.853 Test Loss: 0.842 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5552983283996582
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.856 Test Loss: 0.810 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4899017810821533
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.859 Test Loss: 0.796 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3873136043548584
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.859 Test Loss: 0.814 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5458788871765137
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.856 Test Loss: 0.839 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6718885898590088
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.847 Test Loss: 0.849 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7447521686553955
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.850 Test Loss: 0.848 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 655552
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5596916675567627
Epoch: 1, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.261 Vali Acc: 0.684 Test Loss: 1.261 Test Acc: 0.684
Validation loss decreased (inf --> -0.684362).  Saving model ...
Epoch: 2 cost time: 1.4221484661102295
Epoch: 2, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
Validation loss decreased (-0.684362 --> -0.831244).  Saving model ...
Epoch: 3 cost time: 1.364783763885498
Epoch: 3, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
Validation loss decreased (-0.831244 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 1.4043662548065186
Epoch: 4, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4238603115081787
Epoch: 5, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1342992782592773
Epoch: 6, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.662 Vali Acc: 0.863 Test Loss: 0.662 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862493).  Saving model ...
Epoch: 7 cost time: 1.409358024597168
Epoch: 7, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.696 Vali Acc: 0.863 Test Loss: 0.696 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2409801483154297
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.831 Vali Acc: 0.853 Test Loss: 0.831 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3681654930114746
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.833 Vali Acc: 0.856 Test Loss: 0.833 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3499867916107178
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.733 Vali Acc: 0.878 Test Loss: 0.733 Test Acc: 0.878
Validation loss decreased (-0.862493 --> -0.878118).  Saving model ...
Epoch: 11 cost time: 1.1749279499053955
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.722 Vali Acc: 0.872 Test Loss: 0.722 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3819124698638916
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.875 Test Loss: 0.717 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3180413246154785
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.884 Test Loss: 0.732 Test Acc: 0.884
Validation loss decreased (-0.878118 --> -0.884368).  Saving model ...
Epoch: 14 cost time: 1.4501540660858154
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.878 Test Loss: 0.744 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.328979253768921
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.884 Test Loss: 0.753 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5042059421539307
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.887 Test Loss: 0.739 Test Acc: 0.887
Validation loss decreased (-0.884368 --> -0.887493).  Saving model ...
Epoch: 17 cost time: 1.4841578006744385
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.884 Test Loss: 0.728 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.196342945098877
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.884 Test Loss: 0.732 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.38018798828125
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.884 Test Loss: 0.744 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.424163818359375
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.881 Test Loss: 0.758 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3617324829101562
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.887 Test Loss: 0.765 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3865408897399902
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.881 Test Loss: 0.769 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3701062202453613
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.884 Test Loss: 0.778 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4211626052856445
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.884 Test Loss: 0.784 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.369938850402832
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.884 Test Loss: 0.784 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3356704711914062
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.875 Test Loss: 0.784 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8875
model parameter : 655552
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7223598957061768
Epoch: 1, Steps: 8 | Train Loss: 2.287 Vali Loss: 1.426 Vali Acc: 0.613 Test Loss: 1.426 Test Acc: 0.613
Validation loss decreased (inf --> -0.612486).  Saving model ...
Epoch: 2 cost time: 1.5398838520050049
Epoch: 2, Steps: 8 | Train Loss: 0.910 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
Validation loss decreased (-0.612486 --> -0.821869).  Saving model ...
Epoch: 3 cost time: 1.3783807754516602
Epoch: 3, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 4 cost time: 1.1928989887237549
Epoch: 4, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
Validation loss decreased (-0.824994 --> -0.853120).  Saving model ...
Epoch: 5 cost time: 1.3148128986358643
Epoch: 5, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.736 Vali Acc: 0.828 Test Loss: 0.736 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.513474464416504
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.733 Vali Acc: 0.844 Test Loss: 0.733 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5794568061828613
Epoch: 7, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.781 Vali Acc: 0.828 Test Loss: 0.781 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2088963985443115
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.796 Vali Acc: 0.819 Test Loss: 0.796 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6438930034637451
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.841 Vali Acc: 0.828 Test Loss: 0.841 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.533858299255371
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.876 Vali Acc: 0.819 Test Loss: 0.876 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5543816089630127
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.996 Vali Acc: 0.809 Test Loss: 0.996 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.534710168838501
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.800 Test Loss: 1.105 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.436967134475708
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.984 Vali Acc: 0.831 Test Loss: 0.984 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.495781660079956
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.942 Vali Acc: 0.838 Test Loss: 0.942 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 524480
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5543951988220215
Epoch: 1, Steps: 8 | Train Loss: 2.282 Vali Loss: 1.428 Vali Acc: 0.594 Test Loss: 1.428 Test Acc: 0.594
Validation loss decreased (inf --> -0.593736).  Saving model ...
Epoch: 2 cost time: 1.6121020317077637
Epoch: 2, Steps: 8 | Train Loss: 0.915 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
Validation loss decreased (-0.593736 --> -0.821869).  Saving model ...
Epoch: 3 cost time: 1.4397928714752197
Epoch: 3, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.584 Vali Acc: 0.831 Test Loss: 0.584 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 4 cost time: 1.4899711608886719
Epoch: 4, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
Validation loss decreased (-0.831244 --> -0.853120).  Saving model ...
Epoch: 5 cost time: 1.5596814155578613
Epoch: 5, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.733 Vali Acc: 0.838 Test Loss: 0.733 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6481962203979492
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.742 Vali Acc: 0.844 Test Loss: 0.742 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.337432622909546
Epoch: 7, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5191822052001953
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.828 Test Loss: 0.806 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7296993732452393
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.832 Vali Acc: 0.831 Test Loss: 0.832 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7085933685302734
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.816 Test Loss: 0.842 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3798925876617432
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.950 Vali Acc: 0.819 Test Loss: 0.950 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.419706106185913
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.023 Vali Acc: 0.806 Test Loss: 1.023 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6301374435424805
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.825 Test Loss: 0.980 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.84326171875
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.948 Vali Acc: 0.825 Test Loss: 0.948 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 524480
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.577763319015503
Epoch: 1, Steps: 8 | Train Loss: 2.264 Vali Loss: 1.416 Vali Acc: 0.581 Test Loss: 1.416 Test Acc: 0.581
Validation loss decreased (inf --> -0.581236).  Saving model ...
Epoch: 2 cost time: 1.2382135391235352
Epoch: 2, Steps: 8 | Train Loss: 0.925 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
Validation loss decreased (-0.581236 --> -0.815619).  Saving model ...
Epoch: 3 cost time: 1.4827120304107666
Epoch: 3, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831244).  Saving model ...
Epoch: 4 cost time: 1.5733766555786133
Epoch: 4, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.527 Vali Acc: 0.863 Test Loss: 0.527 Test Acc: 0.863
Validation loss decreased (-0.831244 --> -0.862495).  Saving model ...
Epoch: 5 cost time: 1.2975571155548096
Epoch: 5, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.696 Vali Acc: 0.850 Test Loss: 0.696 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4184327125549316
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.726 Vali Acc: 0.853 Test Loss: 0.726 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3799004554748535
Epoch: 7, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.760 Vali Acc: 0.844 Test Loss: 0.760 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.188223123550415
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.754 Vali Acc: 0.850 Test Loss: 0.754 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3891735076904297
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.847 Test Loss: 0.805 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6376416683197021
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.829 Vali Acc: 0.847 Test Loss: 0.829 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.787785530090332
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.917 Vali Acc: 0.844 Test Loss: 0.917 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.750905990600586
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.825 Test Loss: 1.021 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3256981372833252
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.838 Test Loss: 0.924 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6294324398040771
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.890 Vali Acc: 0.853 Test Loss: 0.890 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 524480
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4453675746917725
Epoch: 1, Steps: 8 | Train Loss: 2.215 Vali Loss: 1.469 Vali Acc: 0.578 Test Loss: 1.469 Test Acc: 0.578
Validation loss decreased (inf --> -0.578110).  Saving model ...
Epoch: 2 cost time: 1.3034229278564453
Epoch: 2, Steps: 8 | Train Loss: 0.960 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
Validation loss decreased (-0.578110 --> -0.824994).  Saving model ...
Epoch: 3 cost time: 1.2386293411254883
Epoch: 3, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 4 cost time: 1.3664939403533936
Epoch: 4, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 1.1963508129119873
Epoch: 5, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0962672233581543
Epoch: 6, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.671 Vali Acc: 0.866 Test Loss: 0.671 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865618).  Saving model ...
Epoch: 7 cost time: 1.3426997661590576
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3539526462554932
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.726 Vali Acc: 0.847 Test Loss: 0.726 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.359323263168335
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.787 Vali Acc: 0.847 Test Loss: 0.787 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2481958866119385
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0769665241241455
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.760 Vali Acc: 0.866 Test Loss: 0.760 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.306182622909546
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.856 Test Loss: 0.797 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3422234058380127
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.863 Test Loss: 0.801 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.404740333557129
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.859 Test Loss: 0.810 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4625358581542969
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.853 Test Loss: 0.823 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.324972152709961
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.853 Test Loss: 0.816 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 524480
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.648676872253418
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.371 Vali Acc: 0.650 Test Loss: 1.371 Test Acc: 0.650
Validation loss decreased (inf --> -0.649986).  Saving model ...
Epoch: 2 cost time: 1.5356640815734863
Epoch: 2, Steps: 8 | Train Loss: 0.951 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
Validation loss decreased (-0.649986 --> -0.828119).  Saving model ...
Epoch: 3 cost time: 1.3973805904388428
Epoch: 3, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
Validation loss decreased (-0.828119 --> -0.853120).  Saving model ...
Epoch: 4 cost time: 1.5564141273498535
Epoch: 4, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.710 Vali Acc: 0.806 Test Loss: 0.710 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.644775629043579
Epoch: 5, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.729 Vali Acc: 0.847 Test Loss: 0.729 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4536056518554688
Epoch: 6, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.737 Vali Acc: 0.838 Test Loss: 0.737 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4784774780273438
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.932 Vali Acc: 0.806 Test Loss: 0.932 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4336497783660889
Epoch: 8, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.902 Vali Acc: 0.812 Test Loss: 0.902 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.616793155670166
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.858 Vali Acc: 0.822 Test Loss: 0.858 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4720685482025146
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.988 Vali Acc: 0.809 Test Loss: 0.988 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6017019748687744
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.968 Vali Acc: 0.819 Test Loss: 0.968 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.651564359664917
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.822 Test Loss: 0.969 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7111530303955078
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.819 Test Loss: 0.984 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 458944
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4352400302886963
Epoch: 1, Steps: 8 | Train Loss: 2.112 Vali Loss: 1.361 Vali Acc: 0.659 Test Loss: 1.361 Test Acc: 0.659
Validation loss decreased (inf --> -0.659361).  Saving model ...
Epoch: 2 cost time: 1.4409277439117432
Epoch: 2, Steps: 8 | Train Loss: 0.953 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
Validation loss decreased (-0.659361 --> -0.818745).  Saving model ...
Epoch: 3 cost time: 1.5955379009246826
Epoch: 3, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
Validation loss decreased (-0.818745 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 1.6533105373382568
Epoch: 4, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.706 Vali Acc: 0.800 Test Loss: 0.706 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5367929935455322
Epoch: 5, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.730 Vali Acc: 0.847 Test Loss: 0.730 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5340149402618408
Epoch: 6, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.743 Vali Acc: 0.838 Test Loss: 0.743 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5838394165039062
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.927 Vali Acc: 0.806 Test Loss: 0.927 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6980540752410889
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.898 Vali Acc: 0.822 Test Loss: 0.898 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5965936183929443
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.810 Vali Acc: 0.816 Test Loss: 0.810 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5704143047332764
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.925 Vali Acc: 0.825 Test Loss: 0.925 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.723336935043335
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.895 Vali Acc: 0.828 Test Loss: 0.895 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6031341552734375
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.831 Test Loss: 0.926 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5898642539978027
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.946 Vali Acc: 0.828 Test Loss: 0.946 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 458944
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8805041313171387
Epoch: 1, Steps: 8 | Train Loss: 2.127 Vali Loss: 1.342 Vali Acc: 0.697 Test Loss: 1.342 Test Acc: 0.697
Validation loss decreased (inf --> -0.696862).  Saving model ...
Epoch: 2 cost time: 1.5146613121032715
Epoch: 2, Steps: 8 | Train Loss: 0.955 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
Validation loss decreased (-0.696862 --> -0.821870).  Saving model ...
Epoch: 3 cost time: 1.4635980129241943
Epoch: 3, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.482 Vali Acc: 0.859 Test Loss: 0.482 Test Acc: 0.859
Validation loss decreased (-0.821870 --> -0.859370).  Saving model ...
Epoch: 4 cost time: 1.4726505279541016
Epoch: 4, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.673 Vali Acc: 0.812 Test Loss: 0.673 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.403838872909546
Epoch: 5, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.712 Vali Acc: 0.853 Test Loss: 0.712 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.193114995956421
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.757 Vali Acc: 0.844 Test Loss: 0.757 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4621033668518066
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.863 Vali Acc: 0.831 Test Loss: 0.863 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2313010692596436
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.796 Vali Acc: 0.850 Test Loss: 0.796 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6051928997039795
Epoch: 9, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.752 Vali Acc: 0.847 Test Loss: 0.752 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5446970462799072
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.923 Vali Acc: 0.831 Test Loss: 0.923 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.647655963897705
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.936 Vali Acc: 0.831 Test Loss: 0.936 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.491368293762207
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.822 Test Loss: 0.976 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7043917179107666
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.994 Vali Acc: 0.828 Test Loss: 0.994 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 458944
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4031529426574707
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.396 Vali Acc: 0.688 Test Loss: 1.396 Test Acc: 0.688
Validation loss decreased (inf --> -0.687486).  Saving model ...
Epoch: 2 cost time: 1.160902976989746
Epoch: 2, Steps: 8 | Train Loss: 1.006 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
Validation loss decreased (-0.687486 --> -0.824994).  Saving model ...
Epoch: 3 cost time: 1.1769256591796875
Epoch: 3, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.475 Vali Acc: 0.866 Test Loss: 0.475 Test Acc: 0.866
Validation loss decreased (-0.824994 --> -0.865620).  Saving model ...
Epoch: 4 cost time: 1.3464879989624023
Epoch: 4, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2897601127624512
Epoch: 5, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.695 Vali Acc: 0.853 Test Loss: 0.695 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.353128433227539
Epoch: 6, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.716 Vali Acc: 0.825 Test Loss: 0.716 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4238362312316895
Epoch: 7, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.751 Vali Acc: 0.850 Test Loss: 0.751 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3793187141418457
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.265549659729004
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.702 Vali Acc: 0.850 Test Loss: 0.702 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2789041996002197
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.711 Vali Acc: 0.863 Test Loss: 0.711 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1906442642211914
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
Validation loss decreased (-0.865620 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 1.315110206604004
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.856 Test Loss: 0.805 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4793598651885986
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.956 Vali Acc: 0.841 Test Loss: 0.956 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2249422073364258
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.853 Test Loss: 0.973 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1804707050323486
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.869 Test Loss: 0.883 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3373444080352783
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.869 Test Loss: 0.847 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.373096227645874
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.869 Test Loss: 0.838 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4725427627563477
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.872 Test Loss: 0.840 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.297722578048706
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.875 Test Loss: 0.846 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3236098289489746
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.869 Test Loss: 0.853 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4549803733825684
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.869 Test Loss: 0.860 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 458944
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.899507999420166
Epoch: 1, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.323 Vali Acc: 0.628 Test Loss: 1.323 Test Acc: 0.628
Validation loss decreased (inf --> -0.628112).  Saving model ...
Epoch: 2 cost time: 1.4483861923217773
Epoch: 2, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
Validation loss decreased (-0.628112 --> -0.840619).  Saving model ...
Epoch: 3 cost time: 1.4718775749206543
Epoch: 3, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4879958629608154
Epoch: 4, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.763 Vali Acc: 0.822 Test Loss: 0.763 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4354543685913086
Epoch: 5, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.744 Vali Acc: 0.828 Test Loss: 0.744 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2547764778137207
Epoch: 6, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.769 Vali Acc: 0.841 Test Loss: 0.769 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3493165969848633
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.838 Vali Acc: 0.831 Test Loss: 0.838 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0388767719268799
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.858 Vali Acc: 0.831 Test Loss: 0.858 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3729310035705566
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.900 Vali Acc: 0.825 Test Loss: 0.900 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5639543533325195
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.912 Vali Acc: 0.816 Test Loss: 0.912 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4737236499786377
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.853 Test Loss: 0.816 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853117).  Saving model ...
Epoch: 12 cost time: 1.430243968963623
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.827 Vali Acc: 0.847 Test Loss: 0.827 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4780819416046143
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.813 Vali Acc: 0.844 Test Loss: 0.813 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5634982585906982
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.826 Vali Acc: 0.844 Test Loss: 0.826 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.512110710144043
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.243 Vali Acc: 0.787 Test Loss: 1.243 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6533639430999756
Epoch: 16, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.299 Vali Acc: 0.809 Test Loss: 1.299 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3223304748535156
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.178 Vali Acc: 0.816 Test Loss: 1.178 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2921013832092285
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.295 Vali Acc: 0.797 Test Loss: 1.295 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.277207374572754
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.444 Vali Acc: 0.794 Test Loss: 1.444 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4620146751403809
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.806 Test Loss: 1.430 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3965210914611816
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.822 Test Loss: 1.388 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 426176
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.581953287124634
Epoch: 1, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.305 Vali Acc: 0.644 Test Loss: 1.305 Test Acc: 0.644
Validation loss decreased (inf --> -0.643737).  Saving model ...
Epoch: 2 cost time: 1.433121681213379
Epoch: 2, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
Validation loss decreased (-0.643737 --> -0.840620).  Saving model ...
Epoch: 3 cost time: 1.253852367401123
Epoch: 3, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4207139015197754
Epoch: 4, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.757 Vali Acc: 0.819 Test Loss: 0.757 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.328019380569458
Epoch: 5, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.731 Vali Acc: 0.828 Test Loss: 0.731 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.515594482421875
Epoch: 6, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.764 Vali Acc: 0.834 Test Loss: 0.764 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.504112720489502
Epoch: 7, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.824 Vali Acc: 0.844 Test Loss: 0.824 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843742).  Saving model ...
Epoch: 8 cost time: 1.5824720859527588
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.813 Vali Acc: 0.831 Test Loss: 0.813 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4153995513916016
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.859 Vali Acc: 0.838 Test Loss: 0.859 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5918824672698975
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.909 Vali Acc: 0.816 Test Loss: 0.909 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.519200325012207
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.803 Vali Acc: 0.847 Test Loss: 0.803 Test Acc: 0.847
Validation loss decreased (-0.843742 --> -0.846867).  Saving model ...
Epoch: 12 cost time: 1.573523998260498
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.841 Test Loss: 0.804 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5029256343841553
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.844 Test Loss: 0.790 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3698523044586182
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.818 Vali Acc: 0.844 Test Loss: 0.818 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6492335796356201
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.274 Vali Acc: 0.794 Test Loss: 1.274 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5848963260650635
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.318 Vali Acc: 0.812 Test Loss: 1.318 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5153212547302246
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.213 Vali Acc: 0.809 Test Loss: 1.213 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.534128189086914
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.205 Vali Acc: 0.834 Test Loss: 1.205 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5582301616668701
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.373 Vali Acc: 0.812 Test Loss: 1.373 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6539630889892578
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.509 Vali Acc: 0.809 Test Loss: 1.509 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6233890056610107
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.508 Vali Acc: 0.816 Test Loss: 1.508 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 426176
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.535128116607666
Epoch: 1, Steps: 8 | Train Loss: 1.979 Vali Loss: 1.304 Vali Acc: 0.662 Test Loss: 1.304 Test Acc: 0.662
Validation loss decreased (inf --> -0.662487).  Saving model ...
Epoch: 2 cost time: 1.4018821716308594
Epoch: 2, Steps: 8 | Train Loss: 0.780 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
Validation loss decreased (-0.662487 --> -0.834370).  Saving model ...
Epoch: 3 cost time: 1.251530647277832
Epoch: 3, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.504 Vali Acc: 0.831 Test Loss: 0.504 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5407695770263672
Epoch: 4, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.711 Vali Acc: 0.841 Test Loss: 0.711 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840618).  Saving model ...
Epoch: 5 cost time: 1.3596317768096924
Epoch: 5, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.697 Vali Acc: 0.838 Test Loss: 0.697 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.528310775756836
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.735 Vali Acc: 0.853 Test Loss: 0.735 Test Acc: 0.853
Validation loss decreased (-0.840618 --> -0.853118).  Saving model ...
Epoch: 7 cost time: 1.3551514148712158
Epoch: 7, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.794 Vali Acc: 0.853 Test Loss: 0.794 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4618465900421143
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.775 Vali Acc: 0.853 Test Loss: 0.775 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0807838439941406
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.807 Vali Acc: 0.838 Test Loss: 0.807 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.308274745941162
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.838 Test Loss: 0.823 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2101786136627197
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.847 Test Loss: 0.814 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.335237979888916
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.847 Test Loss: 0.811 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4893646240234375
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.850 Test Loss: 0.812 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4510467052459717
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.847 Test Loss: 0.822 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4335641860961914
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.844 Test Loss: 0.830 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3647301197052002
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.844 Test Loss: 0.842 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 426176
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.526782751083374
Epoch: 1, Steps: 8 | Train Loss: 1.972 Vali Loss: 1.325 Vali Acc: 0.659 Test Loss: 1.325 Test Acc: 0.659
Validation loss decreased (inf --> -0.659362).  Saving model ...
Epoch: 2 cost time: 1.1671030521392822
Epoch: 2, Steps: 8 | Train Loss: 0.841 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.659362 --> -0.831245).  Saving model ...
Epoch: 3 cost time: 1.279714822769165
Epoch: 3, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
Validation loss decreased (-0.831245 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 1.078756332397461
Epoch: 4, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3249154090881348
Epoch: 5, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.634 Vali Acc: 0.847 Test Loss: 0.634 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.285628080368042
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.671 Vali Acc: 0.863 Test Loss: 0.671 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862493).  Saving model ...
Epoch: 7 cost time: 1.3081133365631104
Epoch: 7, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.689 Vali Acc: 0.856 Test Loss: 0.689 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.311249017715454
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.759 Vali Acc: 0.834 Test Loss: 0.759 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2164108753204346
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.723 Vali Acc: 0.859 Test Loss: 0.723 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.12461256980896
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.710 Vali Acc: 0.866 Test Loss: 0.710 Test Acc: 0.866
Validation loss decreased (-0.862493 --> -0.865618).  Saving model ...
Epoch: 11 cost time: 1.2060766220092773
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.859 Test Loss: 0.763 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3455150127410889
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.850 Test Loss: 0.757 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4231038093566895
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.859 Test Loss: 0.751 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2994744777679443
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.859 Test Loss: 0.752 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1993277072906494
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.859 Test Loss: 0.748 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.362647294998169
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.869 Test Loss: 0.765 Test Acc: 0.869
Validation loss decreased (-0.865618 --> -0.868742).  Saving model ...
Epoch: 17 cost time: 1.2607228755950928
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.863 Test Loss: 0.776 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.262378215789795
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.859 Test Loss: 0.783 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2996931076049805
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.863 Test Loss: 0.782 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2225291728973389
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.863 Test Loss: 0.787 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.27384614944458
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.856 Test Loss: 0.793 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3723199367523193
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.856 Test Loss: 0.800 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.278791904449463
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.856 Test Loss: 0.803 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.302107334136963
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.859 Test Loss: 0.808 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2914559841156006
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.866 Test Loss: 0.815 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0977871417999268
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.869 Test Loss: 0.814 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 426176
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.436403751373291
Epoch: 1, Steps: 8 | Train Loss: 1.984 Vali Loss: 1.550 Vali Acc: 0.516 Test Loss: 1.550 Test Acc: 0.516
Validation loss decreased (inf --> -0.515610).  Saving model ...
Epoch: 2 cost time: 1.4884889125823975
Epoch: 2, Steps: 8 | Train Loss: 1.089 Vali Loss: 0.758 Vali Acc: 0.787 Test Loss: 0.758 Test Acc: 0.787
Validation loss decreased (-0.515610 --> -0.787492).  Saving model ...
Epoch: 3 cost time: 1.5539016723632812
Epoch: 3, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.559 Vali Acc: 0.806 Test Loss: 0.559 Test Acc: 0.806
Validation loss decreased (-0.787492 --> -0.806244).  Saving model ...
Epoch: 4 cost time: 1.433180332183838
Epoch: 4, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
Validation loss decreased (-0.806244 --> -0.824995).  Saving model ...
Epoch: 5 cost time: 1.5916719436645508
Epoch: 5, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
Validation loss decreased (-0.824995 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 1.5313670635223389
Epoch: 6, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.582 Vali Acc: 0.831 Test Loss: 0.582 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.470865249633789
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.604 Vali Acc: 0.834 Test Loss: 0.604 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4936351776123047
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.683 Vali Acc: 0.831 Test Loss: 0.683 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3947210311889648
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.699 Vali Acc: 0.816 Test Loss: 0.699 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6963872909545898
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.680 Vali Acc: 0.828 Test Loss: 0.680 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5040900707244873
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.716 Vali Acc: 0.828 Test Loss: 0.716 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.565877914428711
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.423912763595581
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.745 Vali Acc: 0.834 Test Loss: 0.745 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.652125597000122
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.838 Test Loss: 0.744 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.811340093612671
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.838 Test Loss: 0.736 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 704640
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7813796997070312
Epoch: 1, Steps: 8 | Train Loss: 1.970 Vali Loss: 1.556 Vali Acc: 0.500 Test Loss: 1.556 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 1.5408194065093994
Epoch: 2, Steps: 8 | Train Loss: 1.102 Vali Loss: 0.759 Vali Acc: 0.787 Test Loss: 0.759 Test Acc: 0.787
Validation loss decreased (-0.499984 --> -0.787492).  Saving model ...
Epoch: 3 cost time: 1.5073950290679932
Epoch: 3, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.564 Vali Acc: 0.806 Test Loss: 0.564 Test Acc: 0.806
Validation loss decreased (-0.787492 --> -0.806244).  Saving model ...
Epoch: 4 cost time: 1.4586989879608154
Epoch: 4, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
Validation loss decreased (-0.806244 --> -0.828120).  Saving model ...
Epoch: 5 cost time: 1.4181513786315918
Epoch: 5, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 1.4425535202026367
Epoch: 6, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6079246997833252
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4637105464935303
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.684 Vali Acc: 0.834 Test Loss: 0.684 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7791178226470947
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.704 Vali Acc: 0.831 Test Loss: 0.704 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5132381916046143
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.677 Vali Acc: 0.831 Test Loss: 0.677 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5759432315826416
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.701 Vali Acc: 0.819 Test Loss: 0.701 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3849647045135498
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1540262699127197
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.828 Test Loss: 0.737 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3653874397277832
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.828 Test Loss: 0.742 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5569679737091064
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.822 Test Loss: 0.741 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 704640
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5124051570892334
Epoch: 1, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.542 Vali Acc: 0.534 Test Loss: 1.542 Test Acc: 0.534
Validation loss decreased (inf --> -0.534360).  Saving model ...
Epoch: 2 cost time: 1.2800498008728027
Epoch: 2, Steps: 8 | Train Loss: 1.099 Vali Loss: 0.744 Vali Acc: 0.803 Test Loss: 0.744 Test Acc: 0.803
Validation loss decreased (-0.534360 --> -0.803118).  Saving model ...
Epoch: 3 cost time: 1.2217833995819092
Epoch: 3, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
Validation loss decreased (-0.803118 --> -0.828120).  Saving model ...
Epoch: 4 cost time: 1.283921718597412
Epoch: 4, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4332334995269775
Epoch: 5, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 1.1531305313110352
Epoch: 6, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 1.174957513809204
Epoch: 7, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5149405002593994
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.652 Vali Acc: 0.841 Test Loss: 0.652 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3255839347839355
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.654 Vali Acc: 0.841 Test Loss: 0.654 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4132146835327148
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.620 Vali Acc: 0.834 Test Loss: 0.620 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3033130168914795
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3661861419677734
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.686 Vali Acc: 0.831 Test Loss: 0.686 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3911542892456055
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0699191093444824
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.689 Vali Acc: 0.828 Test Loss: 0.689 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2258243560791016
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3077950477600098
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 704640
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.475447416305542
Epoch: 1, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.582 Vali Acc: 0.497 Test Loss: 1.582 Test Acc: 0.497
Validation loss decreased (inf --> -0.496859).  Saving model ...
Epoch: 2 cost time: 1.3511252403259277
Epoch: 2, Steps: 8 | Train Loss: 1.183 Vali Loss: 0.778 Vali Acc: 0.812 Test Loss: 0.778 Test Acc: 0.812
Validation loss decreased (-0.496859 --> -0.812492).  Saving model ...
Epoch: 3 cost time: 1.2817094326019287
Epoch: 3, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.531 Vali Acc: 0.812 Test Loss: 0.531 Test Acc: 0.812
Validation loss decreased (-0.812492 --> -0.812495).  Saving model ...
Epoch: 4 cost time: 1.2247684001922607
Epoch: 4, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.483 Vali Acc: 0.822 Test Loss: 0.483 Test Acc: 0.822
Validation loss decreased (-0.812495 --> -0.821870).  Saving model ...
Epoch: 5 cost time: 1.4604804515838623
Epoch: 5, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.821870 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.4188380241394043
Epoch: 6, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.501 Vali Acc: 0.863 Test Loss: 0.501 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 1.2760629653930664
Epoch: 7, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.499 Vali Acc: 0.869 Test Loss: 0.499 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 8 cost time: 1.2793166637420654
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4113547801971436
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.547 Vali Acc: 0.863 Test Loss: 0.547 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3486416339874268
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.520 Vali Acc: 0.869 Test Loss: 0.520 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2546947002410889
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.866 Test Loss: 0.549 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0658173561096191
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2711842060089111
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.847 Test Loss: 0.617 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.205794095993042
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2918646335601807
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.631 Vali Acc: 0.863 Test Loss: 0.631 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3549199104309082
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871869).  Saving model ...
Epoch: 17 cost time: 1.3895947933197021
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.869 Test Loss: 0.621 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3146259784698486
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.866 Test Loss: 0.620 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.309701681137085
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.625 Vali Acc: 0.872 Test Loss: 0.625 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2675859928131104
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.869 Test Loss: 0.629 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.357480525970459
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.872 Test Loss: 0.625 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3571562767028809
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.36834716796875
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.869 Test Loss: 0.636 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3390214443206787
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 1.1691834926605225
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.875 Test Loss: 0.642 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.425250768661499
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2434911727905273
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.875 Test Loss: 0.641 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5061557292938232
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.872 Test Loss: 0.644 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4191975593566895
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.875 Test Loss: 0.646 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2989590167999268
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.875 Test Loss: 0.647 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.199063777923584
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.875 Test Loss: 0.649 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3957111835479736
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.875 Test Loss: 0.653 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4316284656524658
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.878 Test Loss: 0.658 Test Acc: 0.878
Validation loss decreased (-0.874994 --> -0.878118).  Saving model ...
Epoch: 34 cost time: 1.3382937908172607
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3636562824249268
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.872 Test Loss: 0.663 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3164763450622559
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.872 Test Loss: 0.666 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2466118335723877
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3845252990722656
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.872 Test Loss: 0.671 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3797194957733154
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.872 Test Loss: 0.670 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1876881122589111
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.875 Test Loss: 0.670 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.4082436561584473
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.875 Test Loss: 0.676 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.4264535903930664
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.875 Test Loss: 0.682 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3534657955169678
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.875 Test Loss: 0.683 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 704640
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4845993518829346
Epoch: 1, Steps: 8 | Train Loss: 2.252 Vali Loss: 1.816 Vali Acc: 0.338 Test Loss: 1.816 Test Acc: 0.338
Validation loss decreased (inf --> -0.337482).  Saving model ...
Epoch: 2 cost time: 1.488523244857788
Epoch: 2, Steps: 8 | Train Loss: 1.298 Vali Loss: 0.873 Vali Acc: 0.747 Test Loss: 0.873 Test Acc: 0.747
Validation loss decreased (-0.337482 --> -0.746866).  Saving model ...
Epoch: 3 cost time: 1.4822726249694824
Epoch: 3, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
Validation loss decreased (-0.746866 --> -0.834369).  Saving model ...
Epoch: 4 cost time: 1.2460319995880127
Epoch: 4, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4840350151062012
Epoch: 5, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4538357257843018
Epoch: 6, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 1.5289883613586426
Epoch: 7, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.597 Vali Acc: 0.838 Test Loss: 0.597 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.395993709564209
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.722 Vali Acc: 0.806 Test Loss: 0.722 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5100843906402588
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3573830127716064
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4330270290374756
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.762 Vali Acc: 0.812 Test Loss: 0.762 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.386866807937622
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.746 Vali Acc: 0.831 Test Loss: 0.746 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3887505531311035
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.828 Test Loss: 0.732 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2749066352844238
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.752 Vali Acc: 0.828 Test Loss: 0.752 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.392601490020752
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.511303186416626
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.797 Vali Acc: 0.831 Test Loss: 0.797 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 442496
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.065889596939087
Epoch: 1, Steps: 8 | Train Loss: 2.245 Vali Loss: 1.796 Vali Acc: 0.362 Test Loss: 1.796 Test Acc: 0.362
Validation loss decreased (inf --> -0.362482).  Saving model ...
Epoch: 2 cost time: 1.223026990890503
Epoch: 2, Steps: 8 | Train Loss: 1.289 Vali Loss: 0.862 Vali Acc: 0.762 Test Loss: 0.862 Test Acc: 0.762
Validation loss decreased (-0.362482 --> -0.762491).  Saving model ...
Epoch: 3 cost time: 1.3754537105560303
Epoch: 3, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.762491 --> -0.843745).  Saving model ...
Epoch: 4 cost time: 1.53837251663208
Epoch: 4, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.331057071685791
Epoch: 5, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3988547325134277
Epoch: 6, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 1.1461577415466309
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.578 Vali Acc: 0.847 Test Loss: 0.578 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.577082633972168
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.714 Vali Acc: 0.816 Test Loss: 0.714 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.701564073562622
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.654 Vali Acc: 0.838 Test Loss: 0.654 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5645627975463867
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.671 Vali Acc: 0.831 Test Loss: 0.671 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4362032413482666
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.716 Vali Acc: 0.816 Test Loss: 0.716 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7287347316741943
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4055471420288086
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5695042610168457
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.825 Test Loss: 0.725 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3990211486816406
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6379592418670654
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.822 Test Loss: 0.753 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 442496
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.689262628555298
Epoch: 1, Steps: 8 | Train Loss: 2.225 Vali Loss: 1.770 Vali Acc: 0.362 Test Loss: 1.770 Test Acc: 0.362
Validation loss decreased (inf --> -0.362482).  Saving model ...
Epoch: 2 cost time: 1.2684285640716553
Epoch: 2, Steps: 8 | Train Loss: 1.287 Vali Loss: 0.854 Vali Acc: 0.775 Test Loss: 0.854 Test Acc: 0.775
Validation loss decreased (-0.362482 --> -0.774991).  Saving model ...
Epoch: 3 cost time: 1.31382155418396
Epoch: 3, Steps: 8 | Train Loss: 0.556 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
Validation loss decreased (-0.774991 --> -0.834369).  Saving model ...
Epoch: 4 cost time: 1.2904281616210938
Epoch: 4, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2706325054168701
Epoch: 5, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3160157203674316
Epoch: 6, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 1.334259271621704
Epoch: 7, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2433397769927979
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9711856842041016
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.838 Test Loss: 0.620 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1199162006378174
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.631 Vali Acc: 0.847 Test Loss: 0.631 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2428104877471924
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0462195873260498
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.676 Vali Acc: 0.828 Test Loss: 0.676 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3781137466430664
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.209155797958374
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1025381088256836
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.691 Vali Acc: 0.825 Test Loss: 0.691 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3074023723602295
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 442496
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1820971965789795
Epoch: 1, Steps: 8 | Train Loss: 2.191 Vali Loss: 1.788 Vali Acc: 0.369 Test Loss: 1.788 Test Acc: 0.369
Validation loss decreased (inf --> -0.368732).  Saving model ...
Epoch: 2 cost time: 1.2800719738006592
Epoch: 2, Steps: 8 | Train Loss: 1.335 Vali Loss: 0.881 Vali Acc: 0.787 Test Loss: 0.881 Test Acc: 0.787
Validation loss decreased (-0.368732 --> -0.787491).  Saving model ...
Epoch: 3 cost time: 1.286322832107544
Epoch: 3, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
Validation loss decreased (-0.787491 --> -0.824995).  Saving model ...
Epoch: 4 cost time: 1.260420799255371
Epoch: 4, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 1.3156521320343018
Epoch: 5, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.493 Vali Acc: 0.834 Test Loss: 0.493 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.194361925125122
Epoch: 6, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 1.0926012992858887
Epoch: 7, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
Validation loss decreased (-0.853120 --> -0.878120).  Saving model ...
Epoch: 8 cost time: 1.222623348236084
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.592 Vali Acc: 0.863 Test Loss: 0.592 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0876564979553223
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1199049949645996
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.532 Vali Acc: 0.872 Test Loss: 0.532 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.182520866394043
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.591 Vali Acc: 0.853 Test Loss: 0.591 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.007697343826294
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.579 Vali Acc: 0.859 Test Loss: 0.579 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2969419956207275
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.190504550933838
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.045522689819336
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.859 Test Loss: 0.601 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2761499881744385
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.859 Test Loss: 0.610 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1991186141967773
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.863 Test Loss: 0.606 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 442496
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.708270311355591
Epoch: 1, Steps: 8 | Train Loss: 2.217 Vali Loss: 1.677 Vali Acc: 0.425 Test Loss: 1.677 Test Acc: 0.425
Validation loss decreased (inf --> -0.424983).  Saving model ...
Epoch: 2 cost time: 1.5015394687652588
Epoch: 2, Steps: 8 | Train Loss: 1.273 Vali Loss: 0.801 Vali Acc: 0.784 Test Loss: 0.801 Test Acc: 0.784
Validation loss decreased (-0.424983 --> -0.784367).  Saving model ...
Epoch: 3 cost time: 1.351184368133545
Epoch: 3, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
Validation loss decreased (-0.784367 --> -0.818744).  Saving model ...
Epoch: 4 cost time: 1.5762407779693604
Epoch: 4, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.818744 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 1.2766757011413574
Epoch: 5, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5320570468902588
Epoch: 6, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.595 Vali Acc: 0.831 Test Loss: 0.595 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6533496379852295
Epoch: 7, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.606 Vali Acc: 0.838 Test Loss: 0.606 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3806276321411133
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.466580867767334
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3128933906555176
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5037922859191895
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3119463920593262
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.716 Vali Acc: 0.825 Test Loss: 0.716 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.678574800491333
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.746 Vali Acc: 0.819 Test Loss: 0.746 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.595144271850586
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.738 Vali Acc: 0.838 Test Loss: 0.738 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 311424
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3382630348205566
Epoch: 1, Steps: 8 | Train Loss: 2.221 Vali Loss: 1.677 Vali Acc: 0.456 Test Loss: 1.677 Test Acc: 0.456
Validation loss decreased (inf --> -0.456233).  Saving model ...
Epoch: 2 cost time: 1.2462594509124756
Epoch: 2, Steps: 8 | Train Loss: 1.274 Vali Loss: 0.795 Vali Acc: 0.806 Test Loss: 0.795 Test Acc: 0.806
Validation loss decreased (-0.456233 --> -0.806242).  Saving model ...
Epoch: 3 cost time: 1.296499252319336
Epoch: 3, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.806242 --> -0.821869).  Saving model ...
Epoch: 4 cost time: 1.4028820991516113
Epoch: 4, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 1.353550672531128
Epoch: 5, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.3601272106170654
Epoch: 6, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0728709697723389
Epoch: 7, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.612 Vali Acc: 0.838 Test Loss: 0.612 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4893708229064941
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843744).  Saving model ...
Epoch: 9 cost time: 1.3296146392822266
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.677 Vali Acc: 0.819 Test Loss: 0.677 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3965940475463867
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.725 Vali Acc: 0.822 Test Loss: 0.725 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3504338264465332
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.709 Vali Acc: 0.834 Test Loss: 0.709 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3792486190795898
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.695 Vali Acc: 0.828 Test Loss: 0.695 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4306175708770752
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.831 Test Loss: 0.721 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1990296840667725
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.722 Vali Acc: 0.834 Test Loss: 0.722 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3664236068725586
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.712 Vali Acc: 0.834 Test Loss: 0.712 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.411900520324707
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.838 Test Loss: 0.724 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.420280933380127
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.838 Test Loss: 0.738 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1564812660217285
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.834 Test Loss: 0.760 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 311424
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3646483421325684
Epoch: 1, Steps: 8 | Train Loss: 2.192 Vali Loss: 1.658 Vali Acc: 0.481 Test Loss: 1.658 Test Acc: 0.481
Validation loss decreased (inf --> -0.481233).  Saving model ...
Epoch: 2 cost time: 1.1952486038208008
Epoch: 2, Steps: 8 | Train Loss: 1.268 Vali Loss: 0.785 Vali Acc: 0.812 Test Loss: 0.785 Test Acc: 0.812
Validation loss decreased (-0.481233 --> -0.812492).  Saving model ...
Epoch: 3 cost time: 1.0908751487731934
Epoch: 3, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
Validation loss decreased (-0.812492 --> -0.831245).  Saving model ...
Epoch: 4 cost time: 1.030137538909912
Epoch: 4, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
Validation loss decreased (-0.831245 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 1.1866590976715088
Epoch: 5, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2573490142822266
Epoch: 6, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.559 Vali Acc: 0.853 Test Loss: 0.559 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853119).  Saving model ...
Epoch: 7 cost time: 1.2629246711730957
Epoch: 7, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.569 Vali Acc: 0.859 Test Loss: 0.569 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859369).  Saving model ...
Epoch: 8 cost time: 1.3853771686553955
Epoch: 8, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1968600749969482
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.664 Vali Acc: 0.831 Test Loss: 0.664 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0986948013305664
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.666 Vali Acc: 0.841 Test Loss: 0.666 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3323006629943848
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2437520027160645
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.638 Vali Acc: 0.844 Test Loss: 0.638 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3215863704681396
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.667 Vali Acc: 0.831 Test Loss: 0.667 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3411540985107422
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.680 Vali Acc: 0.838 Test Loss: 0.680 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2856979370117188
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.675 Vali Acc: 0.834 Test Loss: 0.675 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4021883010864258
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.677 Vali Acc: 0.838 Test Loss: 0.677 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4262304306030273
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.847 Test Loss: 0.682 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 311424
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6473381519317627
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 1.674 Vali Acc: 0.503 Test Loss: 1.674 Test Acc: 0.503
Validation loss decreased (inf --> -0.503108).  Saving model ...
Epoch: 2 cost time: 1.276318073272705
Epoch: 2, Steps: 8 | Train Loss: 1.319 Vali Loss: 0.816 Vali Acc: 0.828 Test Loss: 0.816 Test Acc: 0.828
Validation loss decreased (-0.503108 --> -0.828117).  Saving model ...
Epoch: 3 cost time: 1.2668511867523193
Epoch: 3, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
Validation loss decreased (-0.828117 --> -0.828120).  Saving model ...
Epoch: 4 cost time: 1.2768759727478027
Epoch: 4, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.2947125434875488
Epoch: 5, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 1.2816944122314453
Epoch: 6, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 1.0911667346954346
Epoch: 7, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1747448444366455
Epoch: 8, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1216545104980469
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.200148344039917
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2027103900909424
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.543 Vali Acc: 0.866 Test Loss: 0.543 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 1.2856507301330566
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.224247932434082
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.847 Test Loss: 0.592 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1577942371368408
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.606 Vali Acc: 0.863 Test Loss: 0.606 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.250272274017334
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2911078929901123
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.859 Test Loss: 0.594 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2784514427185059
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.863 Test Loss: 0.603 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2495009899139404
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.863 Test Loss: 0.620 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.192375659942627
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.859 Test Loss: 0.629 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.205838680267334
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.866 Test Loss: 0.629 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2656943798065186
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.633 Vali Acc: 0.863 Test Loss: 0.633 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 311424
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5053389072418213
Epoch: 1, Steps: 8 | Train Loss: 2.180 Vali Loss: 1.696 Vali Acc: 0.406 Test Loss: 1.696 Test Acc: 0.406
Validation loss decreased (inf --> -0.406233).  Saving model ...
Epoch: 2 cost time: 1.2000789642333984
Epoch: 2, Steps: 8 | Train Loss: 1.256 Vali Loss: 0.886 Vali Acc: 0.731 Test Loss: 0.886 Test Acc: 0.731
Validation loss decreased (-0.406233 --> -0.731241).  Saving model ...
Epoch: 3 cost time: 1.2627651691436768
Epoch: 3, Steps: 8 | Train Loss: 0.626 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
Validation loss decreased (-0.731241 --> -0.815619).  Saving model ...
Epoch: 4 cost time: 1.2681183815002441
Epoch: 4, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831245).  Saving model ...
Epoch: 5 cost time: 1.2517526149749756
Epoch: 5, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
Validation loss decreased (-0.831245 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.1088242530822754
Epoch: 6, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.441819429397583
Epoch: 7, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.362722396850586
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.13261079788208
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.718 Vali Acc: 0.816 Test Loss: 0.718 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.282839059829712
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.697 Vali Acc: 0.816 Test Loss: 0.697 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3007214069366455
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.699 Vali Acc: 0.828 Test Loss: 0.699 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3326144218444824
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.834 Test Loss: 0.717 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2111682891845703
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.831 Test Loss: 0.737 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.420766830444336
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.838 Test Loss: 0.749 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3565216064453125
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.834 Test Loss: 0.744 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 245888
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.863947868347168
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 1.692 Vali Acc: 0.412 Test Loss: 1.692 Test Acc: 0.412
Validation loss decreased (inf --> -0.412483).  Saving model ...
Epoch: 2 cost time: 1.2837409973144531
Epoch: 2, Steps: 8 | Train Loss: 1.241 Vali Loss: 0.883 Vali Acc: 0.738 Test Loss: 0.883 Test Acc: 0.738
Validation loss decreased (-0.412483 --> -0.737491).  Saving model ...
Epoch: 3 cost time: 1.2681260108947754
Epoch: 3, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
Validation loss decreased (-0.737491 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 1.3819234371185303
Epoch: 4, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 1.102452278137207
Epoch: 5, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 1.4494893550872803
Epoch: 6, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.385589361190796
Epoch: 7, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4780328273773193
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.652 Vali Acc: 0.825 Test Loss: 0.652 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.545179843902588
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0848984718322754
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.678 Vali Acc: 0.831 Test Loss: 0.678 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3180830478668213
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.681 Vali Acc: 0.838 Test Loss: 0.681 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3409802913665771
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.706 Vali Acc: 0.825 Test Loss: 0.706 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0831987857818604
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.822 Test Loss: 0.733 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1026058197021484
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.151646614074707
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.730 Vali Acc: 0.831 Test Loss: 0.730 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 245888
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7666513919830322
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 1.664 Vali Acc: 0.453 Test Loss: 1.664 Test Acc: 0.453
Validation loss decreased (inf --> -0.453108).  Saving model ...
Epoch: 2 cost time: 1.3810713291168213
Epoch: 2, Steps: 8 | Train Loss: 1.240 Vali Loss: 0.869 Vali Acc: 0.766 Test Loss: 0.869 Test Acc: 0.766
Validation loss decreased (-0.453108 --> -0.765616).  Saving model ...
Epoch: 3 cost time: 1.3318202495574951
Epoch: 3, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.553 Vali Acc: 0.838 Test Loss: 0.553 Test Acc: 0.838
Validation loss decreased (-0.765616 --> -0.837494).  Saving model ...
Epoch: 4 cost time: 1.2278003692626953
Epoch: 4, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2729458808898926
Epoch: 5, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.1744985580444336
Epoch: 6, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.192274570465088
Epoch: 7, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.543 Vali Acc: 0.847 Test Loss: 0.543 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 1.1861138343811035
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4468793869018555
Epoch: 9, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.698 Vali Acc: 0.819 Test Loss: 0.698 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2244744300842285
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2457857131958008
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856244).  Saving model ...
Epoch: 12 cost time: 1.0860979557037354
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.676 Vali Acc: 0.825 Test Loss: 0.676 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2768735885620117
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.707 Vali Acc: 0.816 Test Loss: 0.707 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.306520700454712
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.819 Test Loss: 0.707 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1854755878448486
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2591633796691895
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.693 Vali Acc: 0.831 Test Loss: 0.693 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3513104915618896
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.825 Test Loss: 0.707 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2548983097076416
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2672295570373535
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.831 Test Loss: 0.731 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.368159294128418
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.828 Test Loss: 0.744 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2271182537078857
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.831 Test Loss: 0.748 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 245888
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.520533800125122
Epoch: 1, Steps: 8 | Train Loss: 2.093 Vali Loss: 1.616 Vali Acc: 0.491 Test Loss: 1.616 Test Acc: 0.491
Validation loss decreased (inf --> -0.490609).  Saving model ...
Epoch: 2 cost time: 1.2045326232910156
Epoch: 2, Steps: 8 | Train Loss: 1.274 Vali Loss: 0.865 Vali Acc: 0.787 Test Loss: 0.865 Test Acc: 0.787
Validation loss decreased (-0.490609 --> -0.787491).  Saving model ...
Epoch: 3 cost time: 1.2878856658935547
Epoch: 3, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
Validation loss decreased (-0.787491 --> -0.821870).  Saving model ...
Epoch: 4 cost time: 1.3864479064941406
Epoch: 4, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
Validation loss decreased (-0.821870 --> -0.821870).  Saving model ...
Epoch: 5 cost time: 1.265134334564209
Epoch: 5, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.502 Vali Acc: 0.825 Test Loss: 0.502 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 1.2282052040100098
Epoch: 6, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
Validation loss decreased (-0.824995 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 1.3987619876861572
Epoch: 7, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.485 Vali Acc: 0.866 Test Loss: 0.485 Test Acc: 0.866
Validation loss decreased (-0.846870 --> -0.865620).  Saving model ...
Epoch: 8 cost time: 1.1238610744476318
Epoch: 8, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3679823875427246
Epoch: 9, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3091545104980469
Epoch: 10, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.555 Vali Acc: 0.866 Test Loss: 0.555 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4137318134307861
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3206582069396973
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3217754364013672
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.847 Test Loss: 0.659 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2541933059692383
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1103603839874268
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.859 Test Loss: 0.617 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4486427307128906
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4937641620635986
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.853 Test Loss: 0.636 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 245888
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.03798246383667
Epoch: 1, Steps: 8 | Train Loss: 2.187 Vali Loss: 1.680 Vali Acc: 0.428 Test Loss: 1.680 Test Acc: 0.428
Validation loss decreased (inf --> -0.428108).  Saving model ...
Epoch: 2 cost time: 1.14876389503479
Epoch: 2, Steps: 8 | Train Loss: 1.300 Vali Loss: 0.812 Vali Acc: 0.816 Test Loss: 0.812 Test Acc: 0.816
Validation loss decreased (-0.428108 --> -0.815617).  Saving model ...
Epoch: 3 cost time: 1.3239879608154297
Epoch: 3, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.567 Vali Acc: 0.800 Test Loss: 0.567 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.592177152633667
Epoch: 4, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
Validation loss decreased (-0.815617 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 1.5423007011413574
Epoch: 5, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4873168468475342
Epoch: 6, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.578 Vali Acc: 0.838 Test Loss: 0.578 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6081116199493408
Epoch: 7, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.579 Vali Acc: 0.834 Test Loss: 0.579 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3210787773132324
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.697 Vali Acc: 0.816 Test Loss: 0.697 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.547234058380127
Epoch: 9, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.670 Vali Acc: 0.816 Test Loss: 0.670 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4026074409484863
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.659 Vali Acc: 0.838 Test Loss: 0.659 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6000542640686035
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.689 Vali Acc: 0.831 Test Loss: 0.689 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5735294818878174
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.816 Test Loss: 0.711 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.408459186553955
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.809 Test Loss: 0.713 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4552767276763916
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 213120
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.601649284362793
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 1.689 Vali Acc: 0.403 Test Loss: 1.689 Test Acc: 0.403
Validation loss decreased (inf --> -0.403108).  Saving model ...
Epoch: 2 cost time: 1.4948909282684326
Epoch: 2, Steps: 8 | Train Loss: 1.300 Vali Loss: 0.823 Vali Acc: 0.812 Test Loss: 0.823 Test Acc: 0.812
Validation loss decreased (-0.403108 --> -0.812492).  Saving model ...
Epoch: 3 cost time: 1.2970709800720215
Epoch: 3, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.380415916442871
Epoch: 4, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
Validation loss decreased (-0.812492 --> -0.834370).  Saving model ...
Epoch: 5 cost time: 1.4504847526550293
Epoch: 5, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3757586479187012
Epoch: 6, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.585 Vali Acc: 0.831 Test Loss: 0.585 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3968629837036133
Epoch: 7, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837494).  Saving model ...
Epoch: 8 cost time: 1.2097270488739014
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.720 Vali Acc: 0.812 Test Loss: 0.720 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4194769859313965
Epoch: 9, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.686 Vali Acc: 0.816 Test Loss: 0.686 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.304243803024292
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3837025165557861
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.682 Vali Acc: 0.812 Test Loss: 0.682 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3809270858764648
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7358617782592773
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.812 Test Loss: 0.720 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4407846927642822
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.803 Test Loss: 0.724 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0172345638275146
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.70223069190979
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.809 Test Loss: 0.735 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5054512023925781
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.809 Test Loss: 0.748 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 213120
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0814075469970703
Epoch: 1, Steps: 8 | Train Loss: 2.166 Vali Loss: 1.664 Vali Acc: 0.422 Test Loss: 1.664 Test Acc: 0.422
Validation loss decreased (inf --> -0.421858).  Saving model ...
Epoch: 2 cost time: 1.1398448944091797
Epoch: 2, Steps: 8 | Train Loss: 1.315 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
Validation loss decreased (-0.421858 --> -0.803117).  Saving model ...
Epoch: 3 cost time: 1.1184892654418945
Epoch: 3, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.561 Vali Acc: 0.812 Test Loss: 0.561 Test Acc: 0.812
Validation loss decreased (-0.803117 --> -0.812494).  Saving model ...
Epoch: 4 cost time: 1.1356010437011719
Epoch: 4, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.812494 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.21537446975708
Epoch: 5, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2221870422363281
Epoch: 6, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3040201663970947
Epoch: 7, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3804988861083984
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.692 Vali Acc: 0.822 Test Loss: 0.692 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1507105827331543
Epoch: 9, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.641 Vali Acc: 0.825 Test Loss: 0.641 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.390976905822754
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3396928310394287
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.632 Vali Acc: 0.825 Test Loss: 0.632 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.263411521911621
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.664 Vali Acc: 0.819 Test Loss: 0.664 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2823317050933838
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.676 Vali Acc: 0.825 Test Loss: 0.676 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5567190647125244
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 213120
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8252947330474854
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 1.678 Vali Acc: 0.431 Test Loss: 1.678 Test Acc: 0.431
Validation loss decreased (inf --> -0.431233).  Saving model ...
Epoch: 2 cost time: 1.3687701225280762
Epoch: 2, Steps: 8 | Train Loss: 1.347 Vali Loss: 0.840 Vali Acc: 0.822 Test Loss: 0.840 Test Acc: 0.822
Validation loss decreased (-0.431233 --> -0.821867).  Saving model ...
Epoch: 3 cost time: 1.1652758121490479
Epoch: 3, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
Validation loss decreased (-0.821867 --> -0.831245).  Saving model ...
Epoch: 4 cost time: 1.307607650756836
Epoch: 4, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.2923800945281982
Epoch: 5, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 1.1521611213684082
Epoch: 6, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0861032009124756
Epoch: 7, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
Validation loss decreased (-0.859370 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 1.19547700881958
Epoch: 8, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.594 Vali Acc: 0.834 Test Loss: 0.594 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3153669834136963
Epoch: 9, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.527 Vali Acc: 0.869 Test Loss: 0.527 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2767014503479004
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.502 Vali Acc: 0.866 Test Loss: 0.502 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2494349479675293
Epoch: 11, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.520 Vali Acc: 0.869 Test Loss: 0.520 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3514456748962402
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.281909465789795
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2305173873901367
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3330116271972656
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.863 Test Loss: 0.586 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1979913711547852
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1515717506408691
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 213120
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.384596347808838
Epoch: 1, Steps: 8 | Train Loss: 2.150 Vali Loss: 1.672 Vali Acc: 0.388 Test Loss: 1.672 Test Acc: 0.388
Validation loss decreased (inf --> -0.387483).  Saving model ...
Epoch: 2 cost time: 1.4286019802093506
Epoch: 2, Steps: 8 | Train Loss: 1.230 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.387483 --> -0.749992).  Saving model ...
Epoch: 3 cost time: 1.2745180130004883
Epoch: 3, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
Validation loss decreased (-0.749992 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 1.4795303344726562
Epoch: 4, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
Validation loss decreased (-0.828119 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 1.392085075378418
Epoch: 5, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1862800121307373
Epoch: 6, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.570 Vali Acc: 0.838 Test Loss: 0.570 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.324540138244629
Epoch: 7, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.607 Vali Acc: 0.831 Test Loss: 0.607 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.282538652420044
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.740 Vali Acc: 0.816 Test Loss: 0.740 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1594429016113281
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.640 Vali Acc: 0.825 Test Loss: 0.640 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3301286697387695
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.634 Vali Acc: 0.841 Test Loss: 0.634 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2539637088775635
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.694 Vali Acc: 0.831 Test Loss: 0.694 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4640438556671143
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.801 Vali Acc: 0.822 Test Loss: 0.801 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.508122205734253
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.822 Test Loss: 0.793 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6972129344940186
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.757 Vali Acc: 0.825 Test Loss: 0.757 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 196736
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.303154468536377
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 1.673 Vali Acc: 0.378 Test Loss: 1.673 Test Acc: 0.378
Validation loss decreased (inf --> -0.378108).  Saving model ...
Epoch: 2 cost time: 1.2476189136505127
Epoch: 2, Steps: 8 | Train Loss: 1.245 Vali Loss: 0.838 Vali Acc: 0.759 Test Loss: 0.838 Test Acc: 0.759
Validation loss decreased (-0.378108 --> -0.759367).  Saving model ...
Epoch: 3 cost time: 1.5101892948150635
Epoch: 3, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
Validation loss decreased (-0.759367 --> -0.821869).  Saving model ...
Epoch: 4 cost time: 1.4407944679260254
Epoch: 4, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.821869 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 1.237457513809204
Epoch: 5, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6127068996429443
Epoch: 6, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.556 Vali Acc: 0.834 Test Loss: 0.556 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2854845523834229
Epoch: 7, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.613304853439331
Epoch: 8, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.730 Vali Acc: 0.816 Test Loss: 0.730 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2565526962280273
Epoch: 9, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.612 Vali Acc: 0.838 Test Loss: 0.612 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.489623785018921
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.620 Vali Acc: 0.847 Test Loss: 0.620 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2750308513641357
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.679 Vali Acc: 0.828 Test Loss: 0.679 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6824111938476562
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.776 Vali Acc: 0.809 Test Loss: 0.776 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4625158309936523
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.772 Vali Acc: 0.809 Test Loss: 0.772 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4255385398864746
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 196736
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.651223659515381
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 1.652 Vali Acc: 0.441 Test Loss: 1.652 Test Acc: 0.441
Validation loss decreased (inf --> -0.440608).  Saving model ...
Epoch: 2 cost time: 1.3502118587493896
Epoch: 2, Steps: 8 | Train Loss: 1.247 Vali Loss: 0.828 Vali Acc: 0.772 Test Loss: 0.828 Test Acc: 0.772
Validation loss decreased (-0.440608 --> -0.771867).  Saving model ...
Epoch: 3 cost time: 1.2502124309539795
Epoch: 3, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
Validation loss decreased (-0.771867 --> -0.821870).  Saving model ...
Epoch: 4 cost time: 1.1700773239135742
Epoch: 4, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
Validation loss decreased (-0.821870 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 1.173447608947754
Epoch: 5, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2472715377807617
Epoch: 6, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3627643585205078
Epoch: 7, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1540040969848633
Epoch: 8, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.696 Vali Acc: 0.819 Test Loss: 0.696 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3001000881195068
Epoch: 9, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.580 Vali Acc: 0.847 Test Loss: 0.580 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2493376731872559
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859369).  Saving model ...
Epoch: 11 cost time: 1.2689683437347412
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.646 Vali Acc: 0.838 Test Loss: 0.646 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3666155338287354
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.723 Vali Acc: 0.812 Test Loss: 0.723 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1604430675506592
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.725 Vali Acc: 0.825 Test Loss: 0.725 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2914812564849854
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.694 Vali Acc: 0.844 Test Loss: 0.694 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1050653457641602
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.677 Vali Acc: 0.847 Test Loss: 0.677 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.372729778289795
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.691 Vali Acc: 0.847 Test Loss: 0.691 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1650454998016357
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.841 Test Loss: 0.702 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3443200588226318
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.834 Test Loss: 0.711 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2656946182250977
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.838 Test Loss: 0.725 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3523247241973877
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.831 Test Loss: 0.742 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 196736
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.187518358230591
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 1.689 Vali Acc: 0.431 Test Loss: 1.689 Test Acc: 0.431
Validation loss decreased (inf --> -0.431233).  Saving model ...
Epoch: 2 cost time: 1.5091135501861572
Epoch: 2, Steps: 8 | Train Loss: 1.263 Vali Loss: 0.870 Vali Acc: 0.787 Test Loss: 0.870 Test Acc: 0.787
Validation loss decreased (-0.431233 --> -0.787491).  Saving model ...
Epoch: 3 cost time: 1.3793103694915771
Epoch: 3, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
Validation loss decreased (-0.787491 --> -0.809369).  Saving model ...
Epoch: 4 cost time: 1.3847556114196777
Epoch: 4, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.809369 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 1.210296630859375
Epoch: 5, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4751651287078857
Epoch: 6, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1126275062561035
Epoch: 7, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5248417854309082
Epoch: 8, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.651 Vali Acc: 0.819 Test Loss: 0.651 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2927663326263428
Epoch: 9, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.528 Vali Acc: 0.863 Test Loss: 0.528 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862495).  Saving model ...
Epoch: 10 cost time: 1.5039105415344238
Epoch: 10, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.410158395767212
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4715025424957275
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4649126529693604
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.869 Test Loss: 0.617 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868744).  Saving model ...
Epoch: 14 cost time: 1.6258690357208252
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.863 Test Loss: 0.605 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4327349662780762
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.427825689315796
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.853 Test Loss: 0.634 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4830234050750732
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.615013599395752
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5294134616851807
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.859 Test Loss: 0.658 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4440436363220215
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.853 Test Loss: 0.659 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3997015953063965
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.443784236907959
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.856 Test Loss: 0.668 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3693602085113525
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 196736
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4604339599609375
Epoch: 1, Steps: 8 | Train Loss: 1.945 Vali Loss: 1.752 Vali Acc: 0.397 Test Loss: 1.752 Test Acc: 0.397
Validation loss decreased (inf --> -0.396857).  Saving model ...
Epoch: 2 cost time: 1.247481107711792
Epoch: 2, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.140 Vali Acc: 0.753 Test Loss: 1.140 Test Acc: 0.753
Validation loss decreased (-0.396857 --> -0.753114).  Saving model ...
Epoch: 3 cost time: 1.2834382057189941
Epoch: 3, Steps: 8 | Train Loss: 0.868 Vali Loss: 0.739 Vali Acc: 0.794 Test Loss: 0.739 Test Acc: 0.794
Validation loss decreased (-0.753114 --> -0.793743).  Saving model ...
Epoch: 4 cost time: 1.083796739578247
Epoch: 4, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
Validation loss decreased (-0.793743 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 1.215571403503418
Epoch: 5, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
Validation loss decreased (-0.818744 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 1.1721117496490479
Epoch: 6, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 1.2554359436035156
Epoch: 7, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 1.3946292400360107
Epoch: 8, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.521 Vali Acc: 0.853 Test Loss: 0.521 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 1.3597133159637451
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.324732780456543
Epoch: 10, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.564 Vali Acc: 0.853 Test Loss: 0.564 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3177282810211182
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2693254947662354
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3728933334350586
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.614 Vali Acc: 0.838 Test Loss: 0.614 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2249209880828857
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3071165084838867
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.641 Vali Acc: 0.847 Test Loss: 0.641 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4413864612579346
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.847 Test Loss: 0.657 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4764931201934814
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.401864767074585
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.666 Vali Acc: 0.847 Test Loss: 0.666 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 348256
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7129156589508057
Epoch: 1, Steps: 8 | Train Loss: 1.934 Vali Loss: 1.732 Vali Acc: 0.381 Test Loss: 1.732 Test Acc: 0.381
Validation loss decreased (inf --> -0.381233).  Saving model ...
Epoch: 2 cost time: 1.3937175273895264
Epoch: 2, Steps: 8 | Train Loss: 1.441 Vali Loss: 1.121 Vali Acc: 0.762 Test Loss: 1.121 Test Acc: 0.762
Validation loss decreased (-0.381233 --> -0.762489).  Saving model ...
Epoch: 3 cost time: 1.1769659519195557
Epoch: 3, Steps: 8 | Train Loss: 0.847 Vali Loss: 0.727 Vali Acc: 0.806 Test Loss: 0.727 Test Acc: 0.806
Validation loss decreased (-0.762489 --> -0.806243).  Saving model ...
Epoch: 4 cost time: 1.201183557510376
Epoch: 4, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 5 cost time: 1.2600162029266357
Epoch: 5, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
Validation loss decreased (-0.809369 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 1.3427481651306152
Epoch: 6, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 1.3095405101776123
Epoch: 7, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 1.4636926651000977
Epoch: 8, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 1.2920589447021484
Epoch: 9, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5204215049743652
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6595962047576904
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.592 Vali Acc: 0.847 Test Loss: 0.592 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4783475399017334
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4101026058197021
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.626 Vali Acc: 0.847 Test Loss: 0.626 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5330417156219482
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.624 Vali Acc: 0.834 Test Loss: 0.624 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.628380537033081
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5180718898773193
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.657 Vali Acc: 0.841 Test Loss: 0.657 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.498377799987793
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4125897884368896
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.844 Test Loss: 0.675 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 348256
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2638320922851562
Epoch: 1, Steps: 8 | Train Loss: 1.907 Vali Loss: 1.721 Vali Acc: 0.406 Test Loss: 1.721 Test Acc: 0.406
Validation loss decreased (inf --> -0.406233).  Saving model ...
Epoch: 2 cost time: 1.2900733947753906
Epoch: 2, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.111 Vali Acc: 0.778 Test Loss: 1.111 Test Acc: 0.778
Validation loss decreased (-0.406233 --> -0.778114).  Saving model ...
Epoch: 3 cost time: 1.245701789855957
Epoch: 3, Steps: 8 | Train Loss: 0.848 Vali Loss: 0.716 Vali Acc: 0.806 Test Loss: 0.716 Test Acc: 0.806
Validation loss decreased (-0.778114 --> -0.806243).  Saving model ...
Epoch: 4 cost time: 1.2896642684936523
Epoch: 4, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
Validation loss decreased (-0.806243 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 1.2602665424346924
Epoch: 5, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.818744 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.3342909812927246
Epoch: 6, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3476102352142334
Epoch: 7, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.515 Vali Acc: 0.853 Test Loss: 0.515 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 1.3920612335205078
Epoch: 8, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4378881454467773
Epoch: 9, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3277297019958496
Epoch: 10, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 1.3831446170806885
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3579926490783691
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.602 Vali Acc: 0.847 Test Loss: 0.602 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3465626239776611
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.610 Vali Acc: 0.847 Test Loss: 0.610 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4139153957366943
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2564806938171387
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.364675521850586
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3202178478240967
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.626 Vali Acc: 0.853 Test Loss: 0.626 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.268326997756958
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.853 Test Loss: 0.637 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.286172866821289
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1206672191619873
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 348256
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5717010498046875
Epoch: 1, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.705 Vali Acc: 0.487 Test Loss: 1.705 Test Acc: 0.487
Validation loss decreased (inf --> -0.487483).  Saving model ...
Epoch: 2 cost time: 1.352525234222412
Epoch: 2, Steps: 8 | Train Loss: 1.443 Vali Loss: 1.138 Vali Acc: 0.778 Test Loss: 1.138 Test Acc: 0.778
Validation loss decreased (-0.487483 --> -0.778114).  Saving model ...
Epoch: 3 cost time: 1.3122341632843018
Epoch: 3, Steps: 8 | Train Loss: 0.883 Vali Loss: 0.746 Vali Acc: 0.809 Test Loss: 0.746 Test Acc: 0.809
Validation loss decreased (-0.778114 --> -0.809368).  Saving model ...
Epoch: 4 cost time: 1.1374683380126953
Epoch: 4, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 1.3251194953918457
Epoch: 5, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
Validation loss decreased (-0.818744 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.437152624130249
Epoch: 6, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3952465057373047
Epoch: 7, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 1.3217461109161377
Epoch: 8, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 1.3893156051635742
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2526013851165771
Epoch: 10, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.486 Vali Acc: 0.866 Test Loss: 0.486 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 1.297546148300171
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.505 Vali Acc: 0.866 Test Loss: 0.505 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2247669696807861
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.506 Vali Acc: 0.869 Test Loss: 0.506 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 13 cost time: 1.1999025344848633
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.493 Vali Acc: 0.869 Test Loss: 0.493 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868745).  Saving model ...
Epoch: 14 cost time: 1.1574532985687256
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.494 Vali Acc: 0.869 Test Loss: 0.494 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3597002029418945
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 16 cost time: 1.158562421798706
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.518 Vali Acc: 0.866 Test Loss: 0.518 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2888741493225098
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.528 Vali Acc: 0.866 Test Loss: 0.528 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2852978706359863
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 1.2414913177490234
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
Validation loss decreased (-0.874995 --> -0.878120).  Saving model ...
Epoch: 20 cost time: 1.3449721336364746
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1534326076507568
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.338860034942627
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4268615245819092
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.869 Test Loss: 0.538 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1790814399719238
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.869 Test Loss: 0.541 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3145568370819092
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2509880065917969
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3054513931274414
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.869 Test Loss: 0.552 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1290485858917236
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.866 Test Loss: 0.565 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.122804880142212
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.863 Test Loss: 0.568 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 348256
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.213085174560547
Epoch: 1, Steps: 8 | Train Loss: 2.322 Vali Loss: 1.981 Vali Acc: 0.194 Test Loss: 1.981 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 1.179114818572998
Epoch: 2, Steps: 8 | Train Loss: 1.707 Vali Loss: 1.274 Vali Acc: 0.613 Test Loss: 1.274 Test Acc: 0.613
Validation loss decreased (-0.193730 --> -0.612487).  Saving model ...
Epoch: 3 cost time: 1.4287993907928467
Epoch: 3, Steps: 8 | Train Loss: 1.010 Vali Loss: 0.803 Vali Acc: 0.781 Test Loss: 0.803 Test Acc: 0.781
Validation loss decreased (-0.612487 --> -0.781242).  Saving model ...
Epoch: 4 cost time: 1.2993168830871582
Epoch: 4, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
Validation loss decreased (-0.781242 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 1.3433496952056885
Epoch: 5, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.821869 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.2042453289031982
Epoch: 6, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1258838176727295
Epoch: 7, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 1.2782833576202393
Epoch: 8, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 1.1568801403045654
Epoch: 9, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2686903476715088
Epoch: 10, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.9986517429351807
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.532 Vali Acc: 0.853 Test Loss: 0.532 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 1.129788875579834
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.253129482269287
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3156533241271973
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.597 Vali Acc: 0.834 Test Loss: 0.597 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3440701961517334
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4458849430084229
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.639 Vali Acc: 0.838 Test Loss: 0.639 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4651079177856445
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.652 Vali Acc: 0.828 Test Loss: 0.652 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.408820629119873
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3162541389465332
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.648 Vali Acc: 0.838 Test Loss: 0.648 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4082000255584717
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.179236650466919
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.655 Vali Acc: 0.841 Test Loss: 0.655 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 217184
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4294567108154297
Epoch: 1, Steps: 8 | Train Loss: 2.316 Vali Loss: 1.984 Vali Acc: 0.203 Test Loss: 1.984 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 1.2663171291351318
Epoch: 2, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.277 Vali Acc: 0.637 Test Loss: 1.277 Test Acc: 0.637
Validation loss decreased (-0.203105 --> -0.637487).  Saving model ...
Epoch: 3 cost time: 1.2431414127349854
Epoch: 3, Steps: 8 | Train Loss: 1.011 Vali Loss: 0.807 Vali Acc: 0.784 Test Loss: 0.807 Test Acc: 0.784
Validation loss decreased (-0.637487 --> -0.784367).  Saving model ...
Epoch: 4 cost time: 1.3450708389282227
Epoch: 4, Steps: 8 | Train Loss: 0.583 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
Validation loss decreased (-0.784367 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 1.3776004314422607
Epoch: 5, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.3378500938415527
Epoch: 6, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.328993320465088
Epoch: 7, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.514 Vali Acc: 0.853 Test Loss: 0.514 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 1.429868221282959
Epoch: 8, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.2852299213409424
Epoch: 9, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1246321201324463
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3776679039001465
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.545 Vali Acc: 0.863 Test Loss: 0.545 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 12 cost time: 1.126370906829834
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3197858333587646
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2821838855743408
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3194093704223633
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.637 Vali Acc: 0.838 Test Loss: 0.637 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.459359884262085
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.657 Vali Acc: 0.838 Test Loss: 0.657 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3500018119812012
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.669 Vali Acc: 0.838 Test Loss: 0.669 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3444275856018066
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5890536308288574
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.853 Test Loss: 0.662 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4876909255981445
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2832529544830322
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 217184
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4328548908233643
Epoch: 1, Steps: 8 | Train Loss: 2.325 Vali Loss: 1.966 Vali Acc: 0.178 Test Loss: 1.966 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 1.2752652168273926
Epoch: 2, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
Validation loss decreased (-0.178105 --> -0.649987).  Saving model ...
Epoch: 3 cost time: 1.2578561305999756
Epoch: 3, Steps: 8 | Train Loss: 1.013 Vali Loss: 0.791 Vali Acc: 0.784 Test Loss: 0.791 Test Acc: 0.784
Validation loss decreased (-0.649987 --> -0.784367).  Saving model ...
Epoch: 4 cost time: 1.2851409912109375
Epoch: 4, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.573 Vali Acc: 0.831 Test Loss: 0.573 Test Acc: 0.831
Validation loss decreased (-0.784367 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 1.0797088146209717
Epoch: 5, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 1.2772958278656006
Epoch: 6, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.494 Vali Acc: 0.834 Test Loss: 0.494 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1058337688446045
Epoch: 7, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 1.3338384628295898
Epoch: 8, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.2350261211395264
Epoch: 9, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3544371128082275
Epoch: 10, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2290980815887451
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.519 Vali Acc: 0.859 Test Loss: 0.519 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2951054573059082
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2791311740875244
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.552 Vali Acc: 0.853 Test Loss: 0.552 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1034419536590576
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.565 Vali Acc: 0.859 Test Loss: 0.565 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4001233577728271
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.584 Vali Acc: 0.847 Test Loss: 0.584 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2594237327575684
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.312736988067627
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.629 Vali Acc: 0.847 Test Loss: 0.629 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2589330673217773
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 217184
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2252824306488037
Epoch: 1, Steps: 8 | Train Loss: 2.229 Vali Loss: 1.930 Vali Acc: 0.209 Test Loss: 1.930 Test Acc: 0.209
Validation loss decreased (inf --> -0.209356).  Saving model ...
Epoch: 2 cost time: 1.124361515045166
Epoch: 2, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.275 Vali Acc: 0.678 Test Loss: 1.275 Test Acc: 0.678
Validation loss decreased (-0.209356 --> -0.678112).  Saving model ...
Epoch: 3 cost time: 1.2729737758636475
Epoch: 3, Steps: 8 | Train Loss: 1.024 Vali Loss: 0.828 Vali Acc: 0.784 Test Loss: 0.828 Test Acc: 0.784
Validation loss decreased (-0.678112 --> -0.784367).  Saving model ...
Epoch: 4 cost time: 1.073051929473877
Epoch: 4, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.590 Vali Acc: 0.819 Test Loss: 0.590 Test Acc: 0.819
Validation loss decreased (-0.784367 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 1.3174190521240234
Epoch: 5, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 1.424727439880371
Epoch: 6, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.491 Vali Acc: 0.825 Test Loss: 0.491 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.262138843536377
Epoch: 7, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 1.3906147480010986
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.5606300830841064
Epoch: 9, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 1.3449738025665283
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 1.1687262058258057
Epoch: 11, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.463 Vali Acc: 0.863 Test Loss: 0.463 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 12 cost time: 1.4513132572174072
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.486 Vali Acc: 0.869 Test Loss: 0.486 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 13 cost time: 1.4705147743225098
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.510 Vali Acc: 0.866 Test Loss: 0.510 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3613440990447998
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3682446479797363
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.519 Vali Acc: 0.869 Test Loss: 0.519 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3089001178741455
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.525 Vali Acc: 0.869 Test Loss: 0.525 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3554644584655762
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.546 Vali Acc: 0.863 Test Loss: 0.546 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.296088457107544
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.540 Vali Acc: 0.863 Test Loss: 0.540 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3431456089019775
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.525 Vali Acc: 0.866 Test Loss: 0.525 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4487617015838623
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
Validation loss decreased (-0.868745 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 1.32425856590271
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.872 Test Loss: 0.537 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3651273250579834
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.550 Vali Acc: 0.875 Test Loss: 0.550 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.382474660873413
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4867353439331055
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4568202495574951
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3985793590545654
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
Validation loss decreased (-0.874995 --> -0.878119).  Saving model ...
Epoch: 27 cost time: 1.5177655220031738
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.377119779586792
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.872 Test Loss: 0.559 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.357062816619873
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.351651668548584
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3939287662506104
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.875 Test Loss: 0.567 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3157057762145996
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2598962783813477
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.413198471069336
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.875 Test Loss: 0.581 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4457674026489258
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4122095108032227
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 217184
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2961881160736084
Epoch: 1, Steps: 8 | Train Loss: 2.112 Vali Loss: 1.850 Vali Acc: 0.297 Test Loss: 1.850 Test Acc: 0.297
Validation loss decreased (inf --> -0.296857).  Saving model ...
Epoch: 2 cost time: 1.3733625411987305
Epoch: 2, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.222 Vali Acc: 0.662 Test Loss: 1.222 Test Acc: 0.662
Validation loss decreased (-0.296857 --> -0.662488).  Saving model ...
Epoch: 3 cost time: 1.1601414680480957
Epoch: 3, Steps: 8 | Train Loss: 0.936 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
Validation loss decreased (-0.662488 --> -0.799992).  Saving model ...
Epoch: 4 cost time: 1.2865800857543945
Epoch: 4, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.799992 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 1.2730865478515625
Epoch: 5, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 1.3817763328552246
Epoch: 6, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.523 Vali Acc: 0.828 Test Loss: 0.523 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2670910358428955
Epoch: 7, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 1.2542707920074463
Epoch: 8, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 1.3309502601623535
Epoch: 9, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 1.3363702297210693
Epoch: 10, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.553 Vali Acc: 0.838 Test Loss: 0.553 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4627459049224854
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.576 Vali Acc: 0.831 Test Loss: 0.576 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5903997421264648
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.447004795074463
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.587 Vali Acc: 0.834 Test Loss: 0.587 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3524017333984375
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.600 Vali Acc: 0.838 Test Loss: 0.600 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3762028217315674
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.628 Vali Acc: 0.838 Test Loss: 0.628 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4326975345611572
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.662 Vali Acc: 0.838 Test Loss: 0.662 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4095594882965088
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.655 Vali Acc: 0.834 Test Loss: 0.655 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2611968517303467
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.674 Vali Acc: 0.834 Test Loss: 0.674 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4265096187591553
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.679 Vali Acc: 0.831 Test Loss: 0.679 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 151648
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5856432914733887
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 1.834 Vali Acc: 0.309 Test Loss: 1.834 Test Acc: 0.309
Validation loss decreased (inf --> -0.309357).  Saving model ...
Epoch: 2 cost time: 1.3175442218780518
Epoch: 2, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.211 Vali Acc: 0.703 Test Loss: 1.211 Test Acc: 0.703
Validation loss decreased (-0.309357 --> -0.703113).  Saving model ...
Epoch: 3 cost time: 1.238487958908081
Epoch: 3, Steps: 8 | Train Loss: 0.934 Vali Loss: 0.765 Vali Acc: 0.803 Test Loss: 0.765 Test Acc: 0.803
Validation loss decreased (-0.703113 --> -0.803117).  Saving model ...
Epoch: 4 cost time: 1.2294182777404785
Epoch: 4, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.579 Vali Acc: 0.806 Test Loss: 0.579 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806244).  Saving model ...
Epoch: 5 cost time: 1.375044822692871
Epoch: 5, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
Validation loss decreased (-0.806244 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 1.3844337463378906
Epoch: 6, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.255934715270996
Epoch: 7, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1932992935180664
Epoch: 8, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 1.203409194946289
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.553 Vali Acc: 0.847 Test Loss: 0.553 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 10 cost time: 1.1724801063537598
Epoch: 10, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1850636005401611
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.575 Vali Acc: 0.847 Test Loss: 0.575 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2701518535614014
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3665306568145752
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1136913299560547
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.1687898635864258
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.628 Vali Acc: 0.841 Test Loss: 0.628 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1091220378875732
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2249925136566162
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.653 Vali Acc: 0.841 Test Loss: 0.653 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3129587173461914
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.672 Vali Acc: 0.841 Test Loss: 0.672 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1965711116790771
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.682 Vali Acc: 0.844 Test Loss: 0.682 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.234208583831787
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.695 Vali Acc: 0.838 Test Loss: 0.695 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2354204654693604
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.705 Vali Acc: 0.841 Test Loss: 0.705 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1421408653259277
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.697 Vali Acc: 0.841 Test Loss: 0.697 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3009190559387207
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3807482719421387
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.706 Vali Acc: 0.841 Test Loss: 0.706 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 151648
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4433681964874268
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.814 Vali Acc: 0.322 Test Loss: 1.814 Test Acc: 0.322
Validation loss decreased (inf --> -0.321857).  Saving model ...
Epoch: 2 cost time: 1.2996704578399658
Epoch: 2, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.193 Vali Acc: 0.744 Test Loss: 1.193 Test Acc: 0.744
Validation loss decreased (-0.321857 --> -0.743738).  Saving model ...
Epoch: 3 cost time: 1.3305776119232178
Epoch: 3, Steps: 8 | Train Loss: 0.930 Vali Loss: 0.753 Vali Acc: 0.797 Test Loss: 0.753 Test Acc: 0.797
Validation loss decreased (-0.743738 --> -0.796867).  Saving model ...
Epoch: 4 cost time: 1.2614214420318604
Epoch: 4, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
Validation loss decreased (-0.796867 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 1.2848036289215088
Epoch: 5, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.496 Vali Acc: 0.831 Test Loss: 0.496 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 1.3517515659332275
Epoch: 6, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 1.16219162940979
Epoch: 7, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 1.161595344543457
Epoch: 8, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.2315683364868164
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.386695384979248
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3957865238189697
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.299964427947998
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4193425178527832
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5147302150726318
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2953155040740967
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.592 Vali Acc: 0.847 Test Loss: 0.592 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1621835231781006
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2281296253204346
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4414832592010498
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 151648
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5014233589172363
Epoch: 1, Steps: 8 | Train Loss: 2.095 Vali Loss: 1.855 Vali Acc: 0.278 Test Loss: 1.855 Test Acc: 0.278
Validation loss decreased (inf --> -0.278106).  Saving model ...
Epoch: 2 cost time: 1.266998052597046
Epoch: 2, Steps: 8 | Train Loss: 1.638 Vali Loss: 1.265 Vali Acc: 0.728 Test Loss: 1.265 Test Acc: 0.728
Validation loss decreased (-0.278106 --> -0.728112).  Saving model ...
Epoch: 3 cost time: 1.3512496948242188
Epoch: 3, Steps: 8 | Train Loss: 1.010 Vali Loss: 0.826 Vali Acc: 0.803 Test Loss: 0.826 Test Acc: 0.803
Validation loss decreased (-0.728112 --> -0.803117).  Saving model ...
Epoch: 4 cost time: 1.2532448768615723
Epoch: 4, Steps: 8 | Train Loss: 0.621 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1255083084106445
Epoch: 5, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
Validation loss decreased (-0.803117 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.1495251655578613
Epoch: 6, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2289142608642578
Epoch: 7, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2512376308441162
Epoch: 8, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.834370 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.2445611953735352
Epoch: 9, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 1.3955299854278564
Epoch: 10, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3921701908111572
Epoch: 11, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.517 Vali Acc: 0.853 Test Loss: 0.517 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2570645809173584
Epoch: 12, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5002532005310059
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
Validation loss decreased (-0.856245 --> -0.871870).  Saving model ...
Epoch: 14 cost time: 1.2707188129425049
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
Validation loss decreased (-0.871870 --> -0.878120).  Saving model ...
Epoch: 15 cost time: 1.2201719284057617
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1828718185424805
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3703153133392334
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.566 Vali Acc: 0.863 Test Loss: 0.566 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4287090301513672
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.346919059753418
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5855987071990967
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.583 Vali Acc: 0.866 Test Loss: 0.583 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3040611743927002
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.595 Vali Acc: 0.859 Test Loss: 0.595 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6283724308013916
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.588 Vali Acc: 0.869 Test Loss: 0.588 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5544953346252441
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.869 Test Loss: 0.583 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.505692958831787
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.866 Test Loss: 0.595 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 151648
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3270907402038574
Epoch: 1, Steps: 8 | Train Loss: 2.429 Vali Loss: 2.127 Vali Acc: 0.094 Test Loss: 2.127 Test Acc: 0.094
Validation loss decreased (inf --> -0.093729).  Saving model ...
Epoch: 2 cost time: 1.2535779476165771
Epoch: 2, Steps: 8 | Train Loss: 1.848 Vali Loss: 1.409 Vali Acc: 0.653 Test Loss: 1.409 Test Acc: 0.653
Validation loss decreased (-0.093729 --> -0.653111).  Saving model ...
Epoch: 3 cost time: 1.2448334693908691
Epoch: 3, Steps: 8 | Train Loss: 1.114 Vali Loss: 0.857 Vali Acc: 0.791 Test Loss: 0.857 Test Acc: 0.791
Validation loss decreased (-0.653111 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 1.3904345035552979
Epoch: 4, Steps: 8 | Train Loss: 0.640 Vali Loss: 0.605 Vali Acc: 0.834 Test Loss: 0.605 Test Acc: 0.834
Validation loss decreased (-0.790616 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 1.351109504699707
Epoch: 5, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
Validation loss decreased (-0.834369 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 1.4358890056610107
Epoch: 6, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3728935718536377
Epoch: 7, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2595410346984863
Epoch: 8, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.313619613647461
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3128585815429688
Epoch: 10, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2127158641815186
Epoch: 11, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1889538764953613
Epoch: 12, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.584 Vali Acc: 0.834 Test Loss: 0.584 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.156144380569458
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3859829902648926
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.610 Vali Acc: 0.847 Test Loss: 0.610 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.422511339187622
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.634 Vali Acc: 0.831 Test Loss: 0.634 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 118880
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.388427972793579
Epoch: 1, Steps: 8 | Train Loss: 2.421 Vali Loss: 2.119 Vali Acc: 0.116 Test Loss: 2.119 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 1.2440285682678223
Epoch: 2, Steps: 8 | Train Loss: 1.853 Vali Loss: 1.403 Vali Acc: 0.653 Test Loss: 1.403 Test Acc: 0.653
Validation loss decreased (-0.115604 --> -0.653111).  Saving model ...
Epoch: 3 cost time: 1.3743486404418945
Epoch: 3, Steps: 8 | Train Loss: 1.109 Vali Loss: 0.854 Vali Acc: 0.787 Test Loss: 0.854 Test Acc: 0.787
Validation loss decreased (-0.653111 --> -0.787491).  Saving model ...
Epoch: 4 cost time: 1.2905805110931396
Epoch: 4, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.601 Vali Acc: 0.831 Test Loss: 0.601 Test Acc: 0.831
Validation loss decreased (-0.787491 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 1.1833314895629883
Epoch: 5, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
Validation loss decreased (-0.831244 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 1.2850403785705566
Epoch: 6, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1571314334869385
Epoch: 7, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1756384372711182
Epoch: 8, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2729933261871338
Epoch: 9, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4219884872436523
Epoch: 10, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4034130573272705
Epoch: 11, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.637789249420166
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4071412086486816
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.628 Vali Acc: 0.831 Test Loss: 0.628 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5416862964630127
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4272112846374512
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.630 Vali Acc: 0.838 Test Loss: 0.630 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 118880
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3408634662628174
Epoch: 1, Steps: 8 | Train Loss: 2.425 Vali Loss: 2.123 Vali Acc: 0.087 Test Loss: 2.123 Test Acc: 0.087
Validation loss decreased (inf --> -0.087479).  Saving model ...
Epoch: 2 cost time: 1.2922511100769043
Epoch: 2, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.413 Vali Acc: 0.662 Test Loss: 1.413 Test Acc: 0.662
Validation loss decreased (-0.087479 --> -0.662486).  Saving model ...
Epoch: 3 cost time: 1.3361444473266602
Epoch: 3, Steps: 8 | Train Loss: 1.113 Vali Loss: 0.865 Vali Acc: 0.778 Test Loss: 0.865 Test Acc: 0.778
Validation loss decreased (-0.662486 --> -0.778116).  Saving model ...
Epoch: 4 cost time: 1.3668022155761719
Epoch: 4, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.608 Vali Acc: 0.816 Test Loss: 0.608 Test Acc: 0.816
Validation loss decreased (-0.778116 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 1.3933699131011963
Epoch: 5, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.815619 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.4129812717437744
Epoch: 6, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 1.4239435195922852
Epoch: 7, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2324845790863037
Epoch: 8, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2472615242004395
Epoch: 9, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3818869590759277
Epoch: 10, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2485673427581787
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2424023151397705
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 1.412355899810791
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.599 Vali Acc: 0.853 Test Loss: 0.599 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.292959451675415
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.592 Vali Acc: 0.847 Test Loss: 0.592 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.357602834701538
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.614 Vali Acc: 0.841 Test Loss: 0.614 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3695082664489746
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1542913913726807
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.659 Vali Acc: 0.841 Test Loss: 0.659 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.303168773651123
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.644 Vali Acc: 0.847 Test Loss: 0.644 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2457172870635986
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.847 Test Loss: 0.651 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1036081314086914
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.663 Vali Acc: 0.856 Test Loss: 0.663 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856243).  Saving model ...
Epoch: 21 cost time: 1.1530358791351318
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.083728313446045
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0696983337402344
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.678 Vali Acc: 0.847 Test Loss: 0.678 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3288209438323975
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.673 Vali Acc: 0.847 Test Loss: 0.673 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3891422748565674
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2252871990203857
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.688 Vali Acc: 0.847 Test Loss: 0.688 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.289487361907959
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2745327949523926
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.691 Vali Acc: 0.847 Test Loss: 0.691 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1732549667358398
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.853 Test Loss: 0.696 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.319253921508789
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.847 Test Loss: 0.703 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 118880
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.436959743499756
Epoch: 1, Steps: 8 | Train Loss: 2.393 Vali Loss: 2.096 Vali Acc: 0.128 Test Loss: 2.096 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 1.1732215881347656
Epoch: 2, Steps: 8 | Train Loss: 1.888 Vali Loss: 1.436 Vali Acc: 0.631 Test Loss: 1.436 Test Acc: 0.631
Validation loss decreased (-0.128104 --> -0.631236).  Saving model ...
Epoch: 3 cost time: 1.3607285022735596
Epoch: 3, Steps: 8 | Train Loss: 1.178 Vali Loss: 0.907 Vali Acc: 0.775 Test Loss: 0.907 Test Acc: 0.775
Validation loss decreased (-0.631236 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 1.1725249290466309
Epoch: 4, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
Validation loss decreased (-0.774991 --> -0.809369).  Saving model ...
Epoch: 5 cost time: 1.1611425876617432
Epoch: 5, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.809369 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.289792776107788
Epoch: 6, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 1.3743772506713867
Epoch: 7, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2735393047332764
Epoch: 8, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2979724407196045
Epoch: 9, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1033527851104736
Epoch: 10, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.1267085075378418
Epoch: 11, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2839915752410889
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 1.1850523948669434
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.529 Vali Acc: 0.859 Test Loss: 0.529 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 14 cost time: 1.2168493270874023
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.157973289489746
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.554 Vali Acc: 0.859 Test Loss: 0.554 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2163348197937012
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.586 Vali Acc: 0.853 Test Loss: 0.586 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3695433139801025
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2166988849639893
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.564 Vali Acc: 0.863 Test Loss: 0.564 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862494).  Saving model ...
Epoch: 19 cost time: 1.2039210796356201
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.564 Vali Acc: 0.863 Test Loss: 0.564 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3123888969421387
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0670969486236572
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.589 Vali Acc: 0.853 Test Loss: 0.589 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4193875789642334
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.581 Vali Acc: 0.863 Test Loss: 0.581 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2330808639526367
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.579 Vali Acc: 0.866 Test Loss: 0.579 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865619).  Saving model ...
Epoch: 24 cost time: 1.249563455581665
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.869 Test Loss: 0.582 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868744).  Saving model ...
Epoch: 25 cost time: 1.2308638095855713
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871869).  Saving model ...
Epoch: 26 cost time: 1.5298473834991455
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.602 Vali Acc: 0.866 Test Loss: 0.602 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3623714447021484
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.590 Vali Acc: 0.869 Test Loss: 0.590 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3214313983917236
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.593 Vali Acc: 0.869 Test Loss: 0.593 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3399505615234375
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.866 Test Loss: 0.609 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2226991653442383
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.866 Test Loss: 0.624 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3626773357391357
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.352243185043335
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.869 Test Loss: 0.610 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4653384685516357
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.614 Vali Acc: 0.869 Test Loss: 0.614 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3689954280853271
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.869 Test Loss: 0.621 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3076748847961426
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.872 Test Loss: 0.626 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 118880
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.690063238143921
Epoch: 1, Steps: 8 | Train Loss: 2.106 Vali Loss: 1.811 Vali Acc: 0.325 Test Loss: 1.811 Test Acc: 0.325
Validation loss decreased (inf --> -0.324982).  Saving model ...
Epoch: 2 cost time: 1.1385140419006348
Epoch: 2, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.206 Vali Acc: 0.694 Test Loss: 1.206 Test Acc: 0.694
Validation loss decreased (-0.324982 --> -0.693738).  Saving model ...
Epoch: 3 cost time: 1.2194499969482422
Epoch: 3, Steps: 8 | Train Loss: 0.877 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
Validation loss decreased (-0.693738 --> -0.774992).  Saving model ...
Epoch: 4 cost time: 1.1452598571777344
Epoch: 4, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799994).  Saving model ...
Epoch: 5 cost time: 1.1706101894378662
Epoch: 5, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.799994 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.1442937850952148
Epoch: 6, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.243830919265747
Epoch: 7, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 1.200861930847168
Epoch: 8, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1366877555847168
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.281578540802002
Epoch: 10, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.525 Vali Acc: 0.859 Test Loss: 0.525 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 1.1405315399169922
Epoch: 11, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.195706844329834
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3956785202026367
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1562423706054688
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.600 Vali Acc: 0.847 Test Loss: 0.600 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2271523475646973
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3392605781555176
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.645 Vali Acc: 0.841 Test Loss: 0.645 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2568449974060059
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2157483100891113
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2574732303619385
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.666 Vali Acc: 0.844 Test Loss: 0.666 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.394085168838501
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.683 Vali Acc: 0.844 Test Loss: 0.683 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 102496
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2420191764831543
Epoch: 1, Steps: 8 | Train Loss: 2.097 Vali Loss: 1.818 Vali Acc: 0.312 Test Loss: 1.818 Test Acc: 0.312
Validation loss decreased (inf --> -0.312482).  Saving model ...
Epoch: 2 cost time: 1.172987461090088
Epoch: 2, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.213 Vali Acc: 0.681 Test Loss: 1.213 Test Acc: 0.681
Validation loss decreased (-0.312482 --> -0.681238).  Saving model ...
Epoch: 3 cost time: 1.211376428604126
Epoch: 3, Steps: 8 | Train Loss: 0.885 Vali Loss: 0.795 Vali Acc: 0.762 Test Loss: 0.795 Test Acc: 0.762
Validation loss decreased (-0.681238 --> -0.762492).  Saving model ...
Epoch: 4 cost time: 1.3123772144317627
Epoch: 4, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
Validation loss decreased (-0.762492 --> -0.803119).  Saving model ...
Epoch: 5 cost time: 1.253061294555664
Epoch: 5, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
Validation loss decreased (-0.803119 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 1.3459787368774414
Epoch: 6, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2522640228271484
Epoch: 7, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.3458409309387207
Epoch: 8, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4464969635009766
Epoch: 9, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.26942777633667
Epoch: 10, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 1.210803508758545
Epoch: 11, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.387448787689209
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3496952056884766
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.601 Vali Acc: 0.841 Test Loss: 0.601 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5954267978668213
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3035809993743896
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.612 Vali Acc: 0.847 Test Loss: 0.612 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3553428649902344
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2790820598602295
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.662 Vali Acc: 0.841 Test Loss: 0.662 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2391431331634521
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.660 Vali Acc: 0.847 Test Loss: 0.660 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.284165859222412
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.667 Vali Acc: 0.847 Test Loss: 0.667 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3306303024291992
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.687 Vali Acc: 0.850 Test Loss: 0.687 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 102496
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4445810317993164
Epoch: 1, Steps: 8 | Train Loss: 2.071 Vali Loss: 1.805 Vali Acc: 0.312 Test Loss: 1.805 Test Acc: 0.312
Validation loss decreased (inf --> -0.312482).  Saving model ...
Epoch: 2 cost time: 1.0844309329986572
Epoch: 2, Steps: 8 | Train Loss: 1.518 Vali Loss: 1.203 Vali Acc: 0.700 Test Loss: 1.203 Test Acc: 0.700
Validation loss decreased (-0.312482 --> -0.699988).  Saving model ...
Epoch: 3 cost time: 1.3081955909729004
Epoch: 3, Steps: 8 | Train Loss: 0.874 Vali Loss: 0.785 Vali Acc: 0.778 Test Loss: 0.785 Test Acc: 0.778
Validation loss decreased (-0.699988 --> -0.778117).  Saving model ...
Epoch: 4 cost time: 0.9789595603942871
Epoch: 4, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.601 Vali Acc: 0.806 Test Loss: 0.601 Test Acc: 0.806
Validation loss decreased (-0.778117 --> -0.806244).  Saving model ...
Epoch: 5 cost time: 1.3566725254058838
Epoch: 5, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
Validation loss decreased (-0.806244 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.435084581375122
Epoch: 6, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.14192533493042
Epoch: 7, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 1.1046695709228516
Epoch: 8, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2532718181610107
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.520 Vali Acc: 0.859 Test Loss: 0.520 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 10 cost time: 1.3048763275146484
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 1.414621114730835
Epoch: 11, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3464632034301758
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2063908576965332
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.578 Vali Acc: 0.841 Test Loss: 0.578 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1762018203735352
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.573 Vali Acc: 0.841 Test Loss: 0.573 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2891993522644043
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.276686191558838
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.614 Vali Acc: 0.847 Test Loss: 0.614 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.253016710281372
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2752628326416016
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.626 Vali Acc: 0.853 Test Loss: 0.626 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1884660720825195
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.615 Vali Acc: 0.853 Test Loss: 0.615 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4482474327087402
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.853 Test Loss: 0.628 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 102496
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.98445987701416
Epoch: 1, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.776 Vali Acc: 0.328 Test Loss: 1.776 Test Acc: 0.328
Validation loss decreased (inf --> -0.328107).  Saving model ...
Epoch: 2 cost time: 1.178447961807251
Epoch: 2, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.218 Vali Acc: 0.728 Test Loss: 1.218 Test Acc: 0.728
Validation loss decreased (-0.328107 --> -0.728113).  Saving model ...
Epoch: 3 cost time: 1.3401572704315186
Epoch: 3, Steps: 8 | Train Loss: 0.948 Vali Loss: 0.809 Vali Acc: 0.787 Test Loss: 0.809 Test Acc: 0.787
Validation loss decreased (-0.728113 --> -0.787492).  Saving model ...
Epoch: 4 cost time: 1.2254104614257812
Epoch: 4, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
Validation loss decreased (-0.787492 --> -0.803119).  Saving model ...
Epoch: 5 cost time: 1.3176634311676025
Epoch: 5, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
Validation loss decreased (-0.803119 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 1.3630080223083496
Epoch: 6, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2849516868591309
Epoch: 7, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 1.316422939300537
Epoch: 8, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1906249523162842
Epoch: 9, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.2824127674102783
Epoch: 10, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 1.3149917125701904
Epoch: 11, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3837847709655762
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3239996433258057
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0690298080444336
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2160141468048096
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.180342674255371
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 17 cost time: 1.2005515098571777
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.570 Vali Acc: 0.869 Test Loss: 0.570 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868744).  Saving model ...
Epoch: 18 cost time: 1.0857059955596924
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.577 Vali Acc: 0.859 Test Loss: 0.577 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1034696102142334
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.569 Vali Acc: 0.869 Test Loss: 0.569 Test Acc: 0.869
Validation loss decreased (-0.868744 --> -0.868744).  Saving model ...
Epoch: 20 cost time: 1.2089388370513916
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.584 Vali Acc: 0.869 Test Loss: 0.584 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2149436473846436
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.585 Vali Acc: 0.869 Test Loss: 0.585 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1374595165252686
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.602 Vali Acc: 0.853 Test Loss: 0.602 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2460112571716309
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.17191481590271
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.594 Vali Acc: 0.863 Test Loss: 0.594 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.229546070098877
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.866 Test Loss: 0.601 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1279535293579102
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.859 Test Loss: 0.616 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1167240142822266
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2223751544952393
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.625 Vali Acc: 0.859 Test Loss: 0.625 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3271479606628418
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.869 Test Loss: 0.625 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 102496
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.197942018508911
Epoch: 1, Steps: 8 | Train Loss: 2.446 Vali Loss: 2.075 Vali Acc: 0.172 Test Loss: 2.075 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 1.18697190284729
Epoch: 2, Steps: 8 | Train Loss: 1.805 Vali Loss: 1.319 Vali Acc: 0.697 Test Loss: 1.319 Test Acc: 0.697
Validation loss decreased (-0.171854 --> -0.696862).  Saving model ...
Epoch: 3 cost time: 1.2402985095977783
Epoch: 3, Steps: 8 | Train Loss: 1.043 Vali Loss: 0.794 Vali Acc: 0.816 Test Loss: 0.794 Test Acc: 0.816
Validation loss decreased (-0.696862 --> -0.815617).  Saving model ...
Epoch: 4 cost time: 1.287862777709961
Epoch: 4, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.571 Vali Acc: 0.834 Test Loss: 0.571 Test Acc: 0.834
Validation loss decreased (-0.815617 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 1.129415512084961
Epoch: 5, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 1.1744999885559082
Epoch: 6, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1925098896026611
Epoch: 7, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 1.239135503768921
Epoch: 8, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.196958303451538
Epoch: 9, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2235541343688965
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 1.1948480606079102
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.565 Vali Acc: 0.847 Test Loss: 0.565 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.286191701889038
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4960744380950928
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.567 Vali Acc: 0.853 Test Loss: 0.567 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.450887680053711
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.598 Vali Acc: 0.847 Test Loss: 0.598 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3874266147613525
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.618 Vali Acc: 0.847 Test Loss: 0.618 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3290226459503174
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.620 Vali Acc: 0.838 Test Loss: 0.620 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2930419445037842
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.626 Vali Acc: 0.847 Test Loss: 0.626 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3566651344299316
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.259460687637329
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.679 Vali Acc: 0.831 Test Loss: 0.679 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.291841983795166
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.689 Vali Acc: 0.841 Test Loss: 0.689 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 94304
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3163163661956787
Epoch: 1, Steps: 8 | Train Loss: 2.443 Vali Loss: 2.097 Vali Acc: 0.169 Test Loss: 2.097 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 1.1728150844573975
Epoch: 2, Steps: 8 | Train Loss: 1.801 Vali Loss: 1.336 Vali Acc: 0.666 Test Loss: 1.336 Test Acc: 0.666
Validation loss decreased (-0.168729 --> -0.665612).  Saving model ...
Epoch: 3 cost time: 1.289510726928711
Epoch: 3, Steps: 8 | Train Loss: 1.039 Vali Loss: 0.808 Vali Acc: 0.809 Test Loss: 0.808 Test Acc: 0.809
Validation loss decreased (-0.665612 --> -0.809367).  Saving model ...
Epoch: 4 cost time: 1.1158151626586914
Epoch: 4, Steps: 8 | Train Loss: 0.621 Vali Loss: 0.582 Vali Acc: 0.834 Test Loss: 0.582 Test Acc: 0.834
Validation loss decreased (-0.809367 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 1.1722221374511719
Epoch: 5, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 1.264451265335083
Epoch: 6, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 1.164790153503418
Epoch: 7, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2474417686462402
Epoch: 8, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 1.11201810836792
Epoch: 9, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.158402681350708
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 1.1998507976531982
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.207620620727539
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.183758020401001
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2066409587860107
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.602 Vali Acc: 0.847 Test Loss: 0.602 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2062335014343262
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.620 Vali Acc: 0.847 Test Loss: 0.620 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3625681400299072
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.621 Vali Acc: 0.847 Test Loss: 0.621 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.412879467010498
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.631 Vali Acc: 0.853 Test Loss: 0.631 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2258014678955078
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1698789596557617
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.680 Vali Acc: 0.841 Test Loss: 0.680 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3366446495056152
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.683 Vali Acc: 0.841 Test Loss: 0.683 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 94304
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.365508794784546
Epoch: 1, Steps: 8 | Train Loss: 2.418 Vali Loss: 2.094 Vali Acc: 0.166 Test Loss: 2.094 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 1.155912160873413
Epoch: 2, Steps: 8 | Train Loss: 1.778 Vali Loss: 1.335 Vali Acc: 0.672 Test Loss: 1.335 Test Acc: 0.672
Validation loss decreased (-0.165604 --> -0.671862).  Saving model ...
Epoch: 3 cost time: 1.1397287845611572
Epoch: 3, Steps: 8 | Train Loss: 1.040 Vali Loss: 0.811 Vali Acc: 0.794 Test Loss: 0.811 Test Acc: 0.794
Validation loss decreased (-0.671862 --> -0.793742).  Saving model ...
Epoch: 4 cost time: 1.1008615493774414
Epoch: 4, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
Validation loss decreased (-0.793742 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 1.0924479961395264
Epoch: 5, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 1.2149584293365479
Epoch: 6, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2239713668823242
Epoch: 7, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.503 Vali Acc: 0.834 Test Loss: 0.503 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2209584712982178
Epoch: 8, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 1.2454884052276611
Epoch: 9, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 1.1658525466918945
Epoch: 10, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 1.3477404117584229
Epoch: 11, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.557 Vali Acc: 0.841 Test Loss: 0.557 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.251164197921753
Epoch: 12, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2431972026824951
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3270106315612793
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.578 Vali Acc: 0.847 Test Loss: 0.578 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2592966556549072
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1392619609832764
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.094569206237793
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1927096843719482
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.623 Vali Acc: 0.853 Test Loss: 0.623 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2270607948303223
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.645 Vali Acc: 0.847 Test Loss: 0.645 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3366599082946777
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.650 Vali Acc: 0.847 Test Loss: 0.650 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 94304
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4184958934783936
Epoch: 1, Steps: 8 | Train Loss: 2.388 Vali Loss: 2.120 Vali Acc: 0.156 Test Loss: 2.120 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 1.2650573253631592
Epoch: 2, Steps: 8 | Train Loss: 1.823 Vali Loss: 1.404 Vali Acc: 0.656 Test Loss: 1.404 Test Acc: 0.656
Validation loss decreased (-0.156229 --> -0.656236).  Saving model ...
Epoch: 3 cost time: 1.277503490447998
Epoch: 3, Steps: 8 | Train Loss: 1.114 Vali Loss: 0.884 Vali Acc: 0.775 Test Loss: 0.884 Test Acc: 0.775
Validation loss decreased (-0.656236 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 1.218209981918335
Epoch: 4, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.632 Vali Acc: 0.809 Test Loss: 0.632 Test Acc: 0.809
Validation loss decreased (-0.774991 --> -0.809369).  Saving model ...
Epoch: 5 cost time: 1.2108097076416016
Epoch: 5, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
Validation loss decreased (-0.809369 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.2673747539520264
Epoch: 6, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4381814002990723
Epoch: 7, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 1.2969932556152344
Epoch: 8, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.436166524887085
Epoch: 9, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4662408828735352
Epoch: 10, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 1.2665135860443115
Epoch: 11, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3263444900512695
Epoch: 12, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.540 Vali Acc: 0.847 Test Loss: 0.540 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.474147081375122
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 14 cost time: 1.2117407321929932
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.553 Vali Acc: 0.853 Test Loss: 0.553 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.344224214553833
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2661406993865967
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.367140769958496
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.580 Vali Acc: 0.853 Test Loss: 0.580 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.346583366394043
Epoch: 18, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2054097652435303
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3730719089508057
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.612 Vali Acc: 0.859 Test Loss: 0.612 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2700235843658447
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.597 Vali Acc: 0.866 Test Loss: 0.597 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865619).  Saving model ...
Epoch: 22 cost time: 1.324920654296875
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.598 Vali Acc: 0.869 Test Loss: 0.598 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868744).  Saving model ...
Epoch: 23 cost time: 1.1235980987548828
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.863 Test Loss: 0.609 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.102435827255249
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.623 Vali Acc: 0.859 Test Loss: 0.623 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3313562870025635
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.631 Vali Acc: 0.853 Test Loss: 0.631 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3556852340698242
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.631 Vali Acc: 0.859 Test Loss: 0.631 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3314549922943115
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.859 Test Loss: 0.632 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3291301727294922
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.866 Test Loss: 0.630 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3692972660064697
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.633 Vali Acc: 0.863 Test Loss: 0.633 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.40297269821167
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.645 Vali Acc: 0.863 Test Loss: 0.645 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3844425678253174
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.646 Vali Acc: 0.863 Test Loss: 0.646 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3756134510040283
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.863 Test Loss: 0.644 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 94304
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3603124618530273
Epoch: 1, Steps: 8 | Train Loss: 1.746 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
Validation loss decreased (inf --> -0.809369).  Saving model ...
Epoch: 2 cost time: 1.5131042003631592
Epoch: 2, Steps: 8 | Train Loss: 0.456 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
Validation loss decreased (-0.809369 --> -0.849993).  Saving model ...
Epoch: 3 cost time: 1.3347365856170654
Epoch: 3, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.171 Vali Acc: 0.803 Test Loss: 1.171 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5235726833343506
Epoch: 4, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.244 Vali Acc: 0.812 Test Loss: 1.244 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3852715492248535
Epoch: 5, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.396 Vali Acc: 0.841 Test Loss: 1.396 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.571789026260376
Epoch: 6, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.743 Vali Acc: 0.822 Test Loss: 1.743 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4000511169433594
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 2.232 Vali Acc: 0.809 Test Loss: 2.232 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5977952480316162
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.287 Vali Acc: 0.831 Test Loss: 2.287 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5152597427368164
Epoch: 9, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.327 Vali Acc: 0.822 Test Loss: 2.327 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5003249645233154
Epoch: 10, Steps: 8 | Train Loss: 0.126 Vali Loss: 2.191 Vali Acc: 0.838 Test Loss: 2.191 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.680443286895752
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.306 Vali Acc: 0.834 Test Loss: 2.306 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.249575138092041
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.816 Vali Acc: 0.809 Test Loss: 2.816 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 3925540
model size : 24.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3523592948913574
Epoch: 1, Steps: 8 | Train Loss: 1.737 Vali Loss: 0.617 Vali Acc: 0.803 Test Loss: 0.617 Test Acc: 0.803
Validation loss decreased (inf --> -0.803119).  Saving model ...
Epoch: 2 cost time: 1.2618744373321533
Epoch: 2, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.666 Vali Acc: 0.853 Test Loss: 0.666 Test Acc: 0.853
Validation loss decreased (-0.803119 --> -0.853118).  Saving model ...
Epoch: 3 cost time: 1.410336971282959
Epoch: 3, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.173 Vali Acc: 0.806 Test Loss: 1.173 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2672817707061768
Epoch: 4, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.245 Vali Acc: 0.819 Test Loss: 1.245 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3133721351623535
Epoch: 5, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.563 Vali Acc: 0.838 Test Loss: 1.563 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.304619312286377
Epoch: 6, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.677 Vali Acc: 0.825 Test Loss: 1.677 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3284471035003662
Epoch: 7, Steps: 8 | Train Loss: 0.102 Vali Loss: 2.383 Vali Acc: 0.825 Test Loss: 2.383 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.420753002166748
Epoch: 8, Steps: 8 | Train Loss: 0.152 Vali Loss: 2.683 Vali Acc: 0.806 Test Loss: 2.683 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4419522285461426
Epoch: 9, Steps: 8 | Train Loss: 0.289 Vali Loss: 2.346 Vali Acc: 0.825 Test Loss: 2.346 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3775949478149414
Epoch: 10, Steps: 8 | Train Loss: 0.255 Vali Loss: 2.706 Vali Acc: 0.822 Test Loss: 2.706 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.13840651512146
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 3.087 Vali Acc: 0.800 Test Loss: 3.087 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.092406988143921
Epoch: 12, Steps: 8 | Train Loss: 0.251 Vali Loss: 2.727 Vali Acc: 0.822 Test Loss: 2.727 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 3925540
model size : 24.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.40317964553833
Epoch: 1, Steps: 8 | Train Loss: 1.761 Vali Loss: 0.650 Vali Acc: 0.784 Test Loss: 0.650 Test Acc: 0.784
Validation loss decreased (inf --> -0.784369).  Saving model ...
Epoch: 2 cost time: 1.263352394104004
Epoch: 2, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.602 Vali Acc: 0.875 Test Loss: 0.602 Test Acc: 0.875
Validation loss decreased (-0.784369 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 1.1083917617797852
Epoch: 3, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.090 Vali Acc: 0.816 Test Loss: 1.090 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2327830791473389
Epoch: 4, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.136 Vali Acc: 0.838 Test Loss: 1.136 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2310490608215332
Epoch: 5, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.011 Vali Acc: 0.875 Test Loss: 1.011 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.207791805267334
Epoch: 6, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.546 Vali Acc: 0.831 Test Loss: 1.546 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.023167371749878
Epoch: 7, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.796 Vali Acc: 0.828 Test Loss: 1.796 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1958165168762207
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.605 Vali Acc: 0.850 Test Loss: 1.605 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.149491548538208
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.997 Vali Acc: 0.844 Test Loss: 1.997 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0566072463989258
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 2.116 Vali Acc: 0.806 Test Loss: 2.116 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2139294147491455
Epoch: 11, Steps: 8 | Train Loss: 0.131 Vali Loss: 2.612 Vali Acc: 0.803 Test Loss: 2.612 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2618803977966309
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.089 Vali Acc: 0.828 Test Loss: 2.089 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 3925540
model size : 24.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.373384714126587
Epoch: 1, Steps: 8 | Train Loss: 1.804 Vali Loss: 0.775 Vali Acc: 0.775 Test Loss: 0.775 Test Acc: 0.775
Validation loss decreased (inf --> -0.774992).  Saving model ...
Epoch: 2 cost time: 1.2128841876983643
Epoch: 2, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.674 Vali Acc: 0.831 Test Loss: 0.674 Test Acc: 0.831
Validation loss decreased (-0.774992 --> -0.831243).  Saving model ...
Epoch: 3 cost time: 1.1880731582641602
Epoch: 3, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.061 Vali Acc: 0.828 Test Loss: 1.061 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1084215641021729
Epoch: 4, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.224 Vali Acc: 0.828 Test Loss: 1.224 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2704548835754395
Epoch: 5, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.205 Vali Acc: 0.841 Test Loss: 1.205 Test Acc: 0.841
Validation loss decreased (-0.831243 --> -0.840613).  Saving model ...
Epoch: 6 cost time: 1.2908141613006592
Epoch: 6, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.424 Vali Acc: 0.831 Test Loss: 1.424 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0370368957519531
Epoch: 7, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.778 Vali Acc: 0.816 Test Loss: 1.778 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.005331039428711
Epoch: 8, Steps: 8 | Train Loss: 0.176 Vali Loss: 2.154 Vali Acc: 0.769 Test Loss: 2.154 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9838573932647705
Epoch: 9, Steps: 8 | Train Loss: 0.092 Vali Loss: 2.444 Vali Acc: 0.769 Test Loss: 2.444 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0647590160369873
Epoch: 10, Steps: 8 | Train Loss: 0.205 Vali Loss: 2.240 Vali Acc: 0.831 Test Loss: 2.240 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1418204307556152
Epoch: 11, Steps: 8 | Train Loss: 0.088 Vali Loss: 2.416 Vali Acc: 0.816 Test Loss: 2.416 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2471401691436768
Epoch: 12, Steps: 8 | Train Loss: 0.053 Vali Loss: 2.594 Vali Acc: 0.803 Test Loss: 2.594 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3144216537475586
Epoch: 13, Steps: 8 | Train Loss: 0.250 Vali Loss: 2.285 Vali Acc: 0.831 Test Loss: 2.285 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3627679347991943
Epoch: 14, Steps: 8 | Train Loss: 0.472 Vali Loss: 2.924 Vali Acc: 0.825 Test Loss: 2.924 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2994234561920166
Epoch: 15, Steps: 8 | Train Loss: 0.074 Vali Loss: 3.821 Vali Acc: 0.800 Test Loss: 3.821 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 3925540
model size : 24.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2528903484344482
Epoch: 1, Steps: 8 | Train Loss: 1.772 Vali Loss: 0.692 Vali Acc: 0.766 Test Loss: 0.692 Test Acc: 0.766
Validation loss decreased (inf --> -0.765618).  Saving model ...
Epoch: 2 cost time: 1.4362878799438477
Epoch: 2, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.763 Vali Acc: 0.838 Test Loss: 0.763 Test Acc: 0.838
Validation loss decreased (-0.765618 --> -0.837492).  Saving model ...
Epoch: 3 cost time: 1.247025728225708
Epoch: 3, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.086 Vali Acc: 0.825 Test Loss: 1.086 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.260469913482666
Epoch: 4, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.327 Vali Acc: 0.803 Test Loss: 1.327 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3400044441223145
Epoch: 5, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.530 Vali Acc: 0.822 Test Loss: 1.530 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2181446552276611
Epoch: 6, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.718 Vali Acc: 0.838 Test Loss: 1.718 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.307006597518921
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.193 Vali Acc: 0.800 Test Loss: 2.193 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3051717281341553
Epoch: 8, Steps: 8 | Train Loss: 0.035 Vali Loss: 2.030 Vali Acc: 0.822 Test Loss: 2.030 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.368192195892334
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.043 Vali Acc: 0.822 Test Loss: 2.043 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2934675216674805
Epoch: 10, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.307 Vali Acc: 0.809 Test Loss: 2.307 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2130968570709229
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.588 Vali Acc: 0.816 Test Loss: 2.588 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1859993934631348
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.018 Vali Acc: 0.838 Test Loss: 2.018 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 2876964
model size : 20.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3558976650238037
Epoch: 1, Steps: 8 | Train Loss: 1.761 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
Validation loss decreased (inf --> -0.774993).  Saving model ...
Epoch: 2 cost time: 1.1287412643432617
Epoch: 2, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.748 Vali Acc: 0.838 Test Loss: 0.748 Test Acc: 0.838
Validation loss decreased (-0.774993 --> -0.837493).  Saving model ...
Epoch: 3 cost time: 1.2392263412475586
Epoch: 3, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.108 Vali Acc: 0.822 Test Loss: 1.108 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3141450881958008
Epoch: 4, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.286 Vali Acc: 0.803 Test Loss: 1.286 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3271915912628174
Epoch: 5, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.399 Vali Acc: 0.834 Test Loss: 1.399 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.277230978012085
Epoch: 6, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.566 Vali Acc: 0.853 Test Loss: 1.566 Test Acc: 0.853
Validation loss decreased (-0.837493 --> -0.853109).  Saving model ...
Epoch: 7 cost time: 1.3256430625915527
Epoch: 7, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.639 Vali Acc: 0.853 Test Loss: 1.639 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.332749366760254
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.850 Test Loss: 1.630 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4161672592163086
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.844 Test Loss: 1.641 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.139939785003662
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.850 Test Loss: 1.654 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.261533498764038
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.844 Test Loss: 1.758 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.31829833984375
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.847 Test Loss: 1.823 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2493271827697754
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.844 Test Loss: 1.870 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2171027660369873
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.893 Vali Acc: 0.841 Test Loss: 1.893 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2860548496246338
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.844 Test Loss: 1.903 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2450778484344482
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.844 Test Loss: 1.906 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 2876964
model size : 20.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.399031162261963
Epoch: 1, Steps: 8 | Train Loss: 1.754 Vali Loss: 0.702 Vali Acc: 0.784 Test Loss: 0.702 Test Acc: 0.784
Validation loss decreased (inf --> -0.784368).  Saving model ...
Epoch: 2 cost time: 1.5144050121307373
Epoch: 2, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.709 Vali Acc: 0.831 Test Loss: 0.709 Test Acc: 0.831
Validation loss decreased (-0.784368 --> -0.831243).  Saving model ...
Epoch: 3 cost time: 1.3119738101959229
Epoch: 3, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.069 Vali Acc: 0.809 Test Loss: 1.069 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3185250759124756
Epoch: 4, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.190 Vali Acc: 0.822 Test Loss: 1.190 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.353259563446045
Epoch: 5, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.303 Vali Acc: 0.831 Test Loss: 1.303 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4312338829040527
Epoch: 6, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.317 Vali Acc: 0.869 Test Loss: 1.317 Test Acc: 0.869
Validation loss decreased (-0.831243 --> -0.868737).  Saving model ...
Epoch: 7 cost time: 1.427685260772705
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.853 Test Loss: 1.443 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4393723011016846
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.856 Test Loss: 1.502 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3402230739593506
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.866 Test Loss: 1.504 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5263080596923828
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.863 Test Loss: 1.495 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2983896732330322
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.869 Test Loss: 1.487 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4941844940185547
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.872 Test Loss: 1.479 Test Acc: 0.872
Validation loss decreased (-0.868737 --> -0.871860).  Saving model ...
Epoch: 13 cost time: 1.4171397686004639
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.872 Test Loss: 1.473 Test Acc: 0.872
Validation loss decreased (-0.871860 --> -0.871860).  Saving model ...
Epoch: 14 cost time: 1.4558982849121094
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.872 Test Loss: 1.468 Test Acc: 0.872
Validation loss decreased (-0.871860 --> -0.871860).  Saving model ...
Epoch: 15 cost time: 1.6025009155273438
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.872 Test Loss: 1.464 Test Acc: 0.872
Validation loss decreased (-0.871860 --> -0.871860).  Saving model ...
Epoch: 16 cost time: 1.4769084453582764
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.872 Test Loss: 1.460 Test Acc: 0.872
Validation loss decreased (-0.871860 --> -0.871860).  Saving model ...
Epoch: 17 cost time: 1.3289883136749268
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.872 Test Loss: 1.457 Test Acc: 0.872
Validation loss decreased (-0.871860 --> -0.871860).  Saving model ...
Epoch: 18 cost time: 1.439535140991211
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.872 Test Loss: 1.455 Test Acc: 0.872
Validation loss decreased (-0.871860 --> -0.871860).  Saving model ...
Epoch: 19 cost time: 1.1942954063415527
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.872 Test Loss: 1.454 Test Acc: 0.872
Validation loss decreased (-0.871860 --> -0.871860).  Saving model ...
Epoch: 20 cost time: 1.2063860893249512
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.875 Test Loss: 1.452 Test Acc: 0.875
Validation loss decreased (-0.871860 --> -0.874985).  Saving model ...
Epoch: 21 cost time: 1.4212737083435059
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.875 Test Loss: 1.449 Test Acc: 0.875
Validation loss decreased (-0.874985 --> -0.874986).  Saving model ...
Epoch: 22 cost time: 1.445603609085083
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.875 Test Loss: 1.448 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 23 cost time: 1.2630934715270996
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.875 Test Loss: 1.447 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 24 cost time: 1.4442362785339355
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.875 Test Loss: 1.445 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 25 cost time: 1.5774054527282715
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.875 Test Loss: 1.445 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 26 cost time: 1.4511189460754395
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.875 Test Loss: 1.445 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 27 cost time: 1.4455437660217285
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.875 Test Loss: 1.444 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 28 cost time: 1.4944241046905518
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.875 Test Loss: 1.444 Test Acc: 0.875
Validation loss decreased (-0.874986 --> -0.874986).  Saving model ...
Epoch: 29 cost time: 1.4501688480377197
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.872 Test Loss: 1.444 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4356906414031982
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.869 Test Loss: 1.443 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5343842506408691
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.869 Test Loss: 1.443 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.371598482131958
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.872 Test Loss: 1.442 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2616398334503174
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.872 Test Loss: 1.443 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3549599647521973
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.872 Test Loss: 1.443 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.457552194595337
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.872 Test Loss: 1.443 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3247509002685547
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.872 Test Loss: 1.442 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.501291036605835
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.872 Test Loss: 1.441 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3922882080078125
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.872 Test Loss: 1.441 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 2876964
model size : 20.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9162392616271973
Epoch: 1, Steps: 8 | Train Loss: 1.813 Vali Loss: 0.806 Vali Acc: 0.784 Test Loss: 0.806 Test Acc: 0.784
Validation loss decreased (inf --> -0.784367).  Saving model ...
Epoch: 2 cost time: 1.0174758434295654
Epoch: 2, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.752 Vali Acc: 0.791 Test Loss: 0.752 Test Acc: 0.791
Validation loss decreased (-0.784367 --> -0.790617).  Saving model ...
Epoch: 3 cost time: 1.0021519660949707
Epoch: 3, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.018 Vali Acc: 0.825 Test Loss: 1.018 Test Acc: 0.825
Validation loss decreased (-0.790617 --> -0.824990).  Saving model ...
Epoch: 4 cost time: 1.043633222579956
Epoch: 4, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.065 Vali Acc: 0.847 Test Loss: 1.065 Test Acc: 0.847
Validation loss decreased (-0.824990 --> -0.846864).  Saving model ...
Epoch: 5 cost time: 1.0981898307800293
Epoch: 5, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.240 Vali Acc: 0.853 Test Loss: 1.240 Test Acc: 0.853
Validation loss decreased (-0.846864 --> -0.853113).  Saving model ...
Epoch: 6 cost time: 1.2879893779754639
Epoch: 6, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.380 Vali Acc: 0.847 Test Loss: 1.380 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1061711311340332
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.677 Vali Acc: 0.825 Test Loss: 1.677 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2174286842346191
Epoch: 8, Steps: 8 | Train Loss: 0.159 Vali Loss: 2.007 Vali Acc: 0.800 Test Loss: 2.007 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1136548519134521
Epoch: 9, Steps: 8 | Train Loss: 0.140 Vali Loss: 2.218 Vali Acc: 0.809 Test Loss: 2.218 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1981077194213867
Epoch: 10, Steps: 8 | Train Loss: 0.387 Vali Loss: 2.101 Vali Acc: 0.828 Test Loss: 2.101 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2091076374053955
Epoch: 11, Steps: 8 | Train Loss: 0.240 Vali Loss: 2.766 Vali Acc: 0.784 Test Loss: 2.766 Test Acc: 0.784
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2558350563049316
Epoch: 12, Steps: 8 | Train Loss: 0.219 Vali Loss: 3.390 Vali Acc: 0.784 Test Loss: 3.390 Test Acc: 0.784
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2195758819580078
Epoch: 13, Steps: 8 | Train Loss: 0.117 Vali Loss: 3.696 Vali Acc: 0.781 Test Loss: 3.696 Test Acc: 0.781
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2081382274627686
Epoch: 14, Steps: 8 | Train Loss: 0.200 Vali Loss: 3.418 Vali Acc: 0.822 Test Loss: 3.418 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2790193557739258
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 3.171 Vali Acc: 0.806 Test Loss: 3.171 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 2876964
model size : 20.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3383660316467285
Epoch: 1, Steps: 8 | Train Loss: 1.792 Vali Loss: 0.721 Vali Acc: 0.762 Test Loss: 0.721 Test Acc: 0.762
Validation loss decreased (inf --> -0.762493).  Saving model ...
Epoch: 2 cost time: 1.2898221015930176
Epoch: 2, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.759 Vali Acc: 0.841 Test Loss: 0.759 Test Acc: 0.841
Validation loss decreased (-0.762493 --> -0.840617).  Saving model ...
Epoch: 3 cost time: 1.4276206493377686
Epoch: 3, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.906 Vali Acc: 0.844 Test Loss: 0.906 Test Acc: 0.844
Validation loss decreased (-0.840617 --> -0.843741).  Saving model ...
Epoch: 4 cost time: 1.3211960792541504
Epoch: 4, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.133 Vali Acc: 0.834 Test Loss: 1.133 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.370408058166504
Epoch: 5, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.523 Vali Acc: 0.853 Test Loss: 1.523 Test Acc: 0.853
Validation loss decreased (-0.843741 --> -0.853110).  Saving model ...
Epoch: 6 cost time: 1.4601783752441406
Epoch: 6, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.729 Vali Acc: 0.834 Test Loss: 1.729 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4671776294708252
Epoch: 7, Steps: 8 | Train Loss: 0.057 Vali Loss: 2.344 Vali Acc: 0.775 Test Loss: 2.344 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.412318468093872
Epoch: 8, Steps: 8 | Train Loss: 0.093 Vali Loss: 2.440 Vali Acc: 0.828 Test Loss: 2.440 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3434312343597412
Epoch: 9, Steps: 8 | Train Loss: 0.081 Vali Loss: 2.621 Vali Acc: 0.772 Test Loss: 2.621 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2055609226226807
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 3.284 Vali Acc: 0.794 Test Loss: 3.284 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3607168197631836
Epoch: 11, Steps: 8 | Train Loss: 0.129 Vali Loss: 2.618 Vali Acc: 0.825 Test Loss: 2.618 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4355645179748535
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.844 Vali Acc: 0.841 Test Loss: 2.844 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.732182502746582
Epoch: 13, Steps: 8 | Train Loss: 0.213 Vali Loss: 3.224 Vali Acc: 0.806 Test Loss: 3.224 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2531962394714355
Epoch: 14, Steps: 8 | Train Loss: 0.172 Vali Loss: 3.189 Vali Acc: 0.809 Test Loss: 3.189 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.618788719177246
Epoch: 15, Steps: 8 | Train Loss: 0.307 Vali Loss: 3.302 Vali Acc: 0.834 Test Loss: 3.302 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 2352676
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4422290325164795
Epoch: 1, Steps: 8 | Train Loss: 1.802 Vali Loss: 0.723 Vali Acc: 0.766 Test Loss: 0.723 Test Acc: 0.766
Validation loss decreased (inf --> -0.765618).  Saving model ...
Epoch: 2 cost time: 1.2121624946594238
Epoch: 2, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
Validation loss decreased (-0.765618 --> -0.843743).  Saving model ...
Epoch: 3 cost time: 1.2804112434387207
Epoch: 3, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.860 Vali Acc: 0.847 Test Loss: 0.860 Test Acc: 0.847
Validation loss decreased (-0.843743 --> -0.846866).  Saving model ...
Epoch: 4 cost time: 1.1723628044128418
Epoch: 4, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.108 Vali Acc: 0.831 Test Loss: 1.108 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3502697944641113
Epoch: 5, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.693 Vali Acc: 0.831 Test Loss: 1.693 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1512608528137207
Epoch: 6, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.371 Vali Acc: 0.872 Test Loss: 1.371 Test Acc: 0.872
Validation loss decreased (-0.846866 --> -0.871861).  Saving model ...
Epoch: 7 cost time: 1.098400592803955
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.744 Vali Acc: 0.834 Test Loss: 1.744 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.071094274520874
Epoch: 8, Steps: 8 | Train Loss: 0.120 Vali Loss: 2.881 Vali Acc: 0.800 Test Loss: 2.881 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0898828506469727
Epoch: 9, Steps: 8 | Train Loss: 0.562 Vali Loss: 2.491 Vali Acc: 0.809 Test Loss: 2.491 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.203378677368164
Epoch: 10, Steps: 8 | Train Loss: 0.269 Vali Loss: 2.653 Vali Acc: 0.803 Test Loss: 2.653 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2281928062438965
Epoch: 11, Steps: 8 | Train Loss: 0.044 Vali Loss: 3.237 Vali Acc: 0.822 Test Loss: 3.237 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.313514232635498
Epoch: 12, Steps: 8 | Train Loss: 0.422 Vali Loss: 3.990 Vali Acc: 0.791 Test Loss: 3.990 Test Acc: 0.791
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.317431926727295
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 2.898 Vali Acc: 0.853 Test Loss: 2.898 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1970367431640625
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 3.295 Vali Acc: 0.816 Test Loss: 3.295 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2981176376342773
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 3.044 Vali Acc: 0.834 Test Loss: 3.044 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2725601196289062
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 3.681 Vali Acc: 0.812 Test Loss: 3.681 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 2352676
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9484481811523438
Epoch: 1, Steps: 8 | Train Loss: 1.812 Vali Loss: 0.730 Vali Acc: 0.769 Test Loss: 0.730 Test Acc: 0.769
Validation loss decreased (inf --> -0.768743).  Saving model ...
Epoch: 2 cost time: 1.1357157230377197
Epoch: 2, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.698 Vali Acc: 0.841 Test Loss: 0.698 Test Acc: 0.841
Validation loss decreased (-0.768743 --> -0.840618).  Saving model ...
Epoch: 3 cost time: 1.2069182395935059
Epoch: 3, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.814 Vali Acc: 0.850 Test Loss: 0.814 Test Acc: 0.850
Validation loss decreased (-0.840618 --> -0.849992).  Saving model ...
Epoch: 4 cost time: 1.2454445362091064
Epoch: 4, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.131 Vali Acc: 0.856 Test Loss: 1.131 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.856239).  Saving model ...
Epoch: 5 cost time: 1.2954459190368652
Epoch: 5, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.373 Vali Acc: 0.856 Test Loss: 1.373 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3484971523284912
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.376 Vali Acc: 0.850 Test Loss: 1.376 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3270909786224365
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.704 Vali Acc: 0.853 Test Loss: 1.704 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2682344913482666
Epoch: 8, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.725 Vali Acc: 0.850 Test Loss: 1.725 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3656938076019287
Epoch: 9, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.665 Vali Acc: 0.859 Test Loss: 1.665 Test Acc: 0.859
Validation loss decreased (-0.856239 --> -0.859358).  Saving model ...
Epoch: 10 cost time: 1.4565331935882568
Epoch: 10, Steps: 8 | Train Loss: 0.101 Vali Loss: 2.115 Vali Acc: 0.803 Test Loss: 2.115 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5166776180267334
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.278 Vali Acc: 0.806 Test Loss: 2.278 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.479179859161377
Epoch: 12, Steps: 8 | Train Loss: 0.355 Vali Loss: 2.055 Vali Acc: 0.828 Test Loss: 2.055 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.380352258682251
Epoch: 13, Steps: 8 | Train Loss: 1.063 Vali Loss: 2.662 Vali Acc: 0.831 Test Loss: 2.662 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4042811393737793
Epoch: 14, Steps: 8 | Train Loss: 0.616 Vali Loss: 2.337 Vali Acc: 0.869 Test Loss: 2.337 Test Acc: 0.869
Validation loss decreased (-0.859358 --> -0.868727).  Saving model ...
Epoch: 15 cost time: 1.3558413982391357
Epoch: 15, Steps: 8 | Train Loss: 0.261 Vali Loss: 3.414 Vali Acc: 0.816 Test Loss: 3.414 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.230017900466919
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 4.038 Vali Acc: 0.834 Test Loss: 4.038 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3416941165924072
Epoch: 17, Steps: 8 | Train Loss: 0.320 Vali Loss: 4.484 Vali Acc: 0.816 Test Loss: 4.484 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1659059524536133
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 4.465 Vali Acc: 0.809 Test Loss: 4.465 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1980016231536865
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 4.117 Vali Acc: 0.825 Test Loss: 4.117 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3888683319091797
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.929 Vali Acc: 0.834 Test Loss: 3.929 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3185234069824219
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.866 Vali Acc: 0.841 Test Loss: 3.866 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3737850189208984
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.842 Vali Acc: 0.844 Test Loss: 3.842 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3645598888397217
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.830 Vali Acc: 0.844 Test Loss: 3.830 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2903831005096436
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.821 Vali Acc: 0.844 Test Loss: 3.821 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 2352676
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.481644630432129
Epoch: 1, Steps: 8 | Train Loss: 1.817 Vali Loss: 0.800 Vali Acc: 0.784 Test Loss: 0.800 Test Acc: 0.784
Validation loss decreased (inf --> -0.784367).  Saving model ...
Epoch: 2 cost time: 0.987940788269043
Epoch: 2, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.767 Vali Acc: 0.819 Test Loss: 0.767 Test Acc: 0.819
Validation loss decreased (-0.784367 --> -0.818742).  Saving model ...
Epoch: 3 cost time: 1.0265483856201172
Epoch: 3, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.976 Vali Acc: 0.806 Test Loss: 0.976 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2934658527374268
Epoch: 4, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.018 Vali Acc: 0.831 Test Loss: 1.018 Test Acc: 0.831
Validation loss decreased (-0.818742 --> -0.831240).  Saving model ...
Epoch: 5 cost time: 1.2594540119171143
Epoch: 5, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.270 Vali Acc: 0.847 Test Loss: 1.270 Test Acc: 0.847
Validation loss decreased (-0.831240 --> -0.846862).  Saving model ...
Epoch: 6 cost time: 1.1738197803497314
Epoch: 6, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.398 Vali Acc: 0.850 Test Loss: 1.398 Test Acc: 0.850
Validation loss decreased (-0.846862 --> -0.849986).  Saving model ...
Epoch: 7 cost time: 1.3404030799865723
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.501 Vali Acc: 0.863 Test Loss: 1.501 Test Acc: 0.863
Validation loss decreased (-0.849986 --> -0.862485).  Saving model ...
Epoch: 8 cost time: 1.149860143661499
Epoch: 8, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.687 Vali Acc: 0.838 Test Loss: 1.687 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3037376403808594
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.880 Vali Acc: 0.825 Test Loss: 1.880 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4012103080749512
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 2.339 Vali Acc: 0.794 Test Loss: 2.339 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1687893867492676
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 2.306 Vali Acc: 0.819 Test Loss: 2.306 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2219610214233398
Epoch: 12, Steps: 8 | Train Loss: 0.165 Vali Loss: 2.135 Vali Acc: 0.831 Test Loss: 2.135 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3097200393676758
Epoch: 13, Steps: 8 | Train Loss: 0.321 Vali Loss: 2.267 Vali Acc: 0.841 Test Loss: 2.267 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2341902256011963
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.293 Vali Acc: 0.844 Test Loss: 2.293 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1730072498321533
Epoch: 15, Steps: 8 | Train Loss: 0.078 Vali Loss: 2.554 Vali Acc: 0.816 Test Loss: 2.554 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3023080825805664
Epoch: 16, Steps: 8 | Train Loss: 0.041 Vali Loss: 2.935 Vali Acc: 0.791 Test Loss: 2.935 Test Acc: 0.791
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.154550313949585
Epoch: 17, Steps: 8 | Train Loss: 0.062 Vali Loss: 3.569 Vali Acc: 0.778 Test Loss: 3.569 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 2352676
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3817811012268066
Epoch: 1, Steps: 8 | Train Loss: 1.839 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
Validation loss decreased (inf --> -0.724992).  Saving model ...
Epoch: 2 cost time: 1.4188036918640137
Epoch: 2, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.772 Vali Acc: 0.797 Test Loss: 0.772 Test Acc: 0.797
Validation loss decreased (-0.724992 --> -0.796867).  Saving model ...
Epoch: 3 cost time: 1.1864097118377686
Epoch: 3, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.249 Vali Acc: 0.819 Test Loss: 1.249 Test Acc: 0.819
Validation loss decreased (-0.796867 --> -0.818738).  Saving model ...
Epoch: 4 cost time: 1.1863784790039062
Epoch: 4, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.485 Vali Acc: 0.825 Test Loss: 1.485 Test Acc: 0.825
Validation loss decreased (-0.818738 --> -0.824985).  Saving model ...
Epoch: 5 cost time: 1.2645831108093262
Epoch: 5, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.219 Vali Acc: 0.869 Test Loss: 1.219 Test Acc: 0.869
Validation loss decreased (-0.824985 --> -0.868738).  Saving model ...
Epoch: 6 cost time: 1.3103795051574707
Epoch: 6, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.788 Vali Acc: 0.803 Test Loss: 1.788 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5149164199829102
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.989 Vali Acc: 0.806 Test Loss: 1.989 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4379982948303223
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.822 Test Loss: 1.796 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.294835090637207
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.844 Vali Acc: 0.822 Test Loss: 1.844 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2733311653137207
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.991 Vali Acc: 0.822 Test Loss: 1.991 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2324328422546387
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.063 Vali Acc: 0.819 Test Loss: 2.063 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3823809623718262
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 3.908 Vali Acc: 0.756 Test Loss: 3.908 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2910051345825195
Epoch: 13, Steps: 8 | Train Loss: 0.317 Vali Loss: 2.536 Vali Acc: 0.809 Test Loss: 2.536 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3278241157531738
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 2.852 Vali Acc: 0.806 Test Loss: 2.852 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4056110382080078
Epoch: 15, Steps: 8 | Train Loss: 0.038 Vali Loss: 4.621 Vali Acc: 0.759 Test Loss: 4.621 Test Acc: 0.759
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 2090532
model size : 17.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.341707944869995
Epoch: 1, Steps: 8 | Train Loss: 1.835 Vali Loss: 0.780 Vali Acc: 0.728 Test Loss: 0.780 Test Acc: 0.728
Validation loss decreased (inf --> -0.728117).  Saving model ...
Epoch: 2 cost time: 1.4335181713104248
Epoch: 2, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.732 Vali Acc: 0.794 Test Loss: 0.732 Test Acc: 0.794
Validation loss decreased (-0.728117 --> -0.793743).  Saving model ...
Epoch: 3 cost time: 1.3931727409362793
Epoch: 3, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.234 Vali Acc: 0.809 Test Loss: 1.234 Test Acc: 0.809
Validation loss decreased (-0.793743 --> -0.809363).  Saving model ...
Epoch: 4 cost time: 1.2329275608062744
Epoch: 4, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.436 Vali Acc: 0.812 Test Loss: 1.436 Test Acc: 0.812
Validation loss decreased (-0.809363 --> -0.812486).  Saving model ...
Epoch: 5 cost time: 1.2011158466339111
Epoch: 5, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.407 Vali Acc: 0.869 Test Loss: 1.407 Test Acc: 0.869
Validation loss decreased (-0.812486 --> -0.868736).  Saving model ...
Epoch: 6 cost time: 1.113126516342163
Epoch: 6, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.745 Vali Acc: 0.831 Test Loss: 1.745 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0969533920288086
Epoch: 7, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.847 Vali Acc: 0.816 Test Loss: 1.847 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4913482666015625
Epoch: 8, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.812 Vali Acc: 0.859 Test Loss: 1.812 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5891404151916504
Epoch: 9, Steps: 8 | Train Loss: 0.043 Vali Loss: 2.398 Vali Acc: 0.809 Test Loss: 2.398 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3422002792358398
Epoch: 10, Steps: 8 | Train Loss: 0.094 Vali Loss: 2.582 Vali Acc: 0.812 Test Loss: 2.582 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.455320119857788
Epoch: 11, Steps: 8 | Train Loss: 0.048 Vali Loss: 2.768 Vali Acc: 0.828 Test Loss: 2.768 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3549580574035645
Epoch: 12, Steps: 8 | Train Loss: 0.098 Vali Loss: 3.039 Vali Acc: 0.812 Test Loss: 3.039 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3896348476409912
Epoch: 13, Steps: 8 | Train Loss: 0.075 Vali Loss: 3.405 Vali Acc: 0.816 Test Loss: 3.405 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2849011421203613
Epoch: 14, Steps: 8 | Train Loss: 0.242 Vali Loss: 4.122 Vali Acc: 0.784 Test Loss: 4.122 Test Acc: 0.784
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3204753398895264
Epoch: 15, Steps: 8 | Train Loss: 0.183 Vali Loss: 3.388 Vali Acc: 0.828 Test Loss: 3.388 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 2090532
model size : 17.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.47286057472229
Epoch: 1, Steps: 8 | Train Loss: 1.832 Vali Loss: 0.772 Vali Acc: 0.734 Test Loss: 0.772 Test Acc: 0.734
Validation loss decreased (inf --> -0.734367).  Saving model ...
Epoch: 2 cost time: 1.1922204494476318
Epoch: 2, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.707 Vali Acc: 0.787 Test Loss: 0.707 Test Acc: 0.787
Validation loss decreased (-0.734367 --> -0.787493).  Saving model ...
Epoch: 3 cost time: 1.2363979816436768
Epoch: 3, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.123 Vali Acc: 0.816 Test Loss: 1.123 Test Acc: 0.816
Validation loss decreased (-0.787493 --> -0.815614).  Saving model ...
Epoch: 4 cost time: 1.3320143222808838
Epoch: 4, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.071 Vali Acc: 0.831 Test Loss: 1.071 Test Acc: 0.831
Validation loss decreased (-0.815614 --> -0.831239).  Saving model ...
Epoch: 5 cost time: 1.1931145191192627
Epoch: 5, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.163 Vali Acc: 0.881 Test Loss: 1.163 Test Acc: 0.881
Validation loss decreased (-0.831239 --> -0.881238).  Saving model ...
Epoch: 6 cost time: 1.277639389038086
Epoch: 6, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.754 Vali Acc: 0.834 Test Loss: 1.754 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2630524635314941
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.909 Vali Acc: 0.825 Test Loss: 1.909 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.310255765914917
Epoch: 8, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.563 Vali Acc: 0.841 Test Loss: 1.563 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2886133193969727
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.843 Vali Acc: 0.847 Test Loss: 1.843 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0749282836914062
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.039 Vali Acc: 0.859 Test Loss: 2.039 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.399163007736206
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.980 Vali Acc: 0.850 Test Loss: 1.980 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4445669651031494
Epoch: 12, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.899 Vali Acc: 0.875 Test Loss: 1.899 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4027128219604492
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 2.430 Vali Acc: 0.844 Test Loss: 2.430 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5035147666931152
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 3.829 Vali Acc: 0.762 Test Loss: 3.829 Test Acc: 0.762
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3410837650299072
Epoch: 15, Steps: 8 | Train Loss: 0.209 Vali Loss: 2.613 Vali Acc: 0.803 Test Loss: 2.613 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 2090532
model size : 17.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.546915054321289
Epoch: 1, Steps: 8 | Train Loss: 1.868 Vali Loss: 0.885 Vali Acc: 0.681 Test Loss: 0.885 Test Acc: 0.681
Validation loss decreased (inf --> -0.681241).  Saving model ...
Epoch: 2 cost time: 1.1614623069763184
Epoch: 2, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.747 Vali Acc: 0.819 Test Loss: 0.747 Test Acc: 0.819
Validation loss decreased (-0.681241 --> -0.818743).  Saving model ...
Epoch: 3 cost time: 1.170337438583374
Epoch: 3, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.048 Vali Acc: 0.812 Test Loss: 1.048 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9760291576385498
Epoch: 4, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.264 Vali Acc: 0.803 Test Loss: 1.264 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0537424087524414
Epoch: 5, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.351 Vali Acc: 0.819 Test Loss: 1.351 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2082395553588867
Epoch: 6, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.695 Vali Acc: 0.825 Test Loss: 1.695 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824983).  Saving model ...
Epoch: 7 cost time: 1.0634446144104004
Epoch: 7, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.677 Vali Acc: 0.847 Test Loss: 1.677 Test Acc: 0.847
Validation loss decreased (-0.824983 --> -0.846858).  Saving model ...
Epoch: 8 cost time: 1.1190564632415771
Epoch: 8, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.555 Vali Acc: 0.844 Test Loss: 1.555 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.17643141746521
Epoch: 9, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.743 Vali Acc: 0.850 Test Loss: 1.743 Test Acc: 0.850
Validation loss decreased (-0.846858 --> -0.849983).  Saving model ...
Epoch: 10 cost time: 1.222947359085083
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.760 Vali Acc: 0.825 Test Loss: 1.760 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2633137702941895
Epoch: 11, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.796 Vali Acc: 0.825 Test Loss: 1.796 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.270160436630249
Epoch: 12, Steps: 8 | Train Loss: 0.092 Vali Loss: 2.084 Vali Acc: 0.816 Test Loss: 2.084 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0775752067565918
Epoch: 13, Steps: 8 | Train Loss: 0.218 Vali Loss: 2.915 Vali Acc: 0.806 Test Loss: 2.915 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1866710186004639
Epoch: 14, Steps: 8 | Train Loss: 0.124 Vali Loss: 3.334 Vali Acc: 0.794 Test Loss: 3.334 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1802945137023926
Epoch: 15, Steps: 8 | Train Loss: 0.136 Vali Loss: 3.245 Vali Acc: 0.772 Test Loss: 3.245 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2179560661315918
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 3.848 Vali Acc: 0.775 Test Loss: 3.848 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2763152122497559
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 4.392 Vali Acc: 0.784 Test Loss: 4.392 Test Acc: 0.784
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1070022583007812
Epoch: 18, Steps: 8 | Train Loss: 0.185 Vali Loss: 3.782 Vali Acc: 0.819 Test Loss: 3.782 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1100127696990967
Epoch: 19, Steps: 8 | Train Loss: 0.236 Vali Loss: 4.037 Vali Acc: 0.816 Test Loss: 4.037 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 2090532
model size : 17.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.51509165763855
Epoch: 1, Steps: 8 | Train Loss: 1.696 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
Validation loss decreased (inf --> -0.803119).  Saving model ...
Epoch: 2 cost time: 1.3419766426086426
Epoch: 2, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.825 Vali Acc: 0.822 Test Loss: 0.825 Test Acc: 0.822
Validation loss decreased (-0.803119 --> -0.821867).  Saving model ...
Epoch: 3 cost time: 1.3495755195617676
Epoch: 3, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.263 Vali Acc: 0.816 Test Loss: 1.263 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2128932476043701
Epoch: 4, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.179 Vali Acc: 0.847 Test Loss: 1.179 Test Acc: 0.847
Validation loss decreased (-0.821867 --> -0.846863).  Saving model ...
Epoch: 5 cost time: 1.2304258346557617
Epoch: 5, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.693 Vali Acc: 0.803 Test Loss: 1.693 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4489021301269531
Epoch: 6, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.573 Vali Acc: 0.847 Test Loss: 1.573 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4519433975219727
Epoch: 7, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.747 Vali Acc: 0.847 Test Loss: 1.747 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4293310642242432
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.796 Vali Acc: 0.831 Test Loss: 1.796 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3465754985809326
Epoch: 9, Steps: 8 | Train Loss: 0.072 Vali Loss: 2.279 Vali Acc: 0.816 Test Loss: 2.279 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2611985206604004
Epoch: 10, Steps: 8 | Train Loss: 0.102 Vali Loss: 3.618 Vali Acc: 0.766 Test Loss: 3.618 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.288912296295166
Epoch: 11, Steps: 8 | Train Loss: 0.058 Vali Loss: 3.277 Vali Acc: 0.738 Test Loss: 3.277 Test Acc: 0.738
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2852284908294678
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.804 Vali Acc: 0.809 Test Loss: 2.804 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9886922836303711
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 4.517 Vali Acc: 0.734 Test Loss: 4.517 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.274397850036621
Epoch: 14, Steps: 8 | Train Loss: 0.134 Vali Loss: 2.923 Vali Acc: 0.834 Test Loss: 2.923 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 1959460
model size : 17.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.516677141189575
Epoch: 1, Steps: 8 | Train Loss: 1.677 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
Validation loss decreased (inf --> -0.803119).  Saving model ...
Epoch: 2 cost time: 1.1278600692749023
Epoch: 2, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.784 Vali Acc: 0.831 Test Loss: 0.784 Test Acc: 0.831
Validation loss decreased (-0.803119 --> -0.831242).  Saving model ...
Epoch: 3 cost time: 1.2722558975219727
Epoch: 3, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.167 Vali Acc: 0.834 Test Loss: 1.167 Test Acc: 0.834
Validation loss decreased (-0.831242 --> -0.834363).  Saving model ...
Epoch: 4 cost time: 1.2622883319854736
Epoch: 4, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.145 Vali Acc: 0.850 Test Loss: 1.145 Test Acc: 0.850
Validation loss decreased (-0.834363 --> -0.849989).  Saving model ...
Epoch: 5 cost time: 1.2676434516906738
Epoch: 5, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.869 Vali Acc: 0.816 Test Loss: 1.869 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2994654178619385
Epoch: 6, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.806 Vali Acc: 0.819 Test Loss: 1.806 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2730212211608887
Epoch: 7, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.810 Vali Acc: 0.841 Test Loss: 1.810 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1935241222381592
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 2.426 Vali Acc: 0.784 Test Loss: 2.426 Test Acc: 0.784
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2072434425354004
Epoch: 9, Steps: 8 | Train Loss: 0.175 Vali Loss: 2.569 Vali Acc: 0.775 Test Loss: 2.569 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3024709224700928
Epoch: 10, Steps: 8 | Train Loss: 0.060 Vali Loss: 2.664 Vali Acc: 0.772 Test Loss: 2.664 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3467698097229004
Epoch: 11, Steps: 8 | Train Loss: 0.069 Vali Loss: 2.530 Vali Acc: 0.784 Test Loss: 2.530 Test Acc: 0.784
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3246047496795654
Epoch: 12, Steps: 8 | Train Loss: 0.203 Vali Loss: 2.451 Vali Acc: 0.847 Test Loss: 2.451 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3741109371185303
Epoch: 13, Steps: 8 | Train Loss: 0.066 Vali Loss: 2.944 Vali Acc: 0.834 Test Loss: 2.944 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3313705921173096
Epoch: 14, Steps: 8 | Train Loss: 0.192 Vali Loss: 2.866 Vali Acc: 0.847 Test Loss: 2.866 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1959460
model size : 17.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9546000957489014
Epoch: 1, Steps: 8 | Train Loss: 1.671 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
Validation loss decreased (inf --> -0.815619).  Saving model ...
Epoch: 2 cost time: 1.1326391696929932
Epoch: 2, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.802 Vali Acc: 0.822 Test Loss: 0.802 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821867).  Saving model ...
Epoch: 3 cost time: 1.2407209873199463
Epoch: 3, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.084 Vali Acc: 0.838 Test Loss: 1.084 Test Acc: 0.838
Validation loss decreased (-0.821867 --> -0.837489).  Saving model ...
Epoch: 4 cost time: 1.2614784240722656
Epoch: 4, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.080 Vali Acc: 0.834 Test Loss: 1.080 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.519986629486084
Epoch: 5, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.750 Vali Acc: 0.816 Test Loss: 1.750 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2643027305603027
Epoch: 6, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.773 Vali Acc: 0.794 Test Loss: 1.773 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2728736400604248
Epoch: 7, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.406 Vali Acc: 0.847 Test Loss: 1.406 Test Acc: 0.847
Validation loss decreased (-0.837489 --> -0.846861).  Saving model ...
Epoch: 8 cost time: 1.442756175994873
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.107 Vali Acc: 0.794 Test Loss: 2.107 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.497035264968872
Epoch: 9, Steps: 8 | Train Loss: 0.122 Vali Loss: 2.033 Vali Acc: 0.806 Test Loss: 2.033 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6250333786010742
Epoch: 10, Steps: 8 | Train Loss: 0.173 Vali Loss: 2.815 Vali Acc: 0.775 Test Loss: 2.815 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.480818271636963
Epoch: 11, Steps: 8 | Train Loss: 0.127 Vali Loss: 2.150 Vali Acc: 0.838 Test Loss: 2.150 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2678253650665283
Epoch: 12, Steps: 8 | Train Loss: 0.064 Vali Loss: 2.505 Vali Acc: 0.847 Test Loss: 2.505 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.325575351715088
Epoch: 13, Steps: 8 | Train Loss: 0.238 Vali Loss: 2.654 Vali Acc: 0.828 Test Loss: 2.654 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5101757049560547
Epoch: 14, Steps: 8 | Train Loss: 0.085 Vali Loss: 2.851 Vali Acc: 0.844 Test Loss: 2.851 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4630811214447021
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 3.790 Vali Acc: 0.803 Test Loss: 3.790 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4264135360717773
Epoch: 16, Steps: 8 | Train Loss: 0.102 Vali Loss: 3.625 Vali Acc: 0.803 Test Loss: 3.625 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4561078548431396
Epoch: 17, Steps: 8 | Train Loss: 0.114 Vali Loss: 3.061 Vali Acc: 0.847 Test Loss: 3.061 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 1959460
model size : 17.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9492361545562744
Epoch: 1, Steps: 8 | Train Loss: 1.787 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
Validation loss decreased (inf --> -0.793743).  Saving model ...
Epoch: 2 cost time: 1.0857725143432617
Epoch: 2, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.834 Vali Acc: 0.778 Test Loss: 0.834 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.049809217453003
Epoch: 3, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.008 Vali Acc: 0.822 Test Loss: 1.008 Test Acc: 0.822
Validation loss decreased (-0.793743 --> -0.821865).  Saving model ...
Epoch: 4 cost time: 1.2575929164886475
Epoch: 4, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.174 Vali Acc: 0.819 Test Loss: 1.174 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2910773754119873
Epoch: 5, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.868 Vali Acc: 0.797 Test Loss: 1.868 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1459853649139404
Epoch: 6, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.440 Vali Acc: 0.844 Test Loss: 1.440 Test Acc: 0.844
Validation loss decreased (-0.821865 --> -0.843736).  Saving model ...
Epoch: 7 cost time: 1.2378818988800049
Epoch: 7, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.848 Vali Acc: 0.812 Test Loss: 1.848 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2553532123565674
Epoch: 8, Steps: 8 | Train Loss: 0.140 Vali Loss: 2.413 Vali Acc: 0.819 Test Loss: 2.413 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1042003631591797
Epoch: 9, Steps: 8 | Train Loss: 0.078 Vali Loss: 2.570 Vali Acc: 0.809 Test Loss: 2.570 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0732083320617676
Epoch: 10, Steps: 8 | Train Loss: 0.035 Vali Loss: 2.564 Vali Acc: 0.797 Test Loss: 2.564 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1758692264556885
Epoch: 11, Steps: 8 | Train Loss: 0.079 Vali Loss: 2.717 Vali Acc: 0.784 Test Loss: 2.717 Test Acc: 0.784
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.156423807144165
Epoch: 12, Steps: 8 | Train Loss: 0.189 Vali Loss: 2.289 Vali Acc: 0.812 Test Loss: 2.289 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9933264255523682
Epoch: 13, Steps: 8 | Train Loss: 0.136 Vali Loss: 3.297 Vali Acc: 0.772 Test Loss: 3.297 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0859417915344238
Epoch: 14, Steps: 8 | Train Loss: 0.239 Vali Loss: 3.212 Vali Acc: 0.778 Test Loss: 3.212 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0439426898956299
Epoch: 15, Steps: 8 | Train Loss: 0.072 Vali Loss: 3.059 Vali Acc: 0.816 Test Loss: 3.059 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1672475337982178
Epoch: 16, Steps: 8 | Train Loss: 0.330 Vali Loss: 3.697 Vali Acc: 0.797 Test Loss: 3.697 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1959460
model size : 17.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.686323642730713
Epoch: 1, Steps: 8 | Train Loss: 1.769 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
Validation loss decreased (inf --> -0.803119).  Saving model ...
Epoch: 2 cost time: 1.3235092163085938
Epoch: 2, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.679 Vali Acc: 0.834 Test Loss: 0.679 Test Acc: 0.834
Validation loss decreased (-0.803119 --> -0.834368).  Saving model ...
Epoch: 3 cost time: 1.3815605640411377
Epoch: 3, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.970 Vali Acc: 0.844 Test Loss: 0.970 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843740).  Saving model ...
Epoch: 4 cost time: 1.2551264762878418
Epoch: 4, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.187 Vali Acc: 0.825 Test Loss: 1.187 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2381436824798584
Epoch: 5, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.468 Vali Acc: 0.825 Test Loss: 1.468 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1326227188110352
Epoch: 6, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.515 Vali Acc: 0.844 Test Loss: 1.515 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3302953243255615
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.730 Vali Acc: 0.838 Test Loss: 1.730 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4724321365356445
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.233 Vali Acc: 0.822 Test Loss: 2.233 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3572885990142822
Epoch: 9, Steps: 8 | Train Loss: 0.039 Vali Loss: 2.702 Vali Acc: 0.812 Test Loss: 2.702 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5382637977600098
Epoch: 10, Steps: 8 | Train Loss: 0.043 Vali Loss: 2.941 Vali Acc: 0.838 Test Loss: 2.941 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3289120197296143
Epoch: 11, Steps: 8 | Train Loss: 0.092 Vali Loss: 2.412 Vali Acc: 0.863 Test Loss: 2.412 Test Acc: 0.863
Validation loss decreased (-0.843740 --> -0.862476).  Saving model ...
Epoch: 12 cost time: 1.4437541961669922
Epoch: 12, Steps: 8 | Train Loss: 0.105 Vali Loss: 3.214 Vali Acc: 0.828 Test Loss: 3.214 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2729840278625488
Epoch: 13, Steps: 8 | Train Loss: 0.035 Vali Loss: 4.230 Vali Acc: 0.797 Test Loss: 4.230 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4637188911437988
Epoch: 14, Steps: 8 | Train Loss: 0.319 Vali Loss: 4.137 Vali Acc: 0.819 Test Loss: 4.137 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3563106060028076
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 4.043 Vali Acc: 0.825 Test Loss: 4.043 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3853774070739746
Epoch: 16, Steps: 8 | Train Loss: 0.135 Vali Loss: 5.087 Vali Acc: 0.781 Test Loss: 5.087 Test Acc: 0.781
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4523451328277588
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 4.613 Vali Acc: 0.803 Test Loss: 4.613 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4856758117675781
Epoch: 18, Steps: 8 | Train Loss: 0.397 Vali Loss: 4.984 Vali Acc: 0.787 Test Loss: 4.984 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3295106887817383
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 4.167 Vali Acc: 0.822 Test Loss: 4.167 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3775229454040527
Epoch: 20, Steps: 8 | Train Loss: 0.157 Vali Loss: 4.378 Vali Acc: 0.822 Test Loss: 4.378 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3386259078979492
Epoch: 21, Steps: 8 | Train Loss: 0.169 Vali Loss: 4.799 Vali Acc: 0.828 Test Loss: 4.799 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1893924
model size : 17.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.141573429107666
Epoch: 1, Steps: 8 | Train Loss: 1.767 Vali Loss: 0.608 Vali Acc: 0.806 Test Loss: 0.608 Test Acc: 0.806
Validation loss decreased (inf --> -0.806244).  Saving model ...
Epoch: 2 cost time: 1.2159883975982666
Epoch: 2, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.657 Vali Acc: 0.841 Test Loss: 0.657 Test Acc: 0.841
Validation loss decreased (-0.806244 --> -0.840618).  Saving model ...
Epoch: 3 cost time: 1.2609071731567383
Epoch: 3, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.990 Vali Acc: 0.850 Test Loss: 0.990 Test Acc: 0.850
Validation loss decreased (-0.840618 --> -0.849990).  Saving model ...
Epoch: 4 cost time: 1.4042644500732422
Epoch: 4, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.249 Vali Acc: 0.797 Test Loss: 1.249 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4030089378356934
Epoch: 5, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.364 Vali Acc: 0.828 Test Loss: 1.364 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3247098922729492
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.449 Vali Acc: 0.847 Test Loss: 1.449 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4484829902648926
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.816 Test Loss: 1.661 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.300313949584961
Epoch: 8, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.544 Vali Acc: 0.856 Test Loss: 1.544 Test Acc: 0.856
Validation loss decreased (-0.849990 --> -0.856235).  Saving model ...
Epoch: 9 cost time: 1.259049415588379
Epoch: 9, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.773 Vali Acc: 0.828 Test Loss: 1.773 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2189435958862305
Epoch: 10, Steps: 8 | Train Loss: 0.034 Vali Loss: 2.878 Vali Acc: 0.753 Test Loss: 2.878 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3271379470825195
Epoch: 11, Steps: 8 | Train Loss: 0.063 Vali Loss: 2.204 Vali Acc: 0.812 Test Loss: 2.204 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1750338077545166
Epoch: 12, Steps: 8 | Train Loss: 0.247 Vali Loss: 2.948 Vali Acc: 0.794 Test Loss: 2.948 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.193939208984375
Epoch: 13, Steps: 8 | Train Loss: 0.373 Vali Loss: 3.502 Vali Acc: 0.769 Test Loss: 3.502 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2281501293182373
Epoch: 14, Steps: 8 | Train Loss: 0.251 Vali Loss: 3.753 Vali Acc: 0.781 Test Loss: 3.753 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2855627536773682
Epoch: 15, Steps: 8 | Train Loss: 0.115 Vali Loss: 3.515 Vali Acc: 0.778 Test Loss: 3.515 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2814464569091797
Epoch: 16, Steps: 8 | Train Loss: 0.271 Vali Loss: 4.332 Vali Acc: 0.812 Test Loss: 4.332 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3055620193481445
Epoch: 17, Steps: 8 | Train Loss: 0.182 Vali Loss: 4.775 Vali Acc: 0.775 Test Loss: 4.775 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.342374563217163
Epoch: 18, Steps: 8 | Train Loss: 0.296 Vali Loss: 3.789 Vali Acc: 0.834 Test Loss: 3.789 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 1893924
model size : 17.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.296419858932495
Epoch: 1, Steps: 8 | Train Loss: 1.715 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
Validation loss decreased (inf --> -0.803119).  Saving model ...
Epoch: 2 cost time: 1.2630724906921387
Epoch: 2, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.650 Vali Acc: 0.831 Test Loss: 0.650 Test Acc: 0.831
Validation loss decreased (-0.803119 --> -0.831243).  Saving model ...
Epoch: 3 cost time: 1.2195076942443848
Epoch: 3, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.000 Vali Acc: 0.853 Test Loss: 1.000 Test Acc: 0.853
Validation loss decreased (-0.831243 --> -0.853115).  Saving model ...
Epoch: 4 cost time: 1.1796178817749023
Epoch: 4, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.112 Vali Acc: 0.816 Test Loss: 1.112 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2956509590148926
Epoch: 5, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.267 Vali Acc: 0.863 Test Loss: 1.267 Test Acc: 0.863
Validation loss decreased (-0.853115 --> -0.862487).  Saving model ...
Epoch: 6 cost time: 1.1857573986053467
Epoch: 6, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.659 Vali Acc: 0.834 Test Loss: 1.659 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1782689094543457
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.772 Vali Acc: 0.794 Test Loss: 1.772 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3465924263000488
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.845 Vali Acc: 0.822 Test Loss: 1.845 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1642673015594482
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.358 Vali Acc: 0.809 Test Loss: 2.358 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3201065063476562
Epoch: 10, Steps: 8 | Train Loss: 0.138 Vali Loss: 2.421 Vali Acc: 0.816 Test Loss: 2.421 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3893811702728271
Epoch: 11, Steps: 8 | Train Loss: 0.144 Vali Loss: 2.182 Vali Acc: 0.819 Test Loss: 2.182 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.252777099609375
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.657 Vali Acc: 0.816 Test Loss: 2.657 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2599000930786133
Epoch: 13, Steps: 8 | Train Loss: 0.258 Vali Loss: 3.470 Vali Acc: 0.809 Test Loss: 3.470 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2509541511535645
Epoch: 14, Steps: 8 | Train Loss: 0.226 Vali Loss: 2.887 Vali Acc: 0.775 Test Loss: 2.887 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2063062191009521
Epoch: 15, Steps: 8 | Train Loss: 0.236 Vali Loss: 4.035 Vali Acc: 0.812 Test Loss: 4.035 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1893924
model size : 17.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3264541625976562
Epoch: 1, Steps: 8 | Train Loss: 1.722 Vali Loss: 0.734 Vali Acc: 0.787 Test Loss: 0.734 Test Acc: 0.787
Validation loss decreased (inf --> -0.787493).  Saving model ...
Epoch: 2 cost time: 1.1428282260894775
Epoch: 2, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.854 Vali Acc: 0.822 Test Loss: 0.854 Test Acc: 0.822
Validation loss decreased (-0.787493 --> -0.821866).  Saving model ...
Epoch: 3 cost time: 1.025958776473999
Epoch: 3, Steps: 8 | Train Loss: 0.265 Vali Loss: 1.029 Vali Acc: 0.809 Test Loss: 1.029 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.120293378829956
Epoch: 4, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.539 Vali Acc: 0.756 Test Loss: 1.539 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1331572532653809
Epoch: 5, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.247 Vali Acc: 0.838 Test Loss: 1.247 Test Acc: 0.838
Validation loss decreased (-0.821866 --> -0.837488).  Saving model ...
Epoch: 6 cost time: 1.060920238494873
Epoch: 6, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.682 Vali Acc: 0.841 Test Loss: 1.682 Test Acc: 0.841
Validation loss decreased (-0.837488 --> -0.840608).  Saving model ...
Epoch: 7 cost time: 1.1801128387451172
Epoch: 7, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.972 Vali Acc: 0.791 Test Loss: 1.972 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1833555698394775
Epoch: 8, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.662 Vali Acc: 0.831 Test Loss: 1.662 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2109386920928955
Epoch: 9, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.930 Vali Acc: 0.850 Test Loss: 1.930 Test Acc: 0.850
Validation loss decreased (-0.840608 --> -0.849981).  Saving model ...
Epoch: 10 cost time: 1.161060094833374
Epoch: 10, Steps: 8 | Train Loss: 0.038 Vali Loss: 2.013 Vali Acc: 0.838 Test Loss: 2.013 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0946004390716553
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 2.305 Vali Acc: 0.794 Test Loss: 2.305 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1295664310455322
Epoch: 12, Steps: 8 | Train Loss: 0.106 Vali Loss: 2.135 Vali Acc: 0.831 Test Loss: 2.135 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1862537860870361
Epoch: 13, Steps: 8 | Train Loss: 0.117 Vali Loss: 2.574 Vali Acc: 0.803 Test Loss: 2.574 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0917818546295166
Epoch: 14, Steps: 8 | Train Loss: 0.107 Vali Loss: 3.324 Vali Acc: 0.803 Test Loss: 3.324 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0904109477996826
Epoch: 15, Steps: 8 | Train Loss: 0.150 Vali Loss: 2.631 Vali Acc: 0.819 Test Loss: 2.631 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1841456890106201
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.994 Vali Acc: 0.809 Test Loss: 2.994 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1132080554962158
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 3.841 Vali Acc: 0.766 Test Loss: 3.841 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2169654369354248
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.643 Vali Acc: 0.863 Test Loss: 2.643 Test Acc: 0.863
Validation loss decreased (-0.849981 --> -0.862474).  Saving model ...
Epoch: 19 cost time: 1.2623071670532227
Epoch: 19, Steps: 8 | Train Loss: 0.363 Vali Loss: 3.263 Vali Acc: 0.797 Test Loss: 3.263 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2531116008758545
Epoch: 20, Steps: 8 | Train Loss: 0.274 Vali Loss: 5.064 Vali Acc: 0.756 Test Loss: 5.064 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1389014720916748
Epoch: 21, Steps: 8 | Train Loss: 0.661 Vali Loss: 3.512 Vali Acc: 0.831 Test Loss: 3.512 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4131395816802979
Epoch: 22, Steps: 8 | Train Loss: 0.486 Vali Loss: 3.850 Vali Acc: 0.850 Test Loss: 3.850 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2711386680603027
Epoch: 23, Steps: 8 | Train Loss: 0.224 Vali Loss: 5.010 Vali Acc: 0.838 Test Loss: 5.010 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1656124591827393
Epoch: 24, Steps: 8 | Train Loss: 0.170 Vali Loss: 5.363 Vali Acc: 0.819 Test Loss: 5.363 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9637312889099121
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 5.868 Vali Acc: 0.787 Test Loss: 5.868 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1305322647094727
Epoch: 26, Steps: 8 | Train Loss: 0.133 Vali Loss: 4.870 Vali Acc: 0.809 Test Loss: 4.870 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1837303638458252
Epoch: 27, Steps: 8 | Train Loss: 0.223 Vali Loss: 5.291 Vali Acc: 0.825 Test Loss: 5.291 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1980445384979248
Epoch: 28, Steps: 8 | Train Loss: 0.079 Vali Loss: 5.110 Vali Acc: 0.812 Test Loss: 5.110 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1893924
model size : 17.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1222009658813477
Epoch: 1, Steps: 8 | Train Loss: 1.950 Vali Loss: 0.889 Vali Acc: 0.775 Test Loss: 0.889 Test Acc: 0.775
Validation loss decreased (inf --> -0.774991).  Saving model ...
Epoch: 2 cost time: 0.9770722389221191
Epoch: 2, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
Validation loss decreased (-0.774991 --> -0.862495).  Saving model ...
Epoch: 3 cost time: 1.0278770923614502
Epoch: 3, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.801 Vali Acc: 0.816 Test Loss: 0.801 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.130291223526001
Epoch: 4, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.710 Vali Acc: 0.859 Test Loss: 0.710 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2080464363098145
Epoch: 5, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.119 Vali Acc: 0.834 Test Loss: 1.119 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0606839656829834
Epoch: 6, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.291 Vali Acc: 0.831 Test Loss: 1.291 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1498982906341553
Epoch: 7, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.304 Vali Acc: 0.825 Test Loss: 1.304 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0365650653839111
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.417 Vali Acc: 0.809 Test Loss: 1.417 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0526747703552246
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.352 Vali Acc: 0.831 Test Loss: 1.352 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9924221038818359
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.841 Test Loss: 1.371 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0109906196594238
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.828 Test Loss: 1.380 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.121495246887207
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.834 Test Loss: 1.372 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1831716
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.898592472076416
Epoch: 1, Steps: 8 | Train Loss: 1.952 Vali Loss: 0.892 Vali Acc: 0.775 Test Loss: 0.892 Test Acc: 0.775
Validation loss decreased (inf --> -0.774991).  Saving model ...
Epoch: 2 cost time: 1.094912052154541
Epoch: 2, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
Validation loss decreased (-0.774991 --> -0.856245).  Saving model ...
Epoch: 3 cost time: 1.1666805744171143
Epoch: 3, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.780 Vali Acc: 0.816 Test Loss: 0.780 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1427829265594482
Epoch: 4, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.702 Vali Acc: 0.859 Test Loss: 0.702 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859368).  Saving model ...
Epoch: 5 cost time: 0.9342901706695557
Epoch: 5, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.972 Vali Acc: 0.856 Test Loss: 0.972 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.039358377456665
Epoch: 6, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.184 Vali Acc: 0.844 Test Loss: 1.184 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9399852752685547
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.257 Vali Acc: 0.828 Test Loss: 1.257 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1609368324279785
Epoch: 8, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.514 Vali Acc: 0.812 Test Loss: 1.514 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0276358127593994
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.336 Vali Acc: 0.853 Test Loss: 1.336 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0139703750610352
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.287 Vali Acc: 0.844 Test Loss: 1.287 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1146652698516846
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.844 Test Loss: 1.365 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.100865125656128
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.816 Test Loss: 1.476 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1197192668914795
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.812 Test Loss: 1.521 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0896916389465332
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.816 Test Loss: 1.516 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1831716
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1635982990264893
Epoch: 1, Steps: 8 | Train Loss: 1.961 Vali Loss: 0.917 Vali Acc: 0.784 Test Loss: 0.917 Test Acc: 0.784
Validation loss decreased (inf --> -0.784366).  Saving model ...
Epoch: 2 cost time: 1.0693910121917725
Epoch: 2, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
Validation loss decreased (-0.784366 --> -0.856245).  Saving model ...
Epoch: 3 cost time: 1.1565139293670654
Epoch: 3, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.737 Vali Acc: 0.822 Test Loss: 0.737 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0659880638122559
Epoch: 4, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.683 Vali Acc: 0.859 Test Loss: 0.683 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859368).  Saving model ...
Epoch: 5 cost time: 1.1236286163330078
Epoch: 5, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.849 Vali Acc: 0.847 Test Loss: 0.849 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9049122333526611
Epoch: 6, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.963 Vali Acc: 0.859 Test Loss: 0.963 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.124281883239746
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.184 Vali Acc: 0.831 Test Loss: 1.184 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0318117141723633
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.274 Vali Acc: 0.831 Test Loss: 1.274 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.080141544342041
Epoch: 9, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.068 Vali Acc: 0.866 Test Loss: 1.068 Test Acc: 0.866
Validation loss decreased (-0.859368 --> -0.865614).  Saving model ...
Epoch: 10 cost time: 1.0562753677368164
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.004 Vali Acc: 0.859 Test Loss: 1.004 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2110514640808105
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.053 Vali Acc: 0.859 Test Loss: 1.053 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2114894390106201
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.005 Vali Acc: 0.869 Test Loss: 1.005 Test Acc: 0.869
Validation loss decreased (-0.865614 --> -0.868740).  Saving model ...
Epoch: 13 cost time: 1.0710945129394531
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.013 Vali Acc: 0.869 Test Loss: 1.013 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.042604923248291
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.859 Test Loss: 1.224 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8027901649475098
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.044 Vali Acc: 0.884 Test Loss: 1.044 Test Acc: 0.884
Validation loss decreased (-0.868740 --> -0.884365).  Saving model ...
Epoch: 16 cost time: 1.0671501159667969
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.155 Vali Acc: 0.866 Test Loss: 1.155 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1377391815185547
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.707 Vali Acc: 0.856 Test Loss: 1.707 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.075974702835083
Epoch: 18, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.773 Vali Acc: 0.838 Test Loss: 1.773 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0920679569244385
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.868 Vali Acc: 0.825 Test Loss: 1.868 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2419562339782715
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.834 Test Loss: 1.862 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3368732929229736
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.876 Vali Acc: 0.825 Test Loss: 1.876 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0505664348602295
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.831 Test Loss: 1.811 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1514532566070557
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.790 Vali Acc: 0.838 Test Loss: 1.790 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1889915466308594
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.838 Test Loss: 1.788 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9448907375335693
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.790 Vali Acc: 0.838 Test Loss: 1.790 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 1831716
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.228837013244629
Epoch: 1, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.066 Vali Acc: 0.778 Test Loss: 1.066 Test Acc: 0.778
Validation loss decreased (inf --> -0.778114).  Saving model ...
Epoch: 2 cost time: 1.0232491493225098
Epoch: 2, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
Validation loss decreased (-0.778114 --> -0.812495).  Saving model ...
Epoch: 3 cost time: 0.9010350704193115
Epoch: 3, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.746 Vali Acc: 0.816 Test Loss: 0.746 Test Acc: 0.816
Validation loss decreased (-0.812495 --> -0.815618).  Saving model ...
Epoch: 4 cost time: 0.8921632766723633
Epoch: 4, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.806 Vali Acc: 0.819 Test Loss: 0.806 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818742).  Saving model ...
Epoch: 5 cost time: 0.8969688415527344
Epoch: 5, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.067 Vali Acc: 0.816 Test Loss: 1.067 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8780088424682617
Epoch: 6, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.006 Vali Acc: 0.831 Test Loss: 1.006 Test Acc: 0.831
Validation loss decreased (-0.818742 --> -0.831240).  Saving model ...
Epoch: 7 cost time: 1.0042436122894287
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.021 Vali Acc: 0.841 Test Loss: 1.021 Test Acc: 0.841
Validation loss decreased (-0.831240 --> -0.840615).  Saving model ...
Epoch: 8 cost time: 1.0548837184906006
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.121 Vali Acc: 0.838 Test Loss: 1.121 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0760271549224854
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.159 Vali Acc: 0.834 Test Loss: 1.159 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.093341588973999
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.164 Vali Acc: 0.841 Test Loss: 1.164 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9426102638244629
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.220 Vali Acc: 0.841 Test Loss: 1.220 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9459211826324463
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.160 Vali Acc: 0.847 Test Loss: 1.160 Test Acc: 0.847
Validation loss decreased (-0.840615 --> -0.846863).  Saving model ...
Epoch: 13 cost time: 0.9148666858673096
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.443 Vali Acc: 0.812 Test Loss: 1.443 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0720324516296387
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.433 Vali Acc: 0.831 Test Loss: 1.433 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0031473636627197
Epoch: 15, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.233 Vali Acc: 0.847 Test Loss: 1.233 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1200199127197266
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.372 Vali Acc: 0.819 Test Loss: 1.372 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1109671592712402
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.337 Vali Acc: 0.841 Test Loss: 1.337 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.102200984954834
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.847 Test Loss: 1.693 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0811476707458496
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.748 Vali Acc: 0.831 Test Loss: 1.748 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9794106483459473
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.060 Vali Acc: 0.822 Test Loss: 2.060 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.052210807800293
Epoch: 21, Steps: 8 | Train Loss: 0.052 Vali Loss: 2.234 Vali Acc: 0.812 Test Loss: 2.234 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.041687250137329
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.828 Test Loss: 1.956 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 1831716
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.85361385345459
Epoch: 1, Steps: 8 | Train Loss: 1.831 Vali Loss: 0.891 Vali Acc: 0.769 Test Loss: 0.891 Test Acc: 0.769
Validation loss decreased (inf --> -0.768741).  Saving model ...
Epoch: 2 cost time: 1.1405112743377686
Epoch: 2, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.661 Vali Acc: 0.806 Test Loss: 0.661 Test Acc: 0.806
Validation loss decreased (-0.768741 --> -0.806243).  Saving model ...
Epoch: 3 cost time: 1.0690679550170898
Epoch: 3, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
Validation loss decreased (-0.806243 --> -0.849994).  Saving model ...
Epoch: 4 cost time: 1.11936354637146
Epoch: 4, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.779 Vali Acc: 0.844 Test Loss: 0.779 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.078700065612793
Epoch: 5, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.970 Vali Acc: 0.816 Test Loss: 0.970 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0569403171539307
Epoch: 6, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.941 Vali Acc: 0.838 Test Loss: 0.941 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0604047775268555
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.013 Vali Acc: 0.850 Test Loss: 1.013 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.125842571258545
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.172 Vali Acc: 0.834 Test Loss: 1.172 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.067460060119629
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.218 Vali Acc: 0.838 Test Loss: 1.218 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0105571746826172
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.198 Vali Acc: 0.850 Test Loss: 1.198 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9937033653259277
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.844 Test Loss: 1.175 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.080554723739624
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.850 Test Loss: 1.184 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0991227626800537
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.850 Test Loss: 1.204 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1307428
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1166181564331055
Epoch: 1, Steps: 8 | Train Loss: 1.831 Vali Loss: 0.898 Vali Acc: 0.759 Test Loss: 0.898 Test Acc: 0.759
Validation loss decreased (inf --> -0.759366).  Saving model ...
Epoch: 2 cost time: 0.9925780296325684
Epoch: 2, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
Validation loss decreased (-0.759366 --> -0.809369).  Saving model ...
Epoch: 3 cost time: 0.9271395206451416
Epoch: 3, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
Validation loss decreased (-0.809369 --> -0.849994).  Saving model ...
Epoch: 4 cost time: 0.8439123630523682
Epoch: 4, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.768 Vali Acc: 0.841 Test Loss: 0.768 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0524470806121826
Epoch: 5, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.924 Vali Acc: 0.828 Test Loss: 0.924 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0132062435150146
Epoch: 6, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.854 Vali Acc: 0.863 Test Loss: 0.854 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.862491).  Saving model ...
Epoch: 7 cost time: 0.9923357963562012
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.949 Vali Acc: 0.850 Test Loss: 0.949 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0527515411376953
Epoch: 8, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.044 Vali Acc: 0.841 Test Loss: 1.044 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0808825492858887
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.061 Vali Acc: 0.844 Test Loss: 1.061 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.017652988433838
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.192 Vali Acc: 0.831 Test Loss: 1.192 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9266252517700195
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.298 Vali Acc: 0.838 Test Loss: 1.298 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0038843154907227
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.652 Vali Acc: 0.834 Test Loss: 1.652 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8653674125671387
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.836 Vali Acc: 0.819 Test Loss: 1.836 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9852590560913086
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.607 Vali Acc: 0.844 Test Loss: 1.607 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.164445161819458
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.827 Vali Acc: 0.838 Test Loss: 1.827 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1219823360443115
Epoch: 16, Steps: 8 | Train Loss: 0.102 Vali Loss: 2.374 Vali Acc: 0.812 Test Loss: 2.374 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1307428
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1908929347991943
Epoch: 1, Steps: 8 | Train Loss: 1.831 Vali Loss: 0.907 Vali Acc: 0.759 Test Loss: 0.907 Test Acc: 0.759
Validation loss decreased (inf --> -0.759366).  Saving model ...
Epoch: 2 cost time: 0.9985148906707764
Epoch: 2, Steps: 8 | Train Loss: 0.549 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (-0.759366 --> -0.818744).  Saving model ...
Epoch: 3 cost time: 1.03226637840271
Epoch: 3, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
Validation loss decreased (-0.818744 --> -0.856244).  Saving model ...
Epoch: 4 cost time: 0.9254202842712402
Epoch: 4, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.735 Vali Acc: 0.841 Test Loss: 0.735 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0482919216156006
Epoch: 5, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.778 Vali Acc: 0.856 Test Loss: 0.778 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9941165447235107
Epoch: 6, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.853 Vali Acc: 0.853 Test Loss: 0.853 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8389010429382324
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.853 Test Loss: 0.959 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.027791976928711
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.856 Test Loss: 1.057 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0354702472686768
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.859 Test Loss: 1.063 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859364).  Saving model ...
Epoch: 10 cost time: 1.1388967037200928
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.856 Test Loss: 1.052 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1080751419067383
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.856 Test Loss: 1.041 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1969354152679443
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.856 Test Loss: 1.034 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1107780933380127
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.866 Test Loss: 1.020 Test Acc: 0.866
Validation loss decreased (-0.859364 --> -0.865615).  Saving model ...
Epoch: 14 cost time: 1.0565669536590576
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.869 Test Loss: 1.009 Test Acc: 0.869
Validation loss decreased (-0.865615 --> -0.868740).  Saving model ...
Epoch: 15 cost time: 1.014791488647461
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.869 Test Loss: 1.000 Test Acc: 0.869
Validation loss decreased (-0.868740 --> -0.868740).  Saving model ...
Epoch: 16 cost time: 0.9862732887268066
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.872 Test Loss: 0.998 Test Acc: 0.872
Validation loss decreased (-0.868740 --> -0.871865).  Saving model ...
Epoch: 17 cost time: 1.0433993339538574
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.878 Test Loss: 0.997 Test Acc: 0.878
Validation loss decreased (-0.871865 --> -0.878115).  Saving model ...
Epoch: 18 cost time: 1.0265698432922363
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.875 Test Loss: 0.998 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.115617036819458
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.875 Test Loss: 0.995 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0559959411621094
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.875 Test Loss: 0.990 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0324220657348633
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.872 Test Loss: 0.987 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0202016830444336
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.872 Test Loss: 0.986 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9640531539916992
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.872 Test Loss: 0.987 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1310627460479736
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.872 Test Loss: 0.987 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0464143753051758
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.872 Test Loss: 0.990 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0562515258789062
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.875 Test Loss: 0.995 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0277495384216309
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.875 Test Loss: 0.995 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 1307428
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.903665781021118
Epoch: 1, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.044 Vali Acc: 0.750 Test Loss: 1.044 Test Acc: 0.750
Validation loss decreased (inf --> -0.749990).  Saving model ...
Epoch: 2 cost time: 1.0268046855926514
Epoch: 2, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799994).  Saving model ...
Epoch: 3 cost time: 1.0336062908172607
Epoch: 3, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.639 Vali Acc: 0.834 Test Loss: 0.639 Test Acc: 0.834
Validation loss decreased (-0.799994 --> -0.834369).  Saving model ...
Epoch: 4 cost time: 1.158846378326416
Epoch: 4, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.803 Vali Acc: 0.822 Test Loss: 0.803 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0349960327148438
Epoch: 5, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.847 Vali Acc: 0.841 Test Loss: 0.847 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840617).  Saving model ...
Epoch: 6 cost time: 0.8820514678955078
Epoch: 6, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.911 Vali Acc: 0.825 Test Loss: 0.911 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0127923488616943
Epoch: 7, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.014 Vali Acc: 0.828 Test Loss: 1.014 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9823412895202637
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.227 Vali Acc: 0.803 Test Loss: 1.227 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0325865745544434
Epoch: 9, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.096 Vali Acc: 0.834 Test Loss: 1.096 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0797345638275146
Epoch: 10, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.670 Vali Acc: 0.803 Test Loss: 1.670 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1698787212371826
Epoch: 11, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.736 Vali Acc: 0.812 Test Loss: 1.736 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9714071750640869
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.531 Vali Acc: 0.816 Test Loss: 1.531 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1021876335144043
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.402 Vali Acc: 0.822 Test Loss: 1.402 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.101762294769287
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.812 Test Loss: 1.439 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1834285259246826
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.825 Test Loss: 1.485 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 1307428
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0162529945373535
Epoch: 1, Steps: 8 | Train Loss: 1.732 Vali Loss: 0.830 Vali Acc: 0.803 Test Loss: 0.830 Test Acc: 0.803
Validation loss decreased (inf --> -0.803117).  Saving model ...
Epoch: 2 cost time: 1.1514334678649902
Epoch: 2, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
Validation loss decreased (-0.803117 --> -0.834370).  Saving model ...
Epoch: 3 cost time: 1.0599572658538818
Epoch: 3, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.742 Vali Acc: 0.822 Test Loss: 0.742 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.128859281539917
Epoch: 4, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.783 Vali Acc: 0.844 Test Loss: 0.783 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843742).  Saving model ...
Epoch: 5 cost time: 1.1553926467895508
Epoch: 5, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.004 Vali Acc: 0.819 Test Loss: 1.004 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0882747173309326
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.071 Vali Acc: 0.816 Test Loss: 1.071 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0458900928497314
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.027 Vali Acc: 0.828 Test Loss: 1.027 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1220312118530273
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.125 Vali Acc: 0.809 Test Loss: 1.125 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0394797325134277
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.251 Vali Acc: 0.825 Test Loss: 1.251 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8875784873962402
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.371 Vali Acc: 0.816 Test Loss: 1.371 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3145241737365723
Epoch: 11, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.495 Vali Acc: 0.828 Test Loss: 1.495 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2840087413787842
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.636 Vali Acc: 0.828 Test Loss: 1.636 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9739775657653809
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.689 Vali Acc: 0.838 Test Loss: 1.689 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8739886283874512
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.062 Vali Acc: 0.809 Test Loss: 2.062 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1045284
model size : 8.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.242743730545044
Epoch: 1, Steps: 8 | Train Loss: 1.712 Vali Loss: 0.828 Vali Acc: 0.816 Test Loss: 0.828 Test Acc: 0.816
Validation loss decreased (inf --> -0.815617).  Saving model ...
Epoch: 2 cost time: 1.1183128356933594
Epoch: 2, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
Validation loss decreased (-0.815617 --> -0.837495).  Saving model ...
Epoch: 3 cost time: 1.0842211246490479
Epoch: 3, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.708 Vali Acc: 0.828 Test Loss: 0.708 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.057032585144043
Epoch: 4, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849992).  Saving model ...
Epoch: 5 cost time: 1.0969927310943604
Epoch: 5, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.012 Vali Acc: 0.825 Test Loss: 1.012 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.182837963104248
Epoch: 6, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.974 Vali Acc: 0.844 Test Loss: 0.974 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.128526210784912
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.959 Vali Acc: 0.841 Test Loss: 0.959 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0514047145843506
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.091 Vali Acc: 0.825 Test Loss: 1.091 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1490733623504639
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.256 Vali Acc: 0.822 Test Loss: 1.256 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1218311786651611
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.270 Vali Acc: 0.834 Test Loss: 1.270 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0017614364624023
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.389 Vali Acc: 0.828 Test Loss: 1.389 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8894929885864258
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.527 Vali Acc: 0.828 Test Loss: 1.527 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0567212104797363
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.834 Test Loss: 1.348 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9713084697723389
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.831 Test Loss: 1.356 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1045284
model size : 8.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.075404644012451
Epoch: 1, Steps: 8 | Train Loss: 1.751 Vali Loss: 0.852 Vali Acc: 0.800 Test Loss: 0.852 Test Acc: 0.800
Validation loss decreased (inf --> -0.799991).  Saving model ...
Epoch: 2 cost time: 0.983867883682251
Epoch: 2, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
Validation loss decreased (-0.799991 --> -0.853120).  Saving model ...
Epoch: 3 cost time: 1.1252427101135254
Epoch: 3, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.653 Vali Acc: 0.841 Test Loss: 0.653 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9544470310211182
Epoch: 4, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.715 Vali Acc: 0.863 Test Loss: 0.715 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862493).  Saving model ...
Epoch: 5 cost time: 0.9503979682922363
Epoch: 5, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.841 Vali Acc: 0.847 Test Loss: 0.841 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0624206066131592
Epoch: 6, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.918 Vali Acc: 0.850 Test Loss: 0.918 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9459226131439209
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.738 Vali Acc: 0.897 Test Loss: 0.738 Test Acc: 0.897
Validation loss decreased (-0.862493 --> -0.896868).  Saving model ...
Epoch: 8 cost time: 0.9117255210876465
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.975 Vali Acc: 0.856 Test Loss: 0.975 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0003271102905273
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.067 Vali Acc: 0.841 Test Loss: 1.067 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9998164176940918
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.962 Vali Acc: 0.878 Test Loss: 0.962 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9426851272583008
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.141 Vali Acc: 0.869 Test Loss: 1.141 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0103778839111328
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.844 Test Loss: 1.180 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9930946826934814
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.844 Test Loss: 1.176 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0648024082183838
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.152 Vali Acc: 0.850 Test Loss: 1.152 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0110764503479004
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.853 Test Loss: 1.180 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9186861515045166
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.856 Test Loss: 1.193 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.009155511856079
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.863 Test Loss: 1.183 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.896875
model parameter : 1045284
model size : 8.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.14471173286438
Epoch: 1, Steps: 8 | Train Loss: 1.754 Vali Loss: 0.999 Vali Acc: 0.756 Test Loss: 0.999 Test Acc: 0.756
Validation loss decreased (inf --> -0.756240).  Saving model ...
Epoch: 2 cost time: 0.9371249675750732
Epoch: 2, Steps: 8 | Train Loss: 0.617 Vali Loss: 0.604 Vali Acc: 0.791 Test Loss: 0.604 Test Acc: 0.791
Validation loss decreased (-0.756240 --> -0.790619).  Saving model ...
Epoch: 3 cost time: 0.9878284931182861
Epoch: 3, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.705 Vali Acc: 0.812 Test Loss: 0.705 Test Acc: 0.812
Validation loss decreased (-0.790619 --> -0.812493).  Saving model ...
Epoch: 4 cost time: 0.9396114349365234
Epoch: 4, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.774 Vali Acc: 0.841 Test Loss: 0.774 Test Acc: 0.841
Validation loss decreased (-0.812493 --> -0.840617).  Saving model ...
Epoch: 5 cost time: 1.0748250484466553
Epoch: 5, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.859 Vali Acc: 0.844 Test Loss: 0.859 Test Acc: 0.844
Validation loss decreased (-0.840617 --> -0.843741).  Saving model ...
Epoch: 6 cost time: 0.9844400882720947
Epoch: 6, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.006 Vali Acc: 0.819 Test Loss: 1.006 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9944069385528564
Epoch: 7, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.828 Vali Acc: 0.828 Test Loss: 0.828 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0499591827392578
Epoch: 8, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.111 Vali Acc: 0.828 Test Loss: 1.111 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1391282081604004
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.308 Vali Acc: 0.819 Test Loss: 1.308 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0262978076934814
Epoch: 10, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.229 Vali Acc: 0.819 Test Loss: 1.229 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.064711093902588
Epoch: 11, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.195 Vali Acc: 0.841 Test Loss: 1.195 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0501377582550049
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.381 Vali Acc: 0.828 Test Loss: 1.381 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9864625930786133
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.368 Vali Acc: 0.838 Test Loss: 1.368 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9809024333953857
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.480 Vali Acc: 0.819 Test Loss: 1.480 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9085953235626221
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.417 Vali Acc: 0.828 Test Loss: 1.417 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1045284
model size : 8.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.074803352355957
Epoch: 1, Steps: 8 | Train Loss: 1.829 Vali Loss: 0.879 Vali Acc: 0.791 Test Loss: 0.879 Test Acc: 0.791
Validation loss decreased (inf --> -0.790616).  Saving model ...
Epoch: 2 cost time: 1.2305858135223389
Epoch: 2, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
Validation loss decreased (-0.790616 --> -0.846870).  Saving model ...
Epoch: 3 cost time: 0.999380350112915
Epoch: 3, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856244).  Saving model ...
Epoch: 4 cost time: 1.0533380508422852
Epoch: 4, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.867 Vali Acc: 0.838 Test Loss: 0.867 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0538008213043213
Epoch: 5, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.919 Vali Acc: 0.863 Test Loss: 0.919 Test Acc: 0.863
Validation loss decreased (-0.856244 --> -0.862491).  Saving model ...
Epoch: 6 cost time: 1.1154530048370361
Epoch: 6, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.975 Vali Acc: 0.856 Test Loss: 0.975 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0705196857452393
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.282 Vali Acc: 0.819 Test Loss: 1.282 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0911030769348145
Epoch: 8, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.233 Vali Acc: 0.850 Test Loss: 1.233 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0795114040374756
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.248 Vali Acc: 0.841 Test Loss: 1.248 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0973358154296875
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.841 Test Loss: 1.385 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9999194145202637
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.831 Test Loss: 1.402 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0124242305755615
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.828 Test Loss: 1.402 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.021873950958252
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.828 Test Loss: 1.393 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0420536994934082
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.834 Test Loss: 1.373 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9245975017547607
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.838 Test Loss: 1.357 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 914212
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.117494583129883
Epoch: 1, Steps: 8 | Train Loss: 1.819 Vali Loss: 0.898 Vali Acc: 0.772 Test Loss: 0.898 Test Acc: 0.772
Validation loss decreased (inf --> -0.771866).  Saving model ...
Epoch: 2 cost time: 1.0166876316070557
Epoch: 2, Steps: 8 | Train Loss: 0.504 Vali Loss: 0.471 Vali Acc: 0.853 Test Loss: 0.471 Test Acc: 0.853
Validation loss decreased (-0.771866 --> -0.853120).  Saving model ...
Epoch: 3 cost time: 0.9864704608917236
Epoch: 3, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.555 Vali Acc: 0.866 Test Loss: 0.555 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865619).  Saving model ...
Epoch: 4 cost time: 1.081496000289917
Epoch: 4, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.804 Vali Acc: 0.844 Test Loss: 0.804 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0170669555664062
Epoch: 5, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.869 Vali Acc: 0.866 Test Loss: 0.869 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9670352935791016
Epoch: 6, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.998 Vali Acc: 0.841 Test Loss: 0.998 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9947609901428223
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.096 Vali Acc: 0.834 Test Loss: 1.096 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0882518291473389
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.183 Vali Acc: 0.844 Test Loss: 1.183 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9220554828643799
Epoch: 9, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.276 Vali Acc: 0.850 Test Loss: 1.276 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7845537662506104
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.525 Vali Acc: 0.816 Test Loss: 1.525 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.978919267654419
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.806 Test Loss: 1.630 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8417952060699463
Epoch: 12, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.393 Vali Acc: 0.822 Test Loss: 1.393 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9858059883117676
Epoch: 13, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.283 Vali Acc: 0.831 Test Loss: 1.283 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 914212
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1107873916625977
Epoch: 1, Steps: 8 | Train Loss: 1.807 Vali Loss: 0.926 Vali Acc: 0.759 Test Loss: 0.926 Test Acc: 0.759
Validation loss decreased (inf --> -0.759366).  Saving model ...
Epoch: 2 cost time: 1.0148189067840576
Epoch: 2, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
Validation loss decreased (-0.759366 --> -0.840620).  Saving model ...
Epoch: 3 cost time: 0.9133760929107666
Epoch: 3, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.840620 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 0.9949393272399902
Epoch: 4, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.785 Vali Acc: 0.831 Test Loss: 0.785 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8976974487304688
Epoch: 5, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.823 Vali Acc: 0.866 Test Loss: 0.823 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9857177734375
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.839 Vali Acc: 0.863 Test Loss: 0.839 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0363547801971436
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.075 Vali Acc: 0.838 Test Loss: 1.075 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9317934513092041
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.094 Vali Acc: 0.850 Test Loss: 1.094 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1028990745544434
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.866 Test Loss: 1.036 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0068247318267822
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.161 Vali Acc: 0.856 Test Loss: 1.161 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9942724704742432
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.960 Vali Acc: 0.869 Test Loss: 0.960 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9119811058044434
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.976 Vali Acc: 0.872 Test Loss: 0.976 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9459226131439209
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.021 Vali Acc: 0.872 Test Loss: 1.021 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 914212
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6741883754730225
Epoch: 1, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.011 Vali Acc: 0.753 Test Loss: 1.011 Test Acc: 0.753
Validation loss decreased (inf --> -0.753115).  Saving model ...
Epoch: 2 cost time: 0.894202470779419
Epoch: 2, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
Validation loss decreased (-0.753115 --> -0.818745).  Saving model ...
Epoch: 3 cost time: 0.9508988857269287
Epoch: 3, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.702 Vali Acc: 0.819 Test Loss: 0.702 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9819662570953369
Epoch: 4, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0475552082061768
Epoch: 5, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.851 Vali Acc: 0.828 Test Loss: 0.851 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828116).  Saving model ...
Epoch: 6 cost time: 0.9371957778930664
Epoch: 6, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.950 Vali Acc: 0.838 Test Loss: 0.950 Test Acc: 0.838
Validation loss decreased (-0.828116 --> -0.837490).  Saving model ...
Epoch: 7 cost time: 0.9252853393554688
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.026 Vali Acc: 0.844 Test Loss: 1.026 Test Acc: 0.844
Validation loss decreased (-0.837490 --> -0.843740).  Saving model ...
Epoch: 8 cost time: 1.0055210590362549
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.061 Vali Acc: 0.838 Test Loss: 1.061 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9951744079589844
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.178 Vali Acc: 0.831 Test Loss: 1.178 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.860558271408081
Epoch: 10, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.093 Vali Acc: 0.863 Test Loss: 1.093 Test Acc: 0.863
Validation loss decreased (-0.843740 --> -0.862489).  Saving model ...
Epoch: 11 cost time: 0.8323109149932861
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.230 Vali Acc: 0.831 Test Loss: 1.230 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0189149379730225
Epoch: 12, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.224 Vali Acc: 0.831 Test Loss: 1.224 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9580893516540527
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.169 Vali Acc: 0.838 Test Loss: 1.169 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9340701103210449
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.244 Vali Acc: 0.838 Test Loss: 1.244 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0179369449615479
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.297 Vali Acc: 0.838 Test Loss: 1.297 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9434423446655273
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.841 Test Loss: 1.179 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.969139575958252
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.179 Vali Acc: 0.844 Test Loss: 1.179 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0522093772888184
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.306 Vali Acc: 0.838 Test Loss: 1.306 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8627638816833496
Epoch: 19, Steps: 8 | Train Loss: 0.319 Vali Loss: 1.609 Vali Acc: 0.825 Test Loss: 1.609 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9816787242889404
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 2.192 Vali Acc: 0.741 Test Loss: 2.192 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 914212
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9757699966430664
Epoch: 1, Steps: 8 | Train Loss: 1.976 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (inf --> -0.774991).  Saving model ...
Epoch: 2 cost time: 1.1709792613983154
Epoch: 2, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
Validation loss decreased (-0.774991 --> -0.840620).  Saving model ...
Epoch: 3 cost time: 1.138878583908081
Epoch: 3, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.622 Vali Acc: 0.853 Test Loss: 0.622 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853119).  Saving model ...
Epoch: 4 cost time: 0.9755673408508301
Epoch: 4, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.129 Vali Acc: 0.784 Test Loss: 1.129 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0640699863433838
Epoch: 5, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.131 Vali Acc: 0.819 Test Loss: 1.131 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1096956729888916
Epoch: 6, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.134 Vali Acc: 0.847 Test Loss: 1.134 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0922422409057617
Epoch: 7, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.324 Vali Acc: 0.828 Test Loss: 1.324 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1826868057250977
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.288 Vali Acc: 0.819 Test Loss: 1.288 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0679056644439697
Epoch: 9, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.320 Vali Acc: 0.816 Test Loss: 1.320 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9977719783782959
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.613 Vali Acc: 0.819 Test Loss: 1.613 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9673447608947754
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.748 Vali Acc: 0.816 Test Loss: 1.748 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.030928373336792
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.819 Test Loss: 1.756 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.982769250869751
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.778 Vali Acc: 0.822 Test Loss: 1.778 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 848676
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9712867736816406
Epoch: 1, Steps: 8 | Train Loss: 1.972 Vali Loss: 0.909 Vali Acc: 0.769 Test Loss: 0.909 Test Acc: 0.769
Validation loss decreased (inf --> -0.768741).  Saving model ...
Epoch: 2 cost time: 0.9922916889190674
Epoch: 2, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
Validation loss decreased (-0.768741 --> -0.840620).  Saving model ...
Epoch: 3 cost time: 1.0150258541107178
Epoch: 3, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
Validation loss decreased (-0.840620 --> -0.859369).  Saving model ...
Epoch: 4 cost time: 1.078047752380371
Epoch: 4, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.094 Vali Acc: 0.784 Test Loss: 1.094 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1049480438232422
Epoch: 5, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.158 Vali Acc: 0.822 Test Loss: 1.158 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.102531909942627
Epoch: 6, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.034 Vali Acc: 0.844 Test Loss: 1.034 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0279371738433838
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.113 Vali Acc: 0.822 Test Loss: 1.113 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9423441886901855
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.204 Vali Acc: 0.844 Test Loss: 1.204 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0511784553527832
Epoch: 9, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.167 Vali Acc: 0.834 Test Loss: 1.167 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0847387313842773
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.318 Vali Acc: 0.844 Test Loss: 1.318 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1921522617340088
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.530 Vali Acc: 0.828 Test Loss: 1.530 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2349298000335693
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.832 Vali Acc: 0.825 Test Loss: 1.832 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.020735740661621
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.059 Vali Acc: 0.809 Test Loss: 2.059 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 848676
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.106276750564575
Epoch: 1, Steps: 8 | Train Loss: 1.923 Vali Loss: 0.927 Vali Acc: 0.775 Test Loss: 0.927 Test Acc: 0.775
Validation loss decreased (inf --> -0.774991).  Saving model ...
Epoch: 2 cost time: 1.019679307937622
Epoch: 2, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
Validation loss decreased (-0.774991 --> -0.846871).  Saving model ...
Epoch: 3 cost time: 1.047316074371338
Epoch: 3, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.549 Vali Acc: 0.866 Test Loss: 0.549 Test Acc: 0.866
Validation loss decreased (-0.846871 --> -0.865620).  Saving model ...
Epoch: 4 cost time: 1.0191738605499268
Epoch: 4, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.023 Vali Acc: 0.819 Test Loss: 1.023 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.123192548751831
Epoch: 5, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.959 Vali Acc: 0.844 Test Loss: 0.959 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9204263687133789
Epoch: 6, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.915 Vali Acc: 0.869 Test Loss: 0.915 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868741).  Saving model ...
Epoch: 7 cost time: 0.9502336978912354
Epoch: 7, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.089 Vali Acc: 0.831 Test Loss: 1.089 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.062995195388794
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.105 Vali Acc: 0.844 Test Loss: 1.105 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.027209997177124
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.213 Vali Acc: 0.822 Test Loss: 1.213 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.013195514678955
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.203 Vali Acc: 0.859 Test Loss: 1.203 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.024639368057251
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.527 Vali Acc: 0.838 Test Loss: 1.527 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0330233573913574
Epoch: 12, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.513 Vali Acc: 0.841 Test Loss: 1.513 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0410304069519043
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.838 Test Loss: 1.544 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1480753421783447
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.825 Test Loss: 1.724 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.185704231262207
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.610 Vali Acc: 0.831 Test Loss: 1.610 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.031203269958496
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.803 Test Loss: 1.732 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 848676
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.064380407333374
Epoch: 1, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.074 Vali Acc: 0.759 Test Loss: 1.074 Test Acc: 0.759
Validation loss decreased (inf --> -0.759364).  Saving model ...
Epoch: 2 cost time: 0.9642562866210938
Epoch: 2, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.759364 --> -0.821870).  Saving model ...
Epoch: 3 cost time: 0.91428542137146
Epoch: 3, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.647 Vali Acc: 0.816 Test Loss: 0.647 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1166050434112549
Epoch: 4, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.188 Vali Acc: 0.772 Test Loss: 1.188 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.074345588684082
Epoch: 5, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.235 Vali Acc: 0.791 Test Loss: 1.235 Test Acc: 0.791
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1342897415161133
Epoch: 6, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.045 Vali Acc: 0.828 Test Loss: 1.045 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828115).  Saving model ...
Epoch: 7 cost time: 1.0722301006317139
Epoch: 7, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.189 Vali Acc: 0.806 Test Loss: 1.189 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1042866706848145
Epoch: 8, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.152 Vali Acc: 0.828 Test Loss: 1.152 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9335794448852539
Epoch: 9, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.434 Vali Acc: 0.797 Test Loss: 1.434 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8759124279022217
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.363 Vali Acc: 0.803 Test Loss: 1.363 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9135448932647705
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.449 Vali Acc: 0.803 Test Loss: 1.449 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0785717964172363
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.800 Test Loss: 1.468 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9659090042114258
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.445 Vali Acc: 0.819 Test Loss: 1.445 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1596589088439941
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.430 Vali Acc: 0.838 Test Loss: 1.430 Test Acc: 0.838
Validation loss decreased (-0.828115 --> -0.837486).  Saving model ...
Epoch: 15 cost time: 1.0811481475830078
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.853 Test Loss: 1.435 Test Acc: 0.853
Validation loss decreased (-0.837486 --> -0.853111).  Saving model ...
Epoch: 16 cost time: 1.0804851055145264
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.856 Test Loss: 1.453 Test Acc: 0.856
Validation loss decreased (-0.853111 --> -0.856235).  Saving model ...
Epoch: 17 cost time: 0.9862701892852783
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.856 Test Loss: 1.472 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9217314720153809
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.856 Test Loss: 1.483 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0810725688934326
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.856 Test Loss: 1.500 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1981916427612305
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.856 Test Loss: 1.510 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0690853595733643
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.856 Test Loss: 1.514 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0691936016082764
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.853 Test Loss: 1.516 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.026139259338379
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.853 Test Loss: 1.517 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9577775001525879
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.853 Test Loss: 1.517 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9877963066101074
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.853 Test Loss: 1.515 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9415056705474854
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.853 Test Loss: 1.514 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 848676
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.828479766845703
Epoch: 1, Steps: 8 | Train Loss: 1.839 Vali Loss: 0.879 Vali Acc: 0.756 Test Loss: 0.879 Test Acc: 0.756
Validation loss decreased (inf --> -0.756241).  Saving model ...
Epoch: 2 cost time: 0.925534725189209
Epoch: 2, Steps: 8 | Train Loss: 0.654 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
Validation loss decreased (-0.756241 --> -0.834370).  Saving model ...
Epoch: 3 cost time: 0.9730319976806641
Epoch: 3, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.720 Vali Acc: 0.831 Test Loss: 0.720 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0889580249786377
Epoch: 4, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.838 Vali Acc: 0.834 Test Loss: 0.838 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.887516975402832
Epoch: 5, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.840 Vali Acc: 0.850 Test Loss: 0.840 Test Acc: 0.850
Validation loss decreased (-0.834370 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 0.9641118049621582
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.831 Test Loss: 1.034 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9485611915588379
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.982 Vali Acc: 0.844 Test Loss: 0.982 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0009429454803467
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.215 Vali Acc: 0.822 Test Loss: 1.215 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9834496974945068
Epoch: 9, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.319 Vali Acc: 0.831 Test Loss: 1.319 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.00046968460083
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.505 Vali Acc: 0.825 Test Loss: 1.505 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0110092163085938
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.281 Vali Acc: 0.844 Test Loss: 1.281 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9105660915374756
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.088 Vali Acc: 0.859 Test Loss: 1.088 Test Acc: 0.859
Validation loss decreased (-0.849992 --> -0.859364).  Saving model ...
Epoch: 13 cost time: 0.9434406757354736
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.872 Test Loss: 1.059 Test Acc: 0.872
Validation loss decreased (-0.859364 --> -0.871864).  Saving model ...
Epoch: 14 cost time: 0.8463752269744873
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.107 Vali Acc: 0.856 Test Loss: 1.107 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9544408321380615
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.287 Vali Acc: 0.834 Test Loss: 1.287 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8425791263580322
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.384 Vali Acc: 0.853 Test Loss: 1.384 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8624317646026611
Epoch: 17, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.825 Vali Acc: 0.828 Test Loss: 1.825 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0473113059997559
Epoch: 18, Steps: 8 | Train Loss: 0.092 Vali Loss: 2.521 Vali Acc: 0.787 Test Loss: 2.521 Test Acc: 0.787
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0937185287475586
Epoch: 19, Steps: 8 | Train Loss: 0.375 Vali Loss: 2.340 Vali Acc: 0.828 Test Loss: 2.340 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.066840648651123
Epoch: 20, Steps: 8 | Train Loss: 0.148 Vali Loss: 2.572 Vali Acc: 0.816 Test Loss: 2.572 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.005502700805664
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 3.157 Vali Acc: 0.819 Test Loss: 3.157 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0627069473266602
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 3.317 Vali Acc: 0.812 Test Loss: 3.317 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0666286945343018
Epoch: 23, Steps: 8 | Train Loss: 0.035 Vali Loss: 3.659 Vali Acc: 0.791 Test Loss: 3.659 Test Acc: 0.791
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 815908
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.187363386154175
Epoch: 1, Steps: 8 | Train Loss: 1.830 Vali Loss: 0.880 Vali Acc: 0.753 Test Loss: 0.880 Test Acc: 0.753
Validation loss decreased (inf --> -0.753116).  Saving model ...
Epoch: 2 cost time: 0.9700701236724854
Epoch: 2, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.753116 --> -0.840620).  Saving model ...
Epoch: 3 cost time: 1.0383601188659668
Epoch: 3, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.712 Vali Acc: 0.834 Test Loss: 0.712 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0673985481262207
Epoch: 4, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.827 Vali Acc: 0.834 Test Loss: 0.827 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.057551383972168
Epoch: 5, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.814 Vali Acc: 0.850 Test Loss: 0.814 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 0.9062817096710205
Epoch: 6, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.998 Vali Acc: 0.834 Test Loss: 0.998 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0289843082427979
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.946 Vali Acc: 0.834 Test Loss: 0.946 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9696178436279297
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.060 Vali Acc: 0.844 Test Loss: 1.060 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.929973840713501
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.179 Vali Acc: 0.850 Test Loss: 1.179 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0781071186065674
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.129 Vali Acc: 0.844 Test Loss: 1.129 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0363709926605225
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.105 Vali Acc: 0.841 Test Loss: 1.105 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.842390775680542
Epoch: 12, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.404 Vali Acc: 0.825 Test Loss: 1.404 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9623212814331055
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.325 Vali Acc: 0.859 Test Loss: 1.325 Test Acc: 0.859
Validation loss decreased (-0.849992 --> -0.859362).  Saving model ...
Epoch: 14 cost time: 0.9324955940246582
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.520 Vali Acc: 0.822 Test Loss: 1.520 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9169933795928955
Epoch: 15, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.757 Vali Acc: 0.844 Test Loss: 1.757 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9988024234771729
Epoch: 16, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.834 Vali Acc: 0.791 Test Loss: 1.834 Test Acc: 0.791
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0373303890228271
Epoch: 17, Steps: 8 | Train Loss: 0.222 Vali Loss: 2.065 Vali Acc: 0.803 Test Loss: 2.065 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.023730754852295
Epoch: 18, Steps: 8 | Train Loss: 0.238 Vali Loss: 2.819 Vali Acc: 0.806 Test Loss: 2.819 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9628336429595947
Epoch: 19, Steps: 8 | Train Loss: 0.058 Vali Loss: 2.353 Vali Acc: 0.822 Test Loss: 2.353 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.966975212097168
Epoch: 20, Steps: 8 | Train Loss: 0.069 Vali Loss: 2.723 Vali Acc: 0.831 Test Loss: 2.723 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9782149791717529
Epoch: 21, Steps: 8 | Train Loss: 0.071 Vali Loss: 3.099 Vali Acc: 0.806 Test Loss: 3.099 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.008357286453247
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 3.110 Vali Acc: 0.784 Test Loss: 3.110 Test Acc: 0.784
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0407993793487549
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.885 Vali Acc: 0.831 Test Loss: 2.885 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 815908
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.895812749862671
Epoch: 1, Steps: 8 | Train Loss: 1.793 Vali Loss: 0.885 Vali Acc: 0.778 Test Loss: 0.885 Test Acc: 0.778
Validation loss decreased (inf --> -0.778116).  Saving model ...
Epoch: 2 cost time: 0.9489636421203613
Epoch: 2, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
Validation loss decreased (-0.778116 --> -0.840620).  Saving model ...
Epoch: 3 cost time: 0.9902451038360596
Epoch: 3, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843743).  Saving model ...
Epoch: 4 cost time: 1.0594329833984375
Epoch: 4, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.797 Vali Acc: 0.834 Test Loss: 0.797 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1414482593536377
Epoch: 5, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.757 Vali Acc: 0.853 Test Loss: 0.757 Test Acc: 0.853
Validation loss decreased (-0.843743 --> -0.853117).  Saving model ...
Epoch: 6 cost time: 0.8734018802642822
Epoch: 6, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.936 Vali Acc: 0.841 Test Loss: 0.936 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8136792182922363
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.998 Vali Acc: 0.847 Test Loss: 0.998 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8835382461547852
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.859 Test Loss: 0.896 Test Acc: 0.859
Validation loss decreased (-0.853117 --> -0.859366).  Saving model ...
Epoch: 9 cost time: 1.0538218021392822
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.878 Test Loss: 0.848 Test Acc: 0.878
Validation loss decreased (-0.859366 --> -0.878117).  Saving model ...
Epoch: 10 cost time: 0.9853179454803467
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.878 Test Loss: 0.860 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1138544082641602
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.887 Test Loss: 0.875 Test Acc: 0.887
Validation loss decreased (-0.878117 --> -0.887491).  Saving model ...
Epoch: 12 cost time: 1.0079421997070312
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.891 Test Loss: 0.890 Test Acc: 0.891
Validation loss decreased (-0.887491 --> -0.890616).  Saving model ...
Epoch: 13 cost time: 0.9398369789123535
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.887 Test Loss: 0.896 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9108612537384033
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.881 Test Loss: 0.904 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0516235828399658
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.881 Test Loss: 0.910 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9229550361633301
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.878 Test Loss: 0.913 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0070087909698486
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.875 Test Loss: 0.918 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0908339023590088
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.875 Test Loss: 0.925 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9777305126190186
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.872 Test Loss: 0.935 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0291345119476318
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.872 Test Loss: 0.941 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0749571323394775
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.878 Test Loss: 0.942 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0829977989196777
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.878 Test Loss: 0.945 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.890625
model parameter : 815908
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9764904975891113
Epoch: 1, Steps: 8 | Train Loss: 1.838 Vali Loss: 1.012 Vali Acc: 0.759 Test Loss: 1.012 Test Acc: 0.759
Validation loss decreased (inf --> -0.759365).  Saving model ...
Epoch: 2 cost time: 1.0046863555908203
Epoch: 2, Steps: 8 | Train Loss: 0.709 Vali Loss: 0.591 Vali Acc: 0.806 Test Loss: 0.591 Test Acc: 0.806
Validation loss decreased (-0.759365 --> -0.806244).  Saving model ...
Epoch: 3 cost time: 1.0086116790771484
Epoch: 3, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.747 Vali Acc: 0.812 Test Loss: 0.747 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812493).  Saving model ...
Epoch: 4 cost time: 0.9373190402984619
Epoch: 4, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.838 Vali Acc: 0.784 Test Loss: 0.838 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9453387260437012
Epoch: 5, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.906 Vali Acc: 0.838 Test Loss: 0.906 Test Acc: 0.838
Validation loss decreased (-0.812493 --> -0.837491).  Saving model ...
Epoch: 6 cost time: 1.1024224758148193
Epoch: 6, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.990 Vali Acc: 0.831 Test Loss: 0.990 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0195198059082031
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.966 Vali Acc: 0.831 Test Loss: 0.966 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0129716396331787
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.937 Vali Acc: 0.847 Test Loss: 0.937 Test Acc: 0.847
Validation loss decreased (-0.837491 --> -0.846866).  Saving model ...
Epoch: 9 cost time: 1.0743505954742432
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.520 Vali Acc: 0.797 Test Loss: 1.520 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.073286533355713
Epoch: 10, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.255 Vali Acc: 0.831 Test Loss: 1.255 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8939869403839111
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.404 Vali Acc: 0.822 Test Loss: 1.404 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9644649028778076
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.601 Vali Acc: 0.794 Test Loss: 1.601 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9015927314758301
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.181 Vali Acc: 0.838 Test Loss: 1.181 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1308646202087402
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.170 Vali Acc: 0.841 Test Loss: 1.170 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9695045948028564
Epoch: 15, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.227 Vali Acc: 0.847 Test Loss: 1.227 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9424259662628174
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.262 Vali Acc: 0.847 Test Loss: 1.262 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9932575225830078
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.581 Vali Acc: 0.812 Test Loss: 1.581 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9052839279174805
Epoch: 18, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.820 Vali Acc: 0.784 Test Loss: 1.820 Test Acc: 0.784
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 815908
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.028972864151001
Epoch: 1, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.202 Vali Acc: 0.756 Test Loss: 1.202 Test Acc: 0.756
Validation loss decreased (inf --> -0.756238).  Saving model ...
Epoch: 2 cost time: 0.9577054977416992
Epoch: 2, Steps: 8 | Train Loss: 0.773 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
Validation loss decreased (-0.756238 --> -0.834370).  Saving model ...
Epoch: 3 cost time: 0.8890225887298584
Epoch: 3, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 4 cost time: 0.9259414672851562
Epoch: 4, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.643 Vali Acc: 0.816 Test Loss: 0.643 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0357849597930908
Epoch: 5, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.706 Vali Acc: 0.831 Test Loss: 0.706 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8775088787078857
Epoch: 6, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.697 Vali Acc: 0.847 Test Loss: 0.697 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846868).  Saving model ...
Epoch: 7 cost time: 0.8989195823669434
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.896 Vali Acc: 0.822 Test Loss: 0.896 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9247574806213379
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.939 Vali Acc: 0.819 Test Loss: 0.939 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.012237310409546
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.826 Vali Acc: 0.850 Test Loss: 0.826 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 1.0245747566223145
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.817 Vali Acc: 0.844 Test Loss: 0.817 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9341785907745361
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.831 Test Loss: 0.959 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9559853076934814
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.911 Vali Acc: 0.838 Test Loss: 0.911 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8963301181793213
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.834 Test Loss: 0.913 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9169661998748779
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.841 Test Loss: 0.927 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9132232666015625
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.844 Test Loss: 0.927 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9489197731018066
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.841 Test Loss: 0.944 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.922783613204956
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.838 Test Loss: 0.955 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9184243679046631
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.841 Test Loss: 0.957 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9130373001098633
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.844 Test Loss: 0.953 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 883108
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8269596099853516
Epoch: 1, Steps: 8 | Train Loss: 1.852 Vali Loss: 1.211 Vali Acc: 0.734 Test Loss: 1.211 Test Acc: 0.734
Validation loss decreased (inf --> -0.734363).  Saving model ...
Epoch: 2 cost time: 0.9485793113708496
Epoch: 2, Steps: 8 | Train Loss: 0.777 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.734363 --> -0.840620).  Saving model ...
Epoch: 3 cost time: 0.9102270603179932
Epoch: 3, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 0.9616785049438477
Epoch: 4, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9256362915039062
Epoch: 5, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.675 Vali Acc: 0.838 Test Loss: 0.675 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9283926486968994
Epoch: 6, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.657 Vali Acc: 0.866 Test Loss: 0.657 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865618).  Saving model ...
Epoch: 7 cost time: 0.8955903053283691
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.791 Vali Acc: 0.841 Test Loss: 0.791 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9124751091003418
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.830 Vali Acc: 0.838 Test Loss: 0.830 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9247910976409912
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.768 Vali Acc: 0.869 Test Loss: 0.768 Test Acc: 0.869
Validation loss decreased (-0.865618 --> -0.868742).  Saving model ...
Epoch: 10 cost time: 1.0821261405944824
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.859 Test Loss: 0.769 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9437141418457031
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.847 Test Loss: 0.854 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9545125961303711
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.844 Test Loss: 0.870 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.933189868927002
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.868 Vali Acc: 0.847 Test Loss: 0.868 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9471390247344971
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.850 Test Loss: 0.851 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9303805828094482
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.859 Test Loss: 0.840 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9677746295928955
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.853 Test Loss: 0.848 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8960103988647461
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.853 Test Loss: 0.855 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9541027545928955
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.853 Test Loss: 0.857 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.031919240951538
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.853 Test Loss: 0.858 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 883108
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.868903875350952
Epoch: 1, Steps: 8 | Train Loss: 1.850 Vali Loss: 1.224 Vali Acc: 0.756 Test Loss: 1.224 Test Acc: 0.756
Validation loss decreased (inf --> -0.756238).  Saving model ...
Epoch: 2 cost time: 0.9303202629089355
Epoch: 2, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
Validation loss decreased (-0.756238 --> -0.834370).  Saving model ...
Epoch: 3 cost time: 1.0234651565551758
Epoch: 3, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 0.9060556888580322
Epoch: 4, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.601 Vali Acc: 0.834 Test Loss: 0.601 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9061124324798584
Epoch: 5, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.670 Vali Acc: 0.831 Test Loss: 0.670 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9114465713500977
Epoch: 6, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856244).  Saving model ...
Epoch: 7 cost time: 0.9575986862182617
Epoch: 7, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.690 Vali Acc: 0.844 Test Loss: 0.690 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8668684959411621
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.694 Vali Acc: 0.844 Test Loss: 0.694 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8518633842468262
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.705 Vali Acc: 0.872 Test Loss: 0.705 Test Acc: 0.872
Validation loss decreased (-0.856244 --> -0.871868).  Saving model ...
Epoch: 10 cost time: 0.8671286106109619
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.840 Vali Acc: 0.847 Test Loss: 0.840 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8928554058074951
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.795 Vali Acc: 0.869 Test Loss: 0.795 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9337503910064697
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.866 Test Loss: 0.816 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.771348237991333
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.869 Test Loss: 0.820 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9371628761291504
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.878 Test Loss: 0.788 Test Acc: 0.878
Validation loss decreased (-0.871868 --> -0.878117).  Saving model ...
Epoch: 15 cost time: 1.0094289779663086
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.881 Test Loss: 0.762 Test Acc: 0.881
Validation loss decreased (-0.878117 --> -0.881242).  Saving model ...
Epoch: 16 cost time: 0.9195525646209717
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.878 Test Loss: 0.765 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8978636264801025
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.878 Test Loss: 0.777 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9007284641265869
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.878 Test Loss: 0.789 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9131226539611816
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.878 Test Loss: 0.793 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9448587894439697
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.881 Test Loss: 0.793 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.950251579284668
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.884 Test Loss: 0.793 Test Acc: 0.884
Validation loss decreased (-0.881242 --> -0.884367).  Saving model ...
Epoch: 22 cost time: 0.8684327602386475
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.881 Test Loss: 0.796 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8981256484985352
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.881 Test Loss: 0.800 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9687168598175049
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.887 Test Loss: 0.801 Test Acc: 0.887
Validation loss decreased (-0.884367 --> -0.887492).  Saving model ...
Epoch: 25 cost time: 0.9174168109893799
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.887 Test Loss: 0.801 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9271719455718994
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.884 Test Loss: 0.800 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1238622665405273
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.884 Test Loss: 0.801 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9636919498443604
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.884 Test Loss: 0.802 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9786665439605713
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.887 Test Loss: 0.803 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0073943138122559
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.804 Vali Acc: 0.887 Test Loss: 0.804 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9925229549407959
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.887 Test Loss: 0.805 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9529080390930176
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.884 Test Loss: 0.808 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.119370698928833
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.881 Test Loss: 0.817 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.003082513809204
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.881 Test Loss: 0.818 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8875
model parameter : 883108
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.107266426086426
Epoch: 1, Steps: 8 | Train Loss: 1.840 Vali Loss: 1.310 Vali Acc: 0.750 Test Loss: 1.310 Test Acc: 0.750
Validation loss decreased (inf --> -0.749987).  Saving model ...
Epoch: 2 cost time: 0.8773598670959473
Epoch: 2, Steps: 8 | Train Loss: 0.914 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
Validation loss decreased (-0.749987 --> -0.799994).  Saving model ...
Epoch: 3 cost time: 0.913520097732544
Epoch: 3, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
Validation loss decreased (-0.799994 --> -0.809369).  Saving model ...
Epoch: 4 cost time: 0.9047162532806396
Epoch: 4, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.718 Vali Acc: 0.791 Test Loss: 0.718 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8532071113586426
Epoch: 5, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.802 Vali Acc: 0.806 Test Loss: 0.802 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8075947761535645
Epoch: 6, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.745 Vali Acc: 0.834 Test Loss: 0.745 Test Acc: 0.834
Validation loss decreased (-0.809369 --> -0.834368).  Saving model ...
Epoch: 7 cost time: 0.8559718132019043
Epoch: 7, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.872 Vali Acc: 0.825 Test Loss: 0.872 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9211776256561279
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.846 Vali Acc: 0.828 Test Loss: 0.846 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9646430015563965
Epoch: 9, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.823 Vali Acc: 0.838 Test Loss: 0.823 Test Acc: 0.838
Validation loss decreased (-0.834368 --> -0.837492).  Saving model ...
Epoch: 10 cost time: 0.8508791923522949
Epoch: 10, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.122 Vali Acc: 0.794 Test Loss: 1.122 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8588967323303223
Epoch: 11, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.025 Vali Acc: 0.822 Test Loss: 1.025 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8997581005096436
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.978 Vali Acc: 0.825 Test Loss: 0.978 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8353495597839355
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.033 Vali Acc: 0.822 Test Loss: 1.033 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8679299354553223
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.995 Vali Acc: 0.825 Test Loss: 0.995 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8677089214324951
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.007 Vali Acc: 0.828 Test Loss: 1.007 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8536860942840576
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.831 Test Loss: 1.087 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8329989910125732
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.950 Vali Acc: 0.841 Test Loss: 0.950 Test Acc: 0.841
Validation loss decreased (-0.837492 --> -0.840616).  Saving model ...
Epoch: 18 cost time: 0.8322691917419434
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.929 Vali Acc: 0.856 Test Loss: 0.929 Test Acc: 0.856
Validation loss decreased (-0.840616 --> -0.856241).  Saving model ...
Epoch: 19 cost time: 0.8140695095062256
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.009 Vali Acc: 0.834 Test Loss: 1.009 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8400542736053467
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.995 Vali Acc: 0.838 Test Loss: 0.995 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9214117527008057
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.831 Test Loss: 0.990 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.900275468826294
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.831 Test Loss: 1.003 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8315079212188721
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.828 Test Loss: 1.042 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8052911758422852
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.822 Test Loss: 1.074 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7921721935272217
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.825 Test Loss: 1.081 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8430285453796387
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.831 Test Loss: 1.079 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8587808609008789
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.834 Test Loss: 1.077 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8291289806365967
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.834 Test Loss: 1.073 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 883108
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.924988031387329
Epoch: 1, Steps: 8 | Train Loss: 1.863 Vali Loss: 1.162 Vali Acc: 0.728 Test Loss: 1.162 Test Acc: 0.728
Validation loss decreased (inf --> -0.728113).  Saving model ...
Epoch: 2 cost time: 0.9084129333496094
Epoch: 2, Steps: 8 | Train Loss: 0.728 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
Validation loss decreased (-0.728113 --> -0.824994).  Saving model ...
Epoch: 3 cost time: 1.019296407699585
Epoch: 3, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
Validation loss decreased (-0.824994 --> -0.853120).  Saving model ...
Epoch: 4 cost time: 0.9556450843811035
Epoch: 4, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.632 Vali Acc: 0.831 Test Loss: 0.632 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9309275150299072
Epoch: 5, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9502429962158203
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.680 Vali Acc: 0.853 Test Loss: 0.680 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9954805374145508
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.823 Vali Acc: 0.834 Test Loss: 0.823 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9805550575256348
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.857 Vali Acc: 0.834 Test Loss: 0.857 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.864769697189331
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.859 Vali Acc: 0.834 Test Loss: 0.859 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9133472442626953
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.841 Test Loss: 0.878 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.821038007736206
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.881 Vali Acc: 0.844 Test Loss: 0.881 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9890170097351074
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.844 Test Loss: 0.871 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0094890594482422
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.838 Test Loss: 0.878 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 620964
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.752354383468628
Epoch: 1, Steps: 8 | Train Loss: 1.871 Vali Loss: 1.175 Vali Acc: 0.744 Test Loss: 1.175 Test Acc: 0.744
Validation loss decreased (inf --> -0.743738).  Saving model ...
Epoch: 2 cost time: 0.9790387153625488
Epoch: 2, Steps: 8 | Train Loss: 0.738 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
Validation loss decreased (-0.743738 --> -0.812494).  Saving model ...
Epoch: 3 cost time: 0.8955755233764648
Epoch: 3, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
Validation loss decreased (-0.812494 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 0.9227283000946045
Epoch: 4, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.614 Vali Acc: 0.841 Test Loss: 0.614 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9969487190246582
Epoch: 5, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0361156463623047
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.644 Vali Acc: 0.866 Test Loss: 0.644 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865619).  Saving model ...
Epoch: 7 cost time: 0.917508602142334
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.785 Vali Acc: 0.841 Test Loss: 0.785 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8847112655639648
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.810 Vali Acc: 0.847 Test Loss: 0.810 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8772423267364502
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.802 Vali Acc: 0.859 Test Loss: 0.802 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7630589008331299
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.859 Test Loss: 0.804 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.824643611907959
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.866 Test Loss: 0.813 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9761323928833008
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.859 Test Loss: 0.821 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9434492588043213
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.856 Test Loss: 0.832 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8691506385803223
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.850 Test Loss: 0.836 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9132277965545654
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.850 Test Loss: 0.844 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9396059513092041
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.853 Test Loss: 0.848 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 620964
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.691671371459961
Epoch: 1, Steps: 8 | Train Loss: 1.906 Vali Loss: 1.214 Vali Acc: 0.728 Test Loss: 1.214 Test Acc: 0.728
Validation loss decreased (inf --> -0.728113).  Saving model ...
Epoch: 2 cost time: 0.884005069732666
Epoch: 2, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.549 Vali Acc: 0.812 Test Loss: 0.549 Test Acc: 0.812
Validation loss decreased (-0.728113 --> -0.812495).  Saving model ...
Epoch: 3 cost time: 0.9895956516265869
Epoch: 3, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
Validation loss decreased (-0.812495 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 0.9312081336975098
Epoch: 4, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9338085651397705
Epoch: 5, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.608 Vali Acc: 0.869 Test Loss: 0.608 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868744).  Saving model ...
Epoch: 6 cost time: 0.9839355945587158
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.638 Vali Acc: 0.859 Test Loss: 0.638 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9098539352416992
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.723 Vali Acc: 0.856 Test Loss: 0.723 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8702220916748047
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.757 Vali Acc: 0.850 Test Loss: 0.757 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9849450588226318
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.722 Vali Acc: 0.866 Test Loss: 0.722 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9312489032745361
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.869 Test Loss: 0.726 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.949573278427124
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.733 Vali Acc: 0.869 Test Loss: 0.733 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9298238754272461
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.869 Test Loss: 0.734 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8921675682067871
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.869 Test Loss: 0.739 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8702890872955322
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.868744 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.899155855178833
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.872 Test Loss: 0.738 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0854439735412598
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.869 Test Loss: 0.746 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9524140357971191
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.872 Test Loss: 0.752 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9785676002502441
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.872 Test Loss: 0.752 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9347789287567139
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.875 Test Loss: 0.757 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.979351282119751
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.872 Test Loss: 0.752 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9013562202453613
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.872 Test Loss: 0.759 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9938640594482422
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.872 Test Loss: 0.772 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.006730556488037
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.872 Test Loss: 0.777 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1104552745819092
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.872 Test Loss: 0.776 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 620964
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9027462005615234
Epoch: 1, Steps: 8 | Train Loss: 1.908 Vali Loss: 1.339 Vali Acc: 0.662 Test Loss: 1.339 Test Acc: 0.662
Validation loss decreased (inf --> -0.662487).  Saving model ...
Epoch: 2 cost time: 0.89833664894104
Epoch: 2, Steps: 8 | Train Loss: 0.884 Vali Loss: 0.677 Vali Acc: 0.775 Test Loss: 0.677 Test Acc: 0.775
Validation loss decreased (-0.662487 --> -0.774993).  Saving model ...
Epoch: 3 cost time: 0.8934938907623291
Epoch: 3, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
Validation loss decreased (-0.774993 --> -0.812494).  Saving model ...
Epoch: 4 cost time: 0.8423073291778564
Epoch: 4, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815618).  Saving model ...
Epoch: 5 cost time: 0.8954312801361084
Epoch: 5, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.748 Vali Acc: 0.828 Test Loss: 0.748 Test Acc: 0.828
Validation loss decreased (-0.815618 --> -0.828118).  Saving model ...
Epoch: 6 cost time: 0.8522284030914307
Epoch: 6, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.716 Vali Acc: 0.828 Test Loss: 0.716 Test Acc: 0.828
Validation loss decreased (-0.828118 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 0.9549598693847656
Epoch: 7, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.858 Vali Acc: 0.834 Test Loss: 0.858 Test Acc: 0.834
Validation loss decreased (-0.828118 --> -0.834366).  Saving model ...
Epoch: 8 cost time: 0.9065885543823242
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.988 Vali Acc: 0.822 Test Loss: 0.988 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.890204668045044
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.936 Vali Acc: 0.825 Test Loss: 0.936 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.850449800491333
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.123 Vali Acc: 0.809 Test Loss: 1.123 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9121675491333008
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.005 Vali Acc: 0.831 Test Loss: 1.005 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9479317665100098
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.927 Vali Acc: 0.841 Test Loss: 0.927 Test Acc: 0.841
Validation loss decreased (-0.834366 --> -0.840616).  Saving model ...
Epoch: 13 cost time: 0.9900143146514893
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.945 Vali Acc: 0.834 Test Loss: 0.945 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9242300987243652
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.825 Test Loss: 0.959 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8271608352661133
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.831 Test Loss: 0.985 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8975129127502441
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.828 Test Loss: 1.012 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8544027805328369
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.831 Test Loss: 1.027 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.912423849105835
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.019 Vali Acc: 0.831 Test Loss: 1.019 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9034483432769775
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.038 Vali Acc: 0.831 Test Loss: 1.038 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9290010929107666
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.834 Test Loss: 1.023 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9009137153625488
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.834 Test Loss: 1.001 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9358413219451904
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.831 Test Loss: 1.017 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 620964
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.836385726928711
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 1.396 Vali Acc: 0.581 Test Loss: 1.396 Test Acc: 0.581
Validation loss decreased (inf --> -0.581236).  Saving model ...
Epoch: 2 cost time: 1.032966136932373
Epoch: 2, Steps: 8 | Train Loss: 0.789 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
Validation loss decreased (-0.581236 --> -0.821869).  Saving model ...
Epoch: 3 cost time: 0.9982850551605225
Epoch: 3, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.821869 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 0.9192335605621338
Epoch: 4, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9794187545776367
Epoch: 5, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.678 Vali Acc: 0.831 Test Loss: 0.678 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9542679786682129
Epoch: 6, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.751 Vali Acc: 0.828 Test Loss: 0.751 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9892878532409668
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.722 Vali Acc: 0.850 Test Loss: 0.722 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0723364353179932
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.855 Vali Acc: 0.828 Test Loss: 0.855 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.890031099319458
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.899 Vali Acc: 0.834 Test Loss: 0.899 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9540627002716064
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.977 Vali Acc: 0.828 Test Loss: 0.977 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9890844821929932
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.012 Vali Acc: 0.822 Test Loss: 1.012 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9917922019958496
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.828 Test Loss: 1.002 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.03987717628479
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.834 Test Loss: 0.966 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 489892
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.818505048751831
Epoch: 1, Steps: 8 | Train Loss: 2.118 Vali Loss: 1.394 Vali Acc: 0.603 Test Loss: 1.394 Test Acc: 0.603
Validation loss decreased (inf --> -0.603111).  Saving model ...
Epoch: 2 cost time: 0.9367599487304688
Epoch: 2, Steps: 8 | Train Loss: 0.790 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
Validation loss decreased (-0.603111 --> -0.815619).  Saving model ...
Epoch: 3 cost time: 0.9368062019348145
Epoch: 3, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.815619 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 0.886404275894165
Epoch: 4, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0260772705078125
Epoch: 5, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.670 Vali Acc: 0.838 Test Loss: 0.670 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9380223751068115
Epoch: 6, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.742 Vali Acc: 0.831 Test Loss: 0.742 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8932600021362305
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.718 Vali Acc: 0.853 Test Loss: 0.718 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853118).  Saving model ...
Epoch: 8 cost time: 1.0633642673492432
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.782 Vali Acc: 0.838 Test Loss: 0.782 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8925042152404785
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.880 Vali Acc: 0.825 Test Loss: 0.880 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9479720592498779
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.834 Test Loss: 0.899 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9583590030670166
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.890 Vali Acc: 0.841 Test Loss: 0.890 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9302976131439209
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.898 Vali Acc: 0.838 Test Loss: 0.898 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8481974601745605
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.909 Vali Acc: 0.841 Test Loss: 0.909 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8968935012817383
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.911 Vali Acc: 0.844 Test Loss: 0.911 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9153633117675781
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.850 Test Loss: 0.928 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9104506969451904
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.850 Test Loss: 0.927 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9036581516265869
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.853 Test Loss: 0.910 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 489892
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1514828205108643
Epoch: 1, Steps: 8 | Train Loss: 2.068 Vali Loss: 1.395 Vali Acc: 0.625 Test Loss: 1.395 Test Acc: 0.625
Validation loss decreased (inf --> -0.624986).  Saving model ...
Epoch: 2 cost time: 1.0936033725738525
Epoch: 2, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
Validation loss decreased (-0.624986 --> -0.812494).  Saving model ...
Epoch: 3 cost time: 0.9574604034423828
Epoch: 3, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
Validation loss decreased (-0.812494 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 0.9720654487609863
Epoch: 4, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 5 cost time: 1.0610055923461914
Epoch: 5, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.623 Vali Acc: 0.859 Test Loss: 0.623 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859369).  Saving model ...
Epoch: 6 cost time: 0.986605167388916
Epoch: 6, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.702 Vali Acc: 0.844 Test Loss: 0.702 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0696802139282227
Epoch: 7, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.682 Vali Acc: 0.859 Test Loss: 0.682 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9816181659698486
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.711 Vali Acc: 0.853 Test Loss: 0.711 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.958125114440918
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.848 Vali Acc: 0.838 Test Loss: 0.848 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8631908893585205
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.821 Vali Acc: 0.847 Test Loss: 0.821 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9947891235351562
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.869 Test Loss: 0.797 Test Acc: 0.869
Validation loss decreased (-0.859369 --> -0.868742).  Saving model ...
Epoch: 12 cost time: 0.9674723148345947
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.807 Vali Acc: 0.866 Test Loss: 0.807 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9520845413208008
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.825 Vali Acc: 0.866 Test Loss: 0.825 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0871467590332031
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.863 Test Loss: 0.821 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0860817432403564
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.866 Test Loss: 0.808 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1397285461425781
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.866 Test Loss: 0.795 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9909050464630127
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.872 Test Loss: 0.786 Test Acc: 0.872
Validation loss decreased (-0.868742 --> -0.871867).  Saving model ...
Epoch: 18 cost time: 0.9862141609191895
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.872 Test Loss: 0.780 Test Acc: 0.872
Validation loss decreased (-0.871867 --> -0.871867).  Saving model ...
Epoch: 19 cost time: 0.9428021907806396
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.872 Test Loss: 0.778 Test Acc: 0.872
Validation loss decreased (-0.871867 --> -0.871867).  Saving model ...
Epoch: 20 cost time: 0.9261736869812012
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.872 Test Loss: 0.780 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.995154619216919
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.872 Test Loss: 0.786 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9791169166564941
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.875 Test Loss: 0.788 Test Acc: 0.875
Validation loss decreased (-0.871867 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 0.9429211616516113
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.875 Test Loss: 0.791 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8510782718658447
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.875 Test Loss: 0.795 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8847668170928955
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.872 Test Loss: 0.796 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9920639991760254
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.869 Test Loss: 0.798 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9680023193359375
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.866 Test Loss: 0.795 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0340797901153564
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.869 Test Loss: 0.795 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9526054859161377
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.872 Test Loss: 0.797 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9772517681121826
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.872 Test Loss: 0.798 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9328629970550537
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.869 Test Loss: 0.801 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8861582279205322
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.869 Test Loss: 0.798 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 489892
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6728737354278564
Epoch: 1, Steps: 8 | Train Loss: 2.073 Vali Loss: 1.486 Vali Acc: 0.625 Test Loss: 1.486 Test Acc: 0.625
Validation loss decreased (inf --> -0.624985).  Saving model ...
Epoch: 2 cost time: 0.8901264667510986
Epoch: 2, Steps: 8 | Train Loss: 0.907 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
Validation loss decreased (-0.624985 --> -0.803118).  Saving model ...
Epoch: 3 cost time: 0.7710988521575928
Epoch: 3, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
Validation loss decreased (-0.803118 --> -0.818744).  Saving model ...
Epoch: 4 cost time: 0.8097643852233887
Epoch: 4, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.651 Vali Acc: 0.812 Test Loss: 0.651 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.964167594909668
Epoch: 5, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.719 Vali Acc: 0.838 Test Loss: 0.719 Test Acc: 0.838
Validation loss decreased (-0.818744 --> -0.837493).  Saving model ...
Epoch: 6 cost time: 1.0299875736236572
Epoch: 6, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.752 Vali Acc: 0.809 Test Loss: 0.752 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8494670391082764
Epoch: 7, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.723 Vali Acc: 0.828 Test Loss: 0.723 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9399299621582031
Epoch: 8, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.941 Vali Acc: 0.828 Test Loss: 0.941 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8940095901489258
Epoch: 9, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.936 Vali Acc: 0.831 Test Loss: 0.936 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8743042945861816
Epoch: 10, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.920 Vali Acc: 0.825 Test Loss: 0.920 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8364038467407227
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.980 Vali Acc: 0.828 Test Loss: 0.980 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9298350811004639
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.032 Vali Acc: 0.828 Test Loss: 1.032 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8746800422668457
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.996 Vali Acc: 0.831 Test Loss: 0.996 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9134993553161621
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.982 Vali Acc: 0.834 Test Loss: 0.982 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8106293678283691
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.993 Vali Acc: 0.841 Test Loss: 0.993 Test Acc: 0.841
Validation loss decreased (-0.837493 --> -0.840615).  Saving model ...
Epoch: 16 cost time: 0.9584407806396484
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.144 Vali Acc: 0.822 Test Loss: 1.144 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9322500228881836
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.021 Vali Acc: 0.850 Test Loss: 1.021 Test Acc: 0.850
Validation loss decreased (-0.840615 --> -0.849990).  Saving model ...
Epoch: 18 cost time: 0.9573311805725098
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.023 Vali Acc: 0.841 Test Loss: 1.023 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9203548431396484
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.286 Vali Acc: 0.816 Test Loss: 1.286 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8827672004699707
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.112 Vali Acc: 0.834 Test Loss: 1.112 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8895993232727051
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.047 Vali Acc: 0.853 Test Loss: 1.047 Test Acc: 0.853
Validation loss decreased (-0.849990 --> -0.853115).  Saving model ...
Epoch: 22 cost time: 0.8891441822052002
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.139 Vali Acc: 0.838 Test Loss: 1.139 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8878355026245117
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.182 Vali Acc: 0.819 Test Loss: 1.182 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8431575298309326
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.199 Vali Acc: 0.838 Test Loss: 1.199 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8731522560119629
Epoch: 25, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.097 Vali Acc: 0.828 Test Loss: 1.097 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9237086772918701
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.825 Test Loss: 1.222 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8836135864257812
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.262 Vali Acc: 0.822 Test Loss: 1.262 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.830352783203125
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.825 Test Loss: 1.277 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8615210056304932
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.825 Test Loss: 1.277 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8485147953033447
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.825 Test Loss: 1.265 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8140740394592285
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.825 Test Loss: 1.265 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 489892
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.954315423965454
Epoch: 1, Steps: 8 | Train Loss: 1.865 Vali Loss: 1.202 Vali Acc: 0.747 Test Loss: 1.202 Test Acc: 0.747
Validation loss decreased (inf --> -0.746863).  Saving model ...
Epoch: 2 cost time: 0.8426010608673096
Epoch: 2, Steps: 8 | Train Loss: 0.773 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
Validation loss decreased (-0.746863 --> -0.824995).  Saving model ...
Epoch: 3 cost time: 0.8791599273681641
Epoch: 3, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 0.8174259662628174
Epoch: 4, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.604 Vali Acc: 0.838 Test Loss: 0.604 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8300113677978516
Epoch: 5, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.706 Vali Acc: 0.838 Test Loss: 0.706 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9668917655944824
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.755 Vali Acc: 0.831 Test Loss: 0.755 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9091427326202393
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.763 Vali Acc: 0.841 Test Loss: 0.763 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8532905578613281
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.839 Vali Acc: 0.834 Test Loss: 0.839 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8700721263885498
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.828 Test Loss: 0.900 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8684053421020508
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.868 Vali Acc: 0.841 Test Loss: 0.868 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9265809059143066
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.872 Vali Acc: 0.838 Test Loss: 0.872 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8696444034576416
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.844 Test Loss: 0.875 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9470281600952148
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.844 Test Loss: 0.864 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 424356
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.915801763534546
Epoch: 1, Steps: 8 | Train Loss: 1.862 Vali Loss: 1.218 Vali Acc: 0.747 Test Loss: 1.218 Test Acc: 0.747
Validation loss decreased (inf --> -0.746863).  Saving model ...
Epoch: 2 cost time: 0.9634714126586914
Epoch: 2, Steps: 8 | Train Loss: 0.786 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
Validation loss decreased (-0.746863 --> -0.828120).  Saving model ...
Epoch: 3 cost time: 0.9328374862670898
Epoch: 3, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 0.8865039348602295
Epoch: 4, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.603 Vali Acc: 0.831 Test Loss: 0.603 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8676126003265381
Epoch: 5, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.679 Vali Acc: 0.841 Test Loss: 0.679 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9986581802368164
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.716 Vali Acc: 0.838 Test Loss: 0.716 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9436097145080566
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.739 Vali Acc: 0.844 Test Loss: 0.739 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8771231174468994
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.828 Vali Acc: 0.831 Test Loss: 0.828 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9116697311401367
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.859 Vali Acc: 0.834 Test Loss: 0.859 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8912889957427979
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.847 Test Loss: 0.815 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.978595495223999
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.853 Test Loss: 0.824 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853117).  Saving model ...
Epoch: 12 cost time: 0.8905031681060791
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.853 Test Loss: 0.829 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9604148864746094
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.856 Test Loss: 0.814 Test Acc: 0.856
Validation loss decreased (-0.853117 --> -0.856242).  Saving model ...
Epoch: 14 cost time: 0.9667413234710693
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.856 Test Loss: 0.820 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9757428169250488
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.856 Test Loss: 0.825 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9099099636077881
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.839 Vali Acc: 0.859 Test Loss: 0.839 Test Acc: 0.859
Validation loss decreased (-0.856242 --> -0.859367).  Saving model ...
Epoch: 17 cost time: 0.8896105289459229
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.853 Test Loss: 0.857 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9110252857208252
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.850 Test Loss: 0.859 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9678857326507568
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.847 Test Loss: 0.850 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9972937107086182
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.847 Test Loss: 0.850 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9255907535552979
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.850 Test Loss: 0.853 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9464683532714844
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.850 Test Loss: 0.872 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9390270709991455
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.850 Test Loss: 0.886 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8900656700134277
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.850 Test Loss: 0.889 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7978639602661133
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.850 Test Loss: 0.887 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8977246284484863
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.853 Test Loss: 0.890 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 424356
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.673261880874634
Epoch: 1, Steps: 8 | Train Loss: 1.841 Vali Loss: 1.224 Vali Acc: 0.750 Test Loss: 1.224 Test Acc: 0.750
Validation loss decreased (inf --> -0.749988).  Saving model ...
Epoch: 2 cost time: 0.8272609710693359
Epoch: 2, Steps: 8 | Train Loss: 0.785 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
Validation loss decreased (-0.749988 --> -0.815620).  Saving model ...
Epoch: 3 cost time: 0.8599514961242676
Epoch: 3, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.815620 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 0.847754955291748
Epoch: 4, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9248530864715576
Epoch: 5, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8683993816375732
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.629 Vali Acc: 0.847 Test Loss: 0.629 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.928004264831543
Epoch: 7, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.686 Vali Acc: 0.859 Test Loss: 0.686 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859368).  Saving model ...
Epoch: 8 cost time: 1.0120759010314941
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.738 Vali Acc: 0.856 Test Loss: 0.738 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9331438541412354
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.838 Test Loss: 0.789 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9560456275939941
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.878 Test Loss: 0.735 Test Acc: 0.878
Validation loss decreased (-0.859368 --> -0.878118).  Saving model ...
Epoch: 11 cost time: 0.9058232307434082
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.866 Test Loss: 0.735 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9311459064483643
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.872 Test Loss: 0.718 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.932415246963501
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.884 Test Loss: 0.702 Test Acc: 0.884
Validation loss decreased (-0.878118 --> -0.884368).  Saving model ...
Epoch: 14 cost time: 0.8843567371368408
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.891 Test Loss: 0.723 Test Acc: 0.891
Validation loss decreased (-0.884368 --> -0.890618).  Saving model ...
Epoch: 15 cost time: 0.7881810665130615
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.875 Test Loss: 0.764 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9158499240875244
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.869 Test Loss: 0.776 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8734486103057861
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.875 Test Loss: 0.786 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.886176586151123
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.875 Test Loss: 0.778 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8509821891784668
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.878 Test Loss: 0.767 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9876284599304199
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.884 Test Loss: 0.765 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8717937469482422
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.881 Test Loss: 0.767 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.956430196762085
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.884 Test Loss: 0.779 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9150805473327637
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.878 Test Loss: 0.789 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8673300743103027
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.875 Test Loss: 0.791 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.890625
model parameter : 424356
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.743011713027954
Epoch: 1, Steps: 8 | Train Loss: 1.891 Vali Loss: 1.336 Vali Acc: 0.688 Test Loss: 1.336 Test Acc: 0.688
Validation loss decreased (inf --> -0.687487).  Saving model ...
Epoch: 2 cost time: 0.8522484302520752
Epoch: 2, Steps: 8 | Train Loss: 0.900 Vali Loss: 0.662 Vali Acc: 0.778 Test Loss: 0.662 Test Acc: 0.778
Validation loss decreased (-0.687487 --> -0.778118).  Saving model ...
Epoch: 3 cost time: 0.7486121654510498
Epoch: 3, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
Validation loss decreased (-0.778118 --> -0.815619).  Saving model ...
Epoch: 4 cost time: 0.8426268100738525
Epoch: 4, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.692 Vali Acc: 0.806 Test Loss: 0.692 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7296514511108398
Epoch: 5, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.712 Vali Acc: 0.831 Test Loss: 0.712 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831243).  Saving model ...
Epoch: 6 cost time: 0.7795529365539551
Epoch: 6, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.724 Vali Acc: 0.834 Test Loss: 0.724 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834368).  Saving model ...
Epoch: 7 cost time: 0.7751882076263428
Epoch: 7, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.828 Vali Acc: 0.828 Test Loss: 0.828 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7737250328063965
Epoch: 8, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.852 Vali Acc: 0.809 Test Loss: 0.852 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8139438629150391
Epoch: 9, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.928 Vali Acc: 0.825 Test Loss: 0.928 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8744800090789795
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.967 Vali Acc: 0.831 Test Loss: 0.967 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8031325340270996
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.936 Vali Acc: 0.806 Test Loss: 0.936 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8742830753326416
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.109 Vali Acc: 0.809 Test Loss: 1.109 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8452324867248535
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.092 Vali Acc: 0.822 Test Loss: 1.092 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8760654926300049
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.025 Vali Acc: 0.831 Test Loss: 1.025 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8829078674316406
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.831 Test Loss: 1.027 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.878680944442749
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.054 Vali Acc: 0.834 Test Loss: 1.054 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 424356
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.640019178390503
Epoch: 1, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.291 Vali Acc: 0.700 Test Loss: 1.291 Test Acc: 0.700
Validation loss decreased (inf --> -0.699987).  Saving model ...
Epoch: 2 cost time: 0.8606555461883545
Epoch: 2, Steps: 8 | Train Loss: 0.842 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.699987 --> -0.821869).  Saving model ...
Epoch: 3 cost time: 0.843747615814209
Epoch: 3, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.467 Vali Acc: 0.834 Test Loss: 0.467 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 4 cost time: 0.7930049896240234
Epoch: 4, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
Validation loss decreased (-0.834370 --> -0.859370).  Saving model ...
Epoch: 5 cost time: 0.7745165824890137
Epoch: 5, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.621 Vali Acc: 0.847 Test Loss: 0.621 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8537521362304688
Epoch: 6, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.933281421661377
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.685 Vali Acc: 0.847 Test Loss: 0.685 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.938629150390625
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8969972133636475
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.711 Vali Acc: 0.838 Test Loss: 0.711 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8574926853179932
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.838 Test Loss: 0.775 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9024879932403564
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.838 Test Loss: 0.787 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8376474380493164
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.841 Test Loss: 0.775 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.803938627243042
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.766 Vali Acc: 0.844 Test Loss: 0.766 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8500580787658691
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.844 Test Loss: 0.781 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 391588
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9704692363739014
Epoch: 1, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.290 Vali Acc: 0.716 Test Loss: 1.290 Test Acc: 0.716
Validation loss decreased (inf --> -0.715612).  Saving model ...
Epoch: 2 cost time: 0.7342538833618164
Epoch: 2, Steps: 8 | Train Loss: 0.838 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
Validation loss decreased (-0.715612 --> -0.809369).  Saving model ...
Epoch: 3 cost time: 0.872269868850708
Epoch: 3, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
Validation loss decreased (-0.809369 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 0.903282642364502
Epoch: 4, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 0.90834641456604
Epoch: 5, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8966279029846191
Epoch: 6, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.662 Vali Acc: 0.853 Test Loss: 0.662 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8650112152099609
Epoch: 7, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.631 Vali Acc: 0.869 Test Loss: 0.631 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868744).  Saving model ...
Epoch: 8 cost time: 0.9539844989776611
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.866 Test Loss: 0.634 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8766176700592041
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.671 Vali Acc: 0.863 Test Loss: 0.671 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8687248229980469
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.847 Test Loss: 0.744 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8077442646026611
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.847 Test Loss: 0.753 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9661486148834229
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.856 Test Loss: 0.740 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8585042953491211
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.859 Test Loss: 0.735 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9090757369995117
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.863 Test Loss: 0.760 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7686553001403809
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.859 Test Loss: 0.791 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9134976863861084
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.856 Test Loss: 0.802 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.906505823135376
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.804 Vali Acc: 0.856 Test Loss: 0.804 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 391588
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6485040187835693
Epoch: 1, Steps: 8 | Train Loss: 1.970 Vali Loss: 1.300 Vali Acc: 0.700 Test Loss: 1.300 Test Acc: 0.700
Validation loss decreased (inf --> -0.699987).  Saving model ...
Epoch: 2 cost time: 0.901341438293457
Epoch: 2, Steps: 8 | Train Loss: 0.840 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
Validation loss decreased (-0.699987 --> -0.821869).  Saving model ...
Epoch: 3 cost time: 0.707493782043457
Epoch: 3, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
Validation loss decreased (-0.821869 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 0.8815617561340332
Epoch: 4, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9067578315734863
Epoch: 5, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.555 Vali Acc: 0.866 Test Loss: 0.555 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865619).  Saving model ...
Epoch: 6 cost time: 0.8432812690734863
Epoch: 6, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.666 Vali Acc: 0.847 Test Loss: 0.666 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8847887516021729
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.635 Vali Acc: 0.859 Test Loss: 0.635 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9328536987304688
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.630 Vali Acc: 0.872 Test Loss: 0.630 Test Acc: 0.872
Validation loss decreased (-0.865619 --> -0.871869).  Saving model ...
Epoch: 9 cost time: 0.9283185005187988
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9061553478240967
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.850 Test Loss: 0.739 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9628942012786865
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.856 Test Loss: 0.760 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.858468770980835
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.872 Test Loss: 0.751 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0058135986328125
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.872 Test Loss: 0.747 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9149887561798096
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.869 Test Loss: 0.749 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8508317470550537
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.866 Test Loss: 0.756 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9352633953094482
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.866 Test Loss: 0.765 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9251754283905029
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.863 Test Loss: 0.766 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9159107208251953
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.859 Test Loss: 0.764 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 391588
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6218316555023193
Epoch: 1, Steps: 8 | Train Loss: 1.953 Vali Loss: 1.389 Vali Acc: 0.647 Test Loss: 1.389 Test Acc: 0.647
Validation loss decreased (inf --> -0.646861).  Saving model ...
Epoch: 2 cost time: 0.7173678874969482
Epoch: 2, Steps: 8 | Train Loss: 0.934 Vali Loss: 0.690 Vali Acc: 0.791 Test Loss: 0.690 Test Acc: 0.791
Validation loss decreased (-0.646861 --> -0.790618).  Saving model ...
Epoch: 3 cost time: 0.6860134601593018
Epoch: 3, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
Validation loss decreased (-0.790618 --> -0.812494).  Saving model ...
Epoch: 4 cost time: 0.767913818359375
Epoch: 4, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.662 Vali Acc: 0.816 Test Loss: 0.662 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815618).  Saving model ...
Epoch: 5 cost time: 0.7532045841217041
Epoch: 5, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.726 Vali Acc: 0.812 Test Loss: 0.726 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7289044857025146
Epoch: 6, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.793 Vali Acc: 0.816 Test Loss: 0.793 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7150485515594482
Epoch: 7, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.862 Vali Acc: 0.822 Test Loss: 0.862 Test Acc: 0.822
Validation loss decreased (-0.815618 --> -0.821866).  Saving model ...
Epoch: 8 cost time: 0.7422807216644287
Epoch: 8, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.914 Vali Acc: 0.809 Test Loss: 0.914 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8169560432434082
Epoch: 9, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.907 Vali Acc: 0.828 Test Loss: 0.907 Test Acc: 0.828
Validation loss decreased (-0.821866 --> -0.828116).  Saving model ...
Epoch: 10 cost time: 0.7429749965667725
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.005 Vali Acc: 0.819 Test Loss: 1.005 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8497931957244873
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.917 Vali Acc: 0.828 Test Loss: 0.917 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7313306331634521
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.932 Vali Acc: 0.825 Test Loss: 0.932 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7624764442443848
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.000 Vali Acc: 0.822 Test Loss: 1.000 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7415933609008789
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.972 Vali Acc: 0.834 Test Loss: 0.972 Test Acc: 0.834
Validation loss decreased (-0.828116 --> -0.834365).  Saving model ...
Epoch: 15 cost time: 0.6820178031921387
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.828 Test Loss: 0.947 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6805758476257324
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.838 Test Loss: 0.933 Test Acc: 0.838
Validation loss decreased (-0.834365 --> -0.837491).  Saving model ...
Epoch: 17 cost time: 0.7109038829803467
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.841 Test Loss: 0.932 Test Acc: 0.841
Validation loss decreased (-0.837491 --> -0.840616).  Saving model ...
Epoch: 18 cost time: 0.7849166393280029
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.946 Vali Acc: 0.834 Test Loss: 0.946 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7575831413269043
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.961 Vali Acc: 0.831 Test Loss: 0.961 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7588276863098145
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.963 Vali Acc: 0.831 Test Loss: 0.963 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7932937145233154
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.834 Test Loss: 0.970 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8053908348083496
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.978 Vali Acc: 0.838 Test Loss: 0.978 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7723891735076904
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.981 Vali Acc: 0.838 Test Loss: 0.981 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7929849624633789
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.834 Test Loss: 0.990 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8851325511932373
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.834 Test Loss: 0.997 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7701497077941895
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.834 Test Loss: 1.008 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7400047779083252
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.834 Test Loss: 1.010 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 391588
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7429158687591553
Epoch: 1, Steps: 8 | Train Loss: 1.993 Vali Loss: 1.244 Vali Acc: 0.713 Test Loss: 1.244 Test Acc: 0.713
Validation loss decreased (inf --> -0.712488).  Saving model ...
Epoch: 2 cost time: 0.9414710998535156
Epoch: 2, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.712488 --> -0.837495).  Saving model ...
Epoch: 3 cost time: 0.9328973293304443
Epoch: 3, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.499 Vali Acc: 0.866 Test Loss: 0.499 Test Acc: 0.866
Validation loss decreased (-0.837495 --> -0.865620).  Saving model ...
Epoch: 4 cost time: 0.7800977230072021
Epoch: 4, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.573 Vali Acc: 0.859 Test Loss: 0.573 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8429968357086182
Epoch: 5, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.679 Vali Acc: 0.838 Test Loss: 0.679 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8143291473388672
Epoch: 6, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8058013916015625
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.751 Vali Acc: 0.847 Test Loss: 0.751 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.827228307723999
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.805 Vali Acc: 0.831 Test Loss: 0.805 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.884824275970459
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.877 Vali Acc: 0.822 Test Loss: 0.877 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8357143402099609
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.887 Vali Acc: 0.844 Test Loss: 0.887 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8188705444335938
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.847 Test Loss: 0.837 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8409585952758789
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.817 Vali Acc: 0.859 Test Loss: 0.817 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8248529434204102
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.833 Vali Acc: 0.856 Test Loss: 0.833 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 375204
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7203307151794434
Epoch: 1, Steps: 8 | Train Loss: 1.970 Vali Loss: 1.248 Vali Acc: 0.722 Test Loss: 1.248 Test Acc: 0.722
Validation loss decreased (inf --> -0.721863).  Saving model ...
Epoch: 2 cost time: 0.857781171798706
Epoch: 2, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
Validation loss decreased (-0.721863 --> -0.837495).  Saving model ...
Epoch: 3 cost time: 0.8456618785858154
Epoch: 3, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
Validation loss decreased (-0.837495 --> -0.871870).  Saving model ...
Epoch: 4 cost time: 0.8654077053070068
Epoch: 4, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.571 Vali Acc: 0.847 Test Loss: 0.571 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8644213676452637
Epoch: 5, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.646 Vali Acc: 0.838 Test Loss: 0.646 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8588526248931885
Epoch: 6, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.665 Vali Acc: 0.863 Test Loss: 0.665 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7931649684906006
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.717 Vali Acc: 0.853 Test Loss: 0.717 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8588950634002686
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.834 Test Loss: 0.800 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.788947343826294
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.831 Vali Acc: 0.831 Test Loss: 0.831 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8289825916290283
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.831 Vali Acc: 0.847 Test Loss: 0.831 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8834249973297119
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.850 Test Loss: 0.816 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8128800392150879
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.847 Test Loss: 0.888 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8420736789703369
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.892 Vali Acc: 0.841 Test Loss: 0.892 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 375204
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.559173107147217
Epoch: 1, Steps: 8 | Train Loss: 1.925 Vali Loss: 1.269 Vali Acc: 0.719 Test Loss: 1.269 Test Acc: 0.719
Validation loss decreased (inf --> -0.718737).  Saving model ...
Epoch: 2 cost time: 0.8294835090637207
Epoch: 2, Steps: 8 | Train Loss: 0.707 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
Validation loss decreased (-0.718737 --> -0.831245).  Saving model ...
Epoch: 3 cost time: 0.832937479019165
Epoch: 3, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.482 Vali Acc: 0.866 Test Loss: 0.482 Test Acc: 0.866
Validation loss decreased (-0.831245 --> -0.865620).  Saving model ...
Epoch: 4 cost time: 0.8945789337158203
Epoch: 4, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8599467277526855
Epoch: 5, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7082643508911133
Epoch: 6, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.619 Vali Acc: 0.878 Test Loss: 0.619 Test Acc: 0.878
Validation loss decreased (-0.865620 --> -0.878119).  Saving model ...
Epoch: 7 cost time: 0.807037353515625
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.648 Vali Acc: 0.866 Test Loss: 0.648 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8614909648895264
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.745 Vali Acc: 0.841 Test Loss: 0.745 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.875964879989624
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.781 Vali Acc: 0.841 Test Loss: 0.781 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8056039810180664
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8331999778747559
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.869 Test Loss: 0.729 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7893044948577881
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.878 Test Loss: 0.717 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8524317741394043
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.872 Test Loss: 0.729 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8394753932952881
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.872 Test Loss: 0.739 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.810164213180542
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.745 Vali Acc: 0.872 Test Loss: 0.745 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8130621910095215
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.872 Test Loss: 0.749 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 375204
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7210898399353027
Epoch: 1, Steps: 8 | Train Loss: 1.970 Vali Loss: 1.378 Vali Acc: 0.681 Test Loss: 1.378 Test Acc: 0.681
Validation loss decreased (inf --> -0.681236).  Saving model ...
Epoch: 2 cost time: 0.778273344039917
Epoch: 2, Steps: 8 | Train Loss: 0.884 Vali Loss: 0.658 Vali Acc: 0.794 Test Loss: 0.658 Test Acc: 0.794
Validation loss decreased (-0.681236 --> -0.793743).  Saving model ...
Epoch: 3 cost time: 0.8746020793914795
Epoch: 3, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.566 Vali Acc: 0.831 Test Loss: 0.566 Test Acc: 0.831
Validation loss decreased (-0.793743 --> -0.831244).  Saving model ...
Epoch: 4 cost time: 0.8109946250915527
Epoch: 4, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.671 Vali Acc: 0.812 Test Loss: 0.671 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7942650318145752
Epoch: 5, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8492906093597412
Epoch: 6, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.811 Vali Acc: 0.838 Test Loss: 0.811 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837492).  Saving model ...
Epoch: 7 cost time: 0.7429487705230713
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.836 Vali Acc: 0.822 Test Loss: 0.836 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.726104736328125
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.840 Vali Acc: 0.822 Test Loss: 0.840 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.753760576248169
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.067 Vali Acc: 0.797 Test Loss: 1.067 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7008945941925049
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.081 Vali Acc: 0.797 Test Loss: 1.081 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7446062564849854
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.901 Vali Acc: 0.838 Test Loss: 0.901 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7851052284240723
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.999 Vali Acc: 0.816 Test Loss: 0.999 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7871296405792236
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.041 Vali Acc: 0.825 Test Loss: 1.041 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7772510051727295
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.973 Vali Acc: 0.834 Test Loss: 0.973 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8075151443481445
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.938 Vali Acc: 0.841 Test Loss: 0.938 Test Acc: 0.841
Validation loss decreased (-0.837492 --> -0.840616).  Saving model ...
Epoch: 16 cost time: 0.7512247562408447
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.968 Vali Acc: 0.847 Test Loss: 0.968 Test Acc: 0.847
Validation loss decreased (-0.840616 --> -0.846865).  Saving model ...
Epoch: 17 cost time: 0.7190902233123779
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.080 Vali Acc: 0.841 Test Loss: 1.080 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8010244369506836
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.073 Vali Acc: 0.838 Test Loss: 1.073 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7841651439666748
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.831 Test Loss: 1.063 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7891476154327393
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.145 Vali Acc: 0.828 Test Loss: 1.145 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7682924270629883
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.187 Vali Acc: 0.828 Test Loss: 1.187 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7263314723968506
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.194 Vali Acc: 0.825 Test Loss: 1.194 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7345180511474609
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.170 Vali Acc: 0.831 Test Loss: 1.170 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7214975357055664
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.148 Vali Acc: 0.828 Test Loss: 1.148 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7524733543395996
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.138 Vali Acc: 0.834 Test Loss: 1.138 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8444085121154785
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.838 Test Loss: 1.136 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 375204
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.581368923187256
Epoch: 1, Steps: 8 | Train Loss: 2.129 Vali Loss: 1.650 Vali Acc: 0.491 Test Loss: 1.650 Test Acc: 0.491
Validation loss decreased (inf --> -0.490608).  Saving model ...
Epoch: 2 cost time: 0.9112722873687744
Epoch: 2, Steps: 8 | Train Loss: 1.215 Vali Loss: 0.820 Vali Acc: 0.787 Test Loss: 0.820 Test Acc: 0.787
Validation loss decreased (-0.490608 --> -0.787492).  Saving model ...
Epoch: 3 cost time: 0.811570405960083
Epoch: 3, Steps: 8 | Train Loss: 0.584 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
Validation loss decreased (-0.787492 --> -0.821870).  Saving model ...
Epoch: 4 cost time: 0.7575826644897461
Epoch: 4, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
Validation loss decreased (-0.821870 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 0.6861090660095215
Epoch: 5, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.739769458770752
Epoch: 6, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7280926704406738
Epoch: 7, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7412807941436768
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.628 Vali Acc: 0.819 Test Loss: 0.628 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8575983047485352
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856244).  Saving model ...
Epoch: 10 cost time: 0.8248450756072998
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.646 Vali Acc: 0.834 Test Loss: 0.646 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8583314418792725
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.689 Vali Acc: 0.831 Test Loss: 0.689 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8572063446044922
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.831 Test Loss: 0.698 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8626196384429932
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.697 Vali Acc: 0.825 Test Loss: 0.697 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7035975456237793
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8072726726531982
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7778348922729492
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.822 Test Loss: 0.729 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7711331844329834
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.828 Test Loss: 0.732 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8059566020965576
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.740 Vali Acc: 0.819 Test Loss: 0.740 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8304061889648438
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.822 Test Loss: 0.736 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 433380
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6291050910949707
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 1.646 Vali Acc: 0.519 Test Loss: 1.646 Test Acc: 0.519
Validation loss decreased (inf --> -0.518734).  Saving model ...
Epoch: 2 cost time: 0.8081846237182617
Epoch: 2, Steps: 8 | Train Loss: 1.220 Vali Loss: 0.823 Vali Acc: 0.784 Test Loss: 0.823 Test Acc: 0.784
Validation loss decreased (-0.518734 --> -0.784367).  Saving model ...
Epoch: 3 cost time: 0.8100461959838867
Epoch: 3, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
Validation loss decreased (-0.784367 --> -0.809370).  Saving model ...
Epoch: 4 cost time: 0.8336272239685059
Epoch: 4, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.809370 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 0.8323357105255127
Epoch: 5, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 0.8092782497406006
Epoch: 6, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8102586269378662
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.580 Vali Acc: 0.831 Test Loss: 0.580 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8140063285827637
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.596 Vali Acc: 0.838 Test Loss: 0.596 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.750063419342041
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.613 Vali Acc: 0.847 Test Loss: 0.613 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8402891159057617
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8026971817016602
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.661 Vali Acc: 0.834 Test Loss: 0.661 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7694451808929443
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7903592586517334
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.678 Vali Acc: 0.828 Test Loss: 0.678 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7666757106781006
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.825 Test Loss: 0.681 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7964146137237549
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.828 Test Loss: 0.699 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 433380
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.562328577041626
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 1.642 Vali Acc: 0.544 Test Loss: 1.642 Test Acc: 0.544
Validation loss decreased (inf --> -0.543734).  Saving model ...
Epoch: 2 cost time: 0.8037300109863281
Epoch: 2, Steps: 8 | Train Loss: 1.242 Vali Loss: 0.832 Vali Acc: 0.787 Test Loss: 0.832 Test Acc: 0.787
Validation loss decreased (-0.543734 --> -0.787492).  Saving model ...
Epoch: 3 cost time: 0.7638201713562012
Epoch: 3, Steps: 8 | Train Loss: 0.614 Vali Loss: 0.534 Vali Acc: 0.825 Test Loss: 0.534 Test Acc: 0.825
Validation loss decreased (-0.787492 --> -0.824995).  Saving model ...
Epoch: 4 cost time: 0.7604668140411377
Epoch: 4, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 0.7795252799987793
Epoch: 5, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
Validation loss decreased (-0.837495 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 0.844977617263794
Epoch: 6, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8985438346862793
Epoch: 7, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8473541736602783
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.551 Vali Acc: 0.859 Test Loss: 0.551 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 9 cost time: 0.7884891033172607
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8217389583587646
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8161425590515137
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8282549381256104
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8538849353790283
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.847 Test Loss: 0.615 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7714340686798096
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7428791522979736
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8309779167175293
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.749138355255127
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.702362060546875
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 433380
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.634355068206787
Epoch: 1, Steps: 8 | Train Loss: 2.129 Vali Loss: 1.732 Vali Acc: 0.472 Test Loss: 1.732 Test Acc: 0.472
Validation loss decreased (inf --> -0.471858).  Saving model ...
Epoch: 2 cost time: 0.7847778797149658
Epoch: 2, Steps: 8 | Train Loss: 1.374 Vali Loss: 0.958 Vali Acc: 0.775 Test Loss: 0.958 Test Acc: 0.775
Validation loss decreased (-0.471858 --> -0.774990).  Saving model ...
Epoch: 3 cost time: 0.7843270301818848
Epoch: 3, Steps: 8 | Train Loss: 0.718 Vali Loss: 0.614 Vali Acc: 0.809 Test Loss: 0.614 Test Acc: 0.809
Validation loss decreased (-0.774990 --> -0.809369).  Saving model ...
Epoch: 4 cost time: 0.8441669940948486
Epoch: 4, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 5 cost time: 0.8467457294464111
Epoch: 5, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
Validation loss decreased (-0.809369 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 0.8188934326171875
Epoch: 6, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.8004183769226074
Epoch: 7, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.645 Vali Acc: 0.825 Test Loss: 0.645 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7167670726776123
Epoch: 8, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.602 Vali Acc: 0.838 Test Loss: 0.602 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7597453594207764
Epoch: 9, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.632 Vali Acc: 0.841 Test Loss: 0.632 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 0.8162679672241211
Epoch: 10, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.620 Vali Acc: 0.838 Test Loss: 0.620 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9130628108978271
Epoch: 11, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.691 Vali Acc: 0.844 Test Loss: 0.691 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843743).  Saving model ...
Epoch: 12 cost time: 0.7789201736450195
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.671 Vali Acc: 0.847 Test Loss: 0.671 Test Acc: 0.847
Validation loss decreased (-0.843743 --> -0.846868).  Saving model ...
Epoch: 13 cost time: 0.7939112186431885
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.673 Vali Acc: 0.847 Test Loss: 0.673 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9439811706542969
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.685 Vali Acc: 0.844 Test Loss: 0.685 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8335995674133301
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7614932060241699
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8611161708831787
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.736 Vali Acc: 0.841 Test Loss: 0.736 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8953495025634766
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.723 Vali Acc: 0.844 Test Loss: 0.723 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8817367553710938
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.847 Test Loss: 0.702 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9544498920440674
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.731 Vali Acc: 0.844 Test Loss: 0.731 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8463292121887207
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.772 Vali Acc: 0.844 Test Loss: 0.772 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.776503324508667
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 0.8137168884277344
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.853 Test Loss: 0.746 Test Acc: 0.853
Validation loss decreased (-0.849992 --> -0.853118).  Saving model ...
Epoch: 24 cost time: 0.8074450492858887
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.760 Vali Acc: 0.847 Test Loss: 0.760 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8717074394226074
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8481130599975586
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8134851455688477
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.779 Vali Acc: 0.850 Test Loss: 0.779 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8891012668609619
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.850 Test Loss: 0.781 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7996511459350586
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.850 Test Loss: 0.790 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9003980159759521
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.793 Vali Acc: 0.850 Test Loss: 0.793 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8769593238830566
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.850 Test Loss: 0.811 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9862668514251709
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.814 Vali Acc: 0.853 Test Loss: 0.814 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8884718418121338
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.817 Vali Acc: 0.853 Test Loss: 0.817 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 433380
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7672717571258545
Epoch: 1, Steps: 8 | Train Loss: 1.985 Vali Loss: 1.554 Vali Acc: 0.559 Test Loss: 1.554 Test Acc: 0.559
Validation loss decreased (inf --> -0.559359).  Saving model ...
Epoch: 2 cost time: 0.7993576526641846
Epoch: 2, Steps: 8 | Train Loss: 1.169 Vali Loss: 0.788 Vali Acc: 0.794 Test Loss: 0.788 Test Acc: 0.794
Validation loss decreased (-0.559359 --> -0.793742).  Saving model ...
Epoch: 3 cost time: 0.7245197296142578
Epoch: 3, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.585 Vali Acc: 0.800 Test Loss: 0.585 Test Acc: 0.800
Validation loss decreased (-0.793742 --> -0.799994).  Saving model ...
Epoch: 4 cost time: 0.7990627288818359
Epoch: 4, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.828120).  Saving model ...
Epoch: 5 cost time: 0.8392131328582764
Epoch: 5, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 0.8980197906494141
Epoch: 6, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.566 Vali Acc: 0.834 Test Loss: 0.566 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.827063798904419
Epoch: 7, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8397932052612305
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.682 Vali Acc: 0.831 Test Loss: 0.682 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8206748962402344
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.665 Vali Acc: 0.841 Test Loss: 0.665 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840618).  Saving model ...
Epoch: 10 cost time: 0.867440938949585
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.671 Vali Acc: 0.831 Test Loss: 0.671 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8775107860565186
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.719 Vali Acc: 0.831 Test Loss: 0.719 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7647089958190918
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.758 Vali Acc: 0.831 Test Loss: 0.758 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.823462724685669
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.825 Test Loss: 0.756 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8868355751037598
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.740 Vali Acc: 0.831 Test Loss: 0.740 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9195072650909424
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.834 Test Loss: 0.736 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8339829444885254
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.828 Test Loss: 0.741 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7997152805328369
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.757 Vali Acc: 0.828 Test Loss: 0.757 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9127094745635986
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.831 Test Loss: 0.776 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9031507968902588
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.828 Test Loss: 0.777 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 302308
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7748162746429443
Epoch: 1, Steps: 8 | Train Loss: 1.993 Vali Loss: 1.564 Vali Acc: 0.584 Test Loss: 1.564 Test Acc: 0.584
Validation loss decreased (inf --> -0.584359).  Saving model ...
Epoch: 2 cost time: 0.8205528259277344
Epoch: 2, Steps: 8 | Train Loss: 1.178 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
Validation loss decreased (-0.584359 --> -0.803117).  Saving model ...
Epoch: 3 cost time: 0.8630831241607666
Epoch: 3, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8886978626251221
Epoch: 4, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
Validation loss decreased (-0.803117 --> -0.824995).  Saving model ...
Epoch: 5 cost time: 0.8893811702728271
Epoch: 5, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 0.8369858264923096
Epoch: 6, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840619).  Saving model ...
Epoch: 7 cost time: 0.8091747760772705
Epoch: 7, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.607 Vali Acc: 0.831 Test Loss: 0.607 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7495791912078857
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.662 Vali Acc: 0.828 Test Loss: 0.662 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8369405269622803
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.663 Vali Acc: 0.834 Test Loss: 0.663 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8706274032592773
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.636 Vali Acc: 0.847 Test Loss: 0.636 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846869).  Saving model ...
Epoch: 11 cost time: 0.8675799369812012
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.680 Vali Acc: 0.831 Test Loss: 0.680 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7029139995574951
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.722 Vali Acc: 0.828 Test Loss: 0.722 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7234594821929932
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.834 Test Loss: 0.718 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.766822099685669
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.834 Test Loss: 0.708 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7972900867462158
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.709 Vali Acc: 0.838 Test Loss: 0.709 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7600517272949219
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.834 Test Loss: 0.714 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.691633939743042
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.831 Test Loss: 0.723 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7711613178253174
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.838 Test Loss: 0.736 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8424382209777832
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.841 Test Loss: 0.739 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7758128643035889
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.834 Test Loss: 0.738 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 302308
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5729944705963135
Epoch: 1, Steps: 8 | Train Loss: 1.969 Vali Loss: 1.572 Vali Acc: 0.600 Test Loss: 1.572 Test Acc: 0.600
Validation loss decreased (inf --> -0.599984).  Saving model ...
Epoch: 2 cost time: 0.7677998542785645
Epoch: 2, Steps: 8 | Train Loss: 1.165 Vali Loss: 0.802 Vali Acc: 0.797 Test Loss: 0.802 Test Acc: 0.797
Validation loss decreased (-0.599984 --> -0.796867).  Saving model ...
Epoch: 3 cost time: 0.7876181602478027
Epoch: 3, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
Validation loss decreased (-0.796867 --> -0.803119).  Saving model ...
Epoch: 4 cost time: 0.7776260375976562
Epoch: 4, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
Validation loss decreased (-0.803119 --> -0.831245).  Saving model ...
Epoch: 5 cost time: 0.7361667156219482
Epoch: 5, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.8247995376586914
Epoch: 6, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.7514936923980713
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7563300132751465
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.595 Vali Acc: 0.847 Test Loss: 0.595 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7360434532165527
Epoch: 9, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.609 Vali Acc: 0.838 Test Loss: 0.609 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7146306037902832
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.859 Test Loss: 0.592 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859369).  Saving model ...
Epoch: 11 cost time: 0.7384169101715088
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.606 Vali Acc: 0.847 Test Loss: 0.606 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7968137264251709
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.633 Vali Acc: 0.838 Test Loss: 0.633 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8185184001922607
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.847 Test Loss: 0.634 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7038593292236328
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.847 Test Loss: 0.626 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.815485954284668
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.847 Test Loss: 0.633 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8247079849243164
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.847 Test Loss: 0.636 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7620041370391846
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7748610973358154
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.856 Test Loss: 0.665 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.760094404220581
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.816495418548584
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.853 Test Loss: 0.656 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 302308
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.776211977005005
Epoch: 1, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.677 Vali Acc: 0.569 Test Loss: 1.677 Test Acc: 0.569
Validation loss decreased (inf --> -0.568733).  Saving model ...
Epoch: 2 cost time: 0.8480322360992432
Epoch: 2, Steps: 8 | Train Loss: 1.323 Vali Loss: 0.937 Vali Acc: 0.784 Test Loss: 0.937 Test Acc: 0.784
Validation loss decreased (-0.568733 --> -0.784366).  Saving model ...
Epoch: 3 cost time: 0.7391619682312012
Epoch: 3, Steps: 8 | Train Loss: 0.697 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
Validation loss decreased (-0.784366 --> -0.809368).  Saving model ...
Epoch: 4 cost time: 0.7196433544158936
Epoch: 4, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
Validation loss decreased (-0.809368 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 0.7587411403656006
Epoch: 5, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.577 Vali Acc: 0.831 Test Loss: 0.577 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 0.7605626583099365
Epoch: 6, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.598 Vali Acc: 0.828 Test Loss: 0.598 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8882756233215332
Epoch: 7, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.638 Vali Acc: 0.825 Test Loss: 0.638 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7963621616363525
Epoch: 8, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.896216869354248
Epoch: 9, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.856684684753418
Epoch: 10, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.696 Vali Acc: 0.831 Test Loss: 0.696 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7509815692901611
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.668 Vali Acc: 0.841 Test Loss: 0.668 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840618).  Saving model ...
Epoch: 12 cost time: 0.7546722888946533
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843743).  Saving model ...
Epoch: 13 cost time: 0.7438769340515137
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.687 Vali Acc: 0.847 Test Loss: 0.687 Test Acc: 0.847
Validation loss decreased (-0.843743 --> -0.846868).  Saving model ...
Epoch: 14 cost time: 0.690854549407959
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7906408309936523
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.728 Vali Acc: 0.841 Test Loss: 0.728 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.827134370803833
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.719 Vali Acc: 0.844 Test Loss: 0.719 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8148584365844727
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.758 Vali Acc: 0.841 Test Loss: 0.758 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8279330730438232
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.825 Vali Acc: 0.834 Test Loss: 0.825 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8022243976593018
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.813 Vali Acc: 0.831 Test Loss: 0.813 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8798172473907471
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.770 Vali Acc: 0.841 Test Loss: 0.770 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7914338111877441
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.774 Vali Acc: 0.844 Test Loss: 0.774 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7929437160491943
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.796 Vali Acc: 0.844 Test Loss: 0.796 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8992364406585693
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.844 Test Loss: 0.814 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 302308
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.814375877380371
Epoch: 1, Steps: 8 | Train Loss: 2.146 Vali Loss: 1.653 Vali Acc: 0.509 Test Loss: 1.653 Test Acc: 0.509
Validation loss decreased (inf --> -0.509358).  Saving model ...
Epoch: 2 cost time: 0.815056324005127
Epoch: 2, Steps: 8 | Train Loss: 1.190 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
Validation loss decreased (-0.509358 --> -0.803117).  Saving model ...
Epoch: 3 cost time: 0.8139591217041016
Epoch: 3, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.803117 --> -0.843745).  Saving model ...
Epoch: 4 cost time: 0.7468667030334473
Epoch: 4, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.510 Vali Acc: 0.828 Test Loss: 0.510 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7781765460968018
Epoch: 5, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8158926963806152
Epoch: 6, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.555 Vali Acc: 0.859 Test Loss: 0.555 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859369).  Saving model ...
Epoch: 7 cost time: 0.8527305126190186
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.610 Vali Acc: 0.847 Test Loss: 0.610 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7739303112030029
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.690 Vali Acc: 0.828 Test Loss: 0.690 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.788973331451416
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.668 Vali Acc: 0.838 Test Loss: 0.668 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8541767597198486
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.614 Vali Acc: 0.841 Test Loss: 0.614 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7885787487030029
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.659 Vali Acc: 0.834 Test Loss: 0.659 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9113337993621826
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.834 Test Loss: 0.693 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8572673797607422
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.831 Test Loss: 0.721 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7796683311462402
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.838 Test Loss: 0.720 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8208529949188232
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.841 Test Loss: 0.713 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8720943927764893
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.720 Vali Acc: 0.844 Test Loss: 0.720 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 236772
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.583596706390381
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 1.671 Vali Acc: 0.494 Test Loss: 1.671 Test Acc: 0.494
Validation loss decreased (inf --> -0.493733).  Saving model ...
Epoch: 2 cost time: 0.8145284652709961
Epoch: 2, Steps: 8 | Train Loss: 1.211 Vali Loss: 0.800 Vali Acc: 0.791 Test Loss: 0.800 Test Acc: 0.791
Validation loss decreased (-0.493733 --> -0.790617).  Saving model ...
Epoch: 3 cost time: 0.8263731002807617
Epoch: 3, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
Validation loss decreased (-0.790617 --> -0.843745).  Saving model ...
Epoch: 4 cost time: 0.8076567649841309
Epoch: 4, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7856824398040771
Epoch: 5, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8315789699554443
Epoch: 6, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 0.8099324703216553
Epoch: 7, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7258498668670654
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.661 Vali Acc: 0.831 Test Loss: 0.661 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8367247581481934
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.643 Vali Acc: 0.831 Test Loss: 0.643 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7784276008605957
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.588 Vali Acc: 0.853 Test Loss: 0.588 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.771104097366333
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.628 Vali Acc: 0.847 Test Loss: 0.628 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8231844902038574
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.841 Test Loss: 0.655 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7773003578186035
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.684 Vali Acc: 0.838 Test Loss: 0.684 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8254683017730713
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.831 Test Loss: 0.702 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8272793292999268
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.692 Vali Acc: 0.834 Test Loss: 0.692 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7866311073303223
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.689 Vali Acc: 0.841 Test Loss: 0.689 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 236772
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6093316078186035
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 1.706 Vali Acc: 0.487 Test Loss: 1.706 Test Acc: 0.487
Validation loss decreased (inf --> -0.487483).  Saving model ...
Epoch: 2 cost time: 0.770470142364502
Epoch: 2, Steps: 8 | Train Loss: 1.229 Vali Loss: 0.837 Vali Acc: 0.812 Test Loss: 0.837 Test Acc: 0.812
Validation loss decreased (-0.487483 --> -0.812492).  Saving model ...
Epoch: 3 cost time: 0.6898717880249023
Epoch: 3, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
Validation loss decreased (-0.812492 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 0.6295514106750488
Epoch: 4, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7627217769622803
Epoch: 5, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7724623680114746
Epoch: 6, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.522 Vali Acc: 0.863 Test Loss: 0.522 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 0.759610652923584
Epoch: 7, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7852818965911865
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8673825263977051
Epoch: 9, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7307379245758057
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7659039497375488
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.853 Test Loss: 0.580 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7280640602111816
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7407963275909424
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6686081886291504
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.658 Vali Acc: 0.831 Test Loss: 0.658 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7402827739715576
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8367791175842285
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.647 Vali Acc: 0.853 Test Loss: 0.647 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 236772
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4853079319000244
Epoch: 1, Steps: 8 | Train Loss: 2.083 Vali Loss: 1.731 Vali Acc: 0.459 Test Loss: 1.731 Test Acc: 0.459
Validation loss decreased (inf --> -0.459358).  Saving model ...
Epoch: 2 cost time: 0.8737256526947021
Epoch: 2, Steps: 8 | Train Loss: 1.296 Vali Loss: 0.949 Vali Acc: 0.781 Test Loss: 0.949 Test Acc: 0.781
Validation loss decreased (-0.459358 --> -0.781241).  Saving model ...
Epoch: 3 cost time: 0.7838335037231445
Epoch: 3, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.619 Vali Acc: 0.806 Test Loss: 0.619 Test Acc: 0.806
Validation loss decreased (-0.781241 --> -0.806244).  Saving model ...
Epoch: 4 cost time: 0.7588725090026855
Epoch: 4, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7751760482788086
Epoch: 5, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.633 Vali Acc: 0.806 Test Loss: 0.633 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7353789806365967
Epoch: 6, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 7 cost time: 0.7620635032653809
Epoch: 7, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.578 Vali Acc: 0.838 Test Loss: 0.578 Test Acc: 0.838
Validation loss decreased (-0.809369 --> -0.837494).  Saving model ...
Epoch: 8 cost time: 0.8495311737060547
Epoch: 8, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.683 Vali Acc: 0.828 Test Loss: 0.683 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7941100597381592
Epoch: 9, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7311241626739502
Epoch: 10, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 0.7240686416625977
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.698 Vali Acc: 0.831 Test Loss: 0.698 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7968637943267822
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.695 Vali Acc: 0.844 Test Loss: 0.695 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843743).  Saving model ...
Epoch: 13 cost time: 0.7827990055084229
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.702 Vali Acc: 0.831 Test Loss: 0.702 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7494745254516602
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.753 Vali Acc: 0.822 Test Loss: 0.753 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8170433044433594
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.752 Vali Acc: 0.841 Test Loss: 0.752 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7744698524475098
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.753 Vali Acc: 0.844 Test Loss: 0.753 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7432663440704346
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
Validation loss decreased (-0.843743 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 0.72076416015625
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.737 Vali Acc: 0.850 Test Loss: 0.737 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7870573997497559
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.759 Vali Acc: 0.847 Test Loss: 0.759 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7688493728637695
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.785 Vali Acc: 0.844 Test Loss: 0.785 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7840433120727539
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.778 Vali Acc: 0.844 Test Loss: 0.778 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8179047107696533
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.775 Vali Acc: 0.844 Test Loss: 0.775 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7942633628845215
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.841 Test Loss: 0.806 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8208320140838623
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.819 Vali Acc: 0.841 Test Loss: 0.819 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8341586589813232
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.818 Vali Acc: 0.841 Test Loss: 0.818 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7479293346405029
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.820 Vali Acc: 0.844 Test Loss: 0.820 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8121204376220703
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.844 Test Loss: 0.816 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 236772
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.949706554412842
Epoch: 1, Steps: 8 | Train Loss: 1.920 Vali Loss: 1.521 Vali Acc: 0.562 Test Loss: 1.521 Test Acc: 0.562
Validation loss decreased (inf --> -0.562485).  Saving model ...
Epoch: 2 cost time: 0.8354184627532959
Epoch: 2, Steps: 8 | Train Loss: 1.123 Vali Loss: 0.753 Vali Acc: 0.816 Test Loss: 0.753 Test Acc: 0.816
Validation loss decreased (-0.562485 --> -0.815617).  Saving model ...
Epoch: 3 cost time: 0.828502893447876
Epoch: 3, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
Validation loss decreased (-0.815617 --> -0.837495).  Saving model ...
Epoch: 4 cost time: 0.886293888092041
Epoch: 4, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 0.8110413551330566
Epoch: 5, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 0.875361442565918
Epoch: 6, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8298854827880859
Epoch: 7, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8825993537902832
Epoch: 8, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.625 Vali Acc: 0.834 Test Loss: 0.625 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8515350818634033
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.662 Vali Acc: 0.831 Test Loss: 0.662 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9340510368347168
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.684 Vali Acc: 0.838 Test Loss: 0.684 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8692090511322021
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.699 Vali Acc: 0.834 Test Loss: 0.699 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9145731925964355
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.703 Vali Acc: 0.819 Test Loss: 0.703 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7564704418182373
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.719 Vali Acc: 0.825 Test Loss: 0.719 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8191053867340088
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.834 Test Loss: 0.724 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.851797342300415
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.732 Vali Acc: 0.834 Test Loss: 0.732 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 204004
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.582885265350342
Epoch: 1, Steps: 8 | Train Loss: 1.938 Vali Loss: 1.534 Vali Acc: 0.537 Test Loss: 1.534 Test Acc: 0.537
Validation loss decreased (inf --> -0.537485).  Saving model ...
Epoch: 2 cost time: 0.8010330200195312
Epoch: 2, Steps: 8 | Train Loss: 1.136 Vali Loss: 0.761 Vali Acc: 0.809 Test Loss: 0.761 Test Acc: 0.809
Validation loss decreased (-0.537485 --> -0.809367).  Saving model ...
Epoch: 3 cost time: 0.7388288974761963
Epoch: 3, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.809367 --> -0.843745).  Saving model ...
Epoch: 4 cost time: 0.8822784423828125
Epoch: 4, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.832144021987915
Epoch: 5, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 0.8362951278686523
Epoch: 6, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8861963748931885
Epoch: 7, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.599 Vali Acc: 0.825 Test Loss: 0.599 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8795671463012695
Epoch: 8, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7781853675842285
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8414101600646973
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.659 Vali Acc: 0.841 Test Loss: 0.659 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7630999088287354
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.669 Vali Acc: 0.834 Test Loss: 0.669 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7670109272003174
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.834 Test Loss: 0.668 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8361389636993408
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.676 Vali Acc: 0.834 Test Loss: 0.676 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8830695152282715
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.838 Test Loss: 0.688 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8302452564239502
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.838 Test Loss: 0.703 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 204004
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5606160163879395
Epoch: 1, Steps: 8 | Train Loss: 1.954 Vali Loss: 1.542 Vali Acc: 0.566 Test Loss: 1.542 Test Acc: 0.566
Validation loss decreased (inf --> -0.565610).  Saving model ...
Epoch: 2 cost time: 0.7444515228271484
Epoch: 2, Steps: 8 | Train Loss: 1.171 Vali Loss: 0.775 Vali Acc: 0.809 Test Loss: 0.775 Test Acc: 0.809
Validation loss decreased (-0.565610 --> -0.809367).  Saving model ...
Epoch: 3 cost time: 0.753321647644043
Epoch: 3, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.809367 --> -0.840620).  Saving model ...
Epoch: 4 cost time: 0.92203688621521
Epoch: 4, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7259998321533203
Epoch: 5, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.461 Vali Acc: 0.859 Test Loss: 0.461 Test Acc: 0.859
Validation loss decreased (-0.840620 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 0.6386966705322266
Epoch: 6, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7453913688659668
Epoch: 7, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8317348957061768
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7117893695831299
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7202284336090088
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.572 Vali Acc: 0.869 Test Loss: 0.572 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868744).  Saving model ...
Epoch: 11 cost time: 0.699925422668457
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.834 Test Loss: 0.602 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7898950576782227
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.831 Test Loss: 0.647 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7276666164398193
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.646 Vali Acc: 0.853 Test Loss: 0.646 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7982978820800781
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9045796394348145
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.616 Vali Acc: 0.853 Test Loss: 0.616 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7393820285797119
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.853 Test Loss: 0.639 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6982495784759521
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.666 Vali Acc: 0.859 Test Loss: 0.666 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7006635665893555
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.859 Test Loss: 0.681 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6984448432922363
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.856 Test Loss: 0.688 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7538547515869141
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.853 Test Loss: 0.687 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 204004
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7602100372314453
Epoch: 1, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.615 Vali Acc: 0.553 Test Loss: 1.615 Test Acc: 0.553
Validation loss decreased (inf --> -0.553109).  Saving model ...
Epoch: 2 cost time: 0.7833645343780518
Epoch: 2, Steps: 8 | Train Loss: 1.295 Vali Loss: 0.905 Vali Acc: 0.787 Test Loss: 0.905 Test Acc: 0.787
Validation loss decreased (-0.553109 --> -0.787491).  Saving model ...
Epoch: 3 cost time: 0.7580962181091309
Epoch: 3, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.616 Vali Acc: 0.806 Test Loss: 0.616 Test Acc: 0.806
Validation loss decreased (-0.787491 --> -0.806244).  Saving model ...
Epoch: 4 cost time: 0.7383201122283936
Epoch: 4, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 0.8149023056030273
Epoch: 5, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.815619 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.8577308654785156
Epoch: 6, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.564 Vali Acc: 0.831 Test Loss: 0.564 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9190990924835205
Epoch: 7, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8535599708557129
Epoch: 8, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7849626541137695
Epoch: 9, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.676 Vali Acc: 0.825 Test Loss: 0.676 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8029341697692871
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.654 Vali Acc: 0.838 Test Loss: 0.654 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7396652698516846
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.693 Vali Acc: 0.841 Test Loss: 0.693 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7928707599639893
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.641 Vali Acc: 0.841 Test Loss: 0.641 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8306405544281006
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.673 Vali Acc: 0.844 Test Loss: 0.673 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7582211494445801
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.702 Vali Acc: 0.841 Test Loss: 0.702 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6952030658721924
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.736 Vali Acc: 0.841 Test Loss: 0.736 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 204004
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.537189245223999
Epoch: 1, Steps: 8 | Train Loss: 2.159 Vali Loss: 1.660 Vali Acc: 0.425 Test Loss: 1.660 Test Acc: 0.425
Validation loss decreased (inf --> -0.424983).  Saving model ...
Epoch: 2 cost time: 0.7948534488677979
Epoch: 2, Steps: 8 | Train Loss: 1.270 Vali Loss: 0.816 Vali Acc: 0.772 Test Loss: 0.816 Test Acc: 0.772
Validation loss decreased (-0.424983 --> -0.771867).  Saving model ...
Epoch: 3 cost time: 0.9413208961486816
Epoch: 3, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.771867 --> -0.818744).  Saving model ...
Epoch: 4 cost time: 0.81524658203125
Epoch: 4, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.512 Vali Acc: 0.825 Test Loss: 0.512 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824995).  Saving model ...
Epoch: 5 cost time: 0.7968544960021973
Epoch: 5, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.8516941070556641
Epoch: 6, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8201794624328613
Epoch: 7, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.8050844669342041
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.643 Vali Acc: 0.831 Test Loss: 0.643 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8368005752563477
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8201258182525635
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.659 Vali Acc: 0.828 Test Loss: 0.659 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8182418346405029
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.733 Vali Acc: 0.816 Test Loss: 0.733 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7738709449768066
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8654916286468506
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.831 Test Loss: 0.730 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8618009090423584
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.731 Vali Acc: 0.831 Test Loss: 0.731 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8691732883453369
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.832432746887207
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.731 Vali Acc: 0.822 Test Loss: 0.731 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8597350120544434
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.825 Test Loss: 0.747 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 187620
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.758227825164795
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 1.674 Vali Acc: 0.422 Test Loss: 1.674 Test Acc: 0.422
Validation loss decreased (inf --> -0.421858).  Saving model ...
Epoch: 2 cost time: 0.8800878524780273
Epoch: 2, Steps: 8 | Train Loss: 1.287 Vali Loss: 0.829 Vali Acc: 0.769 Test Loss: 0.829 Test Acc: 0.769
Validation loss decreased (-0.421858 --> -0.768742).  Saving model ...
Epoch: 3 cost time: 0.9417781829833984
Epoch: 3, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
Validation loss decreased (-0.768742 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 0.8660228252410889
Epoch: 4, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 0.8198559284210205
Epoch: 5, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.8306252956390381
Epoch: 6, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9259920120239258
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 0.8645505905151367
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8857989311218262
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.628 Vali Acc: 0.834 Test Loss: 0.628 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9359297752380371
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.638 Vali Acc: 0.841 Test Loss: 0.638 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8034489154815674
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.816 Test Loss: 0.707 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7989869117736816
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.711 Vali Acc: 0.838 Test Loss: 0.711 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8640904426574707
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.834 Test Loss: 0.707 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8629519939422607
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.841 Test Loss: 0.706 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8523204326629639
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.844 Test Loss: 0.706 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7949235439300537
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.834 Test Loss: 0.708 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8350279331207275
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.828 Test Loss: 0.724 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 187620
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.577451229095459
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 1.709 Vali Acc: 0.384 Test Loss: 1.709 Test Acc: 0.384
Validation loss decreased (inf --> -0.384358).  Saving model ...
Epoch: 2 cost time: 0.8064279556274414
Epoch: 2, Steps: 8 | Train Loss: 1.298 Vali Loss: 0.860 Vali Acc: 0.784 Test Loss: 0.860 Test Acc: 0.784
Validation loss decreased (-0.384358 --> -0.784366).  Saving model ...
Epoch: 3 cost time: 0.8322739601135254
Epoch: 3, Steps: 8 | Train Loss: 0.674 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
Validation loss decreased (-0.784366 --> -0.812494).  Saving model ...
Epoch: 4 cost time: 0.7518682479858398
Epoch: 4, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
Validation loss decreased (-0.812494 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 0.7553184032440186
Epoch: 5, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 0.7591578960418701
Epoch: 6, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7630562782287598
Epoch: 7, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.489 Vali Acc: 0.869 Test Loss: 0.489 Test Acc: 0.869
Validation loss decreased (-0.853120 --> -0.868745).  Saving model ...
Epoch: 8 cost time: 0.7809648513793945
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7484478950500488
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.545 Vali Acc: 0.866 Test Loss: 0.545 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7607042789459229
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.549 Vali Acc: 0.866 Test Loss: 0.549 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7684507369995117
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7891809940338135
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8559777736663818
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.859 Test Loss: 0.612 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.77579665184021
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.859 Test Loss: 0.612 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7881312370300293
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7454578876495361
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.853 Test Loss: 0.612 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8843562602996826
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 187620
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5115270614624023
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 1.745 Vali Acc: 0.406 Test Loss: 1.745 Test Acc: 0.406
Validation loss decreased (inf --> -0.406233).  Saving model ...
Epoch: 2 cost time: 0.7815351486206055
Epoch: 2, Steps: 8 | Train Loss: 1.391 Vali Loss: 0.966 Vali Acc: 0.806 Test Loss: 0.966 Test Acc: 0.806
Validation loss decreased (-0.406233 --> -0.806240).  Saving model ...
Epoch: 3 cost time: 0.7269871234893799
Epoch: 3, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.645 Vali Acc: 0.816 Test Loss: 0.645 Test Acc: 0.816
Validation loss decreased (-0.806240 --> -0.815619).  Saving model ...
Epoch: 4 cost time: 0.7163279056549072
Epoch: 4, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831245).  Saving model ...
Epoch: 5 cost time: 0.7592730522155762
Epoch: 5, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.7626707553863525
Epoch: 6, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8805549144744873
Epoch: 7, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7943482398986816
Epoch: 8, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7694096565246582
Epoch: 9, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 0.7229926586151123
Epoch: 10, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.856244).  Saving model ...
Epoch: 11 cost time: 0.7930827140808105
Epoch: 11, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6788103580474854
Epoch: 12, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.665 Vali Acc: 0.847 Test Loss: 0.665 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7972202301025391
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.667 Vali Acc: 0.847 Test Loss: 0.667 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.717369556427002
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.688 Vali Acc: 0.853 Test Loss: 0.688 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6877360343933105
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.693 Vali Acc: 0.853 Test Loss: 0.693 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8057911396026611
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.692 Vali Acc: 0.853 Test Loss: 0.692 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7610714435577393
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.853 Test Loss: 0.707 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8191068172454834
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.727 Vali Acc: 0.856 Test Loss: 0.727 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6613667011260986
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7432210445404053
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.853 Test Loss: 0.717 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 187620
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.522616147994995
Epoch: 1, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.465 Vali Acc: 0.581 Test Loss: 1.465 Test Acc: 0.581
Validation loss decreased (inf --> -0.581235).  Saving model ...
Epoch: 2 cost time: 0.7937850952148438
Epoch: 2, Steps: 8 | Train Loss: 1.111 Vali Loss: 0.753 Vali Acc: 0.803 Test Loss: 0.753 Test Acc: 0.803
Validation loss decreased (-0.581235 --> -0.803117).  Saving model ...
Epoch: 3 cost time: 0.8357281684875488
Epoch: 3, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
Validation loss decreased (-0.803117 --> -0.812495).  Saving model ...
Epoch: 4 cost time: 0.8687958717346191
Epoch: 4, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
Validation loss decreased (-0.812495 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 0.797736644744873
Epoch: 5, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8541128635406494
Epoch: 6, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8765497207641602
Epoch: 7, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.580 Vali Acc: 0.831 Test Loss: 0.580 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7846298217773438
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.607 Vali Acc: 0.847 Test Loss: 0.607 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7273519039154053
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.685 Vali Acc: 0.831 Test Loss: 0.685 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8470473289489746
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.674 Vali Acc: 0.816 Test Loss: 0.674 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8423833847045898
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7812528610229492
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.706 Vali Acc: 0.831 Test Loss: 0.706 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7849724292755127
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.738 Vali Acc: 0.828 Test Loss: 0.738 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7659993171691895
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.722 Vali Acc: 0.825 Test Loss: 0.722 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 179428
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7117292881011963
Epoch: 1, Steps: 8 | Train Loss: 1.852 Vali Loss: 1.460 Vali Acc: 0.594 Test Loss: 1.460 Test Acc: 0.594
Validation loss decreased (inf --> -0.593735).  Saving model ...
Epoch: 2 cost time: 0.8795373439788818
Epoch: 2, Steps: 8 | Train Loss: 1.095 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
Validation loss decreased (-0.593735 --> -0.799992).  Saving model ...
Epoch: 3 cost time: 0.7339768409729004
Epoch: 3, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
Validation loss decreased (-0.799992 --> -0.815620).  Saving model ...
Epoch: 4 cost time: 0.8080792427062988
Epoch: 4, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
Validation loss decreased (-0.815620 --> -0.859370).  Saving model ...
Epoch: 5 cost time: 0.7652521133422852
Epoch: 5, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7581055164337158
Epoch: 6, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8032212257385254
Epoch: 7, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8226885795593262
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.611 Vali Acc: 0.847 Test Loss: 0.611 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8631579875946045
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.686 Vali Acc: 0.822 Test Loss: 0.686 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1254065036773682
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.651 Vali Acc: 0.834 Test Loss: 0.651 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9301283359527588
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.838 Test Loss: 0.636 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8725826740264893
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.831 Test Loss: 0.681 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8597147464752197
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8824095726013184
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.698 Vali Acc: 0.828 Test Loss: 0.698 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 179428
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.169109344482422
Epoch: 1, Steps: 8 | Train Loss: 1.844 Vali Loss: 1.470 Vali Acc: 0.628 Test Loss: 1.470 Test Acc: 0.628
Validation loss decreased (inf --> -0.628110).  Saving model ...
Epoch: 2 cost time: 0.7399137020111084
Epoch: 2, Steps: 8 | Train Loss: 1.112 Vali Loss: 0.775 Vali Acc: 0.822 Test Loss: 0.775 Test Acc: 0.822
Validation loss decreased (-0.628110 --> -0.821867).  Saving model ...
Epoch: 3 cost time: 0.8909647464752197
Epoch: 3, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8765664100646973
Epoch: 4, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
Validation loss decreased (-0.821867 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 0.9058482646942139
Epoch: 5, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 0.8615691661834717
Epoch: 6, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8639562129974365
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.503 Vali Acc: 0.866 Test Loss: 0.503 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 8 cost time: 0.9341778755187988
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8539292812347412
Epoch: 9, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.611 Vali Acc: 0.831 Test Loss: 0.611 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8413670063018799
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8842859268188477
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.571 Vali Acc: 0.853 Test Loss: 0.571 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9018261432647705
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.859 Test Loss: 0.595 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8813178539276123
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.847 Test Loss: 0.636 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9381029605865479
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.650 Vali Acc: 0.847 Test Loss: 0.650 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.693183183670044
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.847 Test Loss: 0.628 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8716647624969482
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.847 Test Loss: 0.633 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.917614221572876
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 179428
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.954765558242798
Epoch: 1, Steps: 8 | Train Loss: 1.877 Vali Loss: 1.570 Vali Acc: 0.562 Test Loss: 1.570 Test Acc: 0.562
Validation loss decreased (inf --> -0.562484).  Saving model ...
Epoch: 2 cost time: 0.7932860851287842
Epoch: 2, Steps: 8 | Train Loss: 1.235 Vali Loss: 0.925 Vali Acc: 0.769 Test Loss: 0.925 Test Acc: 0.769
Validation loss decreased (-0.562484 --> -0.768741).  Saving model ...
Epoch: 3 cost time: 0.7621560096740723
Epoch: 3, Steps: 8 | Train Loss: 0.622 Vali Loss: 0.630 Vali Acc: 0.806 Test Loss: 0.630 Test Acc: 0.806
Validation loss decreased (-0.768741 --> -0.806244).  Saving model ...
Epoch: 4 cost time: 0.7796578407287598
Epoch: 4, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
Validation loss decreased (-0.806244 --> -0.824995).  Saving model ...
Epoch: 5 cost time: 0.6881380081176758
Epoch: 5, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8342432975769043
Epoch: 6, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8589775562286377
Epoch: 7, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
Validation loss decreased (-0.824995 --> -0.846869).  Saving model ...
Epoch: 8 cost time: 0.8248462677001953
Epoch: 8, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.592 Vali Acc: 0.834 Test Loss: 0.592 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7814047336578369
Epoch: 9, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.641 Vali Acc: 0.838 Test Loss: 0.641 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8561685085296631
Epoch: 10, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.632 Vali Acc: 0.834 Test Loss: 0.632 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8557755947113037
Epoch: 11, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.676 Vali Acc: 0.841 Test Loss: 0.676 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8673586845397949
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8337488174438477
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.697 Vali Acc: 0.834 Test Loss: 0.697 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9172103404998779
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.722 Vali Acc: 0.841 Test Loss: 0.722 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8478355407714844
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.723 Vali Acc: 0.838 Test Loss: 0.723 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.828033447265625
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.753 Vali Acc: 0.838 Test Loss: 0.753 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8686141967773438
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 179428
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.995368719100952
Epoch: 1, Steps: 8 | Train Loss: 2.208 Vali Loss: 1.894 Vali Acc: 0.338 Test Loss: 1.894 Test Acc: 0.338
Validation loss decreased (inf --> -0.337481).  Saving model ...
Epoch: 2 cost time: 0.7259321212768555
Epoch: 2, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.242 Vali Acc: 0.706 Test Loss: 1.242 Test Acc: 0.706
Validation loss decreased (-0.337481 --> -0.706238).  Saving model ...
Epoch: 3 cost time: 0.8126330375671387
Epoch: 3, Steps: 8 | Train Loss: 0.988 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.706238 --> -0.799992).  Saving model ...
Epoch: 4 cost time: 0.8336653709411621
Epoch: 4, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809369).  Saving model ...
Epoch: 5 cost time: 0.8634800910949707
Epoch: 5, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812495).  Saving model ...
Epoch: 6 cost time: 0.8347592353820801
Epoch: 6, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.812495 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.8005478382110596
Epoch: 7, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.8815183639526367
Epoch: 8, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8649523258209229
Epoch: 9, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.849804162979126
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7646305561065674
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.602 Vali Acc: 0.834 Test Loss: 0.602 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9318978786468506
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.609 Vali Acc: 0.828 Test Loss: 0.609 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.860684871673584
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.588 Vali Acc: 0.847 Test Loss: 0.588 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7753386497497559
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.602 Vali Acc: 0.838 Test Loss: 0.602 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8753893375396729
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.625 Vali Acc: 0.834 Test Loss: 0.625 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8591399192810059
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.7937121391296387
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8030080795288086
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8431515693664551
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8511264324188232
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8242616653442383
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.828005313873291
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.664 Vali Acc: 0.847 Test Loss: 0.664 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9545953273773193
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.675 Vali Acc: 0.841 Test Loss: 0.675 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7880251407623291
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9335432052612305
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.844 Test Loss: 0.687 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.782078742980957
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.694 Vali Acc: 0.844 Test Loss: 0.694 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 214660
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8201043605804443
Epoch: 1, Steps: 8 | Train Loss: 2.206 Vali Loss: 1.891 Vali Acc: 0.369 Test Loss: 1.891 Test Acc: 0.369
Validation loss decreased (inf --> -0.368731).  Saving model ...
Epoch: 2 cost time: 0.8728775978088379
Epoch: 2, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.246 Vali Acc: 0.709 Test Loss: 1.246 Test Acc: 0.709
Validation loss decreased (-0.368731 --> -0.709363).  Saving model ...
Epoch: 3 cost time: 0.9206509590148926
Epoch: 3, Steps: 8 | Train Loss: 0.991 Vali Loss: 0.777 Vali Acc: 0.816 Test Loss: 0.777 Test Acc: 0.816
Validation loss decreased (-0.709363 --> -0.815617).  Saving model ...
Epoch: 4 cost time: 0.9016237258911133
Epoch: 4, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 0.9157254695892334
Epoch: 5, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8728384971618652
Epoch: 6, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.821869 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 0.9057695865631104
Epoch: 7, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8998196125030518
Epoch: 8, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9297254085540771
Epoch: 9, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9255692958831787
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8147256374359131
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9137792587280273
Epoch: 12, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0089874267578125
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8506832122802734
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7748210430145264
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.588 Vali Acc: 0.847 Test Loss: 0.588 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9294257164001465
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.595 Vali Acc: 0.847 Test Loss: 0.595 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 214660
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0618319511413574
Epoch: 1, Steps: 8 | Train Loss: 2.210 Vali Loss: 1.890 Vali Acc: 0.350 Test Loss: 1.890 Test Acc: 0.350
Validation loss decreased (inf --> -0.349981).  Saving model ...
Epoch: 2 cost time: 0.8915235996246338
Epoch: 2, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.267 Vali Acc: 0.731 Test Loss: 1.267 Test Acc: 0.731
Validation loss decreased (-0.349981 --> -0.731237).  Saving model ...
Epoch: 3 cost time: 0.8891146183013916
Epoch: 3, Steps: 8 | Train Loss: 1.021 Vali Loss: 0.807 Vali Acc: 0.809 Test Loss: 0.807 Test Acc: 0.809
Validation loss decreased (-0.731237 --> -0.809367).  Saving model ...
Epoch: 4 cost time: 0.9734468460083008
Epoch: 4, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
Validation loss decreased (-0.809367 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 0.9242973327636719
Epoch: 5, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8216378688812256
Epoch: 6, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.504 Vali Acc: 0.828 Test Loss: 0.504 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 0.729968786239624
Epoch: 7, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 0.7638628482818604
Epoch: 8, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.519 Vali Acc: 0.853 Test Loss: 0.519 Test Acc: 0.853
Validation loss decreased (-0.834370 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.7359237670898438
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7596073150634766
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9069843292236328
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.864288330078125
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.553 Vali Acc: 0.847 Test Loss: 0.553 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.645514726638794
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 0.9525821208953857
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.565 Vali Acc: 0.847 Test Loss: 0.565 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8746094703674316
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.617 Vali Acc: 0.834 Test Loss: 0.617 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.834658145904541
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.604 Vali Acc: 0.847 Test Loss: 0.604 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8974640369415283
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.585 Vali Acc: 0.863 Test Loss: 0.585 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862494).  Saving model ...
Epoch: 18 cost time: 0.8286778926849365
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.589 Vali Acc: 0.859 Test Loss: 0.589 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8866932392120361
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8392477035522461
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.753678560256958
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8548424243927002
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.630 Vali Acc: 0.853 Test Loss: 0.630 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7666416168212891
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.634 Vali Acc: 0.853 Test Loss: 0.634 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9278285503387451
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.635 Vali Acc: 0.853 Test Loss: 0.635 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.779388427734375
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.647 Vali Acc: 0.853 Test Loss: 0.647 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.914985179901123
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8313624858856201
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.665 Vali Acc: 0.847 Test Loss: 0.665 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 214660
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.872917413711548
Epoch: 1, Steps: 8 | Train Loss: 2.218 Vali Loss: 1.960 Vali Acc: 0.284 Test Loss: 1.960 Test Acc: 0.284
Validation loss decreased (inf --> -0.284355).  Saving model ...
Epoch: 2 cost time: 0.7335808277130127
Epoch: 2, Steps: 8 | Train Loss: 1.759 Vali Loss: 1.388 Vali Acc: 0.672 Test Loss: 1.388 Test Acc: 0.672
Validation loss decreased (-0.284355 --> -0.671861).  Saving model ...
Epoch: 3 cost time: 0.8189032077789307
Epoch: 3, Steps: 8 | Train Loss: 1.159 Vali Loss: 0.934 Vali Acc: 0.787 Test Loss: 0.934 Test Acc: 0.787
Validation loss decreased (-0.671861 --> -0.787491).  Saving model ...
Epoch: 4 cost time: 0.8113083839416504
Epoch: 4, Steps: 8 | Train Loss: 0.735 Vali Loss: 0.708 Vali Acc: 0.794 Test Loss: 0.708 Test Acc: 0.794
Validation loss decreased (-0.787491 --> -0.793743).  Saving model ...
Epoch: 5 cost time: 0.7240984439849854
Epoch: 5, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.623 Vali Acc: 0.794 Test Loss: 0.623 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793744).  Saving model ...
Epoch: 6 cost time: 0.7823879718780518
Epoch: 6, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
Validation loss decreased (-0.793744 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.8272647857666016
Epoch: 7, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7702476978302002
Epoch: 8, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.825392484664917
Epoch: 9, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.588 Vali Acc: 0.809 Test Loss: 0.588 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8057503700256348
Epoch: 10, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 0.7192294597625732
Epoch: 11, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 0.8287055492401123
Epoch: 12, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8366959095001221
Epoch: 13, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.616 Vali Acc: 0.834 Test Loss: 0.616 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 14 cost time: 0.821885347366333
Epoch: 14, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.636 Vali Acc: 0.831 Test Loss: 0.636 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8137929439544678
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.663 Vali Acc: 0.831 Test Loss: 0.663 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7134871482849121
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7172315120697021
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.650 Vali Acc: 0.834 Test Loss: 0.650 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8227183818817139
Epoch: 18, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.666 Vali Acc: 0.841 Test Loss: 0.666 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840618).  Saving model ...
Epoch: 19 cost time: 0.7941617965698242
Epoch: 19, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.689 Vali Acc: 0.834 Test Loss: 0.689 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7763915061950684
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.688 Vali Acc: 0.841 Test Loss: 0.688 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8246383666992188
Epoch: 21, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.712 Vali Acc: 0.844 Test Loss: 0.712 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843743).  Saving model ...
Epoch: 22 cost time: 0.8302328586578369
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.722 Vali Acc: 0.838 Test Loss: 0.722 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7381994724273682
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.736 Vali Acc: 0.838 Test Loss: 0.736 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8125061988830566
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.746 Vali Acc: 0.838 Test Loss: 0.746 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8287487030029297
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.730 Vali Acc: 0.841 Test Loss: 0.730 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7718942165374756
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.736 Vali Acc: 0.834 Test Loss: 0.736 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8016445636749268
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.765 Vali Acc: 0.838 Test Loss: 0.765 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7076711654663086
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.844 Test Loss: 0.754 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7036886215209961
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.743 Vali Acc: 0.844 Test Loss: 0.743 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7612357139587402
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.763 Vali Acc: 0.838 Test Loss: 0.763 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6650471687316895
Epoch: 31, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.775 Vali Acc: 0.838 Test Loss: 0.775 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 214660
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7395401000976562
Epoch: 1, Steps: 8 | Train Loss: 2.193 Vali Loss: 1.888 Vali Acc: 0.359 Test Loss: 1.888 Test Acc: 0.359
Validation loss decreased (inf --> -0.359356).  Saving model ...
Epoch: 2 cost time: 0.8149118423461914
Epoch: 2, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.243 Vali Acc: 0.719 Test Loss: 1.243 Test Acc: 0.719
Validation loss decreased (-0.359356 --> -0.718738).  Saving model ...
Epoch: 3 cost time: 0.8355679512023926
Epoch: 3, Steps: 8 | Train Loss: 0.995 Vali Loss: 0.786 Vali Acc: 0.806 Test Loss: 0.786 Test Acc: 0.806
Validation loss decreased (-0.718738 --> -0.806242).  Saving model ...
Epoch: 4 cost time: 0.8357999324798584
Epoch: 4, Steps: 8 | Train Loss: 0.578 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
Validation loss decreased (-0.806242 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 0.7346556186676025
Epoch: 5, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.7151107788085938
Epoch: 6, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7921855449676514
Epoch: 7, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.7701609134674072
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7924587726593018
Epoch: 9, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.530 Vali Acc: 0.853 Test Loss: 0.530 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.6857485771179199
Epoch: 10, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.7345602512359619
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8509459495544434
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.622 Vali Acc: 0.838 Test Loss: 0.622 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8051302433013916
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7171709537506104
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.623 Vali Acc: 0.838 Test Loss: 0.623 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8523170948028564
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.640 Vali Acc: 0.841 Test Loss: 0.640 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8273985385894775
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.811469316482544
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.841454029083252
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.634 Vali Acc: 0.853 Test Loss: 0.634 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7628695964813232
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.841 Test Loss: 0.659 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8129181861877441
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 149124
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1763839721679688
Epoch: 1, Steps: 8 | Train Loss: 2.187 Vali Loss: 1.898 Vali Acc: 0.353 Test Loss: 1.898 Test Acc: 0.353
Validation loss decreased (inf --> -0.353106).  Saving model ...
Epoch: 2 cost time: 0.7089972496032715
Epoch: 2, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.255 Vali Acc: 0.719 Test Loss: 1.255 Test Acc: 0.719
Validation loss decreased (-0.353106 --> -0.718737).  Saving model ...
Epoch: 3 cost time: 0.8424818515777588
Epoch: 3, Steps: 8 | Train Loss: 1.002 Vali Loss: 0.794 Vali Acc: 0.797 Test Loss: 0.794 Test Acc: 0.797
Validation loss decreased (-0.718737 --> -0.796867).  Saving model ...
Epoch: 4 cost time: 0.8301916122436523
Epoch: 4, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
Validation loss decreased (-0.796867 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 0.8343460559844971
Epoch: 5, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.9069461822509766
Epoch: 6, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.8934199810028076
Epoch: 7, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 0.8524198532104492
Epoch: 8, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8536202907562256
Epoch: 9, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8178415298461914
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 11 cost time: 0.8888325691223145
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9037551879882812
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8137784004211426
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7996664047241211
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.591 Vali Acc: 0.859 Test Loss: 0.591 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 15 cost time: 0.79374098777771
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.617 Vali Acc: 0.838 Test Loss: 0.617 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.819509744644165
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.613 Vali Acc: 0.847 Test Loss: 0.613 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8220498561859131
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8979904651641846
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.607 Vali Acc: 0.853 Test Loss: 0.607 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8095166683197021
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8522536754608154
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.765357494354248
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.859 Test Loss: 0.637 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.831273078918457
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.645 Vali Acc: 0.859 Test Loss: 0.645 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7311010360717773
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.644 Vali Acc: 0.859 Test Loss: 0.644 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7086746692657471
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.652 Vali Acc: 0.859 Test Loss: 0.652 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 149124
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6343438625335693
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 1.932 Vali Acc: 0.322 Test Loss: 1.932 Test Acc: 0.322
Validation loss decreased (inf --> -0.321856).  Saving model ...
Epoch: 2 cost time: 0.8249127864837646
Epoch: 2, Steps: 8 | Train Loss: 1.641 Vali Loss: 1.298 Vali Acc: 0.725 Test Loss: 1.298 Test Acc: 0.725
Validation loss decreased (-0.321856 --> -0.724987).  Saving model ...
Epoch: 3 cost time: 0.7928142547607422
Epoch: 3, Steps: 8 | Train Loss: 1.033 Vali Loss: 0.832 Vali Acc: 0.781 Test Loss: 0.832 Test Acc: 0.781
Validation loss decreased (-0.724987 --> -0.781242).  Saving model ...
Epoch: 4 cost time: 0.7735404968261719
Epoch: 4, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.621 Vali Acc: 0.816 Test Loss: 0.621 Test Acc: 0.816
Validation loss decreased (-0.781242 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 0.8062789440155029
Epoch: 5, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
Validation loss decreased (-0.815619 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 0.7104372978210449
Epoch: 6, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.776684045791626
Epoch: 7, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 0.7555873394012451
Epoch: 8, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8209652900695801
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8134655952453613
Epoch: 10, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.846870 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 0.7564079761505127
Epoch: 11, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8408186435699463
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.592 Vali Acc: 0.838 Test Loss: 0.592 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7885668277740479
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7410800457000732
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8525500297546387
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8362815380096436
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.611 Vali Acc: 0.847 Test Loss: 0.611 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8085832595825195
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.595 Vali Acc: 0.863 Test Loss: 0.595 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.750176191329956
Epoch: 18, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.594 Vali Acc: 0.863 Test Loss: 0.594 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8037669658660889
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.623 Vali Acc: 0.853 Test Loss: 0.623 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7858114242553711
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.644 Vali Acc: 0.841 Test Loss: 0.644 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 149124
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7263896465301514
Epoch: 1, Steps: 8 | Train Loss: 2.222 Vali Loss: 1.981 Vali Acc: 0.278 Test Loss: 1.981 Test Acc: 0.278
Validation loss decreased (inf --> -0.278105).  Saving model ...
Epoch: 2 cost time: 0.7424125671386719
Epoch: 2, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.412 Vali Acc: 0.681 Test Loss: 1.412 Test Acc: 0.681
Validation loss decreased (-0.278105 --> -0.681236).  Saving model ...
Epoch: 3 cost time: 0.8642978668212891
Epoch: 3, Steps: 8 | Train Loss: 1.195 Vali Loss: 0.969 Vali Acc: 0.772 Test Loss: 0.969 Test Acc: 0.772
Validation loss decreased (-0.681236 --> -0.771865).  Saving model ...
Epoch: 4 cost time: 0.8754873275756836
Epoch: 4, Steps: 8 | Train Loss: 0.758 Vali Loss: 0.731 Vali Acc: 0.794 Test Loss: 0.731 Test Acc: 0.794
Validation loss decreased (-0.771865 --> -0.793743).  Saving model ...
Epoch: 5 cost time: 0.8992698192596436
Epoch: 5, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
Validation loss decreased (-0.793743 --> -0.809369).  Saving model ...
Epoch: 6 cost time: 0.901665449142456
Epoch: 6, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 7 cost time: 0.8700873851776123
Epoch: 7, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8551435470581055
Epoch: 8, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7268249988555908
Epoch: 9, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
Validation loss decreased (-0.812494 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 0.7791652679443359
Epoch: 10, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.569 Vali Acc: 0.834 Test Loss: 0.569 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7409203052520752
Epoch: 11, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7715458869934082
Epoch: 12, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.795001745223999
Epoch: 13, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 14 cost time: 0.8275573253631592
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.628 Vali Acc: 0.838 Test Loss: 0.628 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7034461498260498
Epoch: 15, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8338220119476318
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.670 Vali Acc: 0.834 Test Loss: 0.670 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8450484275817871
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.667 Vali Acc: 0.841 Test Loss: 0.667 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7718379497528076
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.674 Vali Acc: 0.841 Test Loss: 0.674 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9477007389068604
Epoch: 19, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9042928218841553
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.709 Vali Acc: 0.828 Test Loss: 0.709 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9524149894714355
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.722 Vali Acc: 0.828 Test Loss: 0.722 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8527817726135254
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.711 Vali Acc: 0.831 Test Loss: 0.711 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7589156627655029
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.729 Vali Acc: 0.831 Test Loss: 0.729 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 149124
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.028733015060425
Epoch: 1, Steps: 8 | Train Loss: 2.255 Vali Loss: 1.915 Vali Acc: 0.281 Test Loss: 1.915 Test Acc: 0.281
Validation loss decreased (inf --> -0.281231).  Saving model ...
Epoch: 2 cost time: 0.828139066696167
Epoch: 2, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.271 Vali Acc: 0.725 Test Loss: 1.271 Test Acc: 0.725
Validation loss decreased (-0.281231 --> -0.724987).  Saving model ...
Epoch: 3 cost time: 0.8615212440490723
Epoch: 3, Steps: 8 | Train Loss: 1.047 Vali Loss: 0.787 Vali Acc: 0.812 Test Loss: 0.787 Test Acc: 0.812
Validation loss decreased (-0.724987 --> -0.812492).  Saving model ...
Epoch: 4 cost time: 0.755948543548584
Epoch: 4, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.587 Vali Acc: 0.825 Test Loss: 0.587 Test Acc: 0.825
Validation loss decreased (-0.812492 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 0.799971342086792
Epoch: 5, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.8020575046539307
Epoch: 6, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7131657600402832
Epoch: 7, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.8150496482849121
Epoch: 8, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8654663562774658
Epoch: 9, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7554116249084473
Epoch: 10, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8417770862579346
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8055229187011719
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.572 Vali Acc: 0.838 Test Loss: 0.572 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8347742557525635
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.614 Vali Acc: 0.831 Test Loss: 0.614 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8187062740325928
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.622 Vali Acc: 0.838 Test Loss: 0.622 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7631776332855225
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.606 Vali Acc: 0.834 Test Loss: 0.606 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7203056812286377
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7433087825775146
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.637 Vali Acc: 0.834 Test Loss: 0.637 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 116356
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.103771448135376
Epoch: 1, Steps: 8 | Train Loss: 2.240 Vali Loss: 1.913 Vali Acc: 0.269 Test Loss: 1.913 Test Acc: 0.269
Validation loss decreased (inf --> -0.268731).  Saving model ...
Epoch: 2 cost time: 0.6315608024597168
Epoch: 2, Steps: 8 | Train Loss: 1.667 Vali Loss: 1.280 Vali Acc: 0.728 Test Loss: 1.280 Test Acc: 0.728
Validation loss decreased (-0.268731 --> -0.728112).  Saving model ...
Epoch: 3 cost time: 0.7937142848968506
Epoch: 3, Steps: 8 | Train Loss: 1.052 Vali Loss: 0.795 Vali Acc: 0.791 Test Loss: 0.795 Test Acc: 0.791
Validation loss decreased (-0.728112 --> -0.790617).  Saving model ...
Epoch: 4 cost time: 0.7651486396789551
Epoch: 4, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
Validation loss decreased (-0.790617 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 0.6822788715362549
Epoch: 5, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 0.7214066982269287
Epoch: 6, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7703166007995605
Epoch: 7, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.477 Vali Acc: 0.859 Test Loss: 0.477 Test Acc: 0.859
Validation loss decreased (-0.840620 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.7909846305847168
Epoch: 8, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7171881198883057
Epoch: 9, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.508 Vali Acc: 0.853 Test Loss: 0.508 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7896637916564941
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7293593883514404
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8058178424835205
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8736026287078857
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7571649551391602
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7417869567871094
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6740257740020752
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.594 Vali Acc: 0.841 Test Loss: 0.594 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7030346393585205
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 116356
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7958059310913086
Epoch: 1, Steps: 8 | Train Loss: 2.187 Vali Loss: 1.901 Vali Acc: 0.322 Test Loss: 1.901 Test Acc: 0.322
Validation loss decreased (inf --> -0.321856).  Saving model ...
Epoch: 2 cost time: 0.8688018321990967
Epoch: 2, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.306 Vali Acc: 0.688 Test Loss: 1.306 Test Acc: 0.688
Validation loss decreased (-0.321856 --> -0.687487).  Saving model ...
Epoch: 3 cost time: 0.7737116813659668
Epoch: 3, Steps: 8 | Train Loss: 1.063 Vali Loss: 0.829 Vali Acc: 0.806 Test Loss: 0.829 Test Acc: 0.806
Validation loss decreased (-0.687487 --> -0.806242).  Saving model ...
Epoch: 4 cost time: 0.8219518661499023
Epoch: 4, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.616 Vali Acc: 0.825 Test Loss: 0.616 Test Acc: 0.825
Validation loss decreased (-0.806242 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 0.7608976364135742
Epoch: 5, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.851299524307251
Epoch: 6, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.8112053871154785
Epoch: 7, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.485 Vali Acc: 0.863 Test Loss: 0.485 Test Acc: 0.863
Validation loss decreased (-0.840620 --> -0.862495).  Saving model ...
Epoch: 8 cost time: 0.9718959331512451
Epoch: 8, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8555412292480469
Epoch: 9, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8902106285095215
Epoch: 10, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.529 Vali Acc: 0.853 Test Loss: 0.529 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.796053409576416
Epoch: 11, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8542163372039795
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8630721569061279
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.581 Vali Acc: 0.847 Test Loss: 0.581 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7413170337677002
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8515691757202148
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.582 Vali Acc: 0.853 Test Loss: 0.582 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7995743751525879
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7483768463134766
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.611 Vali Acc: 0.847 Test Loss: 0.611 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 116356
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.707082509994507
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 1.891 Vali Acc: 0.303 Test Loss: 1.891 Test Acc: 0.303
Validation loss decreased (inf --> -0.303106).  Saving model ...
Epoch: 2 cost time: 0.8843066692352295
Epoch: 2, Steps: 8 | Train Loss: 1.709 Vali Loss: 1.386 Vali Acc: 0.628 Test Loss: 1.386 Test Acc: 0.628
Validation loss decreased (-0.303106 --> -0.628111).  Saving model ...
Epoch: 3 cost time: 0.9148049354553223
Epoch: 3, Steps: 8 | Train Loss: 1.168 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
Validation loss decreased (-0.628111 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 0.8627805709838867
Epoch: 4, Steps: 8 | Train Loss: 0.733 Vali Loss: 0.719 Vali Acc: 0.794 Test Loss: 0.719 Test Acc: 0.794
Validation loss decreased (-0.774991 --> -0.793743).  Saving model ...
Epoch: 5 cost time: 0.8267545700073242
Epoch: 5, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.614 Vali Acc: 0.812 Test Loss: 0.614 Test Acc: 0.812
Validation loss decreased (-0.793743 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.8442983627319336
Epoch: 6, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8682024478912354
Epoch: 7, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.8696470260620117
Epoch: 8, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8729121685028076
Epoch: 9, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8425617218017578
Epoch: 10, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7559871673583984
Epoch: 11, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.591 Vali Acc: 0.831 Test Loss: 0.591 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.8478593826293945
Epoch: 12, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9654033184051514
Epoch: 13, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8940808773040771
Epoch: 14, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.636 Vali Acc: 0.838 Test Loss: 0.636 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 15 cost time: 0.8449113368988037
Epoch: 15, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8685669898986816
Epoch: 16, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.667 Vali Acc: 0.831 Test Loss: 0.667 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8525421619415283
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.686 Vali Acc: 0.841 Test Loss: 0.686 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840618).  Saving model ...
Epoch: 18 cost time: 0.8486948013305664
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
Validation loss decreased (-0.840618 --> -0.840618).  Saving model ...
Epoch: 19 cost time: 0.9348392486572266
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.696 Vali Acc: 0.841 Test Loss: 0.696 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8359055519104004
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.712 Vali Acc: 0.841 Test Loss: 0.712 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8025708198547363
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.719 Vali Acc: 0.831 Test Loss: 0.719 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8317656517028809
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.723 Vali Acc: 0.838 Test Loss: 0.723 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8660681247711182
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.741 Vali Acc: 0.831 Test Loss: 0.741 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8954455852508545
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.749 Vali Acc: 0.834 Test Loss: 0.749 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8452138900756836
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.754 Vali Acc: 0.834 Test Loss: 0.754 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8752965927124023
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.763 Vali Acc: 0.831 Test Loss: 0.763 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8708047866821289
Epoch: 27, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.760 Vali Acc: 0.834 Test Loss: 0.760 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7783846855163574
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.778 Vali Acc: 0.828 Test Loss: 0.778 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 116356
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9705328941345215
Epoch: 1, Steps: 8 | Train Loss: 2.066 Vali Loss: 1.838 Vali Acc: 0.334 Test Loss: 1.838 Test Acc: 0.334
Validation loss decreased (inf --> -0.334357).  Saving model ...
Epoch: 2 cost time: 0.8281464576721191
Epoch: 2, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.196 Vali Acc: 0.734 Test Loss: 1.196 Test Acc: 0.734
Validation loss decreased (-0.334357 --> -0.734363).  Saving model ...
Epoch: 3 cost time: 0.8132531642913818
Epoch: 3, Steps: 8 | Train Loss: 0.939 Vali Loss: 0.740 Vali Acc: 0.834 Test Loss: 0.740 Test Acc: 0.834
Validation loss decreased (-0.734363 --> -0.834368).  Saving model ...
Epoch: 4 cost time: 0.8133213520050049
Epoch: 4, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
Validation loss decreased (-0.834368 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 0.8980977535247803
Epoch: 5, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.822608470916748
Epoch: 6, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 0.943187952041626
Epoch: 7, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8668491840362549
Epoch: 8, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 0.8199496269226074
Epoch: 9, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9222853183746338
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8626871109008789
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8509616851806641
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8710448741912842
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9192898273468018
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8292093276977539
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7104787826538086
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.618 Vali Acc: 0.841 Test Loss: 0.618 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8669607639312744
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9015088081359863
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 99972
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4282445907592773
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.852 Vali Acc: 0.319 Test Loss: 1.852 Test Acc: 0.319
Validation loss decreased (inf --> -0.318731).  Saving model ...
Epoch: 2 cost time: 0.8958797454833984
Epoch: 2, Steps: 8 | Train Loss: 1.550 Vali Loss: 1.216 Vali Acc: 0.728 Test Loss: 1.216 Test Acc: 0.728
Validation loss decreased (-0.318731 --> -0.728113).  Saving model ...
Epoch: 3 cost time: 0.8790326118469238
Epoch: 3, Steps: 8 | Train Loss: 0.943 Vali Loss: 0.758 Vali Acc: 0.825 Test Loss: 0.758 Test Acc: 0.825
Validation loss decreased (-0.728113 --> -0.824992).  Saving model ...
Epoch: 4 cost time: 0.8354096412658691
Epoch: 4, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.557 Vali Acc: 0.847 Test Loss: 0.557 Test Acc: 0.847
Validation loss decreased (-0.824992 --> -0.846869).  Saving model ...
Epoch: 5 cost time: 0.8642756938934326
Epoch: 5, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.499 Vali Acc: 0.831 Test Loss: 0.499 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8741207122802734
Epoch: 6, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
Validation loss decreased (-0.846869 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 0.8536784648895264
Epoch: 7, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8410482406616211
Epoch: 8, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.485 Vali Acc: 0.859 Test Loss: 0.485 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 0.8107559680938721
Epoch: 9, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7903079986572266
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7428500652313232
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7527251243591309
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9434976577758789
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9289498329162598
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.568 Vali Acc: 0.853 Test Loss: 0.568 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7232890129089355
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8355844020843506
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.591 Vali Acc: 0.853 Test Loss: 0.591 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8292970657348633
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.592 Vali Acc: 0.859 Test Loss: 0.592 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7886450290679932
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 99972
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7185914516448975
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 1.897 Vali Acc: 0.275 Test Loss: 1.897 Test Acc: 0.275
Validation loss decreased (inf --> -0.274981).  Saving model ...
Epoch: 2 cost time: 0.8834481239318848
Epoch: 2, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.270 Vali Acc: 0.728 Test Loss: 1.270 Test Acc: 0.728
Validation loss decreased (-0.274981 --> -0.728112).  Saving model ...
Epoch: 3 cost time: 0.8709144592285156
Epoch: 3, Steps: 8 | Train Loss: 0.989 Vali Loss: 0.805 Vali Acc: 0.797 Test Loss: 0.805 Test Acc: 0.797
Validation loss decreased (-0.728112 --> -0.796867).  Saving model ...
Epoch: 4 cost time: 0.7921779155731201
Epoch: 4, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.588 Vali Acc: 0.834 Test Loss: 0.588 Test Acc: 0.834
Validation loss decreased (-0.796867 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 0.8545453548431396
Epoch: 5, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8887040615081787
Epoch: 6, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.834369 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 0.7762904167175293
Epoch: 7, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7531130313873291
Epoch: 8, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8778946399688721
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.506 Vali Acc: 0.859 Test Loss: 0.506 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8629601001739502
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8538229465484619
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.543 Vali Acc: 0.859 Test Loss: 0.543 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8880503177642822
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8551208972930908
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8466153144836426
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8524255752563477
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.580 Vali Acc: 0.863 Test Loss: 0.580 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862494).  Saving model ...
Epoch: 16 cost time: 0.87538743019104
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.602 Vali Acc: 0.859 Test Loss: 0.602 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8695008754730225
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9101011753082275
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8923940658569336
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7846662998199463
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.610 Vali Acc: 0.866 Test Loss: 0.610 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865619).  Saving model ...
Epoch: 21 cost time: 0.9044108390808105
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.618 Vali Acc: 0.859 Test Loss: 0.618 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8328731060028076
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.628 Vali Acc: 0.859 Test Loss: 0.628 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7697346210479736
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8978011608123779
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8780252933502197
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.853 Test Loss: 0.627 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7763962745666504
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.644 Vali Acc: 0.853 Test Loss: 0.644 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8642363548278809
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9372107982635498
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7491536140441895
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.859 Test Loss: 0.659 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8776054382324219
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 99972
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.059370756149292
Epoch: 1, Steps: 8 | Train Loss: 2.194 Vali Loss: 1.981 Vali Acc: 0.231 Test Loss: 1.981 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.8268659114837646
Epoch: 2, Steps: 8 | Train Loss: 1.768 Vali Loss: 1.414 Vali Acc: 0.659 Test Loss: 1.414 Test Acc: 0.659
Validation loss decreased (-0.231230 --> -0.659361).  Saving model ...
Epoch: 3 cost time: 0.7263519763946533
Epoch: 3, Steps: 8 | Train Loss: 1.173 Vali Loss: 0.957 Vali Acc: 0.784 Test Loss: 0.957 Test Acc: 0.784
Validation loss decreased (-0.659361 --> -0.784365).  Saving model ...
Epoch: 4 cost time: 0.7871575355529785
Epoch: 4, Steps: 8 | Train Loss: 0.735 Vali Loss: 0.717 Vali Acc: 0.797 Test Loss: 0.717 Test Acc: 0.797
Validation loss decreased (-0.784365 --> -0.796868).  Saving model ...
Epoch: 5 cost time: 0.7801358699798584
Epoch: 5, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.625 Vali Acc: 0.791 Test Loss: 0.625 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7884762287139893
Epoch: 6, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
Validation loss decreased (-0.796868 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.7984402179718018
Epoch: 7, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.599 Vali Acc: 0.800 Test Loss: 0.599 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7780013084411621
Epoch: 8, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8194646835327148
Epoch: 9, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
Validation loss decreased (-0.818744 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.8091113567352295
Epoch: 10, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.602 Vali Acc: 0.816 Test Loss: 0.602 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8182594776153564
Epoch: 11, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.615 Vali Acc: 0.825 Test Loss: 0.615 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8546850681304932
Epoch: 12, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.612 Vali Acc: 0.831 Test Loss: 0.612 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7988650798797607
Epoch: 13, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7743752002716064
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.639 Vali Acc: 0.841 Test Loss: 0.639 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 15 cost time: 0.8331265449523926
Epoch: 15, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.654 Vali Acc: 0.838 Test Loss: 0.654 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8104643821716309
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7851150035858154
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.693 Vali Acc: 0.838 Test Loss: 0.693 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6705312728881836
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.672 Vali Acc: 0.844 Test Loss: 0.672 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843743).  Saving model ...
Epoch: 19 cost time: 0.6641533374786377
Epoch: 19, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.681 Vali Acc: 0.847 Test Loss: 0.681 Test Acc: 0.847
Validation loss decreased (-0.843743 --> -0.846868).  Saving model ...
Epoch: 20 cost time: 0.8565688133239746
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.698 Vali Acc: 0.834 Test Loss: 0.698 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.723942756652832
Epoch: 21, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.703 Vali Acc: 0.841 Test Loss: 0.703 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.852757453918457
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.725 Vali Acc: 0.838 Test Loss: 0.725 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7987446784973145
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.743 Vali Acc: 0.838 Test Loss: 0.743 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8298816680908203
Epoch: 24, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.749 Vali Acc: 0.844 Test Loss: 0.749 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8327043056488037
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849993).  Saving model ...
Epoch: 26 cost time: 0.8664455413818359
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 0.8959672451019287
Epoch: 27, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.753 Vali Acc: 0.841 Test Loss: 0.753 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8582816123962402
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.761 Vali Acc: 0.834 Test Loss: 0.761 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7571532726287842
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.772 Vali Acc: 0.838 Test Loss: 0.772 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.771934986114502
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.768 Vali Acc: 0.838 Test Loss: 0.768 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8764901161193848
Epoch: 31, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.781 Vali Acc: 0.841 Test Loss: 0.781 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8334040641784668
Epoch: 32, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.786 Vali Acc: 0.838 Test Loss: 0.786 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7923660278320312
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.756 Vali Acc: 0.847 Test Loss: 0.756 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.806816816329956
Epoch: 34, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7831447124481201
Epoch: 35, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.782 Vali Acc: 0.850 Test Loss: 0.782 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9078223705291748
Epoch: 36, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.796 Vali Acc: 0.847 Test Loss: 0.796 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 99972
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.939988613128662
Epoch: 1, Steps: 8 | Train Loss: 2.132 Vali Loss: 1.825 Vali Acc: 0.338 Test Loss: 1.825 Test Acc: 0.338
Validation loss decreased (inf --> -0.337482).  Saving model ...
Epoch: 2 cost time: 0.8934774398803711
Epoch: 2, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.210 Vali Acc: 0.706 Test Loss: 1.210 Test Acc: 0.706
Validation loss decreased (-0.337482 --> -0.706238).  Saving model ...
Epoch: 3 cost time: 0.8426492214202881
Epoch: 3, Steps: 8 | Train Loss: 0.924 Vali Loss: 0.787 Vali Acc: 0.787 Test Loss: 0.787 Test Acc: 0.787
Validation loss decreased (-0.706238 --> -0.787492).  Saving model ...
Epoch: 4 cost time: 0.8828494548797607
Epoch: 4, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
Validation loss decreased (-0.787492 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 0.9788856506347656
Epoch: 5, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
Validation loss decreased (-0.818744 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 0.8522608280181885
Epoch: 6, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.8386175632476807
Epoch: 7, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7172505855560303
Epoch: 8, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8531081676483154
Epoch: 9, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8804590702056885
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.737053394317627
Epoch: 11, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8320496082305908
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8508167266845703
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8039093017578125
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9712557792663574
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.605 Vali Acc: 0.847 Test Loss: 0.605 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8726718425750732
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 91780
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.163825273513794
Epoch: 1, Steps: 8 | Train Loss: 2.113 Vali Loss: 1.823 Vali Acc: 0.375 Test Loss: 1.823 Test Acc: 0.375
Validation loss decreased (inf --> -0.374982).  Saving model ...
Epoch: 2 cost time: 0.8472082614898682
Epoch: 2, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.216 Vali Acc: 0.706 Test Loss: 1.216 Test Acc: 0.706
Validation loss decreased (-0.374982 --> -0.706238).  Saving model ...
Epoch: 3 cost time: 0.8358917236328125
Epoch: 3, Steps: 8 | Train Loss: 0.932 Vali Loss: 0.791 Vali Acc: 0.794 Test Loss: 0.791 Test Acc: 0.794
Validation loss decreased (-0.706238 --> -0.793742).  Saving model ...
Epoch: 4 cost time: 0.8391237258911133
Epoch: 4, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
Validation loss decreased (-0.793742 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 0.9056684970855713
Epoch: 5, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.821869 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 0.7709543704986572
Epoch: 6, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.8091452121734619
Epoch: 7, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7834217548370361
Epoch: 8, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 0.8983063697814941
Epoch: 9, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.859588623046875
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7387847900390625
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7937750816345215
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8747587203979492
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8007855415344238
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.856886625289917
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.573 Vali Acc: 0.838 Test Loss: 0.573 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8644096851348877
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8099291324615479
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9306659698486328
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.603 Vali Acc: 0.847 Test Loss: 0.603 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 91780
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.700183629989624
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 1.838 Vali Acc: 0.378 Test Loss: 1.838 Test Acc: 0.378
Validation loss decreased (inf --> -0.378107).  Saving model ...
Epoch: 2 cost time: 0.8674211502075195
Epoch: 2, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.251 Vali Acc: 0.703 Test Loss: 1.251 Test Acc: 0.703
Validation loss decreased (-0.378107 --> -0.703112).  Saving model ...
Epoch: 3 cost time: 0.7424347400665283
Epoch: 3, Steps: 8 | Train Loss: 0.977 Vali Loss: 0.829 Vali Acc: 0.791 Test Loss: 0.829 Test Acc: 0.791
Validation loss decreased (-0.703112 --> -0.790617).  Saving model ...
Epoch: 4 cost time: 0.8673031330108643
Epoch: 4, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.627 Vali Acc: 0.812 Test Loss: 0.627 Test Acc: 0.812
Validation loss decreased (-0.790617 --> -0.812494).  Saving model ...
Epoch: 5 cost time: 0.8637368679046631
Epoch: 5, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828120).  Saving model ...
Epoch: 6 cost time: 0.9492373466491699
Epoch: 6, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.7990622520446777
Epoch: 7, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6951735019683838
Epoch: 8, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.6893854141235352
Epoch: 9, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8925604820251465
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.7748270034790039
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.6109693050384521
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7814509868621826
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8306553363800049
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7428979873657227
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9711205959320068
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8489711284637451
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.594 Vali Acc: 0.834 Test Loss: 0.594 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8246583938598633
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8532288074493408
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8823525905609131
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.600 Vali Acc: 0.844 Test Loss: 0.600 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8516843318939209
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.625 Vali Acc: 0.834 Test Loss: 0.625 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 91780
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.882917642593384
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 1.844 Vali Acc: 0.309 Test Loss: 1.844 Test Acc: 0.309
Validation loss decreased (inf --> -0.309357).  Saving model ...
Epoch: 2 cost time: 0.822608232498169
Epoch: 2, Steps: 8 | Train Loss: 1.692 Vali Loss: 1.336 Vali Acc: 0.672 Test Loss: 1.336 Test Acc: 0.672
Validation loss decreased (-0.309357 --> -0.671862).  Saving model ...
Epoch: 3 cost time: 0.868039608001709
Epoch: 3, Steps: 8 | Train Loss: 1.128 Vali Loss: 0.937 Vali Acc: 0.762 Test Loss: 0.937 Test Acc: 0.762
Validation loss decreased (-0.671862 --> -0.762491).  Saving model ...
Epoch: 4 cost time: 0.7870004177093506
Epoch: 4, Steps: 8 | Train Loss: 0.733 Vali Loss: 0.715 Vali Acc: 0.787 Test Loss: 0.715 Test Acc: 0.787
Validation loss decreased (-0.762491 --> -0.787493).  Saving model ...
Epoch: 5 cost time: 0.754399299621582
Epoch: 5, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
Validation loss decreased (-0.787493 --> -0.803119).  Saving model ...
Epoch: 6 cost time: 0.8026013374328613
Epoch: 6, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
Validation loss decreased (-0.803119 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.6669802665710449
Epoch: 7, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8354568481445312
Epoch: 8, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8341867923736572
Epoch: 9, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.823983907699585
Epoch: 10, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 0.8425586223602295
Epoch: 11, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.605 Vali Acc: 0.825 Test Loss: 0.605 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7640008926391602
Epoch: 12, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.595 Vali Acc: 0.847 Test Loss: 0.595 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846869).  Saving model ...
Epoch: 13 cost time: 0.771681547164917
Epoch: 13, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.609 Vali Acc: 0.838 Test Loss: 0.609 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7528340816497803
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.637 Vali Acc: 0.831 Test Loss: 0.637 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.810680627822876
Epoch: 15, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8508141040802002
Epoch: 16, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7962334156036377
Epoch: 17, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.671 Vali Acc: 0.834 Test Loss: 0.671 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8685038089752197
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.674 Vali Acc: 0.838 Test Loss: 0.674 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6203014850616455
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.689 Vali Acc: 0.834 Test Loss: 0.689 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.904329776763916
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.693 Vali Acc: 0.825 Test Loss: 0.693 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.862027645111084
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.735 Vali Acc: 0.822 Test Loss: 0.735 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7325892448425293
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.736 Vali Acc: 0.828 Test Loss: 0.736 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 91780
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8581831455230713
Epoch: 1, Steps: 8 | Train Loss: 2.179 Vali Loss: 1.871 Vali Acc: 0.256 Test Loss: 1.871 Test Acc: 0.256
Validation loss decreased (inf --> -0.256231).  Saving model ...
Epoch: 2 cost time: 0.6850371360778809
Epoch: 2, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.241 Vali Acc: 0.722 Test Loss: 1.241 Test Acc: 0.722
Validation loss decreased (-0.256231 --> -0.721863).  Saving model ...
Epoch: 3 cost time: 0.788729190826416
Epoch: 3, Steps: 8 | Train Loss: 1.001 Vali Loss: 0.771 Vali Acc: 0.794 Test Loss: 0.771 Test Acc: 0.794
Validation loss decreased (-0.721863 --> -0.793742).  Saving model ...
Epoch: 4 cost time: 0.7930736541748047
Epoch: 4, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
Validation loss decreased (-0.793742 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 0.7898232936859131
Epoch: 5, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.818744 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.8262121677398682
Epoch: 6, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 0.7858321666717529
Epoch: 7, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7940864562988281
Epoch: 8, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8540501594543457
Epoch: 9, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.519 Vali Acc: 0.853 Test Loss: 0.519 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.8294544219970703
Epoch: 10, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8427944183349609
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.89420485496521
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8254101276397705
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.591 Vali Acc: 0.834 Test Loss: 0.591 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7882637977600098
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.601 Vali Acc: 0.841 Test Loss: 0.601 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8042535781860352
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 16 cost time: 0.7751362323760986
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8648514747619629
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.614 Vali Acc: 0.853 Test Loss: 0.614 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7207849025726318
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7553310394287109
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.653 Vali Acc: 0.847 Test Loss: 0.653 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8185670375823975
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7572305202484131
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8253974914550781
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7983248233795166
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.847 Test Loss: 0.661 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7655282020568848
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.847 Test Loss: 0.674 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8895938396453857
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.684 Vali Acc: 0.847 Test Loss: 0.684 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 87684
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7528858184814453
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 1.875 Vali Acc: 0.275 Test Loss: 1.875 Test Acc: 0.275
Validation loss decreased (inf --> -0.274981).  Saving model ...
Epoch: 2 cost time: 0.8980467319488525
Epoch: 2, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.253 Vali Acc: 0.706 Test Loss: 1.253 Test Acc: 0.706
Validation loss decreased (-0.274981 --> -0.706237).  Saving model ...
Epoch: 3 cost time: 0.9854385852813721
Epoch: 3, Steps: 8 | Train Loss: 1.002 Vali Loss: 0.786 Vali Acc: 0.797 Test Loss: 0.786 Test Acc: 0.797
Validation loss decreased (-0.706237 --> -0.796867).  Saving model ...
Epoch: 4 cost time: 0.8092849254608154
Epoch: 4, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
Validation loss decreased (-0.796867 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 0.8319351673126221
Epoch: 5, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.821869 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 0.888648509979248
Epoch: 6, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 0.8004961013793945
Epoch: 7, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7353219985961914
Epoch: 8, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7321014404296875
Epoch: 9, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8073818683624268
Epoch: 10, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.575 Vali Acc: 0.838 Test Loss: 0.575 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8089542388916016
Epoch: 11, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9343287944793701
Epoch: 12, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8764777183532715
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.573 Vali Acc: 0.838 Test Loss: 0.573 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7884159088134766
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8228664398193359
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.586 Vali Acc: 0.853 Test Loss: 0.586 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8499889373779297
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.587 Vali Acc: 0.853 Test Loss: 0.587 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 87684
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5329837799072266
Epoch: 1, Steps: 8 | Train Loss: 2.163 Vali Loss: 1.894 Vali Acc: 0.247 Test Loss: 1.894 Test Acc: 0.247
Validation loss decreased (inf --> -0.246856).  Saving model ...
Epoch: 2 cost time: 0.7660877704620361
Epoch: 2, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.287 Vali Acc: 0.713 Test Loss: 1.287 Test Acc: 0.713
Validation loss decreased (-0.246856 --> -0.712487).  Saving model ...
Epoch: 3 cost time: 0.7782309055328369
Epoch: 3, Steps: 8 | Train Loss: 1.036 Vali Loss: 0.822 Vali Acc: 0.791 Test Loss: 0.822 Test Acc: 0.791
Validation loss decreased (-0.712487 --> -0.790617).  Saving model ...
Epoch: 4 cost time: 0.8342270851135254
Epoch: 4, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.620 Vali Acc: 0.816 Test Loss: 0.620 Test Acc: 0.816
Validation loss decreased (-0.790617 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 0.8534727096557617
Epoch: 5, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
Validation loss decreased (-0.815619 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.822277307510376
Epoch: 6, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8364467620849609
Epoch: 7, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.886908769607544
Epoch: 8, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.8567090034484863
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 0.811253547668457
Epoch: 10, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8198161125183105
Epoch: 11, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8377046585083008
Epoch: 12, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 0.7397410869598389
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.573 Vali Acc: 0.834 Test Loss: 0.573 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6927177906036377
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8341915607452393
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8242542743682861
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.589 Vali Acc: 0.859 Test Loss: 0.589 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7939562797546387
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7349662780761719
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.618 Vali Acc: 0.841 Test Loss: 0.618 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.697873592376709
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8040196895599365
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.844 Test Loss: 0.638 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8115510940551758
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8569221496582031
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 87684
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8401851654052734
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 1.939 Vali Acc: 0.225 Test Loss: 1.939 Test Acc: 0.225
Validation loss decreased (inf --> -0.224981).  Saving model ...
Epoch: 2 cost time: 0.7758440971374512
Epoch: 2, Steps: 8 | Train Loss: 1.712 Vali Loss: 1.404 Vali Acc: 0.684 Test Loss: 1.404 Test Acc: 0.684
Validation loss decreased (-0.224981 --> -0.684361).  Saving model ...
Epoch: 3 cost time: 0.8701584339141846
Epoch: 3, Steps: 8 | Train Loss: 1.175 Vali Loss: 0.960 Vali Acc: 0.775 Test Loss: 0.960 Test Acc: 0.775
Validation loss decreased (-0.684361 --> -0.774990).  Saving model ...
Epoch: 4 cost time: 0.88037109375
Epoch: 4, Steps: 8 | Train Loss: 0.738 Vali Loss: 0.732 Vali Acc: 0.781 Test Loss: 0.732 Test Acc: 0.781
Validation loss decreased (-0.774990 --> -0.781243).  Saving model ...
Epoch: 5 cost time: 0.8282465934753418
Epoch: 5, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.635 Vali Acc: 0.797 Test Loss: 0.635 Test Acc: 0.797
Validation loss decreased (-0.781243 --> -0.796869).  Saving model ...
Epoch: 6 cost time: 0.7113649845123291
Epoch: 6, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
Validation loss decreased (-0.796869 --> -0.803119).  Saving model ...
Epoch: 7 cost time: 0.9669163227081299
Epoch: 7, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8200562000274658
Epoch: 8, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
Validation loss decreased (-0.803119 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 0.7725343704223633
Epoch: 9, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7923357486724854
Epoch: 10, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7700791358947754
Epoch: 11, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.641 Vali Acc: 0.831 Test Loss: 0.641 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.836573600769043
Epoch: 12, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840619).  Saving model ...
Epoch: 13 cost time: 0.8182036876678467
Epoch: 13, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.637 Vali Acc: 0.819 Test Loss: 0.637 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8427915573120117
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.643 Vali Acc: 0.825 Test Loss: 0.643 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7555339336395264
Epoch: 15, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 16 cost time: 0.7011449337005615
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6210966110229492
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.685 Vali Acc: 0.828 Test Loss: 0.685 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6861522197723389
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.697 Vali Acc: 0.841 Test Loss: 0.697 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.728165864944458
Epoch: 19, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.691 Vali Acc: 0.834 Test Loss: 0.691 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8663156032562256
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.707 Vali Acc: 0.825 Test Loss: 0.707 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7674083709716797
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.720 Vali Acc: 0.828 Test Loss: 0.720 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8224465847015381
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.725 Vali Acc: 0.831 Test Loss: 0.725 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8133304119110107
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.731 Vali Acc: 0.834 Test Loss: 0.731 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7976861000061035
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.749 Vali Acc: 0.834 Test Loss: 0.749 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7893960475921631
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.759 Vali Acc: 0.838 Test Loss: 0.759 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_ETSformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 87684
model size : 0.96MB
