Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.066819429397583
Epoch: 1, Steps: 13 | Train Loss: 1.076 Vali Loss: 0.877 Vali Acc: 0.550 Test Loss: 0.877 Test Acc: 0.550
Validation loss decreased (inf --> -0.549991).  Saving model ...
Epoch: 2 cost time: 6.263904094696045
Epoch: 2, Steps: 13 | Train Loss: 1.468 Vali Loss: 2.037 Vali Acc: 0.511 Test Loss: 2.037 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.917106628417969
Epoch: 3, Steps: 13 | Train Loss: 1.601 Vali Loss: 2.694 Vali Acc: 0.506 Test Loss: 2.694 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.958472967147827
Epoch: 4, Steps: 13 | Train Loss: 0.902 Vali Loss: 2.106 Vali Acc: 0.511 Test Loss: 2.106 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.720629453659058
Epoch: 5, Steps: 13 | Train Loss: 0.789 Vali Loss: 2.757 Vali Acc: 0.567 Test Loss: 2.757 Test Acc: 0.567
Validation loss decreased (-0.549991 --> -0.566639).  Saving model ...
Epoch: 6 cost time: 6.551963567733765
Epoch: 6, Steps: 13 | Train Loss: 0.912 Vali Loss: 3.498 Vali Acc: 0.522 Test Loss: 3.498 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.871776580810547
Epoch: 7, Steps: 13 | Train Loss: 1.002 Vali Loss: 3.950 Vali Acc: 0.522 Test Loss: 3.950 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.882386684417725
Epoch: 8, Steps: 13 | Train Loss: 1.491 Vali Loss: 3.945 Vali Acc: 0.600 Test Loss: 3.945 Test Acc: 0.600
Validation loss decreased (-0.566639 --> -0.599961).  Saving model ...
Epoch: 9 cost time: 6.829076051712036
Epoch: 9, Steps: 13 | Train Loss: 0.737 Vali Loss: 6.896 Vali Acc: 0.578 Test Loss: 6.896 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.781774520874023
Epoch: 10, Steps: 13 | Train Loss: 1.192 Vali Loss: 5.834 Vali Acc: 0.550 Test Loss: 5.834 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.714240312576294
Epoch: 11, Steps: 13 | Train Loss: 1.339 Vali Loss: 5.744 Vali Acc: 0.550 Test Loss: 5.744 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.619790315628052
Epoch: 12, Steps: 13 | Train Loss: 0.671 Vali Loss: 6.088 Vali Acc: 0.539 Test Loss: 6.088 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.824389219284058
Epoch: 13, Steps: 13 | Train Loss: 1.103 Vali Loss: 11.206 Vali Acc: 0.506 Test Loss: 11.206 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.562339782714844
Epoch: 14, Steps: 13 | Train Loss: 0.897 Vali Loss: 8.285 Vali Acc: 0.500 Test Loss: 8.285 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.508397340774536
Epoch: 15, Steps: 13 | Train Loss: 0.389 Vali Loss: 9.029 Vali Acc: 0.517 Test Loss: 9.029 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.864193677902222
Epoch: 16, Steps: 13 | Train Loss: 0.794 Vali Loss: 9.540 Vali Acc: 0.500 Test Loss: 9.540 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.2057459354400635
Epoch: 17, Steps: 13 | Train Loss: 0.701 Vali Loss: 10.385 Vali Acc: 0.511 Test Loss: 10.385 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.8289031982421875
Epoch: 18, Steps: 13 | Train Loss: 0.500 Vali Loss: 11.892 Vali Acc: 0.500 Test Loss: 11.892 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6
model parameter : 6457946
model size : 34.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.843990087509155
Epoch: 1, Steps: 13 | Train Loss: 1.060 Vali Loss: 0.883 Vali Acc: 0.517 Test Loss: 0.883 Test Acc: 0.517
Validation loss decreased (inf --> -0.516658).  Saving model ...
Epoch: 2 cost time: 6.343503475189209
Epoch: 2, Steps: 13 | Train Loss: 1.493 Vali Loss: 1.795 Vali Acc: 0.506 Test Loss: 1.795 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.633502244949341
Epoch: 3, Steps: 13 | Train Loss: 1.495 Vali Loss: 3.681 Vali Acc: 0.506 Test Loss: 3.681 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.261292457580566
Epoch: 4, Steps: 13 | Train Loss: 1.404 Vali Loss: 1.704 Vali Acc: 0.539 Test Loss: 1.704 Test Acc: 0.539
Validation loss decreased (-0.516658 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 6.158079624176025
Epoch: 5, Steps: 13 | Train Loss: 1.436 Vali Loss: 4.409 Vali Acc: 0.511 Test Loss: 4.409 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.2576820850372314
Epoch: 6, Steps: 13 | Train Loss: 0.780 Vali Loss: 4.337 Vali Acc: 0.550 Test Loss: 4.337 Test Acc: 0.550
Validation loss decreased (-0.538872 --> -0.549957).  Saving model ...
Epoch: 7 cost time: 6.466681003570557
Epoch: 7, Steps: 13 | Train Loss: 1.575 Vali Loss: 3.273 Vali Acc: 0.539 Test Loss: 3.273 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.336040496826172
Epoch: 8, Steps: 13 | Train Loss: 1.349 Vali Loss: 3.871 Vali Acc: 0.561 Test Loss: 3.871 Test Acc: 0.561
Validation loss decreased (-0.549957 --> -0.561072).  Saving model ...
Epoch: 9 cost time: 5.799070358276367
Epoch: 9, Steps: 13 | Train Loss: 1.930 Vali Loss: 6.745 Vali Acc: 0.506 Test Loss: 6.745 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.986745595932007
Epoch: 10, Steps: 13 | Train Loss: 1.468 Vali Loss: 4.229 Vali Acc: 0.544 Test Loss: 4.229 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.991626977920532
Epoch: 11, Steps: 13 | Train Loss: 0.440 Vali Loss: 5.013 Vali Acc: 0.550 Test Loss: 5.013 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.012166738510132
Epoch: 12, Steps: 13 | Train Loss: 0.847 Vali Loss: 7.385 Vali Acc: 0.556 Test Loss: 7.385 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.3417441844940186
Epoch: 13, Steps: 13 | Train Loss: 1.500 Vali Loss: 7.728 Vali Acc: 0.517 Test Loss: 7.728 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.319188594818115
Epoch: 14, Steps: 13 | Train Loss: 1.631 Vali Loss: 10.270 Vali Acc: 0.511 Test Loss: 10.270 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.359618425369263
Epoch: 15, Steps: 13 | Train Loss: 2.091 Vali Loss: 7.044 Vali Acc: 0.517 Test Loss: 7.044 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.066714763641357
Epoch: 16, Steps: 13 | Train Loss: 0.217 Vali Loss: 8.252 Vali Acc: 0.506 Test Loss: 8.252 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.1458728313446045
Epoch: 17, Steps: 13 | Train Loss: 0.089 Vali Loss: 7.164 Vali Acc: 0.494 Test Loss: 7.164 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.695005416870117
Epoch: 18, Steps: 13 | Train Loss: 0.291 Vali Loss: 8.551 Vali Acc: 0.522 Test Loss: 8.551 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 6457946
model size : 34.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.387526035308838
Epoch: 1, Steps: 13 | Train Loss: 1.031 Vali Loss: 0.820 Vali Acc: 0.506 Test Loss: 0.820 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 5.8527162075042725
Epoch: 2, Steps: 13 | Train Loss: 1.106 Vali Loss: 1.249 Vali Acc: 0.494 Test Loss: 1.249 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.012666463851929
Epoch: 3, Steps: 13 | Train Loss: 0.920 Vali Loss: 1.837 Vali Acc: 0.533 Test Loss: 1.837 Test Acc: 0.533
Validation loss decreased (-0.505547 --> -0.533315).  Saving model ...
Epoch: 4 cost time: 6.18267035484314
Epoch: 4, Steps: 13 | Train Loss: 0.833 Vali Loss: 2.532 Vali Acc: 0.522 Test Loss: 2.532 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.900243282318115
Epoch: 5, Steps: 13 | Train Loss: 2.541 Vali Loss: 3.622 Vali Acc: 0.467 Test Loss: 3.622 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.1952924728393555
Epoch: 6, Steps: 13 | Train Loss: 1.671 Vali Loss: 3.460 Vali Acc: 0.506 Test Loss: 3.460 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.665109634399414
Epoch: 7, Steps: 13 | Train Loss: 2.780 Vali Loss: 7.322 Vali Acc: 0.500 Test Loss: 7.322 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.245747089385986
Epoch: 8, Steps: 13 | Train Loss: 4.396 Vali Loss: 5.657 Vali Acc: 0.506 Test Loss: 5.657 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.911844730377197
Epoch: 9, Steps: 13 | Train Loss: 2.117 Vali Loss: 3.858 Vali Acc: 0.522 Test Loss: 3.858 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.731011629104614
Epoch: 10, Steps: 13 | Train Loss: 1.699 Vali Loss: 3.960 Vali Acc: 0.511 Test Loss: 3.960 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.543009996414185
Epoch: 11, Steps: 13 | Train Loss: 0.365 Vali Loss: 4.660 Vali Acc: 0.517 Test Loss: 4.660 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.7699525356292725
Epoch: 12, Steps: 13 | Train Loss: 1.107 Vali Loss: 8.637 Vali Acc: 0.478 Test Loss: 8.637 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.8833327293396
Epoch: 13, Steps: 13 | Train Loss: 1.967 Vali Loss: 7.565 Vali Acc: 0.544 Test Loss: 7.565 Test Acc: 0.544
Validation loss decreased (-0.533315 --> -0.544369).  Saving model ...
Epoch: 14 cost time: 5.446789503097534
Epoch: 14, Steps: 13 | Train Loss: 1.239 Vali Loss: 7.237 Vali Acc: 0.506 Test Loss: 7.237 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.298180818557739
Epoch: 15, Steps: 13 | Train Loss: 0.795 Vali Loss: 8.079 Vali Acc: 0.522 Test Loss: 8.079 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.640091180801392
Epoch: 16, Steps: 13 | Train Loss: 0.359 Vali Loss: 8.402 Vali Acc: 0.511 Test Loss: 8.402 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.118464708328247
Epoch: 17, Steps: 13 | Train Loss: 0.373 Vali Loss: 8.462 Vali Acc: 0.522 Test Loss: 8.462 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.851059198379517
Epoch: 18, Steps: 13 | Train Loss: 0.384 Vali Loss: 11.488 Vali Acc: 0.478 Test Loss: 11.488 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.425858497619629
Epoch: 19, Steps: 13 | Train Loss: 0.583 Vali Loss: 10.648 Vali Acc: 0.467 Test Loss: 10.648 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.604107141494751
Epoch: 20, Steps: 13 | Train Loss: 0.307 Vali Loss: 13.125 Vali Acc: 0.506 Test Loss: 13.125 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.068008899688721
Epoch: 21, Steps: 13 | Train Loss: 0.567 Vali Loss: 12.293 Vali Acc: 0.472 Test Loss: 12.293 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.946672201156616
Epoch: 22, Steps: 13 | Train Loss: 0.463 Vali Loss: 11.656 Vali Acc: 0.467 Test Loss: 11.656 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.722173452377319
Epoch: 23, Steps: 13 | Train Loss: 0.382 Vali Loss: 14.606 Vali Acc: 0.467 Test Loss: 14.606 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 6457946
model size : 34.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.6994123458862305
Epoch: 1, Steps: 13 | Train Loss: 1.033 Vali Loss: 0.881 Vali Acc: 0.506 Test Loss: 0.881 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 5.375865459442139
Epoch: 2, Steps: 13 | Train Loss: 0.957 Vali Loss: 0.999 Vali Acc: 0.528 Test Loss: 0.999 Test Acc: 0.528
Validation loss decreased (-0.505547 --> -0.527768).  Saving model ...
Epoch: 3 cost time: 5.0401458740234375
Epoch: 3, Steps: 13 | Train Loss: 1.152 Vali Loss: 2.843 Vali Acc: 0.500 Test Loss: 2.843 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.046330451965332
Epoch: 4, Steps: 13 | Train Loss: 2.266 Vali Loss: 1.656 Vali Acc: 0.494 Test Loss: 1.656 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.9449334144592285
Epoch: 5, Steps: 13 | Train Loss: 1.138 Vali Loss: 4.984 Vali Acc: 0.511 Test Loss: 4.984 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.232763290405273
Epoch: 6, Steps: 13 | Train Loss: 1.664 Vali Loss: 4.261 Vali Acc: 0.528 Test Loss: 4.261 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.368595123291016
Epoch: 7, Steps: 13 | Train Loss: 2.222 Vali Loss: 2.649 Vali Acc: 0.500 Test Loss: 2.649 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.1310813426971436
Epoch: 8, Steps: 13 | Train Loss: 1.233 Vali Loss: 4.722 Vali Acc: 0.511 Test Loss: 4.722 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.1961753368377686
Epoch: 9, Steps: 13 | Train Loss: 2.195 Vali Loss: 3.914 Vali Acc: 0.550 Test Loss: 3.914 Test Acc: 0.550
Validation loss decreased (-0.527768 --> -0.549961).  Saving model ...
Epoch: 10 cost time: 5.532265901565552
Epoch: 10, Steps: 13 | Train Loss: 1.266 Vali Loss: 5.052 Vali Acc: 0.517 Test Loss: 5.052 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.5213782787323
Epoch: 11, Steps: 13 | Train Loss: 1.309 Vali Loss: 6.371 Vali Acc: 0.456 Test Loss: 6.371 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.434374094009399
Epoch: 12, Steps: 13 | Train Loss: 1.238 Vali Loss: 6.716 Vali Acc: 0.489 Test Loss: 6.716 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.389063358306885
Epoch: 13, Steps: 13 | Train Loss: 2.050 Vali Loss: 7.259 Vali Acc: 0.489 Test Loss: 7.259 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.300631284713745
Epoch: 14, Steps: 13 | Train Loss: 1.589 Vali Loss: 12.131 Vali Acc: 0.500 Test Loss: 12.131 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.503389120101929
Epoch: 15, Steps: 13 | Train Loss: 0.328 Vali Loss: 13.239 Vali Acc: 0.506 Test Loss: 13.239 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.560062408447266
Epoch: 16, Steps: 13 | Train Loss: 1.154 Vali Loss: 9.389 Vali Acc: 0.450 Test Loss: 9.389 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.508216857910156
Epoch: 17, Steps: 13 | Train Loss: 0.654 Vali Loss: 11.203 Vali Acc: 0.461 Test Loss: 11.203 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.013402938842773
Epoch: 18, Steps: 13 | Train Loss: 0.807 Vali Loss: 13.970 Vali Acc: 0.517 Test Loss: 13.970 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.029379367828369
Epoch: 19, Steps: 13 | Train Loss: 0.433 Vali Loss: 11.667 Vali Acc: 0.467 Test Loss: 11.667 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 6457946
model size : 34.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 8.092524766921997
Epoch: 1, Steps: 13 | Train Loss: 1.025 Vali Loss: 1.055 Vali Acc: 0.550 Test Loss: 1.055 Test Acc: 0.550
Validation loss decreased (inf --> -0.549989).  Saving model ...
Epoch: 2 cost time: 5.9684836864471436
Epoch: 2, Steps: 13 | Train Loss: 0.960 Vali Loss: 1.656 Vali Acc: 0.500 Test Loss: 1.656 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.780100107192993
Epoch: 3, Steps: 13 | Train Loss: 1.774 Vali Loss: 1.933 Vali Acc: 0.517 Test Loss: 1.933 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.82063889503479
Epoch: 4, Steps: 13 | Train Loss: 1.676 Vali Loss: 2.895 Vali Acc: 0.528 Test Loss: 2.895 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.307868242263794
Epoch: 5, Steps: 13 | Train Loss: 1.889 Vali Loss: 4.678 Vali Acc: 0.461 Test Loss: 4.678 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.106011867523193
Epoch: 6, Steps: 13 | Train Loss: 1.696 Vali Loss: 5.681 Vali Acc: 0.511 Test Loss: 5.681 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.637670278549194
Epoch: 7, Steps: 13 | Train Loss: 1.236 Vali Loss: 4.043 Vali Acc: 0.550 Test Loss: 4.043 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.981471061706543
Epoch: 8, Steps: 13 | Train Loss: 1.559 Vali Loss: 5.678 Vali Acc: 0.550 Test Loss: 5.678 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.360234975814819
Epoch: 9, Steps: 13 | Train Loss: 0.632 Vali Loss: 7.397 Vali Acc: 0.550 Test Loss: 7.397 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.27391242980957
Epoch: 10, Steps: 13 | Train Loss: 2.960 Vali Loss: 7.007 Vali Acc: 0.517 Test Loss: 7.007 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.1118409633636475
Epoch: 11, Steps: 13 | Train Loss: 6.528 Vali Loss: 7.686 Vali Acc: 0.550 Test Loss: 7.686 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 4360794
model size : 26.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.335495233535767
Epoch: 1, Steps: 13 | Train Loss: 1.039 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 5.956138372421265
Epoch: 2, Steps: 13 | Train Loss: 0.971 Vali Loss: 1.636 Vali Acc: 0.494 Test Loss: 1.636 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5977699756622314
Epoch: 3, Steps: 13 | Train Loss: 1.607 Vali Loss: 2.186 Vali Acc: 0.533 Test Loss: 2.186 Test Acc: 0.533
Validation loss decreased (-0.499989 --> -0.533311).  Saving model ...
Epoch: 4 cost time: 5.561293840408325
Epoch: 4, Steps: 13 | Train Loss: 1.542 Vali Loss: 3.159 Vali Acc: 0.506 Test Loss: 3.159 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.48194146156311
Epoch: 5, Steps: 13 | Train Loss: 1.738 Vali Loss: 3.202 Vali Acc: 0.500 Test Loss: 3.202 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.171595811843872
Epoch: 6, Steps: 13 | Train Loss: 0.987 Vali Loss: 4.662 Vali Acc: 0.533 Test Loss: 4.662 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.053566932678223
Epoch: 7, Steps: 13 | Train Loss: 0.730 Vali Loss: 4.497 Vali Acc: 0.539 Test Loss: 4.497 Test Acc: 0.539
Validation loss decreased (-0.533311 --> -0.538844).  Saving model ...
Epoch: 8 cost time: 5.836881160736084
Epoch: 8, Steps: 13 | Train Loss: 0.794 Vali Loss: 5.170 Vali Acc: 0.517 Test Loss: 5.170 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.272264719009399
Epoch: 9, Steps: 13 | Train Loss: 1.365 Vali Loss: 4.173 Vali Acc: 0.544 Test Loss: 4.173 Test Acc: 0.544
Validation loss decreased (-0.538844 --> -0.544403).  Saving model ...
Epoch: 10 cost time: 5.779804229736328
Epoch: 10, Steps: 13 | Train Loss: 0.635 Vali Loss: 5.298 Vali Acc: 0.561 Test Loss: 5.298 Test Acc: 0.561
Validation loss decreased (-0.544403 --> -0.561058).  Saving model ...
Epoch: 11 cost time: 5.747769355773926
Epoch: 11, Steps: 13 | Train Loss: 0.711 Vali Loss: 9.441 Vali Acc: 0.506 Test Loss: 9.441 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.813567399978638
Epoch: 12, Steps: 13 | Train Loss: 2.447 Vali Loss: 7.542 Vali Acc: 0.533 Test Loss: 7.542 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.072866916656494
Epoch: 13, Steps: 13 | Train Loss: 0.873 Vali Loss: 9.066 Vali Acc: 0.500 Test Loss: 9.066 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.678215026855469
Epoch: 14, Steps: 13 | Train Loss: 1.491 Vali Loss: 14.035 Vali Acc: 0.511 Test Loss: 14.035 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.853107929229736
Epoch: 15, Steps: 13 | Train Loss: 3.824 Vali Loss: 13.044 Vali Acc: 0.500 Test Loss: 13.044 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.830792427062988
Epoch: 16, Steps: 13 | Train Loss: 0.578 Vali Loss: 8.204 Vali Acc: 0.567 Test Loss: 8.204 Test Acc: 0.567
Validation loss decreased (-0.561058 --> -0.566585).  Saving model ...
Epoch: 17 cost time: 6.1165077686309814
Epoch: 17, Steps: 13 | Train Loss: 0.294 Vali Loss: 13.540 Vali Acc: 0.511 Test Loss: 13.540 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.6307172775268555
Epoch: 18, Steps: 13 | Train Loss: 0.594 Vali Loss: 11.100 Vali Acc: 0.517 Test Loss: 11.100 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.77680516242981
Epoch: 19, Steps: 13 | Train Loss: 0.845 Vali Loss: 12.713 Vali Acc: 0.533 Test Loss: 12.713 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.855365991592407
Epoch: 20, Steps: 13 | Train Loss: 0.546 Vali Loss: 10.179 Vali Acc: 0.522 Test Loss: 10.179 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.622561454772949
Epoch: 21, Steps: 13 | Train Loss: 0.692 Vali Loss: 12.505 Vali Acc: 0.489 Test Loss: 12.505 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.6406779289245605
Epoch: 22, Steps: 13 | Train Loss: 0.420 Vali Loss: 16.853 Vali Acc: 0.461 Test Loss: 16.853 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.676127910614014
Epoch: 23, Steps: 13 | Train Loss: 1.229 Vali Loss: 17.034 Vali Acc: 0.483 Test Loss: 17.034 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.72766375541687
Epoch: 24, Steps: 13 | Train Loss: 0.201 Vali Loss: 13.271 Vali Acc: 0.506 Test Loss: 13.271 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.7296764850616455
Epoch: 25, Steps: 13 | Train Loss: 0.366 Vali Loss: 16.434 Vali Acc: 0.511 Test Loss: 16.434 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.895944833755493
Epoch: 26, Steps: 13 | Train Loss: 0.245 Vali Loss: 17.496 Vali Acc: 0.489 Test Loss: 17.496 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 4360794
model size : 26.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.482164144515991
Epoch: 1, Steps: 13 | Train Loss: 1.063 Vali Loss: 1.131 Vali Acc: 0.511 Test Loss: 1.131 Test Acc: 0.511
Validation loss decreased (inf --> -0.511100).  Saving model ...
Epoch: 2 cost time: 4.939681529998779
Epoch: 2, Steps: 13 | Train Loss: 1.003 Vali Loss: 1.694 Vali Acc: 0.489 Test Loss: 1.694 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.066291809082031
Epoch: 3, Steps: 13 | Train Loss: 2.270 Vali Loss: 3.364 Vali Acc: 0.478 Test Loss: 3.364 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.84706974029541
Epoch: 4, Steps: 13 | Train Loss: 2.138 Vali Loss: 2.374 Vali Acc: 0.500 Test Loss: 2.374 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.149770259857178
Epoch: 5, Steps: 13 | Train Loss: 0.660 Vali Loss: 1.814 Vali Acc: 0.544 Test Loss: 1.814 Test Acc: 0.544
Validation loss decreased (-0.511100 --> -0.544426).  Saving model ...
Epoch: 6 cost time: 5.318455696105957
Epoch: 6, Steps: 13 | Train Loss: 1.999 Vali Loss: 3.362 Vali Acc: 0.478 Test Loss: 3.362 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.6020896434783936
Epoch: 7, Steps: 13 | Train Loss: 2.987 Vali Loss: 8.478 Vali Acc: 0.511 Test Loss: 8.478 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.372004270553589
Epoch: 8, Steps: 13 | Train Loss: 2.974 Vali Loss: 5.626 Vali Acc: 0.528 Test Loss: 5.626 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.21124792098999
Epoch: 9, Steps: 13 | Train Loss: 0.805 Vali Loss: 3.880 Vali Acc: 0.550 Test Loss: 3.880 Test Acc: 0.550
Validation loss decreased (-0.544426 --> -0.549961).  Saving model ...
Epoch: 10 cost time: 5.254150867462158
Epoch: 10, Steps: 13 | Train Loss: 0.881 Vali Loss: 10.501 Vali Acc: 0.522 Test Loss: 10.501 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.299907207489014
Epoch: 11, Steps: 13 | Train Loss: 4.971 Vali Loss: 6.930 Vali Acc: 0.461 Test Loss: 6.930 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.4327239990234375
Epoch: 12, Steps: 13 | Train Loss: 2.167 Vali Loss: 8.367 Vali Acc: 0.467 Test Loss: 8.367 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.2808167934417725
Epoch: 13, Steps: 13 | Train Loss: 1.958 Vali Loss: 8.209 Vali Acc: 0.483 Test Loss: 8.209 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.2481184005737305
Epoch: 14, Steps: 13 | Train Loss: 0.951 Vali Loss: 7.322 Vali Acc: 0.556 Test Loss: 7.322 Test Acc: 0.556
Validation loss decreased (-0.549961 --> -0.555482).  Saving model ...
Epoch: 15 cost time: 5.348597288131714
Epoch: 15, Steps: 13 | Train Loss: 0.208 Vali Loss: 8.256 Vali Acc: 0.489 Test Loss: 8.256 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.57293438911438
Epoch: 16, Steps: 13 | Train Loss: 0.283 Vali Loss: 9.359 Vali Acc: 0.517 Test Loss: 9.359 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.39308500289917
Epoch: 17, Steps: 13 | Train Loss: 0.239 Vali Loss: 8.080 Vali Acc: 0.539 Test Loss: 8.080 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.977744817733765
Epoch: 18, Steps: 13 | Train Loss: 0.225 Vali Loss: 8.850 Vali Acc: 0.483 Test Loss: 8.850 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.232653617858887
Epoch: 19, Steps: 13 | Train Loss: 0.411 Vali Loss: 10.591 Vali Acc: 0.461 Test Loss: 10.591 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.8499836921691895
Epoch: 20, Steps: 13 | Train Loss: 0.457 Vali Loss: 10.935 Vali Acc: 0.511 Test Loss: 10.935 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.137776851654053
Epoch: 21, Steps: 13 | Train Loss: 0.636 Vali Loss: 16.042 Vali Acc: 0.500 Test Loss: 16.042 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.938025236129761
Epoch: 22, Steps: 13 | Train Loss: 2.077 Vali Loss: 14.919 Vali Acc: 0.456 Test Loss: 14.919 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.21311092376709
Epoch: 23, Steps: 13 | Train Loss: 0.714 Vali Loss: 14.543 Vali Acc: 0.461 Test Loss: 14.543 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.772197484970093
Epoch: 24, Steps: 13 | Train Loss: 0.943 Vali Loss: 15.007 Vali Acc: 0.456 Test Loss: 15.007 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 4360794
model size : 26.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.543132305145264
Epoch: 1, Steps: 13 | Train Loss: 1.051 Vali Loss: 1.195 Vali Acc: 0.489 Test Loss: 1.195 Test Acc: 0.489
Validation loss decreased (inf --> -0.488877).  Saving model ...
Epoch: 2 cost time: 4.437380790710449
Epoch: 2, Steps: 13 | Train Loss: 1.149 Vali Loss: 1.489 Vali Acc: 0.500 Test Loss: 1.489 Test Acc: 0.500
Validation loss decreased (-0.488877 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 4.618432283401489
Epoch: 3, Steps: 13 | Train Loss: 1.678 Vali Loss: 2.798 Vali Acc: 0.506 Test Loss: 2.798 Test Acc: 0.506
Validation loss decreased (-0.499985 --> -0.505528).  Saving model ...
Epoch: 4 cost time: 4.649298191070557
Epoch: 4, Steps: 13 | Train Loss: 2.285 Vali Loss: 1.689 Vali Acc: 0.500 Test Loss: 1.689 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.095396995544434
Epoch: 5, Steps: 13 | Train Loss: 0.878 Vali Loss: 2.336 Vali Acc: 0.506 Test Loss: 2.336 Test Acc: 0.506
Validation loss decreased (-0.505528 --> -0.505532).  Saving model ...
Epoch: 6 cost time: 4.718240976333618
Epoch: 6, Steps: 13 | Train Loss: 1.604 Vali Loss: 4.869 Vali Acc: 0.517 Test Loss: 4.869 Test Acc: 0.517
Validation loss decreased (-0.505532 --> -0.516618).  Saving model ...
Epoch: 7 cost time: 4.341335773468018
Epoch: 7, Steps: 13 | Train Loss: 1.835 Vali Loss: 7.583 Vali Acc: 0.500 Test Loss: 7.583 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.539748430252075
Epoch: 8, Steps: 13 | Train Loss: 2.870 Vali Loss: 7.289 Vali Acc: 0.489 Test Loss: 7.289 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.759425640106201
Epoch: 9, Steps: 13 | Train Loss: 2.496 Vali Loss: 6.752 Vali Acc: 0.506 Test Loss: 6.752 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.881631135940552
Epoch: 10, Steps: 13 | Train Loss: 3.231 Vali Loss: 4.777 Vali Acc: 0.494 Test Loss: 4.777 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.839303255081177
Epoch: 11, Steps: 13 | Train Loss: 2.120 Vali Loss: 6.276 Vali Acc: 0.517 Test Loss: 6.276 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.633723735809326
Epoch: 12, Steps: 13 | Train Loss: 1.436 Vali Loss: 7.128 Vali Acc: 0.500 Test Loss: 7.128 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.766427516937256
Epoch: 13, Steps: 13 | Train Loss: 1.293 Vali Loss: 8.144 Vali Acc: 0.544 Test Loss: 8.144 Test Acc: 0.544
Validation loss decreased (-0.516618 --> -0.544363).  Saving model ...
Epoch: 14 cost time: 4.636922597885132
Epoch: 14, Steps: 13 | Train Loss: 2.514 Vali Loss: 11.258 Vali Acc: 0.489 Test Loss: 11.258 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.950756788253784
Epoch: 15, Steps: 13 | Train Loss: 3.875 Vali Loss: 9.727 Vali Acc: 0.478 Test Loss: 9.727 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.749864339828491
Epoch: 16, Steps: 13 | Train Loss: 0.806 Vali Loss: 9.098 Vali Acc: 0.489 Test Loss: 9.098 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.562298774719238
Epoch: 17, Steps: 13 | Train Loss: 0.767 Vali Loss: 8.464 Vali Acc: 0.494 Test Loss: 8.464 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.654922962188721
Epoch: 18, Steps: 13 | Train Loss: 0.326 Vali Loss: 14.542 Vali Acc: 0.483 Test Loss: 14.542 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.613240718841553
Epoch: 19, Steps: 13 | Train Loss: 0.906 Vali Loss: 11.497 Vali Acc: 0.433 Test Loss: 11.497 Test Acc: 0.433
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.725618600845337
Epoch: 20, Steps: 13 | Train Loss: 0.566 Vali Loss: 12.053 Vali Acc: 0.456 Test Loss: 12.053 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.457763910293579
Epoch: 21, Steps: 13 | Train Loss: 2.554 Vali Loss: 16.917 Vali Acc: 0.472 Test Loss: 16.917 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.261646270751953
Epoch: 22, Steps: 13 | Train Loss: 1.784 Vali Loss: 17.152 Vali Acc: 0.478 Test Loss: 17.152 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.839122772216797
Epoch: 23, Steps: 13 | Train Loss: 0.348 Vali Loss: 15.935 Vali Acc: 0.456 Test Loss: 15.935 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 4360794
model size : 26.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.9959962368011475
Epoch: 1, Steps: 13 | Train Loss: 1.502 Vali Loss: 0.796 Vali Acc: 0.544 Test Loss: 0.796 Test Acc: 0.544
Validation loss decreased (inf --> -0.544436).  Saving model ...
Epoch: 2 cost time: 5.626204252243042
Epoch: 2, Steps: 13 | Train Loss: 0.971 Vali Loss: 2.010 Vali Acc: 0.506 Test Loss: 2.010 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.012109041213989
Epoch: 3, Steps: 13 | Train Loss: 2.069 Vali Loss: 4.084 Vali Acc: 0.517 Test Loss: 4.084 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.467167854309082
Epoch: 4, Steps: 13 | Train Loss: 2.540 Vali Loss: 3.182 Vali Acc: 0.511 Test Loss: 3.182 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.562518358230591
Epoch: 5, Steps: 13 | Train Loss: 1.286 Vali Loss: 2.668 Vali Acc: 0.483 Test Loss: 2.668 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.651266574859619
Epoch: 6, Steps: 13 | Train Loss: 2.147 Vali Loss: 4.123 Vali Acc: 0.561 Test Loss: 4.123 Test Acc: 0.561
Validation loss decreased (-0.544436 --> -0.561070).  Saving model ...
Epoch: 7 cost time: 6.021291255950928
Epoch: 7, Steps: 13 | Train Loss: 2.005 Vali Loss: 3.924 Vali Acc: 0.522 Test Loss: 3.924 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.618841171264648
Epoch: 8, Steps: 13 | Train Loss: 0.907 Vali Loss: 4.983 Vali Acc: 0.494 Test Loss: 4.983 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.500241994857788
Epoch: 9, Steps: 13 | Train Loss: 0.945 Vali Loss: 4.707 Vali Acc: 0.517 Test Loss: 4.707 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.454744577407837
Epoch: 10, Steps: 13 | Train Loss: 0.669 Vali Loss: 5.751 Vali Acc: 0.528 Test Loss: 5.751 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.620949745178223
Epoch: 11, Steps: 13 | Train Loss: 0.923 Vali Loss: 9.764 Vali Acc: 0.522 Test Loss: 9.764 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.6794867515563965
Epoch: 12, Steps: 13 | Train Loss: 1.951 Vali Loss: 8.548 Vali Acc: 0.494 Test Loss: 8.548 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.554724454879761
Epoch: 13, Steps: 13 | Train Loss: 2.107 Vali Loss: 7.739 Vali Acc: 0.539 Test Loss: 7.739 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.665487289428711
Epoch: 14, Steps: 13 | Train Loss: 0.498 Vali Loss: 8.555 Vali Acc: 0.533 Test Loss: 8.555 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.658992290496826
Epoch: 15, Steps: 13 | Train Loss: 0.425 Vali Loss: 9.235 Vali Acc: 0.539 Test Loss: 9.235 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.836587905883789
Epoch: 16, Steps: 13 | Train Loss: 0.456 Vali Loss: 9.140 Vali Acc: 0.528 Test Loss: 9.140 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 3312218
model size : 22.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.865275144577026
Epoch: 1, Steps: 13 | Train Loss: 1.476 Vali Loss: 0.780 Vali Acc: 0.544 Test Loss: 0.780 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 5.321648120880127
Epoch: 2, Steps: 13 | Train Loss: 0.870 Vali Loss: 1.978 Vali Acc: 0.494 Test Loss: 1.978 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.423973560333252
Epoch: 3, Steps: 13 | Train Loss: 1.152 Vali Loss: 1.500 Vali Acc: 0.506 Test Loss: 1.500 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.104761600494385
Epoch: 4, Steps: 13 | Train Loss: 1.125 Vali Loss: 2.963 Vali Acc: 0.494 Test Loss: 2.963 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.958598613739014
Epoch: 5, Steps: 13 | Train Loss: 1.654 Vali Loss: 4.441 Vali Acc: 0.517 Test Loss: 4.441 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.32977819442749
Epoch: 6, Steps: 13 | Train Loss: 2.344 Vali Loss: 3.445 Vali Acc: 0.561 Test Loss: 3.445 Test Acc: 0.561
Validation loss decreased (-0.544437 --> -0.561077).  Saving model ...
Epoch: 7 cost time: 5.440000534057617
Epoch: 7, Steps: 13 | Train Loss: 1.547 Vali Loss: 3.407 Vali Acc: 0.550 Test Loss: 3.407 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.97253942489624
Epoch: 8, Steps: 13 | Train Loss: 0.936 Vali Loss: 4.726 Vali Acc: 0.500 Test Loss: 4.726 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.107379913330078
Epoch: 9, Steps: 13 | Train Loss: 1.004 Vali Loss: 3.939 Vali Acc: 0.528 Test Loss: 3.939 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.086174249649048
Epoch: 10, Steps: 13 | Train Loss: 2.077 Vali Loss: 6.392 Vali Acc: 0.544 Test Loss: 6.392 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.326305389404297
Epoch: 11, Steps: 13 | Train Loss: 2.288 Vali Loss: 8.310 Vali Acc: 0.500 Test Loss: 8.310 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.37975549697876
Epoch: 12, Steps: 13 | Train Loss: 2.347 Vali Loss: 6.672 Vali Acc: 0.522 Test Loss: 6.672 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.961127996444702
Epoch: 13, Steps: 13 | Train Loss: 0.685 Vali Loss: 6.795 Vali Acc: 0.544 Test Loss: 6.795 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.025759220123291
Epoch: 14, Steps: 13 | Train Loss: 0.888 Vali Loss: 7.411 Vali Acc: 0.522 Test Loss: 7.411 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.897004127502441
Epoch: 15, Steps: 13 | Train Loss: 1.586 Vali Loss: 10.984 Vali Acc: 0.517 Test Loss: 10.984 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.243775129318237
Epoch: 16, Steps: 13 | Train Loss: 1.582 Vali Loss: 12.329 Vali Acc: 0.511 Test Loss: 12.329 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 3312218
model size : 22.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.184399366378784
Epoch: 1, Steps: 13 | Train Loss: 1.448 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 4.596078872680664
Epoch: 2, Steps: 13 | Train Loss: 0.852 Vali Loss: 1.691 Vali Acc: 0.506 Test Loss: 1.691 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.584510803222656
Epoch: 3, Steps: 13 | Train Loss: 1.052 Vali Loss: 1.291 Vali Acc: 0.528 Test Loss: 1.291 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.312783479690552
Epoch: 4, Steps: 13 | Train Loss: 1.000 Vali Loss: 2.800 Vali Acc: 0.506 Test Loss: 2.800 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.104109048843384
Epoch: 5, Steps: 13 | Train Loss: 1.153 Vali Loss: 3.323 Vali Acc: 0.533 Test Loss: 3.323 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.349032878875732
Epoch: 6, Steps: 13 | Train Loss: 3.329 Vali Loss: 3.280 Vali Acc: 0.494 Test Loss: 3.280 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.855105638504028
Epoch: 7, Steps: 13 | Train Loss: 5.157 Vali Loss: 9.827 Vali Acc: 0.511 Test Loss: 9.827 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.772553205490112
Epoch: 8, Steps: 13 | Train Loss: 5.861 Vali Loss: 5.921 Vali Acc: 0.500 Test Loss: 5.921 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.323044776916504
Epoch: 9, Steps: 13 | Train Loss: 1.889 Vali Loss: 4.096 Vali Acc: 0.511 Test Loss: 4.096 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.359025239944458
Epoch: 10, Steps: 13 | Train Loss: 2.157 Vali Loss: 4.500 Vali Acc: 0.506 Test Loss: 4.500 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.612413644790649
Epoch: 11, Steps: 13 | Train Loss: 0.999 Vali Loss: 7.018 Vali Acc: 0.500 Test Loss: 7.018 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 3312218
model size : 22.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.53242564201355
Epoch: 1, Steps: 13 | Train Loss: 1.344 Vali Loss: 0.892 Vali Acc: 0.517 Test Loss: 0.892 Test Acc: 0.517
Validation loss decreased (inf --> -0.516658).  Saving model ...
Epoch: 2 cost time: 4.179139137268066
Epoch: 2, Steps: 13 | Train Loss: 0.979 Vali Loss: 2.939 Vali Acc: 0.494 Test Loss: 2.939 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.180782794952393
Epoch: 3, Steps: 13 | Train Loss: 1.634 Vali Loss: 2.182 Vali Acc: 0.511 Test Loss: 2.182 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.380424737930298
Epoch: 4, Steps: 13 | Train Loss: 2.218 Vali Loss: 2.746 Vali Acc: 0.483 Test Loss: 2.746 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.41735053062439
Epoch: 5, Steps: 13 | Train Loss: 3.017 Vali Loss: 2.334 Vali Acc: 0.539 Test Loss: 2.334 Test Acc: 0.539
Validation loss decreased (-0.516658 --> -0.538866).  Saving model ...
Epoch: 6 cost time: 4.265786170959473
Epoch: 6, Steps: 13 | Train Loss: 1.647 Vali Loss: 3.870 Vali Acc: 0.533 Test Loss: 3.870 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.250127077102661
Epoch: 7, Steps: 13 | Train Loss: 1.902 Vali Loss: 6.274 Vali Acc: 0.533 Test Loss: 6.274 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.173320770263672
Epoch: 8, Steps: 13 | Train Loss: 6.007 Vali Loss: 7.003 Vali Acc: 0.483 Test Loss: 7.003 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.378983497619629
Epoch: 9, Steps: 13 | Train Loss: 2.157 Vali Loss: 3.612 Vali Acc: 0.489 Test Loss: 3.612 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.4430930614471436
Epoch: 10, Steps: 13 | Train Loss: 2.385 Vali Loss: 6.193 Vali Acc: 0.500 Test Loss: 6.193 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.359274625778198
Epoch: 11, Steps: 13 | Train Loss: 0.842 Vali Loss: 4.468 Vali Acc: 0.522 Test Loss: 4.468 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.1466734409332275
Epoch: 12, Steps: 13 | Train Loss: 1.175 Vali Loss: 8.041 Vali Acc: 0.522 Test Loss: 8.041 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.1225831508636475
Epoch: 13, Steps: 13 | Train Loss: 0.903 Vali Loss: 6.071 Vali Acc: 0.494 Test Loss: 6.071 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.406473398208618
Epoch: 14, Steps: 13 | Train Loss: 0.642 Vali Loss: 6.622 Vali Acc: 0.461 Test Loss: 6.622 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.427574396133423
Epoch: 15, Steps: 13 | Train Loss: 0.439 Vali Loss: 7.389 Vali Acc: 0.522 Test Loss: 7.389 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 3312218
model size : 22.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.76919150352478
Epoch: 1, Steps: 13 | Train Loss: 1.151 Vali Loss: 1.614 Vali Acc: 0.500 Test Loss: 1.614 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 5.4687299728393555
Epoch: 2, Steps: 13 | Train Loss: 1.722 Vali Loss: 1.775 Vali Acc: 0.550 Test Loss: 1.775 Test Acc: 0.550
Validation loss decreased (-0.499984 --> -0.549982).  Saving model ...
Epoch: 3 cost time: 4.986320972442627
Epoch: 3, Steps: 13 | Train Loss: 1.241 Vali Loss: 1.554 Vali Acc: 0.511 Test Loss: 1.554 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.072173357009888
Epoch: 4, Steps: 13 | Train Loss: 1.168 Vali Loss: 3.222 Vali Acc: 0.528 Test Loss: 3.222 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.294365406036377
Epoch: 5, Steps: 13 | Train Loss: 1.111 Vali Loss: 3.466 Vali Acc: 0.539 Test Loss: 3.466 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.423724174499512
Epoch: 6, Steps: 13 | Train Loss: 1.249 Vali Loss: 3.563 Vali Acc: 0.539 Test Loss: 3.563 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.324702262878418
Epoch: 7, Steps: 13 | Train Loss: 1.131 Vali Loss: 4.069 Vali Acc: 0.517 Test Loss: 4.069 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.336797714233398
Epoch: 8, Steps: 13 | Train Loss: 1.008 Vali Loss: 9.194 Vali Acc: 0.494 Test Loss: 9.194 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.267388582229614
Epoch: 9, Steps: 13 | Train Loss: 1.617 Vali Loss: 5.032 Vali Acc: 0.539 Test Loss: 5.032 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.350950717926025
Epoch: 10, Steps: 13 | Train Loss: 1.412 Vali Loss: 6.401 Vali Acc: 0.522 Test Loss: 6.401 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.473018407821655
Epoch: 11, Steps: 13 | Train Loss: 1.561 Vali Loss: 7.820 Vali Acc: 0.550 Test Loss: 7.820 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.393364191055298
Epoch: 12, Steps: 13 | Train Loss: 3.828 Vali Loss: 13.478 Vali Acc: 0.533 Test Loss: 13.478 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 2787930
model size : 20.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.59592866897583
Epoch: 1, Steps: 13 | Train Loss: 1.111 Vali Loss: 1.787 Vali Acc: 0.506 Test Loss: 1.787 Test Acc: 0.506
Validation loss decreased (inf --> -0.505538).  Saving model ...
Epoch: 2 cost time: 5.137647390365601
Epoch: 2, Steps: 13 | Train Loss: 1.468 Vali Loss: 2.545 Vali Acc: 0.517 Test Loss: 2.545 Test Acc: 0.517
Validation loss decreased (-0.505538 --> -0.516641).  Saving model ...
Epoch: 3 cost time: 4.954214334487915
Epoch: 3, Steps: 13 | Train Loss: 1.826 Vali Loss: 3.671 Vali Acc: 0.522 Test Loss: 3.671 Test Acc: 0.522
Validation loss decreased (-0.516641 --> -0.522186).  Saving model ...
Epoch: 4 cost time: 4.800633907318115
Epoch: 4, Steps: 13 | Train Loss: 1.874 Vali Loss: 5.465 Vali Acc: 0.500 Test Loss: 5.465 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.6986634731292725
Epoch: 5, Steps: 13 | Train Loss: 2.154 Vali Loss: 3.247 Vali Acc: 0.417 Test Loss: 3.247 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.293532133102417
Epoch: 6, Steps: 13 | Train Loss: 1.270 Vali Loss: 5.652 Vali Acc: 0.483 Test Loss: 5.652 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.116438627243042
Epoch: 7, Steps: 13 | Train Loss: 1.936 Vali Loss: 3.648 Vali Acc: 0.511 Test Loss: 3.648 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.879974365234375
Epoch: 8, Steps: 13 | Train Loss: 1.006 Vali Loss: 5.855 Vali Acc: 0.528 Test Loss: 5.855 Test Acc: 0.528
Validation loss decreased (-0.522186 --> -0.527719).  Saving model ...
Epoch: 9 cost time: 5.011910438537598
Epoch: 9, Steps: 13 | Train Loss: 1.218 Vali Loss: 3.985 Vali Acc: 0.550 Test Loss: 3.985 Test Acc: 0.550
Validation loss decreased (-0.527719 --> -0.549960).  Saving model ...
Epoch: 10 cost time: 5.081819295883179
Epoch: 10, Steps: 13 | Train Loss: 2.010 Vali Loss: 4.652 Vali Acc: 0.539 Test Loss: 4.652 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.937666416168213
Epoch: 11, Steps: 13 | Train Loss: 1.127 Vali Loss: 6.819 Vali Acc: 0.533 Test Loss: 6.819 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.687823057174683
Epoch: 12, Steps: 13 | Train Loss: 2.816 Vali Loss: 12.226 Vali Acc: 0.500 Test Loss: 12.226 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.031822919845581
Epoch: 13, Steps: 13 | Train Loss: 2.063 Vali Loss: 8.099 Vali Acc: 0.556 Test Loss: 8.099 Test Acc: 0.556
Validation loss decreased (-0.549960 --> -0.555475).  Saving model ...
Epoch: 14 cost time: 5.024464130401611
Epoch: 14, Steps: 13 | Train Loss: 0.490 Vali Loss: 8.071 Vali Acc: 0.472 Test Loss: 8.071 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.287980079650879
Epoch: 15, Steps: 13 | Train Loss: 1.298 Vali Loss: 11.886 Vali Acc: 0.533 Test Loss: 11.886 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.284608364105225
Epoch: 16, Steps: 13 | Train Loss: 0.771 Vali Loss: 9.467 Vali Acc: 0.539 Test Loss: 9.467 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.986964702606201
Epoch: 17, Steps: 13 | Train Loss: 1.497 Vali Loss: 13.870 Vali Acc: 0.511 Test Loss: 13.870 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.826843500137329
Epoch: 18, Steps: 13 | Train Loss: 2.155 Vali Loss: 16.714 Vali Acc: 0.494 Test Loss: 16.714 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.09819483757019
Epoch: 19, Steps: 13 | Train Loss: 1.692 Vali Loss: 12.195 Vali Acc: 0.483 Test Loss: 12.195 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.172214031219482
Epoch: 20, Steps: 13 | Train Loss: 2.018 Vali Loss: 13.115 Vali Acc: 0.472 Test Loss: 13.115 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.053942441940308
Epoch: 21, Steps: 13 | Train Loss: 0.195 Vali Loss: 13.816 Vali Acc: 0.561 Test Loss: 13.816 Test Acc: 0.561
Validation loss decreased (-0.555475 --> -0.560973).  Saving model ...
Epoch: 22 cost time: 4.937371253967285
Epoch: 22, Steps: 13 | Train Loss: 1.842 Vali Loss: 15.481 Vali Acc: 0.506 Test Loss: 15.481 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.675826072692871
Epoch: 23, Steps: 13 | Train Loss: 1.164 Vali Loss: 15.307 Vali Acc: 0.467 Test Loss: 15.307 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.08926796913147
Epoch: 24, Steps: 13 | Train Loss: 0.388 Vali Loss: 19.101 Vali Acc: 0.517 Test Loss: 19.101 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.904775381088257
Epoch: 25, Steps: 13 | Train Loss: 0.749 Vali Loss: 18.505 Vali Acc: 0.494 Test Loss: 18.505 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.708080291748047
Epoch: 26, Steps: 13 | Train Loss: 0.603 Vali Loss: 17.649 Vali Acc: 0.522 Test Loss: 17.649 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.72197699546814
Epoch: 27, Steps: 13 | Train Loss: 0.127 Vali Loss: 19.865 Vali Acc: 0.483 Test Loss: 19.865 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.1010191440582275
Epoch: 28, Steps: 13 | Train Loss: 0.781 Vali Loss: 21.601 Vali Acc: 0.500 Test Loss: 21.601 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.041990518569946
Epoch: 29, Steps: 13 | Train Loss: 0.269 Vali Loss: 21.968 Vali Acc: 0.500 Test Loss: 21.968 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.550086498260498
Epoch: 30, Steps: 13 | Train Loss: 0.051 Vali Loss: 25.953 Vali Acc: 0.500 Test Loss: 25.953 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.6813719272613525
Epoch: 31, Steps: 13 | Train Loss: 0.543 Vali Loss: 21.596 Vali Acc: 0.500 Test Loss: 21.596 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 2787930
model size : 20.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.996392726898193
Epoch: 1, Steps: 13 | Train Loss: 1.108 Vali Loss: 1.693 Vali Acc: 0.500 Test Loss: 1.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499983).  Saving model ...
Epoch: 2 cost time: 4.649702787399292
Epoch: 2, Steps: 13 | Train Loss: 1.187 Vali Loss: 3.887 Vali Acc: 0.500 Test Loss: 3.887 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.5282440185546875
Epoch: 3, Steps: 13 | Train Loss: 2.173 Vali Loss: 2.749 Vali Acc: 0.517 Test Loss: 2.749 Test Acc: 0.517
Validation loss decreased (-0.499983 --> -0.516639).  Saving model ...
Epoch: 4 cost time: 4.541809320449829
Epoch: 4, Steps: 13 | Train Loss: 1.380 Vali Loss: 2.242 Vali Acc: 0.528 Test Loss: 2.242 Test Acc: 0.528
Validation loss decreased (-0.516639 --> -0.527755).  Saving model ...
Epoch: 5 cost time: 4.69832181930542
Epoch: 5, Steps: 13 | Train Loss: 0.911 Vali Loss: 2.624 Vali Acc: 0.450 Test Loss: 2.624 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.630773305892944
Epoch: 6, Steps: 13 | Train Loss: 1.197 Vali Loss: 2.452 Vali Acc: 0.489 Test Loss: 2.452 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.673095941543579
Epoch: 7, Steps: 13 | Train Loss: 1.168 Vali Loss: 3.726 Vali Acc: 0.494 Test Loss: 3.726 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.574613809585571
Epoch: 8, Steps: 13 | Train Loss: 1.403 Vali Loss: 8.548 Vali Acc: 0.483 Test Loss: 8.548 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.52431845664978
Epoch: 9, Steps: 13 | Train Loss: 3.708 Vali Loss: 4.515 Vali Acc: 0.517 Test Loss: 4.515 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.503634691238403
Epoch: 10, Steps: 13 | Train Loss: 1.355 Vali Loss: 4.547 Vali Acc: 0.556 Test Loss: 4.547 Test Acc: 0.556
Validation loss decreased (-0.527755 --> -0.555510).  Saving model ...
Epoch: 11 cost time: 4.306713342666626
Epoch: 11, Steps: 13 | Train Loss: 1.233 Vali Loss: 4.566 Vali Acc: 0.511 Test Loss: 4.566 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.958858013153076
Epoch: 12, Steps: 13 | Train Loss: 1.546 Vali Loss: 5.267 Vali Acc: 0.494 Test Loss: 5.267 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.790393590927124
Epoch: 13, Steps: 13 | Train Loss: 1.338 Vali Loss: 6.468 Vali Acc: 0.456 Test Loss: 6.468 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.719628810882568
Epoch: 14, Steps: 13 | Train Loss: 0.774 Vali Loss: 7.109 Vali Acc: 0.506 Test Loss: 7.109 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.489715337753296
Epoch: 15, Steps: 13 | Train Loss: 1.586 Vali Loss: 9.248 Vali Acc: 0.506 Test Loss: 9.248 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.544495105743408
Epoch: 16, Steps: 13 | Train Loss: 0.279 Vali Loss: 10.923 Vali Acc: 0.511 Test Loss: 10.923 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.383682012557983
Epoch: 17, Steps: 13 | Train Loss: 0.992 Vali Loss: 9.467 Vali Acc: 0.511 Test Loss: 9.467 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.745532274246216
Epoch: 18, Steps: 13 | Train Loss: 0.549 Vali Loss: 12.002 Vali Acc: 0.494 Test Loss: 12.002 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.997568368911743
Epoch: 19, Steps: 13 | Train Loss: 0.487 Vali Loss: 11.367 Vali Acc: 0.467 Test Loss: 11.367 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.5746681690216064
Epoch: 20, Steps: 13 | Train Loss: 0.566 Vali Loss: 12.995 Vali Acc: 0.489 Test Loss: 12.995 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 2787930
model size : 20.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.068414211273193
Epoch: 1, Steps: 13 | Train Loss: 1.021 Vali Loss: 2.308 Vali Acc: 0.500 Test Loss: 2.308 Test Acc: 0.500
Validation loss decreased (inf --> -0.499977).  Saving model ...
Epoch: 2 cost time: 4.288623571395874
Epoch: 2, Steps: 13 | Train Loss: 1.343 Vali Loss: 3.235 Vali Acc: 0.500 Test Loss: 3.235 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9921371936798096
Epoch: 3, Steps: 13 | Train Loss: 2.644 Vali Loss: 4.272 Vali Acc: 0.522 Test Loss: 4.272 Test Acc: 0.522
Validation loss decreased (-0.499977 --> -0.522179).  Saving model ...
Epoch: 4 cost time: 3.8874471187591553
Epoch: 4, Steps: 13 | Train Loss: 2.420 Vali Loss: 4.682 Vali Acc: 0.522 Test Loss: 4.682 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.019146680831909
Epoch: 5, Steps: 13 | Train Loss: 1.878 Vali Loss: 1.342 Vali Acc: 0.494 Test Loss: 1.342 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.102054119110107
Epoch: 6, Steps: 13 | Train Loss: 2.146 Vali Loss: 2.188 Vali Acc: 0.528 Test Loss: 2.188 Test Acc: 0.528
Validation loss decreased (-0.522179 --> -0.527756).  Saving model ...
Epoch: 7 cost time: 3.996821403503418
Epoch: 7, Steps: 13 | Train Loss: 1.210 Vali Loss: 4.649 Vali Acc: 0.483 Test Loss: 4.649 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.170755624771118
Epoch: 8, Steps: 13 | Train Loss: 1.539 Vali Loss: 4.477 Vali Acc: 0.467 Test Loss: 4.477 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.062479257583618
Epoch: 9, Steps: 13 | Train Loss: 0.918 Vali Loss: 2.784 Vali Acc: 0.533 Test Loss: 2.784 Test Acc: 0.533
Validation loss decreased (-0.527756 --> -0.533305).  Saving model ...
Epoch: 10 cost time: 3.8967690467834473
Epoch: 10, Steps: 13 | Train Loss: 0.710 Vali Loss: 2.932 Vali Acc: 0.506 Test Loss: 2.932 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8015010356903076
Epoch: 11, Steps: 13 | Train Loss: 1.140 Vali Loss: 4.143 Vali Acc: 0.489 Test Loss: 4.143 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.4419074058532715
Epoch: 12, Steps: 13 | Train Loss: 0.735 Vali Loss: 4.000 Vali Acc: 0.517 Test Loss: 4.000 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.3061230182647705
Epoch: 13, Steps: 13 | Train Loss: 1.252 Vali Loss: 7.672 Vali Acc: 0.472 Test Loss: 7.672 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9186503887176514
Epoch: 14, Steps: 13 | Train Loss: 2.530 Vali Loss: 8.238 Vali Acc: 0.506 Test Loss: 8.238 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.98893141746521
Epoch: 15, Steps: 13 | Train Loss: 1.519 Vali Loss: 16.511 Vali Acc: 0.500 Test Loss: 16.511 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.085456132888794
Epoch: 16, Steps: 13 | Train Loss: 2.046 Vali Loss: 12.178 Vali Acc: 0.472 Test Loss: 12.178 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.371095657348633
Epoch: 17, Steps: 13 | Train Loss: 3.305 Vali Loss: 15.154 Vali Acc: 0.517 Test Loss: 15.154 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.373781442642212
Epoch: 18, Steps: 13 | Train Loss: 2.761 Vali Loss: 11.477 Vali Acc: 0.506 Test Loss: 11.477 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.383088827133179
Epoch: 19, Steps: 13 | Train Loss: 0.857 Vali Loss: 12.581 Vali Acc: 0.461 Test Loss: 12.581 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 2787930
model size : 20.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.310349225997925
Epoch: 1, Steps: 13 | Train Loss: 1.222 Vali Loss: 2.246 Vali Acc: 0.494 Test Loss: 2.246 Test Acc: 0.494
Validation loss decreased (inf --> -0.494422).  Saving model ...
Epoch: 2 cost time: 5.582880258560181
Epoch: 2, Steps: 13 | Train Loss: 1.318 Vali Loss: 1.754 Vali Acc: 0.506 Test Loss: 1.754 Test Acc: 0.506
Validation loss decreased (-0.494422 --> -0.505538).  Saving model ...
Epoch: 3 cost time: 5.472100734710693
Epoch: 3, Steps: 13 | Train Loss: 1.647 Vali Loss: 2.324 Vali Acc: 0.506 Test Loss: 2.324 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.579423666000366
Epoch: 4, Steps: 13 | Train Loss: 1.224 Vali Loss: 2.826 Vali Acc: 0.517 Test Loss: 2.826 Test Acc: 0.517
Validation loss decreased (-0.505538 --> -0.516638).  Saving model ...
Epoch: 5 cost time: 5.535799264907837
Epoch: 5, Steps: 13 | Train Loss: 1.869 Vali Loss: 3.203 Vali Acc: 0.517 Test Loss: 3.203 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.494027376174927
Epoch: 6, Steps: 13 | Train Loss: 1.178 Vali Loss: 4.254 Vali Acc: 0.500 Test Loss: 4.254 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.589845418930054
Epoch: 7, Steps: 13 | Train Loss: 0.636 Vali Loss: 4.444 Vali Acc: 0.494 Test Loss: 4.444 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.341529369354248
Epoch: 8, Steps: 13 | Train Loss: 1.355 Vali Loss: 5.847 Vali Acc: 0.511 Test Loss: 5.847 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.115915775299072
Epoch: 9, Steps: 13 | Train Loss: 3.226 Vali Loss: 7.544 Vali Acc: 0.489 Test Loss: 7.544 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.197077751159668
Epoch: 10, Steps: 13 | Train Loss: 2.312 Vali Loss: 5.943 Vali Acc: 0.528 Test Loss: 5.943 Test Acc: 0.528
Validation loss decreased (-0.516638 --> -0.527718).  Saving model ...
Epoch: 11 cost time: 5.691042900085449
Epoch: 11, Steps: 13 | Train Loss: 1.300 Vali Loss: 10.457 Vali Acc: 0.494 Test Loss: 10.457 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.375426292419434
Epoch: 12, Steps: 13 | Train Loss: 3.987 Vali Loss: 12.998 Vali Acc: 0.506 Test Loss: 12.998 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.09193229675293
Epoch: 13, Steps: 13 | Train Loss: 2.086 Vali Loss: 10.397 Vali Acc: 0.533 Test Loss: 10.397 Test Acc: 0.533
Validation loss decreased (-0.527718 --> -0.533229).  Saving model ...
Epoch: 14 cost time: 5.1303019523620605
Epoch: 14, Steps: 13 | Train Loss: 2.439 Vali Loss: 8.378 Vali Acc: 0.494 Test Loss: 8.378 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.314930438995361
Epoch: 15, Steps: 13 | Train Loss: 0.833 Vali Loss: 12.999 Vali Acc: 0.478 Test Loss: 12.999 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.395687818527222
Epoch: 16, Steps: 13 | Train Loss: 1.714 Vali Loss: 10.428 Vali Acc: 0.522 Test Loss: 10.428 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.76550030708313
Epoch: 17, Steps: 13 | Train Loss: 0.353 Vali Loss: 11.112 Vali Acc: 0.533 Test Loss: 11.112 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.644545793533325
Epoch: 18, Steps: 13 | Train Loss: 0.380 Vali Loss: 13.651 Vali Acc: 0.550 Test Loss: 13.651 Test Acc: 0.550
Validation loss decreased (-0.533229 --> -0.549863).  Saving model ...
Epoch: 19 cost time: 5.608779430389404
Epoch: 19, Steps: 13 | Train Loss: 1.118 Vali Loss: 12.604 Vali Acc: 0.511 Test Loss: 12.604 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.400538682937622
Epoch: 20, Steps: 13 | Train Loss: 0.652 Vali Loss: 12.390 Vali Acc: 0.539 Test Loss: 12.390 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.931639194488525
Epoch: 21, Steps: 13 | Train Loss: 0.357 Vali Loss: 13.568 Vali Acc: 0.528 Test Loss: 13.568 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.390165567398071
Epoch: 22, Steps: 13 | Train Loss: 0.200 Vali Loss: 14.454 Vali Acc: 0.467 Test Loss: 14.454 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.338689804077148
Epoch: 23, Steps: 13 | Train Loss: 0.180 Vali Loss: 15.094 Vali Acc: 0.506 Test Loss: 15.094 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.326917409896851
Epoch: 24, Steps: 13 | Train Loss: 0.161 Vali Loss: 14.261 Vali Acc: 0.528 Test Loss: 14.261 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.6085524559021
Epoch: 25, Steps: 13 | Train Loss: 0.049 Vali Loss: 14.082 Vali Acc: 0.522 Test Loss: 14.082 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.767788887023926
Epoch: 26, Steps: 13 | Train Loss: 0.262 Vali Loss: 21.091 Vali Acc: 0.533 Test Loss: 21.091 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.60169243812561
Epoch: 27, Steps: 13 | Train Loss: 0.747 Vali Loss: 15.289 Vali Acc: 0.544 Test Loss: 15.289 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.439472436904907
Epoch: 28, Steps: 13 | Train Loss: 0.312 Vali Loss: 18.573 Vali Acc: 0.472 Test Loss: 18.573 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 2525786
model size : 19.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.793416976928711
Epoch: 1, Steps: 13 | Train Loss: 1.119 Vali Loss: 1.230 Vali Acc: 0.494 Test Loss: 1.230 Test Acc: 0.494
Validation loss decreased (inf --> -0.494432).  Saving model ...
Epoch: 2 cost time: 4.959896087646484
Epoch: 2, Steps: 13 | Train Loss: 1.372 Vali Loss: 1.627 Vali Acc: 0.444 Test Loss: 1.627 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.082029819488525
Epoch: 3, Steps: 13 | Train Loss: 1.231 Vali Loss: 1.925 Vali Acc: 0.517 Test Loss: 1.925 Test Acc: 0.517
Validation loss decreased (-0.494432 --> -0.516647).  Saving model ...
Epoch: 4 cost time: 5.137244939804077
Epoch: 4, Steps: 13 | Train Loss: 1.448 Vali Loss: 4.989 Vali Acc: 0.500 Test Loss: 4.989 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.963243722915649
Epoch: 5, Steps: 13 | Train Loss: 2.183 Vali Loss: 3.181 Vali Acc: 0.522 Test Loss: 3.181 Test Acc: 0.522
Validation loss decreased (-0.516647 --> -0.522190).  Saving model ...
Epoch: 6 cost time: 5.102012872695923
Epoch: 6, Steps: 13 | Train Loss: 0.854 Vali Loss: 4.665 Vali Acc: 0.528 Test Loss: 4.665 Test Acc: 0.528
Validation loss decreased (-0.522190 --> -0.527731).  Saving model ...
Epoch: 7 cost time: 5.235232353210449
Epoch: 7, Steps: 13 | Train Loss: 2.618 Vali Loss: 6.957 Vali Acc: 0.533 Test Loss: 6.957 Test Acc: 0.533
Validation loss decreased (-0.527731 --> -0.533264).  Saving model ...
Epoch: 8 cost time: 4.929780006408691
Epoch: 8, Steps: 13 | Train Loss: 2.504 Vali Loss: 4.993 Vali Acc: 0.544 Test Loss: 4.993 Test Acc: 0.544
Validation loss decreased (-0.533264 --> -0.544395).  Saving model ...
Epoch: 9 cost time: 4.603497266769409
Epoch: 9, Steps: 13 | Train Loss: 1.842 Vali Loss: 6.918 Vali Acc: 0.517 Test Loss: 6.918 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.66245174407959
Epoch: 10, Steps: 13 | Train Loss: 1.305 Vali Loss: 4.497 Vali Acc: 0.544 Test Loss: 4.497 Test Acc: 0.544
Validation loss decreased (-0.544395 --> -0.544399).  Saving model ...
Epoch: 11 cost time: 5.033137083053589
Epoch: 11, Steps: 13 | Train Loss: 1.295 Vali Loss: 6.062 Vali Acc: 0.483 Test Loss: 6.062 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.769494533538818
Epoch: 12, Steps: 13 | Train Loss: 0.658 Vali Loss: 5.828 Vali Acc: 0.544 Test Loss: 5.828 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.5174949169158936
Epoch: 13, Steps: 13 | Train Loss: 0.990 Vali Loss: 5.483 Vali Acc: 0.544 Test Loss: 5.483 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.711917877197266
Epoch: 14, Steps: 13 | Train Loss: 0.910 Vali Loss: 7.406 Vali Acc: 0.489 Test Loss: 7.406 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.058818340301514
Epoch: 15, Steps: 13 | Train Loss: 0.372 Vali Loss: 7.674 Vali Acc: 0.494 Test Loss: 7.674 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.965502023696899
Epoch: 16, Steps: 13 | Train Loss: 1.519 Vali Loss: 8.248 Vali Acc: 0.539 Test Loss: 8.248 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.0764641761779785
Epoch: 17, Steps: 13 | Train Loss: 1.192 Vali Loss: 10.942 Vali Acc: 0.522 Test Loss: 10.942 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.846671104431152
Epoch: 18, Steps: 13 | Train Loss: 0.679 Vali Loss: 9.747 Vali Acc: 0.533 Test Loss: 9.747 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.838871479034424
Epoch: 19, Steps: 13 | Train Loss: 0.270 Vali Loss: 13.675 Vali Acc: 0.517 Test Loss: 13.675 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.889981031417847
Epoch: 20, Steps: 13 | Train Loss: 1.322 Vali Loss: 10.744 Vali Acc: 0.517 Test Loss: 10.744 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 2525786
model size : 19.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.4696245193481445
Epoch: 1, Steps: 13 | Train Loss: 1.165 Vali Loss: 2.249 Vali Acc: 0.494 Test Loss: 2.249 Test Acc: 0.494
Validation loss decreased (inf --> -0.494422).  Saving model ...
Epoch: 2 cost time: 3.7428388595581055
Epoch: 2, Steps: 13 | Train Loss: 1.333 Vali Loss: 1.495 Vali Acc: 0.500 Test Loss: 1.495 Test Acc: 0.500
Validation loss decreased (-0.494422 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 4.681604862213135
Epoch: 3, Steps: 13 | Train Loss: 1.461 Vali Loss: 2.325 Vali Acc: 0.483 Test Loss: 2.325 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.6239001750946045
Epoch: 4, Steps: 13 | Train Loss: 0.908 Vali Loss: 2.317 Vali Acc: 0.472 Test Loss: 2.317 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.331026077270508
Epoch: 5, Steps: 13 | Train Loss: 2.143 Vali Loss: 2.707 Vali Acc: 0.522 Test Loss: 2.707 Test Acc: 0.522
Validation loss decreased (-0.499985 --> -0.522195).  Saving model ...
Epoch: 6 cost time: 4.555621385574341
Epoch: 6, Steps: 13 | Train Loss: 0.896 Vali Loss: 2.571 Vali Acc: 0.550 Test Loss: 2.571 Test Acc: 0.550
Validation loss decreased (-0.522195 --> -0.549974).  Saving model ...
Epoch: 7 cost time: 4.546763896942139
Epoch: 7, Steps: 13 | Train Loss: 0.921 Vali Loss: 4.328 Vali Acc: 0.511 Test Loss: 4.328 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.776766061782837
Epoch: 8, Steps: 13 | Train Loss: 1.938 Vali Loss: 4.235 Vali Acc: 0.522 Test Loss: 4.235 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.6967408657073975
Epoch: 9, Steps: 13 | Train Loss: 2.568 Vali Loss: 4.986 Vali Acc: 0.533 Test Loss: 4.986 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.572474718093872
Epoch: 10, Steps: 13 | Train Loss: 0.954 Vali Loss: 5.528 Vali Acc: 0.528 Test Loss: 5.528 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.596946954727173
Epoch: 11, Steps: 13 | Train Loss: 0.695 Vali Loss: 4.192 Vali Acc: 0.528 Test Loss: 4.192 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.6518731117248535
Epoch: 12, Steps: 13 | Train Loss: 0.366 Vali Loss: 5.872 Vali Acc: 0.544 Test Loss: 5.872 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.7908241748809814
Epoch: 13, Steps: 13 | Train Loss: 1.027 Vali Loss: 9.194 Vali Acc: 0.500 Test Loss: 9.194 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.829772710800171
Epoch: 14, Steps: 13 | Train Loss: 2.143 Vali Loss: 10.726 Vali Acc: 0.511 Test Loss: 10.726 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.54785943031311
Epoch: 15, Steps: 13 | Train Loss: 2.014 Vali Loss: 10.346 Vali Acc: 0.489 Test Loss: 10.346 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.586444854736328
Epoch: 16, Steps: 13 | Train Loss: 1.191 Vali Loss: 10.931 Vali Acc: 0.478 Test Loss: 10.931 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 2525786
model size : 19.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.926290988922119
Epoch: 1, Steps: 13 | Train Loss: 1.163 Vali Loss: 1.791 Vali Acc: 0.500 Test Loss: 1.791 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
Epoch: 2 cost time: 3.9784626960754395
Epoch: 2, Steps: 13 | Train Loss: 1.236 Vali Loss: 1.216 Vali Acc: 0.511 Test Loss: 1.216 Test Acc: 0.511
Validation loss decreased (-0.499982 --> -0.511099).  Saving model ...
Epoch: 3 cost time: 3.6856486797332764
Epoch: 3, Steps: 13 | Train Loss: 1.338 Vali Loss: 1.659 Vali Acc: 0.517 Test Loss: 1.659 Test Acc: 0.517
Validation loss decreased (-0.511099 --> -0.516650).  Saving model ...
Epoch: 4 cost time: 3.605262279510498
Epoch: 4, Steps: 13 | Train Loss: 1.801 Vali Loss: 1.119 Vali Acc: 0.483 Test Loss: 1.119 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.053603410720825
Epoch: 5, Steps: 13 | Train Loss: 1.108 Vali Loss: 2.707 Vali Acc: 0.483 Test Loss: 2.707 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.148147106170654
Epoch: 6, Steps: 13 | Train Loss: 0.959 Vali Loss: 2.834 Vali Acc: 0.544 Test Loss: 2.834 Test Acc: 0.544
Validation loss decreased (-0.516650 --> -0.544416).  Saving model ...
Epoch: 7 cost time: 3.956516981124878
Epoch: 7, Steps: 13 | Train Loss: 1.775 Vali Loss: 3.181 Vali Acc: 0.522 Test Loss: 3.181 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8065662384033203
Epoch: 8, Steps: 13 | Train Loss: 1.957 Vali Loss: 3.531 Vali Acc: 0.489 Test Loss: 3.531 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.949180841445923
Epoch: 9, Steps: 13 | Train Loss: 1.511 Vali Loss: 5.024 Vali Acc: 0.506 Test Loss: 5.024 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.917327642440796
Epoch: 10, Steps: 13 | Train Loss: 2.684 Vali Loss: 3.966 Vali Acc: 0.489 Test Loss: 3.966 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.102835416793823
Epoch: 11, Steps: 13 | Train Loss: 1.375 Vali Loss: 5.197 Vali Acc: 0.494 Test Loss: 5.197 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.125594615936279
Epoch: 12, Steps: 13 | Train Loss: 1.606 Vali Loss: 4.733 Vali Acc: 0.467 Test Loss: 4.733 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7942776679992676
Epoch: 13, Steps: 13 | Train Loss: 1.611 Vali Loss: 6.693 Vali Acc: 0.489 Test Loss: 6.693 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.9312210083007812
Epoch: 14, Steps: 13 | Train Loss: 1.420 Vali Loss: 10.964 Vali Acc: 0.489 Test Loss: 10.964 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.9690134525299072
Epoch: 15, Steps: 13 | Train Loss: 3.326 Vali Loss: 11.292 Vali Acc: 0.556 Test Loss: 11.292 Test Acc: 0.556
Validation loss decreased (-0.544416 --> -0.555443).  Saving model ...
Epoch: 16 cost time: 4.240776777267456
Epoch: 16, Steps: 13 | Train Loss: 1.594 Vali Loss: 10.487 Vali Acc: 0.467 Test Loss: 10.487 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.148559093475342
Epoch: 17, Steps: 13 | Train Loss: 0.759 Vali Loss: 9.522 Vali Acc: 0.450 Test Loss: 9.522 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.002536058425903
Epoch: 18, Steps: 13 | Train Loss: 0.351 Vali Loss: 11.969 Vali Acc: 0.483 Test Loss: 11.969 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.067805051803589
Epoch: 19, Steps: 13 | Train Loss: 1.227 Vali Loss: 11.670 Vali Acc: 0.489 Test Loss: 11.670 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.112849712371826
Epoch: 20, Steps: 13 | Train Loss: 2.154 Vali Loss: 12.142 Vali Acc: 0.472 Test Loss: 12.142 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.001814842224121
Epoch: 21, Steps: 13 | Train Loss: 0.567 Vali Loss: 12.856 Vali Acc: 0.467 Test Loss: 12.856 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.2140843868255615
Epoch: 22, Steps: 13 | Train Loss: 2.484 Vali Loss: 19.930 Vali Acc: 0.478 Test Loss: 19.930 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.165208339691162
Epoch: 23, Steps: 13 | Train Loss: 0.739 Vali Loss: 19.540 Vali Acc: 0.461 Test Loss: 19.540 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.934539556503296
Epoch: 24, Steps: 13 | Train Loss: 0.923 Vali Loss: 19.458 Vali Acc: 0.483 Test Loss: 19.458 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.804495334625244
Epoch: 25, Steps: 13 | Train Loss: 0.249 Vali Loss: 20.779 Vali Acc: 0.489 Test Loss: 20.779 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 2525786
model size : 19.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 7.507901430130005
Epoch: 1, Steps: 13 | Train Loss: 1.048 Vali Loss: 1.933 Vali Acc: 0.522 Test Loss: 1.933 Test Acc: 0.522
Validation loss decreased (inf --> -0.522203).  Saving model ...
Epoch: 2 cost time: 5.283928155899048
Epoch: 2, Steps: 13 | Train Loss: 1.387 Vali Loss: 1.463 Vali Acc: 0.528 Test Loss: 1.463 Test Acc: 0.528
Validation loss decreased (-0.522203 --> -0.527763).  Saving model ...
Epoch: 3 cost time: 5.281597137451172
Epoch: 3, Steps: 13 | Train Loss: 1.074 Vali Loss: 2.562 Vali Acc: 0.506 Test Loss: 2.562 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.348817586898804
Epoch: 4, Steps: 13 | Train Loss: 1.440 Vali Loss: 6.487 Vali Acc: 0.489 Test Loss: 6.487 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.589225769042969
Epoch: 5, Steps: 13 | Train Loss: 1.836 Vali Loss: 3.009 Vali Acc: 0.556 Test Loss: 3.009 Test Acc: 0.556
Validation loss decreased (-0.527763 --> -0.555525).  Saving model ...
Epoch: 6 cost time: 5.483452320098877
Epoch: 6, Steps: 13 | Train Loss: 1.049 Vali Loss: 3.738 Vali Acc: 0.494 Test Loss: 3.738 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.551844120025635
Epoch: 7, Steps: 13 | Train Loss: 1.070 Vali Loss: 7.678 Vali Acc: 0.461 Test Loss: 7.678 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.533373594284058
Epoch: 8, Steps: 13 | Train Loss: 4.295 Vali Loss: 5.031 Vali Acc: 0.539 Test Loss: 5.031 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.349209547042847
Epoch: 9, Steps: 13 | Train Loss: 1.638 Vali Loss: 6.203 Vali Acc: 0.494 Test Loss: 6.203 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.533797740936279
Epoch: 10, Steps: 13 | Train Loss: 0.988 Vali Loss: 6.341 Vali Acc: 0.533 Test Loss: 6.341 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.298598051071167
Epoch: 11, Steps: 13 | Train Loss: 2.511 Vali Loss: 6.558 Vali Acc: 0.494 Test Loss: 6.558 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.3811070919036865
Epoch: 12, Steps: 13 | Train Loss: 1.375 Vali Loss: 6.843 Vali Acc: 0.528 Test Loss: 6.843 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.332501173019409
Epoch: 13, Steps: 13 | Train Loss: 0.883 Vali Loss: 7.553 Vali Acc: 0.556 Test Loss: 7.553 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.524187326431274
Epoch: 14, Steps: 13 | Train Loss: 2.339 Vali Loss: 10.675 Vali Acc: 0.517 Test Loss: 10.675 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.542932033538818
Epoch: 15, Steps: 13 | Train Loss: 1.744 Vali Loss: 8.831 Vali Acc: 0.511 Test Loss: 8.831 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 2394714
model size : 18.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.274106502532959
Epoch: 1, Steps: 13 | Train Loss: 1.052 Vali Loss: 2.111 Vali Acc: 0.522 Test Loss: 2.111 Test Acc: 0.522
Validation loss decreased (inf --> -0.522201).  Saving model ...
Epoch: 2 cost time: 5.166006088256836
Epoch: 2, Steps: 13 | Train Loss: 1.625 Vali Loss: 3.385 Vali Acc: 0.517 Test Loss: 3.385 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.0512375831604
Epoch: 3, Steps: 13 | Train Loss: 2.023 Vali Loss: 2.534 Vali Acc: 0.528 Test Loss: 2.534 Test Acc: 0.528
Validation loss decreased (-0.522201 --> -0.527752).  Saving model ...
Epoch: 4 cost time: 4.677000522613525
Epoch: 4, Steps: 13 | Train Loss: 1.465 Vali Loss: 1.966 Vali Acc: 0.550 Test Loss: 1.966 Test Acc: 0.550
Validation loss decreased (-0.527752 --> -0.549980).  Saving model ...
Epoch: 5 cost time: 4.698391914367676
Epoch: 5, Steps: 13 | Train Loss: 0.871 Vali Loss: 3.817 Vali Acc: 0.489 Test Loss: 3.817 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.662114381790161
Epoch: 6, Steps: 13 | Train Loss: 2.462 Vali Loss: 5.190 Vali Acc: 0.506 Test Loss: 5.190 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.122618913650513
Epoch: 7, Steps: 13 | Train Loss: 2.042 Vali Loss: 7.573 Vali Acc: 0.467 Test Loss: 7.573 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.96851921081543
Epoch: 8, Steps: 13 | Train Loss: 3.303 Vali Loss: 5.259 Vali Acc: 0.528 Test Loss: 5.259 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.9279303550720215
Epoch: 9, Steps: 13 | Train Loss: 1.928 Vali Loss: 7.086 Vali Acc: 0.472 Test Loss: 7.086 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.700556993484497
Epoch: 10, Steps: 13 | Train Loss: 1.821 Vali Loss: 5.408 Vali Acc: 0.533 Test Loss: 5.408 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.83983039855957
Epoch: 11, Steps: 13 | Train Loss: 0.483 Vali Loss: 5.333 Vali Acc: 0.550 Test Loss: 5.333 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.191044330596924
Epoch: 12, Steps: 13 | Train Loss: 1.376 Vali Loss: 6.976 Vali Acc: 0.533 Test Loss: 6.976 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.3387017250061035
Epoch: 13, Steps: 13 | Train Loss: 0.837 Vali Loss: 6.560 Vali Acc: 0.544 Test Loss: 6.560 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.0167460441589355
Epoch: 14, Steps: 13 | Train Loss: 0.240 Vali Loss: 7.049 Vali Acc: 0.517 Test Loss: 7.049 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 2394714
model size : 18.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 6.379980564117432
Epoch: 1, Steps: 13 | Train Loss: 0.994 Vali Loss: 2.041 Vali Acc: 0.522 Test Loss: 2.041 Test Acc: 0.522
Validation loss decreased (inf --> -0.522202).  Saving model ...
Epoch: 2 cost time: 4.736544609069824
Epoch: 2, Steps: 13 | Train Loss: 1.647 Vali Loss: 3.141 Vali Acc: 0.528 Test Loss: 3.141 Test Acc: 0.528
Validation loss decreased (-0.522202 --> -0.527746).  Saving model ...
Epoch: 3 cost time: 4.534618854522705
Epoch: 3, Steps: 13 | Train Loss: 2.020 Vali Loss: 2.219 Vali Acc: 0.522 Test Loss: 2.219 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.554240703582764
Epoch: 4, Steps: 13 | Train Loss: 1.573 Vali Loss: 1.987 Vali Acc: 0.500 Test Loss: 1.987 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.573221683502197
Epoch: 5, Steps: 13 | Train Loss: 1.259 Vali Loss: 3.684 Vali Acc: 0.506 Test Loss: 3.684 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.753452777862549
Epoch: 6, Steps: 13 | Train Loss: 2.168 Vali Loss: 4.580 Vali Acc: 0.528 Test Loss: 4.580 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.541313171386719
Epoch: 7, Steps: 13 | Train Loss: 1.869 Vali Loss: 3.122 Vali Acc: 0.517 Test Loss: 3.122 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.599267959594727
Epoch: 8, Steps: 13 | Train Loss: 1.801 Vali Loss: 3.992 Vali Acc: 0.511 Test Loss: 3.992 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.3841776847839355
Epoch: 9, Steps: 13 | Train Loss: 0.754 Vali Loss: 5.974 Vali Acc: 0.489 Test Loss: 5.974 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.247022390365601
Epoch: 10, Steps: 13 | Train Loss: 1.053 Vali Loss: 3.017 Vali Acc: 0.533 Test Loss: 3.017 Test Acc: 0.533
Validation loss decreased (-0.527746 --> -0.533303).  Saving model ...
Epoch: 11 cost time: 4.35117506980896
Epoch: 11, Steps: 13 | Train Loss: 0.741 Vali Loss: 4.107 Vali Acc: 0.550 Test Loss: 4.107 Test Acc: 0.550
Validation loss decreased (-0.533303 --> -0.549959).  Saving model ...
Epoch: 12 cost time: 4.667182683944702
Epoch: 12, Steps: 13 | Train Loss: 0.543 Vali Loss: 4.124 Vali Acc: 0.528 Test Loss: 4.124 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.53984808921814
Epoch: 13, Steps: 13 | Train Loss: 2.120 Vali Loss: 9.395 Vali Acc: 0.478 Test Loss: 9.395 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.331748008728027
Epoch: 14, Steps: 13 | Train Loss: 1.203 Vali Loss: 6.136 Vali Acc: 0.489 Test Loss: 6.136 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.412524223327637
Epoch: 15, Steps: 13 | Train Loss: 0.292 Vali Loss: 8.252 Vali Acc: 0.522 Test Loss: 8.252 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.566102981567383
Epoch: 16, Steps: 13 | Train Loss: 0.603 Vali Loss: 7.314 Vali Acc: 0.522 Test Loss: 7.314 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.539074182510376
Epoch: 17, Steps: 13 | Train Loss: 0.692 Vali Loss: 8.796 Vali Acc: 0.467 Test Loss: 8.796 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.5443830490112305
Epoch: 18, Steps: 13 | Train Loss: 0.184 Vali Loss: 7.339 Vali Acc: 0.489 Test Loss: 7.339 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.389440059661865
Epoch: 19, Steps: 13 | Train Loss: 0.695 Vali Loss: 8.585 Vali Acc: 0.467 Test Loss: 8.585 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.319161415100098
Epoch: 20, Steps: 13 | Train Loss: 1.446 Vali Loss: 12.340 Vali Acc: 0.483 Test Loss: 12.340 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.485548973083496
Epoch: 21, Steps: 13 | Train Loss: 0.324 Vali Loss: 16.690 Vali Acc: 0.506 Test Loss: 16.690 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 2394714
model size : 18.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.4670250415802
Epoch: 1, Steps: 13 | Train Loss: 0.982 Vali Loss: 2.016 Vali Acc: 0.522 Test Loss: 2.016 Test Acc: 0.522
Validation loss decreased (inf --> -0.522202).  Saving model ...
Epoch: 2 cost time: 3.7865002155303955
Epoch: 2, Steps: 13 | Train Loss: 1.638 Vali Loss: 3.435 Vali Acc: 0.506 Test Loss: 3.435 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6717231273651123
Epoch: 3, Steps: 13 | Train Loss: 2.247 Vali Loss: 1.586 Vali Acc: 0.511 Test Loss: 1.586 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.935356855392456
Epoch: 4, Steps: 13 | Train Loss: 2.052 Vali Loss: 3.140 Vali Acc: 0.533 Test Loss: 3.140 Test Acc: 0.533
Validation loss decreased (-0.522202 --> -0.533302).  Saving model ...
Epoch: 5 cost time: 3.9902961254119873
Epoch: 5, Steps: 13 | Train Loss: 2.419 Vali Loss: 3.516 Vali Acc: 0.467 Test Loss: 3.516 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.036561965942383
Epoch: 6, Steps: 13 | Train Loss: 1.255 Vali Loss: 1.958 Vali Acc: 0.567 Test Loss: 1.958 Test Acc: 0.567
Validation loss decreased (-0.533302 --> -0.566647).  Saving model ...
Epoch: 7 cost time: 3.768139600753784
Epoch: 7, Steps: 13 | Train Loss: 1.504 Vali Loss: 3.647 Vali Acc: 0.511 Test Loss: 3.647 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.871885061264038
Epoch: 8, Steps: 13 | Train Loss: 1.152 Vali Loss: 4.324 Vali Acc: 0.489 Test Loss: 4.324 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9318320751190186
Epoch: 9, Steps: 13 | Train Loss: 2.092 Vali Loss: 2.728 Vali Acc: 0.439 Test Loss: 2.728 Test Acc: 0.439
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.3234703540802
Epoch: 10, Steps: 13 | Train Loss: 0.711 Vali Loss: 3.719 Vali Acc: 0.506 Test Loss: 3.719 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.276620864868164
Epoch: 11, Steps: 13 | Train Loss: 1.882 Vali Loss: 4.510 Vali Acc: 0.506 Test Loss: 4.510 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9240403175354004
Epoch: 12, Steps: 13 | Train Loss: 1.711 Vali Loss: 6.682 Vali Acc: 0.533 Test Loss: 6.682 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.0503106117248535
Epoch: 13, Steps: 13 | Train Loss: 1.012 Vali Loss: 4.534 Vali Acc: 0.494 Test Loss: 4.534 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.251410484313965
Epoch: 14, Steps: 13 | Train Loss: 1.393 Vali Loss: 7.317 Vali Acc: 0.533 Test Loss: 7.317 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.1266703605651855
Epoch: 15, Steps: 13 | Train Loss: 1.578 Vali Loss: 5.712 Vali Acc: 0.472 Test Loss: 5.712 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.226654767990112
Epoch: 16, Steps: 13 | Train Loss: 1.128 Vali Loss: 7.817 Vali Acc: 0.494 Test Loss: 7.817 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 2394714
model size : 18.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.501868486404419
Epoch: 1, Steps: 13 | Train Loss: 0.830 Vali Loss: 0.766 Vali Acc: 0.489 Test Loss: 0.766 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 3.6708645820617676
Epoch: 2, Steps: 13 | Train Loss: 0.794 Vali Loss: 1.496 Vali Acc: 0.511 Test Loss: 1.496 Test Acc: 0.511
Validation loss decreased (-0.488881 --> -0.511096).  Saving model ...
Epoch: 3 cost time: 4.075068235397339
Epoch: 3, Steps: 13 | Train Loss: 1.212 Vali Loss: 1.820 Vali Acc: 0.494 Test Loss: 1.820 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3437299728393555
Epoch: 4, Steps: 13 | Train Loss: 1.022 Vali Loss: 2.770 Vali Acc: 0.494 Test Loss: 2.770 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.313079357147217
Epoch: 5, Steps: 13 | Train Loss: 1.312 Vali Loss: 2.808 Vali Acc: 0.494 Test Loss: 2.808 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9796104431152344
Epoch: 6, Steps: 13 | Train Loss: 0.591 Vali Loss: 1.935 Vali Acc: 0.511 Test Loss: 1.935 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9286961555480957
Epoch: 7, Steps: 13 | Train Loss: 0.580 Vali Loss: 2.489 Vali Acc: 0.544 Test Loss: 2.489 Test Acc: 0.544
Validation loss decreased (-0.511096 --> -0.544420).  Saving model ...
Epoch: 8 cost time: 3.7882015705108643
Epoch: 8, Steps: 13 | Train Loss: 0.446 Vali Loss: 3.290 Vali Acc: 0.517 Test Loss: 3.290 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.693118095397949
Epoch: 9, Steps: 13 | Train Loss: 0.945 Vali Loss: 2.596 Vali Acc: 0.539 Test Loss: 2.596 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.730221748352051
Epoch: 10, Steps: 13 | Train Loss: 0.820 Vali Loss: 3.815 Vali Acc: 0.550 Test Loss: 3.815 Test Acc: 0.550
Validation loss decreased (-0.544420 --> -0.549962).  Saving model ...
Epoch: 11 cost time: 3.5643868446350098
Epoch: 11, Steps: 13 | Train Loss: 0.380 Vali Loss: 4.848 Vali Acc: 0.489 Test Loss: 4.848 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.787727117538452
Epoch: 12, Steps: 13 | Train Loss: 0.290 Vali Loss: 4.861 Vali Acc: 0.544 Test Loss: 4.861 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.74815034866333
Epoch: 13, Steps: 13 | Train Loss: 0.317 Vali Loss: 3.657 Vali Acc: 0.556 Test Loss: 3.657 Test Acc: 0.556
Validation loss decreased (-0.549962 --> -0.555519).  Saving model ...
Epoch: 14 cost time: 3.66281795501709
Epoch: 14, Steps: 13 | Train Loss: 0.338 Vali Loss: 3.696 Vali Acc: 0.511 Test Loss: 3.696 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7268712520599365
Epoch: 15, Steps: 13 | Train Loss: 0.329 Vali Loss: 5.230 Vali Acc: 0.550 Test Loss: 5.230 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.715190887451172
Epoch: 16, Steps: 13 | Train Loss: 0.608 Vali Loss: 6.241 Vali Acc: 0.522 Test Loss: 6.241 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4347002506256104
Epoch: 17, Steps: 13 | Train Loss: 0.350 Vali Loss: 7.964 Vali Acc: 0.511 Test Loss: 7.964 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.9003076553344727
Epoch: 18, Steps: 13 | Train Loss: 0.493 Vali Loss: 5.390 Vali Acc: 0.528 Test Loss: 5.390 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.948406219482422
Epoch: 19, Steps: 13 | Train Loss: 0.125 Vali Loss: 6.447 Vali Acc: 0.500 Test Loss: 6.447 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.831758737564087
Epoch: 20, Steps: 13 | Train Loss: 0.095 Vali Loss: 7.536 Vali Acc: 0.539 Test Loss: 7.536 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.7220425605773926
Epoch: 21, Steps: 13 | Train Loss: 0.311 Vali Loss: 6.989 Vali Acc: 0.517 Test Loss: 6.989 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.679377555847168
Epoch: 22, Steps: 13 | Train Loss: 0.043 Vali Loss: 7.056 Vali Acc: 0.500 Test Loss: 7.056 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.913344144821167
Epoch: 23, Steps: 13 | Train Loss: 0.074 Vali Loss: 7.499 Vali Acc: 0.517 Test Loss: 7.499 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 2966874
model size : 16.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.051271200180054
Epoch: 1, Steps: 13 | Train Loss: 0.828 Vali Loss: 0.787 Vali Acc: 0.472 Test Loss: 0.787 Test Acc: 0.472
Validation loss decreased (inf --> -0.472214).  Saving model ...
Epoch: 2 cost time: 3.6020374298095703
Epoch: 2, Steps: 13 | Train Loss: 0.791 Vali Loss: 1.354 Vali Acc: 0.506 Test Loss: 1.354 Test Acc: 0.506
Validation loss decreased (-0.472214 --> -0.505542).  Saving model ...
Epoch: 3 cost time: 3.5019631385803223
Epoch: 3, Steps: 13 | Train Loss: 1.227 Vali Loss: 1.741 Vali Acc: 0.500 Test Loss: 1.741 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7785942554473877
Epoch: 4, Steps: 13 | Train Loss: 0.945 Vali Loss: 2.554 Vali Acc: 0.461 Test Loss: 2.554 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.674692153930664
Epoch: 5, Steps: 13 | Train Loss: 0.977 Vali Loss: 1.662 Vali Acc: 0.522 Test Loss: 1.662 Test Acc: 0.522
Validation loss decreased (-0.505542 --> -0.522206).  Saving model ...
Epoch: 6 cost time: 3.411464214324951
Epoch: 6, Steps: 13 | Train Loss: 0.682 Vali Loss: 2.065 Vali Acc: 0.472 Test Loss: 2.065 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.627716064453125
Epoch: 7, Steps: 13 | Train Loss: 0.534 Vali Loss: 1.945 Vali Acc: 0.506 Test Loss: 1.945 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.584766149520874
Epoch: 8, Steps: 13 | Train Loss: 0.367 Vali Loss: 2.591 Vali Acc: 0.533 Test Loss: 2.591 Test Acc: 0.533
Validation loss decreased (-0.522206 --> -0.533307).  Saving model ...
Epoch: 9 cost time: 3.303480625152588
Epoch: 9, Steps: 13 | Train Loss: 0.976 Vali Loss: 2.201 Vali Acc: 0.567 Test Loss: 2.201 Test Acc: 0.567
Validation loss decreased (-0.533307 --> -0.566645).  Saving model ...
Epoch: 10 cost time: 3.664825677871704
Epoch: 10, Steps: 13 | Train Loss: 0.219 Vali Loss: 2.363 Vali Acc: 0.522 Test Loss: 2.363 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7015607357025146
Epoch: 11, Steps: 13 | Train Loss: 0.179 Vali Loss: 2.814 Vali Acc: 0.511 Test Loss: 2.814 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6302285194396973
Epoch: 12, Steps: 13 | Train Loss: 0.320 Vali Loss: 2.869 Vali Acc: 0.539 Test Loss: 2.869 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5806615352630615
Epoch: 13, Steps: 13 | Train Loss: 0.243 Vali Loss: 3.045 Vali Acc: 0.561 Test Loss: 3.045 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5401697158813477
Epoch: 14, Steps: 13 | Train Loss: 0.233 Vali Loss: 3.609 Vali Acc: 0.522 Test Loss: 3.609 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.457484245300293
Epoch: 15, Steps: 13 | Train Loss: 0.184 Vali Loss: 3.358 Vali Acc: 0.517 Test Loss: 3.358 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.737996816635132
Epoch: 16, Steps: 13 | Train Loss: 0.238 Vali Loss: 3.876 Vali Acc: 0.561 Test Loss: 3.876 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.8659920692443848
Epoch: 17, Steps: 13 | Train Loss: 0.425 Vali Loss: 4.234 Vali Acc: 0.517 Test Loss: 4.234 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.7469398975372314
Epoch: 18, Steps: 13 | Train Loss: 0.818 Vali Loss: 8.900 Vali Acc: 0.500 Test Loss: 8.900 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.5203824043273926
Epoch: 19, Steps: 13 | Train Loss: 1.025 Vali Loss: 5.391 Vali Acc: 0.528 Test Loss: 5.391 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 2966874
model size : 16.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.9804346561431885
Epoch: 1, Steps: 13 | Train Loss: 0.826 Vali Loss: 0.797 Vali Acc: 0.456 Test Loss: 0.797 Test Acc: 0.456
Validation loss decreased (inf --> -0.455548).  Saving model ...
Epoch: 2 cost time: 3.0778889656066895
Epoch: 2, Steps: 13 | Train Loss: 0.826 Vali Loss: 1.420 Vali Acc: 0.506 Test Loss: 1.420 Test Acc: 0.506
Validation loss decreased (-0.455548 --> -0.505541).  Saving model ...
Epoch: 3 cost time: 3.0207748413085938
Epoch: 3, Steps: 13 | Train Loss: 1.189 Vali Loss: 1.963 Vali Acc: 0.500 Test Loss: 1.963 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.087214469909668
Epoch: 4, Steps: 13 | Train Loss: 1.092 Vali Loss: 2.580 Vali Acc: 0.489 Test Loss: 2.580 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.276683807373047
Epoch: 5, Steps: 13 | Train Loss: 1.253 Vali Loss: 1.462 Vali Acc: 0.500 Test Loss: 1.462 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3937458992004395
Epoch: 6, Steps: 13 | Train Loss: 0.898 Vali Loss: 2.466 Vali Acc: 0.517 Test Loss: 2.466 Test Acc: 0.517
Validation loss decreased (-0.505541 --> -0.516642).  Saving model ...
Epoch: 7 cost time: 3.3141002655029297
Epoch: 7, Steps: 13 | Train Loss: 0.780 Vali Loss: 1.914 Vali Acc: 0.567 Test Loss: 1.914 Test Acc: 0.567
Validation loss decreased (-0.516642 --> -0.566648).  Saving model ...
Epoch: 8 cost time: 3.1744649410247803
Epoch: 8, Steps: 13 | Train Loss: 0.453 Vali Loss: 1.858 Vali Acc: 0.522 Test Loss: 1.858 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.025075912475586
Epoch: 9, Steps: 13 | Train Loss: 0.489 Vali Loss: 1.985 Vali Acc: 0.544 Test Loss: 1.985 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0813591480255127
Epoch: 10, Steps: 13 | Train Loss: 0.169 Vali Loss: 2.395 Vali Acc: 0.506 Test Loss: 2.395 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.201228618621826
Epoch: 11, Steps: 13 | Train Loss: 0.674 Vali Loss: 4.571 Vali Acc: 0.489 Test Loss: 4.571 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0894551277160645
Epoch: 12, Steps: 13 | Train Loss: 0.443 Vali Loss: 3.352 Vali Acc: 0.522 Test Loss: 3.352 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2112252712249756
Epoch: 13, Steps: 13 | Train Loss: 0.228 Vali Loss: 3.187 Vali Acc: 0.533 Test Loss: 3.187 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.1408958435058594
Epoch: 14, Steps: 13 | Train Loss: 0.265 Vali Loss: 4.891 Vali Acc: 0.489 Test Loss: 4.891 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.0790629386901855
Epoch: 15, Steps: 13 | Train Loss: 0.372 Vali Loss: 4.406 Vali Acc: 0.522 Test Loss: 4.406 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.187182664871216
Epoch: 16, Steps: 13 | Train Loss: 0.132 Vali Loss: 3.893 Vali Acc: 0.472 Test Loss: 3.893 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.143376111984253
Epoch: 17, Steps: 13 | Train Loss: 0.511 Vali Loss: 3.820 Vali Acc: 0.494 Test Loss: 3.820 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 2966874
model size : 16.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.7661449909210205
Epoch: 1, Steps: 13 | Train Loss: 0.810 Vali Loss: 0.797 Vali Acc: 0.467 Test Loss: 0.797 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 3.028251886367798
Epoch: 2, Steps: 13 | Train Loss: 0.883 Vali Loss: 1.493 Vali Acc: 0.506 Test Loss: 1.493 Test Acc: 0.506
Validation loss decreased (-0.466659 --> -0.505541).  Saving model ...
Epoch: 3 cost time: 3.0696804523468018
Epoch: 3, Steps: 13 | Train Loss: 1.235 Vali Loss: 1.600 Vali Acc: 0.500 Test Loss: 1.600 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.958754777908325
Epoch: 4, Steps: 13 | Train Loss: 1.106 Vali Loss: 1.602 Vali Acc: 0.483 Test Loss: 1.602 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.944406747817993
Epoch: 5, Steps: 13 | Train Loss: 1.171 Vali Loss: 1.201 Vali Acc: 0.489 Test Loss: 1.201 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.217214822769165
Epoch: 6, Steps: 13 | Train Loss: 0.856 Vali Loss: 1.618 Vali Acc: 0.489 Test Loss: 1.618 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3826918601989746
Epoch: 7, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.362 Vali Acc: 0.494 Test Loss: 1.362 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1380650997161865
Epoch: 8, Steps: 13 | Train Loss: 0.570 Vali Loss: 1.299 Vali Acc: 0.556 Test Loss: 1.299 Test Acc: 0.556
Validation loss decreased (-0.505541 --> -0.555543).  Saving model ...
Epoch: 9 cost time: 2.999908685684204
Epoch: 9, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.516 Vali Acc: 0.522 Test Loss: 1.516 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9598453044891357
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 2.087 Vali Acc: 0.506 Test Loss: 2.087 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1459460258483887
Epoch: 11, Steps: 13 | Train Loss: 0.290 Vali Loss: 2.429 Vali Acc: 0.522 Test Loss: 2.429 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.347209930419922
Epoch: 12, Steps: 13 | Train Loss: 0.181 Vali Loss: 2.648 Vali Acc: 0.517 Test Loss: 2.648 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2637062072753906
Epoch: 13, Steps: 13 | Train Loss: 0.462 Vali Loss: 3.775 Vali Acc: 0.472 Test Loss: 3.775 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.227001667022705
Epoch: 14, Steps: 13 | Train Loss: 0.307 Vali Loss: 3.398 Vali Acc: 0.539 Test Loss: 3.398 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.0242772102355957
Epoch: 15, Steps: 13 | Train Loss: 0.526 Vali Loss: 3.859 Vali Acc: 0.472 Test Loss: 3.859 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.040848970413208
Epoch: 16, Steps: 13 | Train Loss: 0.529 Vali Loss: 4.641 Vali Acc: 0.517 Test Loss: 4.641 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9976673126220703
Epoch: 17, Steps: 13 | Train Loss: 0.323 Vali Loss: 4.920 Vali Acc: 0.494 Test Loss: 4.920 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.0422048568725586
Epoch: 18, Steps: 13 | Train Loss: 0.185 Vali Loss: 5.163 Vali Acc: 0.506 Test Loss: 5.163 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 2966874
model size : 16.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.088255405426025
Epoch: 1, Steps: 13 | Train Loss: 0.879 Vali Loss: 0.993 Vali Acc: 0.511 Test Loss: 0.993 Test Acc: 0.511
Validation loss decreased (inf --> -0.511101).  Saving model ...
Epoch: 2 cost time: 3.415295362472534
Epoch: 2, Steps: 13 | Train Loss: 0.788 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.435490131378174
Epoch: 3, Steps: 13 | Train Loss: 0.613 Vali Loss: 1.394 Vali Acc: 0.494 Test Loss: 1.394 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3407208919525146
Epoch: 4, Steps: 13 | Train Loss: 0.478 Vali Loss: 1.418 Vali Acc: 0.517 Test Loss: 1.418 Test Acc: 0.517
Validation loss decreased (-0.511101 --> -0.516652).  Saving model ...
Epoch: 5 cost time: 3.532745599746704
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.731 Vali Acc: 0.528 Test Loss: 1.731 Test Acc: 0.528
Validation loss decreased (-0.516652 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 3.5963480472564697
Epoch: 6, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.967 Vali Acc: 0.500 Test Loss: 1.967 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.529815196990967
Epoch: 7, Steps: 13 | Train Loss: 0.314 Vali Loss: 2.815 Vali Acc: 0.489 Test Loss: 2.815 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.286675214767456
Epoch: 8, Steps: 13 | Train Loss: 0.535 Vali Loss: 2.724 Vali Acc: 0.500 Test Loss: 2.724 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3027007579803467
Epoch: 9, Steps: 13 | Train Loss: 0.265 Vali Loss: 2.865 Vali Acc: 0.461 Test Loss: 2.865 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.404538869857788
Epoch: 10, Steps: 13 | Train Loss: 0.566 Vali Loss: 4.002 Vali Acc: 0.522 Test Loss: 4.002 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.704481601715088
Epoch: 11, Steps: 13 | Train Loss: 1.748 Vali Loss: 3.436 Vali Acc: 0.522 Test Loss: 3.436 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.830254077911377
Epoch: 12, Steps: 13 | Train Loss: 1.043 Vali Loss: 5.847 Vali Acc: 0.506 Test Loss: 5.847 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.5562472343444824
Epoch: 13, Steps: 13 | Train Loss: 0.787 Vali Loss: 4.298 Vali Acc: 0.539 Test Loss: 4.298 Test Acc: 0.539
Validation loss decreased (-0.527760 --> -0.538846).  Saving model ...
Epoch: 14 cost time: 3.4754559993743896
Epoch: 14, Steps: 13 | Train Loss: 0.509 Vali Loss: 6.201 Vali Acc: 0.517 Test Loss: 6.201 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.431704044342041
Epoch: 15, Steps: 13 | Train Loss: 0.748 Vali Loss: 5.513 Vali Acc: 0.528 Test Loss: 5.513 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5469841957092285
Epoch: 16, Steps: 13 | Train Loss: 0.832 Vali Loss: 7.890 Vali Acc: 0.494 Test Loss: 7.890 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8005268573760986
Epoch: 17, Steps: 13 | Train Loss: 0.646 Vali Loss: 5.657 Vali Acc: 0.489 Test Loss: 5.657 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.651686668395996
Epoch: 18, Steps: 13 | Train Loss: 0.656 Vali Loss: 6.280 Vali Acc: 0.511 Test Loss: 6.280 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.4860565662384033
Epoch: 19, Steps: 13 | Train Loss: 0.616 Vali Loss: 8.026 Vali Acc: 0.467 Test Loss: 8.026 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.430879592895508
Epoch: 20, Steps: 13 | Train Loss: 0.259 Vali Loss: 7.826 Vali Acc: 0.494 Test Loss: 7.826 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5366241931915283
Epoch: 21, Steps: 13 | Train Loss: 0.135 Vali Loss: 6.530 Vali Acc: 0.506 Test Loss: 6.530 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.45426869392395
Epoch: 22, Steps: 13 | Train Loss: 0.064 Vali Loss: 6.880 Vali Acc: 0.494 Test Loss: 6.880 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.57497501373291
Epoch: 23, Steps: 13 | Train Loss: 0.561 Vali Loss: 12.393 Vali Acc: 0.517 Test Loss: 12.393 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 1918298
model size : 12.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.9261393547058105
Epoch: 1, Steps: 13 | Train Loss: 0.873 Vali Loss: 1.070 Vali Acc: 0.506 Test Loss: 1.070 Test Acc: 0.506
Validation loss decreased (inf --> -0.505545).  Saving model ...
Epoch: 2 cost time: 3.1597769260406494
Epoch: 2, Steps: 13 | Train Loss: 0.772 Vali Loss: 1.183 Vali Acc: 0.494 Test Loss: 1.183 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2984962463378906
Epoch: 3, Steps: 13 | Train Loss: 0.648 Vali Loss: 1.229 Vali Acc: 0.506 Test Loss: 1.229 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.441836357116699
Epoch: 4, Steps: 13 | Train Loss: 0.628 Vali Loss: 1.943 Vali Acc: 0.483 Test Loss: 1.943 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4721686840057373
Epoch: 5, Steps: 13 | Train Loss: 0.768 Vali Loss: 1.416 Vali Acc: 0.506 Test Loss: 1.416 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.3475327491760254
Epoch: 6, Steps: 13 | Train Loss: 0.559 Vali Loss: 2.001 Vali Acc: 0.522 Test Loss: 2.001 Test Acc: 0.522
Validation loss decreased (-0.505545 --> -0.522202).  Saving model ...
Epoch: 7 cost time: 3.3111064434051514
Epoch: 7, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.851 Vali Acc: 0.500 Test Loss: 1.851 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2915499210357666
Epoch: 8, Steps: 13 | Train Loss: 0.429 Vali Loss: 2.288 Vali Acc: 0.544 Test Loss: 2.288 Test Acc: 0.544
Validation loss decreased (-0.522202 --> -0.544422).  Saving model ...
Epoch: 9 cost time: 3.4308085441589355
Epoch: 9, Steps: 13 | Train Loss: 0.698 Vali Loss: 3.173 Vali Acc: 0.528 Test Loss: 3.173 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5140349864959717
Epoch: 10, Steps: 13 | Train Loss: 1.458 Vali Loss: 3.805 Vali Acc: 0.506 Test Loss: 3.805 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.46150803565979
Epoch: 11, Steps: 13 | Train Loss: 0.723 Vali Loss: 3.490 Vali Acc: 0.522 Test Loss: 3.490 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2779324054718018
Epoch: 12, Steps: 13 | Train Loss: 0.236 Vali Loss: 3.972 Vali Acc: 0.478 Test Loss: 3.972 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.247938394546509
Epoch: 13, Steps: 13 | Train Loss: 0.622 Vali Loss: 3.792 Vali Acc: 0.511 Test Loss: 3.792 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.37538480758667
Epoch: 14, Steps: 13 | Train Loss: 0.375 Vali Loss: 3.909 Vali Acc: 0.506 Test Loss: 3.909 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.314802408218384
Epoch: 15, Steps: 13 | Train Loss: 0.155 Vali Loss: 3.472 Vali Acc: 0.528 Test Loss: 3.472 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3419363498687744
Epoch: 16, Steps: 13 | Train Loss: 0.066 Vali Loss: 3.460 Vali Acc: 0.522 Test Loss: 3.460 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.311981201171875
Epoch: 17, Steps: 13 | Train Loss: 0.067 Vali Loss: 5.386 Vali Acc: 0.500 Test Loss: 5.386 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.2290501594543457
Epoch: 18, Steps: 13 | Train Loss: 0.205 Vali Loss: 5.865 Vali Acc: 0.511 Test Loss: 5.865 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 1918298
model size : 12.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.591354131698608
Epoch: 1, Steps: 13 | Train Loss: 0.866 Vali Loss: 1.122 Vali Acc: 0.506 Test Loss: 1.122 Test Acc: 0.506
Validation loss decreased (inf --> -0.505544).  Saving model ...
Epoch: 2 cost time: 2.816723346710205
Epoch: 2, Steps: 13 | Train Loss: 0.814 Vali Loss: 1.940 Vali Acc: 0.494 Test Loss: 1.940 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.582500696182251
Epoch: 3, Steps: 13 | Train Loss: 0.973 Vali Loss: 1.533 Vali Acc: 0.522 Test Loss: 1.533 Test Acc: 0.522
Validation loss decreased (-0.505544 --> -0.522207).  Saving model ...
Epoch: 4 cost time: 2.5659191608428955
Epoch: 4, Steps: 13 | Train Loss: 0.645 Vali Loss: 1.453 Vali Acc: 0.511 Test Loss: 1.453 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9221127033233643
Epoch: 5, Steps: 13 | Train Loss: 0.849 Vali Loss: 2.387 Vali Acc: 0.511 Test Loss: 2.387 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.171415090560913
Epoch: 6, Steps: 13 | Train Loss: 0.787 Vali Loss: 1.449 Vali Acc: 0.533 Test Loss: 1.449 Test Acc: 0.533
Validation loss decreased (-0.522207 --> -0.533319).  Saving model ...
Epoch: 7 cost time: 2.9383339881896973
Epoch: 7, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.769 Vali Acc: 0.494 Test Loss: 1.769 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.858294725418091
Epoch: 8, Steps: 13 | Train Loss: 0.628 Vali Loss: 1.997 Vali Acc: 0.494 Test Loss: 1.997 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7380049228668213
Epoch: 9, Steps: 13 | Train Loss: 0.449 Vali Loss: 2.454 Vali Acc: 0.544 Test Loss: 2.454 Test Acc: 0.544
Validation loss decreased (-0.533319 --> -0.544420).  Saving model ...
Epoch: 10 cost time: 2.7907285690307617
Epoch: 10, Steps: 13 | Train Loss: 0.554 Vali Loss: 2.635 Vali Acc: 0.500 Test Loss: 2.635 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.858304977416992
Epoch: 11, Steps: 13 | Train Loss: 0.117 Vali Loss: 2.670 Vali Acc: 0.500 Test Loss: 2.670 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.985285520553589
Epoch: 12, Steps: 13 | Train Loss: 0.656 Vali Loss: 5.194 Vali Acc: 0.500 Test Loss: 5.194 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0004665851593018
Epoch: 13, Steps: 13 | Train Loss: 0.787 Vali Loss: 3.912 Vali Acc: 0.489 Test Loss: 3.912 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.85371732711792
Epoch: 14, Steps: 13 | Train Loss: 0.259 Vali Loss: 4.344 Vali Acc: 0.478 Test Loss: 4.344 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0027198791503906
Epoch: 15, Steps: 13 | Train Loss: 0.370 Vali Loss: 6.167 Vali Acc: 0.506 Test Loss: 6.167 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.983180046081543
Epoch: 16, Steps: 13 | Train Loss: 0.364 Vali Loss: 4.448 Vali Acc: 0.461 Test Loss: 4.448 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.8960535526275635
Epoch: 17, Steps: 13 | Train Loss: 0.037 Vali Loss: 4.534 Vali Acc: 0.456 Test Loss: 4.534 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.0264945030212402
Epoch: 18, Steps: 13 | Train Loss: 0.077 Vali Loss: 5.834 Vali Acc: 0.511 Test Loss: 5.834 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0106468200683594
Epoch: 19, Steps: 13 | Train Loss: 0.334 Vali Loss: 5.354 Vali Acc: 0.478 Test Loss: 5.354 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 1918298
model size : 12.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.131762504577637
Epoch: 1, Steps: 13 | Train Loss: 0.849 Vali Loss: 1.133 Vali Acc: 0.494 Test Loss: 1.133 Test Acc: 0.494
Validation loss decreased (inf --> -0.494433).  Saving model ...
Epoch: 2 cost time: 2.676213026046753
Epoch: 2, Steps: 13 | Train Loss: 0.865 Vali Loss: 2.051 Vali Acc: 0.500 Test Loss: 2.051 Test Acc: 0.500
Validation loss decreased (-0.494433 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 2.818070888519287
Epoch: 3, Steps: 13 | Train Loss: 1.118 Vali Loss: 1.353 Vali Acc: 0.511 Test Loss: 1.353 Test Acc: 0.511
Validation loss decreased (-0.499979 --> -0.511098).  Saving model ...
Epoch: 4 cost time: 2.9255993366241455
Epoch: 4, Steps: 13 | Train Loss: 0.796 Vali Loss: 1.024 Vali Acc: 0.506 Test Loss: 1.024 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.702779769897461
Epoch: 5, Steps: 13 | Train Loss: 0.609 Vali Loss: 1.208 Vali Acc: 0.461 Test Loss: 1.208 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6659095287323
Epoch: 6, Steps: 13 | Train Loss: 0.801 Vali Loss: 1.424 Vali Acc: 0.478 Test Loss: 1.424 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.619379997253418
Epoch: 7, Steps: 13 | Train Loss: 1.123 Vali Loss: 1.645 Vali Acc: 0.517 Test Loss: 1.645 Test Acc: 0.517
Validation loss decreased (-0.511098 --> -0.516650).  Saving model ...
Epoch: 8 cost time: 2.6807594299316406
Epoch: 8, Steps: 13 | Train Loss: 0.553 Vali Loss: 1.475 Vali Acc: 0.539 Test Loss: 1.475 Test Acc: 0.539
Validation loss decreased (-0.516650 --> -0.538874).  Saving model ...
Epoch: 9 cost time: 2.5290653705596924
Epoch: 9, Steps: 13 | Train Loss: 0.815 Vali Loss: 3.312 Vali Acc: 0.494 Test Loss: 3.312 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.898648977279663
Epoch: 10, Steps: 13 | Train Loss: 0.501 Vali Loss: 1.932 Vali Acc: 0.528 Test Loss: 1.932 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.854463577270508
Epoch: 11, Steps: 13 | Train Loss: 0.666 Vali Loss: 3.381 Vali Acc: 0.517 Test Loss: 3.381 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5935959815979004
Epoch: 12, Steps: 13 | Train Loss: 0.980 Vali Loss: 4.561 Vali Acc: 0.444 Test Loss: 4.561 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.686035633087158
Epoch: 13, Steps: 13 | Train Loss: 0.959 Vali Loss: 3.422 Vali Acc: 0.500 Test Loss: 3.422 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5311756134033203
Epoch: 14, Steps: 13 | Train Loss: 0.291 Vali Loss: 3.880 Vali Acc: 0.417 Test Loss: 3.880 Test Acc: 0.417
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.580475330352783
Epoch: 15, Steps: 13 | Train Loss: 0.336 Vali Loss: 3.758 Vali Acc: 0.417 Test Loss: 3.758 Test Acc: 0.417
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.690157651901245
Epoch: 16, Steps: 13 | Train Loss: 0.683 Vali Loss: 4.128 Vali Acc: 0.478 Test Loss: 4.128 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9125654697418213
Epoch: 17, Steps: 13 | Train Loss: 0.288 Vali Loss: 4.905 Vali Acc: 0.472 Test Loss: 4.905 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8188722133636475
Epoch: 18, Steps: 13 | Train Loss: 0.168 Vali Loss: 4.302 Vali Acc: 0.478 Test Loss: 4.302 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 1918298
model size : 12.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.967391490936279
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.906 Vali Acc: 0.506 Test Loss: 0.906 Test Acc: 0.506
Validation loss decreased (inf --> -0.505546).  Saving model ...
Epoch: 2 cost time: 3.448803663253784
Epoch: 2, Steps: 13 | Train Loss: 0.868 Vali Loss: 1.224 Vali Acc: 0.533 Test Loss: 1.224 Test Acc: 0.533
Validation loss decreased (-0.505546 --> -0.533321).  Saving model ...
Epoch: 3 cost time: 3.4186840057373047
Epoch: 3, Steps: 13 | Train Loss: 0.730 Vali Loss: 1.927 Vali Acc: 0.522 Test Loss: 1.927 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3562393188476562
Epoch: 4, Steps: 13 | Train Loss: 1.360 Vali Loss: 3.461 Vali Acc: 0.494 Test Loss: 3.461 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.429290294647217
Epoch: 5, Steps: 13 | Train Loss: 1.355 Vali Loss: 2.347 Vali Acc: 0.522 Test Loss: 2.347 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.346431016921997
Epoch: 6, Steps: 13 | Train Loss: 0.901 Vali Loss: 3.193 Vali Acc: 0.456 Test Loss: 3.193 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.328190565109253
Epoch: 7, Steps: 13 | Train Loss: 0.737 Vali Loss: 2.901 Vali Acc: 0.489 Test Loss: 2.901 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.426872968673706
Epoch: 8, Steps: 13 | Train Loss: 0.521 Vali Loss: 3.067 Vali Acc: 0.511 Test Loss: 3.067 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4176979064941406
Epoch: 9, Steps: 13 | Train Loss: 0.553 Vali Loss: 3.098 Vali Acc: 0.511 Test Loss: 3.098 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3751542568206787
Epoch: 10, Steps: 13 | Train Loss: 0.337 Vali Loss: 4.041 Vali Acc: 0.522 Test Loss: 4.041 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.4246113300323486
Epoch: 11, Steps: 13 | Train Loss: 0.645 Vali Loss: 4.901 Vali Acc: 0.511 Test Loss: 4.901 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.3230674266815186
Epoch: 12, Steps: 13 | Train Loss: 0.537 Vali Loss: 3.591 Vali Acc: 0.511 Test Loss: 3.591 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1394010
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.789038181304932
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.923 Vali Acc: 0.511 Test Loss: 0.923 Test Acc: 0.511
Validation loss decreased (inf --> -0.511102).  Saving model ...
Epoch: 2 cost time: 2.99898362159729
Epoch: 2, Steps: 13 | Train Loss: 0.949 Vali Loss: 1.342 Vali Acc: 0.489 Test Loss: 1.342 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.999486207962036
Epoch: 3, Steps: 13 | Train Loss: 0.965 Vali Loss: 2.119 Vali Acc: 0.506 Test Loss: 2.119 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0371198654174805
Epoch: 4, Steps: 13 | Train Loss: 1.524 Vali Loss: 1.882 Vali Acc: 0.500 Test Loss: 1.882 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0058841705322266
Epoch: 5, Steps: 13 | Train Loss: 0.998 Vali Loss: 2.171 Vali Acc: 0.506 Test Loss: 2.171 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2189226150512695
Epoch: 6, Steps: 13 | Train Loss: 0.935 Vali Loss: 2.879 Vali Acc: 0.478 Test Loss: 2.879 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.185706377029419
Epoch: 7, Steps: 13 | Train Loss: 0.746 Vali Loss: 2.605 Vali Acc: 0.506 Test Loss: 2.605 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.108938694000244
Epoch: 8, Steps: 13 | Train Loss: 0.501 Vali Loss: 2.663 Vali Acc: 0.483 Test Loss: 2.663 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.109863519668579
Epoch: 9, Steps: 13 | Train Loss: 0.333 Vali Loss: 2.303 Vali Acc: 0.567 Test Loss: 2.303 Test Acc: 0.567
Validation loss decreased (-0.511102 --> -0.566644).  Saving model ...
Epoch: 10 cost time: 3.1787190437316895
Epoch: 10, Steps: 13 | Train Loss: 0.156 Vali Loss: 2.705 Vali Acc: 0.511 Test Loss: 2.705 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.150073766708374
Epoch: 11, Steps: 13 | Train Loss: 0.737 Vali Loss: 5.606 Vali Acc: 0.506 Test Loss: 5.606 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.317762851715088
Epoch: 12, Steps: 13 | Train Loss: 0.704 Vali Loss: 2.776 Vali Acc: 0.539 Test Loss: 2.776 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.323176145553589
Epoch: 13, Steps: 13 | Train Loss: 0.646 Vali Loss: 5.632 Vali Acc: 0.489 Test Loss: 5.632 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2121684551239014
Epoch: 14, Steps: 13 | Train Loss: 0.777 Vali Loss: 5.255 Vali Acc: 0.517 Test Loss: 5.255 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.086719036102295
Epoch: 15, Steps: 13 | Train Loss: 0.392 Vali Loss: 5.494 Vali Acc: 0.544 Test Loss: 5.494 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.0593063831329346
Epoch: 16, Steps: 13 | Train Loss: 0.346 Vali Loss: 3.881 Vali Acc: 0.522 Test Loss: 3.881 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1923270225524902
Epoch: 17, Steps: 13 | Train Loss: 0.173 Vali Loss: 4.953 Vali Acc: 0.500 Test Loss: 4.953 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.2192482948303223
Epoch: 18, Steps: 13 | Train Loss: 0.335 Vali Loss: 4.596 Vali Acc: 0.489 Test Loss: 4.596 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2779200077056885
Epoch: 19, Steps: 13 | Train Loss: 0.111 Vali Loss: 4.674 Vali Acc: 0.500 Test Loss: 4.674 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 1394010
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.644996166229248
Epoch: 1, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.934 Vali Acc: 0.494 Test Loss: 0.934 Test Acc: 0.494
Validation loss decreased (inf --> -0.494435).  Saving model ...
Epoch: 2 cost time: 2.7727177143096924
Epoch: 2, Steps: 13 | Train Loss: 0.969 Vali Loss: 1.399 Vali Acc: 0.500 Test Loss: 1.399 Test Acc: 0.500
Validation loss decreased (-0.494435 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 2.749084234237671
Epoch: 3, Steps: 13 | Train Loss: 1.056 Vali Loss: 1.830 Vali Acc: 0.506 Test Loss: 1.830 Test Acc: 0.506
Validation loss decreased (-0.499986 --> -0.505537).  Saving model ...
Epoch: 4 cost time: 2.777374029159546
Epoch: 4, Steps: 13 | Train Loss: 1.427 Vali Loss: 1.989 Vali Acc: 0.522 Test Loss: 1.989 Test Acc: 0.522
Validation loss decreased (-0.505537 --> -0.522202).  Saving model ...
Epoch: 5 cost time: 2.932969570159912
Epoch: 5, Steps: 13 | Train Loss: 1.138 Vali Loss: 1.551 Vali Acc: 0.522 Test Loss: 1.551 Test Acc: 0.522
Validation loss decreased (-0.522202 --> -0.522207).  Saving model ...
Epoch: 6 cost time: 2.813669443130493
Epoch: 6, Steps: 13 | Train Loss: 0.988 Vali Loss: 2.768 Vali Acc: 0.472 Test Loss: 2.768 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.770385503768921
Epoch: 7, Steps: 13 | Train Loss: 0.800 Vali Loss: 2.717 Vali Acc: 0.506 Test Loss: 2.717 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7392849922180176
Epoch: 8, Steps: 13 | Train Loss: 0.696 Vali Loss: 2.784 Vali Acc: 0.528 Test Loss: 2.784 Test Acc: 0.528
Validation loss decreased (-0.522207 --> -0.527750).  Saving model ...
Epoch: 9 cost time: 2.6517343521118164
Epoch: 9, Steps: 13 | Train Loss: 0.499 Vali Loss: 2.653 Vali Acc: 0.550 Test Loss: 2.653 Test Acc: 0.550
Validation loss decreased (-0.527750 --> -0.549973).  Saving model ...
Epoch: 10 cost time: 2.857595682144165
Epoch: 10, Steps: 13 | Train Loss: 0.366 Vali Loss: 2.357 Vali Acc: 0.583 Test Loss: 2.357 Test Acc: 0.583
Validation loss decreased (-0.549973 --> -0.583310).  Saving model ...
Epoch: 11 cost time: 2.8991541862487793
Epoch: 11, Steps: 13 | Train Loss: 0.363 Vali Loss: 3.022 Vali Acc: 0.544 Test Loss: 3.022 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.760067939758301
Epoch: 12, Steps: 13 | Train Loss: 0.473 Vali Loss: 2.671 Vali Acc: 0.522 Test Loss: 2.671 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4734396934509277
Epoch: 13, Steps: 13 | Train Loss: 0.214 Vali Loss: 2.517 Vali Acc: 0.544 Test Loss: 2.517 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7216548919677734
Epoch: 14, Steps: 13 | Train Loss: 0.435 Vali Loss: 3.366 Vali Acc: 0.494 Test Loss: 3.366 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8129706382751465
Epoch: 15, Steps: 13 | Train Loss: 1.178 Vali Loss: 7.136 Vali Acc: 0.506 Test Loss: 7.136 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7784249782562256
Epoch: 16, Steps: 13 | Train Loss: 1.012 Vali Loss: 4.715 Vali Acc: 0.544 Test Loss: 4.715 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9863297939300537
Epoch: 17, Steps: 13 | Train Loss: 0.172 Vali Loss: 4.120 Vali Acc: 0.550 Test Loss: 4.120 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.9918248653411865
Epoch: 18, Steps: 13 | Train Loss: 0.134 Vali Loss: 4.340 Vali Acc: 0.517 Test Loss: 4.340 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7530434131622314
Epoch: 19, Steps: 13 | Train Loss: 0.101 Vali Loss: 4.377 Vali Acc: 0.528 Test Loss: 4.377 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8035430908203125
Epoch: 20, Steps: 13 | Train Loss: 0.208 Vali Loss: 8.728 Vali Acc: 0.494 Test Loss: 8.728 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 1394010
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.325593948364258
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.849 Vali Acc: 0.500 Test Loss: 0.849 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.672391176223755
Epoch: 2, Steps: 13 | Train Loss: 0.930 Vali Loss: 1.534 Vali Acc: 0.511 Test Loss: 1.534 Test Acc: 0.511
Validation loss decreased (-0.499992 --> -0.511096).  Saving model ...
Epoch: 3 cost time: 2.5336389541625977
Epoch: 3, Steps: 13 | Train Loss: 1.445 Vali Loss: 1.217 Vali Acc: 0.522 Test Loss: 1.217 Test Acc: 0.522
Validation loss decreased (-0.511096 --> -0.522210).  Saving model ...
Epoch: 4 cost time: 2.575991153717041
Epoch: 4, Steps: 13 | Train Loss: 1.815 Vali Loss: 1.971 Vali Acc: 0.506 Test Loss: 1.971 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.668208599090576
Epoch: 5, Steps: 13 | Train Loss: 1.104 Vali Loss: 1.360 Vali Acc: 0.467 Test Loss: 1.360 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5066912174224854
Epoch: 6, Steps: 13 | Train Loss: 1.118 Vali Loss: 1.369 Vali Acc: 0.506 Test Loss: 1.369 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.565938949584961
Epoch: 7, Steps: 13 | Train Loss: 0.742 Vali Loss: 1.699 Vali Acc: 0.517 Test Loss: 1.699 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.588754177093506
Epoch: 8, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.670 Vali Acc: 0.522 Test Loss: 1.670 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3567371368408203
Epoch: 9, Steps: 13 | Train Loss: 0.698 Vali Loss: 1.751 Vali Acc: 0.528 Test Loss: 1.751 Test Acc: 0.528
Validation loss decreased (-0.522210 --> -0.527760).  Saving model ...
Epoch: 10 cost time: 2.324061155319214
Epoch: 10, Steps: 13 | Train Loss: 1.299 Vali Loss: 2.171 Vali Acc: 0.522 Test Loss: 2.171 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3673272132873535
Epoch: 11, Steps: 13 | Train Loss: 0.929 Vali Loss: 3.157 Vali Acc: 0.456 Test Loss: 3.157 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6435019969940186
Epoch: 12, Steps: 13 | Train Loss: 0.304 Vali Loss: 2.347 Vali Acc: 0.522 Test Loss: 2.347 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.600527763366699
Epoch: 13, Steps: 13 | Train Loss: 0.205 Vali Loss: 2.480 Vali Acc: 0.489 Test Loss: 2.480 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.674752950668335
Epoch: 14, Steps: 13 | Train Loss: 0.225 Vali Loss: 3.887 Vali Acc: 0.506 Test Loss: 3.887 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.60815691947937
Epoch: 15, Steps: 13 | Train Loss: 0.929 Vali Loss: 4.509 Vali Acc: 0.511 Test Loss: 4.509 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.701221227645874
Epoch: 16, Steps: 13 | Train Loss: 0.221 Vali Loss: 3.409 Vali Acc: 0.517 Test Loss: 3.409 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5982296466827393
Epoch: 17, Steps: 13 | Train Loss: 0.411 Vali Loss: 3.416 Vali Acc: 0.556 Test Loss: 3.416 Test Acc: 0.556
Validation loss decreased (-0.527760 --> -0.555521).  Saving model ...
Epoch: 18 cost time: 2.5468242168426514
Epoch: 18, Steps: 13 | Train Loss: 0.345 Vali Loss: 5.707 Vali Acc: 0.483 Test Loss: 5.707 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6639657020568848
Epoch: 19, Steps: 13 | Train Loss: 1.251 Vali Loss: 4.480 Vali Acc: 0.483 Test Loss: 4.480 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7196109294891357
Epoch: 20, Steps: 13 | Train Loss: 0.763 Vali Loss: 8.496 Vali Acc: 0.478 Test Loss: 8.496 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.829847574234009
Epoch: 21, Steps: 13 | Train Loss: 0.729 Vali Loss: 5.065 Vali Acc: 0.456 Test Loss: 5.065 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6619818210601807
Epoch: 22, Steps: 13 | Train Loss: 0.412 Vali Loss: 5.578 Vali Acc: 0.472 Test Loss: 5.578 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.567380905151367
Epoch: 23, Steps: 13 | Train Loss: 0.029 Vali Loss: 6.708 Vali Acc: 0.522 Test Loss: 6.708 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.567894697189331
Epoch: 24, Steps: 13 | Train Loss: 0.157 Vali Loss: 8.259 Vali Acc: 0.478 Test Loss: 8.259 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.6485846042633057
Epoch: 25, Steps: 13 | Train Loss: 1.453 Vali Loss: 15.304 Vali Acc: 0.489 Test Loss: 15.304 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7148215770721436
Epoch: 26, Steps: 13 | Train Loss: 1.449 Vali Loss: 9.175 Vali Acc: 0.506 Test Loss: 9.175 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.7001991271972656
Epoch: 27, Steps: 13 | Train Loss: 0.398 Vali Loss: 8.029 Vali Acc: 0.461 Test Loss: 8.029 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 1394010
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.851386785507202
Epoch: 1, Steps: 13 | Train Loss: 0.792 Vali Loss: 1.069 Vali Acc: 0.483 Test Loss: 1.069 Test Acc: 0.483
Validation loss decreased (inf --> -0.483323).  Saving model ...
Epoch: 2 cost time: 3.1986875534057617
Epoch: 2, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.991 Vali Acc: 0.500 Test Loss: 0.991 Test Acc: 0.500
Validation loss decreased (-0.483323 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 3.5593276023864746
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 1.931 Vali Acc: 0.478 Test Loss: 1.931 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5004937648773193
Epoch: 4, Steps: 13 | Train Loss: 1.096 Vali Loss: 1.625 Vali Acc: 0.517 Test Loss: 1.625 Test Acc: 0.517
Validation loss decreased (-0.499990 --> -0.516650).  Saving model ...
Epoch: 5 cost time: 3.226231336593628
Epoch: 5, Steps: 13 | Train Loss: 0.467 Vali Loss: 1.565 Vali Acc: 0.517 Test Loss: 1.565 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516651).  Saving model ...
Epoch: 6 cost time: 3.2582859992980957
Epoch: 6, Steps: 13 | Train Loss: 0.527 Vali Loss: 1.909 Vali Acc: 0.539 Test Loss: 1.909 Test Acc: 0.539
Validation loss decreased (-0.516651 --> -0.538870).  Saving model ...
Epoch: 7 cost time: 3.3468825817108154
Epoch: 7, Steps: 13 | Train Loss: 0.376 Vali Loss: 2.196 Vali Acc: 0.533 Test Loss: 2.196 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2029452323913574
Epoch: 8, Steps: 13 | Train Loss: 0.519 Vali Loss: 2.243 Vali Acc: 0.528 Test Loss: 2.243 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.296257734298706
Epoch: 9, Steps: 13 | Train Loss: 0.379 Vali Loss: 2.584 Vali Acc: 0.572 Test Loss: 2.584 Test Acc: 0.572
Validation loss decreased (-0.538870 --> -0.572196).  Saving model ...
Epoch: 10 cost time: 3.3920295238494873
Epoch: 10, Steps: 13 | Train Loss: 0.355 Vali Loss: 2.914 Vali Acc: 0.517 Test Loss: 2.914 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.165501832962036
Epoch: 11, Steps: 13 | Train Loss: 0.593 Vali Loss: 5.538 Vali Acc: 0.489 Test Loss: 5.538 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.313856840133667
Epoch: 12, Steps: 13 | Train Loss: 0.692 Vali Loss: 3.283 Vali Acc: 0.544 Test Loss: 3.283 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1614489555358887
Epoch: 13, Steps: 13 | Train Loss: 0.274 Vali Loss: 3.806 Vali Acc: 0.539 Test Loss: 3.806 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2076799869537354
Epoch: 14, Steps: 13 | Train Loss: 0.321 Vali Loss: 4.417 Vali Acc: 0.494 Test Loss: 4.417 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.367766857147217
Epoch: 15, Steps: 13 | Train Loss: 0.475 Vali Loss: 4.342 Vali Acc: 0.567 Test Loss: 4.342 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.3542063236236572
Epoch: 16, Steps: 13 | Train Loss: 0.451 Vali Loss: 4.792 Vali Acc: 0.506 Test Loss: 4.792 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5127620697021484
Epoch: 17, Steps: 13 | Train Loss: 0.746 Vali Loss: 4.869 Vali Acc: 0.533 Test Loss: 4.869 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.187407970428467
Epoch: 18, Steps: 13 | Train Loss: 0.347 Vali Loss: 5.833 Vali Acc: 0.517 Test Loss: 5.833 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1788556575775146
Epoch: 19, Steps: 13 | Train Loss: 0.522 Vali Loss: 5.608 Vali Acc: 0.528 Test Loss: 5.608 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 1131866
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.485001802444458
Epoch: 1, Steps: 13 | Train Loss: 0.788 Vali Loss: 1.035 Vali Acc: 0.461 Test Loss: 1.035 Test Acc: 0.461
Validation loss decreased (inf --> -0.461101).  Saving model ...
Epoch: 2 cost time: 2.9140021800994873
Epoch: 2, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.911 Vali Acc: 0.511 Test Loss: 0.911 Test Acc: 0.511
Validation loss decreased (-0.461101 --> -0.511102).  Saving model ...
Epoch: 3 cost time: 2.956367015838623
Epoch: 3, Steps: 13 | Train Loss: 0.781 Vali Loss: 1.918 Vali Acc: 0.483 Test Loss: 1.918 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.158414602279663
Epoch: 4, Steps: 13 | Train Loss: 1.117 Vali Loss: 1.627 Vali Acc: 0.539 Test Loss: 1.627 Test Acc: 0.539
Validation loss decreased (-0.511102 --> -0.538873).  Saving model ...
Epoch: 5 cost time: 3.1545608043670654
Epoch: 5, Steps: 13 | Train Loss: 0.528 Vali Loss: 1.682 Vali Acc: 0.506 Test Loss: 1.682 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1676740646362305
Epoch: 6, Steps: 13 | Train Loss: 0.450 Vali Loss: 2.572 Vali Acc: 0.506 Test Loss: 2.572 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.180487632751465
Epoch: 7, Steps: 13 | Train Loss: 0.731 Vali Loss: 1.991 Vali Acc: 0.489 Test Loss: 1.991 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.088608980178833
Epoch: 8, Steps: 13 | Train Loss: 0.584 Vali Loss: 2.062 Vali Acc: 0.506 Test Loss: 2.062 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0691425800323486
Epoch: 9, Steps: 13 | Train Loss: 0.613 Vali Loss: 2.378 Vali Acc: 0.517 Test Loss: 2.378 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.069965362548828
Epoch: 10, Steps: 13 | Train Loss: 0.622 Vali Loss: 3.408 Vali Acc: 0.544 Test Loss: 3.408 Test Acc: 0.544
Validation loss decreased (-0.538873 --> -0.544410).  Saving model ...
Epoch: 11 cost time: 2.9313771724700928
Epoch: 11, Steps: 13 | Train Loss: 0.849 Vali Loss: 4.047 Vali Acc: 0.528 Test Loss: 4.047 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.086691379547119
Epoch: 12, Steps: 13 | Train Loss: 0.836 Vali Loss: 4.480 Vali Acc: 0.478 Test Loss: 4.480 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.174631357192993
Epoch: 13, Steps: 13 | Train Loss: 0.781 Vali Loss: 4.268 Vali Acc: 0.539 Test Loss: 4.268 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.157822847366333
Epoch: 14, Steps: 13 | Train Loss: 2.142 Vali Loss: 11.821 Vali Acc: 0.500 Test Loss: 11.821 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0738978385925293
Epoch: 15, Steps: 13 | Train Loss: 1.999 Vali Loss: 6.281 Vali Acc: 0.478 Test Loss: 6.281 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.043607711791992
Epoch: 16, Steps: 13 | Train Loss: 0.514 Vali Loss: 4.636 Vali Acc: 0.550 Test Loss: 4.636 Test Acc: 0.550
Validation loss decreased (-0.544410 --> -0.549954).  Saving model ...
Epoch: 17 cost time: 2.9457545280456543
Epoch: 17, Steps: 13 | Train Loss: 0.378 Vali Loss: 4.379 Vali Acc: 0.550 Test Loss: 4.379 Test Acc: 0.550
Validation loss decreased (-0.549954 --> -0.549956).  Saving model ...
Epoch: 18 cost time: 2.874089241027832
Epoch: 18, Steps: 13 | Train Loss: 0.190 Vali Loss: 4.545 Vali Acc: 0.533 Test Loss: 4.545 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0307674407958984
Epoch: 19, Steps: 13 | Train Loss: 0.045 Vali Loss: 6.712 Vali Acc: 0.467 Test Loss: 6.712 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.10097074508667
Epoch: 20, Steps: 13 | Train Loss: 0.379 Vali Loss: 5.427 Vali Acc: 0.517 Test Loss: 5.427 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.060962438583374
Epoch: 21, Steps: 13 | Train Loss: 0.156 Vali Loss: 8.757 Vali Acc: 0.483 Test Loss: 8.757 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.0761067867279053
Epoch: 22, Steps: 13 | Train Loss: 1.137 Vali Loss: 6.588 Vali Acc: 0.506 Test Loss: 6.588 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.975719451904297
Epoch: 23, Steps: 13 | Train Loss: 0.088 Vali Loss: 5.900 Vali Acc: 0.494 Test Loss: 5.900 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.079843044281006
Epoch: 24, Steps: 13 | Train Loss: 0.125 Vali Loss: 7.248 Vali Acc: 0.528 Test Loss: 7.248 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.2101194858551025
Epoch: 25, Steps: 13 | Train Loss: 0.138 Vali Loss: 7.391 Vali Acc: 0.500 Test Loss: 7.391 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.08962082862854
Epoch: 26, Steps: 13 | Train Loss: 0.036 Vali Loss: 8.180 Vali Acc: 0.511 Test Loss: 8.180 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.132838726043701
Epoch: 27, Steps: 13 | Train Loss: 0.078 Vali Loss: 7.755 Vali Acc: 0.489 Test Loss: 7.755 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1131866
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.490286588668823
Epoch: 1, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.941 Vali Acc: 0.461 Test Loss: 0.941 Test Acc: 0.461
Validation loss decreased (inf --> -0.461102).  Saving model ...
Epoch: 2 cost time: 2.8032093048095703
Epoch: 2, Steps: 13 | Train Loss: 0.804 Vali Loss: 1.201 Vali Acc: 0.506 Test Loss: 1.201 Test Acc: 0.506
Validation loss decreased (-0.461102 --> -0.505544).  Saving model ...
Epoch: 3 cost time: 2.8803606033325195
Epoch: 3, Steps: 13 | Train Loss: 0.571 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6778993606567383
Epoch: 4, Steps: 13 | Train Loss: 0.940 Vali Loss: 1.798 Vali Acc: 0.556 Test Loss: 1.798 Test Acc: 0.556
Validation loss decreased (-0.505544 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 2.6357691287994385
Epoch: 5, Steps: 13 | Train Loss: 1.103 Vali Loss: 1.747 Vali Acc: 0.544 Test Loss: 1.747 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7405471801757812
Epoch: 6, Steps: 13 | Train Loss: 0.835 Vali Loss: 2.322 Vali Acc: 0.489 Test Loss: 2.322 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.616147994995117
Epoch: 7, Steps: 13 | Train Loss: 0.771 Vali Loss: 1.483 Vali Acc: 0.489 Test Loss: 1.483 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5968103408813477
Epoch: 8, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.699 Vali Acc: 0.544 Test Loss: 1.699 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7701539993286133
Epoch: 9, Steps: 13 | Train Loss: 0.611 Vali Loss: 2.966 Vali Acc: 0.539 Test Loss: 2.966 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7241909503936768
Epoch: 10, Steps: 13 | Train Loss: 0.643 Vali Loss: 3.093 Vali Acc: 0.494 Test Loss: 3.093 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8021156787872314
Epoch: 11, Steps: 13 | Train Loss: 0.843 Vali Loss: 2.928 Vali Acc: 0.489 Test Loss: 2.928 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7313270568847656
Epoch: 12, Steps: 13 | Train Loss: 0.687 Vali Loss: 3.374 Vali Acc: 0.500 Test Loss: 3.374 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6898908615112305
Epoch: 13, Steps: 13 | Train Loss: 0.338 Vali Loss: 2.683 Vali Acc: 0.550 Test Loss: 2.683 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5982799530029297
Epoch: 14, Steps: 13 | Train Loss: 0.239 Vali Loss: 3.805 Vali Acc: 0.539 Test Loss: 3.805 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 1131866
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.1413733959198
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.859 Vali Acc: 0.461 Test Loss: 0.859 Test Acc: 0.461
Validation loss decreased (inf --> -0.461103).  Saving model ...
Epoch: 2 cost time: 2.550008773803711
Epoch: 2, Steps: 13 | Train Loss: 0.936 Vali Loss: 0.999 Vali Acc: 0.517 Test Loss: 0.999 Test Acc: 0.517
Validation loss decreased (-0.461103 --> -0.516657).  Saving model ...
Epoch: 3 cost time: 2.5638515949249268
Epoch: 3, Steps: 13 | Train Loss: 0.686 Vali Loss: 1.643 Vali Acc: 0.494 Test Loss: 1.643 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.639291286468506
Epoch: 4, Steps: 13 | Train Loss: 1.330 Vali Loss: 1.745 Vali Acc: 0.500 Test Loss: 1.745 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6731903553009033
Epoch: 5, Steps: 13 | Train Loss: 0.627 Vali Loss: 1.035 Vali Acc: 0.506 Test Loss: 1.035 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7657577991485596
Epoch: 6, Steps: 13 | Train Loss: 0.663 Vali Loss: 1.396 Vali Acc: 0.483 Test Loss: 1.396 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.621781826019287
Epoch: 7, Steps: 13 | Train Loss: 0.617 Vali Loss: 1.140 Vali Acc: 0.533 Test Loss: 1.140 Test Acc: 0.533
Validation loss decreased (-0.516657 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 2.534766435623169
Epoch: 8, Steps: 13 | Train Loss: 0.599 Vali Loss: 2.956 Vali Acc: 0.511 Test Loss: 2.956 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5631649494171143
Epoch: 9, Steps: 13 | Train Loss: 1.206 Vali Loss: 1.907 Vali Acc: 0.483 Test Loss: 1.907 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.569589376449585
Epoch: 10, Steps: 13 | Train Loss: 1.452 Vali Loss: 3.780 Vali Acc: 0.494 Test Loss: 3.780 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6025993824005127
Epoch: 11, Steps: 13 | Train Loss: 0.782 Vali Loss: 2.402 Vali Acc: 0.494 Test Loss: 2.402 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6423611640930176
Epoch: 12, Steps: 13 | Train Loss: 1.047 Vali Loss: 3.704 Vali Acc: 0.489 Test Loss: 3.704 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6427955627441406
Epoch: 13, Steps: 13 | Train Loss: 0.994 Vali Loss: 4.269 Vali Acc: 0.478 Test Loss: 4.269 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6068005561828613
Epoch: 14, Steps: 13 | Train Loss: 1.042 Vali Loss: 3.220 Vali Acc: 0.511 Test Loss: 3.220 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.557124137878418
Epoch: 15, Steps: 13 | Train Loss: 0.669 Vali Loss: 3.092 Vali Acc: 0.506 Test Loss: 3.092 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.598828077316284
Epoch: 16, Steps: 13 | Train Loss: 0.138 Vali Loss: 3.575 Vali Acc: 0.478 Test Loss: 3.575 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.370037317276001
Epoch: 17, Steps: 13 | Train Loss: 0.144 Vali Loss: 4.477 Vali Acc: 0.456 Test Loss: 4.477 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1131866
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.864374160766602
Epoch: 1, Steps: 13 | Train Loss: 0.907 Vali Loss: 0.977 Vali Acc: 0.500 Test Loss: 0.977 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 3.209533929824829
Epoch: 2, Steps: 13 | Train Loss: 0.846 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9409546852111816
Epoch: 3, Steps: 13 | Train Loss: 0.749 Vali Loss: 1.490 Vali Acc: 0.556 Test Loss: 1.490 Test Acc: 0.556
Validation loss decreased (-0.499990 --> -0.555541).  Saving model ...
Epoch: 4 cost time: 2.992047071456909
Epoch: 4, Steps: 13 | Train Loss: 1.102 Vali Loss: 3.050 Vali Acc: 0.517 Test Loss: 3.050 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.840015172958374
Epoch: 5, Steps: 13 | Train Loss: 1.126 Vali Loss: 1.694 Vali Acc: 0.567 Test Loss: 1.694 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566650).  Saving model ...
Epoch: 6 cost time: 3.449899435043335
Epoch: 6, Steps: 13 | Train Loss: 0.770 Vali Loss: 3.019 Vali Acc: 0.528 Test Loss: 3.019 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4647302627563477
Epoch: 7, Steps: 13 | Train Loss: 0.875 Vali Loss: 2.033 Vali Acc: 0.533 Test Loss: 2.033 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.774016857147217
Epoch: 8, Steps: 13 | Train Loss: 0.478 Vali Loss: 2.846 Vali Acc: 0.511 Test Loss: 2.846 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.382056713104248
Epoch: 9, Steps: 13 | Train Loss: 0.391 Vali Loss: 3.151 Vali Acc: 0.528 Test Loss: 3.151 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.33829665184021
Epoch: 10, Steps: 13 | Train Loss: 0.293 Vali Loss: 4.867 Vali Acc: 0.506 Test Loss: 4.867 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.359492778778076
Epoch: 11, Steps: 13 | Train Loss: 0.576 Vali Loss: 3.090 Vali Acc: 0.500 Test Loss: 3.090 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1971499919891357
Epoch: 12, Steps: 13 | Train Loss: 0.385 Vali Loss: 5.498 Vali Acc: 0.511 Test Loss: 5.498 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9049336910247803
Epoch: 13, Steps: 13 | Train Loss: 0.738 Vali Loss: 4.278 Vali Acc: 0.500 Test Loss: 4.278 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.623164415359497
Epoch: 14, Steps: 13 | Train Loss: 0.603 Vali Loss: 4.402 Vali Acc: 0.461 Test Loss: 4.402 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.923211097717285
Epoch: 15, Steps: 13 | Train Loss: 0.531 Vali Loss: 4.912 Vali Acc: 0.506 Test Loss: 4.912 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 1000794
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.522778749465942
Epoch: 1, Steps: 13 | Train Loss: 0.917 Vali Loss: 0.964 Vali Acc: 0.494 Test Loss: 0.964 Test Acc: 0.494
Validation loss decreased (inf --> -0.494435).  Saving model ...
Epoch: 2 cost time: 3.0565991401672363
Epoch: 2, Steps: 13 | Train Loss: 0.859 Vali Loss: 1.341 Vali Acc: 0.533 Test Loss: 1.341 Test Acc: 0.533
Validation loss decreased (-0.494435 --> -0.533320).  Saving model ...
Epoch: 3 cost time: 3.1066598892211914
Epoch: 3, Steps: 13 | Train Loss: 0.777 Vali Loss: 1.307 Vali Acc: 0.550 Test Loss: 1.307 Test Acc: 0.550
Validation loss decreased (-0.533320 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 3.079536199569702
Epoch: 4, Steps: 13 | Train Loss: 1.102 Vali Loss: 2.863 Vali Acc: 0.506 Test Loss: 2.863 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0271754264831543
Epoch: 5, Steps: 13 | Train Loss: 1.227 Vali Loss: 1.599 Vali Acc: 0.533 Test Loss: 1.599 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1308846473693848
Epoch: 6, Steps: 13 | Train Loss: 1.308 Vali Loss: 2.031 Vali Acc: 0.572 Test Loss: 2.031 Test Acc: 0.572
Validation loss decreased (-0.549987 --> -0.572202).  Saving model ...
Epoch: 7 cost time: 3.2358829975128174
Epoch: 7, Steps: 13 | Train Loss: 0.687 Vali Loss: 2.590 Vali Acc: 0.539 Test Loss: 2.590 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1749825477600098
Epoch: 8, Steps: 13 | Train Loss: 0.902 Vali Loss: 2.792 Vali Acc: 0.511 Test Loss: 2.792 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0951247215270996
Epoch: 9, Steps: 13 | Train Loss: 1.054 Vali Loss: 3.728 Vali Acc: 0.517 Test Loss: 3.728 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.082045078277588
Epoch: 10, Steps: 13 | Train Loss: 0.647 Vali Loss: 2.867 Vali Acc: 0.500 Test Loss: 2.867 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0675816535949707
Epoch: 11, Steps: 13 | Train Loss: 0.257 Vali Loss: 2.407 Vali Acc: 0.500 Test Loss: 2.407 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0385115146636963
Epoch: 12, Steps: 13 | Train Loss: 0.263 Vali Loss: 2.959 Vali Acc: 0.500 Test Loss: 2.959 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.097630500793457
Epoch: 13, Steps: 13 | Train Loss: 0.835 Vali Loss: 3.003 Vali Acc: 0.467 Test Loss: 3.003 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.199115037918091
Epoch: 14, Steps: 13 | Train Loss: 0.317 Vali Loss: 3.324 Vali Acc: 0.511 Test Loss: 3.324 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.245607614517212
Epoch: 15, Steps: 13 | Train Loss: 0.107 Vali Loss: 3.627 Vali Acc: 0.533 Test Loss: 3.627 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.042689800262451
Epoch: 16, Steps: 13 | Train Loss: 0.181 Vali Loss: 3.737 Vali Acc: 0.533 Test Loss: 3.737 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 1000794
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.471599340438843
Epoch: 1, Steps: 13 | Train Loss: 0.911 Vali Loss: 0.848 Vali Acc: 0.467 Test Loss: 0.848 Test Acc: 0.467
Validation loss decreased (inf --> -0.466658).  Saving model ...
Epoch: 2 cost time: 2.764197826385498
Epoch: 2, Steps: 13 | Train Loss: 0.902 Vali Loss: 1.778 Vali Acc: 0.494 Test Loss: 1.778 Test Acc: 0.494
Validation loss decreased (-0.466658 --> -0.494427).  Saving model ...
Epoch: 3 cost time: 2.3298702239990234
Epoch: 3, Steps: 13 | Train Loss: 1.065 Vali Loss: 1.102 Vali Acc: 0.544 Test Loss: 1.102 Test Acc: 0.544
Validation loss decreased (-0.494427 --> -0.544433).  Saving model ...
Epoch: 4 cost time: 2.4641125202178955
Epoch: 4, Steps: 13 | Train Loss: 0.668 Vali Loss: 2.086 Vali Acc: 0.533 Test Loss: 2.086 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4911880493164062
Epoch: 5, Steps: 13 | Train Loss: 1.094 Vali Loss: 3.236 Vali Acc: 0.478 Test Loss: 3.236 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9143590927124023
Epoch: 6, Steps: 13 | Train Loss: 2.247 Vali Loss: 4.274 Vali Acc: 0.500 Test Loss: 4.274 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.872788190841675
Epoch: 7, Steps: 13 | Train Loss: 1.103 Vali Loss: 2.955 Vali Acc: 0.506 Test Loss: 2.955 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.623549699783325
Epoch: 8, Steps: 13 | Train Loss: 1.260 Vali Loss: 1.907 Vali Acc: 0.494 Test Loss: 1.907 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.676300525665283
Epoch: 9, Steps: 13 | Train Loss: 0.410 Vali Loss: 2.435 Vali Acc: 0.511 Test Loss: 2.435 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7775866985321045
Epoch: 10, Steps: 13 | Train Loss: 0.599 Vali Loss: 2.215 Vali Acc: 0.550 Test Loss: 2.215 Test Acc: 0.550
Validation loss decreased (-0.544433 --> -0.549978).  Saving model ...
Epoch: 11 cost time: 2.8157222270965576
Epoch: 11, Steps: 13 | Train Loss: 1.276 Vali Loss: 5.752 Vali Acc: 0.494 Test Loss: 5.752 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8570556640625
Epoch: 12, Steps: 13 | Train Loss: 1.513 Vali Loss: 2.558 Vali Acc: 0.494 Test Loss: 2.558 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.98945689201355
Epoch: 13, Steps: 13 | Train Loss: 0.653 Vali Loss: 3.326 Vali Acc: 0.467 Test Loss: 3.326 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.846595048904419
Epoch: 14, Steps: 13 | Train Loss: 1.098 Vali Loss: 5.796 Vali Acc: 0.483 Test Loss: 5.796 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.726576805114746
Epoch: 15, Steps: 13 | Train Loss: 0.901 Vali Loss: 4.299 Vali Acc: 0.561 Test Loss: 4.299 Test Acc: 0.561
Validation loss decreased (-0.549978 --> -0.561068).  Saving model ...
Epoch: 16 cost time: 2.726043701171875
Epoch: 16, Steps: 13 | Train Loss: 0.394 Vali Loss: 3.274 Vali Acc: 0.522 Test Loss: 3.274 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7832834720611572
Epoch: 17, Steps: 13 | Train Loss: 0.048 Vali Loss: 3.576 Vali Acc: 0.578 Test Loss: 3.576 Test Acc: 0.578
Validation loss decreased (-0.561068 --> -0.577742).  Saving model ...
Epoch: 18 cost time: 2.889345407485962
Epoch: 18, Steps: 13 | Train Loss: 0.263 Vali Loss: 4.589 Vali Acc: 0.494 Test Loss: 4.589 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8949878215789795
Epoch: 19, Steps: 13 | Train Loss: 0.308 Vali Loss: 4.416 Vali Acc: 0.572 Test Loss: 4.416 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7925071716308594
Epoch: 20, Steps: 13 | Train Loss: 0.069 Vali Loss: 4.659 Vali Acc: 0.528 Test Loss: 4.659 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7686893939971924
Epoch: 21, Steps: 13 | Train Loss: 0.102 Vali Loss: 5.769 Vali Acc: 0.506 Test Loss: 5.769 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.642996311187744
Epoch: 22, Steps: 13 | Train Loss: 0.045 Vali Loss: 5.946 Vali Acc: 0.517 Test Loss: 5.946 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6588828563690186
Epoch: 23, Steps: 13 | Train Loss: 0.075 Vali Loss: 6.390 Vali Acc: 0.500 Test Loss: 6.390 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4895358085632324
Epoch: 24, Steps: 13 | Train Loss: 0.235 Vali Loss: 8.634 Vali Acc: 0.450 Test Loss: 8.634 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.582441568374634
Epoch: 25, Steps: 13 | Train Loss: 0.087 Vali Loss: 6.864 Vali Acc: 0.467 Test Loss: 6.864 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7852041721343994
Epoch: 26, Steps: 13 | Train Loss: 0.050 Vali Loss: 6.987 Vali Acc: 0.539 Test Loss: 6.987 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.7560653686523438
Epoch: 27, Steps: 13 | Train Loss: 0.256 Vali Loss: 9.042 Vali Acc: 0.500 Test Loss: 9.042 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 1000794
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.9737563133239746
Epoch: 1, Steps: 13 | Train Loss: 0.896 Vali Loss: 0.886 Vali Acc: 0.478 Test Loss: 0.886 Test Acc: 0.478
Validation loss decreased (inf --> -0.477769).  Saving model ...
Epoch: 2 cost time: 2.3059346675872803
Epoch: 2, Steps: 13 | Train Loss: 0.864 Vali Loss: 1.132 Vali Acc: 0.478 Test Loss: 1.132 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.528795003890991
Epoch: 3, Steps: 13 | Train Loss: 0.864 Vali Loss: 1.257 Vali Acc: 0.528 Test Loss: 1.257 Test Acc: 0.528
Validation loss decreased (-0.477769 --> -0.527765).  Saving model ...
Epoch: 4 cost time: 2.5857272148132324
Epoch: 4, Steps: 13 | Train Loss: 1.110 Vali Loss: 1.407 Vali Acc: 0.506 Test Loss: 1.407 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.338818073272705
Epoch: 5, Steps: 13 | Train Loss: 0.710 Vali Loss: 1.956 Vali Acc: 0.528 Test Loss: 1.956 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4394497871398926
Epoch: 6, Steps: 13 | Train Loss: 1.106 Vali Loss: 2.080 Vali Acc: 0.517 Test Loss: 2.080 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.402604579925537
Epoch: 7, Steps: 13 | Train Loss: 1.100 Vali Loss: 1.724 Vali Acc: 0.511 Test Loss: 1.724 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6005680561065674
Epoch: 8, Steps: 13 | Train Loss: 0.679 Vali Loss: 1.747 Vali Acc: 0.500 Test Loss: 1.747 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4125614166259766
Epoch: 9, Steps: 13 | Train Loss: 0.447 Vali Loss: 1.219 Vali Acc: 0.506 Test Loss: 1.219 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.438185214996338
Epoch: 10, Steps: 13 | Train Loss: 0.556 Vali Loss: 1.951 Vali Acc: 0.478 Test Loss: 1.951 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3814287185668945
Epoch: 11, Steps: 13 | Train Loss: 0.402 Vali Loss: 2.090 Vali Acc: 0.533 Test Loss: 2.090 Test Acc: 0.533
Validation loss decreased (-0.527765 --> -0.533312).  Saving model ...
Epoch: 12 cost time: 2.381784677505493
Epoch: 12, Steps: 13 | Train Loss: 0.597 Vali Loss: 1.932 Vali Acc: 0.528 Test Loss: 1.932 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3777990341186523
Epoch: 13, Steps: 13 | Train Loss: 0.372 Vali Loss: 1.934 Vali Acc: 0.500 Test Loss: 1.934 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5206236839294434
Epoch: 14, Steps: 13 | Train Loss: 0.240 Vali Loss: 2.642 Vali Acc: 0.550 Test Loss: 2.642 Test Acc: 0.550
Validation loss decreased (-0.533312 --> -0.549974).  Saving model ...
Epoch: 15 cost time: 2.60007905960083
Epoch: 15, Steps: 13 | Train Loss: 0.353 Vali Loss: 2.871 Vali Acc: 0.461 Test Loss: 2.871 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.660048723220825
Epoch: 16, Steps: 13 | Train Loss: 0.674 Vali Loss: 2.785 Vali Acc: 0.472 Test Loss: 2.785 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7288503646850586
Epoch: 17, Steps: 13 | Train Loss: 0.435 Vali Loss: 4.157 Vali Acc: 0.506 Test Loss: 4.157 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.511343479156494
Epoch: 18, Steps: 13 | Train Loss: 1.007 Vali Loss: 4.055 Vali Acc: 0.517 Test Loss: 4.055 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5179827213287354
Epoch: 19, Steps: 13 | Train Loss: 0.504 Vali Loss: 3.893 Vali Acc: 0.472 Test Loss: 3.893 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.544149875640869
Epoch: 20, Steps: 13 | Train Loss: 0.184 Vali Loss: 5.286 Vali Acc: 0.489 Test Loss: 5.286 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.5843935012817383
Epoch: 21, Steps: 13 | Train Loss: 0.053 Vali Loss: 6.781 Vali Acc: 0.467 Test Loss: 6.781 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.417667865753174
Epoch: 22, Steps: 13 | Train Loss: 0.381 Vali Loss: 6.190 Vali Acc: 0.467 Test Loss: 6.190 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.5345029830932617
Epoch: 23, Steps: 13 | Train Loss: 0.096 Vali Loss: 6.454 Vali Acc: 0.500 Test Loss: 6.454 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.545747756958008
Epoch: 24, Steps: 13 | Train Loss: 0.184 Vali Loss: 6.657 Vali Acc: 0.467 Test Loss: 6.657 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1000794
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.684376955032349
Epoch: 1, Steps: 13 | Train Loss: 0.883 Vali Loss: 0.763 Vali Acc: 0.511 Test Loss: 0.763 Test Acc: 0.511
Validation loss decreased (inf --> -0.511103).  Saving model ...
Epoch: 2 cost time: 2.7720694541931152
Epoch: 2, Steps: 13 | Train Loss: 0.805 Vali Loss: 0.903 Vali Acc: 0.500 Test Loss: 0.903 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1410512924194336
Epoch: 3, Steps: 13 | Train Loss: 0.755 Vali Loss: 1.350 Vali Acc: 0.489 Test Loss: 1.350 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2021400928497314
Epoch: 4, Steps: 13 | Train Loss: 0.657 Vali Loss: 2.553 Vali Acc: 0.528 Test Loss: 2.553 Test Acc: 0.528
Validation loss decreased (-0.511103 --> -0.527752).  Saving model ...
Epoch: 5 cost time: 3.042119264602661
Epoch: 5, Steps: 13 | Train Loss: 1.323 Vali Loss: 3.134 Vali Acc: 0.544 Test Loss: 3.134 Test Acc: 0.544
Validation loss decreased (-0.527752 --> -0.544413).  Saving model ...
Epoch: 6 cost time: 3.0103461742401123
Epoch: 6, Steps: 13 | Train Loss: 0.969 Vali Loss: 3.504 Vali Acc: 0.494 Test Loss: 3.504 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9385106563568115
Epoch: 7, Steps: 13 | Train Loss: 0.882 Vali Loss: 4.023 Vali Acc: 0.500 Test Loss: 4.023 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.181490898132324
Epoch: 8, Steps: 13 | Train Loss: 1.071 Vali Loss: 2.436 Vali Acc: 0.528 Test Loss: 2.436 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4207966327667236
Epoch: 9, Steps: 13 | Train Loss: 0.568 Vali Loss: 3.066 Vali Acc: 0.511 Test Loss: 3.066 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4261527061462402
Epoch: 10, Steps: 13 | Train Loss: 0.502 Vali Loss: 2.734 Vali Acc: 0.511 Test Loss: 2.734 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2986488342285156
Epoch: 11, Steps: 13 | Train Loss: 0.650 Vali Loss: 4.492 Vali Acc: 0.522 Test Loss: 4.492 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.288743019104004
Epoch: 12, Steps: 13 | Train Loss: 0.963 Vali Loss: 3.575 Vali Acc: 0.506 Test Loss: 3.575 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.3595736026763916
Epoch: 13, Steps: 13 | Train Loss: 0.301 Vali Loss: 3.913 Vali Acc: 0.550 Test Loss: 3.913 Test Acc: 0.550
Validation loss decreased (-0.544413 --> -0.549961).  Saving model ...
Epoch: 14 cost time: 3.314720869064331
Epoch: 14, Steps: 13 | Train Loss: 0.470 Vali Loss: 4.078 Vali Acc: 0.522 Test Loss: 4.078 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.409431219100952
Epoch: 15, Steps: 13 | Train Loss: 0.348 Vali Loss: 4.617 Vali Acc: 0.511 Test Loss: 4.617 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4230191707611084
Epoch: 16, Steps: 13 | Train Loss: 0.181 Vali Loss: 4.775 Vali Acc: 0.533 Test Loss: 4.775 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3593220710754395
Epoch: 17, Steps: 13 | Train Loss: 0.421 Vali Loss: 7.108 Vali Acc: 0.517 Test Loss: 7.108 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3648881912231445
Epoch: 18, Steps: 13 | Train Loss: 0.396 Vali Loss: 4.911 Vali Acc: 0.561 Test Loss: 4.911 Test Acc: 0.561
Validation loss decreased (-0.549961 --> -0.561062).  Saving model ...
Epoch: 19 cost time: 3.5141470432281494
Epoch: 19, Steps: 13 | Train Loss: 0.174 Vali Loss: 4.823 Vali Acc: 0.517 Test Loss: 4.823 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.483508348464966
Epoch: 20, Steps: 13 | Train Loss: 0.090 Vali Loss: 5.049 Vali Acc: 0.506 Test Loss: 5.049 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.443934202194214
Epoch: 21, Steps: 13 | Train Loss: 0.076 Vali Loss: 5.216 Vali Acc: 0.494 Test Loss: 5.216 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.142411470413208
Epoch: 22, Steps: 13 | Train Loss: 0.070 Vali Loss: 9.399 Vali Acc: 0.500 Test Loss: 9.399 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.386298418045044
Epoch: 23, Steps: 13 | Train Loss: 1.392 Vali Loss: 7.881 Vali Acc: 0.500 Test Loss: 7.881 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2718560695648193
Epoch: 24, Steps: 13 | Train Loss: 0.709 Vali Loss: 13.512 Vali Acc: 0.517 Test Loss: 13.512 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.296586275100708
Epoch: 25, Steps: 13 | Train Loss: 0.604 Vali Loss: 7.349 Vali Acc: 0.517 Test Loss: 7.349 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.5331742763519287
Epoch: 26, Steps: 13 | Train Loss: 0.057 Vali Loss: 10.395 Vali Acc: 0.528 Test Loss: 10.395 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.430053234100342
Epoch: 27, Steps: 13 | Train Loss: 0.753 Vali Loss: 14.095 Vali Acc: 0.500 Test Loss: 14.095 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.253004312515259
Epoch: 28, Steps: 13 | Train Loss: 0.828 Vali Loss: 9.446 Vali Acc: 0.533 Test Loss: 9.446 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 935258
model size : 8.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.684912204742432
Epoch: 1, Steps: 13 | Train Loss: 0.873 Vali Loss: 0.746 Vali Acc: 0.533 Test Loss: 0.746 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 2.986438035964966
Epoch: 2, Steps: 13 | Train Loss: 0.819 Vali Loss: 0.876 Vali Acc: 0.517 Test Loss: 0.876 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.088545799255371
Epoch: 3, Steps: 13 | Train Loss: 0.756 Vali Loss: 1.423 Vali Acc: 0.489 Test Loss: 1.423 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.026951313018799
Epoch: 4, Steps: 13 | Train Loss: 0.750 Vali Loss: 2.467 Vali Acc: 0.517 Test Loss: 2.467 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.873593330383301
Epoch: 5, Steps: 13 | Train Loss: 1.499 Vali Loss: 3.471 Vali Acc: 0.506 Test Loss: 3.471 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.890514373779297
Epoch: 6, Steps: 13 | Train Loss: 1.295 Vali Loss: 3.212 Vali Acc: 0.506 Test Loss: 3.212 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.94921612739563
Epoch: 7, Steps: 13 | Train Loss: 0.921 Vali Loss: 2.672 Vali Acc: 0.456 Test Loss: 2.672 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.1301980018615723
Epoch: 8, Steps: 13 | Train Loss: 1.055 Vali Loss: 4.672 Vali Acc: 0.500 Test Loss: 4.672 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.9963490962982178
Epoch: 9, Steps: 13 | Train Loss: 1.921 Vali Loss: 2.579 Vali Acc: 0.483 Test Loss: 2.579 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.866562843322754
Epoch: 10, Steps: 13 | Train Loss: 0.504 Vali Loss: 2.750 Vali Acc: 0.528 Test Loss: 2.750 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.9078469276428223
Epoch: 11, Steps: 13 | Train Loss: 1.194 Vali Loss: 3.469 Vali Acc: 0.456 Test Loss: 3.469 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 935258
model size : 8.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.31912899017334
Epoch: 1, Steps: 13 | Train Loss: 0.850 Vali Loss: 0.815 Vali Acc: 0.539 Test Loss: 0.815 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 2.750277280807495
Epoch: 2, Steps: 13 | Train Loss: 0.823 Vali Loss: 0.818 Vali Acc: 0.556 Test Loss: 0.818 Test Acc: 0.556
Validation loss decreased (-0.538881 --> -0.555547).  Saving model ...
Epoch: 3 cost time: 2.64139986038208
Epoch: 3, Steps: 13 | Train Loss: 0.816 Vali Loss: 1.653 Vali Acc: 0.478 Test Loss: 1.653 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6595346927642822
Epoch: 4, Steps: 13 | Train Loss: 0.946 Vali Loss: 1.488 Vali Acc: 0.522 Test Loss: 1.488 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.605501651763916
Epoch: 5, Steps: 13 | Train Loss: 1.038 Vali Loss: 2.578 Vali Acc: 0.506 Test Loss: 2.578 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4628360271453857
Epoch: 6, Steps: 13 | Train Loss: 0.792 Vali Loss: 2.828 Vali Acc: 0.472 Test Loss: 2.828 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7029433250427246
Epoch: 7, Steps: 13 | Train Loss: 0.698 Vali Loss: 1.870 Vali Acc: 0.517 Test Loss: 1.870 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7178683280944824
Epoch: 8, Steps: 13 | Train Loss: 0.629 Vali Loss: 2.743 Vali Acc: 0.472 Test Loss: 2.743 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.690509796142578
Epoch: 9, Steps: 13 | Train Loss: 0.863 Vali Loss: 3.455 Vali Acc: 0.506 Test Loss: 3.455 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.596867322921753
Epoch: 10, Steps: 13 | Train Loss: 0.929 Vali Loss: 2.800 Vali Acc: 0.489 Test Loss: 2.800 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6607773303985596
Epoch: 11, Steps: 13 | Train Loss: 1.066 Vali Loss: 4.285 Vali Acc: 0.467 Test Loss: 4.285 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6016809940338135
Epoch: 12, Steps: 13 | Train Loss: 0.734 Vali Loss: 3.289 Vali Acc: 0.467 Test Loss: 3.289 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 935258
model size : 8.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.209258556365967
Epoch: 1, Steps: 13 | Train Loss: 0.940 Vali Loss: 0.781 Vali Acc: 0.539 Test Loss: 0.781 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 2.4508304595947266
Epoch: 2, Steps: 13 | Train Loss: 0.837 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
Validation loss decreased (-0.538881 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.5340218544006348
Epoch: 3, Steps: 13 | Train Loss: 0.935 Vali Loss: 1.899 Vali Acc: 0.483 Test Loss: 1.899 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.426088333129883
Epoch: 4, Steps: 13 | Train Loss: 1.216 Vali Loss: 1.708 Vali Acc: 0.511 Test Loss: 1.708 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.531573534011841
Epoch: 5, Steps: 13 | Train Loss: 1.453 Vali Loss: 3.009 Vali Acc: 0.517 Test Loss: 3.009 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.686312437057495
Epoch: 6, Steps: 13 | Train Loss: 0.938 Vali Loss: 1.442 Vali Acc: 0.533 Test Loss: 1.442 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.643972873687744
Epoch: 7, Steps: 13 | Train Loss: 0.739 Vali Loss: 1.650 Vali Acc: 0.500 Test Loss: 1.650 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5613486766815186
Epoch: 8, Steps: 13 | Train Loss: 0.692 Vali Loss: 1.582 Vali Acc: 0.533 Test Loss: 1.582 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5720860958099365
Epoch: 9, Steps: 13 | Train Loss: 1.447 Vali Loss: 1.608 Vali Acc: 0.500 Test Loss: 1.608 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4929604530334473
Epoch: 10, Steps: 13 | Train Loss: 1.702 Vali Loss: 4.147 Vali Acc: 0.517 Test Loss: 4.147 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5362014770507812
Epoch: 11, Steps: 13 | Train Loss: 0.992 Vali Loss: 2.126 Vali Acc: 0.517 Test Loss: 2.126 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.532437324523926
Epoch: 12, Steps: 13 | Train Loss: 0.488 Vali Loss: 2.357 Vali Acc: 0.494 Test Loss: 2.357 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 935258
model size : 8.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8838577270507812
Epoch: 1, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.979 Vali Acc: 0.500 Test Loss: 0.979 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 2.3080105781555176
Epoch: 2, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.916 Vali Acc: 0.506 Test Loss: 0.916 Test Acc: 0.506
Validation loss decreased (-0.499990 --> -0.505546).  Saving model ...
Epoch: 3 cost time: 2.5776336193084717
Epoch: 3, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.949 Vali Acc: 0.511 Test Loss: 0.949 Test Acc: 0.511
Validation loss decreased (-0.505546 --> -0.511102).  Saving model ...
Epoch: 4 cost time: 2.4839885234832764
Epoch: 4, Steps: 13 | Train Loss: 0.615 Vali Loss: 1.596 Vali Acc: 0.511 Test Loss: 1.596 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.39664626121521
Epoch: 5, Steps: 13 | Train Loss: 0.651 Vali Loss: 1.329 Vali Acc: 0.489 Test Loss: 1.329 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.331637144088745
Epoch: 6, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.259 Vali Acc: 0.550 Test Loss: 1.259 Test Acc: 0.550
Validation loss decreased (-0.511102 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 2.442633867263794
Epoch: 7, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.265 Vali Acc: 0.522 Test Loss: 1.265 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.468862771987915
Epoch: 8, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.873 Vali Acc: 0.556 Test Loss: 1.873 Test Acc: 0.556
Validation loss decreased (-0.549987 --> -0.555537).  Saving model ...
Epoch: 9 cost time: 2.4078757762908936
Epoch: 9, Steps: 13 | Train Loss: 0.644 Vali Loss: 1.884 Vali Acc: 0.528 Test Loss: 1.884 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.380094528198242
Epoch: 10, Steps: 13 | Train Loss: 0.285 Vali Loss: 2.507 Vali Acc: 0.500 Test Loss: 2.507 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4825570583343506
Epoch: 11, Steps: 13 | Train Loss: 0.246 Vali Loss: 2.181 Vali Acc: 0.556 Test Loss: 2.181 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5031659603118896
Epoch: 12, Steps: 13 | Train Loss: 0.169 Vali Loss: 2.186 Vali Acc: 0.533 Test Loss: 2.186 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.398904800415039
Epoch: 13, Steps: 13 | Train Loss: 0.187 Vali Loss: 2.616 Vali Acc: 0.556 Test Loss: 2.616 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.401332139968872
Epoch: 14, Steps: 13 | Train Loss: 0.124 Vali Loss: 2.825 Vali Acc: 0.528 Test Loss: 2.825 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3198375701904297
Epoch: 15, Steps: 13 | Train Loss: 0.119 Vali Loss: 2.512 Vali Acc: 0.533 Test Loss: 2.512 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.346881151199341
Epoch: 16, Steps: 13 | Train Loss: 0.077 Vali Loss: 2.700 Vali Acc: 0.522 Test Loss: 2.700 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.271913766860962
Epoch: 17, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.268 Vali Acc: 0.544 Test Loss: 3.268 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6239278316497803
Epoch: 18, Steps: 13 | Train Loss: 0.096 Vali Loss: 2.873 Vali Acc: 0.550 Test Loss: 2.873 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 1417946
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.998824119567871
Epoch: 1, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.985 Vali Acc: 0.494 Test Loss: 0.985 Test Acc: 0.494
Validation loss decreased (inf --> -0.494435).  Saving model ...
Epoch: 2 cost time: 2.3820817470550537
Epoch: 2, Steps: 13 | Train Loss: 0.827 Vali Loss: 0.976 Vali Acc: 0.494 Test Loss: 0.976 Test Acc: 0.494
Validation loss decreased (-0.494435 --> -0.494435).  Saving model ...
Epoch: 3 cost time: 2.5148603916168213
Epoch: 3, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.834 Vali Acc: 0.567 Test Loss: 0.834 Test Acc: 0.567
Validation loss decreased (-0.494435 --> -0.566658).  Saving model ...
Epoch: 4 cost time: 2.4574480056762695
Epoch: 4, Steps: 13 | Train Loss: 0.562 Vali Loss: 1.662 Vali Acc: 0.500 Test Loss: 1.662 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.440484046936035
Epoch: 5, Steps: 13 | Train Loss: 0.636 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4100892543792725
Epoch: 6, Steps: 13 | Train Loss: 0.677 Vali Loss: 1.450 Vali Acc: 0.483 Test Loss: 1.450 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.377760648727417
Epoch: 7, Steps: 13 | Train Loss: 0.522 Vali Loss: 1.266 Vali Acc: 0.517 Test Loss: 1.266 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2192864418029785
Epoch: 8, Steps: 13 | Train Loss: 0.475 Vali Loss: 1.947 Vali Acc: 0.517 Test Loss: 1.947 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.396148443222046
Epoch: 9, Steps: 13 | Train Loss: 0.456 Vali Loss: 2.167 Vali Acc: 0.483 Test Loss: 2.167 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.454646587371826
Epoch: 10, Steps: 13 | Train Loss: 0.760 Vali Loss: 2.690 Vali Acc: 0.467 Test Loss: 2.690 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.551821708679199
Epoch: 11, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.949 Vali Acc: 0.506 Test Loss: 1.949 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.498338460922241
Epoch: 12, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.860 Vali Acc: 0.528 Test Loss: 1.860 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4252147674560547
Epoch: 13, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.981 Vali Acc: 0.506 Test Loss: 1.981 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 1417946
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7611334323883057
Epoch: 1, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.968 Vali Acc: 0.494 Test Loss: 0.968 Test Acc: 0.494
Validation loss decreased (inf --> -0.494435).  Saving model ...
Epoch: 2 cost time: 2.1898193359375
Epoch: 2, Steps: 13 | Train Loss: 0.821 Vali Loss: 1.002 Vali Acc: 0.483 Test Loss: 1.002 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2008583545684814
Epoch: 3, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.945 Vali Acc: 0.544 Test Loss: 0.945 Test Acc: 0.544
Validation loss decreased (-0.494435 --> -0.544435).  Saving model ...
Epoch: 4 cost time: 2.142275094985962
Epoch: 4, Steps: 13 | Train Loss: 0.722 Vali Loss: 2.180 Vali Acc: 0.489 Test Loss: 2.180 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1782994270324707
Epoch: 5, Steps: 13 | Train Loss: 1.212 Vali Loss: 1.486 Vali Acc: 0.489 Test Loss: 1.486 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2487125396728516
Epoch: 6, Steps: 13 | Train Loss: 0.572 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1295559406280518
Epoch: 7, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.081 Vali Acc: 0.522 Test Loss: 1.081 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.061829090118408
Epoch: 8, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.376 Vali Acc: 0.511 Test Loss: 1.376 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.237032651901245
Epoch: 9, Steps: 13 | Train Loss: 0.434 Vali Loss: 1.509 Vali Acc: 0.550 Test Loss: 1.509 Test Acc: 0.550
Validation loss decreased (-0.544435 --> -0.549985).  Saving model ...
Epoch: 10 cost time: 2.2390341758728027
Epoch: 10, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.501 Vali Acc: 0.522 Test Loss: 1.501 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1949191093444824
Epoch: 11, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.483 Vali Acc: 0.522 Test Loss: 1.483 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.212829828262329
Epoch: 12, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.788 Vali Acc: 0.489 Test Loss: 1.788 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2334506511688232
Epoch: 13, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.982 Vali Acc: 0.522 Test Loss: 1.982 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.074152708053589
Epoch: 14, Steps: 13 | Train Loss: 0.121 Vali Loss: 2.198 Vali Acc: 0.500 Test Loss: 2.198 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.17529559135437
Epoch: 15, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.237 Vali Acc: 0.494 Test Loss: 2.237 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9944546222686768
Epoch: 16, Steps: 13 | Train Loss: 0.142 Vali Loss: 2.890 Vali Acc: 0.450 Test Loss: 2.890 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.328840732574463
Epoch: 17, Steps: 13 | Train Loss: 0.161 Vali Loss: 2.942 Vali Acc: 0.517 Test Loss: 2.942 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1291067600250244
Epoch: 18, Steps: 13 | Train Loss: 0.143 Vali Loss: 3.260 Vali Acc: 0.489 Test Loss: 3.260 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.079441547393799
Epoch: 19, Steps: 13 | Train Loss: 0.101 Vali Loss: 3.416 Vali Acc: 0.506 Test Loss: 3.416 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1417946
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.554469108581543
Epoch: 1, Steps: 13 | Train Loss: 0.782 Vali Loss: 1.014 Vali Acc: 0.511 Test Loss: 1.014 Test Acc: 0.511
Validation loss decreased (inf --> -0.511101).  Saving model ...
Epoch: 2 cost time: 1.9262018203735352
Epoch: 2, Steps: 13 | Train Loss: 0.893 Vali Loss: 0.926 Vali Acc: 0.489 Test Loss: 0.926 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9156711101531982
Epoch: 3, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.744 Vali Acc: 0.517 Test Loss: 0.744 Test Acc: 0.517
Validation loss decreased (-0.511101 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.8952453136444092
Epoch: 4, Steps: 13 | Train Loss: 0.666 Vali Loss: 1.750 Vali Acc: 0.478 Test Loss: 1.750 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8900375366210938
Epoch: 5, Steps: 13 | Train Loss: 0.944 Vali Loss: 1.026 Vali Acc: 0.483 Test Loss: 1.026 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9313292503356934
Epoch: 6, Steps: 13 | Train Loss: 0.777 Vali Loss: 1.600 Vali Acc: 0.494 Test Loss: 1.600 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8627350330352783
Epoch: 7, Steps: 13 | Train Loss: 0.744 Vali Loss: 1.086 Vali Acc: 0.528 Test Loss: 1.086 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527767).  Saving model ...
Epoch: 8 cost time: 1.8315963745117188
Epoch: 8, Steps: 13 | Train Loss: 0.644 Vali Loss: 1.163 Vali Acc: 0.511 Test Loss: 1.163 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7900829315185547
Epoch: 9, Steps: 13 | Train Loss: 0.681 Vali Loss: 1.633 Vali Acc: 0.533 Test Loss: 1.633 Test Acc: 0.533
Validation loss decreased (-0.527767 --> -0.533317).  Saving model ...
Epoch: 10 cost time: 1.8610472679138184
Epoch: 10, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.172 Vali Acc: 0.511 Test Loss: 1.172 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8351664543151855
Epoch: 11, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.773 Vali Acc: 0.489 Test Loss: 1.773 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9043426513671875
Epoch: 12, Steps: 13 | Train Loss: 0.471 Vali Loss: 1.805 Vali Acc: 0.483 Test Loss: 1.805 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.836902379989624
Epoch: 13, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.850 Vali Acc: 0.489 Test Loss: 1.850 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8021409511566162
Epoch: 14, Steps: 13 | Train Loss: 0.187 Vali Loss: 2.052 Vali Acc: 0.456 Test Loss: 2.052 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8877925872802734
Epoch: 15, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.997 Vali Acc: 0.467 Test Loss: 1.997 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7893040180206299
Epoch: 16, Steps: 13 | Train Loss: 0.312 Vali Loss: 3.133 Vali Acc: 0.483 Test Loss: 3.133 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8502321243286133
Epoch: 17, Steps: 13 | Train Loss: 0.224 Vali Loss: 2.760 Vali Acc: 0.489 Test Loss: 2.760 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7810206413269043
Epoch: 18, Steps: 13 | Train Loss: 0.123 Vali Loss: 2.818 Vali Acc: 0.456 Test Loss: 2.818 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.934558629989624
Epoch: 19, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.798 Vali Acc: 0.517 Test Loss: 2.798 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1417946
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.821704387664795
Epoch: 1, Steps: 13 | Train Loss: 0.840 Vali Loss: 0.960 Vali Acc: 0.494 Test Loss: 0.960 Test Acc: 0.494
Validation loss decreased (inf --> -0.494435).  Saving model ...
Epoch: 2 cost time: 1.9839882850646973
Epoch: 2, Steps: 13 | Train Loss: 1.149 Vali Loss: 1.201 Vali Acc: 0.522 Test Loss: 1.201 Test Acc: 0.522
Validation loss decreased (-0.494435 --> -0.522210).  Saving model ...
Epoch: 3 cost time: 2.2507259845733643
Epoch: 3, Steps: 13 | Train Loss: 0.927 Vali Loss: 0.909 Vali Acc: 0.539 Test Loss: 0.909 Test Acc: 0.539
Validation loss decreased (-0.522210 --> -0.538880).  Saving model ...
Epoch: 4 cost time: 2.282196283340454
Epoch: 4, Steps: 13 | Train Loss: 0.559 Vali Loss: 1.192 Vali Acc: 0.461 Test Loss: 1.192 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3110737800598145
Epoch: 5, Steps: 13 | Train Loss: 0.592 Vali Loss: 1.138 Vali Acc: 0.533 Test Loss: 1.138 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.423764944076538
Epoch: 6, Steps: 13 | Train Loss: 0.574 Vali Loss: 1.388 Vali Acc: 0.489 Test Loss: 1.388 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3686957359313965
Epoch: 7, Steps: 13 | Train Loss: 0.658 Vali Loss: 1.362 Vali Acc: 0.556 Test Loss: 1.362 Test Acc: 0.556
Validation loss decreased (-0.538880 --> -0.555542).  Saving model ...
Epoch: 8 cost time: 2.2729766368865967
Epoch: 8, Steps: 13 | Train Loss: 0.599 Vali Loss: 1.398 Vali Acc: 0.544 Test Loss: 1.398 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.233438491821289
Epoch: 9, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.725 Vali Acc: 0.539 Test Loss: 1.725 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2085835933685303
Epoch: 10, Steps: 13 | Train Loss: 0.540 Vali Loss: 1.655 Vali Acc: 0.556 Test Loss: 1.655 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2102978229522705
Epoch: 11, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.734 Vali Acc: 0.533 Test Loss: 1.734 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.354785919189453
Epoch: 12, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.918 Vali Acc: 0.556 Test Loss: 1.918 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3486528396606445
Epoch: 13, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.980 Vali Acc: 0.533 Test Loss: 1.980 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.305263042449951
Epoch: 14, Steps: 13 | Train Loss: 0.198 Vali Loss: 2.312 Vali Acc: 0.544 Test Loss: 2.312 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.207472324371338
Epoch: 15, Steps: 13 | Train Loss: 0.095 Vali Loss: 2.725 Vali Acc: 0.522 Test Loss: 2.725 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2514004707336426
Epoch: 16, Steps: 13 | Train Loss: 0.190 Vali Loss: 3.075 Vali Acc: 0.539 Test Loss: 3.075 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.257688283920288
Epoch: 17, Steps: 13 | Train Loss: 0.246 Vali Loss: 3.004 Vali Acc: 0.522 Test Loss: 3.004 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 893658
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8406577110290527
Epoch: 1, Steps: 13 | Train Loss: 0.826 Vali Loss: 0.941 Vali Acc: 0.489 Test Loss: 0.941 Test Acc: 0.489
Validation loss decreased (inf --> -0.488879).  Saving model ...
Epoch: 2 cost time: 2.1493701934814453
Epoch: 2, Steps: 13 | Train Loss: 1.120 Vali Loss: 1.214 Vali Acc: 0.511 Test Loss: 1.214 Test Acc: 0.511
Validation loss decreased (-0.488879 --> -0.511099).  Saving model ...
Epoch: 3 cost time: 1.9604909420013428
Epoch: 3, Steps: 13 | Train Loss: 0.938 Vali Loss: 0.922 Vali Acc: 0.550 Test Loss: 0.922 Test Acc: 0.550
Validation loss decreased (-0.511099 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 2.034479856491089
Epoch: 4, Steps: 13 | Train Loss: 0.567 Vali Loss: 1.046 Vali Acc: 0.483 Test Loss: 1.046 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0381996631622314
Epoch: 5, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.998 Vali Acc: 0.517 Test Loss: 0.998 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0352723598480225
Epoch: 6, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.102 Vali Acc: 0.506 Test Loss: 1.102 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0279641151428223
Epoch: 7, Steps: 13 | Train Loss: 0.624 Vali Loss: 1.457 Vali Acc: 0.494 Test Loss: 1.457 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.059718132019043
Epoch: 8, Steps: 13 | Train Loss: 0.689 Vali Loss: 1.633 Vali Acc: 0.556 Test Loss: 1.633 Test Acc: 0.556
Validation loss decreased (-0.549991 --> -0.555539).  Saving model ...
Epoch: 9 cost time: 2.055030584335327
Epoch: 9, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.654 Vali Acc: 0.528 Test Loss: 1.654 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0941414833068848
Epoch: 10, Steps: 13 | Train Loss: 0.287 Vali Loss: 2.461 Vali Acc: 0.489 Test Loss: 2.461 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0430781841278076
Epoch: 11, Steps: 13 | Train Loss: 0.432 Vali Loss: 1.801 Vali Acc: 0.528 Test Loss: 1.801 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0588552951812744
Epoch: 12, Steps: 13 | Train Loss: 0.150 Vali Loss: 2.052 Vali Acc: 0.539 Test Loss: 2.052 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9821641445159912
Epoch: 13, Steps: 13 | Train Loss: 0.187 Vali Loss: 2.362 Vali Acc: 0.500 Test Loss: 2.362 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9488816261291504
Epoch: 14, Steps: 13 | Train Loss: 0.097 Vali Loss: 2.166 Vali Acc: 0.539 Test Loss: 2.166 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0431883335113525
Epoch: 15, Steps: 13 | Train Loss: 0.183 Vali Loss: 2.380 Vali Acc: 0.517 Test Loss: 2.380 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.116232395172119
Epoch: 16, Steps: 13 | Train Loss: 0.091 Vali Loss: 2.693 Vali Acc: 0.578 Test Loss: 2.693 Test Acc: 0.578
Validation loss decreased (-0.555539 --> -0.577751).  Saving model ...
Epoch: 17 cost time: 2.011399030685425
Epoch: 17, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.532 Vali Acc: 0.544 Test Loss: 2.532 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0056064128875732
Epoch: 18, Steps: 13 | Train Loss: 0.091 Vali Loss: 2.402 Vali Acc: 0.561 Test Loss: 2.402 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0199811458587646
Epoch: 19, Steps: 13 | Train Loss: 0.059 Vali Loss: 2.688 Vali Acc: 0.528 Test Loss: 2.688 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1064085960388184
Epoch: 20, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.933 Vali Acc: 0.561 Test Loss: 2.933 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0570175647735596
Epoch: 21, Steps: 13 | Train Loss: 0.029 Vali Loss: 3.092 Vali Acc: 0.494 Test Loss: 3.092 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9866273403167725
Epoch: 22, Steps: 13 | Train Loss: 0.034 Vali Loss: 3.143 Vali Acc: 0.528 Test Loss: 3.143 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.09559965133667
Epoch: 23, Steps: 13 | Train Loss: 0.052 Vali Loss: 3.314 Vali Acc: 0.478 Test Loss: 3.314 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.141298532485962
Epoch: 24, Steps: 13 | Train Loss: 0.039 Vali Loss: 4.676 Vali Acc: 0.494 Test Loss: 4.676 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2222306728363037
Epoch: 25, Steps: 13 | Train Loss: 0.360 Vali Loss: 4.541 Vali Acc: 0.500 Test Loss: 4.541 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.3100225925445557
Epoch: 26, Steps: 13 | Train Loss: 0.215 Vali Loss: 4.138 Vali Acc: 0.517 Test Loss: 4.138 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 893658
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.683133363723755
Epoch: 1, Steps: 13 | Train Loss: 0.849 Vali Loss: 0.893 Vali Acc: 0.533 Test Loss: 0.893 Test Acc: 0.533
Validation loss decreased (inf --> -0.533324).  Saving model ...
Epoch: 2 cost time: 1.950989007949829
Epoch: 2, Steps: 13 | Train Loss: 1.121 Vali Loss: 1.202 Vali Acc: 0.494 Test Loss: 1.202 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.030165433883667
Epoch: 3, Steps: 13 | Train Loss: 0.948 Vali Loss: 0.863 Vali Acc: 0.556 Test Loss: 0.863 Test Acc: 0.556
Validation loss decreased (-0.533324 --> -0.555547).  Saving model ...
Epoch: 4 cost time: 1.968339443206787
Epoch: 4, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.917 Vali Acc: 0.483 Test Loss: 0.917 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.014827251434326
Epoch: 5, Steps: 13 | Train Loss: 0.608 Vali Loss: 1.460 Vali Acc: 0.478 Test Loss: 1.460 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8923897743225098
Epoch: 6, Steps: 13 | Train Loss: 0.501 Vali Loss: 1.162 Vali Acc: 0.533 Test Loss: 1.162 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1017777919769287
Epoch: 7, Steps: 13 | Train Loss: 0.490 Vali Loss: 1.733 Vali Acc: 0.494 Test Loss: 1.733 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9886536598205566
Epoch: 8, Steps: 13 | Train Loss: 0.742 Vali Loss: 1.494 Vali Acc: 0.522 Test Loss: 1.494 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9641532897949219
Epoch: 9, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.318 Vali Acc: 0.511 Test Loss: 1.318 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.027157783508301
Epoch: 10, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.512 Vali Acc: 0.522 Test Loss: 1.512 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9605021476745605
Epoch: 11, Steps: 13 | Train Loss: 0.220 Vali Loss: 2.173 Vali Acc: 0.539 Test Loss: 2.173 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9888644218444824
Epoch: 12, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.928 Vali Acc: 0.528 Test Loss: 1.928 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9332680702209473
Epoch: 13, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.907 Vali Acc: 0.511 Test Loss: 1.907 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 893658
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.311063528060913
Epoch: 1, Steps: 13 | Train Loss: 0.860 Vali Loss: 0.819 Vali Acc: 0.533 Test Loss: 0.819 Test Acc: 0.533
Validation loss decreased (inf --> -0.533325).  Saving model ...
Epoch: 2 cost time: 1.6889798641204834
Epoch: 2, Steps: 13 | Train Loss: 1.090 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7447731494903564
Epoch: 3, Steps: 13 | Train Loss: 1.039 Vali Loss: 0.944 Vali Acc: 0.511 Test Loss: 0.944 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7629215717315674
Epoch: 4, Steps: 13 | Train Loss: 1.028 Vali Loss: 1.117 Vali Acc: 0.472 Test Loss: 1.117 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.799041748046875
Epoch: 5, Steps: 13 | Train Loss: 0.800 Vali Loss: 0.843 Vali Acc: 0.561 Test Loss: 0.843 Test Acc: 0.561
Validation loss decreased (-0.533325 --> -0.561103).  Saving model ...
Epoch: 6 cost time: 1.707474946975708
Epoch: 6, Steps: 13 | Train Loss: 0.654 Vali Loss: 1.185 Vali Acc: 0.506 Test Loss: 1.185 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7703547477722168
Epoch: 7, Steps: 13 | Train Loss: 0.881 Vali Loss: 1.363 Vali Acc: 0.478 Test Loss: 1.363 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6185741424560547
Epoch: 8, Steps: 13 | Train Loss: 0.766 Vali Loss: 1.978 Vali Acc: 0.528 Test Loss: 1.978 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7598178386688232
Epoch: 9, Steps: 13 | Train Loss: 0.877 Vali Loss: 1.764 Vali Acc: 0.489 Test Loss: 1.764 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6865131855010986
Epoch: 10, Steps: 13 | Train Loss: 0.775 Vali Loss: 1.736 Vali Acc: 0.528 Test Loss: 1.736 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8014798164367676
Epoch: 11, Steps: 13 | Train Loss: 0.672 Vali Loss: 2.513 Vali Acc: 0.483 Test Loss: 2.513 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7755975723266602
Epoch: 12, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.429 Vali Acc: 0.528 Test Loss: 1.429 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.762397050857544
Epoch: 13, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.657 Vali Acc: 0.506 Test Loss: 1.657 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.771822452545166
Epoch: 14, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.765 Vali Acc: 0.517 Test Loss: 1.765 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7666618824005127
Epoch: 15, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.860 Vali Acc: 0.494 Test Loss: 1.860 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 893658
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.9906234741210938
Epoch: 1, Steps: 13 | Train Loss: 0.815 Vali Loss: 1.575 Vali Acc: 0.500 Test Loss: 1.575 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 2.167501449584961
Epoch: 2, Steps: 13 | Train Loss: 1.245 Vali Loss: 1.116 Vali Acc: 0.489 Test Loss: 1.116 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.202820301055908
Epoch: 3, Steps: 13 | Train Loss: 0.872 Vali Loss: 1.556 Vali Acc: 0.472 Test Loss: 1.556 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.076993942260742
Epoch: 4, Steps: 13 | Train Loss: 0.733 Vali Loss: 1.231 Vali Acc: 0.539 Test Loss: 1.231 Test Acc: 0.539
Validation loss decreased (-0.499984 --> -0.538877).  Saving model ...
Epoch: 5 cost time: 2.0941989421844482
Epoch: 5, Steps: 13 | Train Loss: 0.634 Vali Loss: 1.282 Vali Acc: 0.522 Test Loss: 1.282 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0562288761138916
Epoch: 6, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.368 Vali Acc: 0.511 Test Loss: 1.368 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.193392276763916
Epoch: 7, Steps: 13 | Train Loss: 0.503 Vali Loss: 1.366 Vali Acc: 0.528 Test Loss: 1.366 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.121307373046875
Epoch: 8, Steps: 13 | Train Loss: 0.332 Vali Loss: 2.168 Vali Acc: 0.528 Test Loss: 2.168 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.219998598098755
Epoch: 9, Steps: 13 | Train Loss: 0.488 Vali Loss: 1.805 Vali Acc: 0.528 Test Loss: 1.805 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1670219898223877
Epoch: 10, Steps: 13 | Train Loss: 0.222 Vali Loss: 2.074 Vali Acc: 0.500 Test Loss: 2.074 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.081446647644043
Epoch: 11, Steps: 13 | Train Loss: 0.234 Vali Loss: 2.043 Vali Acc: 0.528 Test Loss: 2.043 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.028322219848633
Epoch: 12, Steps: 13 | Train Loss: 0.157 Vali Loss: 2.091 Vali Acc: 0.517 Test Loss: 2.091 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9314639568328857
Epoch: 13, Steps: 13 | Train Loss: 0.174 Vali Loss: 2.067 Vali Acc: 0.556 Test Loss: 2.067 Test Acc: 0.556
Validation loss decreased (-0.538877 --> -0.555535).  Saving model ...
Epoch: 14 cost time: 2.011026620864868
Epoch: 14, Steps: 13 | Train Loss: 0.107 Vali Loss: 3.023 Vali Acc: 0.533 Test Loss: 3.023 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0974225997924805
Epoch: 15, Steps: 13 | Train Loss: 0.290 Vali Loss: 2.472 Vali Acc: 0.539 Test Loss: 2.472 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0365710258483887
Epoch: 16, Steps: 13 | Train Loss: 0.231 Vali Loss: 2.419 Vali Acc: 0.528 Test Loss: 2.419 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.079740047454834
Epoch: 17, Steps: 13 | Train Loss: 0.071 Vali Loss: 2.869 Vali Acc: 0.539 Test Loss: 2.869 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9937443733215332
Epoch: 18, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.818 Vali Acc: 0.533 Test Loss: 2.818 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1913509368896484
Epoch: 19, Steps: 13 | Train Loss: 0.059 Vali Loss: 2.841 Vali Acc: 0.539 Test Loss: 2.841 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.144744873046875
Epoch: 20, Steps: 13 | Train Loss: 0.021 Vali Loss: 2.975 Vali Acc: 0.544 Test Loss: 2.975 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.107189178466797
Epoch: 21, Steps: 13 | Train Loss: 0.048 Vali Loss: 3.119 Vali Acc: 0.550 Test Loss: 3.119 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.064277172088623
Epoch: 22, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.939 Vali Acc: 0.567 Test Loss: 2.939 Test Acc: 0.567
Validation loss decreased (-0.555535 --> -0.566637).  Saving model ...
Epoch: 23 cost time: 2.0651063919067383
Epoch: 23, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.226 Vali Acc: 0.556 Test Loss: 3.226 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0462217330932617
Epoch: 24, Steps: 13 | Train Loss: 0.006 Vali Loss: 3.199 Vali Acc: 0.539 Test Loss: 3.199 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9427826404571533
Epoch: 25, Steps: 13 | Train Loss: 0.017 Vali Loss: 3.412 Vali Acc: 0.550 Test Loss: 3.412 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.161057710647583
Epoch: 26, Steps: 13 | Train Loss: 0.003 Vali Loss: 3.500 Vali Acc: 0.533 Test Loss: 3.500 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.972470998764038
Epoch: 27, Steps: 13 | Train Loss: 0.039 Vali Loss: 3.634 Vali Acc: 0.517 Test Loss: 3.634 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.115781784057617
Epoch: 28, Steps: 13 | Train Loss: 0.094 Vali Loss: 3.947 Vali Acc: 0.539 Test Loss: 3.947 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9876856803894043
Epoch: 29, Steps: 13 | Train Loss: 0.025 Vali Loss: 4.180 Vali Acc: 0.528 Test Loss: 4.180 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.2257604598999023
Epoch: 30, Steps: 13 | Train Loss: 0.019 Vali Loss: 4.335 Vali Acc: 0.483 Test Loss: 4.335 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.2447378635406494
Epoch: 31, Steps: 13 | Train Loss: 0.096 Vali Loss: 4.171 Vali Acc: 0.517 Test Loss: 4.171 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.206120252609253
Epoch: 32, Steps: 13 | Train Loss: 0.016 Vali Loss: 4.928 Vali Acc: 0.500 Test Loss: 4.928 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 631514
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.665443181991577
Epoch: 1, Steps: 13 | Train Loss: 0.804 Vali Loss: 1.552 Vali Acc: 0.500 Test Loss: 1.552 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 2.1803786754608154
Epoch: 2, Steps: 13 | Train Loss: 1.255 Vali Loss: 1.138 Vali Acc: 0.489 Test Loss: 1.138 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.177539348602295
Epoch: 3, Steps: 13 | Train Loss: 0.916 Vali Loss: 1.154 Vali Acc: 0.511 Test Loss: 1.154 Test Acc: 0.511
Validation loss decreased (-0.499984 --> -0.511100).  Saving model ...
Epoch: 4 cost time: 2.217226505279541
Epoch: 4, Steps: 13 | Train Loss: 0.607 Vali Loss: 1.047 Vali Acc: 0.461 Test Loss: 1.047 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0438385009765625
Epoch: 5, Steps: 13 | Train Loss: 0.614 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.053598642349243
Epoch: 6, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.359 Vali Acc: 0.467 Test Loss: 1.359 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0693318843841553
Epoch: 7, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.393 Vali Acc: 0.506 Test Loss: 1.393 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.011833667755127
Epoch: 8, Steps: 13 | Train Loss: 0.343 Vali Loss: 2.076 Vali Acc: 0.483 Test Loss: 2.076 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.076669216156006
Epoch: 9, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.630 Vali Acc: 0.511 Test Loss: 1.630 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.076801300048828
Epoch: 10, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.688 Vali Acc: 0.539 Test Loss: 1.688 Test Acc: 0.539
Validation loss decreased (-0.511100 --> -0.538872).  Saving model ...
Epoch: 11 cost time: 2.196495294570923
Epoch: 11, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.767 Vali Acc: 0.506 Test Loss: 1.767 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8758955001831055
Epoch: 12, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.938 Vali Acc: 0.483 Test Loss: 1.938 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8979713916778564
Epoch: 13, Steps: 13 | Train Loss: 0.162 Vali Loss: 2.911 Vali Acc: 0.494 Test Loss: 2.911 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.818521499633789
Epoch: 14, Steps: 13 | Train Loss: 0.242 Vali Loss: 2.247 Vali Acc: 0.522 Test Loss: 2.247 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7723593711853027
Epoch: 15, Steps: 13 | Train Loss: 0.137 Vali Loss: 3.280 Vali Acc: 0.511 Test Loss: 3.280 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8898811340332031
Epoch: 16, Steps: 13 | Train Loss: 0.460 Vali Loss: 2.592 Vali Acc: 0.483 Test Loss: 2.592 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9943060874938965
Epoch: 17, Steps: 13 | Train Loss: 0.138 Vali Loss: 2.541 Vali Acc: 0.511 Test Loss: 2.541 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1031875610351562
Epoch: 18, Steps: 13 | Train Loss: 0.077 Vali Loss: 3.861 Vali Acc: 0.522 Test Loss: 3.861 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.106919765472412
Epoch: 19, Steps: 13 | Train Loss: 0.383 Vali Loss: 2.956 Vali Acc: 0.539 Test Loss: 2.956 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9908726215362549
Epoch: 20, Steps: 13 | Train Loss: 0.124 Vali Loss: 2.871 Vali Acc: 0.528 Test Loss: 2.871 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 631514
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.522352695465088
Epoch: 1, Steps: 13 | Train Loss: 0.813 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 1.8932065963745117
Epoch: 2, Steps: 13 | Train Loss: 1.471 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.9561080932617188
Epoch: 3, Steps: 13 | Train Loss: 0.947 Vali Loss: 0.938 Vali Acc: 0.506 Test Loss: 0.938 Test Acc: 0.506
Validation loss decreased (-0.499987 --> -0.505546).  Saving model ...
Epoch: 4 cost time: 1.7871754169464111
Epoch: 4, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.970 Vali Acc: 0.483 Test Loss: 0.970 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7570984363555908
Epoch: 5, Steps: 13 | Train Loss: 0.740 Vali Loss: 1.869 Vali Acc: 0.528 Test Loss: 1.869 Test Acc: 0.528
Validation loss decreased (-0.505546 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 1.753065586090088
Epoch: 6, Steps: 13 | Train Loss: 0.842 Vali Loss: 1.397 Vali Acc: 0.478 Test Loss: 1.397 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8077363967895508
Epoch: 7, Steps: 13 | Train Loss: 0.576 Vali Loss: 1.230 Vali Acc: 0.494 Test Loss: 1.230 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8366353511810303
Epoch: 8, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.343 Vali Acc: 0.472 Test Loss: 1.343 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9278182983398438
Epoch: 9, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.697 Vali Acc: 0.489 Test Loss: 1.697 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9013307094573975
Epoch: 10, Steps: 13 | Train Loss: 0.551 Vali Loss: 1.716 Vali Acc: 0.511 Test Loss: 1.716 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9510376453399658
Epoch: 11, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.641 Vali Acc: 0.539 Test Loss: 1.641 Test Acc: 0.539
Validation loss decreased (-0.527759 --> -0.538872).  Saving model ...
Epoch: 12 cost time: 1.740220069885254
Epoch: 12, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.795 Vali Acc: 0.522 Test Loss: 1.795 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7985882759094238
Epoch: 13, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.727 Vali Acc: 0.511 Test Loss: 1.727 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7580199241638184
Epoch: 14, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.942 Vali Acc: 0.528 Test Loss: 1.942 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8409266471862793
Epoch: 15, Steps: 13 | Train Loss: 0.189 Vali Loss: 2.360 Vali Acc: 0.517 Test Loss: 2.360 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9370348453521729
Epoch: 16, Steps: 13 | Train Loss: 0.355 Vali Loss: 2.587 Vali Acc: 0.506 Test Loss: 2.587 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9176268577575684
Epoch: 17, Steps: 13 | Train Loss: 0.113 Vali Loss: 2.741 Vali Acc: 0.506 Test Loss: 2.741 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.914801836013794
Epoch: 18, Steps: 13 | Train Loss: 0.143 Vali Loss: 2.436 Vali Acc: 0.544 Test Loss: 2.436 Test Acc: 0.544
Validation loss decreased (-0.538872 --> -0.544420).  Saving model ...
Epoch: 19 cost time: 1.8521738052368164
Epoch: 19, Steps: 13 | Train Loss: 0.082 Vali Loss: 2.629 Vali Acc: 0.517 Test Loss: 2.629 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7759082317352295
Epoch: 20, Steps: 13 | Train Loss: 0.039 Vali Loss: 2.890 Vali Acc: 0.517 Test Loss: 2.890 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8058669567108154
Epoch: 21, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.869 Vali Acc: 0.500 Test Loss: 2.869 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7826685905456543
Epoch: 22, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.914 Vali Acc: 0.483 Test Loss: 2.914 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8543739318847656
Epoch: 23, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.939 Vali Acc: 0.467 Test Loss: 2.939 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7839066982269287
Epoch: 24, Steps: 13 | Train Loss: 0.008 Vali Loss: 3.267 Vali Acc: 0.489 Test Loss: 3.267 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.929131269454956
Epoch: 25, Steps: 13 | Train Loss: 0.022 Vali Loss: 3.625 Vali Acc: 0.478 Test Loss: 3.625 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9719617366790771
Epoch: 26, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.928 Vali Acc: 0.511 Test Loss: 2.928 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8602094650268555
Epoch: 27, Steps: 13 | Train Loss: 0.018 Vali Loss: 3.388 Vali Acc: 0.494 Test Loss: 3.388 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8450429439544678
Epoch: 28, Steps: 13 | Train Loss: 0.109 Vali Loss: 4.460 Vali Acc: 0.478 Test Loss: 4.460 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 631514
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3010056018829346
Epoch: 1, Steps: 13 | Train Loss: 0.825 Vali Loss: 1.446 Vali Acc: 0.500 Test Loss: 1.446 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 1.6498005390167236
Epoch: 2, Steps: 13 | Train Loss: 1.568 Vali Loss: 1.065 Vali Acc: 0.517 Test Loss: 1.065 Test Acc: 0.517
Validation loss decreased (-0.499986 --> -0.516656).  Saving model ...
Epoch: 3 cost time: 1.6199111938476562
Epoch: 3, Steps: 13 | Train Loss: 0.927 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5641627311706543
Epoch: 4, Steps: 13 | Train Loss: 0.818 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
Validation loss decreased (-0.516656 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 1.5830795764923096
Epoch: 5, Steps: 13 | Train Loss: 0.770 Vali Loss: 1.124 Vali Acc: 0.544 Test Loss: 1.124 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5998742580413818
Epoch: 6, Steps: 13 | Train Loss: 0.656 Vali Loss: 1.206 Vali Acc: 0.517 Test Loss: 1.206 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5520987510681152
Epoch: 7, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.899 Vali Acc: 0.572 Test Loss: 0.899 Test Acc: 0.572
Validation loss decreased (-0.549992 --> -0.572213).  Saving model ...
Epoch: 8 cost time: 1.6706275939941406
Epoch: 8, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.578 Vali Acc: 0.506 Test Loss: 1.578 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.701179027557373
Epoch: 9, Steps: 13 | Train Loss: 0.534 Vali Loss: 1.352 Vali Acc: 0.522 Test Loss: 1.352 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7824451923370361
Epoch: 10, Steps: 13 | Train Loss: 0.800 Vali Loss: 1.429 Vali Acc: 0.517 Test Loss: 1.429 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.80078125
Epoch: 11, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.264 Vali Acc: 0.539 Test Loss: 1.264 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.698847770690918
Epoch: 12, Steps: 13 | Train Loss: 0.295 Vali Loss: 2.112 Vali Acc: 0.483 Test Loss: 2.112 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7326083183288574
Epoch: 13, Steps: 13 | Train Loss: 0.336 Vali Loss: 2.127 Vali Acc: 0.472 Test Loss: 2.127 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7218172550201416
Epoch: 14, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.907 Vali Acc: 0.517 Test Loss: 1.907 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7209110260009766
Epoch: 15, Steps: 13 | Train Loss: 0.327 Vali Loss: 2.043 Vali Acc: 0.506 Test Loss: 2.043 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6478140354156494
Epoch: 16, Steps: 13 | Train Loss: 0.710 Vali Loss: 3.424 Vali Acc: 0.494 Test Loss: 3.424 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.668489933013916
Epoch: 17, Steps: 13 | Train Loss: 0.637 Vali Loss: 2.216 Vali Acc: 0.472 Test Loss: 2.216 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 631514
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.755671739578247
Epoch: 1, Steps: 13 | Train Loss: 0.869 Vali Loss: 0.935 Vali Acc: 0.494 Test Loss: 0.935 Test Acc: 0.494
Validation loss decreased (inf --> -0.494435).  Saving model ...
Epoch: 2 cost time: 2.1104140281677246
Epoch: 2, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.781 Vali Acc: 0.522 Test Loss: 0.781 Test Acc: 0.522
Validation loss decreased (-0.494435 --> -0.522214).  Saving model ...
Epoch: 3 cost time: 2.1582469940185547
Epoch: 3, Steps: 13 | Train Loss: 0.635 Vali Loss: 1.080 Vali Acc: 0.544 Test Loss: 1.080 Test Acc: 0.544
Validation loss decreased (-0.522214 --> -0.544434).  Saving model ...
Epoch: 4 cost time: 2.2464802265167236
Epoch: 4, Steps: 13 | Train Loss: 0.814 Vali Loss: 1.077 Vali Acc: 0.561 Test Loss: 1.077 Test Acc: 0.561
Validation loss decreased (-0.544434 --> -0.561100).  Saving model ...
Epoch: 5 cost time: 2.2065277099609375
Epoch: 5, Steps: 13 | Train Loss: 0.765 Vali Loss: 1.169 Vali Acc: 0.522 Test Loss: 1.169 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2484066486358643
Epoch: 6, Steps: 13 | Train Loss: 0.439 Vali Loss: 1.252 Vali Acc: 0.511 Test Loss: 1.252 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.095996379852295
Epoch: 7, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.708 Vali Acc: 0.456 Test Loss: 1.708 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0175681114196777
Epoch: 8, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.400 Vali Acc: 0.572 Test Loss: 1.400 Test Acc: 0.572
Validation loss decreased (-0.561100 --> -0.572208).  Saving model ...
Epoch: 9 cost time: 2.106658697128296
Epoch: 9, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.511 Vali Acc: 0.539 Test Loss: 1.511 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.089719295501709
Epoch: 10, Steps: 13 | Train Loss: 0.308 Vali Loss: 2.103 Vali Acc: 0.517 Test Loss: 2.103 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.010200262069702
Epoch: 11, Steps: 13 | Train Loss: 0.417 Vali Loss: 2.389 Vali Acc: 0.494 Test Loss: 2.389 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2272796630859375
Epoch: 12, Steps: 13 | Train Loss: 0.330 Vali Loss: 2.655 Vali Acc: 0.506 Test Loss: 2.655 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1301004886627197
Epoch: 13, Steps: 13 | Train Loss: 0.210 Vali Loss: 2.092 Vali Acc: 0.544 Test Loss: 2.092 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9301209449768066
Epoch: 14, Steps: 13 | Train Loss: 0.128 Vali Loss: 2.458 Vali Acc: 0.517 Test Loss: 2.458 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0731678009033203
Epoch: 15, Steps: 13 | Train Loss: 0.141 Vali Loss: 2.470 Vali Acc: 0.578 Test Loss: 2.470 Test Acc: 0.578
Validation loss decreased (-0.572208 --> -0.577753).  Saving model ...
Epoch: 16 cost time: 2.0439372062683105
Epoch: 16, Steps: 13 | Train Loss: 0.430 Vali Loss: 3.980 Vali Acc: 0.506 Test Loss: 3.980 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8540754318237305
Epoch: 17, Steps: 13 | Train Loss: 0.305 Vali Loss: 2.449 Vali Acc: 0.556 Test Loss: 2.449 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0643150806427
Epoch: 18, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.540 Vali Acc: 0.528 Test Loss: 2.540 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0407423973083496
Epoch: 19, Steps: 13 | Train Loss: 0.071 Vali Loss: 2.744 Vali Acc: 0.550 Test Loss: 2.744 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1092257499694824
Epoch: 20, Steps: 13 | Train Loss: 0.091 Vali Loss: 3.300 Vali Acc: 0.539 Test Loss: 3.300 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.110947370529175
Epoch: 21, Steps: 13 | Train Loss: 0.124 Vali Loss: 3.819 Vali Acc: 0.539 Test Loss: 3.819 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.060140371322632
Epoch: 22, Steps: 13 | Train Loss: 0.226 Vali Loss: 3.104 Vali Acc: 0.550 Test Loss: 3.104 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0610077381134033
Epoch: 23, Steps: 13 | Train Loss: 0.041 Vali Loss: 3.983 Vali Acc: 0.506 Test Loss: 3.983 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.000333786010742
Epoch: 24, Steps: 13 | Train Loss: 0.160 Vali Loss: 3.424 Vali Acc: 0.539 Test Loss: 3.424 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0155932903289795
Epoch: 25, Steps: 13 | Train Loss: 0.084 Vali Loss: 3.647 Vali Acc: 0.550 Test Loss: 3.647 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 500442
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5301499366760254
Epoch: 1, Steps: 13 | Train Loss: 0.853 Vali Loss: 0.919 Vali Acc: 0.506 Test Loss: 0.919 Test Acc: 0.506
Validation loss decreased (inf --> -0.505546).  Saving model ...
Epoch: 2 cost time: 1.9111106395721436
Epoch: 2, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.758 Vali Acc: 0.533 Test Loss: 0.758 Test Acc: 0.533
Validation loss decreased (-0.505546 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.8870892524719238
Epoch: 3, Steps: 13 | Train Loss: 0.648 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.947805404663086
Epoch: 4, Steps: 13 | Train Loss: 0.769 Vali Loss: 1.034 Vali Acc: 0.522 Test Loss: 1.034 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0143425464630127
Epoch: 5, Steps: 13 | Train Loss: 0.869 Vali Loss: 1.119 Vali Acc: 0.528 Test Loss: 1.119 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0899178981781006
Epoch: 6, Steps: 13 | Train Loss: 0.465 Vali Loss: 1.158 Vali Acc: 0.517 Test Loss: 1.158 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.181234836578369
Epoch: 7, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.716 Vali Acc: 0.483 Test Loss: 1.716 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1445581912994385
Epoch: 8, Steps: 13 | Train Loss: 0.652 Vali Loss: 1.711 Vali Acc: 0.494 Test Loss: 1.711 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0044820308685303
Epoch: 9, Steps: 13 | Train Loss: 0.467 Vali Loss: 1.619 Vali Acc: 0.539 Test Loss: 1.619 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538873).  Saving model ...
Epoch: 10 cost time: 2.040546178817749
Epoch: 10, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.800 Vali Acc: 0.533 Test Loss: 1.800 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0850863456726074
Epoch: 11, Steps: 13 | Train Loss: 0.493 Vali Loss: 2.012 Vali Acc: 0.528 Test Loss: 2.012 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9002540111541748
Epoch: 12, Steps: 13 | Train Loss: 0.449 Vali Loss: 3.498 Vali Acc: 0.494 Test Loss: 3.498 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.265427589416504
Epoch: 13, Steps: 13 | Train Loss: 0.885 Vali Loss: 3.153 Vali Acc: 0.483 Test Loss: 3.153 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1011550426483154
Epoch: 14, Steps: 13 | Train Loss: 0.266 Vali Loss: 2.202 Vali Acc: 0.544 Test Loss: 2.202 Test Acc: 0.544
Validation loss decreased (-0.538873 --> -0.544422).  Saving model ...
Epoch: 15 cost time: 2.076260805130005
Epoch: 15, Steps: 13 | Train Loss: 0.203 Vali Loss: 2.398 Vali Acc: 0.550 Test Loss: 2.398 Test Acc: 0.550
Validation loss decreased (-0.544422 --> -0.549976).  Saving model ...
Epoch: 16 cost time: 2.0540645122528076
Epoch: 16, Steps: 13 | Train Loss: 0.103 Vali Loss: 2.116 Vali Acc: 0.528 Test Loss: 2.116 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0138611793518066
Epoch: 17, Steps: 13 | Train Loss: 0.071 Vali Loss: 2.412 Vali Acc: 0.511 Test Loss: 2.412 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.949707269668579
Epoch: 18, Steps: 13 | Train Loss: 0.132 Vali Loss: 2.589 Vali Acc: 0.550 Test Loss: 2.589 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0647037029266357
Epoch: 19, Steps: 13 | Train Loss: 0.092 Vali Loss: 3.620 Vali Acc: 0.511 Test Loss: 3.620 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0771377086639404
Epoch: 20, Steps: 13 | Train Loss: 0.386 Vali Loss: 2.772 Vali Acc: 0.506 Test Loss: 2.772 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.159759759902954
Epoch: 21, Steps: 13 | Train Loss: 0.140 Vali Loss: 2.764 Vali Acc: 0.572 Test Loss: 2.764 Test Acc: 0.572
Validation loss decreased (-0.549976 --> -0.572195).  Saving model ...
Epoch: 22 cost time: 2.096189498901367
Epoch: 22, Steps: 13 | Train Loss: 0.156 Vali Loss: 3.841 Vali Acc: 0.511 Test Loss: 3.841 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9193041324615479
Epoch: 23, Steps: 13 | Train Loss: 0.164 Vali Loss: 2.863 Vali Acc: 0.556 Test Loss: 2.863 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8974907398223877
Epoch: 24, Steps: 13 | Train Loss: 0.018 Vali Loss: 3.262 Vali Acc: 0.517 Test Loss: 3.262 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.761338233947754
Epoch: 25, Steps: 13 | Train Loss: 0.012 Vali Loss: 3.226 Vali Acc: 0.544 Test Loss: 3.226 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9409124851226807
Epoch: 26, Steps: 13 | Train Loss: 0.037 Vali Loss: 3.473 Vali Acc: 0.556 Test Loss: 3.473 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9988157749176025
Epoch: 27, Steps: 13 | Train Loss: 0.060 Vali Loss: 3.682 Vali Acc: 0.511 Test Loss: 3.682 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0265579223632812
Epoch: 28, Steps: 13 | Train Loss: 0.021 Vali Loss: 3.720 Vali Acc: 0.506 Test Loss: 3.720 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.084252119064331
Epoch: 29, Steps: 13 | Train Loss: 0.020 Vali Loss: 3.949 Vali Acc: 0.511 Test Loss: 3.949 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.096956491470337
Epoch: 30, Steps: 13 | Train Loss: 0.034 Vali Loss: 3.663 Vali Acc: 0.517 Test Loss: 3.663 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8994724750518799
Epoch: 31, Steps: 13 | Train Loss: 0.059 Vali Loss: 4.327 Vali Acc: 0.511 Test Loss: 4.327 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 500442
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5862271785736084
Epoch: 1, Steps: 13 | Train Loss: 0.836 Vali Loss: 0.949 Vali Acc: 0.506 Test Loss: 0.949 Test Acc: 0.506
Validation loss decreased (inf --> -0.505546).  Saving model ...
Epoch: 2 cost time: 1.918701410293579
Epoch: 2, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8515760898590088
Epoch: 3, Steps: 13 | Train Loss: 0.664 Vali Loss: 1.034 Vali Acc: 0.561 Test Loss: 1.034 Test Acc: 0.561
Validation loss decreased (-0.505546 --> -0.561101).  Saving model ...
Epoch: 4 cost time: 1.8793237209320068
Epoch: 4, Steps: 13 | Train Loss: 0.863 Vali Loss: 1.039 Vali Acc: 0.517 Test Loss: 1.039 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8629565238952637
Epoch: 5, Steps: 13 | Train Loss: 0.840 Vali Loss: 1.575 Vali Acc: 0.522 Test Loss: 1.575 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.841001033782959
Epoch: 6, Steps: 13 | Train Loss: 0.616 Vali Loss: 1.201 Vali Acc: 0.550 Test Loss: 1.201 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8296208381652832
Epoch: 7, Steps: 13 | Train Loss: 0.471 Vali Loss: 1.920 Vali Acc: 0.489 Test Loss: 1.920 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7808630466461182
Epoch: 8, Steps: 13 | Train Loss: 0.624 Vali Loss: 1.628 Vali Acc: 0.528 Test Loss: 1.628 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8933935165405273
Epoch: 9, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.279 Vali Acc: 0.522 Test Loss: 1.279 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9507718086242676
Epoch: 10, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.410 Vali Acc: 0.539 Test Loss: 1.410 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.034804105758667
Epoch: 11, Steps: 13 | Train Loss: 0.468 Vali Loss: 1.595 Vali Acc: 0.522 Test Loss: 1.595 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8403875827789307
Epoch: 12, Steps: 13 | Train Loss: 0.274 Vali Loss: 2.627 Vali Acc: 0.489 Test Loss: 2.627 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8026676177978516
Epoch: 13, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.711 Vali Acc: 0.500 Test Loss: 1.711 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 500442
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.323153495788574
Epoch: 1, Steps: 13 | Train Loss: 0.826 Vali Loss: 0.995 Vali Acc: 0.494 Test Loss: 0.995 Test Acc: 0.494
Validation loss decreased (inf --> -0.494434).  Saving model ...
Epoch: 2 cost time: 1.6533215045928955
Epoch: 2, Steps: 13 | Train Loss: 0.796 Vali Loss: 0.778 Vali Acc: 0.522 Test Loss: 0.778 Test Acc: 0.522
Validation loss decreased (-0.494434 --> -0.522214).  Saving model ...
Epoch: 3 cost time: 1.5318503379821777
Epoch: 3, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.965 Vali Acc: 0.506 Test Loss: 0.965 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5986669063568115
Epoch: 4, Steps: 13 | Train Loss: 0.862 Vali Loss: 0.878 Vali Acc: 0.544 Test Loss: 0.878 Test Acc: 0.544
Validation loss decreased (-0.522214 --> -0.544436).  Saving model ...
Epoch: 5 cost time: 1.5287375450134277
Epoch: 5, Steps: 13 | Train Loss: 0.803 Vali Loss: 1.627 Vali Acc: 0.550 Test Loss: 1.627 Test Acc: 0.550
Validation loss decreased (-0.544436 --> -0.549984).  Saving model ...
Epoch: 6 cost time: 1.590223789215088
Epoch: 6, Steps: 13 | Train Loss: 0.843 Vali Loss: 0.989 Vali Acc: 0.494 Test Loss: 0.989 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5498783588409424
Epoch: 7, Steps: 13 | Train Loss: 0.884 Vali Loss: 0.985 Vali Acc: 0.528 Test Loss: 0.985 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6879868507385254
Epoch: 8, Steps: 13 | Train Loss: 1.311 Vali Loss: 3.011 Vali Acc: 0.500 Test Loss: 3.011 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6600823402404785
Epoch: 9, Steps: 13 | Train Loss: 1.356 Vali Loss: 1.467 Vali Acc: 0.500 Test Loss: 1.467 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.730341911315918
Epoch: 10, Steps: 13 | Train Loss: 1.167 Vali Loss: 1.844 Vali Acc: 0.511 Test Loss: 1.844 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6298973560333252
Epoch: 11, Steps: 13 | Train Loss: 0.558 Vali Loss: 1.152 Vali Acc: 0.506 Test Loss: 1.152 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5866436958312988
Epoch: 12, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.965 Vali Acc: 0.467 Test Loss: 1.965 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5750799179077148
Epoch: 13, Steps: 13 | Train Loss: 0.401 Vali Loss: 1.653 Vali Acc: 0.556 Test Loss: 1.653 Test Acc: 0.556
Validation loss decreased (-0.549984 --> -0.555539).  Saving model ...
Epoch: 14 cost time: 1.5712165832519531
Epoch: 14, Steps: 13 | Train Loss: 0.291 Vali Loss: 2.308 Vali Acc: 0.511 Test Loss: 2.308 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6224610805511475
Epoch: 15, Steps: 13 | Train Loss: 0.671 Vali Loss: 1.543 Vali Acc: 0.533 Test Loss: 1.543 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6467397212982178
Epoch: 16, Steps: 13 | Train Loss: 0.510 Vali Loss: 2.612 Vali Acc: 0.506 Test Loss: 2.612 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6406757831573486
Epoch: 17, Steps: 13 | Train Loss: 0.798 Vali Loss: 3.192 Vali Acc: 0.500 Test Loss: 3.192 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5724093914031982
Epoch: 18, Steps: 13 | Train Loss: 0.472 Vali Loss: 2.127 Vali Acc: 0.511 Test Loss: 2.127 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7020797729492188
Epoch: 19, Steps: 13 | Train Loss: 0.187 Vali Loss: 2.021 Vali Acc: 0.489 Test Loss: 2.021 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6091649532318115
Epoch: 20, Steps: 13 | Train Loss: 0.089 Vali Loss: 2.450 Vali Acc: 0.511 Test Loss: 2.450 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5079219341278076
Epoch: 21, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.746 Vali Acc: 0.478 Test Loss: 2.746 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6161925792694092
Epoch: 22, Steps: 13 | Train Loss: 0.066 Vali Loss: 2.933 Vali Acc: 0.483 Test Loss: 2.933 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5876786708831787
Epoch: 23, Steps: 13 | Train Loss: 0.128 Vali Loss: 3.283 Vali Acc: 0.494 Test Loss: 3.283 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 500442
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8269460201263428
Epoch: 1, Steps: 13 | Train Loss: 0.774 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 2.147491931915283
Epoch: 2, Steps: 13 | Train Loss: 1.242 Vali Loss: 2.064 Vali Acc: 0.500 Test Loss: 2.064 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.099008321762085
Epoch: 3, Steps: 13 | Train Loss: 1.356 Vali Loss: 1.702 Vali Acc: 0.494 Test Loss: 1.702 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.083242654800415
Epoch: 4, Steps: 13 | Train Loss: 0.884 Vali Loss: 1.785 Vali Acc: 0.544 Test Loss: 1.785 Test Acc: 0.544
Validation loss decreased (-0.499990 --> -0.544427).  Saving model ...
Epoch: 5 cost time: 2.1138527393341064
Epoch: 5, Steps: 13 | Train Loss: 0.637 Vali Loss: 1.211 Vali Acc: 0.533 Test Loss: 1.211 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.07529878616333
Epoch: 6, Steps: 13 | Train Loss: 0.471 Vali Loss: 1.518 Vali Acc: 0.511 Test Loss: 1.518 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.071293592453003
Epoch: 7, Steps: 13 | Train Loss: 0.747 Vali Loss: 1.833 Vali Acc: 0.533 Test Loss: 1.833 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.145843267440796
Epoch: 8, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.454 Vali Acc: 0.517 Test Loss: 1.454 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.196087598800659
Epoch: 9, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.686 Vali Acc: 0.528 Test Loss: 1.686 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0937552452087402
Epoch: 10, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.573 Vali Acc: 0.556 Test Loss: 1.573 Test Acc: 0.556
Validation loss decreased (-0.544427 --> -0.555540).  Saving model ...
Epoch: 11 cost time: 2.120012044906616
Epoch: 11, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.776 Vali Acc: 0.544 Test Loss: 1.776 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9417879581451416
Epoch: 12, Steps: 13 | Train Loss: 0.330 Vali Loss: 2.312 Vali Acc: 0.544 Test Loss: 2.312 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.108781337738037
Epoch: 13, Steps: 13 | Train Loss: 0.203 Vali Loss: 2.365 Vali Acc: 0.500 Test Loss: 2.365 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0518925189971924
Epoch: 14, Steps: 13 | Train Loss: 0.198 Vali Loss: 2.498 Vali Acc: 0.500 Test Loss: 2.498 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9961676597595215
Epoch: 15, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.509 Vali Acc: 0.561 Test Loss: 2.509 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561086).  Saving model ...
Epoch: 16 cost time: 2.1447489261627197
Epoch: 16, Steps: 13 | Train Loss: 0.092 Vali Loss: 2.705 Vali Acc: 0.556 Test Loss: 2.705 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6619837284088135
Epoch: 17, Steps: 13 | Train Loss: 0.104 Vali Loss: 2.670 Vali Acc: 0.528 Test Loss: 2.670 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6706297397613525
Epoch: 18, Steps: 13 | Train Loss: 0.098 Vali Loss: 5.070 Vali Acc: 0.511 Test Loss: 5.070 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6368224620819092
Epoch: 19, Steps: 13 | Train Loss: 0.602 Vali Loss: 4.515 Vali Acc: 0.500 Test Loss: 4.515 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.733823537826538
Epoch: 20, Steps: 13 | Train Loss: 0.166 Vali Loss: 3.615 Vali Acc: 0.539 Test Loss: 3.615 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9715986251831055
Epoch: 21, Steps: 13 | Train Loss: 0.298 Vali Loss: 3.388 Vali Acc: 0.539 Test Loss: 3.388 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.138303279876709
Epoch: 22, Steps: 13 | Train Loss: 0.298 Vali Loss: 5.784 Vali Acc: 0.511 Test Loss: 5.784 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.081425666809082
Epoch: 23, Steps: 13 | Train Loss: 0.255 Vali Loss: 3.856 Vali Acc: 0.517 Test Loss: 3.856 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9358174800872803
Epoch: 24, Steps: 13 | Train Loss: 0.065 Vali Loss: 4.754 Vali Acc: 0.522 Test Loss: 4.754 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.986884355545044
Epoch: 25, Steps: 13 | Train Loss: 0.141 Vali Loss: 4.145 Vali Acc: 0.567 Test Loss: 4.145 Test Acc: 0.567
Validation loss decreased (-0.561086 --> -0.566625).  Saving model ...
Epoch: 26 cost time: 1.8924188613891602
Epoch: 26, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.937 Vali Acc: 0.528 Test Loss: 3.937 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0608274936676025
Epoch: 27, Steps: 13 | Train Loss: 0.033 Vali Loss: 4.293 Vali Acc: 0.522 Test Loss: 4.293 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8831660747528076
Epoch: 28, Steps: 13 | Train Loss: 0.015 Vali Loss: 4.322 Vali Acc: 0.528 Test Loss: 4.322 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1335110664367676
Epoch: 29, Steps: 13 | Train Loss: 0.020 Vali Loss: 4.243 Vali Acc: 0.533 Test Loss: 4.243 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.064146041870117
Epoch: 30, Steps: 13 | Train Loss: 0.004 Vali Loss: 4.825 Vali Acc: 0.500 Test Loss: 4.825 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0374197959899902
Epoch: 31, Steps: 13 | Train Loss: 0.025 Vali Loss: 5.048 Vali Acc: 0.511 Test Loss: 5.048 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0318377017974854
Epoch: 32, Steps: 13 | Train Loss: 0.078 Vali Loss: 5.048 Vali Acc: 0.533 Test Loss: 5.048 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0556557178497314
Epoch: 33, Steps: 13 | Train Loss: 0.010 Vali Loss: 4.815 Vali Acc: 0.528 Test Loss: 4.815 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0739054679870605
Epoch: 34, Steps: 13 | Train Loss: 0.001 Vali Loss: 5.221 Vali Acc: 0.522 Test Loss: 5.221 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.168332815170288
Epoch: 35, Steps: 13 | Train Loss: 0.002 Vali Loss: 5.080 Vali Acc: 0.500 Test Loss: 5.080 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 434906
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.705226421356201
Epoch: 1, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.969 Vali Acc: 0.500 Test Loss: 0.969 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 1.961003065109253
Epoch: 2, Steps: 13 | Train Loss: 1.242 Vali Loss: 2.021 Vali Acc: 0.500 Test Loss: 2.021 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0300354957580566
Epoch: 3, Steps: 13 | Train Loss: 1.323 Vali Loss: 1.637 Vali Acc: 0.500 Test Loss: 1.637 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0735249519348145
Epoch: 4, Steps: 13 | Train Loss: 0.941 Vali Loss: 1.614 Vali Acc: 0.517 Test Loss: 1.614 Test Acc: 0.517
Validation loss decreased (-0.499990 --> -0.516651).  Saving model ...
Epoch: 5 cost time: 2.0275938510894775
Epoch: 5, Steps: 13 | Train Loss: 0.694 Vali Loss: 1.178 Vali Acc: 0.483 Test Loss: 1.178 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0925087928771973
Epoch: 6, Steps: 13 | Train Loss: 0.535 Vali Loss: 1.355 Vali Acc: 0.517 Test Loss: 1.355 Test Acc: 0.517
Validation loss decreased (-0.516651 --> -0.516653).  Saving model ...
Epoch: 7 cost time: 2.070732355117798
Epoch: 7, Steps: 13 | Train Loss: 0.768 Vali Loss: 1.626 Vali Acc: 0.500 Test Loss: 1.626 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0845837593078613
Epoch: 8, Steps: 13 | Train Loss: 0.726 Vali Loss: 1.839 Vali Acc: 0.517 Test Loss: 1.839 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1235573291778564
Epoch: 9, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.411 Vali Acc: 0.517 Test Loss: 1.411 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.043736696243286
Epoch: 10, Steps: 13 | Train Loss: 0.665 Vali Loss: 2.165 Vali Acc: 0.506 Test Loss: 2.165 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0790669918060303
Epoch: 11, Steps: 13 | Train Loss: 0.771 Vali Loss: 2.587 Vali Acc: 0.544 Test Loss: 2.587 Test Acc: 0.544
Validation loss decreased (-0.516653 --> -0.544419).  Saving model ...
Epoch: 12 cost time: 1.8916904926300049
Epoch: 12, Steps: 13 | Train Loss: 0.811 Vali Loss: 2.692 Vali Acc: 0.456 Test Loss: 2.692 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.03163743019104
Epoch: 13, Steps: 13 | Train Loss: 0.596 Vali Loss: 2.316 Vali Acc: 0.511 Test Loss: 2.316 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0094423294067383
Epoch: 14, Steps: 13 | Train Loss: 0.163 Vali Loss: 2.211 Vali Acc: 0.517 Test Loss: 2.211 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.010814666748047
Epoch: 15, Steps: 13 | Train Loss: 0.236 Vali Loss: 2.786 Vali Acc: 0.506 Test Loss: 2.786 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0984303951263428
Epoch: 16, Steps: 13 | Train Loss: 0.494 Vali Loss: 2.459 Vali Acc: 0.494 Test Loss: 2.459 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0527164936065674
Epoch: 17, Steps: 13 | Train Loss: 0.076 Vali Loss: 2.423 Vali Acc: 0.539 Test Loss: 2.423 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.823500394821167
Epoch: 18, Steps: 13 | Train Loss: 0.041 Vali Loss: 2.692 Vali Acc: 0.544 Test Loss: 2.692 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8332526683807373
Epoch: 19, Steps: 13 | Train Loss: 0.042 Vali Loss: 3.028 Vali Acc: 0.556 Test Loss: 3.028 Test Acc: 0.556
Validation loss decreased (-0.544419 --> -0.555525).  Saving model ...
Epoch: 20 cost time: 1.897301435470581
Epoch: 20, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.816 Vali Acc: 0.528 Test Loss: 2.816 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8462777137756348
Epoch: 21, Steps: 13 | Train Loss: 0.117 Vali Loss: 3.326 Vali Acc: 0.511 Test Loss: 3.326 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8241841793060303
Epoch: 22, Steps: 13 | Train Loss: 0.068 Vali Loss: 2.962 Vali Acc: 0.489 Test Loss: 2.962 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9394433498382568
Epoch: 23, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.131 Vali Acc: 0.500 Test Loss: 3.131 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9838294982910156
Epoch: 24, Steps: 13 | Train Loss: 0.031 Vali Loss: 3.439 Vali Acc: 0.544 Test Loss: 3.439 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0352156162261963
Epoch: 25, Steps: 13 | Train Loss: 0.067 Vali Loss: 3.350 Vali Acc: 0.517 Test Loss: 3.350 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.906785488128662
Epoch: 26, Steps: 13 | Train Loss: 0.020 Vali Loss: 3.559 Vali Acc: 0.533 Test Loss: 3.559 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.847184181213379
Epoch: 27, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.871 Vali Acc: 0.556 Test Loss: 3.871 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8942997455596924
Epoch: 28, Steps: 13 | Train Loss: 0.040 Vali Loss: 4.271 Vali Acc: 0.506 Test Loss: 4.271 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7994136810302734
Epoch: 29, Steps: 13 | Train Loss: 0.084 Vali Loss: 4.922 Vali Acc: 0.506 Test Loss: 4.922 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 434906
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.658022880554199
Epoch: 1, Steps: 13 | Train Loss: 0.779 Vali Loss: 0.952 Vali Acc: 0.500 Test Loss: 0.952 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 1.6913256645202637
Epoch: 2, Steps: 13 | Train Loss: 1.237 Vali Loss: 1.904 Vali Acc: 0.500 Test Loss: 1.904 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7619359493255615
Epoch: 3, Steps: 13 | Train Loss: 1.200 Vali Loss: 1.205 Vali Acc: 0.506 Test Loss: 1.205 Test Acc: 0.506
Validation loss decreased (-0.499990 --> -0.505544).  Saving model ...
Epoch: 4 cost time: 1.742119312286377
Epoch: 4, Steps: 13 | Train Loss: 0.776 Vali Loss: 1.109 Vali Acc: 0.528 Test Loss: 1.109 Test Acc: 0.528
Validation loss decreased (-0.505544 --> -0.527767).  Saving model ...
Epoch: 5 cost time: 1.8986518383026123
Epoch: 5, Steps: 13 | Train Loss: 0.691 Vali Loss: 1.234 Vali Acc: 0.533 Test Loss: 1.234 Test Acc: 0.533
Validation loss decreased (-0.527767 --> -0.533321).  Saving model ...
Epoch: 6 cost time: 1.8429031372070312
Epoch: 6, Steps: 13 | Train Loss: 0.973 Vali Loss: 1.549 Vali Acc: 0.522 Test Loss: 1.549 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9589972496032715
Epoch: 7, Steps: 13 | Train Loss: 0.756 Vali Loss: 1.963 Vali Acc: 0.500 Test Loss: 1.963 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.858435869216919
Epoch: 8, Steps: 13 | Train Loss: 0.587 Vali Loss: 1.154 Vali Acc: 0.561 Test Loss: 1.154 Test Acc: 0.561
Validation loss decreased (-0.533321 --> -0.561100).  Saving model ...
Epoch: 9 cost time: 1.8345081806182861
Epoch: 9, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.488 Vali Acc: 0.500 Test Loss: 1.488 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7170164585113525
Epoch: 10, Steps: 13 | Train Loss: 0.447 Vali Loss: 2.008 Vali Acc: 0.494 Test Loss: 2.008 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.828476905822754
Epoch: 11, Steps: 13 | Train Loss: 0.505 Vali Loss: 1.893 Vali Acc: 0.533 Test Loss: 1.893 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8252394199371338
Epoch: 12, Steps: 13 | Train Loss: 0.509 Vali Loss: 2.133 Vali Acc: 0.483 Test Loss: 2.133 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7813670635223389
Epoch: 13, Steps: 13 | Train Loss: 0.735 Vali Loss: 2.150 Vali Acc: 0.500 Test Loss: 2.150 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.642625331878662
Epoch: 14, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.801 Vali Acc: 0.528 Test Loss: 1.801 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6739556789398193
Epoch: 15, Steps: 13 | Train Loss: 0.093 Vali Loss: 2.462 Vali Acc: 0.483 Test Loss: 2.462 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9285900592803955
Epoch: 16, Steps: 13 | Train Loss: 0.103 Vali Loss: 2.070 Vali Acc: 0.528 Test Loss: 2.070 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9817683696746826
Epoch: 17, Steps: 13 | Train Loss: 0.196 Vali Loss: 2.999 Vali Acc: 0.500 Test Loss: 2.999 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9338114261627197
Epoch: 18, Steps: 13 | Train Loss: 0.246 Vali Loss: 2.602 Vali Acc: 0.500 Test Loss: 2.602 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 434906
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1740801334381104
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.879 Vali Acc: 0.506 Test Loss: 0.879 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 1.6090786457061768
Epoch: 2, Steps: 13 | Train Loss: 1.109 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.637916088104248
Epoch: 3, Steps: 13 | Train Loss: 0.838 Vali Loss: 0.975 Vali Acc: 0.517 Test Loss: 0.975 Test Acc: 0.517
Validation loss decreased (-0.505547 --> -0.516657).  Saving model ...
Epoch: 4 cost time: 1.6372227668762207
Epoch: 4, Steps: 13 | Train Loss: 0.914 Vali Loss: 0.877 Vali Acc: 0.578 Test Loss: 0.877 Test Acc: 0.578
Validation loss decreased (-0.516657 --> -0.577769).  Saving model ...
Epoch: 5 cost time: 1.6307721138000488
Epoch: 5, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5853385925292969
Epoch: 6, Steps: 13 | Train Loss: 0.679 Vali Loss: 1.238 Vali Acc: 0.494 Test Loss: 1.238 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5941345691680908
Epoch: 7, Steps: 13 | Train Loss: 1.004 Vali Loss: 1.446 Vali Acc: 0.478 Test Loss: 1.446 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5962483882904053
Epoch: 8, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.836 Vali Acc: 0.528 Test Loss: 0.836 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.687004566192627
Epoch: 9, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.951 Vali Acc: 0.517 Test Loss: 0.951 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6329853534698486
Epoch: 10, Steps: 13 | Train Loss: 0.628 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5822012424468994
Epoch: 11, Steps: 13 | Train Loss: 0.840 Vali Loss: 1.293 Vali Acc: 0.478 Test Loss: 1.293 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7190463542938232
Epoch: 12, Steps: 13 | Train Loss: 0.633 Vali Loss: 1.966 Vali Acc: 0.511 Test Loss: 1.966 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6331281661987305
Epoch: 13, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.718 Vali Acc: 0.506 Test Loss: 1.718 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6341252326965332
Epoch: 14, Steps: 13 | Train Loss: 0.410 Vali Loss: 2.112 Vali Acc: 0.467 Test Loss: 2.112 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 434906
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.9142215251922607
Epoch: 1, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.911 Vali Acc: 0.494 Test Loss: 0.911 Test Acc: 0.494
Validation loss decreased (inf --> -0.494435).  Saving model ...
Epoch: 2 cost time: 2.1131386756896973
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.993 Vali Acc: 0.544 Test Loss: 0.993 Test Acc: 0.544
Validation loss decreased (-0.494435 --> -0.544435).  Saving model ...
Epoch: 3 cost time: 2.2137033939361572
Epoch: 3, Steps: 13 | Train Loss: 0.804 Vali Loss: 1.267 Vali Acc: 0.511 Test Loss: 1.267 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0777428150177
Epoch: 4, Steps: 13 | Train Loss: 0.664 Vali Loss: 1.525 Vali Acc: 0.511 Test Loss: 1.525 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.038005828857422
Epoch: 5, Steps: 13 | Train Loss: 1.058 Vali Loss: 1.353 Vali Acc: 0.494 Test Loss: 1.353 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0118308067321777
Epoch: 6, Steps: 13 | Train Loss: 0.534 Vali Loss: 1.374 Vali Acc: 0.517 Test Loss: 1.374 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0296781063079834
Epoch: 7, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.327 Vali Acc: 0.528 Test Loss: 1.327 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0340685844421387
Epoch: 8, Steps: 13 | Train Loss: 0.862 Vali Loss: 3.189 Vali Acc: 0.489 Test Loss: 3.189 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1390163898468018
Epoch: 9, Steps: 13 | Train Loss: 1.747 Vali Loss: 3.653 Vali Acc: 0.478 Test Loss: 3.653 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.977325201034546
Epoch: 10, Steps: 13 | Train Loss: 0.902 Vali Loss: 1.963 Vali Acc: 0.528 Test Loss: 1.963 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.089407205581665
Epoch: 11, Steps: 13 | Train Loss: 0.637 Vali Loss: 2.005 Vali Acc: 0.533 Test Loss: 2.005 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.054631233215332
Epoch: 12, Steps: 13 | Train Loss: 0.339 Vali Loss: 2.035 Vali Acc: 0.556 Test Loss: 2.035 Test Acc: 0.556
Validation loss decreased (-0.544435 --> -0.555535).  Saving model ...
Epoch: 13 cost time: 2.0823135375976562
Epoch: 13, Steps: 13 | Train Loss: 0.154 Vali Loss: 2.000 Vali Acc: 0.544 Test Loss: 2.000 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.086804151535034
Epoch: 14, Steps: 13 | Train Loss: 0.139 Vali Loss: 2.298 Vali Acc: 0.539 Test Loss: 2.298 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.135974884033203
Epoch: 15, Steps: 13 | Train Loss: 0.154 Vali Loss: 2.695 Vali Acc: 0.500 Test Loss: 2.695 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9635066986083984
Epoch: 16, Steps: 13 | Train Loss: 0.196 Vali Loss: 2.996 Vali Acc: 0.517 Test Loss: 2.996 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9548869132995605
Epoch: 17, Steps: 13 | Train Loss: 0.356 Vali Loss: 3.169 Vali Acc: 0.528 Test Loss: 3.169 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0439608097076416
Epoch: 18, Steps: 13 | Train Loss: 0.206 Vali Loss: 2.750 Vali Acc: 0.556 Test Loss: 2.750 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9872713088989258
Epoch: 19, Steps: 13 | Train Loss: 0.105 Vali Loss: 3.184 Vali Acc: 0.556 Test Loss: 3.184 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0711886882781982
Epoch: 20, Steps: 13 | Train Loss: 0.069 Vali Loss: 3.061 Vali Acc: 0.522 Test Loss: 3.061 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0442447662353516
Epoch: 21, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.155 Vali Acc: 0.539 Test Loss: 3.155 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9875071048736572
Epoch: 22, Steps: 13 | Train Loss: 0.098 Vali Loss: 3.204 Vali Acc: 0.567 Test Loss: 3.204 Test Acc: 0.567
Validation loss decreased (-0.555535 --> -0.566635).  Saving model ...
Epoch: 23 cost time: 1.97471284866333
Epoch: 23, Steps: 13 | Train Loss: 0.113 Vali Loss: 3.325 Vali Acc: 0.567 Test Loss: 3.325 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9036922454833984
Epoch: 24, Steps: 13 | Train Loss: 0.007 Vali Loss: 3.273 Vali Acc: 0.578 Test Loss: 3.273 Test Acc: 0.578
Validation loss decreased (-0.566635 --> -0.577745).  Saving model ...
Epoch: 25 cost time: 2.0073957443237305
Epoch: 25, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.602 Vali Acc: 0.556 Test Loss: 3.602 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9767985343933105
Epoch: 26, Steps: 13 | Train Loss: 0.009 Vali Loss: 4.013 Vali Acc: 0.522 Test Loss: 4.013 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8064041137695312
Epoch: 27, Steps: 13 | Train Loss: 0.049 Vali Loss: 3.828 Vali Acc: 0.522 Test Loss: 3.828 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0896642208099365
Epoch: 28, Steps: 13 | Train Loss: 0.004 Vali Loss: 3.852 Vali Acc: 0.528 Test Loss: 3.852 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0283100605010986
Epoch: 29, Steps: 13 | Train Loss: 0.061 Vali Loss: 4.071 Vali Acc: 0.533 Test Loss: 4.071 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.087686777114868
Epoch: 30, Steps: 13 | Train Loss: 0.043 Vali Loss: 4.419 Vali Acc: 0.511 Test Loss: 4.419 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9885592460632324
Epoch: 31, Steps: 13 | Train Loss: 0.026 Vali Loss: 5.087 Vali Acc: 0.528 Test Loss: 5.087 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.936856746673584
Epoch: 32, Steps: 13 | Train Loss: 0.103 Vali Loss: 4.015 Vali Acc: 0.550 Test Loss: 4.015 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8740530014038086
Epoch: 33, Steps: 13 | Train Loss: 0.003 Vali Loss: 4.636 Vali Acc: 0.539 Test Loss: 4.636 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9584856033325195
Epoch: 34, Steps: 13 | Train Loss: 0.018 Vali Loss: 5.979 Vali Acc: 0.539 Test Loss: 5.979 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 402138
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6518914699554443
Epoch: 1, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.926 Vali Acc: 0.500 Test Loss: 0.926 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.9830565452575684
Epoch: 2, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.939 Vali Acc: 0.522 Test Loss: 0.939 Test Acc: 0.522
Validation loss decreased (-0.499991 --> -0.522213).  Saving model ...
Epoch: 3 cost time: 1.8634049892425537
Epoch: 3, Steps: 13 | Train Loss: 0.814 Vali Loss: 1.175 Vali Acc: 0.506 Test Loss: 1.175 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7582321166992188
Epoch: 4, Steps: 13 | Train Loss: 0.659 Vali Loss: 1.406 Vali Acc: 0.500 Test Loss: 1.406 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7356724739074707
Epoch: 5, Steps: 13 | Train Loss: 0.999 Vali Loss: 0.965 Vali Acc: 0.556 Test Loss: 0.965 Test Acc: 0.556
Validation loss decreased (-0.522213 --> -0.555546).  Saving model ...
Epoch: 6 cost time: 1.6677792072296143
Epoch: 6, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.375 Vali Acc: 0.533 Test Loss: 1.375 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7099454402923584
Epoch: 7, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.380 Vali Acc: 0.517 Test Loss: 1.380 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9868338108062744
Epoch: 8, Steps: 13 | Train Loss: 0.780 Vali Loss: 2.279 Vali Acc: 0.483 Test Loss: 2.279 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.047506809234619
Epoch: 9, Steps: 13 | Train Loss: 0.937 Vali Loss: 1.976 Vali Acc: 0.528 Test Loss: 1.976 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8401741981506348
Epoch: 10, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.598 Vali Acc: 0.533 Test Loss: 1.598 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9844682216644287
Epoch: 11, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.659 Vali Acc: 0.528 Test Loss: 1.659 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8899059295654297
Epoch: 12, Steps: 13 | Train Loss: 0.154 Vali Loss: 2.149 Vali Acc: 0.511 Test Loss: 2.149 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8912951946258545
Epoch: 13, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.800 Vali Acc: 0.528 Test Loss: 1.800 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8124866485595703
Epoch: 14, Steps: 13 | Train Loss: 0.147 Vali Loss: 2.141 Vali Acc: 0.544 Test Loss: 2.141 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.937124490737915
Epoch: 15, Steps: 13 | Train Loss: 0.261 Vali Loss: 2.227 Vali Acc: 0.506 Test Loss: 2.227 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 402138
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4428510665893555
Epoch: 1, Steps: 13 | Train Loss: 0.799 Vali Loss: 0.924 Vali Acc: 0.500 Test Loss: 0.924 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.7450337409973145
Epoch: 2, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.932 Vali Acc: 0.544 Test Loss: 0.932 Test Acc: 0.544
Validation loss decreased (-0.499991 --> -0.544435).  Saving model ...
Epoch: 3 cost time: 1.7889957427978516
Epoch: 3, Steps: 13 | Train Loss: 0.836 Vali Loss: 1.169 Vali Acc: 0.483 Test Loss: 1.169 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8286981582641602
Epoch: 4, Steps: 13 | Train Loss: 0.687 Vali Loss: 1.134 Vali Acc: 0.494 Test Loss: 1.134 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8372716903686523
Epoch: 5, Steps: 13 | Train Loss: 0.901 Vali Loss: 0.910 Vali Acc: 0.544 Test Loss: 0.910 Test Acc: 0.544
Validation loss decreased (-0.544435 --> -0.544435).  Saving model ...
Epoch: 6 cost time: 1.8450758457183838
Epoch: 6, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.236 Vali Acc: 0.533 Test Loss: 1.236 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.886913537979126
Epoch: 7, Steps: 13 | Train Loss: 0.486 Vali Loss: 1.144 Vali Acc: 0.528 Test Loss: 1.144 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7362139225006104
Epoch: 8, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.602 Vali Acc: 0.550 Test Loss: 1.602 Test Acc: 0.550
Validation loss decreased (-0.544435 --> -0.549984).  Saving model ...
Epoch: 9 cost time: 1.7534594535827637
Epoch: 9, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.711 Vali Acc: 0.517 Test Loss: 1.711 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5635051727294922
Epoch: 10, Steps: 13 | Train Loss: 0.467 Vali Loss: 1.648 Vali Acc: 0.528 Test Loss: 1.648 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7350337505340576
Epoch: 11, Steps: 13 | Train Loss: 0.450 Vali Loss: 1.542 Vali Acc: 0.528 Test Loss: 1.542 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6621856689453125
Epoch: 12, Steps: 13 | Train Loss: 0.390 Vali Loss: 2.382 Vali Acc: 0.489 Test Loss: 2.382 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8103625774383545
Epoch: 13, Steps: 13 | Train Loss: 0.893 Vali Loss: 4.753 Vali Acc: 0.478 Test Loss: 4.753 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.826887607574463
Epoch: 14, Steps: 13 | Train Loss: 1.680 Vali Loss: 3.709 Vali Acc: 0.472 Test Loss: 3.709 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8008718490600586
Epoch: 15, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.980 Vali Acc: 0.528 Test Loss: 1.980 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7105374336242676
Epoch: 16, Steps: 13 | Train Loss: 0.555 Vali Loss: 2.369 Vali Acc: 0.489 Test Loss: 2.369 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.726027011871338
Epoch: 17, Steps: 13 | Train Loss: 0.629 Vali Loss: 1.992 Vali Acc: 0.539 Test Loss: 1.992 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7373545169830322
Epoch: 18, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.506 Vali Acc: 0.528 Test Loss: 2.506 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 402138
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.369293212890625
Epoch: 1, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.5974090099334717
Epoch: 2, Steps: 13 | Train Loss: 0.829 Vali Loss: 0.947 Vali Acc: 0.539 Test Loss: 0.947 Test Acc: 0.539
Validation loss decreased (-0.499991 --> -0.538879).  Saving model ...
Epoch: 3 cost time: 1.5791325569152832
Epoch: 3, Steps: 13 | Train Loss: 0.939 Vali Loss: 1.206 Vali Acc: 0.489 Test Loss: 1.206 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5566699504852295
Epoch: 4, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.777 Vali Acc: 0.556 Test Loss: 0.777 Test Acc: 0.556
Validation loss decreased (-0.538879 --> -0.555548).  Saving model ...
Epoch: 5 cost time: 1.4034533500671387
Epoch: 5, Steps: 13 | Train Loss: 0.904 Vali Loss: 0.976 Vali Acc: 0.500 Test Loss: 0.976 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5354394912719727
Epoch: 6, Steps: 13 | Train Loss: 0.680 Vali Loss: 1.009 Vali Acc: 0.489 Test Loss: 1.009 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5366196632385254
Epoch: 7, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.009 Vali Acc: 0.494 Test Loss: 1.009 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5427086353302002
Epoch: 8, Steps: 13 | Train Loss: 0.626 Vali Loss: 1.356 Vali Acc: 0.533 Test Loss: 1.356 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4975881576538086
Epoch: 9, Steps: 13 | Train Loss: 0.611 Vali Loss: 1.461 Vali Acc: 0.506 Test Loss: 1.461 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5709233283996582
Epoch: 10, Steps: 13 | Train Loss: 0.721 Vali Loss: 1.220 Vali Acc: 0.517 Test Loss: 1.220 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4920375347137451
Epoch: 11, Steps: 13 | Train Loss: 0.637 Vali Loss: 1.156 Vali Acc: 0.528 Test Loss: 1.156 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5196266174316406
Epoch: 12, Steps: 13 | Train Loss: 0.384 Vali Loss: 2.172 Vali Acc: 0.489 Test Loss: 2.172 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.546445369720459
Epoch: 13, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.312 Vali Acc: 0.494 Test Loss: 1.312 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5404579639434814
Epoch: 14, Steps: 13 | Train Loss: 0.279 Vali Loss: 2.422 Vali Acc: 0.500 Test Loss: 2.422 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 402138
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.511789321899414
Epoch: 1, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.731 Vali Acc: 0.511 Test Loss: 0.731 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.7727611064910889
Epoch: 2, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.781 Vali Acc: 0.533 Test Loss: 0.781 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.8908014297485352
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.954 Vali Acc: 0.467 Test Loss: 0.954 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7277190685272217
Epoch: 4, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.804 Vali Acc: 0.533 Test Loss: 0.804 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.803412675857544
Epoch: 5, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7956113815307617
Epoch: 6, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.016 Vali Acc: 0.539 Test Loss: 1.016 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538879).  Saving model ...
Epoch: 7 cost time: 1.8632574081420898
Epoch: 7, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.300 Vali Acc: 0.522 Test Loss: 1.300 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8476123809814453
Epoch: 8, Steps: 13 | Train Loss: 0.444 Vali Loss: 1.142 Vali Acc: 0.528 Test Loss: 1.142 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7385919094085693
Epoch: 9, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.188 Vali Acc: 0.550 Test Loss: 1.188 Test Acc: 0.550
Validation loss decreased (-0.538879 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 1.969320297241211
Epoch: 10, Steps: 13 | Train Loss: 0.240 Vali Loss: 1.446 Vali Acc: 0.511 Test Loss: 1.446 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.848938226699829
Epoch: 11, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.577 Vali Acc: 0.522 Test Loss: 1.577 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8852155208587646
Epoch: 12, Steps: 13 | Train Loss: 0.240 Vali Loss: 1.519 Vali Acc: 0.522 Test Loss: 1.519 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.808445692062378
Epoch: 13, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.658 Vali Acc: 0.528 Test Loss: 1.658 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7584006786346436
Epoch: 14, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.654 Vali Acc: 0.544 Test Loss: 1.654 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7414729595184326
Epoch: 15, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.689 Vali Acc: 0.544 Test Loss: 1.689 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7757854461669922
Epoch: 16, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.916 Vali Acc: 0.567 Test Loss: 1.916 Test Acc: 0.567
Validation loss decreased (-0.549988 --> -0.566648).  Saving model ...
Epoch: 17 cost time: 1.7818591594696045
Epoch: 17, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.886 Vali Acc: 0.544 Test Loss: 1.886 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9190804958343506
Epoch: 18, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.980 Vali Acc: 0.517 Test Loss: 1.980 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9943873882293701
Epoch: 19, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.583 Vali Acc: 0.528 Test Loss: 2.583 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8134829998016357
Epoch: 20, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.305 Vali Acc: 0.500 Test Loss: 2.305 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6756947040557861
Epoch: 21, Steps: 13 | Train Loss: 0.040 Vali Loss: 2.391 Vali Acc: 0.528 Test Loss: 2.391 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7491884231567383
Epoch: 22, Steps: 13 | Train Loss: 0.054 Vali Loss: 2.424 Vali Acc: 0.522 Test Loss: 2.424 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7563507556915283
Epoch: 23, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.997 Vali Acc: 0.533 Test Loss: 2.997 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6999313831329346
Epoch: 24, Steps: 13 | Train Loss: 0.017 Vali Loss: 2.913 Vali Acc: 0.550 Test Loss: 2.913 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7904236316680908
Epoch: 25, Steps: 13 | Train Loss: 0.083 Vali Loss: 3.021 Vali Acc: 0.511 Test Loss: 3.021 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7818207740783691
Epoch: 26, Steps: 13 | Train Loss: 0.028 Vali Loss: 2.639 Vali Acc: 0.522 Test Loss: 2.639 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 692634
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.529200315475464
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.735 Vali Acc: 0.511 Test Loss: 0.735 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.7090651988983154
Epoch: 2, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.798 Vali Acc: 0.528 Test Loss: 0.798 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.695246696472168
Epoch: 3, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.942 Vali Acc: 0.472 Test Loss: 0.942 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7484681606292725
Epoch: 4, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.789 Vali Acc: 0.517 Test Loss: 0.789 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7115693092346191
Epoch: 5, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.936 Vali Acc: 0.533 Test Loss: 0.936 Test Acc: 0.533
Validation loss decreased (-0.527770 --> -0.533324).  Saving model ...
Epoch: 6 cost time: 1.780674934387207
Epoch: 6, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.936 Vali Acc: 0.511 Test Loss: 0.936 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8410847187042236
Epoch: 7, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.473 Vali Acc: 0.517 Test Loss: 1.473 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.82975172996521
Epoch: 8, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.237 Vali Acc: 0.506 Test Loss: 1.237 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7505645751953125
Epoch: 9, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.121 Vali Acc: 0.506 Test Loss: 1.121 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7608153820037842
Epoch: 10, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.341 Vali Acc: 0.522 Test Loss: 1.341 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.669262170791626
Epoch: 11, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.350 Vali Acc: 0.511 Test Loss: 1.350 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6966404914855957
Epoch: 12, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.452 Vali Acc: 0.444 Test Loss: 1.452 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7562158107757568
Epoch: 13, Steps: 13 | Train Loss: 0.148 Vali Loss: 1.479 Vali Acc: 0.478 Test Loss: 1.479 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7534573078155518
Epoch: 14, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.552 Vali Acc: 0.494 Test Loss: 1.552 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7285792827606201
Epoch: 15, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.645 Vali Acc: 0.483 Test Loss: 1.645 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 692634
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0789711475372314
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.730 Vali Acc: 0.511 Test Loss: 0.730 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.5355660915374756
Epoch: 2, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.805 Vali Acc: 0.494 Test Loss: 0.805 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6224944591522217
Epoch: 3, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.897 Vali Acc: 0.483 Test Loss: 0.897 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4976389408111572
Epoch: 4, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.740 Vali Acc: 0.556 Test Loss: 0.740 Test Acc: 0.556
Validation loss decreased (-0.511104 --> -0.555548).  Saving model ...
Epoch: 5 cost time: 1.5049326419830322
Epoch: 5, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.882 Vali Acc: 0.528 Test Loss: 0.882 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4467871189117432
Epoch: 6, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.844 Vali Acc: 0.539 Test Loss: 0.844 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4116132259368896
Epoch: 7, Steps: 13 | Train Loss: 0.528 Vali Loss: 1.338 Vali Acc: 0.528 Test Loss: 1.338 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.417762279510498
Epoch: 8, Steps: 13 | Train Loss: 0.459 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4762625694274902
Epoch: 9, Steps: 13 | Train Loss: 0.560 Vali Loss: 1.414 Vali Acc: 0.533 Test Loss: 1.414 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6203334331512451
Epoch: 10, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.545 Vali Acc: 0.567 Test Loss: 1.545 Test Acc: 0.567
Validation loss decreased (-0.555548 --> -0.566651).  Saving model ...
Epoch: 11 cost time: 1.6184356212615967
Epoch: 11, Steps: 13 | Train Loss: 0.619 Vali Loss: 1.441 Vali Acc: 0.489 Test Loss: 1.441 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6754112243652344
Epoch: 12, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.280 Vali Acc: 0.517 Test Loss: 1.280 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.541213035583496
Epoch: 13, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.640 Vali Acc: 0.522 Test Loss: 1.640 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5634937286376953
Epoch: 14, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.547 Vali Acc: 0.522 Test Loss: 1.547 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5991957187652588
Epoch: 15, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.459 Vali Acc: 0.522 Test Loss: 1.459 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.636606216430664
Epoch: 16, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.603 Vali Acc: 0.500 Test Loss: 1.603 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6275551319122314
Epoch: 17, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.718 Vali Acc: 0.500 Test Loss: 1.718 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6286356449127197
Epoch: 18, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.836 Vali Acc: 0.478 Test Loss: 1.836 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6257786750793457
Epoch: 19, Steps: 13 | Train Loss: 0.087 Vali Loss: 2.072 Vali Acc: 0.489 Test Loss: 2.072 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.657247543334961
Epoch: 20, Steps: 13 | Train Loss: 0.040 Vali Loss: 2.124 Vali Acc: 0.506 Test Loss: 2.124 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 692634
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.11564040184021
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.748 Vali Acc: 0.489 Test Loss: 0.748 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.5051324367523193
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.787 Vali Acc: 0.511 Test Loss: 0.787 Test Acc: 0.511
Validation loss decreased (-0.488881 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 1.478461503982544
Epoch: 3, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.969 Vali Acc: 0.483 Test Loss: 0.969 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4848346710205078
Epoch: 4, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.847 Vali Acc: 0.489 Test Loss: 0.847 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5056672096252441
Epoch: 5, Steps: 13 | Train Loss: 0.797 Vali Loss: 1.094 Vali Acc: 0.489 Test Loss: 1.094 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5337297916412354
Epoch: 6, Steps: 13 | Train Loss: 0.774 Vali Loss: 1.047 Vali Acc: 0.522 Test Loss: 1.047 Test Acc: 0.522
Validation loss decreased (-0.511103 --> -0.522212).  Saving model ...
Epoch: 7 cost time: 1.480912446975708
Epoch: 7, Steps: 13 | Train Loss: 0.719 Vali Loss: 1.323 Vali Acc: 0.533 Test Loss: 1.323 Test Acc: 0.533
Validation loss decreased (-0.522212 --> -0.533320).  Saving model ...
Epoch: 8 cost time: 1.4508755207061768
Epoch: 8, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.824 Vali Acc: 0.544 Test Loss: 0.824 Test Acc: 0.544
Validation loss decreased (-0.533320 --> -0.544436).  Saving model ...
Epoch: 9 cost time: 1.405815601348877
Epoch: 9, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.842 Vali Acc: 0.533 Test Loss: 0.842 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.468430519104004
Epoch: 10, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.873 Vali Acc: 0.533 Test Loss: 0.873 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5063319206237793
Epoch: 11, Steps: 13 | Train Loss: 0.415 Vali Loss: 1.121 Vali Acc: 0.528 Test Loss: 1.121 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3291258811950684
Epoch: 12, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.103 Vali Acc: 0.567 Test Loss: 1.103 Test Acc: 0.567
Validation loss decreased (-0.544436 --> -0.566656).  Saving model ...
Epoch: 13 cost time: 1.474222183227539
Epoch: 13, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.553 Vali Acc: 0.494 Test Loss: 1.553 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.488236904144287
Epoch: 14, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.413 Vali Acc: 0.522 Test Loss: 1.413 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4727132320404053
Epoch: 15, Steps: 13 | Train Loss: 0.256 Vali Loss: 1.417 Vali Acc: 0.533 Test Loss: 1.417 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4505558013916016
Epoch: 16, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.261 Vali Acc: 0.533 Test Loss: 1.261 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5200107097625732
Epoch: 17, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.540 Vali Acc: 0.506 Test Loss: 1.540 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.489647626876831
Epoch: 18, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.950 Vali Acc: 0.478 Test Loss: 1.950 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4267199039459229
Epoch: 19, Steps: 13 | Train Loss: 0.191 Vali Loss: 3.020 Vali Acc: 0.511 Test Loss: 3.020 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.497563123703003
Epoch: 20, Steps: 13 | Train Loss: 0.569 Vali Loss: 2.025 Vali Acc: 0.522 Test Loss: 2.025 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4456963539123535
Epoch: 21, Steps: 13 | Train Loss: 0.102 Vali Loss: 2.175 Vali Acc: 0.517 Test Loss: 2.175 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4820880889892578
Epoch: 22, Steps: 13 | Train Loss: 0.079 Vali Loss: 2.364 Vali Acc: 0.494 Test Loss: 2.364 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 692634
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3218088150024414
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.710 Vali Acc: 0.489 Test Loss: 0.710 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.644340991973877
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.761 Vali Acc: 0.528 Test Loss: 0.761 Test Acc: 0.528
Validation loss decreased (-0.488882 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.6534278392791748
Epoch: 3, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.873 Vali Acc: 0.489 Test Loss: 0.873 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.603090763092041
Epoch: 4, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.817 Vali Acc: 0.528 Test Loss: 0.817 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6598286628723145
Epoch: 5, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.890 Vali Acc: 0.528 Test Loss: 0.890 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6959261894226074
Epoch: 6, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.996 Vali Acc: 0.511 Test Loss: 0.996 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6908209323883057
Epoch: 7, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.071 Vali Acc: 0.506 Test Loss: 1.071 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6938705444335938
Epoch: 8, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.206 Vali Acc: 0.506 Test Loss: 1.206 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4844439029693604
Epoch: 9, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.528 Vali Acc: 0.522 Test Loss: 1.528 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.618922233581543
Epoch: 10, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.312 Vali Acc: 0.494 Test Loss: 1.312 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5774083137512207
Epoch: 11, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.387 Vali Acc: 0.522 Test Loss: 1.387 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5794882774353027
Epoch: 12, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.684 Vali Acc: 0.533 Test Loss: 1.684 Test Acc: 0.533
Validation loss decreased (-0.527770 --> -0.533316).  Saving model ...
Epoch: 13 cost time: 1.6029701232910156
Epoch: 13, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.649 Vali Acc: 0.522 Test Loss: 1.649 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.620572805404663
Epoch: 14, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.530 Vali Acc: 0.528 Test Loss: 1.530 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6915504932403564
Epoch: 15, Steps: 13 | Train Loss: 0.309 Vali Loss: 2.265 Vali Acc: 0.522 Test Loss: 2.265 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6751728057861328
Epoch: 16, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.739 Vali Acc: 0.550 Test Loss: 1.739 Test Acc: 0.550
Validation loss decreased (-0.533316 --> -0.549983).  Saving model ...
Epoch: 17 cost time: 1.6734528541564941
Epoch: 17, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.856 Vali Acc: 0.572 Test Loss: 1.856 Test Acc: 0.572
Validation loss decreased (-0.549983 --> -0.572204).  Saving model ...
Epoch: 18 cost time: 1.5065996646881104
Epoch: 18, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.816 Vali Acc: 0.528 Test Loss: 1.816 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.573730707168579
Epoch: 19, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.795 Vali Acc: 0.539 Test Loss: 1.795 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.484116554260254
Epoch: 20, Steps: 13 | Train Loss: 0.082 Vali Loss: 2.387 Vali Acc: 0.483 Test Loss: 2.387 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.632875680923462
Epoch: 21, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.996 Vali Acc: 0.567 Test Loss: 1.996 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.660759449005127
Epoch: 22, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.051 Vali Acc: 0.567 Test Loss: 2.051 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6551587581634521
Epoch: 23, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.180 Vali Acc: 0.567 Test Loss: 2.180 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7269370555877686
Epoch: 24, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.225 Vali Acc: 0.561 Test Loss: 2.225 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6585047245025635
Epoch: 25, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.327 Vali Acc: 0.556 Test Loss: 2.327 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6879832744598389
Epoch: 26, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.306 Vali Acc: 0.539 Test Loss: 2.306 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6352605819702148
Epoch: 27, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.710 Vali Acc: 0.500 Test Loss: 2.710 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 430490
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3292810916900635
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.718 Vali Acc: 0.456 Test Loss: 0.718 Test Acc: 0.456
Validation loss decreased (inf --> -0.455548).  Saving model ...
Epoch: 2 cost time: 1.6292808055877686
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.748 Vali Acc: 0.517 Test Loss: 0.748 Test Acc: 0.517
Validation loss decreased (-0.455548 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.6229281425476074
Epoch: 3, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.906 Vali Acc: 0.483 Test Loss: 0.906 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4851572513580322
Epoch: 4, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.802 Vali Acc: 0.522 Test Loss: 0.802 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522214).  Saving model ...
Epoch: 5 cost time: 1.4230694770812988
Epoch: 5, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.861 Vali Acc: 0.544 Test Loss: 0.861 Test Acc: 0.544
Validation loss decreased (-0.522214 --> -0.544436).  Saving model ...
Epoch: 6 cost time: 1.4102814197540283
Epoch: 6, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.999 Vali Acc: 0.522 Test Loss: 0.999 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3974416255950928
Epoch: 7, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.037 Vali Acc: 0.500 Test Loss: 1.037 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3658692836761475
Epoch: 8, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.075 Vali Acc: 0.489 Test Loss: 1.075 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.359684705734253
Epoch: 9, Steps: 13 | Train Loss: 0.419 Vali Loss: 1.101 Vali Acc: 0.511 Test Loss: 1.101 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5618836879730225
Epoch: 10, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.143 Vali Acc: 0.556 Test Loss: 1.143 Test Acc: 0.556
Validation loss decreased (-0.544436 --> -0.555544).  Saving model ...
Epoch: 11 cost time: 1.5488545894622803
Epoch: 11, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.248 Vali Acc: 0.489 Test Loss: 1.248 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5392541885375977
Epoch: 12, Steps: 13 | Train Loss: 0.192 Vali Loss: 1.723 Vali Acc: 0.522 Test Loss: 1.723 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4634878635406494
Epoch: 13, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.519 Vali Acc: 0.494 Test Loss: 1.519 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5420899391174316
Epoch: 14, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.660 Vali Acc: 0.506 Test Loss: 1.660 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5305471420288086
Epoch: 15, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.770 Vali Acc: 0.528 Test Loss: 1.770 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5920968055725098
Epoch: 16, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.721 Vali Acc: 0.544 Test Loss: 1.721 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5951106548309326
Epoch: 17, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.935 Vali Acc: 0.506 Test Loss: 1.935 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.557342767715454
Epoch: 18, Steps: 13 | Train Loss: 0.123 Vali Loss: 2.066 Vali Acc: 0.517 Test Loss: 2.066 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6188075542449951
Epoch: 19, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.432 Vali Acc: 0.556 Test Loss: 2.432 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6827569007873535
Epoch: 20, Steps: 13 | Train Loss: 0.053 Vali Loss: 2.295 Vali Acc: 0.539 Test Loss: 2.295 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 430490
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1600148677825928
Epoch: 1, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.708 Vali Acc: 0.467 Test Loss: 0.708 Test Acc: 0.467
Validation loss decreased (inf --> -0.466660).  Saving model ...
Epoch: 2 cost time: 1.296170949935913
Epoch: 2, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (-0.466660 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.4802978038787842
Epoch: 3, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.835 Vali Acc: 0.472 Test Loss: 0.835 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5141863822937012
Epoch: 4, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.765 Vali Acc: 0.517 Test Loss: 0.765 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3943605422973633
Epoch: 5, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.774 Vali Acc: 0.522 Test Loss: 0.774 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4468352794647217
Epoch: 6, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.826 Vali Acc: 0.533 Test Loss: 0.826 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3733408451080322
Epoch: 7, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.893 Vali Acc: 0.567 Test Loss: 0.893 Test Acc: 0.567
Validation loss decreased (-0.549993 --> -0.566658).  Saving model ...
Epoch: 8 cost time: 1.388214349746704
Epoch: 8, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.071 Vali Acc: 0.517 Test Loss: 1.071 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.296799898147583
Epoch: 9, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.321 Vali Acc: 0.528 Test Loss: 1.321 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.360098123550415
Epoch: 10, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.202 Vali Acc: 0.511 Test Loss: 1.202 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4531340599060059
Epoch: 11, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.271 Vali Acc: 0.528 Test Loss: 1.271 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4319629669189453
Epoch: 12, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.420 Vali Acc: 0.533 Test Loss: 1.420 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4404270648956299
Epoch: 13, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.642 Vali Acc: 0.528 Test Loss: 1.642 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5019032955169678
Epoch: 14, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.555 Vali Acc: 0.539 Test Loss: 1.555 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3507390022277832
Epoch: 15, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.810 Vali Acc: 0.511 Test Loss: 1.810 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4516384601593018
Epoch: 16, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.433 Vali Acc: 0.544 Test Loss: 1.433 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4332778453826904
Epoch: 17, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.931 Vali Acc: 0.528 Test Loss: 1.931 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 430490
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.110232353210449
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.696 Vali Acc: 0.539 Test Loss: 0.696 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.2568955421447754
Epoch: 2, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.734 Vali Acc: 0.511 Test Loss: 0.734 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3023324012756348
Epoch: 3, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.762 Vali Acc: 0.517 Test Loss: 0.762 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2126846313476562
Epoch: 4, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.723 Vali Acc: 0.556 Test Loss: 0.723 Test Acc: 0.556
Validation loss decreased (-0.538882 --> -0.555548).  Saving model ...
Epoch: 5 cost time: 1.2246017456054688
Epoch: 5, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.826 Vali Acc: 0.528 Test Loss: 0.826 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.349240779876709
Epoch: 6, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.728 Vali Acc: 0.583 Test Loss: 0.728 Test Acc: 0.583
Validation loss decreased (-0.555548 --> -0.583326).  Saving model ...
Epoch: 7 cost time: 1.3522710800170898
Epoch: 7, Steps: 13 | Train Loss: 0.526 Vali Loss: 1.047 Vali Acc: 0.517 Test Loss: 1.047 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3424785137176514
Epoch: 8, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.978 Vali Acc: 0.544 Test Loss: 0.978 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.377157211303711
Epoch: 9, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.844 Vali Acc: 0.511 Test Loss: 0.844 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.356867790222168
Epoch: 10, Steps: 13 | Train Loss: 0.433 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4099955558776855
Epoch: 11, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.128 Vali Acc: 0.550 Test Loss: 1.128 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3816475868225098
Epoch: 12, Steps: 13 | Train Loss: 0.456 Vali Loss: 1.432 Vali Acc: 0.550 Test Loss: 1.432 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4010272026062012
Epoch: 13, Steps: 13 | Train Loss: 0.472 Vali Loss: 1.388 Vali Acc: 0.567 Test Loss: 1.388 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3576691150665283
Epoch: 14, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.197 Vali Acc: 0.539 Test Loss: 1.197 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2450833320617676
Epoch: 15, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.291 Vali Acc: 0.544 Test Loss: 1.291 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3589918613433838
Epoch: 16, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.710 Vali Acc: 0.511 Test Loss: 1.710 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 430490
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.163383722305298
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.720 Vali Acc: 0.478 Test Loss: 0.720 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 1.516418695449829
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.759 Vali Acc: 0.517 Test Loss: 0.759 Test Acc: 0.517
Validation loss decreased (-0.477771 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.6045939922332764
Epoch: 3, Steps: 13 | Train Loss: 0.665 Vali Loss: 1.077 Vali Acc: 0.461 Test Loss: 1.077 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.588179588317871
Epoch: 4, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.960 Vali Acc: 0.511 Test Loss: 0.960 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6164710521697998
Epoch: 5, Steps: 13 | Train Loss: 0.612 Vali Loss: 1.182 Vali Acc: 0.539 Test Loss: 1.182 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538877).  Saving model ...
Epoch: 6 cost time: 1.6405549049377441
Epoch: 6, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.911 Vali Acc: 0.539 Test Loss: 0.911 Test Acc: 0.539
Validation loss decreased (-0.538877 --> -0.538880).  Saving model ...
Epoch: 7 cost time: 1.6006135940551758
Epoch: 7, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.069 Vali Acc: 0.544 Test Loss: 1.069 Test Acc: 0.544
Validation loss decreased (-0.538880 --> -0.544434).  Saving model ...
Epoch: 8 cost time: 1.6102116107940674
Epoch: 8, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6106834411621094
Epoch: 9, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.136 Vali Acc: 0.533 Test Loss: 1.136 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.647475242614746
Epoch: 10, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.200 Vali Acc: 0.572 Test Loss: 1.200 Test Acc: 0.572
Validation loss decreased (-0.544434 --> -0.572210).  Saving model ...
Epoch: 11 cost time: 1.5896096229553223
Epoch: 11, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.395 Vali Acc: 0.506 Test Loss: 1.395 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5063929557800293
Epoch: 12, Steps: 13 | Train Loss: 0.200 Vali Loss: 1.400 Vali Acc: 0.533 Test Loss: 1.400 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.593618631362915
Epoch: 13, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.833 Vali Acc: 0.528 Test Loss: 1.833 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5974299907684326
Epoch: 14, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.617 Vali Acc: 0.494 Test Loss: 1.617 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7454555034637451
Epoch: 15, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.814 Vali Acc: 0.550 Test Loss: 1.814 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5200262069702148
Epoch: 16, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.701 Vali Acc: 0.522 Test Loss: 1.701 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.518754243850708
Epoch: 17, Steps: 13 | Train Loss: 0.137 Vali Loss: 2.015 Vali Acc: 0.539 Test Loss: 2.015 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6380226612091064
Epoch: 18, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.898 Vali Acc: 0.511 Test Loss: 1.898 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6545078754425049
Epoch: 19, Steps: 13 | Train Loss: 0.112 Vali Loss: 2.728 Vali Acc: 0.522 Test Loss: 2.728 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7433383464813232
Epoch: 20, Steps: 13 | Train Loss: 0.113 Vali Loss: 2.147 Vali Acc: 0.522 Test Loss: 2.147 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 299418
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.227113962173462
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.711 Vali Acc: 0.517 Test Loss: 0.711 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.518928050994873
Epoch: 2, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
Validation loss decreased (-0.516660 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.5375628471374512
Epoch: 3, Steps: 13 | Train Loss: 0.705 Vali Loss: 1.033 Vali Acc: 0.461 Test Loss: 1.033 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.575157642364502
Epoch: 4, Steps: 13 | Train Loss: 0.812 Vali Loss: 0.967 Vali Acc: 0.517 Test Loss: 0.967 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5344505310058594
Epoch: 5, Steps: 13 | Train Loss: 0.664 Vali Loss: 1.050 Vali Acc: 0.528 Test Loss: 1.050 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5945470333099365
Epoch: 6, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.906 Vali Acc: 0.511 Test Loss: 0.906 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6645889282226562
Epoch: 7, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.945 Vali Acc: 0.556 Test Loss: 0.945 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555546).  Saving model ...
Epoch: 8 cost time: 1.518599271774292
Epoch: 8, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.086 Vali Acc: 0.528 Test Loss: 1.086 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5078461170196533
Epoch: 9, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.272 Vali Acc: 0.550 Test Loss: 1.272 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5107176303863525
Epoch: 10, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.183 Vali Acc: 0.567 Test Loss: 1.183 Test Acc: 0.567
Validation loss decreased (-0.555546 --> -0.566655).  Saving model ...
Epoch: 11 cost time: 1.511167287826538
Epoch: 11, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.150 Vali Acc: 0.511 Test Loss: 1.150 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5355215072631836
Epoch: 12, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.188 Vali Acc: 0.511 Test Loss: 1.188 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5395407676696777
Epoch: 13, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.264 Vali Acc: 0.517 Test Loss: 1.264 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5602483749389648
Epoch: 14, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.391 Vali Acc: 0.511 Test Loss: 1.391 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5881366729736328
Epoch: 15, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.623 Vali Acc: 0.544 Test Loss: 1.623 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5261614322662354
Epoch: 16, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.894 Vali Acc: 0.500 Test Loss: 1.894 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5519373416900635
Epoch: 17, Steps: 13 | Train Loss: 0.239 Vali Loss: 2.028 Vali Acc: 0.522 Test Loss: 2.028 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5186715126037598
Epoch: 18, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.738 Vali Acc: 0.500 Test Loss: 1.738 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5077941417694092
Epoch: 19, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.714 Vali Acc: 0.506 Test Loss: 1.714 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4363229274749756
Epoch: 20, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.944 Vali Acc: 0.561 Test Loss: 1.944 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 299418
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.008162260055542
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3152680397033691
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.735 Vali Acc: 0.533 Test Loss: 0.735 Test Acc: 0.533
Validation loss decreased (-0.499993 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.3908557891845703
Epoch: 3, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.953 Vali Acc: 0.461 Test Loss: 0.953 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3513119220733643
Epoch: 4, Steps: 13 | Train Loss: 0.823 Vali Loss: 0.896 Vali Acc: 0.522 Test Loss: 0.896 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3743619918823242
Epoch: 5, Steps: 13 | Train Loss: 0.627 Vali Loss: 1.073 Vali Acc: 0.500 Test Loss: 1.073 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3223326206207275
Epoch: 6, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.897 Vali Acc: 0.506 Test Loss: 0.897 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3488919734954834
Epoch: 7, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.838 Vali Acc: 0.544 Test Loss: 0.838 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544436).  Saving model ...
Epoch: 8 cost time: 1.358536958694458
Epoch: 8, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.867 Vali Acc: 0.556 Test Loss: 0.867 Test Acc: 0.556
Validation loss decreased (-0.544436 --> -0.555547).  Saving model ...
Epoch: 9 cost time: 1.3275799751281738
Epoch: 9, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.044 Vali Acc: 0.578 Test Loss: 1.044 Test Acc: 0.578
Validation loss decreased (-0.555547 --> -0.577767).  Saving model ...
Epoch: 10 cost time: 1.3749935626983643
Epoch: 10, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.035 Vali Acc: 0.567 Test Loss: 1.035 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3019051551818848
Epoch: 11, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.094 Vali Acc: 0.550 Test Loss: 1.094 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.354872703552246
Epoch: 12, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.201 Vali Acc: 0.489 Test Loss: 1.201 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3818209171295166
Epoch: 13, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.415 Vali Acc: 0.528 Test Loss: 1.415 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3420133590698242
Epoch: 14, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.219 Vali Acc: 0.522 Test Loss: 1.219 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3777379989624023
Epoch: 15, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.439 Vali Acc: 0.539 Test Loss: 1.439 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4169516563415527
Epoch: 16, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.480 Vali Acc: 0.494 Test Loss: 1.480 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3602697849273682
Epoch: 17, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.833 Vali Acc: 0.528 Test Loss: 1.833 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4193949699401855
Epoch: 18, Steps: 13 | Train Loss: 0.231 Vali Loss: 2.115 Vali Acc: 0.528 Test Loss: 2.115 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4218401908874512
Epoch: 19, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.039 Vali Acc: 0.500 Test Loss: 2.039 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 299418
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.937732696533203
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.710 Vali Acc: 0.511 Test Loss: 0.710 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.22519850730896
Epoch: 2, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2823166847229004
Epoch: 3, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.869 Vali Acc: 0.506 Test Loss: 0.869 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3499665260314941
Epoch: 4, Steps: 13 | Train Loss: 0.865 Vali Loss: 0.909 Vali Acc: 0.506 Test Loss: 0.909 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2901990413665771
Epoch: 5, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.967 Vali Acc: 0.494 Test Loss: 0.967 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.29738187789917
Epoch: 6, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.911 Vali Acc: 0.522 Test Loss: 0.911 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522213).  Saving model ...
Epoch: 7 cost time: 1.2541248798370361
Epoch: 7, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.914 Vali Acc: 0.517 Test Loss: 0.914 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2626080513000488
Epoch: 8, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.807 Vali Acc: 0.489 Test Loss: 0.807 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2789504528045654
Epoch: 9, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.797 Vali Acc: 0.556 Test Loss: 0.797 Test Acc: 0.556
Validation loss decreased (-0.522213 --> -0.555548).  Saving model ...
Epoch: 10 cost time: 1.3528010845184326
Epoch: 10, Steps: 13 | Train Loss: 0.444 Vali Loss: 1.250 Vali Acc: 0.550 Test Loss: 1.250 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3160293102264404
Epoch: 11, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.962 Vali Acc: 0.489 Test Loss: 0.962 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3457608222961426
Epoch: 12, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.130 Vali Acc: 0.506 Test Loss: 1.130 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3487753868103027
Epoch: 13, Steps: 13 | Train Loss: 0.366 Vali Loss: 2.067 Vali Acc: 0.511 Test Loss: 2.067 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3564598560333252
Epoch: 14, Steps: 13 | Train Loss: 0.471 Vali Loss: 1.071 Vali Acc: 0.556 Test Loss: 1.071 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2965764999389648
Epoch: 15, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3535575866699219
Epoch: 16, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.355 Vali Acc: 0.517 Test Loss: 1.355 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3480138778686523
Epoch: 17, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.454 Vali Acc: 0.550 Test Loss: 1.454 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2749779224395752
Epoch: 18, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.769 Vali Acc: 0.539 Test Loss: 1.769 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2844109535217285
Epoch: 19, Steps: 13 | Train Loss: 0.227 Vali Loss: 2.186 Vali Acc: 0.550 Test Loss: 2.186 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 299418
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1432111263275146
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.701 Vali Acc: 0.556 Test Loss: 0.701 Test Acc: 0.556
Validation loss decreased (inf --> -0.555549).  Saving model ...
Epoch: 2 cost time: 1.5777127742767334
Epoch: 2, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.728 Vali Acc: 0.533 Test Loss: 0.728 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.531031608581543
Epoch: 3, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.853 Vali Acc: 0.511 Test Loss: 0.853 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4729480743408203
Epoch: 4, Steps: 13 | Train Loss: 0.574 Vali Loss: 1.113 Vali Acc: 0.489 Test Loss: 1.113 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5552983283996582
Epoch: 5, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.933 Vali Acc: 0.483 Test Loss: 0.933 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5039498805999756
Epoch: 6, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.225 Vali Acc: 0.506 Test Loss: 1.225 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5453236103057861
Epoch: 7, Steps: 13 | Train Loss: 0.458 Vali Loss: 1.153 Vali Acc: 0.483 Test Loss: 1.153 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5001065731048584
Epoch: 8, Steps: 13 | Train Loss: 0.518 Vali Loss: 1.010 Vali Acc: 0.511 Test Loss: 1.010 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5858526229858398
Epoch: 9, Steps: 13 | Train Loss: 0.463 Vali Loss: 1.175 Vali Acc: 0.544 Test Loss: 1.175 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5646190643310547
Epoch: 10, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5338890552520752
Epoch: 11, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.431 Vali Acc: 0.489 Test Loss: 1.431 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 233882
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.990699052810669
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.705 Vali Acc: 0.522 Test Loss: 0.705 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.552652359008789
Epoch: 2, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.709 Vali Acc: 0.533 Test Loss: 0.709 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.4865431785583496
Epoch: 3, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.802 Vali Acc: 0.522 Test Loss: 0.802 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4009828567504883
Epoch: 4, Steps: 13 | Train Loss: 0.561 Vali Loss: 1.103 Vali Acc: 0.506 Test Loss: 1.103 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4560730457305908
Epoch: 5, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.892 Vali Acc: 0.528 Test Loss: 0.892 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4726841449737549
Epoch: 6, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.252 Vali Acc: 0.517 Test Loss: 1.252 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.429274320602417
Epoch: 7, Steps: 13 | Train Loss: 0.465 Vali Loss: 1.069 Vali Acc: 0.511 Test Loss: 1.069 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5137009620666504
Epoch: 8, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.967 Vali Acc: 0.511 Test Loss: 0.967 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4300768375396729
Epoch: 9, Steps: 13 | Train Loss: 0.526 Vali Loss: 1.085 Vali Acc: 0.494 Test Loss: 1.085 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4919917583465576
Epoch: 10, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.304 Vali Acc: 0.539 Test Loss: 1.304 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538876).  Saving model ...
Epoch: 11 cost time: 1.4238207340240479
Epoch: 11, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.354 Vali Acc: 0.500 Test Loss: 1.354 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5577192306518555
Epoch: 12, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.178 Vali Acc: 0.533 Test Loss: 1.178 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.363835334777832
Epoch: 13, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.582 Vali Acc: 0.533 Test Loss: 1.582 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5048129558563232
Epoch: 14, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.507 Vali Acc: 0.522 Test Loss: 1.507 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4926812648773193
Epoch: 15, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.793 Vali Acc: 0.522 Test Loss: 1.793 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4100944995880127
Epoch: 16, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.811 Vali Acc: 0.517 Test Loss: 1.811 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4527537822723389
Epoch: 17, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.758 Vali Acc: 0.550 Test Loss: 1.758 Test Acc: 0.550
Validation loss decreased (-0.538876 --> -0.549982).  Saving model ...
Epoch: 18 cost time: 1.4458014965057373
Epoch: 18, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.674 Vali Acc: 0.456 Test Loss: 1.674 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.505140781402588
Epoch: 19, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.915 Vali Acc: 0.517 Test Loss: 1.915 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.434434175491333
Epoch: 20, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.964 Vali Acc: 0.511 Test Loss: 1.964 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4148850440979004
Epoch: 21, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.841 Vali Acc: 0.511 Test Loss: 1.841 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2885401248931885
Epoch: 22, Steps: 13 | Train Loss: 0.033 Vali Loss: 2.003 Vali Acc: 0.528 Test Loss: 2.003 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3517251014709473
Epoch: 23, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.999 Vali Acc: 0.506 Test Loss: 1.999 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.338064432144165
Epoch: 24, Steps: 13 | Train Loss: 0.033 Vali Loss: 2.473 Vali Acc: 0.511 Test Loss: 2.473 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.351850986480713
Epoch: 25, Steps: 13 | Train Loss: 0.081 Vali Loss: 2.397 Vali Acc: 0.500 Test Loss: 2.397 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4729282855987549
Epoch: 26, Steps: 13 | Train Loss: 0.091 Vali Loss: 2.370 Vali Acc: 0.500 Test Loss: 2.370 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4960803985595703
Epoch: 27, Steps: 13 | Train Loss: 0.083 Vali Loss: 2.563 Vali Acc: 0.561 Test Loss: 2.563 Test Acc: 0.561
Validation loss decreased (-0.549982 --> -0.561085).  Saving model ...
Epoch: 28 cost time: 1.4999818801879883
Epoch: 28, Steps: 13 | Train Loss: 0.051 Vali Loss: 2.782 Vali Acc: 0.522 Test Loss: 2.782 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.437652349472046
Epoch: 29, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.640 Vali Acc: 0.483 Test Loss: 2.640 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4462976455688477
Epoch: 30, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.727 Vali Acc: 0.500 Test Loss: 2.727 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3952066898345947
Epoch: 31, Steps: 13 | Train Loss: 0.015 Vali Loss: 3.186 Vali Acc: 0.500 Test Loss: 3.186 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5015628337860107
Epoch: 32, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.847 Vali Acc: 0.472 Test Loss: 2.847 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3141987323760986
Epoch: 33, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.721 Vali Acc: 0.500 Test Loss: 2.721 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.407930850982666
Epoch: 34, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.863 Vali Acc: 0.478 Test Loss: 2.863 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4652929306030273
Epoch: 35, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.874 Vali Acc: 0.517 Test Loss: 2.874 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4815363883972168
Epoch: 36, Steps: 13 | Train Loss: 0.007 Vali Loss: 3.311 Vali Acc: 0.511 Test Loss: 3.311 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4887807369232178
Epoch: 37, Steps: 13 | Train Loss: 0.040 Vali Loss: 2.988 Vali Acc: 0.528 Test Loss: 2.988 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 233882
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8720293045043945
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.717 Vali Acc: 0.494 Test Loss: 0.717 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.3045074939727783
Epoch: 2, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.695 Vali Acc: 0.533 Test Loss: 0.695 Test Acc: 0.533
Validation loss decreased (-0.494437 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.2912414073944092
Epoch: 3, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.795 Vali Acc: 0.544 Test Loss: 0.795 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544436).  Saving model ...
Epoch: 4 cost time: 1.3964545726776123
Epoch: 4, Steps: 13 | Train Loss: 0.562 Vali Loss: 1.041 Vali Acc: 0.522 Test Loss: 1.041 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.282386302947998
Epoch: 5, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.845 Vali Acc: 0.517 Test Loss: 0.845 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3460333347320557
Epoch: 6, Steps: 13 | Train Loss: 0.494 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3409957885742188
Epoch: 7, Steps: 13 | Train Loss: 0.621 Vali Loss: 1.019 Vali Acc: 0.539 Test Loss: 1.019 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3214564323425293
Epoch: 8, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.895 Vali Acc: 0.556 Test Loss: 0.895 Test Acc: 0.556
Validation loss decreased (-0.544436 --> -0.555547).  Saving model ...
Epoch: 9 cost time: 1.3656580448150635
Epoch: 9, Steps: 13 | Train Loss: 0.506 Vali Loss: 1.074 Vali Acc: 0.489 Test Loss: 1.074 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.312023401260376
Epoch: 10, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.288 Vali Acc: 0.544 Test Loss: 1.288 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3403537273406982
Epoch: 11, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3561110496520996
Epoch: 12, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.113 Vali Acc: 0.544 Test Loss: 1.113 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.390601634979248
Epoch: 13, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.097 Vali Acc: 0.550 Test Loss: 1.097 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.341120719909668
Epoch: 14, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.171 Vali Acc: 0.550 Test Loss: 1.171 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3244109153747559
Epoch: 15, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.598 Vali Acc: 0.500 Test Loss: 1.598 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3246078491210938
Epoch: 16, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.474 Vali Acc: 0.550 Test Loss: 1.474 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.307403326034546
Epoch: 17, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.378 Vali Acc: 0.533 Test Loss: 1.378 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.316960096359253
Epoch: 18, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.453 Vali Acc: 0.533 Test Loss: 1.453 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 233882
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8923938274383545
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.716 Vali Acc: 0.517 Test Loss: 0.716 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.2198967933654785
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.673 Vali Acc: 0.533 Test Loss: 0.673 Test Acc: 0.533
Validation loss decreased (-0.516660 --> -0.533327).  Saving model ...
Epoch: 3 cost time: 1.162531852722168
Epoch: 3, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.730 Vali Acc: 0.528 Test Loss: 0.730 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2343919277191162
Epoch: 4, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.996 Vali Acc: 0.544 Test Loss: 0.996 Test Acc: 0.544
Validation loss decreased (-0.533327 --> -0.544434).  Saving model ...
Epoch: 5 cost time: 1.1815166473388672
Epoch: 5, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.789 Vali Acc: 0.556 Test Loss: 0.789 Test Acc: 0.556
Validation loss decreased (-0.544434 --> -0.555548).  Saving model ...
Epoch: 6 cost time: 1.309615135192871
Epoch: 6, Steps: 13 | Train Loss: 0.559 Vali Loss: 1.057 Vali Acc: 0.494 Test Loss: 1.057 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2100472450256348
Epoch: 7, Steps: 13 | Train Loss: 0.750 Vali Loss: 1.107 Vali Acc: 0.478 Test Loss: 1.107 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2909698486328125
Epoch: 8, Steps: 13 | Train Loss: 0.557 Vali Loss: 1.194 Vali Acc: 0.517 Test Loss: 1.194 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3330764770507812
Epoch: 9, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.838 Vali Acc: 0.533 Test Loss: 0.838 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2552940845489502
Epoch: 10, Steps: 13 | Train Loss: 0.617 Vali Loss: 1.202 Vali Acc: 0.539 Test Loss: 1.202 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3286633491516113
Epoch: 11, Steps: 13 | Train Loss: 0.530 Vali Loss: 1.020 Vali Acc: 0.517 Test Loss: 1.020 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.209367275238037
Epoch: 12, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.935 Vali Acc: 0.517 Test Loss: 0.935 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2386791706085205
Epoch: 13, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.271 Vali Acc: 0.511 Test Loss: 1.271 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2876558303833008
Epoch: 14, Steps: 13 | Train Loss: 0.625 Vali Loss: 1.172 Vali Acc: 0.550 Test Loss: 1.172 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1833667755126953
Epoch: 15, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.272 Vali Acc: 0.550 Test Loss: 1.272 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 233882
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2086050510406494
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.816 Vali Acc: 0.506 Test Loss: 0.816 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 1.4687199592590332
Epoch: 2, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.874 Vali Acc: 0.517 Test Loss: 0.874 Test Acc: 0.517
Validation loss decreased (-0.505547 --> -0.516658).  Saving model ...
Epoch: 3 cost time: 1.564976453781128
Epoch: 3, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.792 Vali Acc: 0.506 Test Loss: 0.792 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5168919563293457
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.888 Vali Acc: 0.544 Test Loss: 0.888 Test Acc: 0.544
Validation loss decreased (-0.516658 --> -0.544436).  Saving model ...
Epoch: 5 cost time: 1.5425350666046143
Epoch: 5, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.912 Vali Acc: 0.533 Test Loss: 0.912 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6208312511444092
Epoch: 6, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.050 Vali Acc: 0.511 Test Loss: 1.050 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5767416954040527
Epoch: 7, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.317 Vali Acc: 0.472 Test Loss: 1.317 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4219040870666504
Epoch: 8, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.363 Vali Acc: 0.506 Test Loss: 1.363 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5650484561920166
Epoch: 9, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.749 Vali Acc: 0.511 Test Loss: 1.749 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5867598056793213
Epoch: 10, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.410 Vali Acc: 0.522 Test Loss: 1.410 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5366063117980957
Epoch: 11, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.359 Vali Acc: 0.539 Test Loss: 1.359 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4816982746124268
Epoch: 12, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.554 Vali Acc: 0.544 Test Loss: 1.554 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4995110034942627
Epoch: 13, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.586 Vali Acc: 0.522 Test Loss: 1.586 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5303459167480469
Epoch: 14, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.823 Vali Acc: 0.522 Test Loss: 1.823 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 201114
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.035655975341797
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.807 Vali Acc: 0.506 Test Loss: 0.807 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 1.4974262714385986
Epoch: 2, Steps: 13 | Train Loss: 0.791 Vali Loss: 0.850 Vali Acc: 0.522 Test Loss: 0.850 Test Acc: 0.522
Validation loss decreased (-0.505547 --> -0.522214).  Saving model ...
Epoch: 3 cost time: 1.4387834072113037
Epoch: 3, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6035103797912598
Epoch: 4, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.804 Vali Acc: 0.544 Test Loss: 0.804 Test Acc: 0.544
Validation loss decreased (-0.522214 --> -0.544436).  Saving model ...
Epoch: 5 cost time: 1.4941608905792236
Epoch: 5, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.833 Vali Acc: 0.522 Test Loss: 0.833 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5516107082366943
Epoch: 6, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.040 Vali Acc: 0.506 Test Loss: 1.040 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4769470691680908
Epoch: 7, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.177 Vali Acc: 0.494 Test Loss: 1.177 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4358270168304443
Epoch: 8, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.476 Vali Acc: 0.522 Test Loss: 1.476 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.50156569480896
Epoch: 9, Steps: 13 | Train Loss: 0.487 Vali Loss: 1.399 Vali Acc: 0.483 Test Loss: 1.399 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.410691261291504
Epoch: 10, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.309 Vali Acc: 0.511 Test Loss: 1.309 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.453808069229126
Epoch: 11, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.299 Vali Acc: 0.506 Test Loss: 1.299 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3740296363830566
Epoch: 12, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.974 Vali Acc: 0.494 Test Loss: 1.974 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5069034099578857
Epoch: 13, Steps: 13 | Train Loss: 0.553 Vali Loss: 1.437 Vali Acc: 0.561 Test Loss: 1.437 Test Acc: 0.561
Validation loss decreased (-0.544436 --> -0.561097).  Saving model ...
Epoch: 14 cost time: 1.541325569152832
Epoch: 14, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.382 Vali Acc: 0.550 Test Loss: 1.382 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4446120262145996
Epoch: 15, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.572 Vali Acc: 0.494 Test Loss: 1.572 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.37680983543396
Epoch: 16, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.815 Vali Acc: 0.539 Test Loss: 1.815 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4227995872497559
Epoch: 17, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.458 Vali Acc: 0.589 Test Loss: 1.458 Test Acc: 0.589
Validation loss decreased (-0.561097 --> -0.588874).  Saving model ...
Epoch: 18 cost time: 1.4557325839996338
Epoch: 18, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.648 Vali Acc: 0.517 Test Loss: 1.648 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.498978853225708
Epoch: 19, Steps: 13 | Train Loss: 0.151 Vali Loss: 2.009 Vali Acc: 0.522 Test Loss: 2.009 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4922921657562256
Epoch: 20, Steps: 13 | Train Loss: 0.114 Vali Loss: 2.360 Vali Acc: 0.489 Test Loss: 2.360 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5270233154296875
Epoch: 21, Steps: 13 | Train Loss: 0.300 Vali Loss: 2.006 Vali Acc: 0.517 Test Loss: 2.006 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.513521432876587
Epoch: 22, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.969 Vali Acc: 0.550 Test Loss: 1.969 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.499678134918213
Epoch: 23, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.878 Vali Acc: 0.567 Test Loss: 1.878 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4001882076263428
Epoch: 24, Steps: 13 | Train Loss: 0.031 Vali Loss: 2.230 Vali Acc: 0.556 Test Loss: 2.230 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5035207271575928
Epoch: 25, Steps: 13 | Train Loss: 0.046 Vali Loss: 2.324 Vali Acc: 0.506 Test Loss: 2.324 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4335591793060303
Epoch: 26, Steps: 13 | Train Loss: 0.043 Vali Loss: 2.025 Vali Acc: 0.567 Test Loss: 2.025 Test Acc: 0.567
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5178687572479248
Epoch: 27, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.025 Vali Acc: 0.533 Test Loss: 2.025 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 201114
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.887577772140503
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.2619130611419678
Epoch: 2, Steps: 13 | Train Loss: 0.808 Vali Loss: 0.833 Vali Acc: 0.506 Test Loss: 0.833 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505547).  Saving model ...
Epoch: 3 cost time: 1.2947590351104736
Epoch: 3, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.761 Vali Acc: 0.483 Test Loss: 0.761 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2597670555114746
Epoch: 4, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.781 Vali Acc: 0.539 Test Loss: 0.781 Test Acc: 0.539
Validation loss decreased (-0.505547 --> -0.538881).  Saving model ...
Epoch: 5 cost time: 1.2830488681793213
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.846 Vali Acc: 0.478 Test Loss: 0.846 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.266193151473999
Epoch: 6, Steps: 13 | Train Loss: 0.513 Vali Loss: 1.293 Vali Acc: 0.533 Test Loss: 1.293 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.334845781326294
Epoch: 7, Steps: 13 | Train Loss: 0.777 Vali Loss: 1.144 Vali Acc: 0.528 Test Loss: 1.144 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3460092544555664
Epoch: 8, Steps: 13 | Train Loss: 0.559 Vali Loss: 1.322 Vali Acc: 0.528 Test Loss: 1.322 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2908971309661865
Epoch: 9, Steps: 13 | Train Loss: 0.629 Vali Loss: 1.452 Vali Acc: 0.506 Test Loss: 1.452 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2953259944915771
Epoch: 10, Steps: 13 | Train Loss: 0.537 Vali Loss: 1.085 Vali Acc: 0.494 Test Loss: 1.085 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.24540376663208
Epoch: 11, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.091 Vali Acc: 0.528 Test Loss: 1.091 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2665705680847168
Epoch: 12, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.422 Vali Acc: 0.511 Test Loss: 1.422 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2964487075805664
Epoch: 13, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.151 Vali Acc: 0.567 Test Loss: 1.151 Test Acc: 0.567
Validation loss decreased (-0.538881 --> -0.566655).  Saving model ...
Epoch: 14 cost time: 1.3072054386138916
Epoch: 14, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.123 Vali Acc: 0.550 Test Loss: 1.123 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2686891555786133
Epoch: 15, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.578 Vali Acc: 0.483 Test Loss: 1.578 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3233938217163086
Epoch: 16, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.683 Vali Acc: 0.533 Test Loss: 1.683 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3729181289672852
Epoch: 17, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.823 Vali Acc: 0.544 Test Loss: 1.823 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3220798969268799
Epoch: 18, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.778 Vali Acc: 0.567 Test Loss: 1.778 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2796359062194824
Epoch: 19, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.711 Vali Acc: 0.517 Test Loss: 1.711 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2787539958953857
Epoch: 20, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.587 Vali Acc: 0.528 Test Loss: 1.587 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3167812824249268
Epoch: 21, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.682 Vali Acc: 0.528 Test Loss: 1.682 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2840368747711182
Epoch: 22, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.898 Vali Acc: 0.550 Test Loss: 1.898 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3388843536376953
Epoch: 23, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.899 Vali Acc: 0.544 Test Loss: 1.899 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 201114
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8894236087799072
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.2469003200531006
Epoch: 2, Steps: 13 | Train Loss: 0.821 Vali Loss: 0.732 Vali Acc: 0.528 Test Loss: 0.732 Test Acc: 0.528
Validation loss decreased (-0.499992 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.2382128238677979
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.732 Vali Acc: 0.511 Test Loss: 0.732 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1772620677947998
Epoch: 4, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.698 Vali Acc: 0.522 Test Loss: 0.698 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.242971420288086
Epoch: 5, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.739 Vali Acc: 0.506 Test Loss: 0.739 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2338695526123047
Epoch: 6, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.786 Vali Acc: 0.539 Test Loss: 0.786 Test Acc: 0.539
Validation loss decreased (-0.527770 --> -0.538881).  Saving model ...
Epoch: 7 cost time: 1.335606336593628
Epoch: 7, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.836 Vali Acc: 0.500 Test Loss: 0.836 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2256627082824707
Epoch: 8, Steps: 13 | Train Loss: 0.593 Vali Loss: 1.354 Vali Acc: 0.517 Test Loss: 1.354 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2220180034637451
Epoch: 9, Steps: 13 | Train Loss: 0.634 Vali Loss: 1.373 Vali Acc: 0.528 Test Loss: 1.373 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.168708324432373
Epoch: 10, Steps: 13 | Train Loss: 0.726 Vali Loss: 1.044 Vali Acc: 0.500 Test Loss: 1.044 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2140212059020996
Epoch: 11, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.858 Vali Acc: 0.517 Test Loss: 0.858 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.122756004333496
Epoch: 12, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.881 Vali Acc: 0.522 Test Loss: 0.881 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1896934509277344
Epoch: 13, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.175 Vali Acc: 0.517 Test Loss: 1.175 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3389692306518555
Epoch: 14, Steps: 13 | Train Loss: 0.532 Vali Loss: 1.134 Vali Acc: 0.511 Test Loss: 1.134 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.284132719039917
Epoch: 15, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.444 Vali Acc: 0.517 Test Loss: 1.444 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3409216403961182
Epoch: 16, Steps: 13 | Train Loss: 0.603 Vali Loss: 2.079 Vali Acc: 0.522 Test Loss: 2.079 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 201114
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.003811836242676
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.751 Vali Acc: 0.517 Test Loss: 0.751 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 1.3809397220611572
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.818 Vali Acc: 0.550 Test Loss: 0.818 Test Acc: 0.550
Validation loss decreased (-0.516659 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 1.538663625717163
Epoch: 3, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.786 Vali Acc: 0.539 Test Loss: 0.786 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4987859725952148
Epoch: 4, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.891 Vali Acc: 0.517 Test Loss: 0.891 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5263919830322266
Epoch: 5, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.850 Vali Acc: 0.544 Test Loss: 0.850 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4782235622406006
Epoch: 6, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4733963012695312
Epoch: 7, Steps: 13 | Train Loss: 0.582 Vali Loss: 1.244 Vali Acc: 0.533 Test Loss: 1.244 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.482024908065796
Epoch: 8, Steps: 13 | Train Loss: 0.612 Vali Loss: 1.118 Vali Acc: 0.511 Test Loss: 1.118 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5409810543060303
Epoch: 9, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.571 Vali Acc: 0.511 Test Loss: 1.571 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5385198593139648
Epoch: 10, Steps: 13 | Train Loss: 0.471 Vali Loss: 1.315 Vali Acc: 0.517 Test Loss: 1.315 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5433261394500732
Epoch: 11, Steps: 13 | Train Loss: 0.363 Vali Loss: 1.405 Vali Acc: 0.533 Test Loss: 1.405 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5635039806365967
Epoch: 12, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.291 Vali Acc: 0.539 Test Loss: 1.291 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 184730
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0802090167999268
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.747 Vali Acc: 0.522 Test Loss: 0.747 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.4406304359436035
Epoch: 2, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.831 Vali Acc: 0.522 Test Loss: 0.831 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4147770404815674
Epoch: 3, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.751 Vali Acc: 0.511 Test Loss: 0.751 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3516085147857666
Epoch: 4, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.835 Vali Acc: 0.494 Test Loss: 0.835 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4784462451934814
Epoch: 5, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.832 Vali Acc: 0.544 Test Loss: 0.832 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544436).  Saving model ...
Epoch: 6 cost time: 1.4324045181274414
Epoch: 6, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.026 Vali Acc: 0.539 Test Loss: 1.026 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4385199546813965
Epoch: 7, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.906 Vali Acc: 0.522 Test Loss: 0.906 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4219624996185303
Epoch: 8, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.203 Vali Acc: 0.511 Test Loss: 1.203 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.411158800125122
Epoch: 9, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.289 Vali Acc: 0.544 Test Loss: 1.289 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3477778434753418
Epoch: 10, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.249 Vali Acc: 0.511 Test Loss: 1.249 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3770411014556885
Epoch: 11, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.080 Vali Acc: 0.517 Test Loss: 1.080 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.42042875289917
Epoch: 12, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.239 Vali Acc: 0.528 Test Loss: 1.239 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4035265445709229
Epoch: 13, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.245 Vali Acc: 0.533 Test Loss: 1.245 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5087733268737793
Epoch: 14, Steps: 13 | Train Loss: 0.419 Vali Loss: 2.077 Vali Acc: 0.511 Test Loss: 2.077 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.505643367767334
Epoch: 15, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.553 Vali Acc: 0.517 Test Loss: 1.553 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 184730
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.923907518386841
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.756 Vali Acc: 0.506 Test Loss: 0.756 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.2883665561676025
Epoch: 2, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.835 Vali Acc: 0.517 Test Loss: 0.835 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516658).  Saving model ...
Epoch: 3 cost time: 1.2457044124603271
Epoch: 3, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.722 Vali Acc: 0.533 Test Loss: 0.722 Test Acc: 0.533
Validation loss decreased (-0.516658 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.3507254123687744
Epoch: 4, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.801 Vali Acc: 0.522 Test Loss: 0.801 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2976820468902588
Epoch: 5, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.770 Vali Acc: 0.550 Test Loss: 0.770 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 1.3400967121124268
Epoch: 6, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.912 Vali Acc: 0.489 Test Loss: 0.912 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2942986488342285
Epoch: 7, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.817 Vali Acc: 0.583 Test Loss: 0.817 Test Acc: 0.583
Validation loss decreased (-0.549992 --> -0.583325).  Saving model ...
Epoch: 8 cost time: 1.2475581169128418
Epoch: 8, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.156 Vali Acc: 0.528 Test Loss: 1.156 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3106434345245361
Epoch: 9, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.924 Vali Acc: 0.539 Test Loss: 0.924 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.254690170288086
Epoch: 10, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.143 Vali Acc: 0.533 Test Loss: 1.143 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2928612232208252
Epoch: 11, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.035 Vali Acc: 0.517 Test Loss: 1.035 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3035635948181152
Epoch: 12, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.061 Vali Acc: 0.539 Test Loss: 1.061 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2894887924194336
Epoch: 13, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.212 Vali Acc: 0.517 Test Loss: 1.212 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3364577293395996
Epoch: 14, Steps: 13 | Train Loss: 0.195 Vali Loss: 1.413 Vali Acc: 0.517 Test Loss: 1.413 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.284834384918213
Epoch: 15, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3449010848999023
Epoch: 16, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.321 Vali Acc: 0.517 Test Loss: 1.321 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2514188289642334
Epoch: 17, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.376 Vali Acc: 0.533 Test Loss: 1.376 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 184730
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1061997413635254
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.738 Vali Acc: 0.539 Test Loss: 0.738 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.2924132347106934
Epoch: 2, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.825 Vali Acc: 0.506 Test Loss: 0.825 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3951315879821777
Epoch: 3, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.729 Vali Acc: 0.517 Test Loss: 0.729 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3322348594665527
Epoch: 4, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.828 Vali Acc: 0.550 Test Loss: 0.828 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 1.2555346488952637
Epoch: 5, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.855 Vali Acc: 0.506 Test Loss: 0.855 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.255448341369629
Epoch: 6, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.827 Vali Acc: 0.528 Test Loss: 0.827 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2249174118041992
Epoch: 7, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.724 Vali Acc: 0.556 Test Loss: 0.724 Test Acc: 0.556
Validation loss decreased (-0.549992 --> -0.555548).  Saving model ...
Epoch: 8 cost time: 1.299670696258545
Epoch: 8, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.877 Vali Acc: 0.522 Test Loss: 0.877 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3083372116088867
Epoch: 9, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.797 Vali Acc: 0.506 Test Loss: 0.797 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2885668277740479
Epoch: 10, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.817 Vali Acc: 0.539 Test Loss: 0.817 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.333676815032959
Epoch: 11, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.802 Vali Acc: 0.561 Test Loss: 0.802 Test Acc: 0.561
Validation loss decreased (-0.555548 --> -0.561103).  Saving model ...
Epoch: 12 cost time: 1.3226256370544434
Epoch: 12, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.868 Vali Acc: 0.528 Test Loss: 0.868 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2777948379516602
Epoch: 13, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.022 Vali Acc: 0.500 Test Loss: 1.022 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.311997652053833
Epoch: 14, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2654690742492676
Epoch: 15, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.068 Vali Acc: 0.550 Test Loss: 1.068 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.286412239074707
Epoch: 16, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.443 Vali Acc: 0.517 Test Loss: 1.443 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1942942142486572
Epoch: 17, Steps: 13 | Train Loss: 0.324 Vali Loss: 2.038 Vali Acc: 0.489 Test Loss: 2.038 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2910614013671875
Epoch: 18, Steps: 13 | Train Loss: 0.653 Vali Loss: 1.807 Vali Acc: 0.500 Test Loss: 1.807 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2282297611236572
Epoch: 19, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.551 Vali Acc: 0.539 Test Loss: 1.551 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2924246788024902
Epoch: 20, Steps: 13 | Train Loss: 0.599 Vali Loss: 1.324 Vali Acc: 0.517 Test Loss: 1.324 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2626302242279053
Epoch: 21, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.677 Vali Acc: 0.506 Test Loss: 1.677 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 184730
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9493439197540283
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.715 Vali Acc: 0.489 Test Loss: 0.715 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.3586187362670898
Epoch: 2, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.715 Vali Acc: 0.494 Test Loss: 0.715 Test Acc: 0.494
Validation loss decreased (-0.488882 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.3663792610168457
Epoch: 3, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.751 Vali Acc: 0.511 Test Loss: 0.751 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.4235281944274902
Epoch: 4, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.763 Vali Acc: 0.539 Test Loss: 0.763 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538881).  Saving model ...
Epoch: 5 cost time: 1.3999724388122559
Epoch: 5, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.816 Vali Acc: 0.528 Test Loss: 0.816 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4616484642028809
Epoch: 6, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.816 Vali Acc: 0.556 Test Loss: 0.816 Test Acc: 0.556
Validation loss decreased (-0.538881 --> -0.555547).  Saving model ...
Epoch: 7 cost time: 1.4257707595825195
Epoch: 7, Steps: 13 | Train Loss: 0.506 Vali Loss: 1.025 Vali Acc: 0.506 Test Loss: 1.025 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.355522632598877
Epoch: 8, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.902 Vali Acc: 0.494 Test Loss: 0.902 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4009132385253906
Epoch: 9, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.024 Vali Acc: 0.517 Test Loss: 1.024 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.403083086013794
Epoch: 10, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.329 Vali Acc: 0.517 Test Loss: 1.329 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4737884998321533
Epoch: 11, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.133 Vali Acc: 0.539 Test Loss: 1.133 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.379772424697876
Epoch: 12, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.163 Vali Acc: 0.550 Test Loss: 1.163 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4808666706085205
Epoch: 13, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.242 Vali Acc: 0.539 Test Loss: 1.242 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4579436779022217
Epoch: 14, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.238 Vali Acc: 0.544 Test Loss: 1.238 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.460432767868042
Epoch: 15, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.345 Vali Acc: 0.511 Test Loss: 1.345 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5278935432434082
Epoch: 16, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.590 Vali Acc: 0.522 Test Loss: 1.590 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 342266
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0645534992218018
Epoch: 1, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.714 Vali Acc: 0.517 Test Loss: 0.714 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.470468521118164
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.721 Vali Acc: 0.483 Test Loss: 0.721 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4078588485717773
Epoch: 3, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.750 Vali Acc: 0.483 Test Loss: 0.750 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4199576377868652
Epoch: 4, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.727 Vali Acc: 0.544 Test Loss: 0.727 Test Acc: 0.544
Validation loss decreased (-0.516660 --> -0.544437).  Saving model ...
Epoch: 5 cost time: 1.4074268341064453
Epoch: 5, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.746 Vali Acc: 0.539 Test Loss: 0.746 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.405094861984253
Epoch: 6, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.766 Vali Acc: 0.528 Test Loss: 0.766 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3820502758026123
Epoch: 7, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.970 Vali Acc: 0.483 Test Loss: 0.970 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4511816501617432
Epoch: 8, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.952 Vali Acc: 0.506 Test Loss: 0.952 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3063764572143555
Epoch: 9, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.073 Vali Acc: 0.494 Test Loss: 1.073 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3857810497283936
Epoch: 10, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.043 Vali Acc: 0.500 Test Loss: 1.043 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.326645851135254
Epoch: 11, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.140 Vali Acc: 0.528 Test Loss: 1.140 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2494022846221924
Epoch: 12, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.149 Vali Acc: 0.550 Test Loss: 1.149 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 1.3688280582427979
Epoch: 13, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.038 Vali Acc: 0.550 Test Loss: 1.038 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 14 cost time: 1.3662536144256592
Epoch: 14, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.102 Vali Acc: 0.544 Test Loss: 1.102 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.369704246520996
Epoch: 15, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.337 Vali Acc: 0.550 Test Loss: 1.337 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3652491569519043
Epoch: 16, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.222 Vali Acc: 0.544 Test Loss: 1.222 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.43446946144104
Epoch: 17, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.345 Vali Acc: 0.478 Test Loss: 1.345 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4071006774902344
Epoch: 18, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.586 Vali Acc: 0.506 Test Loss: 1.586 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4217801094055176
Epoch: 19, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.478 Vali Acc: 0.533 Test Loss: 1.478 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.432556390762329
Epoch: 20, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.560 Vali Acc: 0.550 Test Loss: 1.560 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3861567974090576
Epoch: 21, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.902 Vali Acc: 0.511 Test Loss: 1.902 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.435774326324463
Epoch: 22, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.597 Vali Acc: 0.517 Test Loss: 1.597 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4047861099243164
Epoch: 23, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.887 Vali Acc: 0.472 Test Loss: 1.887 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 342266
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.955472230911255
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.721 Vali Acc: 0.467 Test Loss: 0.721 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 1.3369803428649902
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.729 Vali Acc: 0.478 Test Loss: 0.729 Test Acc: 0.478
Validation loss decreased (-0.466659 --> -0.477770).  Saving model ...
Epoch: 3 cost time: 1.3297498226165771
Epoch: 3, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.755 Vali Acc: 0.478 Test Loss: 0.755 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.391319990158081
Epoch: 4, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.725 Vali Acc: 0.506 Test Loss: 0.725 Test Acc: 0.506
Validation loss decreased (-0.477770 --> -0.505548).  Saving model ...
Epoch: 5 cost time: 1.3668649196624756
Epoch: 5, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.754 Vali Acc: 0.572 Test Loss: 0.754 Test Acc: 0.572
Validation loss decreased (-0.505548 --> -0.572215).  Saving model ...
Epoch: 6 cost time: 1.3428106307983398
Epoch: 6, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.778 Vali Acc: 0.550 Test Loss: 0.778 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3544447422027588
Epoch: 7, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.941 Vali Acc: 0.494 Test Loss: 0.941 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.353222131729126
Epoch: 8, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.939 Vali Acc: 0.522 Test Loss: 0.939 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2722618579864502
Epoch: 9, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.059 Vali Acc: 0.506 Test Loss: 1.059 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3344449996948242
Epoch: 10, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.125 Vali Acc: 0.478 Test Loss: 1.125 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3306891918182373
Epoch: 11, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.056 Vali Acc: 0.522 Test Loss: 1.056 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3989746570587158
Epoch: 12, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.117 Vali Acc: 0.522 Test Loss: 1.117 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4018337726593018
Epoch: 13, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.156 Vali Acc: 0.489 Test Loss: 1.156 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4295103549957275
Epoch: 14, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.264 Vali Acc: 0.478 Test Loss: 1.264 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2597503662109375
Epoch: 15, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.225 Vali Acc: 0.533 Test Loss: 1.225 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 342266
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.966792106628418
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.707 Vali Acc: 0.506 Test Loss: 0.707 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.3166959285736084
Epoch: 2, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.715 Vali Acc: 0.506 Test Loss: 0.715 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3582496643066406
Epoch: 3, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.722 Vali Acc: 0.544 Test Loss: 0.722 Test Acc: 0.544
Validation loss decreased (-0.505548 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.3731465339660645
Epoch: 4, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.740 Vali Acc: 0.494 Test Loss: 0.740 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2575218677520752
Epoch: 5, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.721 Vali Acc: 0.506 Test Loss: 0.721 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.365490198135376
Epoch: 6, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.765 Vali Acc: 0.511 Test Loss: 0.765 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3488750457763672
Epoch: 7, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.907 Vali Acc: 0.494 Test Loss: 0.907 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3237121105194092
Epoch: 8, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.849 Vali Acc: 0.511 Test Loss: 0.849 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2874691486358643
Epoch: 9, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2773230075836182
Epoch: 10, Steps: 13 | Train Loss: 0.531 Vali Loss: 1.382 Vali Acc: 0.506 Test Loss: 1.382 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2991807460784912
Epoch: 11, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.979 Vali Acc: 0.528 Test Loss: 0.979 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3304455280303955
Epoch: 12, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.142 Vali Acc: 0.506 Test Loss: 1.142 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2250325679779053
Epoch: 13, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.066 Vali Acc: 0.511 Test Loss: 1.066 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 342266
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9379653930664062
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.706 Vali Acc: 0.539 Test Loss: 0.706 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.3792638778686523
Epoch: 2, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.710 Vali Acc: 0.544 Test Loss: 0.710 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 1.3399765491485596
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.715 Vali Acc: 0.544 Test Loss: 0.715 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3417925834655762
Epoch: 4, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.749 Vali Acc: 0.533 Test Loss: 0.749 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2859199047088623
Epoch: 5, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.784 Vali Acc: 0.533 Test Loss: 0.784 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.325289011001587
Epoch: 6, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.861 Vali Acc: 0.517 Test Loss: 0.861 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2727510929107666
Epoch: 7, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.891 Vali Acc: 0.506 Test Loss: 0.891 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3330657482147217
Epoch: 8, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.077 Vali Acc: 0.511 Test Loss: 1.077 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3275959491729736
Epoch: 9, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.999 Vali Acc: 0.528 Test Loss: 0.999 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2536077499389648
Epoch: 10, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.939 Vali Acc: 0.533 Test Loss: 0.939 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3427832126617432
Epoch: 11, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.293 Vali Acc: 0.517 Test Loss: 1.293 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3193259239196777
Epoch: 12, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.087 Vali Acc: 0.500 Test Loss: 1.087 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 211194
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.90494966506958
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.709 Vali Acc: 0.517 Test Loss: 0.709 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.3178839683532715
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.717 Vali Acc: 0.533 Test Loss: 0.717 Test Acc: 0.533
Validation loss decreased (-0.516660 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.3050122261047363
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.716 Vali Acc: 0.567 Test Loss: 0.716 Test Acc: 0.567
Validation loss decreased (-0.533326 --> -0.566660).  Saving model ...
Epoch: 4 cost time: 1.3016908168792725
Epoch: 4, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.740 Vali Acc: 0.533 Test Loss: 0.740 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3478453159332275
Epoch: 5, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.772 Vali Acc: 0.522 Test Loss: 0.772 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2534663677215576
Epoch: 6, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.849 Vali Acc: 0.522 Test Loss: 0.849 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2433769702911377
Epoch: 7, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.830 Vali Acc: 0.544 Test Loss: 0.830 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2375357151031494
Epoch: 8, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.916 Vali Acc: 0.550 Test Loss: 0.916 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.182021141052246
Epoch: 9, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.962 Vali Acc: 0.517 Test Loss: 0.962 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1483769416809082
Epoch: 10, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.884 Vali Acc: 0.556 Test Loss: 0.884 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3622984886169434
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.994 Vali Acc: 0.561 Test Loss: 0.994 Test Acc: 0.561
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3295321464538574
Epoch: 12, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.135 Vali Acc: 0.528 Test Loss: 1.135 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.277360439300537
Epoch: 13, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.042 Vali Acc: 0.528 Test Loss: 1.042 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 211194
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9250857830047607
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.717 Vali Acc: 0.522 Test Loss: 0.717 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.2675566673278809
Epoch: 2, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.721 Vali Acc: 0.506 Test Loss: 0.721 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2702269554138184
Epoch: 3, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
Validation loss decreased (-0.522215 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.2140257358551025
Epoch: 4, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.739 Vali Acc: 0.489 Test Loss: 0.739 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.31406831741333
Epoch: 5, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.741 Vali Acc: 0.472 Test Loss: 0.741 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.298147201538086
Epoch: 6, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2414109706878662
Epoch: 7, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.801 Vali Acc: 0.478 Test Loss: 0.801 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2831368446350098
Epoch: 8, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.873 Vali Acc: 0.461 Test Loss: 0.873 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2129690647125244
Epoch: 9, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.923 Vali Acc: 0.494 Test Loss: 0.923 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3004436492919922
Epoch: 10, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.908 Vali Acc: 0.528 Test Loss: 0.908 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2739965915679932
Epoch: 11, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2524957656860352
Epoch: 12, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.205 Vali Acc: 0.467 Test Loss: 1.205 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2775063514709473
Epoch: 13, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.089 Vali Acc: 0.494 Test Loss: 1.089 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 211194
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.704867362976074
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.715 Vali Acc: 0.494 Test Loss: 0.715 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.2217426300048828
Epoch: 2, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.735 Vali Acc: 0.456 Test Loss: 0.735 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2091655731201172
Epoch: 3, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.728 Vali Acc: 0.528 Test Loss: 0.728 Test Acc: 0.528
Validation loss decreased (-0.494437 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 1.2018601894378662
Epoch: 4, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.711 Vali Acc: 0.489 Test Loss: 0.711 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2125036716461182
Epoch: 5, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.712 Vali Acc: 0.556 Test Loss: 0.712 Test Acc: 0.556
Validation loss decreased (-0.527771 --> -0.555548).  Saving model ...
Epoch: 6 cost time: 1.2334043979644775
Epoch: 6, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.900 Vali Acc: 0.494 Test Loss: 0.900 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2928054332733154
Epoch: 7, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.751 Vali Acc: 0.528 Test Loss: 0.751 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2753267288208008
Epoch: 8, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.821 Vali Acc: 0.561 Test Loss: 0.821 Test Acc: 0.561
Validation loss decreased (-0.555548 --> -0.561103).  Saving model ...
Epoch: 9 cost time: 1.288846731185913
Epoch: 9, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.818 Vali Acc: 0.556 Test Loss: 0.818 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.210012435913086
Epoch: 10, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.963 Vali Acc: 0.528 Test Loss: 0.963 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.240339994430542
Epoch: 11, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.831 Vali Acc: 0.533 Test Loss: 0.831 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1956877708435059
Epoch: 12, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.192 Vali Acc: 0.517 Test Loss: 1.192 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2361180782318115
Epoch: 13, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.989 Vali Acc: 0.528 Test Loss: 0.989 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.196180820465088
Epoch: 14, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.013 Vali Acc: 0.517 Test Loss: 1.013 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2520036697387695
Epoch: 15, Steps: 13 | Train Loss: 0.420 Vali Loss: 1.438 Vali Acc: 0.489 Test Loss: 1.438 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2425580024719238
Epoch: 16, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.207 Vali Acc: 0.517 Test Loss: 1.207 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2323646545410156
Epoch: 17, Steps: 13 | Train Loss: 0.522 Vali Loss: 1.317 Vali Acc: 0.544 Test Loss: 1.317 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1297967433929443
Epoch: 18, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.307 Vali Acc: 0.533 Test Loss: 1.307 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 211194
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.891878128051758
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.792 Vali Acc: 0.506 Test Loss: 0.792 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.1742687225341797
Epoch: 2, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.691 Vali Acc: 0.522 Test Loss: 0.691 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.2061967849731445
Epoch: 3, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.727 Vali Acc: 0.489 Test Loss: 0.727 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1969776153564453
Epoch: 4, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.782 Vali Acc: 0.478 Test Loss: 0.782 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3168578147888184
Epoch: 5, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.760 Vali Acc: 0.544 Test Loss: 0.760 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 6 cost time: 1.23358154296875
Epoch: 6, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.1851849555969238
Epoch: 7, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.049 Vali Acc: 0.522 Test Loss: 1.049 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2062900066375732
Epoch: 8, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.874 Vali Acc: 0.544 Test Loss: 0.874 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2469236850738525
Epoch: 9, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.068 Vali Acc: 0.561 Test Loss: 1.068 Test Acc: 0.561
Validation loss decreased (-0.549992 --> -0.561100).  Saving model ...
Epoch: 10 cost time: 1.2638587951660156
Epoch: 10, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.067 Vali Acc: 0.472 Test Loss: 1.067 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2059381008148193
Epoch: 11, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.171435832977295
Epoch: 12, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.366 Vali Acc: 0.494 Test Loss: 1.366 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2620456218719482
Epoch: 13, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.148 Vali Acc: 0.533 Test Loss: 1.148 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2808644771575928
Epoch: 14, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.132 Vali Acc: 0.539 Test Loss: 1.132 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2351346015930176
Epoch: 15, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.449 Vali Acc: 0.533 Test Loss: 1.449 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2121946811676025
Epoch: 16, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.354 Vali Acc: 0.517 Test Loss: 1.354 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2504172325134277
Epoch: 17, Steps: 13 | Train Loss: 0.189 Vali Loss: 1.413 Vali Acc: 0.550 Test Loss: 1.413 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.158538579940796
Epoch: 18, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.551 Vali Acc: 0.522 Test Loss: 1.551 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.266144037246704
Epoch: 19, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.428 Vali Acc: 0.550 Test Loss: 1.428 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 145658
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.683654308319092
Epoch: 1, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.796 Vali Acc: 0.483 Test Loss: 0.796 Test Acc: 0.483
Validation loss decreased (inf --> -0.483325).  Saving model ...
Epoch: 2 cost time: 1.1506400108337402
Epoch: 2, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.705 Vali Acc: 0.483 Test Loss: 0.705 Test Acc: 0.483
Validation loss decreased (-0.483325 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 1.1628389358520508
Epoch: 3, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.736 Vali Acc: 0.511 Test Loss: 0.736 Test Acc: 0.511
Validation loss decreased (-0.483326 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.1881978511810303
Epoch: 4, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.787 Vali Acc: 0.522 Test Loss: 0.787 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522214).  Saving model ...
Epoch: 5 cost time: 1.1779675483703613
Epoch: 5, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2130069732666016
Epoch: 6, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.771 Vali Acc: 0.539 Test Loss: 0.771 Test Acc: 0.539
Validation loss decreased (-0.522214 --> -0.538881).  Saving model ...
Epoch: 7 cost time: 1.2266733646392822
Epoch: 7, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.998 Vali Acc: 0.506 Test Loss: 0.998 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1813406944274902
Epoch: 8, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.811 Vali Acc: 0.550 Test Loss: 0.811 Test Acc: 0.550
Validation loss decreased (-0.538881 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 1.2904741764068604
Epoch: 9, Steps: 13 | Train Loss: 0.458 Vali Loss: 1.014 Vali Acc: 0.544 Test Loss: 1.014 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.178666591644287
Epoch: 10, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.935 Vali Acc: 0.506 Test Loss: 0.935 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.338468074798584
Epoch: 11, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.937 Vali Acc: 0.528 Test Loss: 0.937 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1663334369659424
Epoch: 12, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.953 Vali Acc: 0.539 Test Loss: 0.953 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2064244747161865
Epoch: 13, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.042 Vali Acc: 0.517 Test Loss: 1.042 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1800458431243896
Epoch: 14, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.018 Vali Acc: 0.550 Test Loss: 1.018 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2874176502227783
Epoch: 15, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.042 Vali Acc: 0.522 Test Loss: 1.042 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1851232051849365
Epoch: 16, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.212 Vali Acc: 0.517 Test Loss: 1.212 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2914283275604248
Epoch: 17, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.236 Vali Acc: 0.544 Test Loss: 1.236 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2135426998138428
Epoch: 18, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.100 Vali Acc: 0.528 Test Loss: 1.100 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 145658
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9941580295562744
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.795 Vali Acc: 0.500 Test Loss: 0.795 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.1928191184997559
Epoch: 2, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.215498685836792
Epoch: 3, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.759 Vali Acc: 0.522 Test Loss: 0.759 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.1373786926269531
Epoch: 4, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.800 Vali Acc: 0.494 Test Loss: 0.800 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1957392692565918
Epoch: 5, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.841 Vali Acc: 0.522 Test Loss: 0.841 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.154855489730835
Epoch: 6, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.764 Vali Acc: 0.494 Test Loss: 0.764 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1930742263793945
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 1.037 Vali Acc: 0.517 Test Loss: 1.037 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.119445562362671
Epoch: 8, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2165262699127197
Epoch: 9, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.947 Vali Acc: 0.517 Test Loss: 0.947 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1037676334381104
Epoch: 10, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.973 Vali Acc: 0.489 Test Loss: 0.973 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.329634189605713
Epoch: 11, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.982 Vali Acc: 0.528 Test Loss: 0.982 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527768).  Saving model ...
Epoch: 12 cost time: 1.159578800201416
Epoch: 12, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.996 Vali Acc: 0.494 Test Loss: 0.996 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.174567461013794
Epoch: 13, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.001 Vali Acc: 0.472 Test Loss: 1.001 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.24338698387146
Epoch: 14, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.009 Vali Acc: 0.500 Test Loss: 1.009 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.141606330871582
Epoch: 15, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.096 Vali Acc: 0.483 Test Loss: 1.096 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.165353536605835
Epoch: 16, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.268711805343628
Epoch: 17, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.219 Vali Acc: 0.511 Test Loss: 1.219 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0984089374542236
Epoch: 18, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.395 Vali Acc: 0.494 Test Loss: 1.395 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.185729742050171
Epoch: 19, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.290 Vali Acc: 0.539 Test Loss: 1.290 Test Acc: 0.539
Validation loss decreased (-0.527768 --> -0.538876).  Saving model ...
Epoch: 20 cost time: 1.061227798461914
Epoch: 20, Steps: 13 | Train Loss: 0.422 Vali Loss: 1.582 Vali Acc: 0.500 Test Loss: 1.582 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.186274528503418
Epoch: 21, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.392 Vali Acc: 0.500 Test Loss: 1.392 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1642661094665527
Epoch: 22, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.584 Vali Acc: 0.478 Test Loss: 1.584 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1432549953460693
Epoch: 23, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.624 Vali Acc: 0.494 Test Loss: 1.624 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1688861846923828
Epoch: 24, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.850 Vali Acc: 0.494 Test Loss: 1.850 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2007951736450195
Epoch: 25, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.809 Vali Acc: 0.528 Test Loss: 1.809 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1674456596374512
Epoch: 26, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.749 Vali Acc: 0.494 Test Loss: 1.749 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1855781078338623
Epoch: 27, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.801 Vali Acc: 0.517 Test Loss: 1.801 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1521036624908447
Epoch: 28, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.306 Vali Acc: 0.511 Test Loss: 2.306 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1147327423095703
Epoch: 29, Steps: 13 | Train Loss: 0.194 Vali Loss: 2.310 Vali Acc: 0.500 Test Loss: 2.310 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 145658
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.847482681274414
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.772 Vali Acc: 0.489 Test Loss: 0.772 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.2142698764801025
Epoch: 2, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.736 Vali Acc: 0.506 Test Loss: 0.736 Test Acc: 0.506
Validation loss decreased (-0.488881 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.1298420429229736
Epoch: 3, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.767 Vali Acc: 0.517 Test Loss: 0.767 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.1797034740447998
Epoch: 4, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.719 Vali Acc: 0.506 Test Loss: 0.719 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.187636137008667
Epoch: 5, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.767 Vali Acc: 0.533 Test Loss: 0.767 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533326).  Saving model ...
Epoch: 6 cost time: 1.137998104095459
Epoch: 6, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.712 Vali Acc: 0.544 Test Loss: 0.712 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544437).  Saving model ...
Epoch: 7 cost time: 1.2573513984680176
Epoch: 7, Steps: 13 | Train Loss: 0.670 Vali Loss: 1.091 Vali Acc: 0.494 Test Loss: 1.091 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2743356227874756
Epoch: 8, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.990 Vali Acc: 0.506 Test Loss: 0.990 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1994171142578125
Epoch: 9, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.760 Vali Acc: 0.511 Test Loss: 0.760 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1488909721374512
Epoch: 10, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.775 Vali Acc: 0.483 Test Loss: 0.775 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1561524868011475
Epoch: 11, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.885 Vali Acc: 0.506 Test Loss: 0.885 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.185302495956421
Epoch: 12, Steps: 13 | Train Loss: 0.450 Vali Loss: 1.037 Vali Acc: 0.472 Test Loss: 1.037 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1622018814086914
Epoch: 13, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.908 Vali Acc: 0.500 Test Loss: 0.908 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.239745855331421
Epoch: 14, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.922 Vali Acc: 0.556 Test Loss: 0.922 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555546).  Saving model ...
Epoch: 15 cost time: 1.2569844722747803
Epoch: 15, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.125 Vali Acc: 0.461 Test Loss: 1.125 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1903667449951172
Epoch: 16, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.146 Vali Acc: 0.522 Test Loss: 1.146 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1100268363952637
Epoch: 17, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.180 Vali Acc: 0.517 Test Loss: 1.180 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.16041898727417
Epoch: 18, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.155 Vali Acc: 0.511 Test Loss: 1.155 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1832070350646973
Epoch: 19, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.341 Vali Acc: 0.556 Test Loss: 1.341 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1044719219207764
Epoch: 20, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.372 Vali Acc: 0.544 Test Loss: 1.372 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1150903701782227
Epoch: 21, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.286 Vali Acc: 0.539 Test Loss: 1.286 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1453216075897217
Epoch: 22, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.902 Vali Acc: 0.489 Test Loss: 1.902 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1259984970092773
Epoch: 23, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.507 Vali Acc: 0.544 Test Loss: 1.507 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1875073909759521
Epoch: 24, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.490 Vali Acc: 0.561 Test Loss: 1.490 Test Acc: 0.561
Validation loss decreased (-0.555546 --> -0.561096).  Saving model ...
Epoch: 25 cost time: 1.0792889595031738
Epoch: 25, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.695 Vali Acc: 0.522 Test Loss: 1.695 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.135970115661621
Epoch: 26, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.679 Vali Acc: 0.489 Test Loss: 1.679 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.113579273223877
Epoch: 27, Steps: 13 | Train Loss: 0.254 Vali Loss: 2.063 Vali Acc: 0.511 Test Loss: 2.063 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1360554695129395
Epoch: 28, Steps: 13 | Train Loss: 0.274 Vali Loss: 2.354 Vali Acc: 0.467 Test Loss: 2.354 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1306188106536865
Epoch: 29, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.960 Vali Acc: 0.489 Test Loss: 1.960 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1332035064697266
Epoch: 30, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.896 Vali Acc: 0.517 Test Loss: 1.896 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1787550449371338
Epoch: 31, Steps: 13 | Train Loss: 0.159 Vali Loss: 2.470 Vali Acc: 0.494 Test Loss: 2.470 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2088449001312256
Epoch: 32, Steps: 13 | Train Loss: 0.206 Vali Loss: 2.461 Vali Acc: 0.494 Test Loss: 2.461 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.201202392578125
Epoch: 33, Steps: 13 | Train Loss: 0.233 Vali Loss: 2.180 Vali Acc: 0.506 Test Loss: 2.180 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.147749662399292
Epoch: 34, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.986 Vali Acc: 0.517 Test Loss: 1.986 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 145658
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7828121185302734
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.755 Vali Acc: 0.489 Test Loss: 0.755 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.2475674152374268
Epoch: 2, Steps: 13 | Train Loss: 0.779 Vali Loss: 0.753 Vali Acc: 0.517 Test Loss: 0.753 Test Acc: 0.517
Validation loss decreased (-0.488881 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.2690300941467285
Epoch: 3, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.832 Vali Acc: 0.511 Test Loss: 0.832 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2726290225982666
Epoch: 4, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.740 Vali Acc: 0.533 Test Loss: 0.740 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533326).  Saving model ...
Epoch: 5 cost time: 1.16865873336792
Epoch: 5, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.825 Vali Acc: 0.539 Test Loss: 0.825 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538881).  Saving model ...
Epoch: 6 cost time: 1.2455487251281738
Epoch: 6, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.879 Vali Acc: 0.528 Test Loss: 0.879 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.228893756866455
Epoch: 7, Steps: 13 | Train Loss: 0.610 Vali Loss: 1.074 Vali Acc: 0.522 Test Loss: 1.074 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2613952159881592
Epoch: 8, Steps: 13 | Train Loss: 0.519 Vali Loss: 1.095 Vali Acc: 0.522 Test Loss: 1.095 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2609889507293701
Epoch: 9, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.991 Vali Acc: 0.517 Test Loss: 0.991 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2560968399047852
Epoch: 10, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.946 Vali Acc: 0.522 Test Loss: 0.946 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3326201438903809
Epoch: 11, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.052 Vali Acc: 0.528 Test Loss: 1.052 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2937045097351074
Epoch: 12, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.074 Vali Acc: 0.517 Test Loss: 1.074 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.258864164352417
Epoch: 13, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2227516174316406
Epoch: 14, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.235 Vali Acc: 0.517 Test Loss: 1.235 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.287766933441162
Epoch: 15, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.294 Vali Acc: 0.494 Test Loss: 1.294 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 112890
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9174981117248535
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.2076325416564941
Epoch: 2, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.741 Vali Acc: 0.494 Test Loss: 0.741 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2904107570648193
Epoch: 3, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.833 Vali Acc: 0.511 Test Loss: 0.833 Test Acc: 0.511
Validation loss decreased (-0.499992 --> -0.511103).  Saving model ...
Epoch: 4 cost time: 1.263627052307129
Epoch: 4, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2158598899841309
Epoch: 5, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.803 Vali Acc: 0.517 Test Loss: 0.803 Test Acc: 0.517
Validation loss decreased (-0.511103 --> -0.516659).  Saving model ...
Epoch: 6 cost time: 1.19443678855896
Epoch: 6, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.890 Vali Acc: 0.494 Test Loss: 0.890 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2003114223480225
Epoch: 7, Steps: 13 | Train Loss: 0.620 Vali Loss: 1.026 Vali Acc: 0.511 Test Loss: 1.026 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2115890979766846
Epoch: 8, Steps: 13 | Train Loss: 0.540 Vali Loss: 1.140 Vali Acc: 0.489 Test Loss: 1.140 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1394438743591309
Epoch: 9, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.911 Vali Acc: 0.533 Test Loss: 0.911 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533324).  Saving model ...
Epoch: 10 cost time: 1.1919844150543213
Epoch: 10, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.916 Vali Acc: 0.528 Test Loss: 0.916 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1724927425384521
Epoch: 11, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.984 Vali Acc: 0.528 Test Loss: 0.984 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1856577396392822
Epoch: 12, Steps: 13 | Train Loss: 0.477 Vali Loss: 1.093 Vali Acc: 0.528 Test Loss: 1.093 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1600947380065918
Epoch: 13, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.127 Vali Acc: 0.506 Test Loss: 1.127 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2290377616882324
Epoch: 14, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.156 Vali Acc: 0.517 Test Loss: 1.156 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1740798950195312
Epoch: 15, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.187 Vali Acc: 0.528 Test Loss: 1.187 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.223207712173462
Epoch: 16, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.268 Vali Acc: 0.489 Test Loss: 1.268 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.119948148727417
Epoch: 17, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.371 Vali Acc: 0.522 Test Loss: 1.371 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.13287353515625
Epoch: 18, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.267 Vali Acc: 0.506 Test Loss: 1.267 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.158782720565796
Epoch: 19, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.183 Vali Acc: 0.567 Test Loss: 1.183 Test Acc: 0.567
Validation loss decreased (-0.533324 --> -0.566655).  Saving model ...
Epoch: 20 cost time: 1.1649441719055176
Epoch: 20, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.506 Vali Acc: 0.533 Test Loss: 1.506 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1541368961334229
Epoch: 21, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.318 Vali Acc: 0.556 Test Loss: 1.318 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.188061237335205
Epoch: 22, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.981 Vali Acc: 0.522 Test Loss: 1.981 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1201770305633545
Epoch: 23, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.344 Vali Acc: 0.567 Test Loss: 1.344 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2064309120178223
Epoch: 24, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.500 Vali Acc: 0.544 Test Loss: 1.500 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1394517421722412
Epoch: 25, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.733 Vali Acc: 0.528 Test Loss: 1.733 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1191513538360596
Epoch: 26, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.535 Vali Acc: 0.517 Test Loss: 1.535 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1803348064422607
Epoch: 27, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.956 Vali Acc: 0.533 Test Loss: 1.956 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.168626070022583
Epoch: 28, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.626 Vali Acc: 0.511 Test Loss: 1.626 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.132788896560669
Epoch: 29, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.637 Vali Acc: 0.561 Test Loss: 1.637 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 112890
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8763623237609863
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.756 Vali Acc: 0.494 Test Loss: 0.756 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.1830270290374756
Epoch: 2, Steps: 13 | Train Loss: 0.785 Vali Loss: 0.726 Vali Acc: 0.506 Test Loss: 0.726 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.1529464721679688
Epoch: 3, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.833 Vali Acc: 0.511 Test Loss: 0.833 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511103).  Saving model ...
Epoch: 4 cost time: 1.283703088760376
Epoch: 4, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.725 Vali Acc: 0.511 Test Loss: 0.725 Test Acc: 0.511
Validation loss decreased (-0.511103 --> -0.511104).  Saving model ...
Epoch: 5 cost time: 1.141993761062622
Epoch: 5, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.833 Vali Acc: 0.506 Test Loss: 0.833 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.302398681640625
Epoch: 6, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.902 Vali Acc: 0.467 Test Loss: 0.902 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1124439239501953
Epoch: 7, Steps: 13 | Train Loss: 0.672 Vali Loss: 1.000 Vali Acc: 0.450 Test Loss: 1.000 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1492912769317627
Epoch: 8, Steps: 13 | Train Loss: 0.592 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1855144500732422
Epoch: 9, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.966 Vali Acc: 0.500 Test Loss: 0.966 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1591014862060547
Epoch: 10, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.886 Vali Acc: 0.494 Test Loss: 0.886 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2041690349578857
Epoch: 11, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 1.2096481323242188
Epoch: 12, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.913 Vali Acc: 0.517 Test Loss: 0.913 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2013039588928223
Epoch: 13, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.136 Vali Acc: 0.489 Test Loss: 1.136 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2549216747283936
Epoch: 14, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.139 Vali Acc: 0.494 Test Loss: 1.139 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1495692729949951
Epoch: 15, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.060 Vali Acc: 0.511 Test Loss: 1.060 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1976876258850098
Epoch: 16, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.243 Vali Acc: 0.517 Test Loss: 1.243 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2193617820739746
Epoch: 17, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.176 Vali Acc: 0.522 Test Loss: 1.176 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1946132183074951
Epoch: 18, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1097052097320557
Epoch: 19, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.177 Vali Acc: 0.522 Test Loss: 1.177 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.144883632659912
Epoch: 20, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.653 Vali Acc: 0.506 Test Loss: 1.653 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.082470178604126
Epoch: 21, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.356 Vali Acc: 0.517 Test Loss: 1.356 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 112890
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.747642993927002
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.123971939086914
Epoch: 2, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.702 Vali Acc: 0.489 Test Loss: 0.702 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1172785758972168
Epoch: 3, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9979538917541504
Epoch: 4, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.714 Vali Acc: 0.494 Test Loss: 0.714 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1019220352172852
Epoch: 5, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.856 Vali Acc: 0.500 Test Loss: 0.856 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.069021463394165
Epoch: 6, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.845 Vali Acc: 0.522 Test Loss: 0.845 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522214).  Saving model ...
Epoch: 7 cost time: 1.1388726234436035
Epoch: 7, Steps: 13 | Train Loss: 0.815 Vali Loss: 0.795 Vali Acc: 0.528 Test Loss: 0.795 Test Acc: 0.528
Validation loss decreased (-0.522214 --> -0.527770).  Saving model ...
Epoch: 8 cost time: 1.081235408782959
Epoch: 8, Steps: 13 | Train Loss: 0.629 Vali Loss: 1.148 Vali Acc: 0.494 Test Loss: 1.148 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.096041202545166
Epoch: 9, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.933 Vali Acc: 0.517 Test Loss: 0.933 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0649685859680176
Epoch: 10, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.816 Vali Acc: 0.494 Test Loss: 0.816 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1080379486083984
Epoch: 11, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.903 Vali Acc: 0.472 Test Loss: 0.903 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1058614253997803
Epoch: 12, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.906 Vali Acc: 0.533 Test Loss: 0.906 Test Acc: 0.533
Validation loss decreased (-0.527770 --> -0.533324).  Saving model ...
Epoch: 13 cost time: 1.1337974071502686
Epoch: 13, Steps: 13 | Train Loss: 0.429 Vali Loss: 1.092 Vali Acc: 0.511 Test Loss: 1.092 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1964774131774902
Epoch: 14, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.925 Vali Acc: 0.450 Test Loss: 0.925 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1355228424072266
Epoch: 15, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.942 Vali Acc: 0.539 Test Loss: 0.942 Test Acc: 0.539
Validation loss decreased (-0.533324 --> -0.538879).  Saving model ...
Epoch: 16 cost time: 1.133284091949463
Epoch: 16, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.039 Vali Acc: 0.517 Test Loss: 1.039 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1117680072784424
Epoch: 17, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.968 Vali Acc: 0.489 Test Loss: 0.968 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0691676139831543
Epoch: 18, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.213 Vali Acc: 0.517 Test Loss: 1.213 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.099400281906128
Epoch: 19, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.057 Vali Acc: 0.511 Test Loss: 1.057 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.105893611907959
Epoch: 20, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.310 Vali Acc: 0.528 Test Loss: 1.310 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0944571495056152
Epoch: 21, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.200 Vali Acc: 0.494 Test Loss: 1.200 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1142065525054932
Epoch: 22, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.382 Vali Acc: 0.500 Test Loss: 1.382 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1607513427734375
Epoch: 23, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.352 Vali Acc: 0.522 Test Loss: 1.352 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1650199890136719
Epoch: 24, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.389 Vali Acc: 0.483 Test Loss: 1.389 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.204434871673584
Epoch: 25, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.673 Vali Acc: 0.506 Test Loss: 1.673 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 112890
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.801727533340454
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.683 Vali Acc: 0.522 Test Loss: 0.683 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.1871025562286377
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.760 Vali Acc: 0.533 Test Loss: 0.760 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.15032958984375
Epoch: 3, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.742 Vali Acc: 0.544 Test Loss: 0.742 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.0812883377075195
Epoch: 4, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.788 Vali Acc: 0.478 Test Loss: 0.788 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1341972351074219
Epoch: 5, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.297982931137085
Epoch: 6, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.777 Vali Acc: 0.578 Test Loss: 0.777 Test Acc: 0.578
Validation loss decreased (-0.549993 --> -0.577770).  Saving model ...
Epoch: 7 cost time: 1.3327724933624268
Epoch: 7, Steps: 13 | Train Loss: 0.513 Vali Loss: 1.044 Vali Acc: 0.511 Test Loss: 1.044 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3535830974578857
Epoch: 8, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.937 Vali Acc: 0.522 Test Loss: 0.937 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.237546443939209
Epoch: 9, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.871 Vali Acc: 0.539 Test Loss: 0.871 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.238457441329956
Epoch: 10, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.959 Vali Acc: 0.550 Test Loss: 0.959 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1349256038665771
Epoch: 11, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.066 Vali Acc: 0.544 Test Loss: 1.066 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2004294395446777
Epoch: 12, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.986 Vali Acc: 0.528 Test Loss: 0.986 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2255499362945557
Epoch: 13, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.014 Vali Acc: 0.544 Test Loss: 1.014 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2231216430664062
Epoch: 14, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.094 Vali Acc: 0.511 Test Loss: 1.094 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2282781600952148
Epoch: 15, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.198 Vali Acc: 0.522 Test Loss: 1.198 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2936499118804932
Epoch: 16, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.190 Vali Acc: 0.533 Test Loss: 1.190 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 96506
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7748539447784424
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.687 Vali Acc: 0.522 Test Loss: 0.687 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.1344294548034668
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.765 Vali Acc: 0.511 Test Loss: 0.765 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0880889892578125
Epoch: 3, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.744 Vali Acc: 0.561 Test Loss: 0.744 Test Acc: 0.561
Validation loss decreased (-0.522215 --> -0.561104).  Saving model ...
Epoch: 4 cost time: 1.1892142295837402
Epoch: 4, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.783 Vali Acc: 0.511 Test Loss: 0.783 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1694116592407227
Epoch: 5, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.727 Vali Acc: 0.572 Test Loss: 0.727 Test Acc: 0.572
Validation loss decreased (-0.561104 --> -0.572215).  Saving model ...
Epoch: 6 cost time: 1.1726245880126953
Epoch: 6, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.751 Vali Acc: 0.578 Test Loss: 0.751 Test Acc: 0.578
Validation loss decreased (-0.572215 --> -0.577770).  Saving model ...
Epoch: 7 cost time: 1.1239144802093506
Epoch: 7, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.963 Vali Acc: 0.511 Test Loss: 0.963 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1754088401794434
Epoch: 8, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.809 Vali Acc: 0.572 Test Loss: 0.809 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1606624126434326
Epoch: 9, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.855 Vali Acc: 0.533 Test Loss: 0.855 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1125779151916504
Epoch: 10, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.878 Vali Acc: 0.572 Test Loss: 0.878 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2121281623840332
Epoch: 11, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.947 Vali Acc: 0.550 Test Loss: 0.947 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.135033369064331
Epoch: 12, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.920 Vali Acc: 0.533 Test Loss: 0.920 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.246666669845581
Epoch: 13, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.938 Vali Acc: 0.544 Test Loss: 0.938 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1976253986358643
Epoch: 14, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.124 Vali Acc: 0.494 Test Loss: 1.124 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.19773530960083
Epoch: 15, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.194 Vali Acc: 0.528 Test Loss: 1.194 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.154480218887329
Epoch: 16, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.270 Vali Acc: 0.528 Test Loss: 1.270 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 96506
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.010016918182373
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.693 Vali Acc: 0.517 Test Loss: 0.693 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.1633424758911133
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.766 Vali Acc: 0.544 Test Loss: 0.766 Test Acc: 0.544
Validation loss decreased (-0.516660 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 1.1956429481506348
Epoch: 3, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 1.1699028015136719
Epoch: 4, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.787 Vali Acc: 0.528 Test Loss: 0.787 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1868913173675537
Epoch: 5, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.734 Vali Acc: 0.556 Test Loss: 0.734 Test Acc: 0.556
Validation loss decreased (-0.549992 --> -0.555548).  Saving model ...
Epoch: 6 cost time: 1.1663062572479248
Epoch: 6, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.744 Vali Acc: 0.539 Test Loss: 0.744 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1588399410247803
Epoch: 7, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.916 Vali Acc: 0.478 Test Loss: 0.916 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1606407165527344
Epoch: 8, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.796 Vali Acc: 0.511 Test Loss: 0.796 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.163989782333374
Epoch: 9, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.826 Vali Acc: 0.528 Test Loss: 0.826 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2789819240570068
Epoch: 10, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.886 Vali Acc: 0.522 Test Loss: 0.886 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1393401622772217
Epoch: 11, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.884 Vali Acc: 0.544 Test Loss: 0.884 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1398000717163086
Epoch: 12, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.870 Vali Acc: 0.522 Test Loss: 0.870 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1765847206115723
Epoch: 13, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.914 Vali Acc: 0.511 Test Loss: 0.914 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2275426387786865
Epoch: 14, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.978 Vali Acc: 0.472 Test Loss: 0.978 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1767618656158447
Epoch: 15, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.029 Vali Acc: 0.528 Test Loss: 1.029 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 96506
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6665756702423096
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.692 Vali Acc: 0.494 Test Loss: 0.692 Test Acc: 0.494
Validation loss decreased (inf --> -0.494438).  Saving model ...
Epoch: 2 cost time: 1.2651944160461426
Epoch: 2, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.731 Vali Acc: 0.517 Test Loss: 0.731 Test Acc: 0.517
Validation loss decreased (-0.494438 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.1731233596801758
Epoch: 3, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.731 Vali Acc: 0.472 Test Loss: 0.731 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.154639720916748
Epoch: 4, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.765 Vali Acc: 0.494 Test Loss: 0.765 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1770405769348145
Epoch: 5, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.092198371887207
Epoch: 6, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.726 Vali Acc: 0.517 Test Loss: 0.726 Test Acc: 0.517
Validation loss decreased (-0.516659 --> -0.516659).  Saving model ...
Epoch: 7 cost time: 1.0570197105407715
Epoch: 7, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.951 Vali Acc: 0.500 Test Loss: 0.951 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0217781066894531
Epoch: 8, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.922 Vali Acc: 0.528 Test Loss: 0.922 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527769).  Saving model ...
Epoch: 9 cost time: 1.0631051063537598
Epoch: 9, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.887 Vali Acc: 0.539 Test Loss: 0.887 Test Acc: 0.539
Validation loss decreased (-0.527769 --> -0.538880).  Saving model ...
Epoch: 10 cost time: 1.1602113246917725
Epoch: 10, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.896 Vali Acc: 0.539 Test Loss: 0.896 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0614144802093506
Epoch: 11, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.785 Vali Acc: 0.522 Test Loss: 0.785 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1659362316131592
Epoch: 12, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.918 Vali Acc: 0.533 Test Loss: 0.918 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1054189205169678
Epoch: 13, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.824 Vali Acc: 0.528 Test Loss: 0.824 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1906273365020752
Epoch: 14, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.891 Vali Acc: 0.528 Test Loss: 0.891 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1243717670440674
Epoch: 15, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.049 Vali Acc: 0.517 Test Loss: 1.049 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.136281967163086
Epoch: 16, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.949 Vali Acc: 0.522 Test Loss: 0.949 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.143916130065918
Epoch: 17, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.935 Vali Acc: 0.539 Test Loss: 0.935 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1783103942871094
Epoch: 18, Steps: 13 | Train Loss: 0.476 Vali Loss: 1.282 Vali Acc: 0.506 Test Loss: 1.282 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1150827407836914
Epoch: 19, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.963 Vali Acc: 0.544 Test Loss: 0.963 Test Acc: 0.544
Validation loss decreased (-0.538880 --> -0.544435).  Saving model ...
Epoch: 20 cost time: 1.1164867877960205
Epoch: 20, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.998 Vali Acc: 0.472 Test Loss: 0.998 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1482138633728027
Epoch: 21, Steps: 13 | Train Loss: 0.372 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1613922119140625
Epoch: 22, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.222 Vali Acc: 0.544 Test Loss: 1.222 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1667206287384033
Epoch: 23, Steps: 13 | Train Loss: 0.403 Vali Loss: 1.400 Vali Acc: 0.528 Test Loss: 1.400 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0874581336975098
Epoch: 24, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.290 Vali Acc: 0.517 Test Loss: 1.290 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0839850902557373
Epoch: 25, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.565 Vali Acc: 0.511 Test Loss: 1.565 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1812865734100342
Epoch: 26, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.265 Vali Acc: 0.511 Test Loss: 1.265 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1046223640441895
Epoch: 27, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.323 Vali Acc: 0.528 Test Loss: 1.323 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1661715507507324
Epoch: 28, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.646 Vali Acc: 0.539 Test Loss: 1.646 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1326656341552734
Epoch: 29, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.647 Vali Acc: 0.511 Test Loss: 1.647 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 96506
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9237825870513916
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.681 Vali Acc: 0.556 Test Loss: 0.681 Test Acc: 0.556
Validation loss decreased (inf --> -0.555549).  Saving model ...
Epoch: 2 cost time: 1.2335023880004883
Epoch: 2, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.758 Vali Acc: 0.550 Test Loss: 0.758 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.155186653137207
Epoch: 3, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.709 Vali Acc: 0.561 Test Loss: 0.709 Test Acc: 0.561
Validation loss decreased (-0.555549 --> -0.561104).  Saving model ...
Epoch: 4 cost time: 1.226442575454712
Epoch: 4, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.713 Vali Acc: 0.572 Test Loss: 0.713 Test Acc: 0.572
Validation loss decreased (-0.561104 --> -0.572215).  Saving model ...
Epoch: 5 cost time: 1.2412292957305908
Epoch: 5, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1211178302764893
Epoch: 6, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.802 Vali Acc: 0.528 Test Loss: 0.802 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2281873226165771
Epoch: 7, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.774 Vali Acc: 0.556 Test Loss: 0.774 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2066097259521484
Epoch: 8, Steps: 13 | Train Loss: 0.469 Vali Loss: 1.052 Vali Acc: 0.489 Test Loss: 1.052 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2707443237304688
Epoch: 9, Steps: 13 | Train Loss: 0.518 Vali Loss: 1.343 Vali Acc: 0.467 Test Loss: 1.343 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2483057975769043
Epoch: 10, Steps: 13 | Train Loss: 0.632 Vali Loss: 1.120 Vali Acc: 0.478 Test Loss: 1.120 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2105481624603271
Epoch: 11, Steps: 13 | Train Loss: 0.467 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.200843334197998
Epoch: 12, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.134 Vali Acc: 0.489 Test Loss: 1.134 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2168183326721191
Epoch: 13, Steps: 13 | Train Loss: 0.533 Vali Loss: 1.414 Vali Acc: 0.522 Test Loss: 1.414 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2738933563232422
Epoch: 14, Steps: 13 | Train Loss: 0.718 Vali Loss: 1.131 Vali Acc: 0.544 Test Loss: 1.131 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 88314
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.604085922241211
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.680 Vali Acc: 0.567 Test Loss: 0.680 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 1.1483561992645264
Epoch: 2, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0893073081970215
Epoch: 3, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.704 Vali Acc: 0.561 Test Loss: 0.704 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0037388801574707
Epoch: 4, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.702 Vali Acc: 0.567 Test Loss: 0.702 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2567667961120605
Epoch: 5, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.758 Vali Acc: 0.539 Test Loss: 0.758 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0701465606689453
Epoch: 6, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.858 Vali Acc: 0.539 Test Loss: 0.858 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1437678337097168
Epoch: 7, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.752 Vali Acc: 0.578 Test Loss: 0.752 Test Acc: 0.578
Validation loss decreased (-0.566660 --> -0.577770).  Saving model ...
Epoch: 8 cost time: 1.1308889389038086
Epoch: 8, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.989 Vali Acc: 0.500 Test Loss: 0.989 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.068913221359253
Epoch: 9, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.225 Vali Acc: 0.489 Test Loss: 1.225 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1493027210235596
Epoch: 10, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.913 Vali Acc: 0.539 Test Loss: 0.913 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.179394245147705
Epoch: 11, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.022 Vali Acc: 0.506 Test Loss: 1.022 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2086310386657715
Epoch: 12, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.270 Vali Acc: 0.517 Test Loss: 1.270 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.118340253829956
Epoch: 13, Steps: 13 | Train Loss: 0.707 Vali Loss: 1.045 Vali Acc: 0.522 Test Loss: 1.045 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2729175090789795
Epoch: 14, Steps: 13 | Train Loss: 0.475 Vali Loss: 1.142 Vali Acc: 0.550 Test Loss: 1.142 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2520925998687744
Epoch: 15, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.027 Vali Acc: 0.511 Test Loss: 1.027 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2722091674804688
Epoch: 16, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.125 Vali Acc: 0.511 Test Loss: 1.125 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1767325401306152
Epoch: 17, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.194 Vali Acc: 0.522 Test Loss: 1.194 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 88314
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.824054718017578
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.678 Vali Acc: 0.550 Test Loss: 0.678 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.0553267002105713
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.753 Vali Acc: 0.544 Test Loss: 0.753 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1166596412658691
Epoch: 3, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.723 Vali Acc: 0.517 Test Loss: 0.723 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.10546875
Epoch: 4, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.702 Vali Acc: 0.528 Test Loss: 0.702 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0645616054534912
Epoch: 5, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.720 Vali Acc: 0.533 Test Loss: 0.720 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1553802490234375
Epoch: 6, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.874 Vali Acc: 0.511 Test Loss: 0.874 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.151775598526001
Epoch: 7, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.768 Vali Acc: 0.494 Test Loss: 0.768 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1577229499816895
Epoch: 8, Steps: 13 | Train Loss: 0.532 Vali Loss: 1.024 Vali Acc: 0.483 Test Loss: 1.024 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1429963111877441
Epoch: 9, Steps: 13 | Train Loss: 0.582 Vali Loss: 1.225 Vali Acc: 0.494 Test Loss: 1.225 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.120558500289917
Epoch: 10, Steps: 13 | Train Loss: 0.702 Vali Loss: 1.150 Vali Acc: 0.478 Test Loss: 1.150 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1866588592529297
Epoch: 11, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.149 Vali Acc: 0.506 Test Loss: 1.149 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 88314
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7279043197631836
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.691 Vali Acc: 0.506 Test Loss: 0.691 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 1.0477452278137207
Epoch: 2, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2387750148773193
Epoch: 3, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.712 Vali Acc: 0.517 Test Loss: 0.712 Test Acc: 0.517
Validation loss decreased (-0.505549 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.1568479537963867
Epoch: 4, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
Validation loss decreased (-0.516660 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.1481468677520752
Epoch: 5, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.708 Vali Acc: 0.528 Test Loss: 0.708 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1013951301574707
Epoch: 6, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.868 Vali Acc: 0.506 Test Loss: 0.868 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2278881072998047
Epoch: 7, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.747 Vali Acc: 0.489 Test Loss: 0.747 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2109479904174805
Epoch: 8, Steps: 13 | Train Loss: 0.583 Vali Loss: 1.022 Vali Acc: 0.494 Test Loss: 1.022 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1833505630493164
Epoch: 9, Steps: 13 | Train Loss: 0.858 Vali Loss: 0.849 Vali Acc: 0.539 Test Loss: 0.849 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1914503574371338
Epoch: 10, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.901 Vali Acc: 0.539 Test Loss: 0.901 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1677370071411133
Epoch: 11, Steps: 13 | Train Loss: 0.631 Vali Loss: 1.037 Vali Acc: 0.539 Test Loss: 1.037 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1157925128936768
Epoch: 12, Steps: 13 | Train Loss: 0.641 Vali Loss: 1.053 Vali Acc: 0.517 Test Loss: 1.053 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1416385173797607
Epoch: 13, Steps: 13 | Train Loss: 0.700 Vali Loss: 1.291 Vali Acc: 0.517 Test Loss: 1.291 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2951271533966064
Epoch: 14, Steps: 13 | Train Loss: 0.831 Vali Loss: 0.879 Vali Acc: 0.511 Test Loss: 0.879 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 88314
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.656964063644409
Epoch: 1, Steps: 13 | Train Loss: 0.928 Vali Loss: 1.449 Vali Acc: 0.472 Test Loss: 1.449 Test Acc: 0.472
Validation loss decreased (inf --> -0.472208).  Saving model ...
Epoch: 2 cost time: 2.9056670665740967
Epoch: 2, Steps: 13 | Train Loss: 2.074 Vali Loss: 3.407 Vali Acc: 0.489 Test Loss: 3.407 Test Acc: 0.489
Validation loss decreased (-0.472208 --> -0.488855).  Saving model ...
Epoch: 3 cost time: 2.9799883365631104
Epoch: 3, Steps: 13 | Train Loss: 2.346 Vali Loss: 3.141 Vali Acc: 0.478 Test Loss: 3.141 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9481301307678223
Epoch: 4, Steps: 13 | Train Loss: 1.338 Vali Loss: 2.123 Vali Acc: 0.489 Test Loss: 2.123 Test Acc: 0.489
Validation loss decreased (-0.488855 --> -0.488868).  Saving model ...
Epoch: 5 cost time: 3.0851166248321533
Epoch: 5, Steps: 13 | Train Loss: 0.899 Vali Loss: 3.590 Vali Acc: 0.494 Test Loss: 3.590 Test Acc: 0.494
Validation loss decreased (-0.488868 --> -0.494409).  Saving model ...
Epoch: 6 cost time: 3.0272815227508545
Epoch: 6, Steps: 13 | Train Loss: 2.016 Vali Loss: 4.837 Vali Acc: 0.494 Test Loss: 4.837 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.058617115020752
Epoch: 7, Steps: 13 | Train Loss: 1.460 Vali Loss: 3.903 Vali Acc: 0.494 Test Loss: 3.903 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.987236976623535
Epoch: 8, Steps: 13 | Train Loss: 2.347 Vali Loss: 5.256 Vali Acc: 0.517 Test Loss: 5.256 Test Acc: 0.517
Validation loss decreased (-0.494409 --> -0.516614).  Saving model ...
Epoch: 9 cost time: 2.885178327560425
Epoch: 9, Steps: 13 | Train Loss: 2.193 Vali Loss: 3.948 Vali Acc: 0.506 Test Loss: 3.948 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.004183769226074
Epoch: 10, Steps: 13 | Train Loss: 1.885 Vali Loss: 5.716 Vali Acc: 0.478 Test Loss: 5.716 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0558106899261475
Epoch: 11, Steps: 13 | Train Loss: 1.511 Vali Loss: 11.576 Vali Acc: 0.489 Test Loss: 11.576 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.19693660736084
Epoch: 12, Steps: 13 | Train Loss: 2.264 Vali Loss: 5.475 Vali Acc: 0.494 Test Loss: 5.475 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1796481609344482
Epoch: 13, Steps: 13 | Train Loss: 0.692 Vali Loss: 6.381 Vali Acc: 0.528 Test Loss: 6.381 Test Acc: 0.528
Validation loss decreased (-0.516614 --> -0.527714).  Saving model ...
Epoch: 14 cost time: 3.0086679458618164
Epoch: 14, Steps: 13 | Train Loss: 2.567 Vali Loss: 7.523 Vali Acc: 0.556 Test Loss: 7.523 Test Acc: 0.556
Validation loss decreased (-0.527714 --> -0.555480).  Saving model ...
Epoch: 15 cost time: 2.9012935161590576
Epoch: 15, Steps: 13 | Train Loss: 2.239 Vali Loss: 10.595 Vali Acc: 0.500 Test Loss: 10.595 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9832398891448975
Epoch: 16, Steps: 13 | Train Loss: 1.823 Vali Loss: 9.673 Vali Acc: 0.489 Test Loss: 9.673 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.051614284515381
Epoch: 17, Steps: 13 | Train Loss: 1.192 Vali Loss: 10.956 Vali Acc: 0.511 Test Loss: 10.956 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0609138011932373
Epoch: 18, Steps: 13 | Train Loss: 1.786 Vali Loss: 13.967 Vali Acc: 0.517 Test Loss: 13.967 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.951169490814209
Epoch: 19, Steps: 13 | Train Loss: 1.376 Vali Loss: 11.522 Vali Acc: 0.544 Test Loss: 11.522 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1068811416625977
Epoch: 20, Steps: 13 | Train Loss: 0.611 Vali Loss: 10.424 Vali Acc: 0.517 Test Loss: 10.424 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0038516521453857
Epoch: 21, Steps: 13 | Train Loss: 0.480 Vali Loss: 10.400 Vali Acc: 0.478 Test Loss: 10.400 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9924607276916504
Epoch: 22, Steps: 13 | Train Loss: 0.210 Vali Loss: 11.355 Vali Acc: 0.533 Test Loss: 11.355 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8903098106384277
Epoch: 23, Steps: 13 | Train Loss: 0.355 Vali Loss: 12.741 Vali Acc: 0.500 Test Loss: 12.741 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.9111924171447754
Epoch: 24, Steps: 13 | Train Loss: 1.385 Vali Loss: 15.412 Vali Acc: 0.506 Test Loss: 15.412 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 3825198
model size : 24.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.4166340827941895
Epoch: 1, Steps: 13 | Train Loss: 0.950 Vali Loss: 1.643 Vali Acc: 0.506 Test Loss: 1.643 Test Acc: 0.506
Validation loss decreased (inf --> -0.505539).  Saving model ...
Epoch: 2 cost time: 2.8390631675720215
Epoch: 2, Steps: 13 | Train Loss: 2.026 Vali Loss: 2.033 Vali Acc: 0.472 Test Loss: 2.033 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9319427013397217
Epoch: 3, Steps: 13 | Train Loss: 1.126 Vali Loss: 1.376 Vali Acc: 0.539 Test Loss: 1.376 Test Acc: 0.539
Validation loss decreased (-0.505539 --> -0.538875).  Saving model ...
Epoch: 4 cost time: 2.8790321350097656
Epoch: 4, Steps: 13 | Train Loss: 1.348 Vali Loss: 2.018 Vali Acc: 0.533 Test Loss: 2.018 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9581756591796875
Epoch: 5, Steps: 13 | Train Loss: 0.933 Vali Loss: 2.750 Vali Acc: 0.417 Test Loss: 2.750 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0309605598449707
Epoch: 6, Steps: 13 | Train Loss: 1.314 Vali Loss: 2.647 Vali Acc: 0.544 Test Loss: 2.647 Test Acc: 0.544
Validation loss decreased (-0.538875 --> -0.544418).  Saving model ...
Epoch: 7 cost time: 3.007201910018921
Epoch: 7, Steps: 13 | Train Loss: 0.877 Vali Loss: 3.830 Vali Acc: 0.500 Test Loss: 3.830 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.836906909942627
Epoch: 8, Steps: 13 | Train Loss: 1.074 Vali Loss: 4.005 Vali Acc: 0.489 Test Loss: 4.005 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8885159492492676
Epoch: 9, Steps: 13 | Train Loss: 1.014 Vali Loss: 4.052 Vali Acc: 0.522 Test Loss: 4.052 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.881401777267456
Epoch: 10, Steps: 13 | Train Loss: 1.201 Vali Loss: 7.115 Vali Acc: 0.489 Test Loss: 7.115 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.876286506652832
Epoch: 11, Steps: 13 | Train Loss: 1.336 Vali Loss: 4.513 Vali Acc: 0.472 Test Loss: 4.513 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.946342706680298
Epoch: 12, Steps: 13 | Train Loss: 0.710 Vali Loss: 9.715 Vali Acc: 0.511 Test Loss: 9.715 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9690511226654053
Epoch: 13, Steps: 13 | Train Loss: 4.184 Vali Loss: 9.403 Vali Acc: 0.528 Test Loss: 9.403 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.93033766746521
Epoch: 14, Steps: 13 | Train Loss: 1.045 Vali Loss: 5.471 Vali Acc: 0.494 Test Loss: 5.471 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.760669231414795
Epoch: 15, Steps: 13 | Train Loss: 0.579 Vali Loss: 5.894 Vali Acc: 0.522 Test Loss: 5.894 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.9970223903656006
Epoch: 16, Steps: 13 | Train Loss: 0.363 Vali Loss: 6.966 Vali Acc: 0.483 Test Loss: 6.966 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 3825198
model size : 24.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.204728126525879
Epoch: 1, Steps: 13 | Train Loss: 1.000 Vali Loss: 1.745 Vali Acc: 0.500 Test Loss: 1.745 Test Acc: 0.500
Validation loss decreased (inf --> -0.499983).  Saving model ...
Epoch: 2 cost time: 2.565593719482422
Epoch: 2, Steps: 13 | Train Loss: 1.705 Vali Loss: 1.087 Vali Acc: 0.472 Test Loss: 1.087 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.690953016281128
Epoch: 3, Steps: 13 | Train Loss: 0.965 Vali Loss: 1.782 Vali Acc: 0.517 Test Loss: 1.782 Test Acc: 0.517
Validation loss decreased (-0.499983 --> -0.516649).  Saving model ...
Epoch: 4 cost time: 2.4792699813842773
Epoch: 4, Steps: 13 | Train Loss: 1.323 Vali Loss: 1.538 Vali Acc: 0.494 Test Loss: 1.538 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7884528636932373
Epoch: 5, Steps: 13 | Train Loss: 1.038 Vali Loss: 1.705 Vali Acc: 0.494 Test Loss: 1.705 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6439943313598633
Epoch: 6, Steps: 13 | Train Loss: 2.061 Vali Loss: 2.240 Vali Acc: 0.467 Test Loss: 2.240 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6082119941711426
Epoch: 7, Steps: 13 | Train Loss: 1.978 Vali Loss: 5.407 Vali Acc: 0.511 Test Loss: 5.407 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.667755126953125
Epoch: 8, Steps: 13 | Train Loss: 3.267 Vali Loss: 4.917 Vali Acc: 0.533 Test Loss: 4.917 Test Acc: 0.533
Validation loss decreased (-0.516649 --> -0.533284).  Saving model ...
Epoch: 9 cost time: 2.5367884635925293
Epoch: 9, Steps: 13 | Train Loss: 2.256 Vali Loss: 4.347 Vali Acc: 0.461 Test Loss: 4.347 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5146982669830322
Epoch: 10, Steps: 13 | Train Loss: 0.881 Vali Loss: 3.035 Vali Acc: 0.489 Test Loss: 3.035 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5586864948272705
Epoch: 11, Steps: 13 | Train Loss: 1.184 Vali Loss: 3.593 Vali Acc: 0.522 Test Loss: 3.593 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.768578052520752
Epoch: 12, Steps: 13 | Train Loss: 1.593 Vali Loss: 6.334 Vali Acc: 0.478 Test Loss: 6.334 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7623209953308105
Epoch: 13, Steps: 13 | Train Loss: 2.071 Vali Loss: 5.737 Vali Acc: 0.494 Test Loss: 5.737 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.8138203620910645
Epoch: 14, Steps: 13 | Train Loss: 0.858 Vali Loss: 7.859 Vali Acc: 0.528 Test Loss: 7.859 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5954415798187256
Epoch: 15, Steps: 13 | Train Loss: 4.674 Vali Loss: 10.977 Vali Acc: 0.528 Test Loss: 10.977 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.657698392868042
Epoch: 16, Steps: 13 | Train Loss: 2.363 Vali Loss: 12.501 Vali Acc: 0.433 Test Loss: 12.501 Test Acc: 0.433
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5497376918792725
Epoch: 17, Steps: 13 | Train Loss: 1.815 Vali Loss: 11.956 Vali Acc: 0.450 Test Loss: 11.956 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.668947219848633
Epoch: 18, Steps: 13 | Train Loss: 2.367 Vali Loss: 12.932 Vali Acc: 0.461 Test Loss: 12.932 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 3825198
model size : 24.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8559582233428955
Epoch: 1, Steps: 13 | Train Loss: 1.094 Vali Loss: 1.827 Vali Acc: 0.500 Test Loss: 1.827 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
Epoch: 2 cost time: 2.230733633041382
Epoch: 2, Steps: 13 | Train Loss: 1.353 Vali Loss: 0.937 Vali Acc: 0.489 Test Loss: 0.937 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4424211978912354
Epoch: 3, Steps: 13 | Train Loss: 1.312 Vali Loss: 1.103 Vali Acc: 0.589 Test Loss: 1.103 Test Acc: 0.589
Validation loss decreased (-0.499982 --> -0.588878).  Saving model ...
Epoch: 4 cost time: 2.387437582015991
Epoch: 4, Steps: 13 | Train Loss: 1.424 Vali Loss: 1.174 Vali Acc: 0.528 Test Loss: 1.174 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.31530499458313
Epoch: 5, Steps: 13 | Train Loss: 0.933 Vali Loss: 1.518 Vali Acc: 0.467 Test Loss: 1.518 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.456744432449341
Epoch: 6, Steps: 13 | Train Loss: 1.427 Vali Loss: 1.501 Vali Acc: 0.567 Test Loss: 1.501 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2991421222686768
Epoch: 7, Steps: 13 | Train Loss: 1.172 Vali Loss: 2.018 Vali Acc: 0.511 Test Loss: 2.018 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.573012113571167
Epoch: 8, Steps: 13 | Train Loss: 1.468 Vali Loss: 2.742 Vali Acc: 0.517 Test Loss: 2.742 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4578065872192383
Epoch: 9, Steps: 13 | Train Loss: 1.807 Vali Loss: 2.363 Vali Acc: 0.494 Test Loss: 2.363 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4692389965057373
Epoch: 10, Steps: 13 | Train Loss: 1.293 Vali Loss: 3.053 Vali Acc: 0.550 Test Loss: 3.053 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5756609439849854
Epoch: 11, Steps: 13 | Train Loss: 1.815 Vali Loss: 5.221 Vali Acc: 0.467 Test Loss: 5.221 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.620637893676758
Epoch: 12, Steps: 13 | Train Loss: 3.224 Vali Loss: 6.173 Vali Acc: 0.533 Test Loss: 6.173 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5713279247283936
Epoch: 13, Steps: 13 | Train Loss: 2.137 Vali Loss: 6.445 Vali Acc: 0.522 Test Loss: 6.445 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 3825198
model size : 24.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.496276140213013
Epoch: 1, Steps: 13 | Train Loss: 0.905 Vali Loss: 1.201 Vali Acc: 0.511 Test Loss: 1.201 Test Acc: 0.511
Validation loss decreased (inf --> -0.511099).  Saving model ...
Epoch: 2 cost time: 3.0523757934570312
Epoch: 2, Steps: 13 | Train Loss: 0.829 Vali Loss: 1.765 Vali Acc: 0.511 Test Loss: 1.765 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.139458179473877
Epoch: 3, Steps: 13 | Train Loss: 1.090 Vali Loss: 1.842 Vali Acc: 0.483 Test Loss: 1.842 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.977067232131958
Epoch: 4, Steps: 13 | Train Loss: 1.390 Vali Loss: 2.159 Vali Acc: 0.478 Test Loss: 2.159 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.983410358428955
Epoch: 5, Steps: 13 | Train Loss: 1.802 Vali Loss: 2.224 Vali Acc: 0.544 Test Loss: 2.224 Test Acc: 0.544
Validation loss decreased (-0.511099 --> -0.544422).  Saving model ...
Epoch: 6 cost time: 2.771073818206787
Epoch: 6, Steps: 13 | Train Loss: 0.822 Vali Loss: 2.023 Vali Acc: 0.544 Test Loss: 2.023 Test Acc: 0.544
Validation loss decreased (-0.544422 --> -0.544424).  Saving model ...
Epoch: 7 cost time: 2.7535653114318848
Epoch: 7, Steps: 13 | Train Loss: 1.744 Vali Loss: 3.213 Vali Acc: 0.472 Test Loss: 3.213 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.005779981613159
Epoch: 8, Steps: 13 | Train Loss: 2.078 Vali Loss: 4.300 Vali Acc: 0.506 Test Loss: 4.300 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.96087646484375
Epoch: 9, Steps: 13 | Train Loss: 1.321 Vali Loss: 5.059 Vali Acc: 0.506 Test Loss: 5.059 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0619499683380127
Epoch: 10, Steps: 13 | Train Loss: 0.863 Vali Loss: 4.176 Vali Acc: 0.483 Test Loss: 4.176 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8113465309143066
Epoch: 11, Steps: 13 | Train Loss: 1.013 Vali Loss: 5.395 Vali Acc: 0.517 Test Loss: 5.395 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.933199882507324
Epoch: 12, Steps: 13 | Train Loss: 2.119 Vali Loss: 4.326 Vali Acc: 0.511 Test Loss: 4.326 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.838271141052246
Epoch: 13, Steps: 13 | Train Loss: 2.280 Vali Loss: 5.708 Vali Acc: 0.506 Test Loss: 5.708 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.912973642349243
Epoch: 14, Steps: 13 | Train Loss: 0.605 Vali Loss: 6.444 Vali Acc: 0.517 Test Loss: 6.444 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.926806688308716
Epoch: 15, Steps: 13 | Train Loss: 0.576 Vali Loss: 5.926 Vali Acc: 0.539 Test Loss: 5.926 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8835203647613525
Epoch: 16, Steps: 13 | Train Loss: 0.339 Vali Loss: 10.294 Vali Acc: 0.494 Test Loss: 10.294 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 2776622
model size : 20.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.190142393112183
Epoch: 1, Steps: 13 | Train Loss: 0.869 Vali Loss: 0.907 Vali Acc: 0.478 Test Loss: 0.907 Test Acc: 0.478
Validation loss decreased (inf --> -0.477769).  Saving model ...
Epoch: 2 cost time: 2.6152303218841553
Epoch: 2, Steps: 13 | Train Loss: 1.028 Vali Loss: 1.254 Vali Acc: 0.528 Test Loss: 1.254 Test Acc: 0.528
Validation loss decreased (-0.477769 --> -0.527765).  Saving model ...
Epoch: 3 cost time: 2.7642054557800293
Epoch: 3, Steps: 13 | Train Loss: 0.942 Vali Loss: 2.096 Vali Acc: 0.483 Test Loss: 2.096 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.810910940170288
Epoch: 4, Steps: 13 | Train Loss: 0.974 Vali Loss: 1.895 Vali Acc: 0.517 Test Loss: 1.895 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.694196939468384
Epoch: 5, Steps: 13 | Train Loss: 1.728 Vali Loss: 2.455 Vali Acc: 0.494 Test Loss: 2.455 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6671230792999268
Epoch: 6, Steps: 13 | Train Loss: 0.749 Vali Loss: 2.625 Vali Acc: 0.500 Test Loss: 2.625 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5645997524261475
Epoch: 7, Steps: 13 | Train Loss: 1.271 Vali Loss: 5.311 Vali Acc: 0.489 Test Loss: 5.311 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.560359239578247
Epoch: 8, Steps: 13 | Train Loss: 2.794 Vali Loss: 3.803 Vali Acc: 0.500 Test Loss: 3.803 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.653927803039551
Epoch: 9, Steps: 13 | Train Loss: 1.301 Vali Loss: 3.436 Vali Acc: 0.506 Test Loss: 3.436 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.757740020751953
Epoch: 10, Steps: 13 | Train Loss: 1.597 Vali Loss: 4.723 Vali Acc: 0.511 Test Loss: 4.723 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.862291097640991
Epoch: 11, Steps: 13 | Train Loss: 1.404 Vali Loss: 7.853 Vali Acc: 0.500 Test Loss: 7.853 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.542745590209961
Epoch: 12, Steps: 13 | Train Loss: 2.742 Vali Loss: 5.114 Vali Acc: 0.522 Test Loss: 5.114 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 2776622
model size : 20.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.229247093200684
Epoch: 1, Steps: 13 | Train Loss: 0.855 Vali Loss: 0.879 Vali Acc: 0.494 Test Loss: 0.879 Test Acc: 0.494
Validation loss decreased (inf --> -0.494436).  Saving model ...
Epoch: 2 cost time: 2.5493767261505127
Epoch: 2, Steps: 13 | Train Loss: 1.007 Vali Loss: 1.093 Vali Acc: 0.517 Test Loss: 1.093 Test Acc: 0.517
Validation loss decreased (-0.494436 --> -0.516656).  Saving model ...
Epoch: 3 cost time: 2.593716859817505
Epoch: 3, Steps: 13 | Train Loss: 0.896 Vali Loss: 1.636 Vali Acc: 0.533 Test Loss: 1.636 Test Acc: 0.533
Validation loss decreased (-0.516656 --> -0.533317).  Saving model ...
Epoch: 4 cost time: 2.415889024734497
Epoch: 4, Steps: 13 | Train Loss: 1.084 Vali Loss: 1.378 Vali Acc: 0.444 Test Loss: 1.378 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.50923228263855
Epoch: 5, Steps: 13 | Train Loss: 0.922 Vali Loss: 2.746 Vali Acc: 0.483 Test Loss: 2.746 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5939371585845947
Epoch: 6, Steps: 13 | Train Loss: 1.621 Vali Loss: 3.322 Vali Acc: 0.489 Test Loss: 3.322 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.475107192993164
Epoch: 7, Steps: 13 | Train Loss: 2.788 Vali Loss: 7.736 Vali Acc: 0.494 Test Loss: 7.736 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.545128583908081
Epoch: 8, Steps: 13 | Train Loss: 1.756 Vali Loss: 2.547 Vali Acc: 0.544 Test Loss: 2.547 Test Acc: 0.544
Validation loss decreased (-0.533317 --> -0.544419).  Saving model ...
Epoch: 9 cost time: 2.569654703140259
Epoch: 9, Steps: 13 | Train Loss: 0.920 Vali Loss: 5.159 Vali Acc: 0.511 Test Loss: 5.159 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.774897336959839
Epoch: 10, Steps: 13 | Train Loss: 1.666 Vali Loss: 3.374 Vali Acc: 0.478 Test Loss: 3.374 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6028590202331543
Epoch: 11, Steps: 13 | Train Loss: 0.731 Vali Loss: 3.229 Vali Acc: 0.467 Test Loss: 3.229 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5842607021331787
Epoch: 12, Steps: 13 | Train Loss: 0.601 Vali Loss: 7.424 Vali Acc: 0.522 Test Loss: 7.424 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6000497341156006
Epoch: 13, Steps: 13 | Train Loss: 1.112 Vali Loss: 4.489 Vali Acc: 0.450 Test Loss: 4.489 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5932116508483887
Epoch: 14, Steps: 13 | Train Loss: 1.253 Vali Loss: 7.606 Vali Acc: 0.450 Test Loss: 7.606 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.664689779281616
Epoch: 15, Steps: 13 | Train Loss: 2.635 Vali Loss: 7.525 Vali Acc: 0.456 Test Loss: 7.525 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.6272215843200684
Epoch: 16, Steps: 13 | Train Loss: 1.226 Vali Loss: 10.764 Vali Acc: 0.500 Test Loss: 10.764 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.651508092880249
Epoch: 17, Steps: 13 | Train Loss: 1.381 Vali Loss: 9.865 Vali Acc: 0.461 Test Loss: 9.865 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4740920066833496
Epoch: 18, Steps: 13 | Train Loss: 0.737 Vali Loss: 11.649 Vali Acc: 0.483 Test Loss: 11.649 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 2776622
model size : 20.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.930023193359375
Epoch: 1, Steps: 13 | Train Loss: 0.863 Vali Loss: 0.872 Vali Acc: 0.506 Test Loss: 0.872 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 2.37581729888916
Epoch: 2, Steps: 13 | Train Loss: 0.979 Vali Loss: 1.450 Vali Acc: 0.506 Test Loss: 1.450 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2609052658081055
Epoch: 3, Steps: 13 | Train Loss: 1.176 Vali Loss: 1.113 Vali Acc: 0.506 Test Loss: 1.113 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.137471914291382
Epoch: 4, Steps: 13 | Train Loss: 1.262 Vali Loss: 1.153 Vali Acc: 0.517 Test Loss: 1.153 Test Acc: 0.517
Validation loss decreased (-0.505547 --> -0.516655).  Saving model ...
Epoch: 5 cost time: 2.178738594055176
Epoch: 5, Steps: 13 | Train Loss: 1.196 Vali Loss: 3.038 Vali Acc: 0.494 Test Loss: 3.038 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.310603141784668
Epoch: 6, Steps: 13 | Train Loss: 1.580 Vali Loss: 3.119 Vali Acc: 0.461 Test Loss: 3.119 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2703535556793213
Epoch: 7, Steps: 13 | Train Loss: 4.640 Vali Loss: 10.967 Vali Acc: 0.500 Test Loss: 10.967 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3563058376312256
Epoch: 8, Steps: 13 | Train Loss: 5.232 Vali Loss: 2.957 Vali Acc: 0.544 Test Loss: 2.957 Test Acc: 0.544
Validation loss decreased (-0.516655 --> -0.544415).  Saving model ...
Epoch: 9 cost time: 2.4278225898742676
Epoch: 9, Steps: 13 | Train Loss: 2.128 Vali Loss: 4.814 Vali Acc: 0.511 Test Loss: 4.814 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.301102638244629
Epoch: 10, Steps: 13 | Train Loss: 1.356 Vali Loss: 4.047 Vali Acc: 0.506 Test Loss: 4.047 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2174041271209717
Epoch: 11, Steps: 13 | Train Loss: 2.237 Vali Loss: 6.390 Vali Acc: 0.494 Test Loss: 6.390 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.314095973968506
Epoch: 12, Steps: 13 | Train Loss: 1.126 Vali Loss: 4.294 Vali Acc: 0.511 Test Loss: 4.294 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1963350772857666
Epoch: 13, Steps: 13 | Train Loss: 1.937 Vali Loss: 5.717 Vali Acc: 0.500 Test Loss: 5.717 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.219764232635498
Epoch: 14, Steps: 13 | Train Loss: 1.369 Vali Loss: 5.540 Vali Acc: 0.483 Test Loss: 5.540 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.224172592163086
Epoch: 15, Steps: 13 | Train Loss: 2.062 Vali Loss: 5.762 Vali Acc: 0.489 Test Loss: 5.762 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.347215175628662
Epoch: 16, Steps: 13 | Train Loss: 0.952 Vali Loss: 5.647 Vali Acc: 0.522 Test Loss: 5.647 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3546688556671143
Epoch: 17, Steps: 13 | Train Loss: 0.738 Vali Loss: 7.618 Vali Acc: 0.506 Test Loss: 7.618 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.339306116104126
Epoch: 18, Steps: 13 | Train Loss: 0.973 Vali Loss: 7.334 Vali Acc: 0.417 Test Loss: 7.334 Test Acc: 0.417
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 2776622
model size : 20.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.196470737457275
Epoch: 1, Steps: 13 | Train Loss: 1.000 Vali Loss: 2.021 Vali Acc: 0.467 Test Loss: 2.021 Test Acc: 0.467
Validation loss decreased (inf --> -0.466646).  Saving model ...
Epoch: 2 cost time: 2.8563036918640137
Epoch: 2, Steps: 13 | Train Loss: 1.348 Vali Loss: 1.690 Vali Acc: 0.544 Test Loss: 1.690 Test Acc: 0.544
Validation loss decreased (-0.466646 --> -0.544428).  Saving model ...
Epoch: 3 cost time: 2.6368181705474854
Epoch: 3, Steps: 13 | Train Loss: 1.002 Vali Loss: 2.088 Vali Acc: 0.506 Test Loss: 2.088 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7716102600097656
Epoch: 4, Steps: 13 | Train Loss: 1.194 Vali Loss: 3.884 Vali Acc: 0.517 Test Loss: 3.884 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.029507875442505
Epoch: 5, Steps: 13 | Train Loss: 1.620 Vali Loss: 3.536 Vali Acc: 0.528 Test Loss: 3.536 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9272260665893555
Epoch: 6, Steps: 13 | Train Loss: 0.909 Vali Loss: 2.371 Vali Acc: 0.522 Test Loss: 2.371 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0183253288269043
Epoch: 7, Steps: 13 | Train Loss: 2.190 Vali Loss: 7.714 Vali Acc: 0.522 Test Loss: 7.714 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0356030464172363
Epoch: 8, Steps: 13 | Train Loss: 2.503 Vali Loss: 6.269 Vali Acc: 0.500 Test Loss: 6.269 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.902184247970581
Epoch: 9, Steps: 13 | Train Loss: 1.468 Vali Loss: 6.464 Vali Acc: 0.506 Test Loss: 6.464 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.834113597869873
Epoch: 10, Steps: 13 | Train Loss: 1.070 Vali Loss: 4.255 Vali Acc: 0.461 Test Loss: 4.255 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8416857719421387
Epoch: 11, Steps: 13 | Train Loss: 0.995 Vali Loss: 4.875 Vali Acc: 0.467 Test Loss: 4.875 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.0451040267944336
Epoch: 12, Steps: 13 | Train Loss: 0.752 Vali Loss: 7.488 Vali Acc: 0.539 Test Loss: 7.488 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 2252334
model size : 18.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.183387041091919
Epoch: 1, Steps: 13 | Train Loss: 1.000 Vali Loss: 2.067 Vali Acc: 0.450 Test Loss: 2.067 Test Acc: 0.450
Validation loss decreased (inf --> -0.449979).  Saving model ...
Epoch: 2 cost time: 2.662149429321289
Epoch: 2, Steps: 13 | Train Loss: 1.382 Vali Loss: 1.800 Vali Acc: 0.539 Test Loss: 1.800 Test Acc: 0.539
Validation loss decreased (-0.449979 --> -0.538871).  Saving model ...
Epoch: 3 cost time: 2.710723876953125
Epoch: 3, Steps: 13 | Train Loss: 1.017 Vali Loss: 1.534 Vali Acc: 0.522 Test Loss: 1.534 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.827336311340332
Epoch: 4, Steps: 13 | Train Loss: 0.812 Vali Loss: 2.688 Vali Acc: 0.478 Test Loss: 2.688 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.729243516921997
Epoch: 5, Steps: 13 | Train Loss: 1.145 Vali Loss: 3.486 Vali Acc: 0.506 Test Loss: 3.486 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7116189002990723
Epoch: 6, Steps: 13 | Train Loss: 1.304 Vali Loss: 3.685 Vali Acc: 0.500 Test Loss: 3.685 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.627394437789917
Epoch: 7, Steps: 13 | Train Loss: 0.876 Vali Loss: 3.218 Vali Acc: 0.517 Test Loss: 3.218 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.785731792449951
Epoch: 8, Steps: 13 | Train Loss: 0.914 Vali Loss: 3.420 Vali Acc: 0.528 Test Loss: 3.420 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6818408966064453
Epoch: 9, Steps: 13 | Train Loss: 1.496 Vali Loss: 5.357 Vali Acc: 0.522 Test Loss: 5.357 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.798945903778076
Epoch: 10, Steps: 13 | Train Loss: 1.159 Vali Loss: 4.748 Vali Acc: 0.483 Test Loss: 4.748 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.771263837814331
Epoch: 11, Steps: 13 | Train Loss: 1.159 Vali Loss: 4.339 Vali Acc: 0.489 Test Loss: 4.339 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7550928592681885
Epoch: 12, Steps: 13 | Train Loss: 2.981 Vali Loss: 5.507 Vali Acc: 0.494 Test Loss: 5.507 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 2252334
model size : 18.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.093288421630859
Epoch: 1, Steps: 13 | Train Loss: 0.979 Vali Loss: 2.073 Vali Acc: 0.494 Test Loss: 2.073 Test Acc: 0.494
Validation loss decreased (inf --> -0.494424).  Saving model ...
Epoch: 2 cost time: 2.474499464035034
Epoch: 2, Steps: 13 | Train Loss: 1.344 Vali Loss: 1.810 Vali Acc: 0.500 Test Loss: 1.810 Test Acc: 0.500
Validation loss decreased (-0.494424 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 2.453551769256592
Epoch: 3, Steps: 13 | Train Loss: 1.344 Vali Loss: 2.348 Vali Acc: 0.511 Test Loss: 2.348 Test Acc: 0.511
Validation loss decreased (-0.499982 --> -0.511088).  Saving model ...
Epoch: 4 cost time: 2.375673294067383
Epoch: 4, Steps: 13 | Train Loss: 1.601 Vali Loss: 3.301 Vali Acc: 0.533 Test Loss: 3.301 Test Acc: 0.533
Validation loss decreased (-0.511088 --> -0.533300).  Saving model ...
Epoch: 5 cost time: 2.353266954421997
Epoch: 5, Steps: 13 | Train Loss: 1.033 Vali Loss: 1.651 Vali Acc: 0.472 Test Loss: 1.651 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4078025817871094
Epoch: 6, Steps: 13 | Train Loss: 0.909 Vali Loss: 2.257 Vali Acc: 0.472 Test Loss: 2.257 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.414092540740967
Epoch: 7, Steps: 13 | Train Loss: 1.986 Vali Loss: 7.652 Vali Acc: 0.494 Test Loss: 7.652 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.525886297225952
Epoch: 8, Steps: 13 | Train Loss: 1.756 Vali Loss: 4.210 Vali Acc: 0.494 Test Loss: 4.210 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4887521266937256
Epoch: 9, Steps: 13 | Train Loss: 1.184 Vali Loss: 3.383 Vali Acc: 0.450 Test Loss: 3.383 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4939208030700684
Epoch: 10, Steps: 13 | Train Loss: 1.624 Vali Loss: 6.655 Vali Acc: 0.539 Test Loss: 6.655 Test Acc: 0.539
Validation loss decreased (-0.533300 --> -0.538822).  Saving model ...
Epoch: 11 cost time: 2.506291627883911
Epoch: 11, Steps: 13 | Train Loss: 2.363 Vali Loss: 3.637 Vali Acc: 0.467 Test Loss: 3.637 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4571430683135986
Epoch: 12, Steps: 13 | Train Loss: 3.834 Vali Loss: 8.263 Vali Acc: 0.478 Test Loss: 8.263 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3577826023101807
Epoch: 13, Steps: 13 | Train Loss: 1.511 Vali Loss: 6.881 Vali Acc: 0.522 Test Loss: 6.881 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4141223430633545
Epoch: 14, Steps: 13 | Train Loss: 0.907 Vali Loss: 9.950 Vali Acc: 0.450 Test Loss: 9.950 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4399826526641846
Epoch: 15, Steps: 13 | Train Loss: 1.437 Vali Loss: 7.189 Vali Acc: 0.450 Test Loss: 7.189 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4970483779907227
Epoch: 16, Steps: 13 | Train Loss: 3.402 Vali Loss: 12.183 Vali Acc: 0.500 Test Loss: 12.183 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.409925937652588
Epoch: 17, Steps: 13 | Train Loss: 3.190 Vali Loss: 11.568 Vali Acc: 0.478 Test Loss: 11.568 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2538797855377197
Epoch: 18, Steps: 13 | Train Loss: 1.281 Vali Loss: 10.397 Vali Acc: 0.483 Test Loss: 10.397 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3777456283569336
Epoch: 19, Steps: 13 | Train Loss: 0.448 Vali Loss: 10.931 Vali Acc: 0.489 Test Loss: 10.931 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4759674072265625
Epoch: 20, Steps: 13 | Train Loss: 0.163 Vali Loss: 10.348 Vali Acc: 0.428 Test Loss: 10.348 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 2252334
model size : 18.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.893559217453003
Epoch: 1, Steps: 13 | Train Loss: 0.950 Vali Loss: 1.787 Vali Acc: 0.511 Test Loss: 1.787 Test Acc: 0.511
Validation loss decreased (inf --> -0.511093).  Saving model ...
Epoch: 2 cost time: 2.241668224334717
Epoch: 2, Steps: 13 | Train Loss: 1.268 Vali Loss: 1.577 Vali Acc: 0.517 Test Loss: 1.577 Test Acc: 0.517
Validation loss decreased (-0.511093 --> -0.516651).  Saving model ...
Epoch: 3 cost time: 2.2567310333251953
Epoch: 3, Steps: 13 | Train Loss: 1.634 Vali Loss: 1.478 Vali Acc: 0.539 Test Loss: 1.478 Test Acc: 0.539
Validation loss decreased (-0.516651 --> -0.538874).  Saving model ...
Epoch: 4 cost time: 2.242361545562744
Epoch: 4, Steps: 13 | Train Loss: 1.484 Vali Loss: 1.944 Vali Acc: 0.500 Test Loss: 1.944 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.199751377105713
Epoch: 5, Steps: 13 | Train Loss: 1.093 Vali Loss: 2.808 Vali Acc: 0.528 Test Loss: 2.808 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.13059401512146
Epoch: 6, Steps: 13 | Train Loss: 1.209 Vali Loss: 2.058 Vali Acc: 0.489 Test Loss: 2.058 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3257791996002197
Epoch: 7, Steps: 13 | Train Loss: 1.396 Vali Loss: 2.560 Vali Acc: 0.511 Test Loss: 2.560 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2731847763061523
Epoch: 8, Steps: 13 | Train Loss: 2.281 Vali Loss: 4.030 Vali Acc: 0.506 Test Loss: 4.030 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3702499866485596
Epoch: 9, Steps: 13 | Train Loss: 3.569 Vali Loss: 2.783 Vali Acc: 0.500 Test Loss: 2.783 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.329543113708496
Epoch: 10, Steps: 13 | Train Loss: 0.995 Vali Loss: 6.353 Vali Acc: 0.483 Test Loss: 6.353 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.30220103263855
Epoch: 11, Steps: 13 | Train Loss: 2.429 Vali Loss: 6.320 Vali Acc: 0.522 Test Loss: 6.320 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.306833028793335
Epoch: 12, Steps: 13 | Train Loss: 2.298 Vali Loss: 5.107 Vali Acc: 0.511 Test Loss: 5.107 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2781989574432373
Epoch: 13, Steps: 13 | Train Loss: 1.097 Vali Loss: 10.930 Vali Acc: 0.483 Test Loss: 10.930 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 2252334
model size : 18.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.449780464172363
Epoch: 1, Steps: 13 | Train Loss: 0.888 Vali Loss: 1.549 Vali Acc: 0.500 Test Loss: 1.549 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 2.6978414058685303
Epoch: 2, Steps: 13 | Train Loss: 1.335 Vali Loss: 1.552 Vali Acc: 0.483 Test Loss: 1.552 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8054330348968506
Epoch: 3, Steps: 13 | Train Loss: 1.041 Vali Loss: 2.255 Vali Acc: 0.544 Test Loss: 2.255 Test Acc: 0.544
Validation loss decreased (-0.499985 --> -0.544422).  Saving model ...
Epoch: 4 cost time: 2.853003740310669
Epoch: 4, Steps: 13 | Train Loss: 1.322 Vali Loss: 1.930 Vali Acc: 0.483 Test Loss: 1.930 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9294002056121826
Epoch: 5, Steps: 13 | Train Loss: 1.813 Vali Loss: 2.831 Vali Acc: 0.528 Test Loss: 2.831 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8423709869384766
Epoch: 6, Steps: 13 | Train Loss: 0.731 Vali Loss: 3.334 Vali Acc: 0.533 Test Loss: 3.334 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.818211078643799
Epoch: 7, Steps: 13 | Train Loss: 1.197 Vali Loss: 3.525 Vali Acc: 0.533 Test Loss: 3.525 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8010358810424805
Epoch: 8, Steps: 13 | Train Loss: 2.765 Vali Loss: 4.135 Vali Acc: 0.506 Test Loss: 4.135 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7168350219726562
Epoch: 9, Steps: 13 | Train Loss: 1.342 Vali Loss: 6.372 Vali Acc: 0.517 Test Loss: 6.372 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7751753330230713
Epoch: 10, Steps: 13 | Train Loss: 1.500 Vali Loss: 6.065 Vali Acc: 0.522 Test Loss: 6.065 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.609071969985962
Epoch: 11, Steps: 13 | Train Loss: 2.492 Vali Loss: 6.412 Vali Acc: 0.489 Test Loss: 6.412 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.87996244430542
Epoch: 12, Steps: 13 | Train Loss: 1.360 Vali Loss: 7.268 Vali Acc: 0.522 Test Loss: 7.268 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8006303310394287
Epoch: 13, Steps: 13 | Train Loss: 1.477 Vali Loss: 6.283 Vali Acc: 0.506 Test Loss: 6.283 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 1990190
model size : 17.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.010198593139648
Epoch: 1, Steps: 13 | Train Loss: 0.892 Vali Loss: 1.498 Vali Acc: 0.522 Test Loss: 1.498 Test Acc: 0.522
Validation loss decreased (inf --> -0.522207).  Saving model ...
Epoch: 2 cost time: 2.6204538345336914
Epoch: 2, Steps: 13 | Train Loss: 1.337 Vali Loss: 1.699 Vali Acc: 0.500 Test Loss: 1.699 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.75784969329834
Epoch: 3, Steps: 13 | Train Loss: 1.351 Vali Loss: 1.864 Vali Acc: 0.506 Test Loss: 1.864 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.615971326828003
Epoch: 4, Steps: 13 | Train Loss: 1.382 Vali Loss: 1.802 Vali Acc: 0.483 Test Loss: 1.802 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5175235271453857
Epoch: 5, Steps: 13 | Train Loss: 1.095 Vali Loss: 2.834 Vali Acc: 0.500 Test Loss: 2.834 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.586751699447632
Epoch: 6, Steps: 13 | Train Loss: 1.626 Vali Loss: 4.107 Vali Acc: 0.550 Test Loss: 4.107 Test Acc: 0.550
Validation loss decreased (-0.522207 --> -0.549959).  Saving model ...
Epoch: 7 cost time: 2.6489322185516357
Epoch: 7, Steps: 13 | Train Loss: 1.007 Vali Loss: 3.581 Vali Acc: 0.489 Test Loss: 3.581 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.739833354949951
Epoch: 8, Steps: 13 | Train Loss: 2.658 Vali Loss: 3.904 Vali Acc: 0.456 Test Loss: 3.904 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.555223226547241
Epoch: 9, Steps: 13 | Train Loss: 1.633 Vali Loss: 3.802 Vali Acc: 0.522 Test Loss: 3.802 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7007863521575928
Epoch: 10, Steps: 13 | Train Loss: 0.811 Vali Loss: 4.986 Vali Acc: 0.511 Test Loss: 4.986 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6145708560943604
Epoch: 11, Steps: 13 | Train Loss: 1.140 Vali Loss: 3.736 Vali Acc: 0.489 Test Loss: 3.736 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.587618350982666
Epoch: 12, Steps: 13 | Train Loss: 0.736 Vali Loss: 5.912 Vali Acc: 0.489 Test Loss: 5.912 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7493667602539062
Epoch: 13, Steps: 13 | Train Loss: 0.770 Vali Loss: 5.169 Vali Acc: 0.528 Test Loss: 5.169 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7777979373931885
Epoch: 14, Steps: 13 | Train Loss: 0.832 Vali Loss: 10.213 Vali Acc: 0.511 Test Loss: 10.213 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8566203117370605
Epoch: 15, Steps: 13 | Train Loss: 1.637 Vali Loss: 8.383 Vali Acc: 0.483 Test Loss: 8.383 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7926695346832275
Epoch: 16, Steps: 13 | Train Loss: 1.247 Vali Loss: 7.024 Vali Acc: 0.511 Test Loss: 7.024 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1990190
model size : 17.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.035838603973389
Epoch: 1, Steps: 13 | Train Loss: 0.900 Vali Loss: 1.543 Vali Acc: 0.500 Test Loss: 1.543 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 2.379603624343872
Epoch: 2, Steps: 13 | Train Loss: 1.230 Vali Loss: 1.545 Vali Acc: 0.511 Test Loss: 1.545 Test Acc: 0.511
Validation loss decreased (-0.499985 --> -0.511096).  Saving model ...
Epoch: 3 cost time: 2.5082664489746094
Epoch: 3, Steps: 13 | Train Loss: 1.617 Vali Loss: 2.834 Vali Acc: 0.506 Test Loss: 2.834 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2608728408813477
Epoch: 4, Steps: 13 | Train Loss: 1.429 Vali Loss: 2.551 Vali Acc: 0.506 Test Loss: 2.551 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.362542152404785
Epoch: 5, Steps: 13 | Train Loss: 1.499 Vali Loss: 5.721 Vali Acc: 0.528 Test Loss: 5.721 Test Acc: 0.528
Validation loss decreased (-0.511096 --> -0.527721).  Saving model ...
Epoch: 6 cost time: 2.184595823287964
Epoch: 6, Steps: 13 | Train Loss: 3.780 Vali Loss: 1.820 Vali Acc: 0.472 Test Loss: 1.820 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4324684143066406
Epoch: 7, Steps: 13 | Train Loss: 1.513 Vali Loss: 4.609 Vali Acc: 0.522 Test Loss: 4.609 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.475985050201416
Epoch: 8, Steps: 13 | Train Loss: 1.676 Vali Loss: 3.238 Vali Acc: 0.472 Test Loss: 3.238 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4276316165924072
Epoch: 9, Steps: 13 | Train Loss: 2.262 Vali Loss: 8.346 Vali Acc: 0.500 Test Loss: 8.346 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3801522254943848
Epoch: 10, Steps: 13 | Train Loss: 2.768 Vali Loss: 9.060 Vali Acc: 0.522 Test Loss: 9.060 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4325244426727295
Epoch: 11, Steps: 13 | Train Loss: 3.928 Vali Loss: 5.880 Vali Acc: 0.494 Test Loss: 5.880 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3300063610076904
Epoch: 12, Steps: 13 | Train Loss: 1.559 Vali Loss: 5.724 Vali Acc: 0.528 Test Loss: 5.724 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.347778081893921
Epoch: 13, Steps: 13 | Train Loss: 0.965 Vali Loss: 5.888 Vali Acc: 0.444 Test Loss: 5.888 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4840869903564453
Epoch: 14, Steps: 13 | Train Loss: 1.185 Vali Loss: 8.684 Vali Acc: 0.522 Test Loss: 8.684 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.378180980682373
Epoch: 15, Steps: 13 | Train Loss: 0.784 Vali Loss: 8.467 Vali Acc: 0.478 Test Loss: 8.467 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 1990190
model size : 17.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7618415355682373
Epoch: 1, Steps: 13 | Train Loss: 0.839 Vali Loss: 0.870 Vali Acc: 0.489 Test Loss: 0.870 Test Acc: 0.489
Validation loss decreased (inf --> -0.488880).  Saving model ...
Epoch: 2 cost time: 2.138474464416504
Epoch: 2, Steps: 13 | Train Loss: 0.977 Vali Loss: 0.890 Vali Acc: 0.511 Test Loss: 0.890 Test Acc: 0.511
Validation loss decreased (-0.488880 --> -0.511102).  Saving model ...
Epoch: 3 cost time: 2.25740909576416
Epoch: 3, Steps: 13 | Train Loss: 2.172 Vali Loss: 2.218 Vali Acc: 0.500 Test Loss: 2.218 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2267119884490967
Epoch: 4, Steps: 13 | Train Loss: 1.267 Vali Loss: 2.893 Vali Acc: 0.494 Test Loss: 2.893 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1988258361816406
Epoch: 5, Steps: 13 | Train Loss: 1.741 Vali Loss: 2.982 Vali Acc: 0.572 Test Loss: 2.982 Test Acc: 0.572
Validation loss decreased (-0.511102 --> -0.572192).  Saving model ...
Epoch: 6 cost time: 2.1750054359436035
Epoch: 6, Steps: 13 | Train Loss: 2.230 Vali Loss: 4.809 Vali Acc: 0.533 Test Loss: 4.809 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.18451189994812
Epoch: 7, Steps: 13 | Train Loss: 1.906 Vali Loss: 3.695 Vali Acc: 0.539 Test Loss: 3.695 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.225501298904419
Epoch: 8, Steps: 13 | Train Loss: 1.125 Vali Loss: 3.058 Vali Acc: 0.544 Test Loss: 3.058 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1254324913024902
Epoch: 9, Steps: 13 | Train Loss: 1.020 Vali Loss: 2.892 Vali Acc: 0.494 Test Loss: 2.892 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.269789218902588
Epoch: 10, Steps: 13 | Train Loss: 1.061 Vali Loss: 3.261 Vali Acc: 0.444 Test Loss: 3.261 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3139162063598633
Epoch: 11, Steps: 13 | Train Loss: 1.375 Vali Loss: 6.258 Vali Acc: 0.517 Test Loss: 6.258 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3472254276275635
Epoch: 12, Steps: 13 | Train Loss: 0.738 Vali Loss: 3.417 Vali Acc: 0.500 Test Loss: 3.417 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.294820785522461
Epoch: 13, Steps: 13 | Train Loss: 1.967 Vali Loss: 6.927 Vali Acc: 0.472 Test Loss: 6.927 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1966989040374756
Epoch: 14, Steps: 13 | Train Loss: 1.587 Vali Loss: 6.688 Vali Acc: 0.483 Test Loss: 6.688 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.157949686050415
Epoch: 15, Steps: 13 | Train Loss: 1.167 Vali Loss: 6.603 Vali Acc: 0.461 Test Loss: 6.603 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 1990190
model size : 17.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.278554677963257
Epoch: 1, Steps: 13 | Train Loss: 0.870 Vali Loss: 1.665 Vali Acc: 0.483 Test Loss: 1.665 Test Acc: 0.483
Validation loss decreased (inf --> -0.483317).  Saving model ...
Epoch: 2 cost time: 2.7773139476776123
Epoch: 2, Steps: 13 | Train Loss: 1.786 Vali Loss: 2.810 Vali Acc: 0.528 Test Loss: 2.810 Test Acc: 0.528
Validation loss decreased (-0.483317 --> -0.527750).  Saving model ...
Epoch: 3 cost time: 2.6612799167633057
Epoch: 3, Steps: 13 | Train Loss: 1.790 Vali Loss: 3.230 Vali Acc: 0.511 Test Loss: 3.230 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.778740406036377
Epoch: 4, Steps: 13 | Train Loss: 1.565 Vali Loss: 3.056 Vali Acc: 0.561 Test Loss: 3.056 Test Acc: 0.561
Validation loss decreased (-0.527750 --> -0.561081).  Saving model ...
Epoch: 5 cost time: 2.7818784713745117
Epoch: 5, Steps: 13 | Train Loss: 1.209 Vali Loss: 2.144 Vali Acc: 0.522 Test Loss: 2.144 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8711228370666504
Epoch: 6, Steps: 13 | Train Loss: 1.110 Vali Loss: 2.911 Vali Acc: 0.544 Test Loss: 2.911 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9121921062469482
Epoch: 7, Steps: 13 | Train Loss: 0.784 Vali Loss: 3.304 Vali Acc: 0.461 Test Loss: 3.304 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8676154613494873
Epoch: 8, Steps: 13 | Train Loss: 1.755 Vali Loss: 7.143 Vali Acc: 0.494 Test Loss: 7.143 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8377039432525635
Epoch: 9, Steps: 13 | Train Loss: 4.311 Vali Loss: 6.597 Vali Acc: 0.478 Test Loss: 6.597 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.802464723587036
Epoch: 10, Steps: 13 | Train Loss: 2.919 Vali Loss: 4.920 Vali Acc: 0.528 Test Loss: 4.920 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8587915897369385
Epoch: 11, Steps: 13 | Train Loss: 0.684 Vali Loss: 7.361 Vali Acc: 0.528 Test Loss: 7.361 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8643085956573486
Epoch: 12, Steps: 13 | Train Loss: 1.512 Vali Loss: 6.807 Vali Acc: 0.472 Test Loss: 6.807 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.948289632797241
Epoch: 13, Steps: 13 | Train Loss: 1.805 Vali Loss: 6.772 Vali Acc: 0.467 Test Loss: 6.772 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8319754600524902
Epoch: 14, Steps: 13 | Train Loss: 0.824 Vali Loss: 6.881 Vali Acc: 0.511 Test Loss: 6.881 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 1859118
model size : 16.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.219550848007202
Epoch: 1, Steps: 13 | Train Loss: 0.869 Vali Loss: 1.309 Vali Acc: 0.478 Test Loss: 1.309 Test Acc: 0.478
Validation loss decreased (inf --> -0.477765).  Saving model ...
Epoch: 2 cost time: 2.603506088256836
Epoch: 2, Steps: 13 | Train Loss: 1.292 Vali Loss: 1.679 Vali Acc: 0.472 Test Loss: 1.679 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6469902992248535
Epoch: 3, Steps: 13 | Train Loss: 0.987 Vali Loss: 2.043 Vali Acc: 0.494 Test Loss: 2.043 Test Acc: 0.494
Validation loss decreased (-0.477765 --> -0.494424).  Saving model ...
Epoch: 4 cost time: 2.6435742378234863
Epoch: 4, Steps: 13 | Train Loss: 1.157 Vali Loss: 3.001 Vali Acc: 0.517 Test Loss: 3.001 Test Acc: 0.517
Validation loss decreased (-0.494424 --> -0.516637).  Saving model ...
Epoch: 5 cost time: 2.4530155658721924
Epoch: 5, Steps: 13 | Train Loss: 1.258 Vali Loss: 3.277 Vali Acc: 0.506 Test Loss: 3.277 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.538006544113159
Epoch: 6, Steps: 13 | Train Loss: 3.378 Vali Loss: 6.614 Vali Acc: 0.494 Test Loss: 6.614 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5878636837005615
Epoch: 7, Steps: 13 | Train Loss: 1.972 Vali Loss: 3.918 Vali Acc: 0.472 Test Loss: 3.918 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6714296340942383
Epoch: 8, Steps: 13 | Train Loss: 1.056 Vali Loss: 4.046 Vali Acc: 0.444 Test Loss: 4.046 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.632891893386841
Epoch: 9, Steps: 13 | Train Loss: 1.094 Vali Loss: 3.467 Vali Acc: 0.506 Test Loss: 3.467 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6140434741973877
Epoch: 10, Steps: 13 | Train Loss: 1.924 Vali Loss: 4.566 Vali Acc: 0.533 Test Loss: 4.566 Test Acc: 0.533
Validation loss decreased (-0.516637 --> -0.533288).  Saving model ...
Epoch: 11 cost time: 2.590104103088379
Epoch: 11, Steps: 13 | Train Loss: 1.391 Vali Loss: 5.814 Vali Acc: 0.517 Test Loss: 5.814 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5203046798706055
Epoch: 12, Steps: 13 | Train Loss: 0.855 Vali Loss: 4.047 Vali Acc: 0.467 Test Loss: 4.047 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6328351497650146
Epoch: 13, Steps: 13 | Train Loss: 0.386 Vali Loss: 5.953 Vali Acc: 0.478 Test Loss: 5.953 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.600372314453125
Epoch: 14, Steps: 13 | Train Loss: 1.318 Vali Loss: 5.246 Vali Acc: 0.483 Test Loss: 5.246 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5811057090759277
Epoch: 15, Steps: 13 | Train Loss: 2.017 Vali Loss: 17.319 Vali Acc: 0.517 Test Loss: 17.319 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.595414638519287
Epoch: 16, Steps: 13 | Train Loss: 3.157 Vali Loss: 7.397 Vali Acc: 0.489 Test Loss: 7.397 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.554338216781616
Epoch: 17, Steps: 13 | Train Loss: 0.946 Vali Loss: 7.560 Vali Acc: 0.467 Test Loss: 7.560 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5990450382232666
Epoch: 18, Steps: 13 | Train Loss: 0.333 Vali Loss: 8.124 Vali Acc: 0.406 Test Loss: 8.124 Test Acc: 0.406
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4673268795013428
Epoch: 19, Steps: 13 | Train Loss: 1.457 Vali Loss: 11.510 Vali Acc: 0.539 Test Loss: 11.510 Test Acc: 0.539
Validation loss decreased (-0.533288 --> -0.538774).  Saving model ...
Epoch: 20 cost time: 2.5051004886627197
Epoch: 20, Steps: 13 | Train Loss: 0.766 Vali Loss: 12.802 Vali Acc: 0.461 Test Loss: 12.802 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4519548416137695
Epoch: 21, Steps: 13 | Train Loss: 0.876 Vali Loss: 10.437 Vali Acc: 0.517 Test Loss: 10.437 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5556373596191406
Epoch: 22, Steps: 13 | Train Loss: 0.580 Vali Loss: 10.918 Vali Acc: 0.472 Test Loss: 10.918 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.498478889465332
Epoch: 23, Steps: 13 | Train Loss: 0.962 Vali Loss: 12.759 Vali Acc: 0.494 Test Loss: 12.759 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.678454637527466
Epoch: 24, Steps: 13 | Train Loss: 0.289 Vali Loss: 12.390 Vali Acc: 0.483 Test Loss: 12.390 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.702784776687622
Epoch: 25, Steps: 13 | Train Loss: 0.569 Vali Loss: 15.657 Vali Acc: 0.489 Test Loss: 15.657 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.476469039916992
Epoch: 26, Steps: 13 | Train Loss: 0.109 Vali Loss: 18.933 Vali Acc: 0.472 Test Loss: 18.933 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.462240695953369
Epoch: 27, Steps: 13 | Train Loss: 0.510 Vali Loss: 16.939 Vali Acc: 0.472 Test Loss: 16.939 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.4999241828918457
Epoch: 28, Steps: 13 | Train Loss: 0.582 Vali Loss: 15.258 Vali Acc: 0.483 Test Loss: 15.258 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.409651041030884
Epoch: 29, Steps: 13 | Train Loss: 0.405 Vali Loss: 20.002 Vali Acc: 0.472 Test Loss: 20.002 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 1859118
model size : 16.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.738994598388672
Epoch: 1, Steps: 13 | Train Loss: 0.880 Vali Loss: 1.585 Vali Acc: 0.500 Test Loss: 1.585 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 2.281919002532959
Epoch: 2, Steps: 13 | Train Loss: 1.304 Vali Loss: 1.860 Vali Acc: 0.472 Test Loss: 1.860 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3775413036346436
Epoch: 3, Steps: 13 | Train Loss: 1.438 Vali Loss: 2.284 Vali Acc: 0.489 Test Loss: 2.284 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4518210887908936
Epoch: 4, Steps: 13 | Train Loss: 1.966 Vali Loss: 4.108 Vali Acc: 0.511 Test Loss: 4.108 Test Acc: 0.511
Validation loss decreased (-0.499984 --> -0.511070).  Saving model ...
Epoch: 5 cost time: 2.522582769393921
Epoch: 5, Steps: 13 | Train Loss: 4.641 Vali Loss: 5.025 Vali Acc: 0.500 Test Loss: 5.025 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.483872890472412
Epoch: 6, Steps: 13 | Train Loss: 2.188 Vali Loss: 3.930 Vali Acc: 0.467 Test Loss: 3.930 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5040574073791504
Epoch: 7, Steps: 13 | Train Loss: 2.190 Vali Loss: 3.032 Vali Acc: 0.494 Test Loss: 3.032 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5114142894744873
Epoch: 8, Steps: 13 | Train Loss: 1.015 Vali Loss: 2.310 Vali Acc: 0.489 Test Loss: 2.310 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4990787506103516
Epoch: 9, Steps: 13 | Train Loss: 1.210 Vali Loss: 2.702 Vali Acc: 0.522 Test Loss: 2.702 Test Acc: 0.522
Validation loss decreased (-0.511070 --> -0.522195).  Saving model ...
Epoch: 10 cost time: 2.4668097496032715
Epoch: 10, Steps: 13 | Train Loss: 1.388 Vali Loss: 4.081 Vali Acc: 0.450 Test Loss: 4.081 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.494091510772705
Epoch: 11, Steps: 13 | Train Loss: 1.761 Vali Loss: 6.946 Vali Acc: 0.533 Test Loss: 6.946 Test Acc: 0.533
Validation loss decreased (-0.522195 --> -0.533264).  Saving model ...
Epoch: 12 cost time: 2.514035701751709
Epoch: 12, Steps: 13 | Train Loss: 2.060 Vali Loss: 4.752 Vali Acc: 0.461 Test Loss: 4.752 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4672183990478516
Epoch: 13, Steps: 13 | Train Loss: 1.418 Vali Loss: 4.894 Vali Acc: 0.500 Test Loss: 4.894 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5015130043029785
Epoch: 14, Steps: 13 | Train Loss: 0.912 Vali Loss: 8.326 Vali Acc: 0.461 Test Loss: 8.326 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.352202892303467
Epoch: 15, Steps: 13 | Train Loss: 1.242 Vali Loss: 6.593 Vali Acc: 0.528 Test Loss: 6.593 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.436171531677246
Epoch: 16, Steps: 13 | Train Loss: 3.897 Vali Loss: 14.334 Vali Acc: 0.533 Test Loss: 14.334 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3879425525665283
Epoch: 17, Steps: 13 | Train Loss: 3.842 Vali Loss: 8.567 Vali Acc: 0.433 Test Loss: 8.567 Test Acc: 0.433
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3764889240264893
Epoch: 18, Steps: 13 | Train Loss: 0.689 Vali Loss: 10.785 Vali Acc: 0.461 Test Loss: 10.785 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2354886531829834
Epoch: 19, Steps: 13 | Train Loss: 0.396 Vali Loss: 11.737 Vali Acc: 0.483 Test Loss: 11.737 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3438494205474854
Epoch: 20, Steps: 13 | Train Loss: 0.949 Vali Loss: 11.629 Vali Acc: 0.489 Test Loss: 11.629 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.309831380844116
Epoch: 21, Steps: 13 | Train Loss: 0.302 Vali Loss: 13.308 Vali Acc: 0.456 Test Loss: 13.308 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1859118
model size : 16.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8520193099975586
Epoch: 1, Steps: 13 | Train Loss: 0.892 Vali Loss: 1.982 Vali Acc: 0.500 Test Loss: 1.982 Test Acc: 0.500
Validation loss decreased (inf --> -0.499980).  Saving model ...
Epoch: 2 cost time: 2.1615583896636963
Epoch: 2, Steps: 13 | Train Loss: 1.440 Vali Loss: 1.621 Vali Acc: 0.533 Test Loss: 1.621 Test Acc: 0.533
Validation loss decreased (-0.499980 --> -0.533317).  Saving model ...
Epoch: 3 cost time: 2.263788938522339
Epoch: 3, Steps: 13 | Train Loss: 1.682 Vali Loss: 1.881 Vali Acc: 0.506 Test Loss: 1.881 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.132636070251465
Epoch: 4, Steps: 13 | Train Loss: 2.874 Vali Loss: 4.435 Vali Acc: 0.522 Test Loss: 4.435 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0818605422973633
Epoch: 5, Steps: 13 | Train Loss: 3.776 Vali Loss: 2.957 Vali Acc: 0.472 Test Loss: 2.957 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.012739658355713
Epoch: 6, Steps: 13 | Train Loss: 3.011 Vali Loss: 4.127 Vali Acc: 0.522 Test Loss: 4.127 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0054399967193604
Epoch: 7, Steps: 13 | Train Loss: 1.488 Vali Loss: 5.027 Vali Acc: 0.500 Test Loss: 5.027 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.119009256362915
Epoch: 8, Steps: 13 | Train Loss: 1.707 Vali Loss: 3.228 Vali Acc: 0.517 Test Loss: 3.228 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2999212741851807
Epoch: 9, Steps: 13 | Train Loss: 1.094 Vali Loss: 2.895 Vali Acc: 0.456 Test Loss: 2.895 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.237499952316284
Epoch: 10, Steps: 13 | Train Loss: 1.797 Vali Loss: 5.583 Vali Acc: 0.506 Test Loss: 5.583 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.107729911804199
Epoch: 11, Steps: 13 | Train Loss: 2.523 Vali Loss: 4.125 Vali Acc: 0.478 Test Loss: 4.125 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0959391593933105
Epoch: 12, Steps: 13 | Train Loss: 1.963 Vali Loss: 4.617 Vali Acc: 0.478 Test Loss: 4.617 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1859118
model size : 16.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.198334455490112
Epoch: 1, Steps: 13 | Train Loss: 1.013 Vali Loss: 1.552 Vali Acc: 0.544 Test Loss: 1.552 Test Acc: 0.544
Validation loss decreased (inf --> -0.544429).  Saving model ...
Epoch: 2 cost time: 2.6720879077911377
Epoch: 2, Steps: 13 | Train Loss: 1.446 Vali Loss: 2.198 Vali Acc: 0.567 Test Loss: 2.198 Test Acc: 0.567
Validation loss decreased (-0.544429 --> -0.566645).  Saving model ...
Epoch: 3 cost time: 2.6863698959350586
Epoch: 3, Steps: 13 | Train Loss: 1.481 Vali Loss: 3.286 Vali Acc: 0.522 Test Loss: 3.286 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7900826930999756
Epoch: 4, Steps: 13 | Train Loss: 1.172 Vali Loss: 2.259 Vali Acc: 0.494 Test Loss: 2.259 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7649152278900146
Epoch: 5, Steps: 13 | Train Loss: 1.070 Vali Loss: 2.166 Vali Acc: 0.506 Test Loss: 2.166 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6486270427703857
Epoch: 6, Steps: 13 | Train Loss: 2.167 Vali Loss: 4.242 Vali Acc: 0.533 Test Loss: 4.242 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9501123428344727
Epoch: 7, Steps: 13 | Train Loss: 1.010 Vali Loss: 6.082 Vali Acc: 0.522 Test Loss: 6.082 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9527690410614014
Epoch: 8, Steps: 13 | Train Loss: 1.960 Vali Loss: 3.957 Vali Acc: 0.494 Test Loss: 3.957 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8415846824645996
Epoch: 9, Steps: 13 | Train Loss: 1.920 Vali Loss: 7.926 Vali Acc: 0.522 Test Loss: 7.926 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7643232345581055
Epoch: 10, Steps: 13 | Train Loss: 2.856 Vali Loss: 6.441 Vali Acc: 0.506 Test Loss: 6.441 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8428192138671875
Epoch: 11, Steps: 13 | Train Loss: 4.168 Vali Loss: 7.214 Vali Acc: 0.506 Test Loss: 7.214 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.787508964538574
Epoch: 12, Steps: 13 | Train Loss: 1.064 Vali Loss: 6.034 Vali Acc: 0.494 Test Loss: 6.034 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 1793582
model size : 16.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.1948792934417725
Epoch: 1, Steps: 13 | Train Loss: 1.023 Vali Loss: 1.595 Vali Acc: 0.544 Test Loss: 1.595 Test Acc: 0.544
Validation loss decreased (inf --> -0.544428).  Saving model ...
Epoch: 2 cost time: 2.5082743167877197
Epoch: 2, Steps: 13 | Train Loss: 1.508 Vali Loss: 2.091 Vali Acc: 0.561 Test Loss: 2.091 Test Acc: 0.561
Validation loss decreased (-0.544428 --> -0.561090).  Saving model ...
Epoch: 3 cost time: 2.4922823905944824
Epoch: 3, Steps: 13 | Train Loss: 1.495 Vali Loss: 2.934 Vali Acc: 0.539 Test Loss: 2.934 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5246803760528564
Epoch: 4, Steps: 13 | Train Loss: 1.279 Vali Loss: 1.831 Vali Acc: 0.561 Test Loss: 1.831 Test Acc: 0.561
Validation loss decreased (-0.561090 --> -0.561093).  Saving model ...
Epoch: 5 cost time: 2.7322041988372803
Epoch: 5, Steps: 13 | Train Loss: 1.333 Vali Loss: 3.014 Vali Acc: 0.489 Test Loss: 3.014 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7328879833221436
Epoch: 6, Steps: 13 | Train Loss: 2.899 Vali Loss: 2.826 Vali Acc: 0.517 Test Loss: 2.826 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5668675899505615
Epoch: 7, Steps: 13 | Train Loss: 1.325 Vali Loss: 2.771 Vali Acc: 0.517 Test Loss: 2.771 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.609107494354248
Epoch: 8, Steps: 13 | Train Loss: 2.745 Vali Loss: 7.148 Vali Acc: 0.506 Test Loss: 7.148 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5407447814941406
Epoch: 9, Steps: 13 | Train Loss: 1.658 Vali Loss: 4.339 Vali Acc: 0.506 Test Loss: 4.339 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4949488639831543
Epoch: 10, Steps: 13 | Train Loss: 0.862 Vali Loss: 4.379 Vali Acc: 0.483 Test Loss: 4.379 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.606048822402954
Epoch: 11, Steps: 13 | Train Loss: 0.688 Vali Loss: 4.867 Vali Acc: 0.511 Test Loss: 4.867 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.689227342605591
Epoch: 12, Steps: 13 | Train Loss: 0.908 Vali Loss: 4.108 Vali Acc: 0.506 Test Loss: 4.108 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5642006397247314
Epoch: 13, Steps: 13 | Train Loss: 1.968 Vali Loss: 6.611 Vali Acc: 0.494 Test Loss: 6.611 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.488196611404419
Epoch: 14, Steps: 13 | Train Loss: 0.817 Vali Loss: 8.807 Vali Acc: 0.511 Test Loss: 8.807 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 1793582
model size : 16.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.053982973098755
Epoch: 1, Steps: 13 | Train Loss: 1.017 Vali Loss: 1.569 Vali Acc: 0.544 Test Loss: 1.569 Test Acc: 0.544
Validation loss decreased (inf --> -0.544429).  Saving model ...
Epoch: 2 cost time: 2.4125237464904785
Epoch: 2, Steps: 13 | Train Loss: 1.479 Vali Loss: 1.685 Vali Acc: 0.544 Test Loss: 1.685 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.379364252090454
Epoch: 3, Steps: 13 | Train Loss: 1.139 Vali Loss: 1.294 Vali Acc: 0.550 Test Loss: 1.294 Test Acc: 0.550
Validation loss decreased (-0.544429 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 2.3003571033477783
Epoch: 4, Steps: 13 | Train Loss: 1.183 Vali Loss: 1.531 Vali Acc: 0.494 Test Loss: 1.531 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.244447708129883
Epoch: 5, Steps: 13 | Train Loss: 1.424 Vali Loss: 2.745 Vali Acc: 0.506 Test Loss: 2.745 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3167004585266113
Epoch: 6, Steps: 13 | Train Loss: 1.945 Vali Loss: 4.566 Vali Acc: 0.506 Test Loss: 4.566 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.403557777404785
Epoch: 7, Steps: 13 | Train Loss: 1.879 Vali Loss: 3.387 Vali Acc: 0.500 Test Loss: 3.387 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.347830295562744
Epoch: 8, Steps: 13 | Train Loss: 0.850 Vali Loss: 3.742 Vali Acc: 0.517 Test Loss: 3.742 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3642823696136475
Epoch: 9, Steps: 13 | Train Loss: 1.070 Vali Loss: 6.022 Vali Acc: 0.500 Test Loss: 6.022 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.44862961769104
Epoch: 10, Steps: 13 | Train Loss: 1.920 Vali Loss: 4.254 Vali Acc: 0.522 Test Loss: 4.254 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.386606454849243
Epoch: 11, Steps: 13 | Train Loss: 0.612 Vali Loss: 5.037 Vali Acc: 0.528 Test Loss: 5.037 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3860580921173096
Epoch: 12, Steps: 13 | Train Loss: 1.419 Vali Loss: 4.849 Vali Acc: 0.478 Test Loss: 4.849 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3512415885925293
Epoch: 13, Steps: 13 | Train Loss: 0.863 Vali Loss: 4.110 Vali Acc: 0.444 Test Loss: 4.110 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1793582
model size : 16.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.676429033279419
Epoch: 1, Steps: 13 | Train Loss: 0.973 Vali Loss: 1.463 Vali Acc: 0.533 Test Loss: 1.463 Test Acc: 0.533
Validation loss decreased (inf --> -0.533319).  Saving model ...
Epoch: 2 cost time: 2.031881809234619
Epoch: 2, Steps: 13 | Train Loss: 1.382 Vali Loss: 1.251 Vali Acc: 0.483 Test Loss: 1.251 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9968719482421875
Epoch: 3, Steps: 13 | Train Loss: 1.304 Vali Loss: 2.792 Vali Acc: 0.506 Test Loss: 2.792 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.96744704246521
Epoch: 4, Steps: 13 | Train Loss: 1.680 Vali Loss: 2.752 Vali Acc: 0.494 Test Loss: 2.752 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1279823780059814
Epoch: 5, Steps: 13 | Train Loss: 0.875 Vali Loss: 1.186 Vali Acc: 0.506 Test Loss: 1.186 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2446322441101074
Epoch: 6, Steps: 13 | Train Loss: 1.567 Vali Loss: 3.390 Vali Acc: 0.517 Test Loss: 3.390 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1725525856018066
Epoch: 7, Steps: 13 | Train Loss: 1.300 Vali Loss: 2.087 Vali Acc: 0.511 Test Loss: 2.087 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0634727478027344
Epoch: 8, Steps: 13 | Train Loss: 1.431 Vali Loss: 1.788 Vali Acc: 0.517 Test Loss: 1.788 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1059446334838867
Epoch: 9, Steps: 13 | Train Loss: 1.204 Vali Loss: 7.204 Vali Acc: 0.511 Test Loss: 7.204 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.132892608642578
Epoch: 10, Steps: 13 | Train Loss: 2.694 Vali Loss: 7.172 Vali Acc: 0.478 Test Loss: 7.172 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1716089248657227
Epoch: 11, Steps: 13 | Train Loss: 1.936 Vali Loss: 7.373 Vali Acc: 0.494 Test Loss: 7.373 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1793582
model size : 16.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4709596633911133
Epoch: 1, Steps: 13 | Train Loss: 0.835 Vali Loss: 0.826 Vali Acc: 0.544 Test Loss: 0.826 Test Acc: 0.544
Validation loss decreased (inf --> -0.544436).  Saving model ...
Epoch: 2 cost time: 1.7529137134552002
Epoch: 2, Steps: 13 | Train Loss: 1.021 Vali Loss: 0.984 Vali Acc: 0.494 Test Loss: 0.984 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7567641735076904
Epoch: 3, Steps: 13 | Train Loss: 0.734 Vali Loss: 1.534 Vali Acc: 0.494 Test Loss: 1.534 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7760305404663086
Epoch: 4, Steps: 13 | Train Loss: 0.709 Vali Loss: 1.235 Vali Acc: 0.489 Test Loss: 1.235 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.815040111541748
Epoch: 5, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.508 Vali Acc: 0.517 Test Loss: 1.508 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.836249828338623
Epoch: 6, Steps: 13 | Train Loss: 0.528 Vali Loss: 1.383 Vali Acc: 0.511 Test Loss: 1.383 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0334060192108154
Epoch: 7, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.656 Vali Acc: 0.539 Test Loss: 1.656 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.807382583618164
Epoch: 8, Steps: 13 | Train Loss: 0.754 Vali Loss: 3.943 Vali Acc: 0.494 Test Loss: 3.943 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9062705039978027
Epoch: 9, Steps: 13 | Train Loss: 0.921 Vali Loss: 3.742 Vali Acc: 0.528 Test Loss: 3.742 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9043312072753906
Epoch: 10, Steps: 13 | Train Loss: 0.632 Vali Loss: 2.511 Vali Acc: 0.511 Test Loss: 2.511 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.976952314376831
Epoch: 11, Steps: 13 | Train Loss: 0.587 Vali Loss: 2.490 Vali Acc: 0.506 Test Loss: 2.490 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 1781550
model size : 11.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3811919689178467
Epoch: 1, Steps: 13 | Train Loss: 0.823 Vali Loss: 0.813 Vali Acc: 0.539 Test Loss: 0.813 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 1.7723259925842285
Epoch: 2, Steps: 13 | Train Loss: 1.013 Vali Loss: 0.942 Vali Acc: 0.478 Test Loss: 0.942 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7768890857696533
Epoch: 3, Steps: 13 | Train Loss: 0.714 Vali Loss: 1.493 Vali Acc: 0.489 Test Loss: 1.493 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7473030090332031
Epoch: 4, Steps: 13 | Train Loss: 0.698 Vali Loss: 1.133 Vali Acc: 0.450 Test Loss: 1.133 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.744476556777954
Epoch: 5, Steps: 13 | Train Loss: 0.712 Vali Loss: 1.754 Vali Acc: 0.522 Test Loss: 1.754 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9154040813446045
Epoch: 6, Steps: 13 | Train Loss: 0.610 Vali Loss: 1.701 Vali Acc: 0.528 Test Loss: 1.701 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8358662128448486
Epoch: 7, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.742 Vali Acc: 0.483 Test Loss: 1.742 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.796339750289917
Epoch: 8, Steps: 13 | Train Loss: 0.749 Vali Loss: 3.712 Vali Acc: 0.483 Test Loss: 3.712 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.731288194656372
Epoch: 9, Steps: 13 | Train Loss: 0.872 Vali Loss: 2.459 Vali Acc: 0.544 Test Loss: 2.459 Test Acc: 0.544
Validation loss decreased (-0.538881 --> -0.544420).  Saving model ...
Epoch: 10 cost time: 1.707890510559082
Epoch: 10, Steps: 13 | Train Loss: 2.013 Vali Loss: 3.455 Vali Acc: 0.489 Test Loss: 3.455 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6640682220458984
Epoch: 11, Steps: 13 | Train Loss: 0.953 Vali Loss: 4.604 Vali Acc: 0.511 Test Loss: 4.604 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.728074073791504
Epoch: 12, Steps: 13 | Train Loss: 1.588 Vali Loss: 2.712 Vali Acc: 0.494 Test Loss: 2.712 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7548954486846924
Epoch: 13, Steps: 13 | Train Loss: 0.408 Vali Loss: 2.693 Vali Acc: 0.517 Test Loss: 2.693 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7693276405334473
Epoch: 14, Steps: 13 | Train Loss: 0.361 Vali Loss: 2.768 Vali Acc: 0.550 Test Loss: 2.768 Test Acc: 0.550
Validation loss decreased (-0.544420 --> -0.549972).  Saving model ...
Epoch: 15 cost time: 1.66363525390625
Epoch: 15, Steps: 13 | Train Loss: 0.533 Vali Loss: 5.079 Vali Acc: 0.467 Test Loss: 5.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.807539939880371
Epoch: 16, Steps: 13 | Train Loss: 0.986 Vali Loss: 3.144 Vali Acc: 0.528 Test Loss: 3.144 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.716273546218872
Epoch: 17, Steps: 13 | Train Loss: 0.160 Vali Loss: 4.610 Vali Acc: 0.478 Test Loss: 4.610 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.70756196975708
Epoch: 18, Steps: 13 | Train Loss: 0.444 Vali Loss: 5.504 Vali Acc: 0.511 Test Loss: 5.504 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.655735969543457
Epoch: 19, Steps: 13 | Train Loss: 0.409 Vali Loss: 4.262 Vali Acc: 0.472 Test Loss: 4.262 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6956274509429932
Epoch: 20, Steps: 13 | Train Loss: 0.557 Vali Loss: 4.647 Vali Acc: 0.483 Test Loss: 4.647 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6505818367004395
Epoch: 21, Steps: 13 | Train Loss: 0.771 Vali Loss: 4.671 Vali Acc: 0.506 Test Loss: 4.671 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.721705675125122
Epoch: 22, Steps: 13 | Train Loss: 1.048 Vali Loss: 5.800 Vali Acc: 0.533 Test Loss: 5.800 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8175334930419922
Epoch: 23, Steps: 13 | Train Loss: 0.412 Vali Loss: 6.691 Vali Acc: 0.489 Test Loss: 6.691 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8677215576171875
Epoch: 24, Steps: 13 | Train Loss: 0.234 Vali Loss: 6.789 Vali Acc: 0.528 Test Loss: 6.789 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1781550
model size : 11.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2517716884613037
Epoch: 1, Steps: 13 | Train Loss: 0.811 Vali Loss: 0.809 Vali Acc: 0.517 Test Loss: 0.809 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 1.5789713859558105
Epoch: 2, Steps: 13 | Train Loss: 0.971 Vali Loss: 0.903 Vali Acc: 0.450 Test Loss: 0.903 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6768019199371338
Epoch: 3, Steps: 13 | Train Loss: 0.930 Vali Loss: 1.417 Vali Acc: 0.472 Test Loss: 1.417 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6808621883392334
Epoch: 4, Steps: 13 | Train Loss: 1.125 Vali Loss: 1.177 Vali Acc: 0.483 Test Loss: 1.177 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7091469764709473
Epoch: 5, Steps: 13 | Train Loss: 1.386 Vali Loss: 2.379 Vali Acc: 0.467 Test Loss: 2.379 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5864648818969727
Epoch: 6, Steps: 13 | Train Loss: 1.205 Vali Loss: 1.431 Vali Acc: 0.456 Test Loss: 1.431 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6016666889190674
Epoch: 7, Steps: 13 | Train Loss: 0.562 Vali Loss: 1.558 Vali Acc: 0.494 Test Loss: 1.558 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6290497779846191
Epoch: 8, Steps: 13 | Train Loss: 1.381 Vali Loss: 2.182 Vali Acc: 0.483 Test Loss: 2.182 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6171600818634033
Epoch: 9, Steps: 13 | Train Loss: 1.336 Vali Loss: 2.884 Vali Acc: 0.472 Test Loss: 2.884 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6328015327453613
Epoch: 10, Steps: 13 | Train Loss: 0.848 Vali Loss: 2.299 Vali Acc: 0.478 Test Loss: 2.299 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6615066528320312
Epoch: 11, Steps: 13 | Train Loss: 0.608 Vali Loss: 2.476 Vali Acc: 0.533 Test Loss: 2.476 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533309).  Saving model ...
Epoch: 12 cost time: 1.6337597370147705
Epoch: 12, Steps: 13 | Train Loss: 0.642 Vali Loss: 2.442 Vali Acc: 0.483 Test Loss: 2.442 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6436011791229248
Epoch: 13, Steps: 13 | Train Loss: 0.660 Vali Loss: 2.538 Vali Acc: 0.483 Test Loss: 2.538 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6162240505218506
Epoch: 14, Steps: 13 | Train Loss: 0.452 Vali Loss: 3.693 Vali Acc: 0.511 Test Loss: 3.693 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6398138999938965
Epoch: 15, Steps: 13 | Train Loss: 0.687 Vali Loss: 5.095 Vali Acc: 0.483 Test Loss: 5.095 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6455345153808594
Epoch: 16, Steps: 13 | Train Loss: 0.684 Vali Loss: 3.398 Vali Acc: 0.517 Test Loss: 3.398 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.623485803604126
Epoch: 17, Steps: 13 | Train Loss: 0.206 Vali Loss: 2.927 Vali Acc: 0.478 Test Loss: 2.927 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.638002872467041
Epoch: 18, Steps: 13 | Train Loss: 0.458 Vali Loss: 4.366 Vali Acc: 0.511 Test Loss: 4.366 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6190853118896484
Epoch: 19, Steps: 13 | Train Loss: 0.544 Vali Loss: 4.037 Vali Acc: 0.550 Test Loss: 4.037 Test Acc: 0.550
Validation loss decreased (-0.533309 --> -0.549960).  Saving model ...
Epoch: 20 cost time: 1.6947884559631348
Epoch: 20, Steps: 13 | Train Loss: 0.199 Vali Loss: 3.684 Vali Acc: 0.544 Test Loss: 3.684 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6859581470489502
Epoch: 21, Steps: 13 | Train Loss: 0.357 Vali Loss: 3.487 Vali Acc: 0.467 Test Loss: 3.487 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.613112211227417
Epoch: 22, Steps: 13 | Train Loss: 0.075 Vali Loss: 3.240 Vali Acc: 0.483 Test Loss: 3.240 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5770208835601807
Epoch: 23, Steps: 13 | Train Loss: 0.083 Vali Loss: 4.202 Vali Acc: 0.556 Test Loss: 4.202 Test Acc: 0.556
Validation loss decreased (-0.549960 --> -0.555514).  Saving model ...
Epoch: 24 cost time: 1.5603868961334229
Epoch: 24, Steps: 13 | Train Loss: 0.692 Vali Loss: 6.355 Vali Acc: 0.467 Test Loss: 6.355 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.613433837890625
Epoch: 25, Steps: 13 | Train Loss: 0.434 Vali Loss: 7.282 Vali Acc: 0.500 Test Loss: 7.282 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6631598472595215
Epoch: 26, Steps: 13 | Train Loss: 0.427 Vali Loss: 6.125 Vali Acc: 0.467 Test Loss: 6.125 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.649707555770874
Epoch: 27, Steps: 13 | Train Loss: 0.171 Vali Loss: 6.156 Vali Acc: 0.506 Test Loss: 6.156 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4188501834869385
Epoch: 28, Steps: 13 | Train Loss: 0.274 Vali Loss: 7.163 Vali Acc: 0.472 Test Loss: 7.163 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6292507648468018
Epoch: 29, Steps: 13 | Train Loss: 0.263 Vali Loss: 5.882 Vali Acc: 0.511 Test Loss: 5.882 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6189091205596924
Epoch: 30, Steps: 13 | Train Loss: 0.100 Vali Loss: 8.176 Vali Acc: 0.472 Test Loss: 8.176 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5568900108337402
Epoch: 31, Steps: 13 | Train Loss: 0.603 Vali Loss: 8.773 Vali Acc: 0.483 Test Loss: 8.773 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.522585153579712
Epoch: 32, Steps: 13 | Train Loss: 1.027 Vali Loss: 11.925 Vali Acc: 0.456 Test Loss: 11.925 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4501724243164062
Epoch: 33, Steps: 13 | Train Loss: 0.217 Vali Loss: 7.705 Vali Acc: 0.511 Test Loss: 7.705 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 1781550
model size : 11.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0103073120117188
Epoch: 1, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.868 Vali Acc: 0.517 Test Loss: 0.868 Test Acc: 0.517
Validation loss decreased (inf --> -0.516658).  Saving model ...
Epoch: 2 cost time: 1.5520379543304443
Epoch: 2, Steps: 13 | Train Loss: 1.221 Vali Loss: 1.221 Vali Acc: 0.494 Test Loss: 1.221 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5147409439086914
Epoch: 3, Steps: 13 | Train Loss: 1.499 Vali Loss: 2.787 Vali Acc: 0.500 Test Loss: 2.787 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4614357948303223
Epoch: 4, Steps: 13 | Train Loss: 1.988 Vali Loss: 0.826 Vali Acc: 0.489 Test Loss: 0.826 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5548138618469238
Epoch: 5, Steps: 13 | Train Loss: 0.841 Vali Loss: 1.335 Vali Acc: 0.517 Test Loss: 1.335 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5538768768310547
Epoch: 6, Steps: 13 | Train Loss: 0.936 Vali Loss: 1.826 Vali Acc: 0.483 Test Loss: 1.826 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.59920334815979
Epoch: 7, Steps: 13 | Train Loss: 1.023 Vali Loss: 2.178 Vali Acc: 0.478 Test Loss: 2.178 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5611515045166016
Epoch: 8, Steps: 13 | Train Loss: 1.450 Vali Loss: 1.179 Vali Acc: 0.533 Test Loss: 1.179 Test Acc: 0.533
Validation loss decreased (-0.516658 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 1.5647311210632324
Epoch: 9, Steps: 13 | Train Loss: 0.912 Vali Loss: 1.878 Vali Acc: 0.533 Test Loss: 1.878 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5435965061187744
Epoch: 10, Steps: 13 | Train Loss: 0.956 Vali Loss: 2.258 Vali Acc: 0.544 Test Loss: 2.258 Test Acc: 0.544
Validation loss decreased (-0.533322 --> -0.544422).  Saving model ...
Epoch: 11 cost time: 1.5226786136627197
Epoch: 11, Steps: 13 | Train Loss: 1.149 Vali Loss: 2.580 Vali Acc: 0.450 Test Loss: 2.580 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5089447498321533
Epoch: 12, Steps: 13 | Train Loss: 0.946 Vali Loss: 2.012 Vali Acc: 0.494 Test Loss: 2.012 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5211594104766846
Epoch: 13, Steps: 13 | Train Loss: 1.114 Vali Loss: 1.865 Vali Acc: 0.522 Test Loss: 1.865 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.510047197341919
Epoch: 14, Steps: 13 | Train Loss: 1.853 Vali Loss: 3.379 Vali Acc: 0.489 Test Loss: 3.379 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4666213989257812
Epoch: 15, Steps: 13 | Train Loss: 0.715 Vali Loss: 3.201 Vali Acc: 0.506 Test Loss: 3.201 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5449373722076416
Epoch: 16, Steps: 13 | Train Loss: 0.668 Vali Loss: 2.776 Vali Acc: 0.500 Test Loss: 2.776 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6368513107299805
Epoch: 17, Steps: 13 | Train Loss: 0.418 Vali Loss: 3.437 Vali Acc: 0.517 Test Loss: 3.437 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5518739223480225
Epoch: 18, Steps: 13 | Train Loss: 0.316 Vali Loss: 2.980 Vali Acc: 0.511 Test Loss: 2.980 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5501961708068848
Epoch: 19, Steps: 13 | Train Loss: 0.454 Vali Loss: 3.370 Vali Acc: 0.439 Test Loss: 3.370 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.501281499862671
Epoch: 20, Steps: 13 | Train Loss: 0.809 Vali Loss: 3.219 Vali Acc: 0.439 Test Loss: 3.219 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 1781550
model size : 11.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.252927541732788
Epoch: 1, Steps: 13 | Train Loss: 0.844 Vali Loss: 0.853 Vali Acc: 0.478 Test Loss: 0.853 Test Acc: 0.478
Validation loss decreased (inf --> -0.477769).  Saving model ...
Epoch: 2 cost time: 1.895395278930664
Epoch: 2, Steps: 13 | Train Loss: 0.758 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9195854663848877
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
Validation loss decreased (-0.477769 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 1.7427160739898682
Epoch: 4, Steps: 13 | Train Loss: 1.426 Vali Loss: 1.380 Vali Acc: 0.533 Test Loss: 1.380 Test Acc: 0.533
Validation loss decreased (-0.499989 --> -0.533320).  Saving model ...
Epoch: 5 cost time: 1.7996859550476074
Epoch: 5, Steps: 13 | Train Loss: 0.652 Vali Loss: 1.340 Vali Acc: 0.506 Test Loss: 1.340 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7994704246520996
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 4.497 Vali Acc: 0.500 Test Loss: 4.497 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8484723567962646
Epoch: 7, Steps: 13 | Train Loss: 1.833 Vali Loss: 2.543 Vali Acc: 0.528 Test Loss: 2.543 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.800377368927002
Epoch: 8, Steps: 13 | Train Loss: 0.981 Vali Loss: 2.651 Vali Acc: 0.500 Test Loss: 2.651 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8054683208465576
Epoch: 9, Steps: 13 | Train Loss: 0.795 Vali Loss: 3.689 Vali Acc: 0.472 Test Loss: 3.689 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8468806743621826
Epoch: 10, Steps: 13 | Train Loss: 1.300 Vali Loss: 2.921 Vali Acc: 0.522 Test Loss: 2.921 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8270809650421143
Epoch: 11, Steps: 13 | Train Loss: 0.744 Vali Loss: 5.780 Vali Acc: 0.494 Test Loss: 5.780 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7671616077423096
Epoch: 12, Steps: 13 | Train Loss: 1.164 Vali Loss: 3.340 Vali Acc: 0.494 Test Loss: 3.340 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8358173370361328
Epoch: 13, Steps: 13 | Train Loss: 0.799 Vali Loss: 4.019 Vali Acc: 0.444 Test Loss: 4.019 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8265209197998047
Epoch: 14, Steps: 13 | Train Loss: 0.517 Vali Loss: 3.724 Vali Acc: 0.528 Test Loss: 3.724 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1257262
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5386977195739746
Epoch: 1, Steps: 13 | Train Loss: 0.845 Vali Loss: 0.845 Vali Acc: 0.472 Test Loss: 0.845 Test Acc: 0.472
Validation loss decreased (inf --> -0.472214).  Saving model ...
Epoch: 2 cost time: 1.7520930767059326
Epoch: 2, Steps: 13 | Train Loss: 0.788 Vali Loss: 1.333 Vali Acc: 0.450 Test Loss: 1.333 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7460169792175293
Epoch: 3, Steps: 13 | Train Loss: 0.873 Vali Loss: 1.627 Vali Acc: 0.489 Test Loss: 1.627 Test Acc: 0.489
Validation loss decreased (-0.472214 --> -0.488873).  Saving model ...
Epoch: 4 cost time: 1.7093112468719482
Epoch: 4, Steps: 13 | Train Loss: 1.185 Vali Loss: 2.236 Vali Acc: 0.494 Test Loss: 2.236 Test Acc: 0.494
Validation loss decreased (-0.488873 --> -0.494422).  Saving model ...
Epoch: 5 cost time: 1.7370939254760742
Epoch: 5, Steps: 13 | Train Loss: 0.940 Vali Loss: 1.269 Vali Acc: 0.428 Test Loss: 1.269 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7515277862548828
Epoch: 6, Steps: 13 | Train Loss: 0.580 Vali Loss: 2.660 Vali Acc: 0.511 Test Loss: 2.660 Test Acc: 0.511
Validation loss decreased (-0.494422 --> -0.511085).  Saving model ...
Epoch: 7 cost time: 1.7512705326080322
Epoch: 7, Steps: 13 | Train Loss: 1.044 Vali Loss: 1.637 Vali Acc: 0.489 Test Loss: 1.637 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8014640808105469
Epoch: 8, Steps: 13 | Train Loss: 0.358 Vali Loss: 2.408 Vali Acc: 0.472 Test Loss: 2.408 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8139269351959229
Epoch: 9, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.728 Vali Acc: 0.500 Test Loss: 1.728 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.781280517578125
Epoch: 10, Steps: 13 | Train Loss: 0.675 Vali Loss: 2.505 Vali Acc: 0.528 Test Loss: 2.505 Test Acc: 0.528
Validation loss decreased (-0.511085 --> -0.527753).  Saving model ...
Epoch: 11 cost time: 1.7681939601898193
Epoch: 11, Steps: 13 | Train Loss: 2.106 Vali Loss: 3.213 Vali Acc: 0.511 Test Loss: 3.213 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8483057022094727
Epoch: 12, Steps: 13 | Train Loss: 0.597 Vali Loss: 2.969 Vali Acc: 0.489 Test Loss: 2.969 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.761498212814331
Epoch: 13, Steps: 13 | Train Loss: 0.823 Vali Loss: 3.044 Vali Acc: 0.456 Test Loss: 3.044 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7411630153656006
Epoch: 14, Steps: 13 | Train Loss: 0.316 Vali Loss: 2.703 Vali Acc: 0.472 Test Loss: 2.703 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.802675485610962
Epoch: 15, Steps: 13 | Train Loss: 0.326 Vali Loss: 4.132 Vali Acc: 0.506 Test Loss: 4.132 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6971385478973389
Epoch: 16, Steps: 13 | Train Loss: 0.441 Vali Loss: 4.132 Vali Acc: 0.472 Test Loss: 4.132 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.814992904663086
Epoch: 17, Steps: 13 | Train Loss: 0.546 Vali Loss: 3.436 Vali Acc: 0.450 Test Loss: 3.436 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8088526725769043
Epoch: 18, Steps: 13 | Train Loss: 0.242 Vali Loss: 4.091 Vali Acc: 0.483 Test Loss: 4.091 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7917134761810303
Epoch: 19, Steps: 13 | Train Loss: 0.124 Vali Loss: 3.753 Vali Acc: 0.489 Test Loss: 3.753 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7228612899780273
Epoch: 20, Steps: 13 | Train Loss: 0.166 Vali Loss: 4.845 Vali Acc: 0.450 Test Loss: 4.845 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 1257262
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2396204471588135
Epoch: 1, Steps: 13 | Train Loss: 0.852 Vali Loss: 0.841 Vali Acc: 0.478 Test Loss: 0.841 Test Acc: 0.478
Validation loss decreased (inf --> -0.477769).  Saving model ...
Epoch: 2 cost time: 1.6158514022827148
Epoch: 2, Steps: 13 | Train Loss: 0.839 Vali Loss: 1.341 Vali Acc: 0.489 Test Loss: 1.341 Test Acc: 0.489
Validation loss decreased (-0.477769 --> -0.488875).  Saving model ...
Epoch: 3 cost time: 1.5868725776672363
Epoch: 3, Steps: 13 | Train Loss: 1.207 Vali Loss: 1.500 Vali Acc: 0.478 Test Loss: 1.500 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6433405876159668
Epoch: 4, Steps: 13 | Train Loss: 1.312 Vali Loss: 1.371 Vali Acc: 0.500 Test Loss: 1.371 Test Acc: 0.500
Validation loss decreased (-0.488875 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 1.5783336162567139
Epoch: 5, Steps: 13 | Train Loss: 0.621 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5334374904632568
Epoch: 6, Steps: 13 | Train Loss: 0.445 Vali Loss: 1.816 Vali Acc: 0.478 Test Loss: 1.816 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.493044376373291
Epoch: 7, Steps: 13 | Train Loss: 0.775 Vali Loss: 1.438 Vali Acc: 0.461 Test Loss: 1.438 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.535346269607544
Epoch: 8, Steps: 13 | Train Loss: 0.590 Vali Loss: 3.184 Vali Acc: 0.511 Test Loss: 3.184 Test Acc: 0.511
Validation loss decreased (-0.499986 --> -0.511079).  Saving model ...
Epoch: 9 cost time: 1.5522656440734863
Epoch: 9, Steps: 13 | Train Loss: 1.454 Vali Loss: 2.011 Vali Acc: 0.517 Test Loss: 2.011 Test Acc: 0.517
Validation loss decreased (-0.511079 --> -0.516647).  Saving model ...
Epoch: 10 cost time: 1.5549428462982178
Epoch: 10, Steps: 13 | Train Loss: 0.617 Vali Loss: 1.849 Vali Acc: 0.472 Test Loss: 1.849 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.499314785003662
Epoch: 11, Steps: 13 | Train Loss: 0.530 Vali Loss: 2.310 Vali Acc: 0.500 Test Loss: 2.310 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5683634281158447
Epoch: 12, Steps: 13 | Train Loss: 1.131 Vali Loss: 1.811 Vali Acc: 0.472 Test Loss: 1.811 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.419395923614502
Epoch: 13, Steps: 13 | Train Loss: 2.276 Vali Loss: 3.253 Vali Acc: 0.500 Test Loss: 3.253 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5709047317504883
Epoch: 14, Steps: 13 | Train Loss: 0.825 Vali Loss: 2.983 Vali Acc: 0.494 Test Loss: 2.983 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.611144781112671
Epoch: 15, Steps: 13 | Train Loss: 0.544 Vali Loss: 3.273 Vali Acc: 0.472 Test Loss: 3.273 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6560299396514893
Epoch: 16, Steps: 13 | Train Loss: 1.188 Vali Loss: 5.245 Vali Acc: 0.511 Test Loss: 5.245 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6252243518829346
Epoch: 17, Steps: 13 | Train Loss: 1.213 Vali Loss: 6.951 Vali Acc: 0.489 Test Loss: 6.951 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.645845890045166
Epoch: 18, Steps: 13 | Train Loss: 0.641 Vali Loss: 3.268 Vali Acc: 0.478 Test Loss: 3.268 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7206628322601318
Epoch: 19, Steps: 13 | Train Loss: 0.299 Vali Loss: 4.472 Vali Acc: 0.528 Test Loss: 4.472 Test Acc: 0.528
Validation loss decreased (-0.516647 --> -0.527733).  Saving model ...
Epoch: 20 cost time: 1.6252961158752441
Epoch: 20, Steps: 13 | Train Loss: 0.400 Vali Loss: 4.474 Vali Acc: 0.461 Test Loss: 4.474 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.680692434310913
Epoch: 21, Steps: 13 | Train Loss: 0.517 Vali Loss: 7.668 Vali Acc: 0.533 Test Loss: 7.668 Test Acc: 0.533
Validation loss decreased (-0.527733 --> -0.533257).  Saving model ...
Epoch: 22 cost time: 1.6407489776611328
Epoch: 22, Steps: 13 | Train Loss: 0.600 Vali Loss: 6.303 Vali Acc: 0.472 Test Loss: 6.303 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7348840236663818
Epoch: 23, Steps: 13 | Train Loss: 0.512 Vali Loss: 4.591 Vali Acc: 0.467 Test Loss: 4.591 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6163382530212402
Epoch: 24, Steps: 13 | Train Loss: 0.180 Vali Loss: 4.773 Vali Acc: 0.439 Test Loss: 4.773 Test Acc: 0.439
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.639009714126587
Epoch: 25, Steps: 13 | Train Loss: 0.178 Vali Loss: 5.220 Vali Acc: 0.467 Test Loss: 5.220 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6223814487457275
Epoch: 26, Steps: 13 | Train Loss: 0.120 Vali Loss: 4.901 Vali Acc: 0.478 Test Loss: 4.901 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6814055442810059
Epoch: 27, Steps: 13 | Train Loss: 0.179 Vali Loss: 5.333 Vali Acc: 0.494 Test Loss: 5.333 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.716038465499878
Epoch: 28, Steps: 13 | Train Loss: 0.135 Vali Loss: 5.646 Vali Acc: 0.461 Test Loss: 5.646 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7024621963500977
Epoch: 29, Steps: 13 | Train Loss: 0.068 Vali Loss: 6.965 Vali Acc: 0.506 Test Loss: 6.965 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6020631790161133
Epoch: 30, Steps: 13 | Train Loss: 0.092 Vali Loss: 6.166 Vali Acc: 0.494 Test Loss: 6.166 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5965774059295654
Epoch: 31, Steps: 13 | Train Loss: 0.031 Vali Loss: 7.206 Vali Acc: 0.483 Test Loss: 7.206 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 1257262
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9597713947296143
Epoch: 1, Steps: 13 | Train Loss: 0.822 Vali Loss: 0.791 Vali Acc: 0.478 Test Loss: 0.791 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.4716100692749023
Epoch: 2, Steps: 13 | Train Loss: 0.837 Vali Loss: 0.877 Vali Acc: 0.522 Test Loss: 0.877 Test Acc: 0.522
Validation loss decreased (-0.477770 --> -0.522213).  Saving model ...
Epoch: 3 cost time: 1.5288763046264648
Epoch: 3, Steps: 13 | Train Loss: 0.815 Vali Loss: 1.225 Vali Acc: 0.550 Test Loss: 1.225 Test Acc: 0.550
Validation loss decreased (-0.522213 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 1.486189365386963
Epoch: 4, Steps: 13 | Train Loss: 2.162 Vali Loss: 1.527 Vali Acc: 0.522 Test Loss: 1.527 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4956138134002686
Epoch: 5, Steps: 13 | Train Loss: 1.072 Vali Loss: 1.190 Vali Acc: 0.539 Test Loss: 1.190 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.433380365371704
Epoch: 6, Steps: 13 | Train Loss: 0.947 Vali Loss: 2.673 Vali Acc: 0.539 Test Loss: 2.673 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5820822715759277
Epoch: 7, Steps: 13 | Train Loss: 1.294 Vali Loss: 1.257 Vali Acc: 0.511 Test Loss: 1.257 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4384725093841553
Epoch: 8, Steps: 13 | Train Loss: 1.188 Vali Loss: 3.031 Vali Acc: 0.483 Test Loss: 3.031 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5101025104522705
Epoch: 9, Steps: 13 | Train Loss: 1.135 Vali Loss: 1.733 Vali Acc: 0.517 Test Loss: 1.733 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.553920030593872
Epoch: 10, Steps: 13 | Train Loss: 0.967 Vali Loss: 2.562 Vali Acc: 0.511 Test Loss: 2.562 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.585458517074585
Epoch: 11, Steps: 13 | Train Loss: 0.803 Vali Loss: 1.745 Vali Acc: 0.533 Test Loss: 1.745 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5121197700500488
Epoch: 12, Steps: 13 | Train Loss: 0.779 Vali Loss: 3.173 Vali Acc: 0.517 Test Loss: 3.173 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.517754077911377
Epoch: 13, Steps: 13 | Train Loss: 0.943 Vali Loss: 2.126 Vali Acc: 0.494 Test Loss: 2.126 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 1257262
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5240681171417236
Epoch: 1, Steps: 13 | Train Loss: 0.874 Vali Loss: 0.967 Vali Acc: 0.489 Test Loss: 0.967 Test Acc: 0.489
Validation loss decreased (inf --> -0.488879).  Saving model ...
Epoch: 2 cost time: 1.912306785583496
Epoch: 2, Steps: 13 | Train Loss: 0.893 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
Validation loss decreased (-0.488879 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.820030927658081
Epoch: 3, Steps: 13 | Train Loss: 0.982 Vali Loss: 0.994 Vali Acc: 0.528 Test Loss: 0.994 Test Acc: 0.528
Validation loss decreased (-0.499988 --> -0.527768).  Saving model ...
Epoch: 4 cost time: 1.7777738571166992
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 1.833 Vali Acc: 0.500 Test Loss: 1.833 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0395758152008057
Epoch: 5, Steps: 13 | Train Loss: 0.834 Vali Loss: 1.876 Vali Acc: 0.533 Test Loss: 1.876 Test Acc: 0.533
Validation loss decreased (-0.527768 --> -0.533315).  Saving model ...
Epoch: 6 cost time: 1.9520955085754395
Epoch: 6, Steps: 13 | Train Loss: 0.719 Vali Loss: 2.560 Vali Acc: 0.511 Test Loss: 2.560 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9609649181365967
Epoch: 7, Steps: 13 | Train Loss: 1.844 Vali Loss: 3.976 Vali Acc: 0.533 Test Loss: 3.976 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9619369506835938
Epoch: 8, Steps: 13 | Train Loss: 0.950 Vali Loss: 2.280 Vali Acc: 0.467 Test Loss: 2.280 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.943493366241455
Epoch: 9, Steps: 13 | Train Loss: 0.680 Vali Loss: 2.244 Vali Acc: 0.450 Test Loss: 2.244 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5294790267944336
Epoch: 10, Steps: 13 | Train Loss: 0.871 Vali Loss: 2.617 Vali Acc: 0.500 Test Loss: 2.617 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5399250984191895
Epoch: 11, Steps: 13 | Train Loss: 0.388 Vali Loss: 2.566 Vali Acc: 0.517 Test Loss: 2.566 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4612836837768555
Epoch: 12, Steps: 13 | Train Loss: 0.225 Vali Loss: 2.603 Vali Acc: 0.500 Test Loss: 2.603 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5572259426116943
Epoch: 13, Steps: 13 | Train Loss: 0.305 Vali Loss: 3.134 Vali Acc: 0.522 Test Loss: 3.134 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6400139331817627
Epoch: 14, Steps: 13 | Train Loss: 0.565 Vali Loss: 4.598 Vali Acc: 0.494 Test Loss: 4.598 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8702657222747803
Epoch: 15, Steps: 13 | Train Loss: 1.057 Vali Loss: 3.952 Vali Acc: 0.533 Test Loss: 3.952 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 995118
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.304417610168457
Epoch: 1, Steps: 13 | Train Loss: 0.861 Vali Loss: 1.028 Vali Acc: 0.494 Test Loss: 1.028 Test Acc: 0.494
Validation loss decreased (inf --> -0.494434).  Saving model ...
Epoch: 2 cost time: 1.70021653175354
Epoch: 2, Steps: 13 | Train Loss: 1.022 Vali Loss: 0.911 Vali Acc: 0.517 Test Loss: 0.911 Test Acc: 0.517
Validation loss decreased (-0.494434 --> -0.516658).  Saving model ...
Epoch: 3 cost time: 1.685624599456787
Epoch: 3, Steps: 13 | Train Loss: 0.893 Vali Loss: 1.323 Vali Acc: 0.494 Test Loss: 1.323 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7376441955566406
Epoch: 4, Steps: 13 | Train Loss: 1.065 Vali Loss: 1.364 Vali Acc: 0.500 Test Loss: 1.364 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7150042057037354
Epoch: 5, Steps: 13 | Train Loss: 1.015 Vali Loss: 1.940 Vali Acc: 0.539 Test Loss: 1.940 Test Acc: 0.539
Validation loss decreased (-0.516658 --> -0.538869).  Saving model ...
Epoch: 6 cost time: 1.7415087223052979
Epoch: 6, Steps: 13 | Train Loss: 0.694 Vali Loss: 1.687 Vali Acc: 0.500 Test Loss: 1.687 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.672804594039917
Epoch: 7, Steps: 13 | Train Loss: 0.674 Vali Loss: 3.584 Vali Acc: 0.500 Test Loss: 3.584 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6906418800354004
Epoch: 8, Steps: 13 | Train Loss: 0.782 Vali Loss: 2.371 Vali Acc: 0.517 Test Loss: 2.371 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.596116304397583
Epoch: 9, Steps: 13 | Train Loss: 0.301 Vali Loss: 2.518 Vali Acc: 0.517 Test Loss: 2.518 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.651078462600708
Epoch: 10, Steps: 13 | Train Loss: 0.385 Vali Loss: 3.550 Vali Acc: 0.511 Test Loss: 3.550 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6562557220458984
Epoch: 11, Steps: 13 | Train Loss: 0.961 Vali Loss: 3.707 Vali Acc: 0.489 Test Loss: 3.707 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7667207717895508
Epoch: 12, Steps: 13 | Train Loss: 0.831 Vali Loss: 2.606 Vali Acc: 0.500 Test Loss: 2.606 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7587270736694336
Epoch: 13, Steps: 13 | Train Loss: 0.739 Vali Loss: 3.231 Vali Acc: 0.544 Test Loss: 3.231 Test Acc: 0.544
Validation loss decreased (-0.538869 --> -0.544412).  Saving model ...
Epoch: 14 cost time: 1.7777540683746338
Epoch: 14, Steps: 13 | Train Loss: 0.361 Vali Loss: 3.322 Vali Acc: 0.472 Test Loss: 3.322 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.692718744277954
Epoch: 15, Steps: 13 | Train Loss: 0.554 Vali Loss: 2.999 Vali Acc: 0.478 Test Loss: 2.999 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.672010898590088
Epoch: 16, Steps: 13 | Train Loss: 0.181 Vali Loss: 3.616 Vali Acc: 0.506 Test Loss: 3.616 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6363885402679443
Epoch: 17, Steps: 13 | Train Loss: 0.453 Vali Loss: 3.913 Vali Acc: 0.494 Test Loss: 3.913 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6284444332122803
Epoch: 18, Steps: 13 | Train Loss: 0.179 Vali Loss: 4.953 Vali Acc: 0.467 Test Loss: 4.953 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6488077640533447
Epoch: 19, Steps: 13 | Train Loss: 0.137 Vali Loss: 3.490 Vali Acc: 0.500 Test Loss: 3.490 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6349031925201416
Epoch: 20, Steps: 13 | Train Loss: 0.243 Vali Loss: 4.185 Vali Acc: 0.511 Test Loss: 4.185 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6979341506958008
Epoch: 21, Steps: 13 | Train Loss: 0.348 Vali Loss: 4.153 Vali Acc: 0.483 Test Loss: 4.153 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6678943634033203
Epoch: 22, Steps: 13 | Train Loss: 0.613 Vali Loss: 5.070 Vali Acc: 0.494 Test Loss: 5.070 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6858997344970703
Epoch: 23, Steps: 13 | Train Loss: 0.477 Vali Loss: 5.101 Vali Acc: 0.506 Test Loss: 5.101 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 995118
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.100841522216797
Epoch: 1, Steps: 13 | Train Loss: 0.880 Vali Loss: 0.930 Vali Acc: 0.517 Test Loss: 0.930 Test Acc: 0.517
Validation loss decreased (inf --> -0.516657).  Saving model ...
Epoch: 2 cost time: 1.4964077472686768
Epoch: 2, Steps: 13 | Train Loss: 0.952 Vali Loss: 1.084 Vali Acc: 0.517 Test Loss: 1.084 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6050164699554443
Epoch: 3, Steps: 13 | Train Loss: 1.109 Vali Loss: 1.163 Vali Acc: 0.489 Test Loss: 1.163 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.565622091293335
Epoch: 4, Steps: 13 | Train Loss: 0.818 Vali Loss: 1.432 Vali Acc: 0.500 Test Loss: 1.432 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5876989364624023
Epoch: 5, Steps: 13 | Train Loss: 1.436 Vali Loss: 1.620 Vali Acc: 0.533 Test Loss: 1.620 Test Acc: 0.533
Validation loss decreased (-0.516657 --> -0.533317).  Saving model ...
Epoch: 6 cost time: 1.4719789028167725
Epoch: 6, Steps: 13 | Train Loss: 0.602 Vali Loss: 2.018 Vali Acc: 0.511 Test Loss: 2.018 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5349414348602295
Epoch: 7, Steps: 13 | Train Loss: 0.583 Vali Loss: 2.078 Vali Acc: 0.472 Test Loss: 2.078 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5002479553222656
Epoch: 8, Steps: 13 | Train Loss: 0.625 Vali Loss: 3.295 Vali Acc: 0.517 Test Loss: 3.295 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5100281238555908
Epoch: 9, Steps: 13 | Train Loss: 1.013 Vali Loss: 2.060 Vali Acc: 0.506 Test Loss: 2.060 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.397613286972046
Epoch: 10, Steps: 13 | Train Loss: 0.543 Vali Loss: 2.169 Vali Acc: 0.439 Test Loss: 2.169 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5397918224334717
Epoch: 11, Steps: 13 | Train Loss: 0.394 Vali Loss: 2.558 Vali Acc: 0.439 Test Loss: 2.558 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5590569972991943
Epoch: 12, Steps: 13 | Train Loss: 0.568 Vali Loss: 2.882 Vali Acc: 0.517 Test Loss: 2.882 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6065845489501953
Epoch: 13, Steps: 13 | Train Loss: 0.463 Vali Loss: 3.908 Vali Acc: 0.517 Test Loss: 3.908 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6054413318634033
Epoch: 14, Steps: 13 | Train Loss: 0.357 Vali Loss: 2.521 Vali Acc: 0.461 Test Loss: 2.521 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5682122707366943
Epoch: 15, Steps: 13 | Train Loss: 0.254 Vali Loss: 4.324 Vali Acc: 0.506 Test Loss: 4.324 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 995118
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8733065128326416
Epoch: 1, Steps: 13 | Train Loss: 0.839 Vali Loss: 0.883 Vali Acc: 0.506 Test Loss: 0.883 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 1.4680869579315186
Epoch: 2, Steps: 13 | Train Loss: 1.090 Vali Loss: 0.891 Vali Acc: 0.489 Test Loss: 0.891 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4425721168518066
Epoch: 3, Steps: 13 | Train Loss: 1.376 Vali Loss: 1.031 Vali Acc: 0.522 Test Loss: 1.031 Test Acc: 0.522
Validation loss decreased (-0.505547 --> -0.522212).  Saving model ...
Epoch: 4 cost time: 1.451786756515503
Epoch: 4, Steps: 13 | Train Loss: 1.236 Vali Loss: 1.117 Vali Acc: 0.528 Test Loss: 1.117 Test Acc: 0.528
Validation loss decreased (-0.522212 --> -0.527767).  Saving model ...
Epoch: 5 cost time: 1.4034099578857422
Epoch: 5, Steps: 13 | Train Loss: 1.220 Vali Loss: 1.573 Vali Acc: 0.489 Test Loss: 1.573 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.426628589630127
Epoch: 6, Steps: 13 | Train Loss: 1.113 Vali Loss: 1.108 Vali Acc: 0.528 Test Loss: 1.108 Test Acc: 0.528
Validation loss decreased (-0.527767 --> -0.527767).  Saving model ...
Epoch: 7 cost time: 1.3559556007385254
Epoch: 7, Steps: 13 | Train Loss: 1.305 Vali Loss: 2.146 Vali Acc: 0.522 Test Loss: 2.146 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.290992259979248
Epoch: 8, Steps: 13 | Train Loss: 1.089 Vali Loss: 2.476 Vali Acc: 0.500 Test Loss: 2.476 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3462786674499512
Epoch: 9, Steps: 13 | Train Loss: 1.302 Vali Loss: 2.311 Vali Acc: 0.539 Test Loss: 2.311 Test Acc: 0.539
Validation loss decreased (-0.527767 --> -0.538866).  Saving model ...
Epoch: 10 cost time: 1.324129343032837
Epoch: 10, Steps: 13 | Train Loss: 0.905 Vali Loss: 1.286 Vali Acc: 0.517 Test Loss: 1.286 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3850808143615723
Epoch: 11, Steps: 13 | Train Loss: 0.619 Vali Loss: 1.546 Vali Acc: 0.500 Test Loss: 1.546 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3971507549285889
Epoch: 12, Steps: 13 | Train Loss: 1.185 Vali Loss: 2.861 Vali Acc: 0.478 Test Loss: 2.861 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.382652997970581
Epoch: 13, Steps: 13 | Train Loss: 0.963 Vali Loss: 1.953 Vali Acc: 0.533 Test Loss: 1.953 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.421661376953125
Epoch: 14, Steps: 13 | Train Loss: 0.505 Vali Loss: 1.643 Vali Acc: 0.478 Test Loss: 1.643 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3983983993530273
Epoch: 15, Steps: 13 | Train Loss: 0.536 Vali Loss: 2.211 Vali Acc: 0.478 Test Loss: 2.211 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4039125442504883
Epoch: 16, Steps: 13 | Train Loss: 0.796 Vali Loss: 3.530 Vali Acc: 0.494 Test Loss: 3.530 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.464709758758545
Epoch: 17, Steps: 13 | Train Loss: 0.928 Vali Loss: 5.682 Vali Acc: 0.517 Test Loss: 5.682 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.256758213043213
Epoch: 18, Steps: 13 | Train Loss: 0.896 Vali Loss: 2.543 Vali Acc: 0.456 Test Loss: 2.543 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3903133869171143
Epoch: 19, Steps: 13 | Train Loss: 0.240 Vali Loss: 3.247 Vali Acc: 0.489 Test Loss: 3.247 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 995118
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4536283016204834
Epoch: 1, Steps: 13 | Train Loss: 0.828 Vali Loss: 1.171 Vali Acc: 0.506 Test Loss: 1.171 Test Acc: 0.506
Validation loss decreased (inf --> -0.505544).  Saving model ...
Epoch: 2 cost time: 1.7426669597625732
Epoch: 2, Steps: 13 | Train Loss: 1.462 Vali Loss: 0.992 Vali Acc: 0.522 Test Loss: 0.992 Test Acc: 0.522
Validation loss decreased (-0.505544 --> -0.522212).  Saving model ...
Epoch: 3 cost time: 1.7547013759613037
Epoch: 3, Steps: 13 | Train Loss: 1.267 Vali Loss: 1.410 Vali Acc: 0.472 Test Loss: 1.410 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8009371757507324
Epoch: 4, Steps: 13 | Train Loss: 0.914 Vali Loss: 1.264 Vali Acc: 0.533 Test Loss: 1.264 Test Acc: 0.533
Validation loss decreased (-0.522212 --> -0.533321).  Saving model ...
Epoch: 5 cost time: 1.7959985733032227
Epoch: 5, Steps: 13 | Train Loss: 1.020 Vali Loss: 2.925 Vali Acc: 0.483 Test Loss: 2.925 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8096544742584229
Epoch: 6, Steps: 13 | Train Loss: 0.839 Vali Loss: 1.684 Vali Acc: 0.506 Test Loss: 1.684 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8486220836639404
Epoch: 7, Steps: 13 | Train Loss: 0.935 Vali Loss: 2.815 Vali Acc: 0.522 Test Loss: 2.815 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.821984052658081
Epoch: 8, Steps: 13 | Train Loss: 0.666 Vali Loss: 1.826 Vali Acc: 0.483 Test Loss: 1.826 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8591952323913574
Epoch: 9, Steps: 13 | Train Loss: 0.598 Vali Loss: 2.613 Vali Acc: 0.494 Test Loss: 2.613 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8317086696624756
Epoch: 10, Steps: 13 | Train Loss: 1.076 Vali Loss: 3.795 Vali Acc: 0.472 Test Loss: 3.795 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8082892894744873
Epoch: 11, Steps: 13 | Train Loss: 0.740 Vali Loss: 5.610 Vali Acc: 0.472 Test Loss: 5.610 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8333206176757812
Epoch: 12, Steps: 13 | Train Loss: 1.077 Vali Loss: 2.962 Vali Acc: 0.528 Test Loss: 2.962 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8039813041687012
Epoch: 13, Steps: 13 | Train Loss: 0.464 Vali Loss: 2.755 Vali Acc: 0.506 Test Loss: 2.755 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8671658039093018
Epoch: 14, Steps: 13 | Train Loss: 1.135 Vali Loss: 3.232 Vali Acc: 0.450 Test Loss: 3.232 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 864046
model size : 8.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.297511577606201
Epoch: 1, Steps: 13 | Train Loss: 0.835 Vali Loss: 1.047 Vali Acc: 0.489 Test Loss: 1.047 Test Acc: 0.489
Validation loss decreased (inf --> -0.488878).  Saving model ...
Epoch: 2 cost time: 1.6197762489318848
Epoch: 2, Steps: 13 | Train Loss: 1.379 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
Validation loss decreased (-0.488878 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.663140058517456
Epoch: 3, Steps: 13 | Train Loss: 0.892 Vali Loss: 1.622 Vali Acc: 0.483 Test Loss: 1.622 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7101655006408691
Epoch: 4, Steps: 13 | Train Loss: 1.119 Vali Loss: 1.981 Vali Acc: 0.528 Test Loss: 1.981 Test Acc: 0.528
Validation loss decreased (-0.499992 --> -0.527758).  Saving model ...
Epoch: 5 cost time: 1.7391855716705322
Epoch: 5, Steps: 13 | Train Loss: 0.753 Vali Loss: 1.788 Vali Acc: 0.528 Test Loss: 1.788 Test Acc: 0.528
Validation loss decreased (-0.527758 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 1.7601945400238037
Epoch: 6, Steps: 13 | Train Loss: 0.722 Vali Loss: 1.986 Vali Acc: 0.500 Test Loss: 1.986 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7711513042449951
Epoch: 7, Steps: 13 | Train Loss: 0.615 Vali Loss: 2.004 Vali Acc: 0.528 Test Loss: 2.004 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7352979183197021
Epoch: 8, Steps: 13 | Train Loss: 0.815 Vali Loss: 2.491 Vali Acc: 0.472 Test Loss: 2.491 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.747370719909668
Epoch: 9, Steps: 13 | Train Loss: 0.962 Vali Loss: 2.282 Vali Acc: 0.489 Test Loss: 2.282 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7475614547729492
Epoch: 10, Steps: 13 | Train Loss: 0.783 Vali Loss: 2.431 Vali Acc: 0.422 Test Loss: 2.431 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6437711715698242
Epoch: 11, Steps: 13 | Train Loss: 1.279 Vali Loss: 2.737 Vali Acc: 0.489 Test Loss: 2.737 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7004475593566895
Epoch: 12, Steps: 13 | Train Loss: 0.554 Vali Loss: 2.309 Vali Acc: 0.494 Test Loss: 2.309 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6413626670837402
Epoch: 13, Steps: 13 | Train Loss: 0.470 Vali Loss: 3.149 Vali Acc: 0.517 Test Loss: 3.149 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6726272106170654
Epoch: 14, Steps: 13 | Train Loss: 1.281 Vali Loss: 5.062 Vali Acc: 0.511 Test Loss: 5.062 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6928043365478516
Epoch: 15, Steps: 13 | Train Loss: 0.809 Vali Loss: 4.409 Vali Acc: 0.511 Test Loss: 4.409 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 864046
model size : 8.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1301488876342773
Epoch: 1, Steps: 13 | Train Loss: 0.820 Vali Loss: 1.140 Vali Acc: 0.506 Test Loss: 1.140 Test Acc: 0.506
Validation loss decreased (inf --> -0.505544).  Saving model ...
Epoch: 2 cost time: 1.575943946838379
Epoch: 2, Steps: 13 | Train Loss: 1.471 Vali Loss: 0.969 Vali Acc: 0.472 Test Loss: 0.969 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.616105556488037
Epoch: 3, Steps: 13 | Train Loss: 1.261 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6994683742523193
Epoch: 4, Steps: 13 | Train Loss: 0.886 Vali Loss: 0.994 Vali Acc: 0.528 Test Loss: 0.994 Test Acc: 0.528
Validation loss decreased (-0.505544 --> -0.527768).  Saving model ...
Epoch: 5 cost time: 1.6406641006469727
Epoch: 5, Steps: 13 | Train Loss: 0.780 Vali Loss: 1.125 Vali Acc: 0.478 Test Loss: 1.125 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6106550693511963
Epoch: 6, Steps: 13 | Train Loss: 0.550 Vali Loss: 1.414 Vali Acc: 0.483 Test Loss: 1.414 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5536577701568604
Epoch: 7, Steps: 13 | Train Loss: 0.633 Vali Loss: 1.597 Vali Acc: 0.483 Test Loss: 1.597 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5949463844299316
Epoch: 8, Steps: 13 | Train Loss: 0.374 Vali Loss: 3.094 Vali Acc: 0.494 Test Loss: 3.094 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5895662307739258
Epoch: 9, Steps: 13 | Train Loss: 1.310 Vali Loss: 2.118 Vali Acc: 0.494 Test Loss: 2.118 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5215497016906738
Epoch: 10, Steps: 13 | Train Loss: 1.178 Vali Loss: 1.739 Vali Acc: 0.489 Test Loss: 1.739 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5647830963134766
Epoch: 11, Steps: 13 | Train Loss: 1.276 Vali Loss: 3.799 Vali Acc: 0.472 Test Loss: 3.799 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6316962242126465
Epoch: 12, Steps: 13 | Train Loss: 0.931 Vali Loss: 4.320 Vali Acc: 0.517 Test Loss: 4.320 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.581815481185913
Epoch: 13, Steps: 13 | Train Loss: 0.674 Vali Loss: 2.303 Vali Acc: 0.439 Test Loss: 2.303 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6151254177093506
Epoch: 14, Steps: 13 | Train Loss: 1.078 Vali Loss: 2.959 Vali Acc: 0.528 Test Loss: 2.959 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 864046
model size : 8.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9871277809143066
Epoch: 1, Steps: 13 | Train Loss: 0.812 Vali Loss: 1.127 Vali Acc: 0.489 Test Loss: 1.127 Test Acc: 0.489
Validation loss decreased (inf --> -0.488878).  Saving model ...
Epoch: 2 cost time: 1.3992133140563965
Epoch: 2, Steps: 13 | Train Loss: 1.377 Vali Loss: 0.814 Vali Acc: 0.522 Test Loss: 0.814 Test Acc: 0.522
Validation loss decreased (-0.488878 --> -0.522214).  Saving model ...
Epoch: 3 cost time: 1.4020400047302246
Epoch: 3, Steps: 13 | Train Loss: 1.055 Vali Loss: 1.755 Vali Acc: 0.511 Test Loss: 1.755 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4186859130859375
Epoch: 4, Steps: 13 | Train Loss: 1.342 Vali Loss: 1.509 Vali Acc: 0.506 Test Loss: 1.509 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3766896724700928
Epoch: 5, Steps: 13 | Train Loss: 0.976 Vali Loss: 2.173 Vali Acc: 0.506 Test Loss: 2.173 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.307508945465088
Epoch: 6, Steps: 13 | Train Loss: 1.392 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
Validation loss decreased (-0.522214 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 1.3668780326843262
Epoch: 7, Steps: 13 | Train Loss: 0.884 Vali Loss: 1.947 Vali Acc: 0.517 Test Loss: 1.947 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.297368049621582
Epoch: 8, Steps: 13 | Train Loss: 1.177 Vali Loss: 1.279 Vali Acc: 0.556 Test Loss: 1.279 Test Acc: 0.556
Validation loss decreased (-0.533323 --> -0.555543).  Saving model ...
Epoch: 9 cost time: 1.2617173194885254
Epoch: 9, Steps: 13 | Train Loss: 0.811 Vali Loss: 1.922 Vali Acc: 0.517 Test Loss: 1.922 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4111733436584473
Epoch: 10, Steps: 13 | Train Loss: 1.098 Vali Loss: 2.235 Vali Acc: 0.528 Test Loss: 2.235 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4042341709136963
Epoch: 11, Steps: 13 | Train Loss: 1.791 Vali Loss: 3.777 Vali Acc: 0.483 Test Loss: 3.777 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5009782314300537
Epoch: 12, Steps: 13 | Train Loss: 1.616 Vali Loss: 2.845 Vali Acc: 0.533 Test Loss: 2.845 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3946812152862549
Epoch: 13, Steps: 13 | Train Loss: 1.839 Vali Loss: 4.744 Vali Acc: 0.483 Test Loss: 4.744 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4442925453186035
Epoch: 14, Steps: 13 | Train Loss: 1.684 Vali Loss: 2.364 Vali Acc: 0.478 Test Loss: 2.364 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3598034381866455
Epoch: 15, Steps: 13 | Train Loss: 0.501 Vali Loss: 3.684 Vali Acc: 0.511 Test Loss: 3.684 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3987882137298584
Epoch: 16, Steps: 13 | Train Loss: 1.089 Vali Loss: 3.426 Vali Acc: 0.517 Test Loss: 3.426 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.307831048965454
Epoch: 17, Steps: 13 | Train Loss: 1.604 Vali Loss: 5.173 Vali Acc: 0.522 Test Loss: 5.173 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3560283184051514
Epoch: 18, Steps: 13 | Train Loss: 1.103 Vali Loss: 5.207 Vali Acc: 0.511 Test Loss: 5.207 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 864046
model size : 8.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0934550762176514
Epoch: 1, Steps: 13 | Train Loss: 0.892 Vali Loss: 0.976 Vali Acc: 0.467 Test Loss: 0.976 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 1.7218210697174072
Epoch: 2, Steps: 13 | Train Loss: 1.027 Vali Loss: 1.392 Vali Acc: 0.511 Test Loss: 1.392 Test Acc: 0.511
Validation loss decreased (-0.466657 --> -0.511097).  Saving model ...
Epoch: 3 cost time: 1.7716727256774902
Epoch: 3, Steps: 13 | Train Loss: 0.715 Vali Loss: 1.036 Vali Acc: 0.511 Test Loss: 1.036 Test Acc: 0.511
Validation loss decreased (-0.511097 --> -0.511101).  Saving model ...
Epoch: 4 cost time: 1.7596635818481445
Epoch: 4, Steps: 13 | Train Loss: 0.830 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.511101 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.7188847064971924
Epoch: 5, Steps: 13 | Train Loss: 0.836 Vali Loss: 2.408 Vali Acc: 0.489 Test Loss: 2.408 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.696462631225586
Epoch: 6, Steps: 13 | Train Loss: 0.712 Vali Loss: 1.938 Vali Acc: 0.500 Test Loss: 1.938 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8629276752471924
Epoch: 7, Steps: 13 | Train Loss: 0.761 Vali Loss: 1.951 Vali Acc: 0.517 Test Loss: 1.951 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8516943454742432
Epoch: 8, Steps: 13 | Train Loss: 0.683 Vali Loss: 3.001 Vali Acc: 0.472 Test Loss: 3.001 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8886191844940186
Epoch: 9, Steps: 13 | Train Loss: 0.545 Vali Loss: 2.142 Vali Acc: 0.494 Test Loss: 2.142 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7388598918914795
Epoch: 10, Steps: 13 | Train Loss: 0.402 Vali Loss: 2.681 Vali Acc: 0.517 Test Loss: 2.681 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7956264019012451
Epoch: 11, Steps: 13 | Train Loss: 0.505 Vali Loss: 3.248 Vali Acc: 0.478 Test Loss: 3.248 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7983274459838867
Epoch: 12, Steps: 13 | Train Loss: 0.303 Vali Loss: 3.153 Vali Acc: 0.500 Test Loss: 3.153 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.732064962387085
Epoch: 13, Steps: 13 | Train Loss: 0.579 Vali Loss: 3.380 Vali Acc: 0.494 Test Loss: 3.380 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8090488910675049
Epoch: 14, Steps: 13 | Train Loss: 0.761 Vali Loss: 3.333 Vali Acc: 0.500 Test Loss: 3.333 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 798510
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.235785961151123
Epoch: 1, Steps: 13 | Train Loss: 0.849 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.6366162300109863
Epoch: 2, Steps: 13 | Train Loss: 1.161 Vali Loss: 1.342 Vali Acc: 0.528 Test Loss: 1.342 Test Acc: 0.528
Validation loss decreased (-0.499988 --> -0.527764).  Saving model ...
Epoch: 3 cost time: 1.649550437927246
Epoch: 3, Steps: 13 | Train Loss: 0.784 Vali Loss: 1.071 Vali Acc: 0.539 Test Loss: 1.071 Test Acc: 0.539
Validation loss decreased (-0.527764 --> -0.538878).  Saving model ...
Epoch: 4 cost time: 1.68519926071167
Epoch: 4, Steps: 13 | Train Loss: 0.868 Vali Loss: 1.724 Vali Acc: 0.500 Test Loss: 1.724 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6263420581817627
Epoch: 5, Steps: 13 | Train Loss: 0.766 Vali Loss: 1.806 Vali Acc: 0.500 Test Loss: 1.806 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.762730598449707
Epoch: 6, Steps: 13 | Train Loss: 1.149 Vali Loss: 2.033 Vali Acc: 0.439 Test Loss: 2.033 Test Acc: 0.439
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7002372741699219
Epoch: 7, Steps: 13 | Train Loss: 0.493 Vali Loss: 2.007 Vali Acc: 0.517 Test Loss: 2.007 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6897461414337158
Epoch: 8, Steps: 13 | Train Loss: 0.876 Vali Loss: 2.886 Vali Acc: 0.483 Test Loss: 2.886 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.689286231994629
Epoch: 9, Steps: 13 | Train Loss: 1.060 Vali Loss: 3.147 Vali Acc: 0.539 Test Loss: 3.147 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.654402256011963
Epoch: 10, Steps: 13 | Train Loss: 0.735 Vali Loss: 2.268 Vali Acc: 0.494 Test Loss: 2.268 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.676255226135254
Epoch: 11, Steps: 13 | Train Loss: 0.762 Vali Loss: 2.352 Vali Acc: 0.506 Test Loss: 2.352 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6606078147888184
Epoch: 12, Steps: 13 | Train Loss: 0.534 Vali Loss: 4.943 Vali Acc: 0.478 Test Loss: 4.943 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6547889709472656
Epoch: 13, Steps: 13 | Train Loss: 1.116 Vali Loss: 4.826 Vali Acc: 0.472 Test Loss: 4.826 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 798510
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1964023113250732
Epoch: 1, Steps: 13 | Train Loss: 0.840 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.466383934020996
Epoch: 2, Steps: 13 | Train Loss: 1.141 Vali Loss: 1.156 Vali Acc: 0.567 Test Loss: 1.156 Test Acc: 0.567
Validation loss decreased (-0.499987 --> -0.566655).  Saving model ...
Epoch: 3 cost time: 1.4319939613342285
Epoch: 3, Steps: 13 | Train Loss: 1.020 Vali Loss: 2.210 Vali Acc: 0.500 Test Loss: 2.210 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4782171249389648
Epoch: 4, Steps: 13 | Train Loss: 0.863 Vali Loss: 1.393 Vali Acc: 0.450 Test Loss: 1.393 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4535791873931885
Epoch: 5, Steps: 13 | Train Loss: 0.786 Vali Loss: 1.286 Vali Acc: 0.511 Test Loss: 1.286 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4755818843841553
Epoch: 6, Steps: 13 | Train Loss: 0.597 Vali Loss: 1.445 Vali Acc: 0.500 Test Loss: 1.445 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4941577911376953
Epoch: 7, Steps: 13 | Train Loss: 0.472 Vali Loss: 2.919 Vali Acc: 0.494 Test Loss: 2.919 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5183744430541992
Epoch: 8, Steps: 13 | Train Loss: 0.998 Vali Loss: 2.190 Vali Acc: 0.511 Test Loss: 2.190 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5237305164337158
Epoch: 9, Steps: 13 | Train Loss: 0.795 Vali Loss: 1.535 Vali Acc: 0.511 Test Loss: 1.535 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4403629302978516
Epoch: 10, Steps: 13 | Train Loss: 0.699 Vali Loss: 1.657 Vali Acc: 0.522 Test Loss: 1.657 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4245760440826416
Epoch: 11, Steps: 13 | Train Loss: 0.237 Vali Loss: 2.425 Vali Acc: 0.444 Test Loss: 2.425 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4200665950775146
Epoch: 12, Steps: 13 | Train Loss: 0.740 Vali Loss: 4.206 Vali Acc: 0.522 Test Loss: 4.206 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 798510
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9274823665618896
Epoch: 1, Steps: 13 | Train Loss: 0.858 Vali Loss: 0.855 Vali Acc: 0.494 Test Loss: 0.855 Test Acc: 0.494
Validation loss decreased (inf --> -0.494436).  Saving model ...
Epoch: 2 cost time: 1.3703641891479492
Epoch: 2, Steps: 13 | Train Loss: 0.855 Vali Loss: 0.961 Vali Acc: 0.528 Test Loss: 0.961 Test Acc: 0.528
Validation loss decreased (-0.494436 --> -0.527768).  Saving model ...
Epoch: 3 cost time: 1.3442292213439941
Epoch: 3, Steps: 13 | Train Loss: 0.918 Vali Loss: 0.847 Vali Acc: 0.528 Test Loss: 0.847 Test Acc: 0.528
Validation loss decreased (-0.527768 --> -0.527769).  Saving model ...
Epoch: 4 cost time: 1.3236396312713623
Epoch: 4, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.959 Vali Acc: 0.539 Test Loss: 0.959 Test Acc: 0.539
Validation loss decreased (-0.527769 --> -0.538879).  Saving model ...
Epoch: 5 cost time: 1.349287509918213
Epoch: 5, Steps: 13 | Train Loss: 1.107 Vali Loss: 1.351 Vali Acc: 0.489 Test Loss: 1.351 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3145618438720703
Epoch: 6, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.905 Vali Acc: 0.506 Test Loss: 0.905 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4209840297698975
Epoch: 7, Steps: 13 | Train Loss: 1.245 Vali Loss: 1.343 Vali Acc: 0.550 Test Loss: 1.343 Test Acc: 0.550
Validation loss decreased (-0.538879 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 1.375770092010498
Epoch: 8, Steps: 13 | Train Loss: 1.516 Vali Loss: 1.940 Vali Acc: 0.483 Test Loss: 1.940 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4422388076782227
Epoch: 9, Steps: 13 | Train Loss: 1.000 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.392899513244629
Epoch: 10, Steps: 13 | Train Loss: 0.866 Vali Loss: 2.453 Vali Acc: 0.517 Test Loss: 2.453 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.405043363571167
Epoch: 11, Steps: 13 | Train Loss: 0.901 Vali Loss: 2.375 Vali Acc: 0.511 Test Loss: 2.375 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4292597770690918
Epoch: 12, Steps: 13 | Train Loss: 0.960 Vali Loss: 1.530 Vali Acc: 0.517 Test Loss: 1.530 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3882741928100586
Epoch: 13, Steps: 13 | Train Loss: 0.674 Vali Loss: 4.160 Vali Acc: 0.528 Test Loss: 4.160 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4068820476531982
Epoch: 14, Steps: 13 | Train Loss: 0.968 Vali Loss: 3.018 Vali Acc: 0.539 Test Loss: 3.018 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4068710803985596
Epoch: 15, Steps: 13 | Train Loss: 1.108 Vali Loss: 2.382 Vali Acc: 0.533 Test Loss: 2.382 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3878748416900635
Epoch: 16, Steps: 13 | Train Loss: 0.734 Vali Loss: 3.240 Vali Acc: 0.522 Test Loss: 3.240 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.397745132446289
Epoch: 17, Steps: 13 | Train Loss: 0.643 Vali Loss: 3.065 Vali Acc: 0.478 Test Loss: 3.065 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 798510
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.482165813446045
Epoch: 1, Steps: 13 | Train Loss: 0.992 Vali Loss: 1.036 Vali Acc: 0.444 Test Loss: 1.036 Test Acc: 0.444
Validation loss decreased (inf --> -0.444434).  Saving model ...
Epoch: 2 cost time: 1.8571734428405762
Epoch: 2, Steps: 13 | Train Loss: 0.843 Vali Loss: 1.093 Vali Acc: 0.517 Test Loss: 1.093 Test Acc: 0.517
Validation loss decreased (-0.444434 --> -0.516656).  Saving model ...
Epoch: 3 cost time: 1.7799830436706543
Epoch: 3, Steps: 13 | Train Loss: 0.916 Vali Loss: 1.302 Vali Acc: 0.489 Test Loss: 1.302 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7702817916870117
Epoch: 4, Steps: 13 | Train Loss: 0.947 Vali Loss: 1.446 Vali Acc: 0.506 Test Loss: 1.446 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.767463207244873
Epoch: 5, Steps: 13 | Train Loss: 0.507 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8169841766357422
Epoch: 6, Steps: 13 | Train Loss: 0.648 Vali Loss: 1.985 Vali Acc: 0.478 Test Loss: 1.985 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8433277606964111
Epoch: 7, Steps: 13 | Train Loss: 0.773 Vali Loss: 2.051 Vali Acc: 0.478 Test Loss: 2.051 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7856709957122803
Epoch: 8, Steps: 13 | Train Loss: 0.495 Vali Loss: 2.143 Vali Acc: 0.489 Test Loss: 2.143 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8385295867919922
Epoch: 9, Steps: 13 | Train Loss: 0.341 Vali Loss: 2.577 Vali Acc: 0.467 Test Loss: 2.577 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8092031478881836
Epoch: 10, Steps: 13 | Train Loss: 0.242 Vali Loss: 2.567 Vali Acc: 0.506 Test Loss: 2.567 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7935431003570557
Epoch: 11, Steps: 13 | Train Loss: 0.387 Vali Loss: 2.209 Vali Acc: 0.517 Test Loss: 2.209 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.796541452407837
Epoch: 12, Steps: 13 | Train Loss: 0.200 Vali Loss: 2.425 Vali Acc: 0.478 Test Loss: 2.425 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 765742
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.12777042388916
Epoch: 1, Steps: 13 | Train Loss: 0.983 Vali Loss: 1.046 Vali Acc: 0.456 Test Loss: 1.046 Test Acc: 0.456
Validation loss decreased (inf --> -0.455545).  Saving model ...
Epoch: 2 cost time: 1.6027874946594238
Epoch: 2, Steps: 13 | Train Loss: 0.866 Vali Loss: 1.061 Vali Acc: 0.528 Test Loss: 1.061 Test Acc: 0.528
Validation loss decreased (-0.455545 --> -0.527767).  Saving model ...
Epoch: 3 cost time: 1.5981743335723877
Epoch: 3, Steps: 13 | Train Loss: 1.063 Vali Loss: 1.480 Vali Acc: 0.472 Test Loss: 1.480 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5519921779632568
Epoch: 4, Steps: 13 | Train Loss: 0.799 Vali Loss: 1.966 Vali Acc: 0.522 Test Loss: 1.966 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5858840942382812
Epoch: 5, Steps: 13 | Train Loss: 1.597 Vali Loss: 3.017 Vali Acc: 0.500 Test Loss: 3.017 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4386379718780518
Epoch: 6, Steps: 13 | Train Loss: 1.734 Vali Loss: 3.191 Vali Acc: 0.522 Test Loss: 3.191 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5970513820648193
Epoch: 7, Steps: 13 | Train Loss: 2.532 Vali Loss: 5.914 Vali Acc: 0.506 Test Loss: 5.914 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5889527797698975
Epoch: 8, Steps: 13 | Train Loss: 2.762 Vali Loss: 6.122 Vali Acc: 0.500 Test Loss: 6.122 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6193797588348389
Epoch: 9, Steps: 13 | Train Loss: 1.733 Vali Loss: 3.296 Vali Acc: 0.472 Test Loss: 3.296 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.540125846862793
Epoch: 10, Steps: 13 | Train Loss: 1.576 Vali Loss: 5.680 Vali Acc: 0.500 Test Loss: 5.680 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5551791191101074
Epoch: 11, Steps: 13 | Train Loss: 2.970 Vali Loss: 4.249 Vali Acc: 0.461 Test Loss: 4.249 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.551243782043457
Epoch: 12, Steps: 13 | Train Loss: 1.882 Vali Loss: 4.155 Vali Acc: 0.522 Test Loss: 4.155 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 765742
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0252926349639893
Epoch: 1, Steps: 13 | Train Loss: 0.955 Vali Loss: 1.024 Vali Acc: 0.472 Test Loss: 1.024 Test Acc: 0.472
Validation loss decreased (inf --> -0.472212).  Saving model ...
Epoch: 2 cost time: 1.524662733078003
Epoch: 2, Steps: 13 | Train Loss: 0.915 Vali Loss: 1.077 Vali Acc: 0.539 Test Loss: 1.077 Test Acc: 0.539
Validation loss decreased (-0.472212 --> -0.538878).  Saving model ...
Epoch: 3 cost time: 1.522171974182129
Epoch: 3, Steps: 13 | Train Loss: 0.767 Vali Loss: 1.313 Vali Acc: 0.478 Test Loss: 1.313 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.532883644104004
Epoch: 4, Steps: 13 | Train Loss: 0.881 Vali Loss: 1.368 Vali Acc: 0.489 Test Loss: 1.368 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.516089916229248
Epoch: 5, Steps: 13 | Train Loss: 0.621 Vali Loss: 1.318 Vali Acc: 0.511 Test Loss: 1.318 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5521759986877441
Epoch: 6, Steps: 13 | Train Loss: 1.104 Vali Loss: 2.481 Vali Acc: 0.517 Test Loss: 2.481 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4993152618408203
Epoch: 7, Steps: 13 | Train Loss: 0.760 Vali Loss: 1.496 Vali Acc: 0.456 Test Loss: 1.496 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4210472106933594
Epoch: 8, Steps: 13 | Train Loss: 0.508 Vali Loss: 3.118 Vali Acc: 0.522 Test Loss: 3.118 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4769678115844727
Epoch: 9, Steps: 13 | Train Loss: 0.931 Vali Loss: 2.231 Vali Acc: 0.500 Test Loss: 2.231 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5273942947387695
Epoch: 10, Steps: 13 | Train Loss: 0.814 Vali Loss: 2.671 Vali Acc: 0.472 Test Loss: 2.671 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5503432750701904
Epoch: 11, Steps: 13 | Train Loss: 0.880 Vali Loss: 2.361 Vali Acc: 0.483 Test Loss: 2.361 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4467179775238037
Epoch: 12, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.949 Vali Acc: 0.461 Test Loss: 1.949 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 765742
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9345850944519043
Epoch: 1, Steps: 13 | Train Loss: 0.914 Vali Loss: 1.007 Vali Acc: 0.478 Test Loss: 1.007 Test Acc: 0.478
Validation loss decreased (inf --> -0.477768).  Saving model ...
Epoch: 2 cost time: 1.3976891040802002
Epoch: 2, Steps: 13 | Train Loss: 1.095 Vali Loss: 1.400 Vali Acc: 0.489 Test Loss: 1.400 Test Acc: 0.489
Validation loss decreased (-0.477768 --> -0.488875).  Saving model ...
Epoch: 3 cost time: 1.4363670349121094
Epoch: 3, Steps: 13 | Train Loss: 0.961 Vali Loss: 1.574 Vali Acc: 0.511 Test Loss: 1.574 Test Acc: 0.511
Validation loss decreased (-0.488875 --> -0.511095).  Saving model ...
Epoch: 4 cost time: 1.4288122653961182
Epoch: 4, Steps: 13 | Train Loss: 1.624 Vali Loss: 1.209 Vali Acc: 0.539 Test Loss: 1.209 Test Acc: 0.539
Validation loss decreased (-0.511095 --> -0.538877).  Saving model ...
Epoch: 5 cost time: 1.3959500789642334
Epoch: 5, Steps: 13 | Train Loss: 1.601 Vali Loss: 1.444 Vali Acc: 0.522 Test Loss: 1.444 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.409550428390503
Epoch: 6, Steps: 13 | Train Loss: 1.375 Vali Loss: 1.192 Vali Acc: 0.483 Test Loss: 1.192 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3472304344177246
Epoch: 7, Steps: 13 | Train Loss: 0.751 Vali Loss: 1.551 Vali Acc: 0.478 Test Loss: 1.551 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3990068435668945
Epoch: 8, Steps: 13 | Train Loss: 0.839 Vali Loss: 1.988 Vali Acc: 0.489 Test Loss: 1.988 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3854575157165527
Epoch: 9, Steps: 13 | Train Loss: 0.703 Vali Loss: 1.592 Vali Acc: 0.444 Test Loss: 1.592 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4183294773101807
Epoch: 10, Steps: 13 | Train Loss: 0.979 Vali Loss: 2.722 Vali Acc: 0.511 Test Loss: 2.722 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3300068378448486
Epoch: 11, Steps: 13 | Train Loss: 1.219 Vali Loss: 2.323 Vali Acc: 0.511 Test Loss: 2.323 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4023563861846924
Epoch: 12, Steps: 13 | Train Loss: 0.677 Vali Loss: 1.578 Vali Acc: 0.494 Test Loss: 1.578 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4205031394958496
Epoch: 13, Steps: 13 | Train Loss: 0.705 Vali Loss: 3.393 Vali Acc: 0.461 Test Loss: 3.393 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3752667903900146
Epoch: 14, Steps: 13 | Train Loss: 1.223 Vali Loss: 4.520 Vali Acc: 0.511 Test Loss: 4.520 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 765742
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9526333808898926
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.846 Vali Acc: 0.533 Test Loss: 0.846 Test Acc: 0.533
Validation loss decreased (inf --> -0.533325).  Saving model ...
Epoch: 2 cost time: 1.3203608989715576
Epoch: 2, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.818 Vali Acc: 0.544 Test Loss: 0.818 Test Acc: 0.544
Validation loss decreased (-0.533325 --> -0.544436).  Saving model ...
Epoch: 3 cost time: 1.3697986602783203
Epoch: 3, Steps: 13 | Train Loss: 1.094 Vali Loss: 1.302 Vali Acc: 0.483 Test Loss: 1.302 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.299818754196167
Epoch: 4, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.919 Vali Acc: 0.544 Test Loss: 0.919 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3388752937316895
Epoch: 5, Steps: 13 | Train Loss: 0.493 Vali Loss: 1.270 Vali Acc: 0.533 Test Loss: 1.270 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2700071334838867
Epoch: 6, Steps: 13 | Train Loss: 0.536 Vali Loss: 1.350 Vali Acc: 0.511 Test Loss: 1.350 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2890887260437012
Epoch: 7, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.299 Vali Acc: 0.494 Test Loss: 1.299 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3062019348144531
Epoch: 8, Steps: 13 | Train Loss: 0.432 Vali Loss: 1.270 Vali Acc: 0.494 Test Loss: 1.270 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.31209135055542
Epoch: 9, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.595 Vali Acc: 0.483 Test Loss: 1.595 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2816357612609863
Epoch: 10, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.529 Vali Acc: 0.522 Test Loss: 1.529 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3712794780731201
Epoch: 11, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.629 Vali Acc: 0.517 Test Loss: 1.629 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.312784194946289
Epoch: 12, Steps: 13 | Train Loss: 0.256 Vali Loss: 2.709 Vali Acc: 0.483 Test Loss: 2.709 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 858030
model size : 5.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.907717227935791
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.834 Vali Acc: 0.544 Test Loss: 0.834 Test Acc: 0.544
Validation loss decreased (inf --> -0.544436).  Saving model ...
Epoch: 2 cost time: 1.270369529724121
Epoch: 2, Steps: 13 | Train Loss: 0.809 Vali Loss: 0.793 Vali Acc: 0.522 Test Loss: 0.793 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2442524433135986
Epoch: 3, Steps: 13 | Train Loss: 1.095 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2621405124664307
Epoch: 4, Steps: 13 | Train Loss: 0.810 Vali Loss: 0.848 Vali Acc: 0.561 Test Loss: 0.848 Test Acc: 0.561
Validation loss decreased (-0.544436 --> -0.561103).  Saving model ...
Epoch: 5 cost time: 1.3199727535247803
Epoch: 5, Steps: 13 | Train Loss: 0.545 Vali Loss: 1.294 Vali Acc: 0.533 Test Loss: 1.294 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.289935827255249
Epoch: 6, Steps: 13 | Train Loss: 0.653 Vali Loss: 1.280 Vali Acc: 0.489 Test Loss: 1.280 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2927098274230957
Epoch: 7, Steps: 13 | Train Loss: 0.637 Vali Loss: 1.147 Vali Acc: 0.517 Test Loss: 1.147 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2227108478546143
Epoch: 8, Steps: 13 | Train Loss: 0.620 Vali Loss: 1.470 Vali Acc: 0.483 Test Loss: 1.470 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2918076515197754
Epoch: 9, Steps: 13 | Train Loss: 0.401 Vali Loss: 2.048 Vali Acc: 0.506 Test Loss: 2.048 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2997186183929443
Epoch: 10, Steps: 13 | Train Loss: 0.595 Vali Loss: 2.060 Vali Acc: 0.489 Test Loss: 2.060 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2813243865966797
Epoch: 11, Steps: 13 | Train Loss: 0.487 Vali Loss: 1.483 Vali Acc: 0.506 Test Loss: 1.483 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.202558994293213
Epoch: 12, Steps: 13 | Train Loss: 0.512 Vali Loss: 1.686 Vali Acc: 0.489 Test Loss: 1.686 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2718501091003418
Epoch: 13, Steps: 13 | Train Loss: 0.337 Vali Loss: 2.173 Vali Acc: 0.506 Test Loss: 2.173 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.285090684890747
Epoch: 14, Steps: 13 | Train Loss: 0.451 Vali Loss: 2.095 Vali Acc: 0.506 Test Loss: 2.095 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 858030
model size : 5.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8189902305603027
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.804 Vali Acc: 0.506 Test Loss: 0.804 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.1850931644439697
Epoch: 2, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.842 Vali Acc: 0.533 Test Loss: 0.842 Test Acc: 0.533
Validation loss decreased (-0.505548 --> -0.533325).  Saving model ...
Epoch: 3 cost time: 1.2110183238983154
Epoch: 3, Steps: 13 | Train Loss: 1.041 Vali Loss: 1.311 Vali Acc: 0.528 Test Loss: 1.311 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1159439086914062
Epoch: 4, Steps: 13 | Train Loss: 0.864 Vali Loss: 0.905 Vali Acc: 0.467 Test Loss: 0.905 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0708022117614746
Epoch: 5, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.893 Vali Acc: 0.489 Test Loss: 0.893 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1877539157867432
Epoch: 6, Steps: 13 | Train Loss: 0.591 Vali Loss: 1.074 Vali Acc: 0.444 Test Loss: 1.074 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1991875171661377
Epoch: 7, Steps: 13 | Train Loss: 0.547 Vali Loss: 1.546 Vali Acc: 0.467 Test Loss: 1.546 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1775448322296143
Epoch: 8, Steps: 13 | Train Loss: 0.537 Vali Loss: 1.239 Vali Acc: 0.489 Test Loss: 1.239 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2178282737731934
Epoch: 9, Steps: 13 | Train Loss: 0.469 Vali Loss: 1.365 Vali Acc: 0.461 Test Loss: 1.365 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1454241275787354
Epoch: 10, Steps: 13 | Train Loss: 0.360 Vali Loss: 1.249 Vali Acc: 0.472 Test Loss: 1.249 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.147334337234497
Epoch: 11, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.654 Vali Acc: 0.544 Test Loss: 1.654 Test Acc: 0.544
Validation loss decreased (-0.533325 --> -0.544428).  Saving model ...
Epoch: 12 cost time: 1.1269009113311768
Epoch: 12, Steps: 13 | Train Loss: 0.337 Vali Loss: 2.002 Vali Acc: 0.506 Test Loss: 2.002 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.124098777770996
Epoch: 13, Steps: 13 | Train Loss: 0.453 Vali Loss: 1.882 Vali Acc: 0.500 Test Loss: 1.882 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1589198112487793
Epoch: 14, Steps: 13 | Train Loss: 0.538 Vali Loss: 1.578 Vali Acc: 0.478 Test Loss: 1.578 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1589877605438232
Epoch: 15, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.774 Vali Acc: 0.489 Test Loss: 1.774 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2166898250579834
Epoch: 16, Steps: 13 | Train Loss: 0.203 Vali Loss: 2.835 Vali Acc: 0.517 Test Loss: 2.835 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.211784839630127
Epoch: 17, Steps: 13 | Train Loss: 0.534 Vali Loss: 2.492 Vali Acc: 0.494 Test Loss: 2.492 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2257869243621826
Epoch: 18, Steps: 13 | Train Loss: 0.229 Vali Loss: 2.032 Vali Acc: 0.450 Test Loss: 2.032 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1917634010314941
Epoch: 19, Steps: 13 | Train Loss: 0.183 Vali Loss: 2.014 Vali Acc: 0.450 Test Loss: 2.014 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.103254795074463
Epoch: 20, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.126 Vali Acc: 0.511 Test Loss: 2.126 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.133727788925171
Epoch: 21, Steps: 13 | Train Loss: 0.146 Vali Loss: 2.600 Vali Acc: 0.506 Test Loss: 2.600 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 858030
model size : 5.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7486462593078613
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.768 Vali Acc: 0.522 Test Loss: 0.768 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.0508873462677002
Epoch: 2, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1089727878570557
Epoch: 3, Steps: 13 | Train Loss: 0.999 Vali Loss: 1.094 Vali Acc: 0.544 Test Loss: 1.094 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544434).  Saving model ...
Epoch: 4 cost time: 1.0400872230529785
Epoch: 4, Steps: 13 | Train Loss: 0.962 Vali Loss: 0.940 Vali Acc: 0.522 Test Loss: 0.940 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0932261943817139
Epoch: 5, Steps: 13 | Train Loss: 0.811 Vali Loss: 0.765 Vali Acc: 0.522 Test Loss: 0.765 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.061028242111206
Epoch: 6, Steps: 13 | Train Loss: 0.708 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.053572177886963
Epoch: 7, Steps: 13 | Train Loss: 0.746 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1024196147918701
Epoch: 8, Steps: 13 | Train Loss: 0.565 Vali Loss: 1.219 Vali Acc: 0.506 Test Loss: 1.219 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0677611827850342
Epoch: 9, Steps: 13 | Train Loss: 0.690 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0849573612213135
Epoch: 10, Steps: 13 | Train Loss: 0.523 Vali Loss: 1.094 Vali Acc: 0.483 Test Loss: 1.094 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0892605781555176
Epoch: 11, Steps: 13 | Train Loss: 0.670 Vali Loss: 1.739 Vali Acc: 0.489 Test Loss: 1.739 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0793437957763672
Epoch: 12, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.298 Vali Acc: 0.478 Test Loss: 1.298 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0912435054779053
Epoch: 13, Steps: 13 | Train Loss: 0.651 Vali Loss: 1.381 Vali Acc: 0.467 Test Loss: 1.381 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 858030
model size : 5.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8067357540130615
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.827 Vali Acc: 0.511 Test Loss: 0.827 Test Acc: 0.511
Validation loss decreased (inf --> -0.511103).  Saving model ...
Epoch: 2 cost time: 1.2643074989318848
Epoch: 2, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.822 Vali Acc: 0.489 Test Loss: 0.822 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.27225661277771
Epoch: 3, Steps: 13 | Train Loss: 0.616 Vali Loss: 1.491 Vali Acc: 0.517 Test Loss: 1.491 Test Acc: 0.517
Validation loss decreased (-0.511103 --> -0.516652).  Saving model ...
Epoch: 4 cost time: 1.2579295635223389
Epoch: 4, Steps: 13 | Train Loss: 1.039 Vali Loss: 1.055 Vali Acc: 0.517 Test Loss: 1.055 Test Acc: 0.517
Validation loss decreased (-0.516652 --> -0.516656).  Saving model ...
Epoch: 5 cost time: 1.2938649654388428
Epoch: 5, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.384 Vali Acc: 0.478 Test Loss: 1.384 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2501046657562256
Epoch: 6, Steps: 13 | Train Loss: 0.582 Vali Loss: 1.204 Vali Acc: 0.511 Test Loss: 1.204 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3022325038909912
Epoch: 7, Steps: 13 | Train Loss: 0.453 Vali Loss: 2.265 Vali Acc: 0.500 Test Loss: 2.265 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.314711570739746
Epoch: 8, Steps: 13 | Train Loss: 1.194 Vali Loss: 2.070 Vali Acc: 0.500 Test Loss: 2.070 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3268444538116455
Epoch: 9, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.475 Vali Acc: 0.517 Test Loss: 1.475 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.204941987991333
Epoch: 10, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.655 Vali Acc: 0.506 Test Loss: 1.655 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2289073467254639
Epoch: 11, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.651 Vali Acc: 0.517 Test Loss: 1.651 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.270900011062622
Epoch: 12, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.685 Vali Acc: 0.506 Test Loss: 1.685 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3066625595092773
Epoch: 13, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.782 Vali Acc: 0.511 Test Loss: 1.782 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2207167148590088
Epoch: 14, Steps: 13 | Train Loss: 0.244 Vali Loss: 2.362 Vali Acc: 0.517 Test Loss: 2.362 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 595886
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.969151735305786
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.825 Vali Acc: 0.528 Test Loss: 0.825 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 1.2231910228729248
Epoch: 2, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.815 Vali Acc: 0.461 Test Loss: 0.815 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1689214706420898
Epoch: 3, Steps: 13 | Train Loss: 0.662 Vali Loss: 1.248 Vali Acc: 0.533 Test Loss: 1.248 Test Acc: 0.533
Validation loss decreased (-0.527770 --> -0.533321).  Saving model ...
Epoch: 4 cost time: 1.1426448822021484
Epoch: 4, Steps: 13 | Train Loss: 1.007 Vali Loss: 0.974 Vali Acc: 0.506 Test Loss: 0.974 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2431831359863281
Epoch: 5, Steps: 13 | Train Loss: 0.554 Vali Loss: 1.353 Vali Acc: 0.478 Test Loss: 1.353 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2320683002471924
Epoch: 6, Steps: 13 | Train Loss: 0.772 Vali Loss: 1.215 Vali Acc: 0.528 Test Loss: 1.215 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2376885414123535
Epoch: 7, Steps: 13 | Train Loss: 0.585 Vali Loss: 1.747 Vali Acc: 0.500 Test Loss: 1.747 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2405085563659668
Epoch: 8, Steps: 13 | Train Loss: 0.581 Vali Loss: 1.670 Vali Acc: 0.494 Test Loss: 1.670 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1424732208251953
Epoch: 9, Steps: 13 | Train Loss: 0.608 Vali Loss: 1.492 Vali Acc: 0.483 Test Loss: 1.492 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2052209377288818
Epoch: 10, Steps: 13 | Train Loss: 0.540 Vali Loss: 2.074 Vali Acc: 0.511 Test Loss: 2.074 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1430268287658691
Epoch: 11, Steps: 13 | Train Loss: 0.582 Vali Loss: 1.400 Vali Acc: 0.517 Test Loss: 1.400 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1863093376159668
Epoch: 12, Steps: 13 | Train Loss: 0.351 Vali Loss: 2.350 Vali Acc: 0.489 Test Loss: 2.350 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1579086780548096
Epoch: 13, Steps: 13 | Train Loss: 0.594 Vali Loss: 2.255 Vali Acc: 0.500 Test Loss: 2.255 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 595886
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.808086395263672
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.846 Vali Acc: 0.533 Test Loss: 0.846 Test Acc: 0.533
Validation loss decreased (inf --> -0.533325).  Saving model ...
Epoch: 2 cost time: 1.085630178451538
Epoch: 2, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1670186519622803
Epoch: 3, Steps: 13 | Train Loss: 0.657 Vali Loss: 1.145 Vali Acc: 0.528 Test Loss: 1.145 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1374328136444092
Epoch: 4, Steps: 13 | Train Loss: 0.964 Vali Loss: 0.913 Vali Acc: 0.472 Test Loss: 0.913 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1732757091522217
Epoch: 5, Steps: 13 | Train Loss: 0.687 Vali Loss: 1.006 Vali Acc: 0.483 Test Loss: 1.006 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1599962711334229
Epoch: 6, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.965 Vali Acc: 0.478 Test Loss: 0.965 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1243906021118164
Epoch: 7, Steps: 13 | Train Loss: 0.427 Vali Loss: 1.426 Vali Acc: 0.506 Test Loss: 1.426 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9710783958435059
Epoch: 8, Steps: 13 | Train Loss: 0.717 Vali Loss: 1.306 Vali Acc: 0.494 Test Loss: 1.306 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1953883171081543
Epoch: 9, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.333 Vali Acc: 0.494 Test Loss: 1.333 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.101083755493164
Epoch: 10, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.419 Vali Acc: 0.506 Test Loss: 1.419 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1338493824005127
Epoch: 11, Steps: 13 | Train Loss: 0.699 Vali Loss: 1.768 Vali Acc: 0.472 Test Loss: 1.768 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 595886
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5210611820220947
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.853 Vali Acc: 0.511 Test Loss: 0.853 Test Acc: 0.511
Validation loss decreased (inf --> -0.511103).  Saving model ...
Epoch: 2 cost time: 0.948859453201294
Epoch: 2, Steps: 13 | Train Loss: 0.792 Vali Loss: 0.697 Vali Acc: 0.506 Test Loss: 0.697 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0194957256317139
Epoch: 3, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.807 Vali Acc: 0.561 Test Loss: 0.807 Test Acc: 0.561
Validation loss decreased (-0.511103 --> -0.561103).  Saving model ...
Epoch: 4 cost time: 1.034614086151123
Epoch: 4, Steps: 13 | Train Loss: 0.929 Vali Loss: 0.768 Vali Acc: 0.539 Test Loss: 0.768 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9844813346862793
Epoch: 5, Steps: 13 | Train Loss: 0.806 Vali Loss: 0.939 Vali Acc: 0.494 Test Loss: 0.939 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0720133781433105
Epoch: 6, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.789 Vali Acc: 0.517 Test Loss: 0.789 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9546267986297607
Epoch: 7, Steps: 13 | Train Loss: 0.518 Vali Loss: 1.284 Vali Acc: 0.522 Test Loss: 1.284 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0113365650177002
Epoch: 8, Steps: 13 | Train Loss: 1.055 Vali Loss: 1.178 Vali Acc: 0.506 Test Loss: 1.178 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0162763595581055
Epoch: 9, Steps: 13 | Train Loss: 0.611 Vali Loss: 1.298 Vali Acc: 0.522 Test Loss: 1.298 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0348517894744873
Epoch: 10, Steps: 13 | Train Loss: 0.914 Vali Loss: 1.930 Vali Acc: 0.506 Test Loss: 1.930 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0066394805908203
Epoch: 11, Steps: 13 | Train Loss: 0.936 Vali Loss: 1.470 Vali Acc: 0.522 Test Loss: 1.470 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9724595546722412
Epoch: 12, Steps: 13 | Train Loss: 0.674 Vali Loss: 1.414 Vali Acc: 0.472 Test Loss: 1.414 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9532628059387207
Epoch: 13, Steps: 13 | Train Loss: 1.082 Vali Loss: 1.736 Vali Acc: 0.506 Test Loss: 1.736 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 595886
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0279579162597656
Epoch: 1, Steps: 13 | Train Loss: 0.849 Vali Loss: 0.685 Vali Acc: 0.517 Test Loss: 0.685 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.2039916515350342
Epoch: 2, Steps: 13 | Train Loss: 0.945 Vali Loss: 1.002 Vali Acc: 0.483 Test Loss: 1.002 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.24753999710083
Epoch: 3, Steps: 13 | Train Loss: 0.699 Vali Loss: 1.129 Vali Acc: 0.489 Test Loss: 1.129 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2462382316589355
Epoch: 4, Steps: 13 | Train Loss: 0.906 Vali Loss: 1.058 Vali Acc: 0.500 Test Loss: 1.058 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2353808879852295
Epoch: 5, Steps: 13 | Train Loss: 0.786 Vali Loss: 1.014 Vali Acc: 0.506 Test Loss: 1.014 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.200577735900879
Epoch: 6, Steps: 13 | Train Loss: 0.728 Vali Loss: 1.290 Vali Acc: 0.522 Test Loss: 1.290 Test Acc: 0.522
Validation loss decreased (-0.516660 --> -0.522209).  Saving model ...
Epoch: 7 cost time: 1.2383995056152344
Epoch: 7, Steps: 13 | Train Loss: 0.584 Vali Loss: 1.434 Vali Acc: 0.494 Test Loss: 1.434 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2531695365905762
Epoch: 8, Steps: 13 | Train Loss: 0.572 Vali Loss: 1.451 Vali Acc: 0.489 Test Loss: 1.451 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.264357089996338
Epoch: 9, Steps: 13 | Train Loss: 0.562 Vali Loss: 1.519 Vali Acc: 0.539 Test Loss: 1.519 Test Acc: 0.539
Validation loss decreased (-0.522209 --> -0.538874).  Saving model ...
Epoch: 10 cost time: 1.2548120021820068
Epoch: 10, Steps: 13 | Train Loss: 0.739 Vali Loss: 1.693 Vali Acc: 0.528 Test Loss: 1.693 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1630113124847412
Epoch: 11, Steps: 13 | Train Loss: 0.415 Vali Loss: 1.818 Vali Acc: 0.478 Test Loss: 1.818 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1667859554290771
Epoch: 12, Steps: 13 | Train Loss: 0.323 Vali Loss: 2.571 Vali Acc: 0.494 Test Loss: 2.571 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.319838047027588
Epoch: 13, Steps: 13 | Train Loss: 0.615 Vali Loss: 2.157 Vali Acc: 0.506 Test Loss: 2.157 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2838025093078613
Epoch: 14, Steps: 13 | Train Loss: 0.290 Vali Loss: 2.008 Vali Acc: 0.511 Test Loss: 2.008 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3318774700164795
Epoch: 15, Steps: 13 | Train Loss: 0.217 Vali Loss: 2.132 Vali Acc: 0.506 Test Loss: 2.132 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3456380367279053
Epoch: 16, Steps: 13 | Train Loss: 0.223 Vali Loss: 2.143 Vali Acc: 0.517 Test Loss: 2.143 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.298818826675415
Epoch: 17, Steps: 13 | Train Loss: 0.196 Vali Loss: 2.339 Vali Acc: 0.494 Test Loss: 2.339 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2590937614440918
Epoch: 18, Steps: 13 | Train Loss: 0.186 Vali Loss: 2.656 Vali Acc: 0.539 Test Loss: 2.656 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2825801372528076
Epoch: 19, Steps: 13 | Train Loss: 0.098 Vali Loss: 3.167 Vali Acc: 0.511 Test Loss: 3.167 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 464814
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7182397842407227
Epoch: 1, Steps: 13 | Train Loss: 0.835 Vali Loss: 0.691 Vali Acc: 0.489 Test Loss: 0.691 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.215008020401001
Epoch: 2, Steps: 13 | Train Loss: 0.964 Vali Loss: 1.110 Vali Acc: 0.511 Test Loss: 1.110 Test Acc: 0.511
Validation loss decreased (-0.488882 --> -0.511100).  Saving model ...
Epoch: 3 cost time: 1.2231032848358154
Epoch: 3, Steps: 13 | Train Loss: 0.988 Vali Loss: 0.996 Vali Acc: 0.494 Test Loss: 0.996 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2144033908843994
Epoch: 4, Steps: 13 | Train Loss: 0.983 Vali Loss: 1.350 Vali Acc: 0.528 Test Loss: 1.350 Test Acc: 0.528
Validation loss decreased (-0.511100 --> -0.527764).  Saving model ...
Epoch: 5 cost time: 1.1937847137451172
Epoch: 5, Steps: 13 | Train Loss: 0.693 Vali Loss: 1.055 Vali Acc: 0.517 Test Loss: 1.055 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2049593925476074
Epoch: 6, Steps: 13 | Train Loss: 0.536 Vali Loss: 1.439 Vali Acc: 0.494 Test Loss: 1.439 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1989319324493408
Epoch: 7, Steps: 13 | Train Loss: 0.557 Vali Loss: 1.389 Vali Acc: 0.533 Test Loss: 1.389 Test Acc: 0.533
Validation loss decreased (-0.527764 --> -0.533319).  Saving model ...
Epoch: 8 cost time: 1.1947963237762451
Epoch: 8, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.551 Vali Acc: 0.500 Test Loss: 1.551 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1472501754760742
Epoch: 9, Steps: 13 | Train Loss: 0.507 Vali Loss: 1.965 Vali Acc: 0.472 Test Loss: 1.965 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2485346794128418
Epoch: 10, Steps: 13 | Train Loss: 0.723 Vali Loss: 1.717 Vali Acc: 0.539 Test Loss: 1.717 Test Acc: 0.539
Validation loss decreased (-0.533319 --> -0.538872).  Saving model ...
Epoch: 11 cost time: 1.1965351104736328
Epoch: 11, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.684 Vali Acc: 0.467 Test Loss: 1.684 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.206437587738037
Epoch: 12, Steps: 13 | Train Loss: 0.521 Vali Loss: 1.393 Vali Acc: 0.478 Test Loss: 1.393 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1893293857574463
Epoch: 13, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.783 Vali Acc: 0.494 Test Loss: 1.783 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.180527925491333
Epoch: 14, Steps: 13 | Train Loss: 0.385 Vali Loss: 2.314 Vali Acc: 0.511 Test Loss: 2.314 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.152895450592041
Epoch: 15, Steps: 13 | Train Loss: 0.535 Vali Loss: 2.169 Vali Acc: 0.489 Test Loss: 2.169 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1920127868652344
Epoch: 16, Steps: 13 | Train Loss: 0.346 Vali Loss: 2.434 Vali Acc: 0.517 Test Loss: 2.434 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1624655723571777
Epoch: 17, Steps: 13 | Train Loss: 0.440 Vali Loss: 3.227 Vali Acc: 0.461 Test Loss: 3.227 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.196274757385254
Epoch: 18, Steps: 13 | Train Loss: 0.874 Vali Loss: 3.569 Vali Acc: 0.483 Test Loss: 3.569 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1416161060333252
Epoch: 19, Steps: 13 | Train Loss: 0.511 Vali Loss: 2.292 Vali Acc: 0.467 Test Loss: 2.292 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2216434478759766
Epoch: 20, Steps: 13 | Train Loss: 0.120 Vali Loss: 2.302 Vali Acc: 0.494 Test Loss: 2.302 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 464814
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7000300884246826
Epoch: 1, Steps: 13 | Train Loss: 0.841 Vali Loss: 0.702 Vali Acc: 0.489 Test Loss: 0.702 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.1107983589172363
Epoch: 2, Steps: 13 | Train Loss: 0.951 Vali Loss: 1.143 Vali Acc: 0.494 Test Loss: 1.143 Test Acc: 0.494
Validation loss decreased (-0.488882 --> -0.494433).  Saving model ...
Epoch: 3 cost time: 1.1285510063171387
Epoch: 3, Steps: 13 | Train Loss: 1.037 Vali Loss: 1.008 Vali Acc: 0.511 Test Loss: 1.008 Test Acc: 0.511
Validation loss decreased (-0.494433 --> -0.511101).  Saving model ...
Epoch: 4 cost time: 1.0692977905273438
Epoch: 4, Steps: 13 | Train Loss: 1.053 Vali Loss: 1.179 Vali Acc: 0.517 Test Loss: 1.179 Test Acc: 0.517
Validation loss decreased (-0.511101 --> -0.516655).  Saving model ...
Epoch: 5 cost time: 1.1166596412658691
Epoch: 5, Steps: 13 | Train Loss: 0.635 Vali Loss: 1.042 Vali Acc: 0.439 Test Loss: 1.042 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1453514099121094
Epoch: 6, Steps: 13 | Train Loss: 0.604 Vali Loss: 1.475 Vali Acc: 0.494 Test Loss: 1.475 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1258571147918701
Epoch: 7, Steps: 13 | Train Loss: 0.608 Vali Loss: 1.311 Vali Acc: 0.522 Test Loss: 1.311 Test Acc: 0.522
Validation loss decreased (-0.516655 --> -0.522209).  Saving model ...
Epoch: 8 cost time: 1.16483473777771
Epoch: 8, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0527141094207764
Epoch: 9, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.962 Vali Acc: 0.467 Test Loss: 1.962 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1240925788879395
Epoch: 10, Steps: 13 | Train Loss: 0.619 Vali Loss: 1.734 Vali Acc: 0.556 Test Loss: 1.734 Test Acc: 0.556
Validation loss decreased (-0.522209 --> -0.555538).  Saving model ...
Epoch: 11 cost time: 1.1027014255523682
Epoch: 11, Steps: 13 | Train Loss: 0.614 Vali Loss: 1.894 Vali Acc: 0.472 Test Loss: 1.894 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1014916896820068
Epoch: 12, Steps: 13 | Train Loss: 0.535 Vali Loss: 1.461 Vali Acc: 0.461 Test Loss: 1.461 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1162045001983643
Epoch: 13, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.557 Vali Acc: 0.478 Test Loss: 1.557 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.156641960144043
Epoch: 14, Steps: 13 | Train Loss: 0.433 Vali Loss: 2.078 Vali Acc: 0.511 Test Loss: 2.078 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9913816452026367
Epoch: 15, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.863 Vali Acc: 0.450 Test Loss: 1.863 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1870026588439941
Epoch: 16, Steps: 13 | Train Loss: 0.321 Vali Loss: 2.224 Vali Acc: 0.500 Test Loss: 2.224 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.171476125717163
Epoch: 17, Steps: 13 | Train Loss: 0.294 Vali Loss: 2.249 Vali Acc: 0.472 Test Loss: 2.249 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1517696380615234
Epoch: 18, Steps: 13 | Train Loss: 0.295 Vali Loss: 2.127 Vali Acc: 0.478 Test Loss: 2.127 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.179734468460083
Epoch: 19, Steps: 13 | Train Loss: 0.160 Vali Loss: 2.394 Vali Acc: 0.456 Test Loss: 2.394 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0975847244262695
Epoch: 20, Steps: 13 | Train Loss: 0.256 Vali Loss: 2.122 Vali Acc: 0.461 Test Loss: 2.122 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 464814
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.49855899810791
Epoch: 1, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.706 Vali Acc: 0.533 Test Loss: 0.706 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.0302846431732178
Epoch: 2, Steps: 13 | Train Loss: 0.880 Vali Loss: 0.778 Vali Acc: 0.489 Test Loss: 0.778 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9776639938354492
Epoch: 3, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.869 Vali Acc: 0.483 Test Loss: 0.869 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0085124969482422
Epoch: 4, Steps: 13 | Train Loss: 0.915 Vali Loss: 0.815 Vali Acc: 0.494 Test Loss: 0.815 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9656417369842529
Epoch: 5, Steps: 13 | Train Loss: 0.853 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9954233169555664
Epoch: 6, Steps: 13 | Train Loss: 0.973 Vali Loss: 1.478 Vali Acc: 0.483 Test Loss: 1.478 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9965593814849854
Epoch: 7, Steps: 13 | Train Loss: 1.506 Vali Loss: 3.145 Vali Acc: 0.500 Test Loss: 3.145 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9711790084838867
Epoch: 8, Steps: 13 | Train Loss: 1.343 Vali Loss: 1.517 Vali Acc: 0.528 Test Loss: 1.517 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9650187492370605
Epoch: 9, Steps: 13 | Train Loss: 0.813 Vali Loss: 1.900 Vali Acc: 0.494 Test Loss: 1.900 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0148427486419678
Epoch: 10, Steps: 13 | Train Loss: 1.226 Vali Loss: 1.389 Vali Acc: 0.539 Test Loss: 1.389 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538875).  Saving model ...
Epoch: 11 cost time: 1.007859468460083
Epoch: 11, Steps: 13 | Train Loss: 1.159 Vali Loss: 0.939 Vali Acc: 0.478 Test Loss: 0.939 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0003657341003418
Epoch: 12, Steps: 13 | Train Loss: 0.595 Vali Loss: 1.720 Vali Acc: 0.506 Test Loss: 1.720 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0829765796661377
Epoch: 13, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.208 Vali Acc: 0.511 Test Loss: 1.208 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0141661167144775
Epoch: 14, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.528 Vali Acc: 0.500 Test Loss: 1.528 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.035637617111206
Epoch: 15, Steps: 13 | Train Loss: 0.560 Vali Loss: 1.604 Vali Acc: 0.511 Test Loss: 1.604 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0037078857421875
Epoch: 16, Steps: 13 | Train Loss: 0.779 Vali Loss: 2.174 Vali Acc: 0.478 Test Loss: 2.174 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.998389720916748
Epoch: 17, Steps: 13 | Train Loss: 0.484 Vali Loss: 2.475 Vali Acc: 0.522 Test Loss: 2.475 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0070817470550537
Epoch: 18, Steps: 13 | Train Loss: 0.429 Vali Loss: 1.743 Vali Acc: 0.506 Test Loss: 1.743 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9220764636993408
Epoch: 19, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.853 Vali Acc: 0.467 Test Loss: 1.853 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0768256187438965
Epoch: 20, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.894 Vali Acc: 0.467 Test Loss: 1.894 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 464814
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8569633960723877
Epoch: 1, Steps: 13 | Train Loss: 0.852 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.1704168319702148
Epoch: 2, Steps: 13 | Train Loss: 0.807 Vali Loss: 0.950 Vali Acc: 0.517 Test Loss: 0.950 Test Acc: 0.517
Validation loss decreased (-0.499991 --> -0.516657).  Saving model ...
Epoch: 3 cost time: 1.2179067134857178
Epoch: 3, Steps: 13 | Train Loss: 0.851 Vali Loss: 1.002 Vali Acc: 0.539 Test Loss: 1.002 Test Acc: 0.539
Validation loss decreased (-0.516657 --> -0.538879).  Saving model ...
Epoch: 4 cost time: 1.1702325344085693
Epoch: 4, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.985 Vali Acc: 0.456 Test Loss: 0.985 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1789617538452148
Epoch: 5, Steps: 13 | Train Loss: 0.695 Vali Loss: 1.062 Vali Acc: 0.522 Test Loss: 1.062 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2431583404541016
Epoch: 6, Steps: 13 | Train Loss: 0.596 Vali Loss: 1.300 Vali Acc: 0.511 Test Loss: 1.300 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1073057651519775
Epoch: 7, Steps: 13 | Train Loss: 0.658 Vali Loss: 1.682 Vali Acc: 0.522 Test Loss: 1.682 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2483665943145752
Epoch: 8, Steps: 13 | Train Loss: 0.434 Vali Loss: 2.218 Vali Acc: 0.483 Test Loss: 2.218 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2573776245117188
Epoch: 9, Steps: 13 | Train Loss: 0.468 Vali Loss: 2.331 Vali Acc: 0.522 Test Loss: 2.331 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2559435367584229
Epoch: 10, Steps: 13 | Train Loss: 0.517 Vali Loss: 1.569 Vali Acc: 0.489 Test Loss: 1.569 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2343206405639648
Epoch: 11, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.865 Vali Acc: 0.528 Test Loss: 1.865 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.222078800201416
Epoch: 12, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.769 Vali Acc: 0.494 Test Loss: 1.769 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2571206092834473
Epoch: 13, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.772 Vali Acc: 0.500 Test Loss: 1.772 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 399278
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.778594732284546
Epoch: 1, Steps: 13 | Train Loss: 0.841 Vali Loss: 0.849 Vali Acc: 0.494 Test Loss: 0.849 Test Acc: 0.494
Validation loss decreased (inf --> -0.494436).  Saving model ...
Epoch: 2 cost time: 1.2390925884246826
Epoch: 2, Steps: 13 | Train Loss: 0.801 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
Validation loss decreased (-0.494436 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 1.2441039085388184
Epoch: 3, Steps: 13 | Train Loss: 0.847 Vali Loss: 0.990 Vali Acc: 0.522 Test Loss: 0.990 Test Acc: 0.522
Validation loss decreased (-0.499991 --> -0.522212).  Saving model ...
Epoch: 4 cost time: 1.2002043724060059
Epoch: 4, Steps: 13 | Train Loss: 0.809 Vali Loss: 1.110 Vali Acc: 0.444 Test Loss: 1.110 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2224705219268799
Epoch: 5, Steps: 13 | Train Loss: 0.698 Vali Loss: 1.492 Vali Acc: 0.478 Test Loss: 1.492 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2455463409423828
Epoch: 6, Steps: 13 | Train Loss: 0.605 Vali Loss: 1.284 Vali Acc: 0.472 Test Loss: 1.284 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.178344488143921
Epoch: 7, Steps: 13 | Train Loss: 0.988 Vali Loss: 2.365 Vali Acc: 0.489 Test Loss: 2.365 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2099802494049072
Epoch: 8, Steps: 13 | Train Loss: 0.977 Vali Loss: 1.840 Vali Acc: 0.461 Test Loss: 1.840 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2077395915985107
Epoch: 9, Steps: 13 | Train Loss: 0.781 Vali Loss: 1.821 Vali Acc: 0.533 Test Loss: 1.821 Test Acc: 0.533
Validation loss decreased (-0.522212 --> -0.533315).  Saving model ...
Epoch: 10 cost time: 1.1769928932189941
Epoch: 10, Steps: 13 | Train Loss: 0.801 Vali Loss: 1.448 Vali Acc: 0.456 Test Loss: 1.448 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2457506656646729
Epoch: 11, Steps: 13 | Train Loss: 0.427 Vali Loss: 1.533 Vali Acc: 0.433 Test Loss: 1.533 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.213263750076294
Epoch: 12, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.577 Vali Acc: 0.489 Test Loss: 1.577 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2555656433105469
Epoch: 13, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.745 Vali Acc: 0.461 Test Loss: 1.745 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2015175819396973
Epoch: 14, Steps: 13 | Train Loss: 0.499 Vali Loss: 1.720 Vali Acc: 0.478 Test Loss: 1.720 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.220444917678833
Epoch: 15, Steps: 13 | Train Loss: 0.302 Vali Loss: 3.000 Vali Acc: 0.506 Test Loss: 3.000 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.169654369354248
Epoch: 16, Steps: 13 | Train Loss: 0.334 Vali Loss: 2.027 Vali Acc: 0.494 Test Loss: 2.027 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2008097171783447
Epoch: 17, Steps: 13 | Train Loss: 0.264 Vali Loss: 2.184 Vali Acc: 0.444 Test Loss: 2.184 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2329201698303223
Epoch: 18, Steps: 13 | Train Loss: 0.131 Vali Loss: 2.324 Vali Acc: 0.461 Test Loss: 2.324 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2830235958099365
Epoch: 19, Steps: 13 | Train Loss: 0.136 Vali Loss: 2.422 Vali Acc: 0.478 Test Loss: 2.422 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 399278
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.837109327316284
Epoch: 1, Steps: 13 | Train Loss: 0.832 Vali Loss: 0.851 Vali Acc: 0.500 Test Loss: 0.851 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.0988194942474365
Epoch: 2, Steps: 13 | Train Loss: 0.818 Vali Loss: 0.892 Vali Acc: 0.494 Test Loss: 0.892 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1466047763824463
Epoch: 3, Steps: 13 | Train Loss: 1.001 Vali Loss: 0.830 Vali Acc: 0.506 Test Loss: 0.830 Test Acc: 0.506
Validation loss decreased (-0.499991 --> -0.505547).  Saving model ...
Epoch: 4 cost time: 1.044792890548706
Epoch: 4, Steps: 13 | Train Loss: 1.010 Vali Loss: 1.304 Vali Acc: 0.511 Test Loss: 1.304 Test Acc: 0.511
Validation loss decreased (-0.505547 --> -0.511098).  Saving model ...
Epoch: 5 cost time: 1.1243038177490234
Epoch: 5, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.935 Vali Acc: 0.494 Test Loss: 0.935 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1725785732269287
Epoch: 6, Steps: 13 | Train Loss: 0.609 Vali Loss: 1.181 Vali Acc: 0.478 Test Loss: 1.181 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1665582656860352
Epoch: 7, Steps: 13 | Train Loss: 0.821 Vali Loss: 1.853 Vali Acc: 0.489 Test Loss: 1.853 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1549768447875977
Epoch: 8, Steps: 13 | Train Loss: 1.048 Vali Loss: 2.842 Vali Acc: 0.478 Test Loss: 2.842 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.104797124862671
Epoch: 9, Steps: 13 | Train Loss: 1.321 Vali Loss: 1.256 Vali Acc: 0.433 Test Loss: 1.256 Test Acc: 0.433
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0791893005371094
Epoch: 10, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.235 Vali Acc: 0.528 Test Loss: 1.235 Test Acc: 0.528
Validation loss decreased (-0.511098 --> -0.527765).  Saving model ...
Epoch: 11 cost time: 1.0696470737457275
Epoch: 11, Steps: 13 | Train Loss: 0.361 Vali Loss: 2.039 Vali Acc: 0.478 Test Loss: 2.039 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1510984897613525
Epoch: 12, Steps: 13 | Train Loss: 0.581 Vali Loss: 1.510 Vali Acc: 0.500 Test Loss: 1.510 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0455565452575684
Epoch: 13, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.842 Vali Acc: 0.478 Test Loss: 1.842 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1060850620269775
Epoch: 14, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.931 Vali Acc: 0.461 Test Loss: 1.931 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.003722906112671
Epoch: 15, Steps: 13 | Train Loss: 0.588 Vali Loss: 1.802 Vali Acc: 0.500 Test Loss: 1.802 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1354753971099854
Epoch: 16, Steps: 13 | Train Loss: 0.546 Vali Loss: 1.972 Vali Acc: 0.483 Test Loss: 1.972 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.174776554107666
Epoch: 17, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.802 Vali Acc: 0.500 Test Loss: 1.802 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1627647876739502
Epoch: 18, Steps: 13 | Train Loss: 0.268 Vali Loss: 2.089 Vali Acc: 0.472 Test Loss: 2.089 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1341872215270996
Epoch: 19, Steps: 13 | Train Loss: 0.293 Vali Loss: 2.165 Vali Acc: 0.522 Test Loss: 2.165 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0392675399780273
Epoch: 20, Steps: 13 | Train Loss: 0.399 Vali Loss: 2.621 Vali Acc: 0.478 Test Loss: 2.621 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 399278
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.458594560623169
Epoch: 1, Steps: 13 | Train Loss: 0.813 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.0535950660705566
Epoch: 2, Steps: 13 | Train Loss: 0.799 Vali Loss: 0.838 Vali Acc: 0.511 Test Loss: 0.838 Test Acc: 0.511
Validation loss decreased (-0.499992 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 0.9947102069854736
Epoch: 3, Steps: 13 | Train Loss: 0.851 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9284870624542236
Epoch: 4, Steps: 13 | Train Loss: 1.058 Vali Loss: 0.914 Vali Acc: 0.511 Test Loss: 0.914 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9931418895721436
Epoch: 5, Steps: 13 | Train Loss: 0.859 Vali Loss: 0.904 Vali Acc: 0.528 Test Loss: 0.904 Test Acc: 0.528
Validation loss decreased (-0.511103 --> -0.527769).  Saving model ...
Epoch: 6 cost time: 0.9415149688720703
Epoch: 6, Steps: 13 | Train Loss: 0.712 Vali Loss: 1.164 Vali Acc: 0.517 Test Loss: 1.164 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9551098346710205
Epoch: 7, Steps: 13 | Train Loss: 0.948 Vali Loss: 1.172 Vali Acc: 0.544 Test Loss: 1.172 Test Acc: 0.544
Validation loss decreased (-0.527769 --> -0.544433).  Saving model ...
Epoch: 8 cost time: 0.9558849334716797
Epoch: 8, Steps: 13 | Train Loss: 0.696 Vali Loss: 1.348 Vali Acc: 0.500 Test Loss: 1.348 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9855780601501465
Epoch: 9, Steps: 13 | Train Loss: 1.002 Vali Loss: 1.448 Vali Acc: 0.539 Test Loss: 1.448 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0394539833068848
Epoch: 10, Steps: 13 | Train Loss: 0.939 Vali Loss: 2.158 Vali Acc: 0.506 Test Loss: 2.158 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0728082656860352
Epoch: 11, Steps: 13 | Train Loss: 1.116 Vali Loss: 1.076 Vali Acc: 0.494 Test Loss: 1.076 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0525765419006348
Epoch: 12, Steps: 13 | Train Loss: 0.806 Vali Loss: 1.789 Vali Acc: 0.539 Test Loss: 1.789 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.04917311668396
Epoch: 13, Steps: 13 | Train Loss: 0.618 Vali Loss: 1.309 Vali Acc: 0.467 Test Loss: 1.309 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0441575050354004
Epoch: 14, Steps: 13 | Train Loss: 0.531 Vali Loss: 2.125 Vali Acc: 0.528 Test Loss: 2.125 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.007045030593872
Epoch: 15, Steps: 13 | Train Loss: 0.711 Vali Loss: 1.302 Vali Acc: 0.517 Test Loss: 1.302 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0336546897888184
Epoch: 16, Steps: 13 | Train Loss: 1.101 Vali Loss: 3.635 Vali Acc: 0.483 Test Loss: 3.635 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0173273086547852
Epoch: 17, Steps: 13 | Train Loss: 1.765 Vali Loss: 2.556 Vali Acc: 0.522 Test Loss: 2.556 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 399278
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.931854486465454
Epoch: 1, Steps: 13 | Train Loss: 0.809 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.251119613647461
Epoch: 2, Steps: 13 | Train Loss: 0.804 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549991).  Saving model ...
Epoch: 3 cost time: 1.244837999343872
Epoch: 3, Steps: 13 | Train Loss: 0.657 Vali Loss: 1.250 Vali Acc: 0.483 Test Loss: 1.250 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2512843608856201
Epoch: 4, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.889 Vali Acc: 0.533 Test Loss: 0.889 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2521967887878418
Epoch: 5, Steps: 13 | Train Loss: 0.587 Vali Loss: 1.018 Vali Acc: 0.500 Test Loss: 1.018 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2565646171569824
Epoch: 6, Steps: 13 | Train Loss: 0.678 Vali Loss: 1.447 Vali Acc: 0.511 Test Loss: 1.447 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2996842861175537
Epoch: 7, Steps: 13 | Train Loss: 0.567 Vali Loss: 2.073 Vali Acc: 0.467 Test Loss: 2.073 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.222780704498291
Epoch: 8, Steps: 13 | Train Loss: 0.639 Vali Loss: 1.561 Vali Acc: 0.539 Test Loss: 1.561 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.308835744857788
Epoch: 9, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.781 Vali Acc: 0.472 Test Loss: 1.781 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2506582736968994
Epoch: 10, Steps: 13 | Train Loss: 0.314 Vali Loss: 2.170 Vali Acc: 0.511 Test Loss: 2.170 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2359778881072998
Epoch: 11, Steps: 13 | Train Loss: 0.544 Vali Loss: 1.901 Vali Acc: 0.506 Test Loss: 1.901 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.268110752105713
Epoch: 12, Steps: 13 | Train Loss: 0.971 Vali Loss: 2.370 Vali Acc: 0.494 Test Loss: 2.370 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 366510
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.631803035736084
Epoch: 1, Steps: 13 | Train Loss: 0.813 Vali Loss: 0.741 Vali Acc: 0.489 Test Loss: 0.741 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.138932228088379
Epoch: 2, Steps: 13 | Train Loss: 0.839 Vali Loss: 0.900 Vali Acc: 0.539 Test Loss: 0.900 Test Acc: 0.539
Validation loss decreased (-0.488881 --> -0.538880).  Saving model ...
Epoch: 3 cost time: 1.1581997871398926
Epoch: 3, Steps: 13 | Train Loss: 0.657 Vali Loss: 1.169 Vali Acc: 0.483 Test Loss: 1.169 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.238295078277588
Epoch: 4, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.891 Vali Acc: 0.522 Test Loss: 0.891 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1698837280273438
Epoch: 5, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.064 Vali Acc: 0.550 Test Loss: 1.064 Test Acc: 0.550
Validation loss decreased (-0.538880 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 1.2043211460113525
Epoch: 6, Steps: 13 | Train Loss: 0.841 Vali Loss: 1.615 Vali Acc: 0.506 Test Loss: 1.615 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.212116003036499
Epoch: 7, Steps: 13 | Train Loss: 0.570 Vali Loss: 1.224 Vali Acc: 0.506 Test Loss: 1.224 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2253828048706055
Epoch: 8, Steps: 13 | Train Loss: 0.560 Vali Loss: 1.407 Vali Acc: 0.467 Test Loss: 1.407 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.190875768661499
Epoch: 9, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.183 Vali Acc: 0.528 Test Loss: 1.183 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1819140911102295
Epoch: 10, Steps: 13 | Train Loss: 0.356 Vali Loss: 2.151 Vali Acc: 0.494 Test Loss: 2.151 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1771457195281982
Epoch: 11, Steps: 13 | Train Loss: 1.017 Vali Loss: 1.562 Vali Acc: 0.506 Test Loss: 1.562 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2068138122558594
Epoch: 12, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.655 Vali Acc: 0.444 Test Loss: 1.655 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.242112159729004
Epoch: 13, Steps: 13 | Train Loss: 0.522 Vali Loss: 1.919 Vali Acc: 0.506 Test Loss: 1.919 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2371273040771484
Epoch: 14, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.800 Vali Acc: 0.494 Test Loss: 1.800 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.228156328201294
Epoch: 15, Steps: 13 | Train Loss: 0.615 Vali Loss: 2.324 Vali Acc: 0.489 Test Loss: 2.324 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 366510
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.841592788696289
Epoch: 1, Steps: 13 | Train Loss: 0.823 Vali Loss: 0.821 Vali Acc: 0.506 Test Loss: 0.821 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 1.1475911140441895
Epoch: 2, Steps: 13 | Train Loss: 0.821 Vali Loss: 0.851 Vali Acc: 0.489 Test Loss: 0.851 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1895158290863037
Epoch: 3, Steps: 13 | Train Loss: 0.715 Vali Loss: 1.096 Vali Acc: 0.483 Test Loss: 1.096 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1642208099365234
Epoch: 4, Steps: 13 | Train Loss: 0.869 Vali Loss: 0.848 Vali Acc: 0.456 Test Loss: 0.848 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1845812797546387
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.990 Vali Acc: 0.483 Test Loss: 0.990 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1660418510437012
Epoch: 6, Steps: 13 | Train Loss: 0.832 Vali Loss: 1.571 Vali Acc: 0.483 Test Loss: 1.571 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1182842254638672
Epoch: 7, Steps: 13 | Train Loss: 0.657 Vali Loss: 1.398 Vali Acc: 0.467 Test Loss: 1.398 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1525280475616455
Epoch: 8, Steps: 13 | Train Loss: 0.629 Vali Loss: 1.495 Vali Acc: 0.522 Test Loss: 1.495 Test Acc: 0.522
Validation loss decreased (-0.505547 --> -0.522207).  Saving model ...
Epoch: 9 cost time: 1.1339850425720215
Epoch: 9, Steps: 13 | Train Loss: 0.549 Vali Loss: 1.569 Vali Acc: 0.506 Test Loss: 1.569 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0034856796264648
Epoch: 10, Steps: 13 | Train Loss: 0.788 Vali Loss: 1.544 Vali Acc: 0.467 Test Loss: 1.544 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1376519203186035
Epoch: 11, Steps: 13 | Train Loss: 0.819 Vali Loss: 2.147 Vali Acc: 0.500 Test Loss: 2.147 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.158092737197876
Epoch: 12, Steps: 13 | Train Loss: 1.092 Vali Loss: 2.405 Vali Acc: 0.494 Test Loss: 2.405 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0917174816131592
Epoch: 13, Steps: 13 | Train Loss: 1.026 Vali Loss: 2.081 Vali Acc: 0.506 Test Loss: 2.081 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1674246788024902
Epoch: 14, Steps: 13 | Train Loss: 0.503 Vali Loss: 1.684 Vali Acc: 0.467 Test Loss: 1.684 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1952159404754639
Epoch: 15, Steps: 13 | Train Loss: 0.565 Vali Loss: 1.818 Vali Acc: 0.483 Test Loss: 1.818 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1858103275299072
Epoch: 16, Steps: 13 | Train Loss: 0.314 Vali Loss: 2.075 Vali Acc: 0.456 Test Loss: 2.075 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1286001205444336
Epoch: 17, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.996 Vali Acc: 0.456 Test Loss: 1.996 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0645420551300049
Epoch: 18, Steps: 13 | Train Loss: 0.710 Vali Loss: 2.232 Vali Acc: 0.544 Test Loss: 2.232 Test Acc: 0.544
Validation loss decreased (-0.522207 --> -0.544422).  Saving model ...
Epoch: 19 cost time: 1.0471084117889404
Epoch: 19, Steps: 13 | Train Loss: 0.290 Vali Loss: 2.405 Vali Acc: 0.494 Test Loss: 2.405 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1383283138275146
Epoch: 20, Steps: 13 | Train Loss: 0.221 Vali Loss: 2.736 Vali Acc: 0.450 Test Loss: 2.736 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1162917613983154
Epoch: 21, Steps: 13 | Train Loss: 0.119 Vali Loss: 2.726 Vali Acc: 0.539 Test Loss: 2.726 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0986511707305908
Epoch: 22, Steps: 13 | Train Loss: 0.366 Vali Loss: 3.741 Vali Acc: 0.478 Test Loss: 3.741 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0792486667633057
Epoch: 23, Steps: 13 | Train Loss: 0.177 Vali Loss: 2.715 Vali Acc: 0.450 Test Loss: 2.715 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1296565532684326
Epoch: 24, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.565 Vali Acc: 0.467 Test Loss: 2.565 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1295084953308105
Epoch: 25, Steps: 13 | Train Loss: 0.046 Vali Loss: 3.358 Vali Acc: 0.489 Test Loss: 3.358 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1171720027923584
Epoch: 26, Steps: 13 | Train Loss: 0.078 Vali Loss: 3.156 Vali Acc: 0.467 Test Loss: 3.156 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1272296905517578
Epoch: 27, Steps: 13 | Train Loss: 0.168 Vali Loss: 3.540 Vali Acc: 0.494 Test Loss: 3.540 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1645619869232178
Epoch: 28, Steps: 13 | Train Loss: 0.227 Vali Loss: 3.952 Vali Acc: 0.461 Test Loss: 3.952 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 366510
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6734859943389893
Epoch: 1, Steps: 13 | Train Loss: 0.810 Vali Loss: 0.818 Vali Acc: 0.500 Test Loss: 0.818 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 0.999392032623291
Epoch: 2, Steps: 13 | Train Loss: 0.820 Vali Loss: 0.844 Vali Acc: 0.533 Test Loss: 0.844 Test Acc: 0.533
Validation loss decreased (-0.499992 --> -0.533325).  Saving model ...
Epoch: 3 cost time: 1.0617024898529053
Epoch: 3, Steps: 13 | Train Loss: 0.822 Vali Loss: 0.858 Vali Acc: 0.528 Test Loss: 0.858 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.024395227432251
Epoch: 4, Steps: 13 | Train Loss: 0.867 Vali Loss: 0.941 Vali Acc: 0.561 Test Loss: 0.941 Test Acc: 0.561
Validation loss decreased (-0.533325 --> -0.561102).  Saving model ...
Epoch: 5 cost time: 1.041827917098999
Epoch: 5, Steps: 13 | Train Loss: 0.912 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0340063571929932
Epoch: 6, Steps: 13 | Train Loss: 0.643 Vali Loss: 1.076 Vali Acc: 0.494 Test Loss: 1.076 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0150184631347656
Epoch: 7, Steps: 13 | Train Loss: 0.880 Vali Loss: 1.232 Vali Acc: 0.483 Test Loss: 1.232 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9925861358642578
Epoch: 8, Steps: 13 | Train Loss: 0.772 Vali Loss: 1.067 Vali Acc: 0.528 Test Loss: 1.067 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9566054344177246
Epoch: 9, Steps: 13 | Train Loss: 0.561 Vali Loss: 1.325 Vali Acc: 0.522 Test Loss: 1.325 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9721040725708008
Epoch: 10, Steps: 13 | Train Loss: 0.786 Vali Loss: 1.481 Vali Acc: 0.517 Test Loss: 1.481 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9122200012207031
Epoch: 11, Steps: 13 | Train Loss: 0.581 Vali Loss: 1.092 Vali Acc: 0.522 Test Loss: 1.092 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0198023319244385
Epoch: 12, Steps: 13 | Train Loss: 0.653 Vali Loss: 1.601 Vali Acc: 0.539 Test Loss: 1.601 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.009350061416626
Epoch: 13, Steps: 13 | Train Loss: 0.444 Vali Loss: 1.440 Vali Acc: 0.511 Test Loss: 1.440 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9907996654510498
Epoch: 14, Steps: 13 | Train Loss: 0.545 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 366510
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.87092661857605
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.807 Vali Acc: 0.478 Test Loss: 0.807 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.2573792934417725
Epoch: 2, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.764 Vali Acc: 0.517 Test Loss: 0.764 Test Acc: 0.517
Validation loss decreased (-0.477770 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.245635747909546
Epoch: 3, Steps: 13 | Train Loss: 0.758 Vali Loss: 1.395 Vali Acc: 0.511 Test Loss: 1.395 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.288621187210083
Epoch: 4, Steps: 13 | Train Loss: 0.686 Vali Loss: 1.973 Vali Acc: 0.500 Test Loss: 1.973 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.271238088607788
Epoch: 5, Steps: 13 | Train Loss: 0.778 Vali Loss: 1.353 Vali Acc: 0.533 Test Loss: 1.353 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533320).  Saving model ...
Epoch: 6 cost time: 1.2035748958587646
Epoch: 6, Steps: 13 | Train Loss: 0.567 Vali Loss: 1.327 Vali Acc: 0.511 Test Loss: 1.327 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2494792938232422
Epoch: 7, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.847 Vali Acc: 0.478 Test Loss: 1.847 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2488338947296143
Epoch: 8, Steps: 13 | Train Loss: 0.564 Vali Loss: 1.451 Vali Acc: 0.528 Test Loss: 1.451 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.281050682067871
Epoch: 9, Steps: 13 | Train Loss: 0.410 Vali Loss: 2.155 Vali Acc: 0.483 Test Loss: 2.155 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.295424222946167
Epoch: 10, Steps: 13 | Train Loss: 0.612 Vali Loss: 2.555 Vali Acc: 0.489 Test Loss: 2.555 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3161585330963135
Epoch: 11, Steps: 13 | Train Loss: 0.717 Vali Loss: 1.937 Vali Acc: 0.511 Test Loss: 1.937 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2434215545654297
Epoch: 12, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.637 Vali Acc: 0.533 Test Loss: 1.637 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.260805368423462
Epoch: 13, Steps: 13 | Train Loss: 0.267 Vali Loss: 2.406 Vali Acc: 0.472 Test Loss: 2.406 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.242185354232788
Epoch: 14, Steps: 13 | Train Loss: 0.397 Vali Loss: 2.092 Vali Acc: 0.472 Test Loss: 2.092 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2600295543670654
Epoch: 15, Steps: 13 | Train Loss: 0.181 Vali Loss: 2.689 Vali Acc: 0.494 Test Loss: 2.689 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 350126
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.67928147315979
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.822 Vali Acc: 0.489 Test Loss: 0.822 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.1886000633239746
Epoch: 2, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.750 Vali Acc: 0.533 Test Loss: 0.750 Test Acc: 0.533
Validation loss decreased (-0.488881 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.2148358821868896
Epoch: 3, Steps: 13 | Train Loss: 0.746 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.182591438293457
Epoch: 4, Steps: 13 | Train Loss: 0.771 Vali Loss: 1.772 Vali Acc: 0.500 Test Loss: 1.772 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.199568748474121
Epoch: 5, Steps: 13 | Train Loss: 0.893 Vali Loss: 1.665 Vali Acc: 0.511 Test Loss: 1.665 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1910665035247803
Epoch: 6, Steps: 13 | Train Loss: 1.029 Vali Loss: 1.050 Vali Acc: 0.478 Test Loss: 1.050 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1833703517913818
Epoch: 7, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.100 Vali Acc: 0.511 Test Loss: 1.100 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.173091173171997
Epoch: 8, Steps: 13 | Train Loss: 0.588 Vali Loss: 1.251 Vali Acc: 0.528 Test Loss: 1.251 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2402806282043457
Epoch: 9, Steps: 13 | Train Loss: 0.505 Vali Loss: 1.638 Vali Acc: 0.494 Test Loss: 1.638 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2043352127075195
Epoch: 10, Steps: 13 | Train Loss: 0.632 Vali Loss: 1.553 Vali Acc: 0.528 Test Loss: 1.553 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.246638298034668
Epoch: 11, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.803 Vali Acc: 0.472 Test Loss: 1.803 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1395580768585205
Epoch: 12, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.659 Vali Acc: 0.517 Test Loss: 1.659 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 350126
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.765589475631714
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.820 Vali Acc: 0.494 Test Loss: 0.820 Test Acc: 0.494
Validation loss decreased (inf --> -0.494436).  Saving model ...
Epoch: 2 cost time: 1.0985288619995117
Epoch: 2, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.747 Vali Acc: 0.467 Test Loss: 0.747 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.132549524307251
Epoch: 3, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.869 Vali Acc: 0.472 Test Loss: 0.869 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1841700077056885
Epoch: 4, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.900 Vali Acc: 0.478 Test Loss: 0.900 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.114173173904419
Epoch: 5, Steps: 13 | Train Loss: 0.633 Vali Loss: 1.223 Vali Acc: 0.544 Test Loss: 1.223 Test Acc: 0.544
Validation loss decreased (-0.494436 --> -0.544432).  Saving model ...
Epoch: 6 cost time: 1.1656992435455322
Epoch: 6, Steps: 13 | Train Loss: 0.534 Vali Loss: 1.358 Vali Acc: 0.494 Test Loss: 1.358 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1725459098815918
Epoch: 7, Steps: 13 | Train Loss: 0.440 Vali Loss: 1.568 Vali Acc: 0.500 Test Loss: 1.568 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.134500503540039
Epoch: 8, Steps: 13 | Train Loss: 0.776 Vali Loss: 1.581 Vali Acc: 0.511 Test Loss: 1.581 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1144189834594727
Epoch: 9, Steps: 13 | Train Loss: 0.557 Vali Loss: 1.787 Vali Acc: 0.450 Test Loss: 1.787 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1409716606140137
Epoch: 10, Steps: 13 | Train Loss: 0.840 Vali Loss: 1.684 Vali Acc: 0.539 Test Loss: 1.684 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1018574237823486
Epoch: 11, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.645 Vali Acc: 0.489 Test Loss: 1.645 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1408319473266602
Epoch: 12, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.383 Vali Acc: 0.433 Test Loss: 1.383 Test Acc: 0.433
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1827385425567627
Epoch: 13, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.370 Vali Acc: 0.494 Test Loss: 1.370 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1459152698516846
Epoch: 14, Steps: 13 | Train Loss: 0.463 Vali Loss: 1.783 Vali Acc: 0.478 Test Loss: 1.783 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1525251865386963
Epoch: 15, Steps: 13 | Train Loss: 0.370 Vali Loss: 2.339 Vali Acc: 0.489 Test Loss: 2.339 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 350126
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.637068271636963
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.823 Vali Acc: 0.506 Test Loss: 0.823 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 0.9612467288970947
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.755 Vali Acc: 0.539 Test Loss: 0.755 Test Acc: 0.539
Validation loss decreased (-0.505547 --> -0.538881).  Saving model ...
Epoch: 3 cost time: 1.0536282062530518
Epoch: 3, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.855 Vali Acc: 0.511 Test Loss: 0.855 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0106773376464844
Epoch: 4, Steps: 13 | Train Loss: 0.723 Vali Loss: 1.036 Vali Acc: 0.522 Test Loss: 1.036 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0130059719085693
Epoch: 5, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.825 Vali Acc: 0.539 Test Loss: 0.825 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9538159370422363
Epoch: 6, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.787 Vali Acc: 0.528 Test Loss: 0.787 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9573276042938232
Epoch: 7, Steps: 13 | Train Loss: 0.558 Vali Loss: 1.034 Vali Acc: 0.506 Test Loss: 1.034 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0024333000183105
Epoch: 8, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.931 Vali Acc: 0.494 Test Loss: 0.931 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.008418083190918
Epoch: 9, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.979 Vali Acc: 0.511 Test Loss: 0.979 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9628810882568359
Epoch: 10, Steps: 13 | Train Loss: 0.806 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9970009326934814
Epoch: 11, Steps: 13 | Train Loss: 0.687 Vali Loss: 1.450 Vali Acc: 0.522 Test Loss: 1.450 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9539461135864258
Epoch: 12, Steps: 13 | Train Loss: 0.581 Vali Loss: 1.525 Vali Acc: 0.517 Test Loss: 1.525 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 350126
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6899123191833496
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.721 Vali Acc: 0.467 Test Loss: 0.721 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 1.0420923233032227
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.741 Vali Acc: 0.494 Test Loss: 0.741 Test Acc: 0.494
Validation loss decreased (-0.466659 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.0379910469055176
Epoch: 3, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.805 Vali Acc: 0.494 Test Loss: 0.805 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0573909282684326
Epoch: 4, Steps: 13 | Train Loss: 0.605 Vali Loss: 1.244 Vali Acc: 0.511 Test Loss: 1.244 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511099).  Saving model ...
Epoch: 5 cost time: 1.0338640213012695
Epoch: 5, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.939 Vali Acc: 0.500 Test Loss: 0.939 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0007812976837158
Epoch: 6, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.934 Vali Acc: 0.517 Test Loss: 0.934 Test Acc: 0.517
Validation loss decreased (-0.511099 --> -0.516657).  Saving model ...
Epoch: 7 cost time: 1.0230278968811035
Epoch: 7, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.971 Vali Acc: 0.483 Test Loss: 0.971 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0151453018188477
Epoch: 8, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.987 Vali Acc: 0.489 Test Loss: 0.987 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.026573896408081
Epoch: 9, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.201 Vali Acc: 0.478 Test Loss: 1.201 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.156306266784668
Epoch: 10, Steps: 13 | Train Loss: 0.478 Vali Loss: 1.069 Vali Acc: 0.517 Test Loss: 1.069 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0918407440185547
Epoch: 11, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.337 Vali Acc: 0.500 Test Loss: 1.337 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.083205223083496
Epoch: 12, Steps: 13 | Train Loss: 0.377 Vali Loss: 1.275 Vali Acc: 0.461 Test Loss: 1.275 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9614944458007812
Epoch: 13, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.270 Vali Acc: 0.472 Test Loss: 1.270 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.001671552658081
Epoch: 14, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.486 Vali Acc: 0.467 Test Loss: 1.486 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9128556251525879
Epoch: 15, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.521 Vali Acc: 0.494 Test Loss: 1.521 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9560461044311523
Epoch: 16, Steps: 13 | Train Loss: 0.236 Vali Loss: 2.101 Vali Acc: 0.472 Test Loss: 2.101 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 420846
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.700119733810425
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.714 Vali Acc: 0.483 Test Loss: 0.714 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.1237714290618896
Epoch: 2, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.739 Vali Acc: 0.461 Test Loss: 0.739 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.00254225730896
Epoch: 3, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.753 Vali Acc: 0.450 Test Loss: 0.753 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0379245281219482
Epoch: 4, Steps: 13 | Train Loss: 0.601 Vali Loss: 1.223 Vali Acc: 0.517 Test Loss: 1.223 Test Acc: 0.517
Validation loss decreased (-0.483326 --> -0.516654).  Saving model ...
Epoch: 5 cost time: 0.9754254817962646
Epoch: 5, Steps: 13 | Train Loss: 0.818 Vali Loss: 1.008 Vali Acc: 0.489 Test Loss: 1.008 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0204448699951172
Epoch: 6, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.911 Vali Acc: 0.522 Test Loss: 0.911 Test Acc: 0.522
Validation loss decreased (-0.516654 --> -0.522213).  Saving model ...
Epoch: 7 cost time: 1.0305309295654297
Epoch: 7, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.950 Vali Acc: 0.506 Test Loss: 0.950 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.049802303314209
Epoch: 8, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.921 Vali Acc: 0.511 Test Loss: 0.921 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.020033359527588
Epoch: 9, Steps: 13 | Train Loss: 0.453 Vali Loss: 1.345 Vali Acc: 0.478 Test Loss: 1.345 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0321383476257324
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 1.042 Vali Acc: 0.511 Test Loss: 1.042 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0419385433197021
Epoch: 11, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.446 Vali Acc: 0.478 Test Loss: 1.446 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0568273067474365
Epoch: 12, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.277 Vali Acc: 0.533 Test Loss: 1.277 Test Acc: 0.533
Validation loss decreased (-0.522213 --> -0.533321).  Saving model ...
Epoch: 13 cost time: 0.9398846626281738
Epoch: 13, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.188 Vali Acc: 0.511 Test Loss: 1.188 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0091373920440674
Epoch: 14, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.266 Vali Acc: 0.528 Test Loss: 1.266 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0606944561004639
Epoch: 15, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.250 Vali Acc: 0.494 Test Loss: 1.250 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.009427785873413
Epoch: 16, Steps: 13 | Train Loss: 0.202 Vali Loss: 1.256 Vali Acc: 0.506 Test Loss: 1.256 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0491647720336914
Epoch: 17, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.367 Vali Acc: 0.522 Test Loss: 1.367 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0305521488189697
Epoch: 18, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.337 Vali Acc: 0.522 Test Loss: 1.337 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0457756519317627
Epoch: 19, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.439 Vali Acc: 0.461 Test Loss: 1.439 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0015451908111572
Epoch: 20, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.100 Vali Acc: 0.494 Test Loss: 2.100 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1551032066345215
Epoch: 21, Steps: 13 | Train Loss: 0.401 Vali Loss: 1.597 Vali Acc: 0.467 Test Loss: 1.597 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0657436847686768
Epoch: 22, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.590 Vali Acc: 0.489 Test Loss: 1.590 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 420846
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.45204496383667
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.713 Vali Acc: 0.489 Test Loss: 0.713 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 0.9143447875976562
Epoch: 2, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.734 Vali Acc: 0.517 Test Loss: 0.734 Test Acc: 0.517
Validation loss decreased (-0.488882 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 0.8832278251647949
Epoch: 3, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.740 Vali Acc: 0.489 Test Loss: 0.740 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9387533664703369
Epoch: 4, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.923 Vali Acc: 0.489 Test Loss: 0.923 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9554979801177979
Epoch: 5, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.775 Vali Acc: 0.450 Test Loss: 0.775 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.984654426574707
Epoch: 6, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.969 Vali Acc: 0.539 Test Loss: 0.969 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538879).  Saving model ...
Epoch: 7 cost time: 0.8907647132873535
Epoch: 7, Steps: 13 | Train Loss: 0.676 Vali Loss: 1.006 Vali Acc: 0.544 Test Loss: 1.006 Test Acc: 0.544
Validation loss decreased (-0.538879 --> -0.544434).  Saving model ...
Epoch: 8 cost time: 0.8975350856781006
Epoch: 8, Steps: 13 | Train Loss: 0.625 Vali Loss: 1.000 Vali Acc: 0.489 Test Loss: 1.000 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9314687252044678
Epoch: 9, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9283843040466309
Epoch: 10, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.990 Vali Acc: 0.500 Test Loss: 0.990 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.986260175704956
Epoch: 11, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9072613716125488
Epoch: 12, Steps: 13 | Train Loss: 0.438 Vali Loss: 1.192 Vali Acc: 0.550 Test Loss: 1.192 Test Acc: 0.550
Validation loss decreased (-0.544434 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.9237878322601318
Epoch: 13, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.102 Vali Acc: 0.556 Test Loss: 1.102 Test Acc: 0.556
Validation loss decreased (-0.549988 --> -0.555545).  Saving model ...
Epoch: 14 cost time: 0.8964328765869141
Epoch: 14, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.330 Vali Acc: 0.483 Test Loss: 1.330 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8598153591156006
Epoch: 15, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.205 Vali Acc: 0.467 Test Loss: 1.205 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.977649450302124
Epoch: 16, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9458489418029785
Epoch: 17, Steps: 13 | Train Loss: 0.228 Vali Loss: 2.138 Vali Acc: 0.522 Test Loss: 2.138 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9578783512115479
Epoch: 18, Steps: 13 | Train Loss: 0.453 Vali Loss: 1.472 Vali Acc: 0.561 Test Loss: 1.472 Test Acc: 0.561
Validation loss decreased (-0.555545 --> -0.561096).  Saving model ...
Epoch: 19 cost time: 0.9378328323364258
Epoch: 19, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.610 Vali Acc: 0.444 Test Loss: 1.610 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9516861438751221
Epoch: 20, Steps: 13 | Train Loss: 0.168 Vali Loss: 2.246 Vali Acc: 0.556 Test Loss: 2.246 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9426314830780029
Epoch: 21, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.462 Vali Acc: 0.533 Test Loss: 1.462 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9294323921203613
Epoch: 22, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.460 Vali Acc: 0.494 Test Loss: 1.460 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.938560962677002
Epoch: 23, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.798 Vali Acc: 0.494 Test Loss: 1.798 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9391806125640869
Epoch: 24, Steps: 13 | Train Loss: 0.179 Vali Loss: 2.180 Vali Acc: 0.483 Test Loss: 2.180 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.890270471572876
Epoch: 25, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.838 Vali Acc: 0.539 Test Loss: 1.838 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9362514019012451
Epoch: 26, Steps: 13 | Train Loss: 0.135 Vali Loss: 2.062 Vali Acc: 0.456 Test Loss: 2.062 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9092085361480713
Epoch: 27, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.901 Vali Acc: 0.433 Test Loss: 1.901 Test Acc: 0.433
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8626744747161865
Epoch: 28, Steps: 13 | Train Loss: 0.079 Vali Loss: 2.143 Vali Acc: 0.439 Test Loss: 2.143 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 420846
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.521493911743164
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.714 Vali Acc: 0.494 Test Loss: 0.714 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.9201705455780029
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.709 Vali Acc: 0.517 Test Loss: 0.709 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 0.9039864540100098
Epoch: 3, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.709 Vali Acc: 0.517 Test Loss: 0.709 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8856685161590576
Epoch: 4, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.824 Vali Acc: 0.517 Test Loss: 0.824 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8477880954742432
Epoch: 5, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.756 Vali Acc: 0.517 Test Loss: 0.756 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9244873523712158
Epoch: 6, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.952 Vali Acc: 0.539 Test Loss: 0.952 Test Acc: 0.539
Validation loss decreased (-0.516660 --> -0.538879).  Saving model ...
Epoch: 7 cost time: 0.9386570453643799
Epoch: 7, Steps: 13 | Train Loss: 0.812 Vali Loss: 0.890 Vali Acc: 0.539 Test Loss: 0.890 Test Acc: 0.539
Validation loss decreased (-0.538879 --> -0.538880).  Saving model ...
Epoch: 8 cost time: 0.913231611251831
Epoch: 8, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.830 Vali Acc: 0.517 Test Loss: 0.830 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9106531143188477
Epoch: 9, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.992 Vali Acc: 0.528 Test Loss: 0.992 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8938164710998535
Epoch: 10, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.816 Vali Acc: 0.494 Test Loss: 0.816 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9157581329345703
Epoch: 11, Steps: 13 | Train Loss: 0.523 Vali Loss: 1.163 Vali Acc: 0.456 Test Loss: 1.163 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9201722145080566
Epoch: 12, Steps: 13 | Train Loss: 0.578 Vali Loss: 1.591 Vali Acc: 0.539 Test Loss: 1.591 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9170806407928467
Epoch: 13, Steps: 13 | Train Loss: 0.894 Vali Loss: 0.975 Vali Acc: 0.522 Test Loss: 0.975 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8792316913604736
Epoch: 14, Steps: 13 | Train Loss: 0.592 Vali Loss: 1.233 Vali Acc: 0.478 Test Loss: 1.233 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9705348014831543
Epoch: 15, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.003 Vali Acc: 0.506 Test Loss: 1.003 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9173874855041504
Epoch: 16, Steps: 13 | Train Loss: 0.742 Vali Loss: 1.538 Vali Acc: 0.539 Test Loss: 1.538 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9030454158782959
Epoch: 17, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.948 Vali Acc: 0.506 Test Loss: 0.948 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 420846
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.554257392883301
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.731 Vali Acc: 0.483 Test Loss: 0.731 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.0083460807800293
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.807 Vali Acc: 0.517 Test Loss: 0.807 Test Acc: 0.517
Validation loss decreased (-0.483326 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 0.9688758850097656
Epoch: 3, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.742 Vali Acc: 0.533 Test Loss: 0.742 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.0076239109039307
Epoch: 4, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.936 Vali Acc: 0.517 Test Loss: 0.936 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0114529132843018
Epoch: 5, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.870 Vali Acc: 0.544 Test Loss: 0.870 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544436).  Saving model ...
Epoch: 6 cost time: 1.0392706394195557
Epoch: 6, Steps: 13 | Train Loss: 0.501 Vali Loss: 1.054 Vali Acc: 0.522 Test Loss: 1.054 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.091895580291748
Epoch: 7, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.930 Vali Acc: 0.550 Test Loss: 0.930 Test Acc: 0.550
Validation loss decreased (-0.544436 --> -0.549991).  Saving model ...
Epoch: 8 cost time: 0.986076831817627
Epoch: 8, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.302 Vali Acc: 0.511 Test Loss: 1.302 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.038034439086914
Epoch: 9, Steps: 13 | Train Loss: 0.752 Vali Loss: 1.490 Vali Acc: 0.494 Test Loss: 1.490 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.004317045211792
Epoch: 10, Steps: 13 | Train Loss: 0.582 Vali Loss: 1.234 Vali Acc: 0.550 Test Loss: 1.234 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0176606178283691
Epoch: 11, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.234 Vali Acc: 0.511 Test Loss: 1.234 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0154571533203125
Epoch: 12, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.677 Vali Acc: 0.483 Test Loss: 1.677 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.003208875656128
Epoch: 13, Steps: 13 | Train Loss: 0.463 Vali Loss: 1.446 Vali Acc: 0.506 Test Loss: 1.446 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9341135025024414
Epoch: 14, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.780 Vali Acc: 0.517 Test Loss: 1.780 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.015838384628296
Epoch: 15, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.495 Vali Acc: 0.528 Test Loss: 1.495 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0188064575195312
Epoch: 16, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.540 Vali Acc: 0.500 Test Loss: 1.540 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9778974056243896
Epoch: 17, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.546 Vali Acc: 0.483 Test Loss: 1.546 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 289774
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4656660556793213
Epoch: 1, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.724 Vali Acc: 0.483 Test Loss: 0.724 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 0.8936891555786133
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.810 Vali Acc: 0.528 Test Loss: 0.810 Test Acc: 0.528
Validation loss decreased (-0.483326 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 0.8737204074859619
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.738 Vali Acc: 0.528 Test Loss: 0.738 Test Acc: 0.528
Validation loss decreased (-0.527770 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 0.8955979347229004
Epoch: 4, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.909 Vali Acc: 0.544 Test Loss: 0.909 Test Acc: 0.544
Validation loss decreased (-0.527770 --> -0.544435).  Saving model ...
Epoch: 5 cost time: 0.9042272567749023
Epoch: 5, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.858 Vali Acc: 0.522 Test Loss: 0.858 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9291832447052002
Epoch: 6, Steps: 13 | Train Loss: 0.526 Vali Loss: 1.137 Vali Acc: 0.511 Test Loss: 1.137 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9845476150512695
Epoch: 7, Steps: 13 | Train Loss: 0.700 Vali Loss: 1.029 Vali Acc: 0.528 Test Loss: 1.029 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9412059783935547
Epoch: 8, Steps: 13 | Train Loss: 0.780 Vali Loss: 1.017 Vali Acc: 0.539 Test Loss: 1.017 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9044513702392578
Epoch: 9, Steps: 13 | Train Loss: 0.859 Vali Loss: 1.711 Vali Acc: 0.483 Test Loss: 1.711 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9688453674316406
Epoch: 10, Steps: 13 | Train Loss: 0.706 Vali Loss: 1.653 Vali Acc: 0.494 Test Loss: 1.653 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9617383480072021
Epoch: 11, Steps: 13 | Train Loss: 0.501 Vali Loss: 1.526 Vali Acc: 0.533 Test Loss: 1.526 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9210860729217529
Epoch: 12, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.458 Vali Acc: 0.472 Test Loss: 1.458 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9315586090087891
Epoch: 13, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.422 Vali Acc: 0.483 Test Loss: 1.422 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8636953830718994
Epoch: 14, Steps: 13 | Train Loss: 0.419 Vali Loss: 1.197 Vali Acc: 0.494 Test Loss: 1.197 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 289774
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4924380779266357
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.714 Vali Acc: 0.528 Test Loss: 0.714 Test Acc: 0.528
Validation loss decreased (inf --> -0.527771).  Saving model ...
Epoch: 2 cost time: 0.915691614151001
Epoch: 2, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.813 Vali Acc: 0.517 Test Loss: 0.813 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8994886875152588
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.718 Vali Acc: 0.544 Test Loss: 0.718 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 0.8366262912750244
Epoch: 4, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.962 Vali Acc: 0.506 Test Loss: 0.962 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8952295780181885
Epoch: 5, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.842 Vali Acc: 0.517 Test Loss: 0.842 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8819186687469482
Epoch: 6, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.927 Vali Acc: 0.511 Test Loss: 0.927 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.992734432220459
Epoch: 7, Steps: 13 | Train Loss: 0.515 Vali Loss: 1.015 Vali Acc: 0.483 Test Loss: 1.015 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9067697525024414
Epoch: 8, Steps: 13 | Train Loss: 0.619 Vali Loss: 1.118 Vali Acc: 0.494 Test Loss: 1.118 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.90380859375
Epoch: 9, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.948 Vali Acc: 0.483 Test Loss: 0.948 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8945193290710449
Epoch: 10, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.888 Vali Acc: 0.450 Test Loss: 0.888 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8809857368469238
Epoch: 11, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.966 Vali Acc: 0.500 Test Loss: 0.966 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9309806823730469
Epoch: 12, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.999 Vali Acc: 0.550 Test Loss: 0.999 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549990).  Saving model ...
Epoch: 13 cost time: 0.9144728183746338
Epoch: 13, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.314 Vali Acc: 0.478 Test Loss: 1.314 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8850767612457275
Epoch: 14, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.395 Vali Acc: 0.528 Test Loss: 1.395 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9234426021575928
Epoch: 15, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.418 Vali Acc: 0.494 Test Loss: 1.418 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8912088871002197
Epoch: 16, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.390 Vali Acc: 0.489 Test Loss: 1.390 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9045453071594238
Epoch: 17, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.310 Vali Acc: 0.494 Test Loss: 1.310 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8767673969268799
Epoch: 18, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.297 Vali Acc: 0.528 Test Loss: 1.297 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.892866849899292
Epoch: 19, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.640 Vali Acc: 0.456 Test Loss: 1.640 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8817167282104492
Epoch: 20, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.285 Vali Acc: 0.478 Test Loss: 1.285 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9030754566192627
Epoch: 21, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.319 Vali Acc: 0.517 Test Loss: 1.319 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9082903861999512
Epoch: 22, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.656 Vali Acc: 0.533 Test Loss: 1.656 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 289774
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5053162574768066
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.701 Vali Acc: 0.517 Test Loss: 0.701 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 0.819896936416626
Epoch: 2, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.814 Vali Acc: 0.506 Test Loss: 0.814 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8699042797088623
Epoch: 3, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.711 Vali Acc: 0.528 Test Loss: 0.711 Test Acc: 0.528
Validation loss decreased (-0.516660 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 0.7617790699005127
Epoch: 4, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.842 Vali Acc: 0.539 Test Loss: 0.842 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538880).  Saving model ...
Epoch: 5 cost time: 0.8804624080657959
Epoch: 5, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.942 Vali Acc: 0.550 Test Loss: 0.942 Test Acc: 0.550
Validation loss decreased (-0.538880 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 0.8023042678833008
Epoch: 6, Steps: 13 | Train Loss: 0.690 Vali Loss: 1.066 Vali Acc: 0.517 Test Loss: 1.066 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8102254867553711
Epoch: 7, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.904 Vali Acc: 0.489 Test Loss: 0.904 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8655219078063965
Epoch: 8, Steps: 13 | Train Loss: 0.766 Vali Loss: 1.043 Vali Acc: 0.444 Test Loss: 1.043 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.858661413192749
Epoch: 9, Steps: 13 | Train Loss: 0.826 Vali Loss: 1.259 Vali Acc: 0.528 Test Loss: 1.259 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.871945858001709
Epoch: 10, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.941 Vali Acc: 0.517 Test Loss: 0.941 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.852604866027832
Epoch: 11, Steps: 13 | Train Loss: 0.593 Vali Loss: 1.034 Vali Acc: 0.544 Test Loss: 1.034 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8851330280303955
Epoch: 12, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.836 Vali Acc: 0.506 Test Loss: 0.836 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.958216667175293
Epoch: 13, Steps: 13 | Train Loss: 0.608 Vali Loss: 1.504 Vali Acc: 0.439 Test Loss: 1.504 Test Acc: 0.439
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9445600509643555
Epoch: 14, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.898 Vali Acc: 0.478 Test Loss: 0.898 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.888596773147583
Epoch: 15, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.100 Vali Acc: 0.511 Test Loss: 1.100 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 289774
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6108176708221436
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.028564453125
Epoch: 2, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.729 Vali Acc: 0.550 Test Loss: 0.729 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 0.9290201663970947
Epoch: 3, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.997 Vali Acc: 0.494 Test Loss: 0.997 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0319733619689941
Epoch: 4, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.840 Vali Acc: 0.544 Test Loss: 0.840 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0321083068847656
Epoch: 5, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.997 Vali Acc: 0.517 Test Loss: 0.997 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9631199836730957
Epoch: 6, Steps: 13 | Train Loss: 0.483 Vali Loss: 1.124 Vali Acc: 0.489 Test Loss: 1.124 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.045717716217041
Epoch: 7, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.904 Vali Acc: 0.528 Test Loss: 0.904 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0481438636779785
Epoch: 8, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.054 Vali Acc: 0.528 Test Loss: 1.054 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0253872871398926
Epoch: 9, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.210 Vali Acc: 0.489 Test Loss: 1.210 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8740148544311523
Epoch: 10, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.533 Vali Acc: 0.472 Test Loss: 1.533 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8949375152587891
Epoch: 11, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.134 Vali Acc: 0.506 Test Loss: 1.134 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.872711181640625
Epoch: 12, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.298 Vali Acc: 0.511 Test Loss: 1.298 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 224238
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5154600143432617
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.757 Vali Acc: 0.494 Test Loss: 0.757 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.9083874225616455
Epoch: 2, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.727 Vali Acc: 0.517 Test Loss: 0.727 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 0.9035849571228027
Epoch: 3, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.881 Vali Acc: 0.506 Test Loss: 0.881 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9169073104858398
Epoch: 4, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.866 Vali Acc: 0.483 Test Loss: 0.866 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9223811626434326
Epoch: 5, Steps: 13 | Train Loss: 0.641 Vali Loss: 1.344 Vali Acc: 0.511 Test Loss: 1.344 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9351348876953125
Epoch: 6, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.828 Vali Acc: 0.528 Test Loss: 0.828 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527770).  Saving model ...
Epoch: 7 cost time: 0.9330830574035645
Epoch: 7, Steps: 13 | Train Loss: 0.531 Vali Loss: 1.063 Vali Acc: 0.522 Test Loss: 1.063 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9056735038757324
Epoch: 8, Steps: 13 | Train Loss: 0.508 Vali Loss: 1.069 Vali Acc: 0.494 Test Loss: 1.069 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8328285217285156
Epoch: 9, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.991 Vali Acc: 0.456 Test Loss: 0.991 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9066996574401855
Epoch: 10, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.206 Vali Acc: 0.528 Test Loss: 1.206 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8973686695098877
Epoch: 11, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.268 Vali Acc: 0.478 Test Loss: 1.268 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.896050214767456
Epoch: 12, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.305 Vali Acc: 0.506 Test Loss: 1.305 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8824896812438965
Epoch: 13, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.370 Vali Acc: 0.494 Test Loss: 1.370 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9150002002716064
Epoch: 14, Steps: 13 | Train Loss: 0.363 Vali Loss: 1.286 Vali Acc: 0.489 Test Loss: 1.286 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9199419021606445
Epoch: 15, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9211850166320801
Epoch: 16, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.332 Vali Acc: 0.528 Test Loss: 1.332 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 224238
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5647125244140625
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 0.8567500114440918
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.731 Vali Acc: 0.494 Test Loss: 0.731 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8658173084259033
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.862 Vali Acc: 0.506 Test Loss: 0.862 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505547).  Saving model ...
Epoch: 4 cost time: 0.8189365863800049
Epoch: 4, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.798 Vali Acc: 0.533 Test Loss: 0.798 Test Acc: 0.533
Validation loss decreased (-0.505547 --> -0.533325).  Saving model ...
Epoch: 5 cost time: 0.8951795101165771
Epoch: 5, Steps: 13 | Train Loss: 0.650 Vali Loss: 1.225 Vali Acc: 0.517 Test Loss: 1.225 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8349974155426025
Epoch: 6, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.776 Vali Acc: 0.511 Test Loss: 0.776 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8273947238922119
Epoch: 7, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.965 Vali Acc: 0.533 Test Loss: 0.965 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8756799697875977
Epoch: 8, Steps: 13 | Train Loss: 0.525 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8652005195617676
Epoch: 9, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.989 Vali Acc: 0.489 Test Loss: 0.989 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8880016803741455
Epoch: 10, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.043 Vali Acc: 0.483 Test Loss: 1.043 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8353188037872314
Epoch: 11, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8710353374481201
Epoch: 12, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.044 Vali Acc: 0.472 Test Loss: 1.044 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8702600002288818
Epoch: 13, Steps: 13 | Train Loss: 0.420 Vali Loss: 1.232 Vali Acc: 0.550 Test Loss: 1.232 Test Acc: 0.550
Validation loss decreased (-0.533325 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 0.8921892642974854
Epoch: 14, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.135 Vali Acc: 0.533 Test Loss: 1.135 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8904693126678467
Epoch: 15, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.322 Vali Acc: 0.500 Test Loss: 1.322 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8494842052459717
Epoch: 16, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.374 Vali Acc: 0.533 Test Loss: 1.374 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9185328483581543
Epoch: 17, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.250 Vali Acc: 0.494 Test Loss: 1.250 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8598692417144775
Epoch: 18, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.588 Vali Acc: 0.494 Test Loss: 1.588 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8700315952301025
Epoch: 19, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.478 Vali Acc: 0.494 Test Loss: 1.478 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9225625991821289
Epoch: 20, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9366941452026367
Epoch: 21, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.457 Vali Acc: 0.456 Test Loss: 1.457 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9104499816894531
Epoch: 22, Steps: 13 | Train Loss: 0.164 Vali Loss: 2.175 Vali Acc: 0.472 Test Loss: 2.175 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9319305419921875
Epoch: 23, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.540 Vali Acc: 0.528 Test Loss: 1.540 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 224238
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4363765716552734
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 0.8056735992431641
Epoch: 2, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 0.8726150989532471
Epoch: 3, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.820 Vali Acc: 0.511 Test Loss: 0.820 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511103).  Saving model ...
Epoch: 4 cost time: 0.8971343040466309
Epoch: 4, Steps: 13 | Train Loss: 0.811 Vali Loss: 0.714 Vali Acc: 0.528 Test Loss: 0.714 Test Acc: 0.528
Validation loss decreased (-0.511103 --> -0.527771).  Saving model ...
Epoch: 5 cost time: 0.8211123943328857
Epoch: 5, Steps: 13 | Train Loss: 0.641 Vali Loss: 1.161 Vali Acc: 0.506 Test Loss: 1.161 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9274277687072754
Epoch: 6, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.840 Vali Acc: 0.511 Test Loss: 0.840 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8458936214447021
Epoch: 7, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.952 Vali Acc: 0.511 Test Loss: 0.952 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8539416790008545
Epoch: 8, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.837 Vali Acc: 0.522 Test Loss: 0.837 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8677806854248047
Epoch: 9, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.789 Vali Acc: 0.472 Test Loss: 0.789 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8572826385498047
Epoch: 10, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.901 Vali Acc: 0.544 Test Loss: 0.901 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544435).  Saving model ...
Epoch: 11 cost time: 0.838679313659668
Epoch: 11, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8975062370300293
Epoch: 12, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.995 Vali Acc: 0.500 Test Loss: 0.995 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8607320785522461
Epoch: 13, Steps: 13 | Train Loss: 0.582 Vali Loss: 1.186 Vali Acc: 0.567 Test Loss: 1.186 Test Acc: 0.567
Validation loss decreased (-0.544435 --> -0.566655).  Saving model ...
Epoch: 14 cost time: 0.8467931747436523
Epoch: 14, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.929 Vali Acc: 0.483 Test Loss: 0.929 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8511133193969727
Epoch: 15, Steps: 13 | Train Loss: 0.475 Vali Loss: 1.426 Vali Acc: 0.533 Test Loss: 1.426 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8737163543701172
Epoch: 16, Steps: 13 | Train Loss: 0.701 Vali Loss: 1.184 Vali Acc: 0.544 Test Loss: 1.184 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8757917881011963
Epoch: 17, Steps: 13 | Train Loss: 0.626 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8441860675811768
Epoch: 18, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.052 Vali Acc: 0.494 Test Loss: 1.052 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8360199928283691
Epoch: 19, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.888869047164917
Epoch: 20, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.132 Vali Acc: 0.433 Test Loss: 1.132 Test Acc: 0.433
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.855072021484375
Epoch: 21, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.208 Vali Acc: 0.433 Test Loss: 1.208 Test Acc: 0.433
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8345215320587158
Epoch: 22, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.592 Vali Acc: 0.472 Test Loss: 1.592 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8114509582519531
Epoch: 23, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.776 Vali Acc: 0.500 Test Loss: 1.776 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 224238
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.519306182861328
Epoch: 1, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.734 Vali Acc: 0.450 Test Loss: 0.734 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 0.9778075218200684
Epoch: 2, Steps: 13 | Train Loss: 0.759 Vali Loss: 1.048 Vali Acc: 0.506 Test Loss: 1.048 Test Acc: 0.506
Validation loss decreased (-0.449993 --> -0.505545).  Saving model ...
Epoch: 3 cost time: 0.9811363220214844
Epoch: 3, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.808 Vali Acc: 0.489 Test Loss: 0.808 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9295611381530762
Epoch: 4, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.038278579711914
Epoch: 5, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.820 Vali Acc: 0.556 Test Loss: 0.820 Test Acc: 0.556
Validation loss decreased (-0.505545 --> -0.555547).  Saving model ...
Epoch: 6 cost time: 1.038421630859375
Epoch: 6, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.006 Vali Acc: 0.517 Test Loss: 1.006 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9993124008178711
Epoch: 7, Steps: 13 | Train Loss: 0.678 Vali Loss: 1.016 Vali Acc: 0.500 Test Loss: 1.016 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.937401294708252
Epoch: 8, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.946 Vali Acc: 0.567 Test Loss: 0.946 Test Acc: 0.567
Validation loss decreased (-0.555547 --> -0.566657).  Saving model ...
Epoch: 9 cost time: 0.9692354202270508
Epoch: 9, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.033 Vali Acc: 0.522 Test Loss: 1.033 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9794864654541016
Epoch: 10, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.500 Vali Acc: 0.500 Test Loss: 1.500 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9564938545227051
Epoch: 11, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.199 Vali Acc: 0.528 Test Loss: 1.199 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9822537899017334
Epoch: 12, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.579 Vali Acc: 0.472 Test Loss: 1.579 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9317197799682617
Epoch: 13, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.307 Vali Acc: 0.528 Test Loss: 1.307 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9665651321411133
Epoch: 14, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.350 Vali Acc: 0.494 Test Loss: 1.350 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9778368473052979
Epoch: 15, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.445 Vali Acc: 0.533 Test Loss: 1.445 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9135007858276367
Epoch: 16, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.523 Vali Acc: 0.467 Test Loss: 1.523 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9682583808898926
Epoch: 17, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.780 Vali Acc: 0.511 Test Loss: 1.780 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.010432243347168
Epoch: 18, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.553 Vali Acc: 0.528 Test Loss: 1.553 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 191470
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.650317907333374
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.741 Vali Acc: 0.472 Test Loss: 0.741 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 0.9339065551757812
Epoch: 2, Steps: 13 | Train Loss: 0.783 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.472215 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.9084970951080322
Epoch: 3, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.972 Vali Acc: 0.478 Test Loss: 0.972 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9402892589569092
Epoch: 4, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.828 Vali Acc: 0.506 Test Loss: 0.828 Test Acc: 0.506
Validation loss decreased (-0.499988 --> -0.505547).  Saving model ...
Epoch: 5 cost time: 0.9057743549346924
Epoch: 5, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.828 Vali Acc: 0.517 Test Loss: 0.828 Test Acc: 0.517
Validation loss decreased (-0.505547 --> -0.516658).  Saving model ...
Epoch: 6 cost time: 0.9596579074859619
Epoch: 6, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.983 Vali Acc: 0.511 Test Loss: 0.983 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9031186103820801
Epoch: 7, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.895 Vali Acc: 0.450 Test Loss: 0.895 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9122970104217529
Epoch: 8, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.006 Vali Acc: 0.478 Test Loss: 1.006 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9403431415557861
Epoch: 9, Steps: 13 | Train Loss: 0.549 Vali Loss: 1.047 Vali Acc: 0.511 Test Loss: 1.047 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.909320592880249
Epoch: 10, Steps: 13 | Train Loss: 0.403 Vali Loss: 1.245 Vali Acc: 0.467 Test Loss: 1.245 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8915243148803711
Epoch: 11, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.081 Vali Acc: 0.483 Test Loss: 1.081 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9516959190368652
Epoch: 12, Steps: 13 | Train Loss: 0.454 Vali Loss: 1.236 Vali Acc: 0.456 Test Loss: 1.236 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9154379367828369
Epoch: 13, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.224 Vali Acc: 0.489 Test Loss: 1.224 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9134049415588379
Epoch: 14, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.361 Vali Acc: 0.456 Test Loss: 1.361 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9484927654266357
Epoch: 15, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.356 Vali Acc: 0.517 Test Loss: 1.356 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 191470
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.595604419708252
Epoch: 1, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.711 Vali Acc: 0.506 Test Loss: 0.711 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 0.8509480953216553
Epoch: 2, Steps: 13 | Train Loss: 0.781 Vali Loss: 1.148 Vali Acc: 0.506 Test Loss: 1.148 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7930593490600586
Epoch: 3, Steps: 13 | Train Loss: 0.847 Vali Loss: 0.939 Vali Acc: 0.517 Test Loss: 0.939 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516657).  Saving model ...
Epoch: 4 cost time: 0.8730552196502686
Epoch: 4, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.846 Vali Acc: 0.539 Test Loss: 0.846 Test Acc: 0.539
Validation loss decreased (-0.516657 --> -0.538880).  Saving model ...
Epoch: 5 cost time: 0.8902080059051514
Epoch: 5, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.833 Vali Acc: 0.517 Test Loss: 0.833 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8812494277954102
Epoch: 6, Steps: 13 | Train Loss: 0.614 Vali Loss: 1.092 Vali Acc: 0.489 Test Loss: 1.092 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8750464916229248
Epoch: 7, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.845 Vali Acc: 0.478 Test Loss: 0.845 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8552563190460205
Epoch: 8, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.953 Vali Acc: 0.506 Test Loss: 0.953 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.819054126739502
Epoch: 9, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.937 Vali Acc: 0.528 Test Loss: 0.937 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8101394176483154
Epoch: 10, Steps: 13 | Train Loss: 0.459 Vali Loss: 1.119 Vali Acc: 0.528 Test Loss: 1.119 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8140006065368652
Epoch: 11, Steps: 13 | Train Loss: 0.456 Vali Loss: 1.001 Vali Acc: 0.528 Test Loss: 1.001 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8037118911743164
Epoch: 12, Steps: 13 | Train Loss: 0.477 Vali Loss: 1.386 Vali Acc: 0.461 Test Loss: 1.386 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8487396240234375
Epoch: 13, Steps: 13 | Train Loss: 0.572 Vali Loss: 1.045 Vali Acc: 0.572 Test Loss: 1.045 Test Acc: 0.572
Validation loss decreased (-0.538880 --> -0.572212).  Saving model ...
Epoch: 14 cost time: 0.8363547325134277
Epoch: 14, Steps: 13 | Train Loss: 0.363 Vali Loss: 1.110 Vali Acc: 0.478 Test Loss: 1.110 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8178601264953613
Epoch: 15, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.198 Vali Acc: 0.472 Test Loss: 1.198 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8844139575958252
Epoch: 16, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.335 Vali Acc: 0.539 Test Loss: 1.335 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9719011783599854
Epoch: 17, Steps: 13 | Train Loss: 0.189 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.849287748336792
Epoch: 18, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.402 Vali Acc: 0.472 Test Loss: 1.402 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.911501407623291
Epoch: 19, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.464 Vali Acc: 0.561 Test Loss: 1.464 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8420801162719727
Epoch: 20, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.337 Vali Acc: 0.511 Test Loss: 1.337 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9664204120635986
Epoch: 21, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.411 Vali Acc: 0.489 Test Loss: 1.411 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9460711479187012
Epoch: 22, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.655 Vali Acc: 0.483 Test Loss: 1.655 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.822821855545044
Epoch: 23, Steps: 13 | Train Loss: 0.241 Vali Loss: 2.289 Vali Acc: 0.567 Test Loss: 2.289 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 191470
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.385312795639038
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 0.8661739826202393
Epoch: 2, Steps: 13 | Train Loss: 0.769 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8487846851348877
Epoch: 3, Steps: 13 | Train Loss: 0.973 Vali Loss: 0.965 Vali Acc: 0.494 Test Loss: 0.965 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8365421295166016
Epoch: 4, Steps: 13 | Train Loss: 0.923 Vali Loss: 0.967 Vali Acc: 0.494 Test Loss: 0.967 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8311049938201904
Epoch: 5, Steps: 13 | Train Loss: 0.761 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9056601524353027
Epoch: 6, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.944 Vali Acc: 0.472 Test Loss: 0.944 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8925673961639404
Epoch: 7, Steps: 13 | Train Loss: 0.892 Vali Loss: 0.796 Vali Acc: 0.528 Test Loss: 0.796 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.918250322341919
Epoch: 8, Steps: 13 | Train Loss: 0.636 Vali Loss: 1.126 Vali Acc: 0.489 Test Loss: 1.126 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.895047664642334
Epoch: 9, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.873 Vali Acc: 0.472 Test Loss: 0.873 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9161696434020996
Epoch: 10, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.874 Vali Acc: 0.472 Test Loss: 0.874 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8398609161376953
Epoch: 11, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.999 Vali Acc: 0.478 Test Loss: 0.999 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 191470
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5873873233795166
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.749 Vali Acc: 0.550 Test Loss: 0.749 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 0.9349279403686523
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.778 Vali Acc: 0.522 Test Loss: 0.778 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9881396293640137
Epoch: 3, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9841985702514648
Epoch: 4, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.785 Vali Acc: 0.494 Test Loss: 0.785 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9303817749023438
Epoch: 5, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.929 Vali Acc: 0.433 Test Loss: 0.929 Test Acc: 0.433
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0120172500610352
Epoch: 6, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.950 Vali Acc: 0.539 Test Loss: 0.950 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9919769763946533
Epoch: 7, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.906 Vali Acc: 0.483 Test Loss: 0.906 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9895648956298828
Epoch: 8, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.029 Vali Acc: 0.461 Test Loss: 1.029 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9772403240203857
Epoch: 9, Steps: 13 | Train Loss: 0.468 Vali Loss: 1.393 Vali Acc: 0.500 Test Loss: 1.393 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9937901496887207
Epoch: 10, Steps: 13 | Train Loss: 0.461 Vali Loss: 1.320 Vali Acc: 0.456 Test Loss: 1.320 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9825074672698975
Epoch: 11, Steps: 13 | Train Loss: 0.508 Vali Loss: 1.588 Vali Acc: 0.522 Test Loss: 1.588 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 175086
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6121411323547363
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.758 Vali Acc: 0.539 Test Loss: 0.758 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 0.9320921897888184
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.782 Vali Acc: 0.517 Test Loss: 0.782 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9288034439086914
Epoch: 3, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.725 Vali Acc: 0.461 Test Loss: 0.725 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9219551086425781
Epoch: 4, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.795 Vali Acc: 0.461 Test Loss: 0.795 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9271347522735596
Epoch: 5, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.849 Vali Acc: 0.428 Test Loss: 0.849 Test Acc: 0.428
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9041295051574707
Epoch: 6, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.863 Vali Acc: 0.483 Test Loss: 0.863 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9830920696258545
Epoch: 7, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9245805740356445
Epoch: 8, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.942 Vali Acc: 0.506 Test Loss: 0.942 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.944054126739502
Epoch: 9, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.067 Vali Acc: 0.511 Test Loss: 1.067 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8988044261932373
Epoch: 10, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.105 Vali Acc: 0.461 Test Loss: 1.105 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8934483528137207
Epoch: 11, Steps: 13 | Train Loss: 0.528 Vali Loss: 1.307 Vali Acc: 0.544 Test Loss: 1.307 Test Acc: 0.544
Validation loss decreased (-0.538881 --> -0.544431).  Saving model ...
Epoch: 12 cost time: 0.9428951740264893
Epoch: 12, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.278 Vali Acc: 0.489 Test Loss: 1.278 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9334831237792969
Epoch: 13, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.251 Vali Acc: 0.517 Test Loss: 1.251 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9461033344268799
Epoch: 14, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.256 Vali Acc: 0.550 Test Loss: 1.256 Test Acc: 0.550
Validation loss decreased (-0.544431 --> -0.549987).  Saving model ...
Epoch: 15 cost time: 0.923614501953125
Epoch: 15, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.473 Vali Acc: 0.467 Test Loss: 1.473 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9546480178833008
Epoch: 16, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.478 Vali Acc: 0.506 Test Loss: 1.478 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9112446308135986
Epoch: 17, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.431 Vali Acc: 0.478 Test Loss: 1.431 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9140334129333496
Epoch: 18, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.468 Vali Acc: 0.494 Test Loss: 1.468 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9413356781005859
Epoch: 19, Steps: 13 | Train Loss: 0.164 Vali Loss: 2.520 Vali Acc: 0.528 Test Loss: 2.520 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9174442291259766
Epoch: 20, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.690 Vali Acc: 0.511 Test Loss: 1.690 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9407835006713867
Epoch: 21, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.839 Vali Acc: 0.478 Test Loss: 1.839 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9290862083435059
Epoch: 22, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.591 Vali Acc: 0.489 Test Loss: 1.591 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.907829761505127
Epoch: 23, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.633 Vali Acc: 0.478 Test Loss: 1.633 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9698567390441895
Epoch: 24, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.847 Vali Acc: 0.478 Test Loss: 1.847 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 175086
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.532372236251831
Epoch: 1, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.752 Vali Acc: 0.556 Test Loss: 0.752 Test Acc: 0.556
Validation loss decreased (inf --> -0.555548).  Saving model ...
Epoch: 2 cost time: 0.8480489253997803
Epoch: 2, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9132814407348633
Epoch: 3, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.711 Vali Acc: 0.472 Test Loss: 0.711 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.878089427947998
Epoch: 4, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.781 Vali Acc: 0.511 Test Loss: 0.781 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9225025177001953
Epoch: 5, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.797 Vali Acc: 0.489 Test Loss: 0.797 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.834545373916626
Epoch: 6, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.819 Vali Acc: 0.506 Test Loss: 0.819 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.852208137512207
Epoch: 7, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.855 Vali Acc: 0.517 Test Loss: 0.855 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8645017147064209
Epoch: 8, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.993 Vali Acc: 0.517 Test Loss: 0.993 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8446362018585205
Epoch: 9, Steps: 13 | Train Loss: 0.709 Vali Loss: 1.344 Vali Acc: 0.494 Test Loss: 1.344 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8267571926116943
Epoch: 10, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.978 Vali Acc: 0.467 Test Loss: 0.978 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8425555229187012
Epoch: 11, Steps: 13 | Train Loss: 0.615 Vali Loss: 1.412 Vali Acc: 0.556 Test Loss: 1.412 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 175086
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4970972537994385
Epoch: 1, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.739 Vali Acc: 0.539 Test Loss: 0.739 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 0.8239367008209229
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8450336456298828
Epoch: 3, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.738 Vali Acc: 0.528 Test Loss: 0.738 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8118314743041992
Epoch: 4, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.735 Vali Acc: 0.472 Test Loss: 0.735 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8002057075500488
Epoch: 5, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.753 Vali Acc: 0.511 Test Loss: 0.753 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8599197864532471
Epoch: 6, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.891 Vali Acc: 0.522 Test Loss: 0.891 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.808093786239624
Epoch: 7, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.808 Vali Acc: 0.556 Test Loss: 0.808 Test Acc: 0.556
Validation loss decreased (-0.538881 --> -0.555547).  Saving model ...
Epoch: 8 cost time: 0.863008975982666
Epoch: 8, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.815 Vali Acc: 0.528 Test Loss: 0.815 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7890923023223877
Epoch: 9, Steps: 13 | Train Loss: 0.651 Vali Loss: 1.131 Vali Acc: 0.528 Test Loss: 1.131 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8615314960479736
Epoch: 10, Steps: 13 | Train Loss: 0.795 Vali Loss: 1.298 Vali Acc: 0.467 Test Loss: 1.298 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.891120433807373
Epoch: 11, Steps: 13 | Train Loss: 0.874 Vali Loss: 0.979 Vali Acc: 0.550 Test Loss: 0.979 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8115816116333008
Epoch: 12, Steps: 13 | Train Loss: 0.561 Vali Loss: 1.194 Vali Acc: 0.494 Test Loss: 1.194 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8361530303955078
Epoch: 13, Steps: 13 | Train Loss: 0.503 Vali Loss: 1.018 Vali Acc: 0.528 Test Loss: 1.018 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8413922786712646
Epoch: 14, Steps: 13 | Train Loss: 0.490 Vali Loss: 1.017 Vali Acc: 0.494 Test Loss: 1.017 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.852247953414917
Epoch: 15, Steps: 13 | Train Loss: 0.706 Vali Loss: 1.041 Vali Acc: 0.511 Test Loss: 1.041 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8919613361358643
Epoch: 16, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.506 Vali Acc: 0.539 Test Loss: 1.506 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8560166358947754
Epoch: 17, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.979 Vali Acc: 0.472 Test Loss: 0.979 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 175086
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5692224502563477
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.700 Vali Acc: 0.511 Test Loss: 0.700 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.016223669052124
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.723 Vali Acc: 0.511 Test Loss: 0.723 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0197455883026123
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.896 Vali Acc: 0.539 Test Loss: 0.896 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538880).  Saving model ...
Epoch: 4 cost time: 1.0236434936523438
Epoch: 4, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.855 Vali Acc: 0.528 Test Loss: 0.855 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0018866062164307
Epoch: 5, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.830 Vali Acc: 0.511 Test Loss: 0.830 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9384505748748779
Epoch: 6, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.018538236618042
Epoch: 7, Steps: 13 | Train Loss: 0.544 Vali Loss: 1.077 Vali Acc: 0.494 Test Loss: 1.077 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0177879333496094
Epoch: 8, Steps: 13 | Train Loss: 0.437 Vali Loss: 1.223 Vali Acc: 0.539 Test Loss: 1.223 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0029411315917969
Epoch: 9, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.110 Vali Acc: 0.478 Test Loss: 1.110 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9981184005737305
Epoch: 10, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.092 Vali Acc: 0.522 Test Loss: 1.092 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0031044483184814
Epoch: 11, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.129 Vali Acc: 0.528 Test Loss: 1.129 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9696037769317627
Epoch: 12, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.235 Vali Acc: 0.506 Test Loss: 1.235 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0521142482757568
Epoch: 13, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.274 Vali Acc: 0.489 Test Loss: 1.274 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 166894
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6013457775115967
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.707 Vali Acc: 0.489 Test Loss: 0.707 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 0.8840603828430176
Epoch: 2, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.725 Vali Acc: 0.522 Test Loss: 0.725 Test Acc: 0.522
Validation loss decreased (-0.488882 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 0.910381555557251
Epoch: 3, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.882 Vali Acc: 0.533 Test Loss: 0.882 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533325).  Saving model ...
Epoch: 4 cost time: 0.8972287178039551
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.873 Vali Acc: 0.506 Test Loss: 0.873 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8900933265686035
Epoch: 5, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9415526390075684
Epoch: 6, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.857 Vali Acc: 0.522 Test Loss: 0.857 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.941098690032959
Epoch: 7, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.871 Vali Acc: 0.500 Test Loss: 0.871 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9615058898925781
Epoch: 8, Steps: 13 | Train Loss: 0.472 Vali Loss: 1.242 Vali Acc: 0.539 Test Loss: 1.242 Test Acc: 0.539
Validation loss decreased (-0.533325 --> -0.538876).  Saving model ...
Epoch: 9 cost time: 0.9312636852264404
Epoch: 9, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.225 Vali Acc: 0.472 Test Loss: 1.225 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9035937786102295
Epoch: 10, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.143 Vali Acc: 0.450 Test Loss: 1.143 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9035191535949707
Epoch: 11, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.228 Vali Acc: 0.511 Test Loss: 1.228 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8887522220611572
Epoch: 12, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.393 Vali Acc: 0.483 Test Loss: 1.393 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.041651964187622
Epoch: 13, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.575 Vali Acc: 0.461 Test Loss: 1.575 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8536984920501709
Epoch: 14, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.495 Vali Acc: 0.539 Test Loss: 1.495 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8930788040161133
Epoch: 15, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.601 Vali Acc: 0.478 Test Loss: 1.601 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9257986545562744
Epoch: 16, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.295 Vali Acc: 0.483 Test Loss: 1.295 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9342048168182373
Epoch: 17, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.530 Vali Acc: 0.539 Test Loss: 1.530 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9453220367431641
Epoch: 18, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.567 Vali Acc: 0.467 Test Loss: 1.567 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 166894
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.43369722366333
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.690 Vali Acc: 0.533 Test Loss: 0.690 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 0.8681232929229736
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.722 Vali Acc: 0.506 Test Loss: 0.722 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9443120956420898
Epoch: 3, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.798 Vali Acc: 0.478 Test Loss: 0.798 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.918532133102417
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.885 Vali Acc: 0.494 Test Loss: 0.885 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8294227123260498
Epoch: 5, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.947 Vali Acc: 0.483 Test Loss: 0.947 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8599588871002197
Epoch: 6, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.793 Vali Acc: 0.506 Test Loss: 0.793 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8483715057373047
Epoch: 7, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.840 Vali Acc: 0.544 Test Loss: 0.840 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544436).  Saving model ...
Epoch: 8 cost time: 0.8905434608459473
Epoch: 8, Steps: 13 | Train Loss: 0.537 Vali Loss: 1.109 Vali Acc: 0.544 Test Loss: 1.109 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.847130537033081
Epoch: 9, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.141 Vali Acc: 0.450 Test Loss: 1.141 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8027029037475586
Epoch: 10, Steps: 13 | Train Loss: 0.505 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8720123767852783
Epoch: 11, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.903 Vali Acc: 0.478 Test Loss: 0.903 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.877239465713501
Epoch: 12, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.994 Vali Acc: 0.522 Test Loss: 0.994 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8412473201751709
Epoch: 13, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.570 Vali Acc: 0.472 Test Loss: 1.570 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8384535312652588
Epoch: 14, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.771 Vali Acc: 0.556 Test Loss: 1.771 Test Acc: 0.556
Validation loss decreased (-0.544436 --> -0.555538).  Saving model ...
Epoch: 15 cost time: 0.8837828636169434
Epoch: 15, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.202 Vali Acc: 0.533 Test Loss: 1.202 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8253443241119385
Epoch: 16, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.745 Vali Acc: 0.522 Test Loss: 1.745 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9923207759857178
Epoch: 17, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.325 Vali Acc: 0.494 Test Loss: 1.325 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9483623504638672
Epoch: 18, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.447 Vali Acc: 0.467 Test Loss: 1.447 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9207842350006104
Epoch: 19, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.362 Vali Acc: 0.489 Test Loss: 1.362 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.912229061126709
Epoch: 20, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.411 Vali Acc: 0.461 Test Loss: 1.411 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9028587341308594
Epoch: 21, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.522 Vali Acc: 0.450 Test Loss: 1.522 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8826608657836914
Epoch: 22, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.579 Vali Acc: 0.494 Test Loss: 1.579 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9034538269042969
Epoch: 23, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.659 Vali Acc: 0.478 Test Loss: 1.659 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.879159688949585
Epoch: 24, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.864 Vali Acc: 0.439 Test Loss: 1.864 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 166894
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.378474235534668
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.7936642169952393
Epoch: 2, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.716 Vali Acc: 0.511 Test Loss: 0.716 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 0.8259005546569824
Epoch: 3, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.775 Vali Acc: 0.517 Test Loss: 0.775 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 0.8986365795135498
Epoch: 4, Steps: 13 | Train Loss: 0.778 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
Validation loss decreased (-0.516659 --> -0.549991).  Saving model ...
Epoch: 5 cost time: 0.8457727432250977
Epoch: 5, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.756 Vali Acc: 0.556 Test Loss: 0.756 Test Acc: 0.556
Validation loss decreased (-0.549991 --> -0.555548).  Saving model ...
Epoch: 6 cost time: 0.8573062419891357
Epoch: 6, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.801 Vali Acc: 0.556 Test Loss: 0.801 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8005199432373047
Epoch: 7, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.817 Vali Acc: 0.556 Test Loss: 0.817 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8504419326782227
Epoch: 8, Steps: 13 | Train Loss: 0.760 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8261537551879883
Epoch: 9, Steps: 13 | Train Loss: 0.677 Vali Loss: 1.013 Vali Acc: 0.444 Test Loss: 1.013 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.853163480758667
Epoch: 10, Steps: 13 | Train Loss: 0.583 Vali Loss: 1.033 Vali Acc: 0.494 Test Loss: 1.033 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7982375621795654
Epoch: 11, Steps: 13 | Train Loss: 0.611 Vali Loss: 1.012 Vali Acc: 0.489 Test Loss: 1.012 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8154230117797852
Epoch: 12, Steps: 13 | Train Loss: 0.614 Vali Loss: 1.110 Vali Acc: 0.522 Test Loss: 1.110 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.795757532119751
Epoch: 13, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.001 Vali Acc: 0.500 Test Loss: 1.001 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8600146770477295
Epoch: 14, Steps: 13 | Train Loss: 0.490 Vali Loss: 1.212 Vali Acc: 0.572 Test Loss: 1.212 Test Acc: 0.572
Validation loss decreased (-0.555548 --> -0.572210).  Saving model ...
Epoch: 15 cost time: 0.6701018810272217
Epoch: 15, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.929 Vali Acc: 0.517 Test Loss: 0.929 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8113327026367188
Epoch: 16, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.233 Vali Acc: 0.450 Test Loss: 1.233 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8322608470916748
Epoch: 17, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.182 Vali Acc: 0.517 Test Loss: 1.182 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8575015068054199
Epoch: 18, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.355 Vali Acc: 0.489 Test Loss: 1.355 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9012417793273926
Epoch: 19, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.066 Vali Acc: 0.478 Test Loss: 1.066 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8455033302307129
Epoch: 20, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.115 Vali Acc: 0.489 Test Loss: 1.115 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8580689430236816
Epoch: 21, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.554 Vali Acc: 0.456 Test Loss: 1.554 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8347771167755127
Epoch: 22, Steps: 13 | Train Loss: 0.609 Vali Loss: 1.637 Vali Acc: 0.461 Test Loss: 1.637 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8363852500915527
Epoch: 23, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.570 Vali Acc: 0.556 Test Loss: 1.570 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8409967422485352
Epoch: 24, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.375 Vali Acc: 0.489 Test Loss: 1.375 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 166894
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.558842897415161
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.711 Vali Acc: 0.522 Test Loss: 0.711 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.8307375907897949
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.755 Vali Acc: 0.517 Test Loss: 0.755 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.851269006729126
Epoch: 3, Steps: 13 | Train Loss: 0.863 Vali Loss: 0.735 Vali Acc: 0.544 Test Loss: 0.735 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 0.9363651275634766
Epoch: 4, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.860 Vali Acc: 0.472 Test Loss: 0.860 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8932654857635498
Epoch: 5, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.741 Vali Acc: 0.533 Test Loss: 0.741 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8721461296081543
Epoch: 6, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.841 Vali Acc: 0.511 Test Loss: 0.841 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8530545234680176
Epoch: 7, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.800 Vali Acc: 0.556 Test Loss: 0.800 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555548).  Saving model ...
Epoch: 8 cost time: 0.8349599838256836
Epoch: 8, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.860 Vali Acc: 0.522 Test Loss: 0.860 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8246541023254395
Epoch: 9, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.910 Vali Acc: 0.528 Test Loss: 0.910 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8605680465698242
Epoch: 10, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.963 Vali Acc: 0.478 Test Loss: 0.963 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8718502521514893
Epoch: 11, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.945 Vali Acc: 0.522 Test Loss: 0.945 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8613061904907227
Epoch: 12, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.931 Vali Acc: 0.533 Test Loss: 0.931 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8690187931060791
Epoch: 13, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.930 Vali Acc: 0.539 Test Loss: 0.930 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.875035285949707
Epoch: 14, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.989 Vali Acc: 0.544 Test Loss: 0.989 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8519227504730225
Epoch: 15, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.036 Vali Acc: 0.578 Test Loss: 1.036 Test Acc: 0.578
Validation loss decreased (-0.555548 --> -0.577767).  Saving model ...
Epoch: 16 cost time: 0.8839418888092041
Epoch: 16, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.172 Vali Acc: 0.511 Test Loss: 1.172 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.898951530456543
Epoch: 17, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.081 Vali Acc: 0.494 Test Loss: 1.081 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.866741418838501
Epoch: 18, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.098 Vali Acc: 0.511 Test Loss: 1.098 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8722081184387207
Epoch: 19, Steps: 13 | Train Loss: 0.202 Vali Loss: 1.138 Vali Acc: 0.517 Test Loss: 1.138 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.913818359375
Epoch: 20, Steps: 13 | Train Loss: 0.189 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8051900863647461
Epoch: 21, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.442 Vali Acc: 0.500 Test Loss: 1.442 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8613932132720947
Epoch: 22, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.506 Vali Acc: 0.511 Test Loss: 1.506 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8358399868011475
Epoch: 23, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.300 Vali Acc: 0.511 Test Loss: 1.300 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8885467052459717
Epoch: 24, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.572 Vali Acc: 0.500 Test Loss: 1.572 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8834588527679443
Epoch: 25, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.368 Vali Acc: 0.539 Test Loss: 1.368 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 208398
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4595694541931152
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.705 Vali Acc: 0.522 Test Loss: 0.705 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.8001248836517334
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.750 Vali Acc: 0.517 Test Loss: 0.750 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8614444732666016
Epoch: 3, Steps: 13 | Train Loss: 0.856 Vali Loss: 0.733 Vali Acc: 0.544 Test Loss: 0.733 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 0.8821201324462891
Epoch: 4, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.851 Vali Acc: 0.478 Test Loss: 0.851 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8788325786590576
Epoch: 5, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.741 Vali Acc: 0.517 Test Loss: 0.741 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9280641078948975
Epoch: 6, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.849 Vali Acc: 0.533 Test Loss: 0.849 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8263416290283203
Epoch: 7, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.847 Vali Acc: 0.494 Test Loss: 0.847 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9012336730957031
Epoch: 8, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.833 Vali Acc: 0.506 Test Loss: 0.833 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8425877094268799
Epoch: 9, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.847 Vali Acc: 0.589 Test Loss: 0.847 Test Acc: 0.589
Validation loss decreased (-0.544437 --> -0.588880).  Saving model ...
Epoch: 10 cost time: 0.854621171951294
Epoch: 10, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.027 Vali Acc: 0.494 Test Loss: 1.027 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8882088661193848
Epoch: 11, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.139 Vali Acc: 0.533 Test Loss: 1.139 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8333871364593506
Epoch: 12, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.900 Vali Acc: 0.528 Test Loss: 0.900 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8499755859375
Epoch: 13, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.939 Vali Acc: 0.522 Test Loss: 0.939 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8995678424835205
Epoch: 14, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.023 Vali Acc: 0.522 Test Loss: 1.023 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.834536075592041
Epoch: 15, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8497142791748047
Epoch: 16, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.242 Vali Acc: 0.478 Test Loss: 1.242 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8374636173248291
Epoch: 17, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.122 Vali Acc: 0.494 Test Loss: 1.122 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8724517822265625
Epoch: 18, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.099 Vali Acc: 0.528 Test Loss: 1.099 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8812575340270996
Epoch: 19, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.163 Vali Acc: 0.489 Test Loss: 1.163 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 208398
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.519347906112671
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.702 Vali Acc: 0.511 Test Loss: 0.702 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.7722682952880859
Epoch: 2, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
Validation loss decreased (-0.511104 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 0.8507552146911621
Epoch: 3, Steps: 13 | Train Loss: 0.857 Vali Loss: 0.738 Vali Acc: 0.506 Test Loss: 0.738 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8440079689025879
Epoch: 4, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.836 Vali Acc: 0.478 Test Loss: 0.836 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8449845314025879
Epoch: 5, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.734 Vali Acc: 0.494 Test Loss: 0.734 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.804194450378418
Epoch: 6, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.836 Vali Acc: 0.511 Test Loss: 0.836 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7960178852081299
Epoch: 7, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.899 Vali Acc: 0.489 Test Loss: 0.899 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8049044609069824
Epoch: 8, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.851 Vali Acc: 0.483 Test Loss: 0.851 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8319599628448486
Epoch: 9, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.863 Vali Acc: 0.500 Test Loss: 0.863 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7576971054077148
Epoch: 10, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.833 Vali Acc: 0.478 Test Loss: 0.833 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7975354194641113
Epoch: 11, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.952 Vali Acc: 0.500 Test Loss: 0.952 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8430111408233643
Epoch: 12, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.903 Vali Acc: 0.522 Test Loss: 0.903 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 208398
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.357861042022705
Epoch: 1, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.704 Vali Acc: 0.450 Test Loss: 0.704 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 0.8172855377197266
Epoch: 2, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.699 Vali Acc: 0.511 Test Loss: 0.699 Test Acc: 0.511
Validation loss decreased (-0.449993 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 0.7718040943145752
Epoch: 3, Steps: 13 | Train Loss: 0.833 Vali Loss: 0.743 Vali Acc: 0.506 Test Loss: 0.743 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8188943862915039
Epoch: 4, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.778 Vali Acc: 0.489 Test Loss: 0.778 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7935161590576172
Epoch: 5, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.697 Vali Acc: 0.533 Test Loss: 0.697 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533326).  Saving model ...
Epoch: 6 cost time: 0.7781991958618164
Epoch: 6, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.786 Vali Acc: 0.533 Test Loss: 0.786 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7280161380767822
Epoch: 7, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.918 Vali Acc: 0.500 Test Loss: 0.918 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8216609954833984
Epoch: 8, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.875 Vali Acc: 0.517 Test Loss: 0.875 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8191463947296143
Epoch: 9, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.850 Vali Acc: 0.517 Test Loss: 0.850 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7996366024017334
Epoch: 10, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.732 Vali Acc: 0.517 Test Loss: 0.732 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8033807277679443
Epoch: 11, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.874 Vali Acc: 0.522 Test Loss: 0.874 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.775517463684082
Epoch: 12, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.756 Vali Acc: 0.528 Test Loss: 0.756 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8461270332336426
Epoch: 13, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.767 Vali Acc: 0.539 Test Loss: 0.767 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538881).  Saving model ...
Epoch: 14 cost time: 0.7986404895782471
Epoch: 14, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.908 Vali Acc: 0.489 Test Loss: 0.908 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8006322383880615
Epoch: 15, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.781 Vali Acc: 0.533 Test Loss: 0.781 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8120193481445312
Epoch: 16, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.835 Vali Acc: 0.522 Test Loss: 0.835 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7983779907226562
Epoch: 17, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.792 Vali Acc: 0.539 Test Loss: 0.792 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7900402545928955
Epoch: 18, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.915 Vali Acc: 0.511 Test Loss: 0.915 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7853925228118896
Epoch: 19, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.896 Vali Acc: 0.556 Test Loss: 0.896 Test Acc: 0.556
Validation loss decreased (-0.538881 --> -0.555547).  Saving model ...
Epoch: 20 cost time: 0.8152940273284912
Epoch: 20, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.902 Vali Acc: 0.533 Test Loss: 0.902 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8189659118652344
Epoch: 21, Steps: 13 | Train Loss: 0.610 Vali Loss: 1.056 Vali Acc: 0.522 Test Loss: 1.056 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8137462139129639
Epoch: 22, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.891 Vali Acc: 0.528 Test Loss: 0.891 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8144145011901855
Epoch: 23, Steps: 13 | Train Loss: 0.584 Vali Loss: 1.516 Vali Acc: 0.517 Test Loss: 1.516 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8042194843292236
Epoch: 24, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.924 Vali Acc: 0.522 Test Loss: 0.924 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8536436557769775
Epoch: 25, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.975 Vali Acc: 0.511 Test Loss: 0.975 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8474664688110352
Epoch: 26, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.033 Vali Acc: 0.522 Test Loss: 1.033 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7799534797668457
Epoch: 27, Steps: 13 | Train Loss: 0.529 Vali Loss: 1.362 Vali Acc: 0.517 Test Loss: 1.362 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7636170387268066
Epoch: 28, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.025 Vali Acc: 0.539 Test Loss: 1.025 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8358917236328125
Epoch: 29, Steps: 13 | Train Loss: 0.452 Vali Loss: 1.029 Vali Acc: 0.528 Test Loss: 1.029 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 208398
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.461132049560547
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.716 Vali Acc: 0.478 Test Loss: 0.716 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 0.8374173641204834
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.710 Vali Acc: 0.533 Test Loss: 0.710 Test Acc: 0.533
Validation loss decreased (-0.477771 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 0.8397886753082275
Epoch: 3, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.743 Vali Acc: 0.506 Test Loss: 0.743 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8294622898101807
Epoch: 4, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.737 Vali Acc: 0.561 Test Loss: 0.737 Test Acc: 0.561
Validation loss decreased (-0.533326 --> -0.561104).  Saving model ...
Epoch: 5 cost time: 0.8748829364776611
Epoch: 5, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.791 Vali Acc: 0.517 Test Loss: 0.791 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8612167835235596
Epoch: 6, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.777 Vali Acc: 0.528 Test Loss: 0.777 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8376021385192871
Epoch: 7, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.792 Vali Acc: 0.517 Test Loss: 0.792 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8448927402496338
Epoch: 8, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.867 Vali Acc: 0.544 Test Loss: 0.867 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8774595260620117
Epoch: 9, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.901 Vali Acc: 0.478 Test Loss: 0.901 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8063457012176514
Epoch: 10, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.968 Vali Acc: 0.511 Test Loss: 0.968 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8746373653411865
Epoch: 11, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.076 Vali Acc: 0.506 Test Loss: 1.076 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.876309871673584
Epoch: 12, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.891 Vali Acc: 0.522 Test Loss: 0.891 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8125712871551514
Epoch: 13, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.890 Vali Acc: 0.544 Test Loss: 0.890 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8379390239715576
Epoch: 14, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.946 Vali Acc: 0.528 Test Loss: 0.946 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 142862
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.601654291152954
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.8342490196228027
Epoch: 2, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.706 Vali Acc: 0.489 Test Loss: 0.706 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8062100410461426
Epoch: 3, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7946527004241943
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.731 Vali Acc: 0.528 Test Loss: 0.731 Test Acc: 0.528
Validation loss decreased (-0.499993 --> -0.527770).  Saving model ...
Epoch: 5 cost time: 0.7820212841033936
Epoch: 5, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.794 Vali Acc: 0.528 Test Loss: 0.794 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8745341300964355
Epoch: 6, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.750 Vali Acc: 0.494 Test Loss: 0.750 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7960336208343506
Epoch: 7, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.786 Vali Acc: 0.511 Test Loss: 0.786 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7478268146514893
Epoch: 8, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.845 Vali Acc: 0.511 Test Loss: 0.845 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7446515560150146
Epoch: 9, Steps: 13 | Train Loss: 0.529 Vali Loss: 1.021 Vali Acc: 0.506 Test Loss: 1.021 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7733485698699951
Epoch: 10, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.981 Vali Acc: 0.511 Test Loss: 0.981 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.824899435043335
Epoch: 11, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.935 Vali Acc: 0.483 Test Loss: 0.935 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8518538475036621
Epoch: 12, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.873 Vali Acc: 0.500 Test Loss: 0.873 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8169174194335938
Epoch: 13, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.949 Vali Acc: 0.517 Test Loss: 0.949 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8554732799530029
Epoch: 14, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.184 Vali Acc: 0.511 Test Loss: 1.184 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 142862
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4975976943969727
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.716 Vali Acc: 0.511 Test Loss: 0.716 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.8102767467498779
Epoch: 2, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.707 Vali Acc: 0.472 Test Loss: 0.707 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8736739158630371
Epoch: 3, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7996931076049805
Epoch: 4, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.739 Vali Acc: 0.494 Test Loss: 0.739 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7675111293792725
Epoch: 5, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.768 Vali Acc: 0.483 Test Loss: 0.768 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8226714134216309
Epoch: 6, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.763 Vali Acc: 0.456 Test Loss: 0.763 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7681026458740234
Epoch: 7, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.813 Vali Acc: 0.506 Test Loss: 0.813 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7633357048034668
Epoch: 8, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.833 Vali Acc: 0.506 Test Loss: 0.833 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7970066070556641
Epoch: 9, Steps: 13 | Train Loss: 0.577 Vali Loss: 1.001 Vali Acc: 0.517 Test Loss: 1.001 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516657).  Saving model ...
Epoch: 10 cost time: 0.7557971477508545
Epoch: 10, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.907 Vali Acc: 0.544 Test Loss: 0.907 Test Acc: 0.544
Validation loss decreased (-0.516657 --> -0.544435).  Saving model ...
Epoch: 11 cost time: 0.8094325065612793
Epoch: 11, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.913 Vali Acc: 0.494 Test Loss: 0.913 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.780632495880127
Epoch: 12, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.009 Vali Acc: 0.478 Test Loss: 1.009 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8060891628265381
Epoch: 13, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.916 Vali Acc: 0.533 Test Loss: 0.916 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8489148616790771
Epoch: 14, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.958 Vali Acc: 0.494 Test Loss: 0.958 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8323745727539062
Epoch: 15, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.927 Vali Acc: 0.483 Test Loss: 0.927 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.788707971572876
Epoch: 16, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.943 Vali Acc: 0.500 Test Loss: 0.943 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8009920120239258
Epoch: 17, Steps: 13 | Train Loss: 0.566 Vali Loss: 1.230 Vali Acc: 0.450 Test Loss: 1.230 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8163547515869141
Epoch: 18, Steps: 13 | Train Loss: 0.506 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7944130897521973
Epoch: 19, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.419 Vali Acc: 0.522 Test Loss: 1.419 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7959318161010742
Epoch: 20, Steps: 13 | Train Loss: 0.684 Vali Loss: 1.961 Vali Acc: 0.517 Test Loss: 1.961 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 142862
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3733088970184326
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.701 Vali Acc: 0.494 Test Loss: 0.701 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.8186893463134766
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 0.8379464149475098
Epoch: 3, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.715 Vali Acc: 0.517 Test Loss: 0.715 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 0.8287086486816406
Epoch: 4, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.712 Vali Acc: 0.511 Test Loss: 0.712 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8394238948822021
Epoch: 5, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.756 Vali Acc: 0.506 Test Loss: 0.756 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8590147495269775
Epoch: 6, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
Validation loss decreased (-0.516660 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 0.8162553310394287
Epoch: 7, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.729 Vali Acc: 0.539 Test Loss: 0.729 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6940665245056152
Epoch: 8, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.838 Vali Acc: 0.478 Test Loss: 0.838 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7970151901245117
Epoch: 9, Steps: 13 | Train Loss: 0.779 Vali Loss: 0.808 Vali Acc: 0.544 Test Loss: 0.808 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7284715175628662
Epoch: 10, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.834 Vali Acc: 0.494 Test Loss: 0.834 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7721390724182129
Epoch: 11, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.739 Vali Acc: 0.522 Test Loss: 0.739 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8089151382446289
Epoch: 12, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.817 Vali Acc: 0.506 Test Loss: 0.817 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7723100185394287
Epoch: 13, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.784 Vali Acc: 0.522 Test Loss: 0.784 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8309726715087891
Epoch: 14, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.771 Vali Acc: 0.511 Test Loss: 0.771 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7966263294219971
Epoch: 15, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.842 Vali Acc: 0.494 Test Loss: 0.842 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8123550415039062
Epoch: 16, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.754 Vali Acc: 0.556 Test Loss: 0.754 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555548).  Saving model ...
Epoch: 17 cost time: 0.8158438205718994
Epoch: 17, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.808 Vali Acc: 0.544 Test Loss: 0.808 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.775193452835083
Epoch: 18, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.998 Vali Acc: 0.517 Test Loss: 0.998 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8301308155059814
Epoch: 19, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.976 Vali Acc: 0.522 Test Loss: 0.976 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8039531707763672
Epoch: 20, Steps: 13 | Train Loss: 0.599 Vali Loss: 1.053 Vali Acc: 0.539 Test Loss: 1.053 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7855355739593506
Epoch: 21, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.986 Vali Acc: 0.517 Test Loss: 0.986 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7627952098846436
Epoch: 22, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.893 Vali Acc: 0.528 Test Loss: 0.893 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7920384407043457
Epoch: 23, Steps: 13 | Train Loss: 0.601 Vali Loss: 1.234 Vali Acc: 0.506 Test Loss: 1.234 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8543963432312012
Epoch: 24, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7677514553070068
Epoch: 25, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.926 Vali Acc: 0.533 Test Loss: 0.926 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8124425411224365
Epoch: 26, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.918 Vali Acc: 0.544 Test Loss: 0.918 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 142862
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.381087064743042
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.694 Vali Acc: 0.522 Test Loss: 0.694 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.7841691970825195
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.708 Vali Acc: 0.528 Test Loss: 0.708 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 0.8557891845703125
Epoch: 3, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.713 Vali Acc: 0.539 Test Loss: 0.713 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 0.8655591011047363
Epoch: 4, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 0.8495101928710938
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.825 Vali Acc: 0.533 Test Loss: 0.825 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8105487823486328
Epoch: 6, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.842 Vali Acc: 0.506 Test Loss: 0.842 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8705523014068604
Epoch: 7, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.856 Vali Acc: 0.544 Test Loss: 0.856 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8261833190917969
Epoch: 8, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.845 Vali Acc: 0.506 Test Loss: 0.845 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8306257724761963
Epoch: 9, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7191095352172852
Epoch: 10, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.860 Vali Acc: 0.528 Test Loss: 0.860 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8146023750305176
Epoch: 11, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.914 Vali Acc: 0.489 Test Loss: 0.914 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8011083602905273
Epoch: 12, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.980 Vali Acc: 0.517 Test Loss: 0.980 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8116681575775146
Epoch: 13, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.897 Vali Acc: 0.533 Test Loss: 0.897 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7840895652770996
Epoch: 14, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.949 Vali Acc: 0.544 Test Loss: 0.949 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 110094
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5674939155578613
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.699 Vali Acc: 0.506 Test Loss: 0.699 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 0.7654905319213867
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.714 Vali Acc: 0.494 Test Loss: 0.714 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7989044189453125
Epoch: 3, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.718 Vali Acc: 0.517 Test Loss: 0.718 Test Acc: 0.517
Validation loss decreased (-0.505549 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 0.7555150985717773
Epoch: 4, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.747 Vali Acc: 0.528 Test Loss: 0.747 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527770).  Saving model ...
Epoch: 5 cost time: 0.8124251365661621
Epoch: 5, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.821 Vali Acc: 0.528 Test Loss: 0.821 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7839300632476807
Epoch: 6, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.845 Vali Acc: 0.506 Test Loss: 0.845 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7863428592681885
Epoch: 7, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.900 Vali Acc: 0.567 Test Loss: 0.900 Test Acc: 0.567
Validation loss decreased (-0.527770 --> -0.566658).  Saving model ...
Epoch: 8 cost time: 0.7866086959838867
Epoch: 8, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.830 Vali Acc: 0.517 Test Loss: 0.830 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7991673946380615
Epoch: 9, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.848 Vali Acc: 0.528 Test Loss: 0.848 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7584629058837891
Epoch: 10, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.854 Vali Acc: 0.528 Test Loss: 0.854 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7939350605010986
Epoch: 11, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.876 Vali Acc: 0.506 Test Loss: 0.876 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8661596775054932
Epoch: 12, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.901 Vali Acc: 0.544 Test Loss: 0.901 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9218988418579102
Epoch: 13, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.918 Vali Acc: 0.517 Test Loss: 0.918 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8705227375030518
Epoch: 14, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.931 Vali Acc: 0.517 Test Loss: 0.931 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.82924485206604
Epoch: 15, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8059592247009277
Epoch: 16, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.245 Vali Acc: 0.522 Test Loss: 1.245 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7808201313018799
Epoch: 17, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.403 Vali Acc: 0.494 Test Loss: 1.403 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 110094
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.373039960861206
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.703 Vali Acc: 0.522 Test Loss: 0.703 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.782977819442749
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.713 Vali Acc: 0.506 Test Loss: 0.713 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7656652927398682
Epoch: 3, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.718 Vali Acc: 0.511 Test Loss: 0.718 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8071990013122559
Epoch: 4, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.746 Vali Acc: 0.489 Test Loss: 0.746 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8093585968017578
Epoch: 5, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.792 Vali Acc: 0.511 Test Loss: 0.792 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9331178665161133
Epoch: 6, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.898 Vali Acc: 0.456 Test Loss: 0.898 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8458757400512695
Epoch: 7, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.863 Vali Acc: 0.544 Test Loss: 0.863 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544436).  Saving model ...
Epoch: 8 cost time: 0.8007688522338867
Epoch: 8, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.844 Vali Acc: 0.528 Test Loss: 0.844 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7583730220794678
Epoch: 9, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.824 Vali Acc: 0.522 Test Loss: 0.824 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7400293350219727
Epoch: 10, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.845 Vali Acc: 0.506 Test Loss: 0.845 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8831830024719238
Epoch: 11, Steps: 13 | Train Loss: 0.447 Vali Loss: 1.053 Vali Acc: 0.500 Test Loss: 1.053 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.780634880065918
Epoch: 12, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.884 Vali Acc: 0.456 Test Loss: 0.884 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8308849334716797
Epoch: 13, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.945 Vali Acc: 0.522 Test Loss: 0.945 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7952907085418701
Epoch: 14, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.932 Vali Acc: 0.511 Test Loss: 0.932 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8288414478302002
Epoch: 15, Steps: 13 | Train Loss: 0.420 Vali Loss: 1.204 Vali Acc: 0.494 Test Loss: 1.204 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.845181941986084
Epoch: 16, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.053 Vali Acc: 0.506 Test Loss: 1.053 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8807733058929443
Epoch: 17, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.014 Vali Acc: 0.506 Test Loss: 1.014 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 110094
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.2980706691741943
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.719 Vali Acc: 0.489 Test Loss: 0.719 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 0.7672336101531982
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.710 Vali Acc: 0.494 Test Loss: 0.710 Test Acc: 0.494
Validation loss decreased (-0.488882 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 0.7442374229431152
Epoch: 3, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 0.7654178142547607
Epoch: 4, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.791 Vali Acc: 0.511 Test Loss: 0.791 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511103).  Saving model ...
Epoch: 5 cost time: 0.7603144645690918
Epoch: 5, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.881 Vali Acc: 0.489 Test Loss: 0.881 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7188704013824463
Epoch: 6, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.746 Vali Acc: 0.472 Test Loss: 0.746 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7603263854980469
Epoch: 7, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.766 Vali Acc: 0.506 Test Loss: 0.766 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.779780387878418
Epoch: 8, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.727 Vali Acc: 0.489 Test Loss: 0.727 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7230558395385742
Epoch: 9, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.776 Vali Acc: 0.489 Test Loss: 0.776 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7632195949554443
Epoch: 10, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.920 Vali Acc: 0.517 Test Loss: 0.920 Test Acc: 0.517
Validation loss decreased (-0.511103 --> -0.516657).  Saving model ...
Epoch: 11 cost time: 0.7399091720581055
Epoch: 11, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.777 Vali Acc: 0.483 Test Loss: 0.777 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7660155296325684
Epoch: 12, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.915 Vali Acc: 0.517 Test Loss: 0.915 Test Acc: 0.517
Validation loss decreased (-0.516657 --> -0.516658).  Saving model ...
Epoch: 13 cost time: 0.7099754810333252
Epoch: 13, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7249157428741455
Epoch: 14, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.874 Vali Acc: 0.544 Test Loss: 0.874 Test Acc: 0.544
Validation loss decreased (-0.516658 --> -0.544436).  Saving model ...
Epoch: 15 cost time: 0.741661548614502
Epoch: 15, Steps: 13 | Train Loss: 0.590 Vali Loss: 1.164 Vali Acc: 0.506 Test Loss: 1.164 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7203817367553711
Epoch: 16, Steps: 13 | Train Loss: 0.762 Vali Loss: 1.102 Vali Acc: 0.483 Test Loss: 1.102 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8069508075714111
Epoch: 17, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.792 Vali Acc: 0.544 Test Loss: 0.792 Test Acc: 0.544
Validation loss decreased (-0.544436 --> -0.544437).  Saving model ...
Epoch: 18 cost time: 0.7072033882141113
Epoch: 18, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.909 Vali Acc: 0.517 Test Loss: 0.909 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.742600679397583
Epoch: 19, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.802 Vali Acc: 0.528 Test Loss: 0.802 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7900698184967041
Epoch: 20, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.848 Vali Acc: 0.506 Test Loss: 0.848 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7784318923950195
Epoch: 21, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.893 Vali Acc: 0.483 Test Loss: 0.893 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7962806224822998
Epoch: 22, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.998 Vali Acc: 0.494 Test Loss: 0.998 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.831740140914917
Epoch: 23, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.916 Vali Acc: 0.522 Test Loss: 0.916 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7645556926727295
Epoch: 24, Steps: 13 | Train Loss: 0.650 Vali Loss: 1.061 Vali Acc: 0.550 Test Loss: 1.061 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549989).  Saving model ...
Epoch: 25 cost time: 0.7805650234222412
Epoch: 25, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.001 Vali Acc: 0.483 Test Loss: 1.001 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.763096809387207
Epoch: 26, Steps: 13 | Train Loss: 0.495 Vali Loss: 1.154 Vali Acc: 0.533 Test Loss: 1.154 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8776741027832031
Epoch: 27, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.887 Vali Acc: 0.578 Test Loss: 0.887 Test Acc: 0.578
Validation loss decreased (-0.549989 --> -0.577769).  Saving model ...
Epoch: 28 cost time: 0.831561803817749
Epoch: 28, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.063 Vali Acc: 0.522 Test Loss: 1.063 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7898995876312256
Epoch: 29, Steps: 13 | Train Loss: 0.447 Vali Loss: 1.212 Vali Acc: 0.483 Test Loss: 1.212 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8986313343048096
Epoch: 30, Steps: 13 | Train Loss: 0.476 Vali Loss: 1.016 Vali Acc: 0.506 Test Loss: 1.016 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8242506980895996
Epoch: 31, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.397 Vali Acc: 0.528 Test Loss: 1.397 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7929410934448242
Epoch: 32, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.216 Vali Acc: 0.489 Test Loss: 1.216 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7834844589233398
Epoch: 33, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.162 Vali Acc: 0.517 Test Loss: 1.162 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7827320098876953
Epoch: 34, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.209 Vali Acc: 0.539 Test Loss: 1.209 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7786846160888672
Epoch: 35, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.383 Vali Acc: 0.478 Test Loss: 1.383 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7464652061462402
Epoch: 36, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.340 Vali Acc: 0.511 Test Loss: 1.340 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8100705146789551
Epoch: 37, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.181 Vali Acc: 0.489 Test Loss: 1.181 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 110094
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5125606060028076
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.754 Vali Acc: 0.489 Test Loss: 0.754 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 0.7886717319488525
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.705 Vali Acc: 0.511 Test Loss: 0.705 Test Acc: 0.511
Validation loss decreased (-0.488881 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 0.7414364814758301
Epoch: 3, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8746232986450195
Epoch: 4, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.863 Vali Acc: 0.517 Test Loss: 0.863 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516658).  Saving model ...
Epoch: 5 cost time: 0.8138811588287354
Epoch: 5, Steps: 13 | Train Loss: 0.593 Vali Loss: 1.091 Vali Acc: 0.489 Test Loss: 1.091 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8482329845428467
Epoch: 6, Steps: 13 | Train Loss: 0.825 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.952643632888794
Epoch: 7, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.814 Vali Acc: 0.522 Test Loss: 0.814 Test Acc: 0.522
Validation loss decreased (-0.516658 --> -0.522214).  Saving model ...
Epoch: 8 cost time: 0.752812385559082
Epoch: 8, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.786 Vali Acc: 0.561 Test Loss: 0.786 Test Acc: 0.561
Validation loss decreased (-0.522214 --> -0.561103).  Saving model ...
Epoch: 9 cost time: 0.8065841197967529
Epoch: 9, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.873 Vali Acc: 0.528 Test Loss: 0.873 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.799309492111206
Epoch: 10, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.868 Vali Acc: 0.522 Test Loss: 0.868 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8417568206787109
Epoch: 11, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.891 Vali Acc: 0.506 Test Loss: 0.891 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8300127983093262
Epoch: 12, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.983 Vali Acc: 0.517 Test Loss: 0.983 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.838019609451294
Epoch: 13, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.489 Vali Acc: 0.500 Test Loss: 1.489 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8375937938690186
Epoch: 14, Steps: 13 | Train Loss: 0.493 Vali Loss: 1.077 Vali Acc: 0.556 Test Loss: 1.077 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8010799884796143
Epoch: 15, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.075 Vali Acc: 0.500 Test Loss: 1.075 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8404252529144287
Epoch: 16, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.734 Vali Acc: 0.494 Test Loss: 1.734 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8168618679046631
Epoch: 17, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.116 Vali Acc: 0.544 Test Loss: 1.116 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8081185817718506
Epoch: 18, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.547 Vali Acc: 0.500 Test Loss: 1.547 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 93710
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.327378273010254
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.8050410747528076
Epoch: 2, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.708 Vali Acc: 0.478 Test Loss: 0.708 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8543353080749512
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.725 Vali Acc: 0.528 Test Loss: 0.725 Test Acc: 0.528
Validation loss decreased (-0.499993 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 0.8071761131286621
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.790 Vali Acc: 0.489 Test Loss: 0.790 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8115956783294678
Epoch: 5, Steps: 13 | Train Loss: 0.590 Vali Loss: 1.065 Vali Acc: 0.494 Test Loss: 1.065 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8128588199615479
Epoch: 6, Steps: 13 | Train Loss: 0.812 Vali Loss: 0.814 Vali Acc: 0.511 Test Loss: 0.814 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7931492328643799
Epoch: 7, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.815 Vali Acc: 0.506 Test Loss: 0.815 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.804194450378418
Epoch: 8, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.797 Vali Acc: 0.544 Test Loss: 0.797 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544436).  Saving model ...
Epoch: 9 cost time: 0.7993505001068115
Epoch: 9, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.791 Vali Acc: 0.522 Test Loss: 0.791 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8480896949768066
Epoch: 10, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.844 Vali Acc: 0.489 Test Loss: 0.844 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8442959785461426
Epoch: 11, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.963 Vali Acc: 0.483 Test Loss: 0.963 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8489651679992676
Epoch: 12, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.938 Vali Acc: 0.522 Test Loss: 0.938 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9008598327636719
Epoch: 13, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.445 Vali Acc: 0.494 Test Loss: 1.445 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8118205070495605
Epoch: 14, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.987 Vali Acc: 0.517 Test Loss: 0.987 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7812454700469971
Epoch: 15, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.980 Vali Acc: 0.494 Test Loss: 0.980 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7697081565856934
Epoch: 16, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.093 Vali Acc: 0.456 Test Loss: 1.093 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8031108379364014
Epoch: 17, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.290 Vali Acc: 0.489 Test Loss: 1.290 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8187487125396729
Epoch: 18, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.612 Vali Acc: 0.500 Test Loss: 1.612 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 93710
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3596203327178955
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.734 Vali Acc: 0.506 Test Loss: 0.734 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 0.8135116100311279
Epoch: 2, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.717 Vali Acc: 0.467 Test Loss: 0.717 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7123467922210693
Epoch: 3, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.732 Vali Acc: 0.506 Test Loss: 0.732 Test Acc: 0.506
Validation loss decreased (-0.505548 --> -0.505548).  Saving model ...
Epoch: 4 cost time: 0.7656786441802979
Epoch: 4, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.789 Vali Acc: 0.511 Test Loss: 0.789 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511103).  Saving model ...
Epoch: 5 cost time: 0.8188543319702148
Epoch: 5, Steps: 13 | Train Loss: 0.646 Vali Loss: 1.106 Vali Acc: 0.506 Test Loss: 1.106 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7384757995605469
Epoch: 6, Steps: 13 | Train Loss: 0.881 Vali Loss: 0.821 Vali Acc: 0.472 Test Loss: 0.821 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7269012928009033
Epoch: 7, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.773 Vali Acc: 0.478 Test Loss: 0.773 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7957859039306641
Epoch: 8, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.769 Vali Acc: 0.478 Test Loss: 0.769 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7712798118591309
Epoch: 9, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.782 Vali Acc: 0.472 Test Loss: 0.782 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7634983062744141
Epoch: 10, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.825 Vali Acc: 0.511 Test Loss: 0.825 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7908868789672852
Epoch: 11, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.918 Vali Acc: 0.472 Test Loss: 0.918 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.765923261642456
Epoch: 12, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.958 Vali Acc: 0.506 Test Loss: 0.958 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7402868270874023
Epoch: 13, Steps: 13 | Train Loss: 0.476 Vali Loss: 1.499 Vali Acc: 0.500 Test Loss: 1.499 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.715660810470581
Epoch: 14, Steps: 13 | Train Loss: 0.729 Vali Loss: 1.082 Vali Acc: 0.461 Test Loss: 1.082 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 93710
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.2887001037597656
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.720 Vali Acc: 0.506 Test Loss: 0.720 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 0.7918393611907959
Epoch: 2, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.715 Vali Acc: 0.533 Test Loss: 0.715 Test Acc: 0.533
Validation loss decreased (-0.505548 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 0.7382605075836182
Epoch: 3, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7598617076873779
Epoch: 4, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.827 Vali Acc: 0.506 Test Loss: 0.827 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7681179046630859
Epoch: 5, Steps: 13 | Train Loss: 0.722 Vali Loss: 1.008 Vali Acc: 0.511 Test Loss: 1.008 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7530686855316162
Epoch: 6, Steps: 13 | Train Loss: 0.952 Vali Loss: 0.768 Vali Acc: 0.511 Test Loss: 0.768 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7340037822723389
Epoch: 7, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.752 Vali Acc: 0.506 Test Loss: 0.752 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7825260162353516
Epoch: 8, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.723 Vali Acc: 0.517 Test Loss: 0.723 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8095383644104004
Epoch: 9, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.740 Vali Acc: 0.556 Test Loss: 0.740 Test Acc: 0.556
Validation loss decreased (-0.533326 --> -0.555548).  Saving model ...
Epoch: 10 cost time: 0.6635391712188721
Epoch: 10, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.733 Vali Acc: 0.506 Test Loss: 0.733 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7730433940887451
Epoch: 11, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.844 Vali Acc: 0.511 Test Loss: 0.844 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.729133129119873
Epoch: 12, Steps: 13 | Train Loss: 0.623 Vali Loss: 1.026 Vali Acc: 0.511 Test Loss: 1.026 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6845338344573975
Epoch: 13, Steps: 13 | Train Loss: 0.626 Vali Loss: 1.292 Vali Acc: 0.506 Test Loss: 1.292 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7265195846557617
Epoch: 14, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.942 Vali Acc: 0.489 Test Loss: 0.942 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7506504058837891
Epoch: 15, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.804 Vali Acc: 0.517 Test Loss: 0.804 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7511298656463623
Epoch: 16, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.980 Vali Acc: 0.511 Test Loss: 0.980 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6286957263946533
Epoch: 17, Steps: 13 | Train Loss: 0.688 Vali Loss: 1.306 Vali Acc: 0.517 Test Loss: 1.306 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.727543830871582
Epoch: 18, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.997 Vali Acc: 0.494 Test Loss: 0.997 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7719361782073975
Epoch: 19, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.895 Vali Acc: 0.500 Test Loss: 0.895 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 93710
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.559602737426758
Epoch: 1, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.688 Vali Acc: 0.467 Test Loss: 0.688 Test Acc: 0.467
Validation loss decreased (inf --> -0.466660).  Saving model ...
Epoch: 2 cost time: 0.855147123336792
Epoch: 2, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.710 Vali Acc: 0.539 Test Loss: 0.710 Test Acc: 0.539
Validation loss decreased (-0.466660 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 0.8347887992858887
Epoch: 3, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.780 Vali Acc: 0.539 Test Loss: 0.780 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8362972736358643
Epoch: 4, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.741 Vali Acc: 0.489 Test Loss: 0.741 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8602306842803955
Epoch: 5, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.765 Vali Acc: 0.489 Test Loss: 0.765 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.811795711517334
Epoch: 6, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 0.7257864475250244
Epoch: 7, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.760 Vali Acc: 0.522 Test Loss: 0.760 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7487878799438477
Epoch: 8, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.930 Vali Acc: 0.556 Test Loss: 0.930 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555546).  Saving model ...
Epoch: 9 cost time: 0.8310568332672119
Epoch: 9, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.831 Vali Acc: 0.522 Test Loss: 0.831 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9314184188842773
Epoch: 10, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.812 Vali Acc: 0.506 Test Loss: 0.812 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7859318256378174
Epoch: 11, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.911 Vali Acc: 0.522 Test Loss: 0.911 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.844872236251831
Epoch: 12, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.997 Vali Acc: 0.506 Test Loss: 0.997 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8690307140350342
Epoch: 13, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.088 Vali Acc: 0.511 Test Loss: 1.088 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8147966861724854
Epoch: 14, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.995 Vali Acc: 0.528 Test Loss: 0.995 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7852203845977783
Epoch: 15, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.152 Vali Acc: 0.511 Test Loss: 1.152 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8440535068511963
Epoch: 16, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.253 Vali Acc: 0.544 Test Loss: 1.253 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8492588996887207
Epoch: 17, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.018 Vali Acc: 0.528 Test Loss: 1.018 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8424842357635498
Epoch: 18, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.043 Vali Acc: 0.561 Test Loss: 1.043 Test Acc: 0.561
Validation loss decreased (-0.555546 --> -0.561101).  Saving model ...
Epoch: 19 cost time: 0.8550515174865723
Epoch: 19, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.386 Vali Acc: 0.528 Test Loss: 1.386 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8731193542480469
Epoch: 20, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.606 Vali Acc: 0.517 Test Loss: 1.606 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8263475894927979
Epoch: 21, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.261 Vali Acc: 0.550 Test Loss: 1.261 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8130776882171631
Epoch: 22, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.430 Vali Acc: 0.506 Test Loss: 1.430 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8215174674987793
Epoch: 23, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.405 Vali Acc: 0.522 Test Loss: 1.405 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8369960784912109
Epoch: 24, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.353 Vali Acc: 0.506 Test Loss: 1.353 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8287115097045898
Epoch: 25, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.496 Vali Acc: 0.528 Test Loss: 1.496 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8221321105957031
Epoch: 26, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.420 Vali Acc: 0.550 Test Loss: 1.420 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8222560882568359
Epoch: 27, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.964 Vali Acc: 0.528 Test Loss: 1.964 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.820002555847168
Epoch: 28, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.398 Vali Acc: 0.522 Test Loss: 1.398 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 85518
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3425371646881104
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.689 Vali Acc: 0.522 Test Loss: 0.689 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.8009700775146484
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.705 Vali Acc: 0.539 Test Loss: 0.705 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 0.8121824264526367
Epoch: 3, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.765 Vali Acc: 0.544 Test Loss: 0.765 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 0.834770679473877
Epoch: 4, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8325862884521484
Epoch: 5, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.778 Vali Acc: 0.489 Test Loss: 0.778 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8515281677246094
Epoch: 6, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.744 Vali Acc: 0.522 Test Loss: 0.744 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7857112884521484
Epoch: 7, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.827 Vali Acc: 0.489 Test Loss: 0.827 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7963571548461914
Epoch: 8, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.829 Vali Acc: 0.528 Test Loss: 0.829 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8029148578643799
Epoch: 9, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.850 Vali Acc: 0.483 Test Loss: 0.850 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8454873561859131
Epoch: 10, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.877 Vali Acc: 0.539 Test Loss: 0.877 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8178665637969971
Epoch: 11, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.011 Vali Acc: 0.500 Test Loss: 1.011 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9332506656646729
Epoch: 12, Steps: 13 | Train Loss: 0.500 Vali Loss: 1.013 Vali Acc: 0.522 Test Loss: 1.013 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.807997465133667
Epoch: 13, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 85518
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4207701683044434
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.695 Vali Acc: 0.517 Test Loss: 0.695 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 0.716454267501831
Epoch: 2, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.705 Vali Acc: 0.506 Test Loss: 0.705 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7648487091064453
Epoch: 3, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.743 Vali Acc: 0.539 Test Loss: 0.743 Test Acc: 0.539
Validation loss decreased (-0.516660 --> -0.538881).  Saving model ...
Epoch: 4 cost time: 0.7770280838012695
Epoch: 4, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.745 Vali Acc: 0.489 Test Loss: 0.745 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7829313278198242
Epoch: 5, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.763 Vali Acc: 0.483 Test Loss: 0.763 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8008780479431152
Epoch: 6, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.733 Vali Acc: 0.489 Test Loss: 0.733 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8494875431060791
Epoch: 7, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.808 Vali Acc: 0.456 Test Loss: 0.808 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8301515579223633
Epoch: 8, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.847 Vali Acc: 0.472 Test Loss: 0.847 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8664889335632324
Epoch: 9, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.841 Vali Acc: 0.461 Test Loss: 0.841 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8511703014373779
Epoch: 10, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.816 Vali Acc: 0.506 Test Loss: 0.816 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8368215560913086
Epoch: 11, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.936 Vali Acc: 0.500 Test Loss: 0.936 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8092575073242188
Epoch: 12, Steps: 13 | Train Loss: 0.602 Vali Loss: 1.037 Vali Acc: 0.517 Test Loss: 1.037 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7958252429962158
Epoch: 13, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.017 Vali Acc: 0.483 Test Loss: 1.017 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 85518
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.37933349609375
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.695 Vali Acc: 0.522 Test Loss: 0.695 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.7661862373352051
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.692 Vali Acc: 0.533 Test Loss: 0.692 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 0.7949886322021484
Epoch: 3, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.695 Vali Acc: 0.544 Test Loss: 0.695 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 0.7954192161560059
Epoch: 4, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.748 Vali Acc: 0.511 Test Loss: 0.748 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8543479442596436
Epoch: 5, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.888 Vali Acc: 0.506 Test Loss: 0.888 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7988028526306152
Epoch: 6, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.802 Vali Acc: 0.489 Test Loss: 0.802 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7534887790679932
Epoch: 7, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.715 Vali Acc: 0.517 Test Loss: 0.715 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.782313346862793
Epoch: 8, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.871 Vali Acc: 0.522 Test Loss: 0.871 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8130738735198975
Epoch: 9, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.824 Vali Acc: 0.539 Test Loss: 0.824 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7766532897949219
Epoch: 10, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.844 Vali Acc: 0.478 Test Loss: 0.844 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7503547668457031
Epoch: 11, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.751 Vali Acc: 0.506 Test Loss: 0.751 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7654907703399658
Epoch: 12, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.867 Vali Acc: 0.494 Test Loss: 0.867 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7721624374389648
Epoch: 13, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.843 Vali Acc: 0.522 Test Loss: 0.843 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 85518
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3952579498291016
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.730 Vali Acc: 0.494 Test Loss: 0.730 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.7976534366607666
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.702 Vali Acc: 0.506 Test Loss: 0.702 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505549).  Saving model ...
Epoch: 3 cost time: 0.8020522594451904
Epoch: 3, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.752 Vali Acc: 0.478 Test Loss: 0.752 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7899820804595947
Epoch: 4, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.807 Vali Acc: 0.478 Test Loss: 0.807 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7847778797149658
Epoch: 5, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.751 Vali Acc: 0.517 Test Loss: 0.751 Test Acc: 0.517
Validation loss decreased (-0.505549 --> -0.516659).  Saving model ...
Epoch: 6 cost time: 0.8169960975646973
Epoch: 6, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.865 Vali Acc: 0.522 Test Loss: 0.865 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522214).  Saving model ...
Epoch: 7 cost time: 0.8411271572113037
Epoch: 7, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
Validation loss decreased (-0.522214 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 0.7973260879516602
Epoch: 8, Steps: 13 | Train Loss: 0.611 Vali Loss: 1.119 Vali Acc: 0.483 Test Loss: 1.119 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8221511840820312
Epoch: 9, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.995 Vali Acc: 0.528 Test Loss: 0.995 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8113489151000977
Epoch: 10, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.934 Vali Acc: 0.544 Test Loss: 0.934 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8137006759643555
Epoch: 11, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.007 Vali Acc: 0.500 Test Loss: 1.007 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7534606456756592
Epoch: 12, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.009 Vali Acc: 0.506 Test Loss: 1.009 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7983083724975586
Epoch: 13, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8193094730377197
Epoch: 14, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.018 Vali Acc: 0.539 Test Loss: 1.018 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.821826696395874
Epoch: 15, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.045 Vali Acc: 0.522 Test Loss: 1.045 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.801537036895752
Epoch: 16, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.056 Vali Acc: 0.506 Test Loss: 1.056 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7233459949493408
Epoch: 17, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 81422
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.283396005630493
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.733 Vali Acc: 0.489 Test Loss: 0.733 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 0.8060059547424316
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.708 Vali Acc: 0.533 Test Loss: 0.708 Test Acc: 0.533
Validation loss decreased (-0.488882 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 0.8726425170898438
Epoch: 3, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.747 Vali Acc: 0.478 Test Loss: 0.747 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7696785926818848
Epoch: 4, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.741 Vali Acc: 0.533 Test Loss: 0.741 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7812902927398682
Epoch: 5, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.737 Vali Acc: 0.467 Test Loss: 0.737 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.834913969039917
Epoch: 6, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.869 Vali Acc: 0.539 Test Loss: 0.869 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538880).  Saving model ...
Epoch: 7 cost time: 0.8077085018157959
Epoch: 7, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.788 Vali Acc: 0.517 Test Loss: 0.788 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7876696586608887
Epoch: 8, Steps: 13 | Train Loss: 0.615 Vali Loss: 1.166 Vali Acc: 0.461 Test Loss: 1.166 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7671904563903809
Epoch: 9, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.969 Vali Acc: 0.517 Test Loss: 0.969 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8314752578735352
Epoch: 10, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.883 Vali Acc: 0.489 Test Loss: 0.883 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.852057695388794
Epoch: 11, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.876 Vali Acc: 0.511 Test Loss: 0.876 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7930471897125244
Epoch: 12, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.949 Vali Acc: 0.483 Test Loss: 0.949 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7634520530700684
Epoch: 13, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.990 Vali Acc: 0.500 Test Loss: 0.990 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7837803363800049
Epoch: 14, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.982 Vali Acc: 0.517 Test Loss: 0.982 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9471039772033691
Epoch: 15, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8262689113616943
Epoch: 16, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.104 Vali Acc: 0.528 Test Loss: 1.104 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 81422
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4586985111236572
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.734 Vali Acc: 0.489 Test Loss: 0.734 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 0.7998154163360596
Epoch: 2, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.704 Vali Acc: 0.483 Test Loss: 0.704 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8343570232391357
Epoch: 3, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (-0.488882 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 0.8270018100738525
Epoch: 4, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.738 Vali Acc: 0.489 Test Loss: 0.738 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8319356441497803
Epoch: 5, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.729 Vali Acc: 0.483 Test Loss: 0.729 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7939672470092773
Epoch: 6, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.829 Vali Acc: 0.478 Test Loss: 0.829 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7686116695404053
Epoch: 7, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.893 Vali Acc: 0.467 Test Loss: 0.893 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7951085567474365
Epoch: 8, Steps: 13 | Train Loss: 0.575 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8262321949005127
Epoch: 9, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.834 Vali Acc: 0.467 Test Loss: 0.834 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7921078205108643
Epoch: 10, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8398878574371338
Epoch: 11, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.877 Vali Acc: 0.511 Test Loss: 0.877 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511102).  Saving model ...
Epoch: 12 cost time: 0.8258399963378906
Epoch: 12, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.973 Vali Acc: 0.494 Test Loss: 0.973 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8732774257659912
Epoch: 13, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.967 Vali Acc: 0.494 Test Loss: 0.967 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8503279685974121
Epoch: 14, Steps: 13 | Train Loss: 0.509 Vali Loss: 1.066 Vali Acc: 0.494 Test Loss: 1.066 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8942980766296387
Epoch: 15, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.000 Vali Acc: 0.506 Test Loss: 1.000 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.810199499130249
Epoch: 16, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9264452457427979
Epoch: 17, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.062 Vali Acc: 0.494 Test Loss: 1.062 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7896120548248291
Epoch: 18, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.965 Vali Acc: 0.489 Test Loss: 0.965 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8162813186645508
Epoch: 19, Steps: 13 | Train Loss: 0.456 Vali Loss: 1.060 Vali Acc: 0.494 Test Loss: 1.060 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7910885810852051
Epoch: 20, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8644418716430664
Epoch: 21, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.261 Vali Acc: 0.494 Test Loss: 1.261 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 81422
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5194640159606934
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.719 Vali Acc: 0.511 Test Loss: 0.719 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.7821533679962158
Epoch: 2, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.700 Vali Acc: 0.472 Test Loss: 0.700 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9726986885070801
Epoch: 3, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8618173599243164
Epoch: 4, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.771 Vali Acc: 0.517 Test Loss: 0.771 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516659).  Saving model ...
Epoch: 5 cost time: 0.8084287643432617
Epoch: 5, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.722 Vali Acc: 0.444 Test Loss: 0.722 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8014554977416992
Epoch: 6, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.776 Vali Acc: 0.489 Test Loss: 0.776 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8269293308258057
Epoch: 7, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8547201156616211
Epoch: 8, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.878 Vali Acc: 0.539 Test Loss: 0.878 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538880).  Saving model ...
Epoch: 9 cost time: 0.7991764545440674
Epoch: 9, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.968 Vali Acc: 0.500 Test Loss: 0.968 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7961971759796143
Epoch: 10, Steps: 13 | Train Loss: 0.721 Vali Loss: 1.028 Vali Acc: 0.522 Test Loss: 1.028 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7778828144073486
Epoch: 11, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.875 Vali Acc: 0.522 Test Loss: 0.875 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8370029926300049
Epoch: 12, Steps: 13 | Train Loss: 0.815 Vali Loss: 0.941 Vali Acc: 0.544 Test Loss: 0.941 Test Acc: 0.544
Validation loss decreased (-0.538880 --> -0.544435).  Saving model ...
Epoch: 13 cost time: 0.8878781795501709
Epoch: 13, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.818 Vali Acc: 0.467 Test Loss: 0.818 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8789923191070557
Epoch: 14, Steps: 13 | Train Loss: 0.674 Vali Loss: 1.000 Vali Acc: 0.567 Test Loss: 1.000 Test Acc: 0.567
Validation loss decreased (-0.544435 --> -0.566657).  Saving model ...
Epoch: 15 cost time: 0.8497309684753418
Epoch: 15, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.839 Vali Acc: 0.544 Test Loss: 0.839 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8851203918457031
Epoch: 16, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.810 Vali Acc: 0.483 Test Loss: 0.810 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8460562229156494
Epoch: 17, Steps: 13 | Train Loss: 0.702 Vali Loss: 1.261 Vali Acc: 0.522 Test Loss: 1.261 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8085064888000488
Epoch: 18, Steps: 13 | Train Loss: 0.583 Vali Loss: 1.009 Vali Acc: 0.506 Test Loss: 1.009 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7898843288421631
Epoch: 19, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.900 Vali Acc: 0.511 Test Loss: 0.900 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8046653270721436
Epoch: 20, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7964308261871338
Epoch: 21, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.912 Vali Acc: 0.539 Test Loss: 0.912 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8456227779388428
Epoch: 22, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.834 Vali Acc: 0.528 Test Loss: 0.834 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.772005558013916
Epoch: 23, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.837 Vali Acc: 0.550 Test Loss: 0.837 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8140580654144287
Epoch: 24, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.826 Vali Acc: 0.544 Test Loss: 0.826 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_ETSformer_UEA_ftM_sl1152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 81422
model size : 0.93MB
