Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.620702028274536
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.237 Vali Acc: 0.421 Test Loss: 1.237 Test Acc: 0.421
Validation loss decreased (inf --> -0.421040).  Saving model ...
Epoch: 2 cost time: 1.668485164642334
Epoch: 2, Steps: 10 | Train Loss: 1.018 Vali Loss: 0.916 Vali Acc: 0.632 Test Loss: 0.916 Test Acc: 0.632
Validation loss decreased (-0.421040 --> -0.631570).  Saving model ...
Epoch: 3 cost time: 1.8825500011444092
Epoch: 3, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.704 Vali Acc: 0.711 Test Loss: 0.704 Test Acc: 0.711
Validation loss decreased (-0.631570 --> -0.710519).  Saving model ...
Epoch: 4 cost time: 1.8811042308807373
Epoch: 4, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.611 Vali Acc: 0.730 Test Loss: 0.611 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 1.8734309673309326
Epoch: 5, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
Validation loss decreased (-0.730257 --> -0.782889).  Saving model ...
Epoch: 6 cost time: 1.8986828327178955
Epoch: 6, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.516 Vali Acc: 0.776 Test Loss: 0.516 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.724250316619873
Epoch: 7, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.9660370349884033
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.7417981624603271
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.8007583618164062
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.796 Test Loss: 0.580 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.899850845336914
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.483461618423462
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6307270526885986
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.809 Test Loss: 0.607 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6335387229919434
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.614 Vali Acc: 0.816 Test Loss: 0.614 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5081923007965088
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.610313892364502
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7815179824829102
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.024073839187622
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6736423969268799
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8212404251098633
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.816 Test Loss: 0.647 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6135079860687256
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.816 Test Loss: 0.650 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 5336148
model size : 30.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9498112201690674
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.235 Vali Acc: 0.487 Test Loss: 1.235 Test Acc: 0.487
Validation loss decreased (inf --> -0.486830).  Saving model ...
Epoch: 2 cost time: 1.7236433029174805
Epoch: 2, Steps: 10 | Train Loss: 1.023 Vali Loss: 0.916 Vali Acc: 0.645 Test Loss: 0.916 Test Acc: 0.645
Validation loss decreased (-0.486830 --> -0.644728).  Saving model ...
Epoch: 3 cost time: 1.8167188167572021
Epoch: 3, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
Validation loss decreased (-0.644728 --> -0.717098).  Saving model ...
Epoch: 4 cost time: 1.7886254787445068
Epoch: 4, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.595 Vali Acc: 0.743 Test Loss: 0.595 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 1.9610786437988281
Epoch: 5, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 1.7908008098602295
Epoch: 6, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.507 Vali Acc: 0.776 Test Loss: 0.507 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776311).  Saving model ...
Epoch: 7 cost time: 1.5194923877716064
Epoch: 7, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.521 Vali Acc: 0.770 Test Loss: 0.521 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8284904956817627
Epoch: 8, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6592884063720703
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7309107780456543
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8815126419067383
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.795630693435669
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6719133853912354
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.8174355030059814
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.71952486038208
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.012714385986328
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.063180446624756
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.8601794242858887
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8342187404632568
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.764845848083496
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.867171287536621
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7049202919006348
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.041860342025757
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9219555854797363
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.789 Test Loss: 0.641 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6605558395385742
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7097907066345215
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.034696340560913
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.789 Test Loss: 0.660 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 5336148
model size : 30.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.249706268310547
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.7789433002471924
Epoch: 2, Steps: 10 | Train Loss: 1.035 Vali Loss: 0.931 Vali Acc: 0.658 Test Loss: 0.931 Test Acc: 0.658
Validation loss decreased (-0.499988 --> -0.657885).  Saving model ...
Epoch: 3 cost time: 1.7553534507751465
Epoch: 3, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.709 Vali Acc: 0.730 Test Loss: 0.709 Test Acc: 0.730
Validation loss decreased (-0.657885 --> -0.730256).  Saving model ...
Epoch: 4 cost time: 1.7924630641937256
Epoch: 4, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.588 Vali Acc: 0.730 Test Loss: 0.588 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 2.0392184257507324
Epoch: 5, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
Validation loss decreased (-0.730257 --> -0.769732).  Saving model ...
Epoch: 6 cost time: 1.9570772647857666
Epoch: 6, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
Validation loss decreased (-0.769732 --> -0.802627).  Saving model ...
Epoch: 7 cost time: 1.5259521007537842
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.791506052017212
Epoch: 8, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.467 Vali Acc: 0.829 Test Loss: 0.467 Test Acc: 0.829
Validation loss decreased (-0.802627 --> -0.828943).  Saving model ...
Epoch: 9 cost time: 1.8176991939544678
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.518444299697876
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8729608058929443
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.893561840057373
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.655287504196167
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9618163108825684
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.980391502380371
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7400119304656982
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.836 Test Loss: 0.536 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 17 cost time: 1.8519353866577148
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.836 Test Loss: 0.540 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0038809776306152
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9576826095581055
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.829 Test Loss: 0.556 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.779836654663086
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8906962871551514
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9198622703552246
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8356904983520508
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5258092880249023
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.829 Test Loss: 0.577 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.819565773010254
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8869779109954834
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.829 Test Loss: 0.592 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 5336148
model size : 30.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.223584890365601
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.237 Vali Acc: 0.520 Test Loss: 1.237 Test Acc: 0.520
Validation loss decreased (inf --> -0.519724).  Saving model ...
Epoch: 2 cost time: 1.7428667545318604
Epoch: 2, Steps: 10 | Train Loss: 1.077 Vali Loss: 0.977 Vali Acc: 0.684 Test Loss: 0.977 Test Acc: 0.684
Validation loss decreased (-0.519724 --> -0.684201).  Saving model ...
Epoch: 3 cost time: 1.7216014862060547
Epoch: 3, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.745 Vali Acc: 0.737 Test Loss: 0.745 Test Acc: 0.737
Validation loss decreased (-0.684201 --> -0.736835).  Saving model ...
Epoch: 4 cost time: 1.6756830215454102
Epoch: 4, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.598 Vali Acc: 0.770 Test Loss: 0.598 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.9426777362823486
Epoch: 5, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782890).  Saving model ...
Epoch: 6 cost time: 2.0399603843688965
Epoch: 6, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.447 Vali Acc: 0.796 Test Loss: 0.447 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 7 cost time: 1.7792515754699707
Epoch: 7, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.444 Vali Acc: 0.829 Test Loss: 0.444 Test Acc: 0.829
Validation loss decreased (-0.796048 --> -0.828943).  Saving model ...
Epoch: 8 cost time: 1.6103334426879883
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.437 Vali Acc: 0.829 Test Loss: 0.437 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 9 cost time: 1.8670809268951416
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.453 Vali Acc: 0.816 Test Loss: 0.453 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.019671678543091
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7916290760040283
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.470 Vali Acc: 0.816 Test Loss: 0.470 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7864880561828613
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.533370018005371
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.702505111694336
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5620434284210205
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9131369590759277
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8566479682922363
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6558504104614258
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 5336148
model size : 30.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.7815752029418945
Epoch: 1, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.221 Vali Acc: 0.408 Test Loss: 1.221 Test Acc: 0.408
Validation loss decreased (inf --> -0.407883).  Saving model ...
Epoch: 2 cost time: 1.8869128227233887
Epoch: 2, Steps: 10 | Train Loss: 1.028 Vali Loss: 0.887 Vali Acc: 0.651 Test Loss: 0.887 Test Acc: 0.651
Validation loss decreased (-0.407883 --> -0.651307).  Saving model ...
Epoch: 3 cost time: 1.6870081424713135
Epoch: 3, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.670 Vali Acc: 0.763 Test Loss: 0.670 Test Acc: 0.763
Validation loss decreased (-0.651307 --> -0.763151).  Saving model ...
Epoch: 4 cost time: 1.892571210861206
Epoch: 4, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782889).  Saving model ...
Epoch: 5 cost time: 1.9085781574249268
Epoch: 5, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7902932167053223
Epoch: 6, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 7 cost time: 1.5725698471069336
Epoch: 7, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 8 cost time: 1.5797393321990967
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.747260332107544
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4866316318511963
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.802238941192627
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.5601553916931152
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6573491096496582
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.816 Test Loss: 0.571 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.897463083267212
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7055649757385254
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.041947364807129
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.809 Test Loss: 0.594 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7682764530181885
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 18 cost time: 1.640650987625122
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5939128398895264
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.532393217086792
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8747694492340088
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8879201412200928
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7538833618164062
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8557722568511963
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8991703987121582
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.809 Test Loss: 0.650 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7787113189697266
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.877211570739746
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 3238996
model size : 22.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.3883445262908936
Epoch: 1, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.222 Vali Acc: 0.414 Test Loss: 1.222 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 1.8224029541015625
Epoch: 2, Steps: 10 | Train Loss: 1.035 Vali Loss: 0.894 Vali Acc: 0.664 Test Loss: 0.894 Test Acc: 0.664
Validation loss decreased (-0.414461 --> -0.664465).  Saving model ...
Epoch: 3 cost time: 1.8421909809112549
Epoch: 3, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
Validation loss decreased (-0.664465 --> -0.763151).  Saving model ...
Epoch: 4 cost time: 1.9619622230529785
Epoch: 4, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.763151 --> -0.789468).  Saving model ...
Epoch: 5 cost time: 1.8430850505828857
Epoch: 5, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.504 Vali Acc: 0.776 Test Loss: 0.504 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7248008251190186
Epoch: 6, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.472 Vali Acc: 0.789 Test Loss: 0.472 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 7 cost time: 2.113008499145508
Epoch: 7, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 8 cost time: 1.96079683303833
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0402615070343018
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 1.9819691181182861
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9428839683532715
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 12 cost time: 1.8567631244659424
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8527133464813232
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8254804611206055
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6851048469543457
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6560819149017334
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9322702884674072
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.821622610092163
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6027765274047852
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.808868408203125
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9503757953643799
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 3238996
model size : 22.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.380131244659424
Epoch: 1, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.229 Vali Acc: 0.408 Test Loss: 1.229 Test Acc: 0.408
Validation loss decreased (inf --> -0.407882).  Saving model ...
Epoch: 2 cost time: 1.7202577590942383
Epoch: 2, Steps: 10 | Train Loss: 1.065 Vali Loss: 0.921 Vali Acc: 0.684 Test Loss: 0.921 Test Acc: 0.684
Validation loss decreased (-0.407882 --> -0.684201).  Saving model ...
Epoch: 3 cost time: 1.9094722270965576
Epoch: 3, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.697 Vali Acc: 0.737 Test Loss: 0.697 Test Acc: 0.737
Validation loss decreased (-0.684201 --> -0.736835).  Saving model ...
Epoch: 4 cost time: 2.1537981033325195
Epoch: 4, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
Validation loss decreased (-0.736835 --> -0.789468).  Saving model ...
Epoch: 5 cost time: 2.1022579669952393
Epoch: 5, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 6 cost time: 2.053131341934204
Epoch: 6, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.455 Vali Acc: 0.822 Test Loss: 0.455 Test Acc: 0.822
Validation loss decreased (-0.789469 --> -0.822364).  Saving model ...
Epoch: 7 cost time: 2.057070016860962
Epoch: 7, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.454 Vali Acc: 0.803 Test Loss: 0.454 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.149644374847412
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.467 Vali Acc: 0.822 Test Loss: 0.467 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2570202350616455
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.460 Vali Acc: 0.836 Test Loss: 0.460 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 10 cost time: 2.1436479091644287
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.472 Vali Acc: 0.842 Test Loss: 0.472 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 11 cost time: 2.2604970932006836
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8032517433166504
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.496 Vali Acc: 0.836 Test Loss: 0.496 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.014291763305664
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.499 Vali Acc: 0.836 Test Loss: 0.499 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8684005737304688
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.67848539352417
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.516 Vali Acc: 0.849 Test Loss: 0.516 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848679).  Saving model ...
Epoch: 16 cost time: 1.7900011539459229
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.849 Test Loss: 0.523 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7930774688720703
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.829 Test Loss: 0.540 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.888662576675415
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.836 Test Loss: 0.540 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.081281900405884
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.842 Test Loss: 0.544 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8455443382263184
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.836 Test Loss: 0.554 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.119565486907959
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.842 Test Loss: 0.559 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9354264736175537
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.842 Test Loss: 0.563 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2778217792510986
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.836 Test Loss: 0.571 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.082029104232788
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.829 Test Loss: 0.579 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0883169174194336
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.842 Test Loss: 0.580 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 3238996
model size : 22.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.258748769760132
Epoch: 1, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.222 Vali Acc: 0.480 Test Loss: 1.222 Test Acc: 0.480
Validation loss decreased (inf --> -0.480251).  Saving model ...
Epoch: 2 cost time: 2.0996060371398926
Epoch: 2, Steps: 10 | Train Loss: 1.067 Vali Loss: 0.959 Vali Acc: 0.684 Test Loss: 0.959 Test Acc: 0.684
Validation loss decreased (-0.480251 --> -0.684201).  Saving model ...
Epoch: 3 cost time: 1.873272180557251
Epoch: 3, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.741 Vali Acc: 0.757 Test Loss: 0.741 Test Acc: 0.757
Validation loss decreased (-0.684201 --> -0.756572).  Saving model ...
Epoch: 4 cost time: 1.7912249565124512
Epoch: 4, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
Validation loss decreased (-0.756572 --> -0.802626).  Saving model ...
Epoch: 5 cost time: 1.8423988819122314
Epoch: 5, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 1.8682656288146973
Epoch: 6, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822364).  Saving model ...
Epoch: 7 cost time: 1.8979711532592773
Epoch: 7, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6037142276763916
Epoch: 8, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.464 Vali Acc: 0.829 Test Loss: 0.464 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 9 cost time: 1.920764684677124
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.834035873413086
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7833456993103027
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0124406814575195
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.997945785522461
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8130693435668945
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.515 Vali Acc: 0.816 Test Loss: 0.515 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7353954315185547
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8599238395690918
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8310878276824951
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.816 Test Loss: 0.538 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9840443134307861
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 3238996
model size : 22.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.191633701324463
Epoch: 1, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.174 Vali Acc: 0.513 Test Loss: 1.174 Test Acc: 0.513
Validation loss decreased (inf --> -0.513146).  Saving model ...
Epoch: 2 cost time: 1.7592360973358154
Epoch: 2, Steps: 10 | Train Loss: 0.937 Vali Loss: 0.893 Vali Acc: 0.664 Test Loss: 0.893 Test Acc: 0.664
Validation loss decreased (-0.513146 --> -0.664465).  Saving model ...
Epoch: 3 cost time: 1.6359679698944092
Epoch: 3, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.688 Vali Acc: 0.730 Test Loss: 0.688 Test Acc: 0.730
Validation loss decreased (-0.664465 --> -0.730256).  Saving model ...
Epoch: 4 cost time: 1.7181594371795654
Epoch: 4, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.707341194152832
Epoch: 5, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 6 cost time: 1.702948808670044
Epoch: 6, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7410411834716797
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.6999075412750244
Epoch: 8, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7704200744628906
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.9311165809631348
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8534648418426514
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7899610996246338
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7666590213775635
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8305177688598633
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.612 Vali Acc: 0.796 Test Loss: 0.612 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7143189907073975
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8309876918792725
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7811250686645508
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.680168867111206
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8216125965118408
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 20 cost time: 2.0446372032165527
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6421325206756592
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.809 Test Loss: 0.657 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8209943771362305
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.833343505859375
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9904265403747559
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.796 Test Loss: 0.675 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8003499507904053
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9558393955230713
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.816 Test Loss: 0.684 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 27 cost time: 1.6126976013183594
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5423798561096191
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.816 Test Loss: 0.686 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6421349048614502
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.690 Vali Acc: 0.809 Test Loss: 0.690 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4731438159942627
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.72135591506958
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.093890905380249
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9780161380767822
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.796 Test Loss: 0.706 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8250725269317627
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.796 Test Loss: 0.711 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0063793659210205
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.796 Test Loss: 0.715 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.9202401638031006
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.796 Test Loss: 0.718 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 2190420
model size : 18.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.291259288787842
Epoch: 1, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.177 Vali Acc: 0.467 Test Loss: 1.177 Test Acc: 0.467
Validation loss decreased (inf --> -0.467093).  Saving model ...
Epoch: 2 cost time: 1.9320461750030518
Epoch: 2, Steps: 10 | Train Loss: 0.957 Vali Loss: 0.890 Vali Acc: 0.658 Test Loss: 0.890 Test Acc: 0.658
Validation loss decreased (-0.467093 --> -0.657886).  Saving model ...
Epoch: 3 cost time: 1.8143470287322998
Epoch: 3, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.678 Vali Acc: 0.730 Test Loss: 0.678 Test Acc: 0.730
Validation loss decreased (-0.657886 --> -0.730256).  Saving model ...
Epoch: 4 cost time: 1.901832103729248
Epoch: 4, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.578 Vali Acc: 0.743 Test Loss: 0.578 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 1.8871216773986816
Epoch: 5, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
Validation loss decreased (-0.743415 --> -0.789468).  Saving model ...
Epoch: 6 cost time: 1.7700591087341309
Epoch: 6, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 7 cost time: 1.8674962520599365
Epoch: 7, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 8 cost time: 1.4648778438568115
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7374577522277832
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5282196998596191
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6286115646362305
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8407084941864014
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7626593112945557
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7220492362976074
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5528910160064697
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9044082164764404
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6250948905944824
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2190420
model size : 18.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.0117247104644775
Epoch: 1, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.199 Vali Acc: 0.520 Test Loss: 1.199 Test Acc: 0.520
Validation loss decreased (inf --> -0.519725).  Saving model ...
Epoch: 2 cost time: 1.6074962615966797
Epoch: 2, Steps: 10 | Train Loss: 0.972 Vali Loss: 0.916 Vali Acc: 0.678 Test Loss: 0.916 Test Acc: 0.678
Validation loss decreased (-0.519725 --> -0.677622).  Saving model ...
Epoch: 3 cost time: 1.6452901363372803
Epoch: 3, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.688 Vali Acc: 0.724 Test Loss: 0.688 Test Acc: 0.724
Validation loss decreased (-0.677622 --> -0.723677).  Saving model ...
Epoch: 4 cost time: 1.739461898803711
Epoch: 4, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.723677 --> -0.789468).  Saving model ...
Epoch: 5 cost time: 1.8634004592895508
Epoch: 5, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 1.7344169616699219
Epoch: 6, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822364).  Saving model ...
Epoch: 7 cost time: 1.5579094886779785
Epoch: 7, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7516846656799316
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 9 cost time: 1.7087197303771973
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7507169246673584
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5168204307556152
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.765413761138916
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5182483196258545
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6260313987731934
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5575311183929443
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6739425659179688
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.855618953704834
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7931056022644043
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 2190420
model size : 18.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.93930721282959
Epoch: 1, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.241 Vali Acc: 0.474 Test Loss: 1.241 Test Acc: 0.474
Validation loss decreased (inf --> -0.473672).  Saving model ...
Epoch: 2 cost time: 1.931809425354004
Epoch: 2, Steps: 10 | Train Loss: 1.028 Vali Loss: 0.984 Vali Acc: 0.592 Test Loss: 0.984 Test Acc: 0.592
Validation loss decreased (-0.473672 --> -0.592095).  Saving model ...
Epoch: 3 cost time: 1.705430030822754
Epoch: 3, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.740 Vali Acc: 0.711 Test Loss: 0.740 Test Acc: 0.711
Validation loss decreased (-0.592095 --> -0.710519).  Saving model ...
Epoch: 4 cost time: 1.6960046291351318
Epoch: 4, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.604 Vali Acc: 0.743 Test Loss: 0.604 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 1.7415637969970703
Epoch: 5, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776311).  Saving model ...
Epoch: 6 cost time: 1.7794737815856934
Epoch: 6, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
Validation loss decreased (-0.776311 --> -0.815785).  Saving model ...
Epoch: 7 cost time: 1.7325654029846191
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4498085975646973
Epoch: 8, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.470 Vali Acc: 0.816 Test Loss: 0.470 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.6110670566558838
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7531976699829102
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5646424293518066
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7143750190734863
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.398716926574707
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4526455402374268
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5891320705413818
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4101295471191406
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.816 Test Loss: 0.554 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.472038745880127
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5339627265930176
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 2190420
model size : 18.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.3942248821258545
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.295 Vali Acc: 0.414 Test Loss: 1.295 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 1.8471217155456543
Epoch: 2, Steps: 10 | Train Loss: 1.029 Vali Loss: 0.944 Vali Acc: 0.638 Test Loss: 0.944 Test Acc: 0.638
Validation loss decreased (-0.414461 --> -0.638148).  Saving model ...
Epoch: 3 cost time: 1.7434072494506836
Epoch: 3, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
Validation loss decreased (-0.638148 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 1.541977882385254
Epoch: 4, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.584 Vali Acc: 0.770 Test Loss: 0.584 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.5291106700897217
Epoch: 5, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 6 cost time: 1.7986786365509033
Epoch: 6, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 7 cost time: 1.9077482223510742
Epoch: 7, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
Validation loss decreased (-0.802626 --> -0.822363).  Saving model ...
Epoch: 8 cost time: 1.7546603679656982
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6273751258850098
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5005269050598145
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6540191173553467
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7927284240722656
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.842 Test Loss: 0.584 Test Acc: 0.842
Validation loss decreased (-0.822363 --> -0.842099).  Saving model ...
Epoch: 13 cost time: 1.5744454860687256
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6649930477142334
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.595 Vali Acc: 0.816 Test Loss: 0.595 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7335593700408936
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7777643203735352
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.863497018814087
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5624301433563232
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.691669225692749
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.809 Test Loss: 0.628 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8859107494354248
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6484758853912354
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8242924213409424
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.816 Test Loss: 0.634 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 1666132
model size : 16.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.721165657043457
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.300 Vali Acc: 0.414 Test Loss: 1.300 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 1.5510156154632568
Epoch: 2, Steps: 10 | Train Loss: 1.052 Vali Loss: 0.953 Vali Acc: 0.625 Test Loss: 0.953 Test Acc: 0.625
Validation loss decreased (-0.414461 --> -0.624990).  Saving model ...
Epoch: 3 cost time: 1.7481396198272705
Epoch: 3, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.677 Vali Acc: 0.763 Test Loss: 0.677 Test Acc: 0.763
Validation loss decreased (-0.624990 --> -0.763151).  Saving model ...
Epoch: 4 cost time: 1.5754992961883545
Epoch: 4, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 5 cost time: 1.7136938571929932
Epoch: 5, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 6 cost time: 1.7207746505737305
Epoch: 6, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
Validation loss decreased (-0.802626 --> -0.822364).  Saving model ...
Epoch: 7 cost time: 1.744403600692749
Epoch: 7, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7122738361358643
Epoch: 8, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8164479732513428
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8258507251739502
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9306960105895996
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.637436866760254
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6374444961547852
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.774437665939331
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7206454277038574
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.666839599609375
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.829 Test Loss: 0.580 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 17 cost time: 1.6895384788513184
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9878580570220947
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9044468402862549
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.836 Test Loss: 0.596 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835520).  Saving model ...
Epoch: 20 cost time: 1.8426668643951416
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7766695022583008
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.802354335784912
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8535072803497314
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.829 Test Loss: 0.604 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6926028728485107
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.836 Test Loss: 0.613 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.703519344329834
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.836 Test Loss: 0.619 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5675976276397705
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.852447271347046
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.816 Test Loss: 0.627 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8077735900878906
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.836 Test Loss: 0.632 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7409019470214844
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.829 Test Loss: 0.637 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 1666132
model size : 16.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.250916957855225
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.307 Vali Acc: 0.382 Test Loss: 1.307 Test Acc: 0.382
Validation loss decreased (inf --> -0.381566).  Saving model ...
Epoch: 2 cost time: 1.937995433807373
Epoch: 2, Steps: 10 | Train Loss: 1.047 Vali Loss: 0.976 Vali Acc: 0.645 Test Loss: 0.976 Test Acc: 0.645
Validation loss decreased (-0.381566 --> -0.644727).  Saving model ...
Epoch: 3 cost time: 1.7094132900238037
Epoch: 3, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.705 Vali Acc: 0.770 Test Loss: 0.705 Test Acc: 0.770
Validation loss decreased (-0.644727 --> -0.769730).  Saving model ...
Epoch: 4 cost time: 1.5947880744934082
Epoch: 4, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 5 cost time: 1.9935998916625977
Epoch: 5, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 6 cost time: 1.888134479522705
Epoch: 6, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
Validation loss decreased (-0.796048 --> -0.822364).  Saving model ...
Epoch: 7 cost time: 1.721536636352539
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0082919597625732
Epoch: 8, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.485 Vali Acc: 0.829 Test Loss: 0.485 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 9 cost time: 2.0114259719848633
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7126851081848145
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.865957260131836
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0562660694122314
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8828394412994385
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.065269708633423
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9215564727783203
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.017256021499634
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9958903789520264
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7574446201324463
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1666132
model size : 16.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.1778764724731445
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.310 Vali Acc: 0.375 Test Loss: 1.310 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.8592557907104492
Epoch: 2, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.024 Vali Acc: 0.612 Test Loss: 1.024 Test Acc: 0.612
Validation loss decreased (-0.374987 --> -0.611832).  Saving model ...
Epoch: 3 cost time: 1.8702802658081055
Epoch: 3, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.761 Vali Acc: 0.730 Test Loss: 0.761 Test Acc: 0.730
Validation loss decreased (-0.611832 --> -0.730256).  Saving model ...
Epoch: 4 cost time: 1.6114342212677002
Epoch: 4, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.730256 --> -0.776310).  Saving model ...
Epoch: 5 cost time: 1.7676119804382324
Epoch: 5, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 1.7119321823120117
Epoch: 6, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.492 Vali Acc: 0.849 Test Loss: 0.492 Test Acc: 0.849
Validation loss decreased (-0.809205 --> -0.848679).  Saving model ...
Epoch: 7 cost time: 1.708132028579712
Epoch: 7, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.446 Vali Acc: 0.829 Test Loss: 0.446 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5748932361602783
Epoch: 8, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.472 Vali Acc: 0.849 Test Loss: 0.472 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 9 cost time: 1.7917051315307617
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.458 Vali Acc: 0.816 Test Loss: 0.458 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7950093746185303
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.482 Vali Acc: 0.836 Test Loss: 0.482 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.833505630493164
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.488 Vali Acc: 0.829 Test Loss: 0.488 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5390119552612305
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.489 Vali Acc: 0.829 Test Loss: 0.489 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6576642990112305
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.498 Vali Acc: 0.829 Test Loss: 0.498 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5432381629943848
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.506 Vali Acc: 0.829 Test Loss: 0.506 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.527550220489502
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.521 Vali Acc: 0.829 Test Loss: 0.521 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5886058807373047
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.532 Vali Acc: 0.829 Test Loss: 0.532 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6940271854400635
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.829 Test Loss: 0.530 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7775678634643555
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 1666132
model size : 16.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.025345087051392
Epoch: 1, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.211 Vali Acc: 0.513 Test Loss: 1.211 Test Acc: 0.513
Validation loss decreased (inf --> -0.513146).  Saving model ...
Epoch: 2 cost time: 1.6080005168914795
Epoch: 2, Steps: 10 | Train Loss: 0.986 Vali Loss: 0.904 Vali Acc: 0.651 Test Loss: 0.904 Test Acc: 0.651
Validation loss decreased (-0.513146 --> -0.651307).  Saving model ...
Epoch: 3 cost time: 1.5149481296539307
Epoch: 3, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.706 Vali Acc: 0.704 Test Loss: 0.706 Test Acc: 0.704
Validation loss decreased (-0.651307 --> -0.703940).  Saving model ...
Epoch: 4 cost time: 1.5239269733428955
Epoch: 4, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.617 Vali Acc: 0.711 Test Loss: 0.617 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710520).  Saving model ...
Epoch: 5 cost time: 1.6950044631958008
Epoch: 5, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
Validation loss decreased (-0.710520 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 1.7271249294281006
Epoch: 6, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776311).  Saving model ...
Epoch: 7 cost time: 1.5119740962982178
Epoch: 7, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
Validation loss decreased (-0.776311 --> -0.809205).  Saving model ...
Epoch: 8 cost time: 1.6136865615844727
Epoch: 8, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 9 cost time: 1.61275315284729
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6671338081359863
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8311011791229248
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.500326156616211
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6518065929412842
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6807687282562256
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.597 Vali Acc: 0.776 Test Loss: 0.597 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7167692184448242
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6449291706085205
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.614 Vali Acc: 0.796 Test Loss: 0.614 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5750432014465332
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8010010719299316
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1403988
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.09609055519104
Epoch: 1, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
Validation loss decreased (inf --> -0.467093).  Saving model ...
Epoch: 2 cost time: 1.6733460426330566
Epoch: 2, Steps: 10 | Train Loss: 1.011 Vali Loss: 0.894 Vali Acc: 0.651 Test Loss: 0.894 Test Acc: 0.651
Validation loss decreased (-0.467093 --> -0.651307).  Saving model ...
Epoch: 3 cost time: 1.8127071857452393
Epoch: 3, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.684 Vali Acc: 0.724 Test Loss: 0.684 Test Acc: 0.724
Validation loss decreased (-0.651307 --> -0.723677).  Saving model ...
Epoch: 4 cost time: 1.909804344177246
Epoch: 4, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.589 Vali Acc: 0.730 Test Loss: 0.589 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 1.5423328876495361
Epoch: 5, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.730257 --> -0.776311).  Saving model ...
Epoch: 6 cost time: 1.5843744277954102
Epoch: 6, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.483 Vali Acc: 0.770 Test Loss: 0.483 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6616168022155762
Epoch: 7, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
Validation loss decreased (-0.776311 --> -0.809206).  Saving model ...
Epoch: 8 cost time: 1.8113515377044678
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.473 Vali Acc: 0.829 Test Loss: 0.473 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828943).  Saving model ...
Epoch: 9 cost time: 1.6315267086029053
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6148185729980469
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.953129768371582
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6411464214324951
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.528 Vali Acc: 0.829 Test Loss: 0.528 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8391494750976562
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.733389139175415
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.669182300567627
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.708268642425537
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.736396312713623
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8043527603149414
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1403988
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7836389541625977
Epoch: 1, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.243 Vali Acc: 0.441 Test Loss: 1.243 Test Acc: 0.441
Validation loss decreased (inf --> -0.440777).  Saving model ...
Epoch: 2 cost time: 1.42360258102417
Epoch: 2, Steps: 10 | Train Loss: 1.039 Vali Loss: 0.930 Vali Acc: 0.638 Test Loss: 0.930 Test Acc: 0.638
Validation loss decreased (-0.440777 --> -0.638149).  Saving model ...
Epoch: 3 cost time: 1.342646598815918
Epoch: 3, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.705 Vali Acc: 0.704 Test Loss: 0.705 Test Acc: 0.704
Validation loss decreased (-0.638149 --> -0.703940).  Saving model ...
Epoch: 4 cost time: 1.3368072509765625
Epoch: 4, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.585 Vali Acc: 0.743 Test Loss: 0.585 Test Acc: 0.743
Validation loss decreased (-0.703940 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 1.4560730457305908
Epoch: 5, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776311).  Saving model ...
Epoch: 6 cost time: 1.5947957038879395
Epoch: 6, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.472 Vali Acc: 0.770 Test Loss: 0.472 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.670011043548584
Epoch: 7, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
Validation loss decreased (-0.776311 --> -0.809206).  Saving model ...
Epoch: 8 cost time: 1.5033624172210693
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.451 Vali Acc: 0.816 Test Loss: 0.451 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.2993605136871338
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 10 cost time: 1.5619151592254639
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.732119083404541
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4644999504089355
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5490846633911133
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5625972747802734
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 15 cost time: 1.5731990337371826
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.525 Vali Acc: 0.829 Test Loss: 0.525 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.559542179107666
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7544734477996826
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.714613437652588
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4719302654266357
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7673778533935547
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5770108699798584
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5053167343139648
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.514220952987671
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6142919063568115
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1403988
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.377136468887329
Epoch: 1, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.264 Vali Acc: 0.441 Test Loss: 1.264 Test Acc: 0.441
Validation loss decreased (inf --> -0.440777).  Saving model ...
Epoch: 2 cost time: 1.776050090789795
Epoch: 2, Steps: 10 | Train Loss: 1.108 Vali Loss: 0.985 Vali Acc: 0.684 Test Loss: 0.985 Test Acc: 0.684
Validation loss decreased (-0.440777 --> -0.684201).  Saving model ...
Epoch: 3 cost time: 1.611030101776123
Epoch: 3, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710519).  Saving model ...
Epoch: 4 cost time: 1.8604881763458252
Epoch: 4, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.606 Vali Acc: 0.770 Test Loss: 0.606 Test Acc: 0.770
Validation loss decreased (-0.710519 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.76108980178833
Epoch: 5, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 6 cost time: 1.6699471473693848
Epoch: 6, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809206).  Saving model ...
Epoch: 7 cost time: 1.6663415431976318
Epoch: 7, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 8 cost time: 2.0163230895996094
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.445 Vali Acc: 0.816 Test Loss: 0.445 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.8067224025726318
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.476 Vali Acc: 0.803 Test Loss: 0.476 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8359854221343994
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8963537216186523
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7983708381652832
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7775795459747314
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6274216175079346
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8097717761993408
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7677083015441895
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6681292057037354
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 18 cost time: 1.776932716369629
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.771718978881836
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8598175048828125
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9544508457183838
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.734945297241211
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.633906602859497
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0016872882843018
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.917952537536621
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.634765863418579
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7560081481933594
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1403988
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8901593685150146
Epoch: 1, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.257 Vali Acc: 0.441 Test Loss: 1.257 Test Acc: 0.441
Validation loss decreased (inf --> -0.440777).  Saving model ...
Epoch: 2 cost time: 1.4822824001312256
Epoch: 2, Steps: 10 | Train Loss: 0.961 Vali Loss: 0.926 Vali Acc: 0.625 Test Loss: 0.926 Test Acc: 0.625
Validation loss decreased (-0.440777 --> -0.624991).  Saving model ...
Epoch: 3 cost time: 1.4905848503112793
Epoch: 3, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.699 Vali Acc: 0.737 Test Loss: 0.699 Test Acc: 0.737
Validation loss decreased (-0.624991 --> -0.736835).  Saving model ...
Epoch: 4 cost time: 1.4618258476257324
Epoch: 4, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 5 cost time: 1.5762829780578613
Epoch: 5, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.734511137008667
Epoch: 6, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 7 cost time: 1.8666188716888428
Epoch: 7, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8432412147521973
Epoch: 8, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.617072343826294
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6621246337890625
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5507678985595703
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.626852035522461
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8687474727630615
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7592246532440186
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.796 Test Loss: 0.615 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5961613655090332
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8432390689849854
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.620 Vali Acc: 0.816 Test Loss: 0.620 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 17 cost time: 1.4702506065368652
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.633 Vali Acc: 0.803 Test Loss: 0.633 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6276521682739258
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8153090476989746
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.796 Test Loss: 0.648 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8488922119140625
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7126426696777344
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.947497844696045
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.803 Test Loss: 0.672 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7441051006317139
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.674 Vali Acc: 0.796 Test Loss: 0.674 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.742063283920288
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6032054424285889
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.803 Test Loss: 0.677 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6582958698272705
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1272916
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.058959722518921
Epoch: 1, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.275 Vali Acc: 0.388 Test Loss: 1.275 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 1.6282362937927246
Epoch: 2, Steps: 10 | Train Loss: 0.964 Vali Loss: 0.944 Vali Acc: 0.625 Test Loss: 0.944 Test Acc: 0.625
Validation loss decreased (-0.388145 --> -0.624991).  Saving model ...
Epoch: 3 cost time: 1.6337149143218994
Epoch: 3, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.704 Vali Acc: 0.717 Test Loss: 0.704 Test Acc: 0.717
Validation loss decreased (-0.624991 --> -0.717098).  Saving model ...
Epoch: 4 cost time: 1.5726561546325684
Epoch: 4, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
Validation loss decreased (-0.717098 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.634467363357544
Epoch: 5, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.6067166328430176
Epoch: 6, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
Validation loss decreased (-0.776310 --> -0.815784).  Saving model ...
Epoch: 7 cost time: 1.8885595798492432
Epoch: 7, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9506888389587402
Epoch: 8, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8824548721313477
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.901869535446167
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8241784572601318
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6776432991027832
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7193610668182373
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7667737007141113
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.740929365158081
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8809154033660889
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1272916
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9292662143707275
Epoch: 1, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.291 Vali Acc: 0.375 Test Loss: 1.291 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.4296410083770752
Epoch: 2, Steps: 10 | Train Loss: 1.006 Vali Loss: 0.969 Vali Acc: 0.612 Test Loss: 0.969 Test Acc: 0.612
Validation loss decreased (-0.374987 --> -0.611832).  Saving model ...
Epoch: 3 cost time: 1.3793938159942627
Epoch: 3, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.721 Vali Acc: 0.737 Test Loss: 0.721 Test Acc: 0.737
Validation loss decreased (-0.611832 --> -0.736835).  Saving model ...
Epoch: 4 cost time: 1.7296576499938965
Epoch: 4, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.579 Vali Acc: 0.789 Test Loss: 0.579 Test Acc: 0.789
Validation loss decreased (-0.736835 --> -0.789468).  Saving model ...
Epoch: 5 cost time: 1.6028542518615723
Epoch: 5, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 1.4071009159088135
Epoch: 6, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 7 cost time: 1.4888339042663574
Epoch: 7, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.486 Vali Acc: 0.829 Test Loss: 0.486 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 8 cost time: 1.4261887073516846
Epoch: 8, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6713807582855225
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6466999053955078
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.659642219543457
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5335674285888672
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7457571029663086
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4306409358978271
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7203352451324463
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.756051778793335
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5357322692871094
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1272916
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.170309066772461
Epoch: 1, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.264 Vali Acc: 0.467 Test Loss: 1.264 Test Acc: 0.467
Validation loss decreased (inf --> -0.467093).  Saving model ...
Epoch: 2 cost time: 1.648771047592163
Epoch: 2, Steps: 10 | Train Loss: 1.052 Vali Loss: 0.988 Vali Acc: 0.612 Test Loss: 0.988 Test Acc: 0.612
Validation loss decreased (-0.467093 --> -0.611832).  Saving model ...
Epoch: 3 cost time: 1.7398262023925781
Epoch: 3, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
Validation loss decreased (-0.611832 --> -0.736835).  Saving model ...
Epoch: 4 cost time: 1.5783028602600098
Epoch: 4, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.590 Vali Acc: 0.770 Test Loss: 0.590 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.8875417709350586
Epoch: 5, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.769731 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 1.617441177368164
Epoch: 6, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.467 Vali Acc: 0.829 Test Loss: 0.467 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828943).  Saving model ...
Epoch: 7 cost time: 1.5173616409301758
Epoch: 7, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.472 Vali Acc: 0.816 Test Loss: 0.472 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7218043804168701
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.457 Vali Acc: 0.816 Test Loss: 0.457 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8636491298675537
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.691770315170288
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8498072624206543
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7311756610870361
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6181972026824951
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5196583271026611
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.68979811668396
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9688899517059326
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1272916
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.1349196434021
Epoch: 1, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.253 Vali Acc: 0.388 Test Loss: 1.253 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 1.759728193283081
Epoch: 2, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.074 Vali Acc: 0.586 Test Loss: 1.074 Test Acc: 0.586
Validation loss decreased (-0.388145 --> -0.585516).  Saving model ...
Epoch: 3 cost time: 1.5394070148468018
Epoch: 3, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.874 Vali Acc: 0.717 Test Loss: 0.874 Test Acc: 0.717
Validation loss decreased (-0.585516 --> -0.717097).  Saving model ...
Epoch: 4 cost time: 1.4263091087341309
Epoch: 4, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.724 Vali Acc: 0.737 Test Loss: 0.724 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736835).  Saving model ...
Epoch: 5 cost time: 1.5813746452331543
Epoch: 5, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.635 Vali Acc: 0.770 Test Loss: 0.635 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769730).  Saving model ...
Epoch: 6 cost time: 1.6792266368865967
Epoch: 6, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.6804804801940918
Epoch: 7, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.6221041679382324
Epoch: 8, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.3982882499694824
Epoch: 9, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6277010440826416
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 11 cost time: 1.640564203262329
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5942630767822266
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4304287433624268
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.3354380130767822
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6390113830566406
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 16 cost time: 1.5669188499450684
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8313541412353516
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6025621891021729
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6355574131011963
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7331089973449707
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.829 Test Loss: 0.591 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828941).  Saving model ...
Epoch: 21 cost time: 1.817908525466919
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8722691535949707
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8263640403747559
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7493913173675537
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.816 Test Loss: 0.605 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6174793243408203
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.809 Test Loss: 0.607 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7141644954681396
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.67291259765625
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5397977828979492
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6957015991210938
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.809 Test Loss: 0.623 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.681089162826538
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.809 Test Loss: 0.628 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 2405972
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.09438419342041
Epoch: 1, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.252 Vali Acc: 0.454 Test Loss: 1.252 Test Acc: 0.454
Validation loss decreased (inf --> -0.453935).  Saving model ...
Epoch: 2 cost time: 1.7792706489562988
Epoch: 2, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.071 Vali Acc: 0.612 Test Loss: 1.071 Test Acc: 0.612
Validation loss decreased (-0.453935 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 1.6302039623260498
Epoch: 3, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.874 Vali Acc: 0.678 Test Loss: 0.874 Test Acc: 0.678
Validation loss decreased (-0.611831 --> -0.677623).  Saving model ...
Epoch: 4 cost time: 1.7042803764343262
Epoch: 4, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.716 Vali Acc: 0.750 Test Loss: 0.716 Test Acc: 0.750
Validation loss decreased (-0.677623 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 1.5439372062683105
Epoch: 5, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782888).  Saving model ...
Epoch: 6 cost time: 1.5247609615325928
Epoch: 6, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802626).  Saving model ...
Epoch: 7 cost time: 1.468322992324829
Epoch: 7, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 8 cost time: 1.4994068145751953
Epoch: 8, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.7358500957489014
Epoch: 9, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5774893760681152
Epoch: 10, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.472 Vali Acc: 0.803 Test Loss: 0.472 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6619462966918945
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 12 cost time: 1.584244728088379
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.480 Vali Acc: 0.816 Test Loss: 0.480 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6205573081970215
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.494 Vali Acc: 0.836 Test Loss: 0.494 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 14 cost time: 1.4922945499420166
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5723817348480225
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5547175407409668
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.512 Vali Acc: 0.829 Test Loss: 0.512 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6901147365570068
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6434979438781738
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6775474548339844
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7073791027069092
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.836 Test Loss: 0.542 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.391305685043335
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.610908031463623
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.552 Vali Acc: 0.836 Test Loss: 0.552 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.506523609161377
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.554 Vali Acc: 0.829 Test Loss: 0.554 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 2405972
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.144325256347656
Epoch: 1, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.246 Vali Acc: 0.474 Test Loss: 1.246 Test Acc: 0.474
Validation loss decreased (inf --> -0.473672).  Saving model ...
Epoch: 2 cost time: 1.4697480201721191
Epoch: 2, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.076 Vali Acc: 0.612 Test Loss: 1.076 Test Acc: 0.612
Validation loss decreased (-0.473672 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 1.676826000213623
Epoch: 3, Steps: 10 | Train Loss: 0.870 Vali Loss: 0.889 Vali Acc: 0.684 Test Loss: 0.889 Test Acc: 0.684
Validation loss decreased (-0.611831 --> -0.684202).  Saving model ...
Epoch: 4 cost time: 1.5428767204284668
Epoch: 4, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.726 Vali Acc: 0.743 Test Loss: 0.726 Test Acc: 0.743
Validation loss decreased (-0.684202 --> -0.743414).  Saving model ...
Epoch: 5 cost time: 1.7230992317199707
Epoch: 5, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.626 Vali Acc: 0.789 Test Loss: 0.626 Test Acc: 0.789
Validation loss decreased (-0.743414 --> -0.789467).  Saving model ...
Epoch: 6 cost time: 1.6360082626342773
Epoch: 6, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809205).  Saving model ...
Epoch: 7 cost time: 1.6674394607543945
Epoch: 7, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7742321491241455
Epoch: 8, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.690964698791504
Epoch: 9, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.452 Vali Acc: 0.829 Test Loss: 0.452 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 10 cost time: 1.6371746063232422
Epoch: 10, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5438423156738281
Epoch: 11, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.444 Vali Acc: 0.816 Test Loss: 0.444 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7177002429962158
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.440 Vali Acc: 0.822 Test Loss: 0.440 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.667001724243164
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.452 Vali Acc: 0.809 Test Loss: 0.452 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9635217189788818
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.451 Vali Acc: 0.829 Test Loss: 0.451 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 15 cost time: 1.6834983825683594
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.457 Vali Acc: 0.829 Test Loss: 0.457 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6530342102050781
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5721728801727295
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.467 Vali Acc: 0.822 Test Loss: 0.467 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8266825675964355
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8282341957092285
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4725432395935059
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.491 Vali Acc: 0.829 Test Loss: 0.491 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7969164848327637
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.712334394454956
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.500 Vali Acc: 0.829 Test Loss: 0.500 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5529577732086182
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.502091646194458
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 2405972
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8319320678710938
Epoch: 1, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.283 Vali Acc: 0.454 Test Loss: 1.283 Test Acc: 0.454
Validation loss decreased (inf --> -0.453935).  Saving model ...
Epoch: 2 cost time: 1.6266422271728516
Epoch: 2, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.129 Vali Acc: 0.658 Test Loss: 1.129 Test Acc: 0.658
Validation loss decreased (-0.453935 --> -0.657883).  Saving model ...
Epoch: 3 cost time: 1.761833667755127
Epoch: 3, Steps: 10 | Train Loss: 0.941 Vali Loss: 0.947 Vali Acc: 0.684 Test Loss: 0.947 Test Acc: 0.684
Validation loss decreased (-0.657883 --> -0.684201).  Saving model ...
Epoch: 4 cost time: 1.4586191177368164
Epoch: 4, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.684201 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 1.5676229000091553
Epoch: 5, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
Validation loss decreased (-0.749992 --> -0.776309).  Saving model ...
Epoch: 6 cost time: 1.482872486114502
Epoch: 6, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
Validation loss decreased (-0.776309 --> -0.809205).  Saving model ...
Epoch: 7 cost time: 1.7182769775390625
Epoch: 7, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 8 cost time: 1.5262227058410645
Epoch: 8, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.448 Vali Acc: 0.829 Test Loss: 0.448 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 9 cost time: 1.6995832920074463
Epoch: 9, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.436 Vali Acc: 0.842 Test Loss: 0.436 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 10 cost time: 1.62058687210083
Epoch: 10, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8172907829284668
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.405 Vali Acc: 0.842 Test Loss: 0.405 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 12 cost time: 1.7610712051391602
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.401 Vali Acc: 0.842 Test Loss: 0.401 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 13 cost time: 1.5303308963775635
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 14 cost time: 1.5741939544677734
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.412 Vali Acc: 0.842 Test Loss: 0.412 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.635300874710083
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.413 Vali Acc: 0.842 Test Loss: 0.413 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.624016284942627
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.425 Vali Acc: 0.849 Test Loss: 0.425 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3739094734191895
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.414 Vali Acc: 0.842 Test Loss: 0.414 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4199848175048828
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.736814022064209
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.441 Vali Acc: 0.849 Test Loss: 0.441 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6442065238952637
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.435 Vali Acc: 0.842 Test Loss: 0.435 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4265940189361572
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.446 Vali Acc: 0.836 Test Loss: 0.446 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6608257293701172
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.842 Test Loss: 0.450 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4794650077819824
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.457 Vali Acc: 0.849 Test Loss: 0.457 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 2405972
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.599386215209961
Epoch: 1, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.256 Vali Acc: 0.461 Test Loss: 1.256 Test Acc: 0.461
Validation loss decreased (inf --> -0.460514).  Saving model ...
Epoch: 2 cost time: 1.450920820236206
Epoch: 2, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.055 Vali Acc: 0.612 Test Loss: 1.055 Test Acc: 0.612
Validation loss decreased (-0.460514 --> -0.611832).  Saving model ...
Epoch: 3 cost time: 1.5836021900177002
Epoch: 3, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.865 Vali Acc: 0.664 Test Loss: 0.865 Test Acc: 0.664
Validation loss decreased (-0.611832 --> -0.664465).  Saving model ...
Epoch: 4 cost time: 1.4590494632720947
Epoch: 4, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.729 Vali Acc: 0.711 Test Loss: 0.729 Test Acc: 0.711
Validation loss decreased (-0.664465 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.241117238998413
Epoch: 5, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.629 Vali Acc: 0.757 Test Loss: 0.629 Test Acc: 0.757
Validation loss decreased (-0.710519 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 1.4059710502624512
Epoch: 6, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.5412075519561768
Epoch: 7, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.509 Vali Acc: 0.776 Test Loss: 0.509 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4051721096038818
Epoch: 8, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809206).  Saving model ...
Epoch: 9 cost time: 1.352898120880127
Epoch: 9, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 10 cost time: 1.3409080505371094
Epoch: 10, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4460203647613525
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.377624750137329
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3510527610778809
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.480 Vali Acc: 0.822 Test Loss: 0.480 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 14 cost time: 1.3028042316436768
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.489 Vali Acc: 0.836 Test Loss: 0.489 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 15 cost time: 1.3983595371246338
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4204916954040527
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3711292743682861
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.514 Vali Acc: 0.836 Test Loss: 0.514 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5238416194915771
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.519 Vali Acc: 0.829 Test Loss: 0.519 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5163977146148682
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.525 Vali Acc: 0.836 Test Loss: 0.525 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5570976734161377
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.530 Vali Acc: 0.836 Test Loss: 0.530 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.565310001373291
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.536 Vali Acc: 0.842 Test Loss: 0.536 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 22 cost time: 1.42795729637146
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.540 Vali Acc: 0.836 Test Loss: 0.540 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4148387908935547
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.550 Vali Acc: 0.829 Test Loss: 0.550 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5157508850097656
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.836 Test Loss: 0.553 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4188768863677979
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.842 Test Loss: 0.558 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3744919300079346
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.842 Test Loss: 0.562 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3584516048431396
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.565 Vali Acc: 0.836 Test Loss: 0.565 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4478018283843994
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.842 Test Loss: 0.568 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.502967357635498
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.836 Test Loss: 0.573 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.737431287765503
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.836 Test Loss: 0.577 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.32541823387146
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.836 Test Loss: 0.582 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 1357396
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.988844394683838
Epoch: 1, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.262 Vali Acc: 0.447 Test Loss: 1.262 Test Acc: 0.447
Validation loss decreased (inf --> -0.447356).  Saving model ...
Epoch: 2 cost time: 1.827892780303955
Epoch: 2, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.065 Vali Acc: 0.586 Test Loss: 1.065 Test Acc: 0.586
Validation loss decreased (-0.447356 --> -0.585516).  Saving model ...
Epoch: 3 cost time: 1.5293025970458984
Epoch: 3, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.872 Vali Acc: 0.678 Test Loss: 0.872 Test Acc: 0.678
Validation loss decreased (-0.585516 --> -0.677623).  Saving model ...
Epoch: 4 cost time: 1.5679376125335693
Epoch: 4, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.734 Vali Acc: 0.724 Test Loss: 0.734 Test Acc: 0.724
Validation loss decreased (-0.677623 --> -0.723677).  Saving model ...
Epoch: 5 cost time: 1.4706463813781738
Epoch: 5, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.633 Vali Acc: 0.757 Test Loss: 0.633 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 1.5450351238250732
Epoch: 6, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.5728728771209717
Epoch: 7, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789469).  Saving model ...
Epoch: 8 cost time: 1.460799217224121
Epoch: 8, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
Validation loss decreased (-0.789469 --> -0.822364).  Saving model ...
Epoch: 9 cost time: 1.6750564575195312
Epoch: 9, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5029020309448242
Epoch: 10, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.446660041809082
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.478 Vali Acc: 0.803 Test Loss: 0.478 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4915754795074463
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.466 Vali Acc: 0.829 Test Loss: 0.466 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 13 cost time: 1.4341769218444824
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.468 Vali Acc: 0.842 Test Loss: 0.468 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 14 cost time: 1.3501324653625488
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5922620296478271
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3107688426971436
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5026142597198486
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.494 Vali Acc: 0.836 Test Loss: 0.494 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.435840368270874
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.47853684425354
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6491570472717285
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.508 Vali Acc: 0.836 Test Loss: 0.508 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.638885736465454
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5223255157470703
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.519 Vali Acc: 0.836 Test Loss: 0.519 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6434545516967773
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 1357396
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.227423906326294
Epoch: 1, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.245 Vali Acc: 0.513 Test Loss: 1.245 Test Acc: 0.513
Validation loss decreased (inf --> -0.513145).  Saving model ...
Epoch: 2 cost time: 1.4798634052276611
Epoch: 2, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.056 Vali Acc: 0.579 Test Loss: 1.056 Test Acc: 0.579
Validation loss decreased (-0.513145 --> -0.578937).  Saving model ...
Epoch: 3 cost time: 1.4029929637908936
Epoch: 3, Steps: 10 | Train Loss: 0.881 Vali Loss: 0.870 Vali Acc: 0.678 Test Loss: 0.870 Test Acc: 0.678
Validation loss decreased (-0.578937 --> -0.677623).  Saving model ...
Epoch: 4 cost time: 1.3007500171661377
Epoch: 4, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.728 Vali Acc: 0.704 Test Loss: 0.728 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 1.3530216217041016
Epoch: 5, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.617 Vali Acc: 0.776 Test Loss: 0.617 Test Acc: 0.776
Validation loss decreased (-0.703940 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.4015307426452637
Epoch: 6, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.2438504695892334
Epoch: 7, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
Validation loss decreased (-0.782889 --> -0.815785).  Saving model ...
Epoch: 8 cost time: 1.6082353591918945
Epoch: 8, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.458 Vali Acc: 0.803 Test Loss: 0.458 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.541961431503296
Epoch: 9, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.438 Vali Acc: 0.796 Test Loss: 0.438 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4618303775787354
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.443 Vali Acc: 0.803 Test Loss: 0.443 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.571744680404663
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.440 Vali Acc: 0.809 Test Loss: 0.440 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4074907302856445
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.431 Vali Acc: 0.822 Test Loss: 0.431 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 13 cost time: 1.4607245922088623
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.439 Vali Acc: 0.822 Test Loss: 0.439 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.454059362411499
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.449 Vali Acc: 0.816 Test Loss: 0.449 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3634629249572754
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.450 Vali Acc: 0.829 Test Loss: 0.450 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 16 cost time: 1.6687843799591064
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6090278625488281
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4878058433532715
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7100534439086914
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5079727172851562
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.570528507232666
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.489 Vali Acc: 0.829 Test Loss: 0.489 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4115169048309326
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4381794929504395
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6850929260253906
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4377059936523438
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.503 Vali Acc: 0.829 Test Loss: 0.503 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1357396
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.246255874633789
Epoch: 1, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.265 Vali Acc: 0.454 Test Loss: 1.265 Test Acc: 0.454
Validation loss decreased (inf --> -0.453935).  Saving model ...
Epoch: 2 cost time: 1.3296351432800293
Epoch: 2, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.096 Vali Acc: 0.625 Test Loss: 1.096 Test Acc: 0.625
Validation loss decreased (-0.453935 --> -0.624989).  Saving model ...
Epoch: 3 cost time: 1.3204169273376465
Epoch: 3, Steps: 10 | Train Loss: 0.916 Vali Loss: 0.925 Vali Acc: 0.664 Test Loss: 0.925 Test Acc: 0.664
Validation loss decreased (-0.624989 --> -0.664464).  Saving model ...
Epoch: 4 cost time: 1.5935909748077393
Epoch: 4, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.776 Vali Acc: 0.717 Test Loss: 0.776 Test Acc: 0.717
Validation loss decreased (-0.664464 --> -0.717097).  Saving model ...
Epoch: 5 cost time: 1.5069479942321777
Epoch: 5, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736836).  Saving model ...
Epoch: 6 cost time: 1.5804038047790527
Epoch: 6, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
Validation loss decreased (-0.736836 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.7191219329833984
Epoch: 7, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809205).  Saving model ...
Epoch: 8 cost time: 1.4753739833831787
Epoch: 8, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5455150604248047
Epoch: 9, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.431 Vali Acc: 0.809 Test Loss: 0.431 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 10 cost time: 1.6770293712615967
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.430 Vali Acc: 0.822 Test Loss: 0.430 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 11 cost time: 1.735645055770874
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.432 Vali Acc: 0.829 Test Loss: 0.432 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 12 cost time: 1.497995138168335
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.426 Vali Acc: 0.842 Test Loss: 0.426 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 13 cost time: 1.555675983428955
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.432 Vali Acc: 0.836 Test Loss: 0.432 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.473496675491333
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.434 Vali Acc: 0.836 Test Loss: 0.434 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.557342529296875
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.436 Vali Acc: 0.816 Test Loss: 0.436 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4110233783721924
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.448 Vali Acc: 0.829 Test Loss: 0.448 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3644680976867676
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.442 Vali Acc: 0.836 Test Loss: 0.442 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4576714038848877
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.454 Vali Acc: 0.822 Test Loss: 0.454 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6244590282440186
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.467 Vali Acc: 0.849 Test Loss: 0.467 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 20 cost time: 1.5892958641052246
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6370501518249512
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5519988536834717
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5652296543121338
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6020543575286865
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5104048252105713
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.401768445968628
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.836 Test Loss: 0.510 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.525794267654419
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5135743618011475
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.515 Vali Acc: 0.816 Test Loss: 0.515 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6659564971923828
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 1357396
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2248411178588867
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.348 Vali Acc: 0.388 Test Loss: 1.348 Test Acc: 0.388
Validation loss decreased (inf --> -0.388144).  Saving model ...
Epoch: 2 cost time: 1.5087401866912842
Epoch: 2, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.165 Vali Acc: 0.526 Test Loss: 1.165 Test Acc: 0.526
Validation loss decreased (-0.388144 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 1.481534481048584
Epoch: 3, Steps: 10 | Train Loss: 0.922 Vali Loss: 0.937 Vali Acc: 0.730 Test Loss: 0.937 Test Acc: 0.730
Validation loss decreased (-0.526304 --> -0.730254).  Saving model ...
Epoch: 4 cost time: 1.3391451835632324
Epoch: 4, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.778 Vali Acc: 0.743 Test Loss: 0.778 Test Acc: 0.743
Validation loss decreased (-0.730254 --> -0.743413).  Saving model ...
Epoch: 5 cost time: 1.5627148151397705
Epoch: 5, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.663 Vali Acc: 0.730 Test Loss: 0.663 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6286218166351318
Epoch: 6, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.608 Vali Acc: 0.757 Test Loss: 0.608 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.6251754760742188
Epoch: 7, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.5541281700134277
Epoch: 8, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.5742642879486084
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.7471377849578857
Epoch: 10, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.5766968727111816
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.4286370277404785
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6633374691009521
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.66090726852417
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3682644367218018
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3714532852172852
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3143932819366455
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6100099086761475
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5940086841583252
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.585 Vali Acc: 0.796 Test Loss: 0.585 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5278396606445312
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7249755859375
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 833108
model size : 8.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8110666275024414
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.344 Vali Acc: 0.388 Test Loss: 1.344 Test Acc: 0.388
Validation loss decreased (inf --> -0.388144).  Saving model ...
Epoch: 2 cost time: 1.5388412475585938
Epoch: 2, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.161 Vali Acc: 0.559 Test Loss: 1.161 Test Acc: 0.559
Validation loss decreased (-0.388144 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 1.6356332302093506
Epoch: 3, Steps: 10 | Train Loss: 0.940 Vali Loss: 0.943 Vali Acc: 0.678 Test Loss: 0.943 Test Acc: 0.678
Validation loss decreased (-0.559199 --> -0.677622).  Saving model ...
Epoch: 4 cost time: 1.5272128582000732
Epoch: 4, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.784 Vali Acc: 0.730 Test Loss: 0.784 Test Acc: 0.730
Validation loss decreased (-0.677622 --> -0.730255).  Saving model ...
Epoch: 5 cost time: 1.539566993713379
Epoch: 5, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.664 Vali Acc: 0.757 Test Loss: 0.664 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756572).  Saving model ...
Epoch: 6 cost time: 1.4980685710906982
Epoch: 6, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.604 Vali Acc: 0.770 Test Loss: 0.604 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.532095193862915
Epoch: 7, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.5922269821166992
Epoch: 8, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.6323351860046387
Epoch: 9, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4515643119812012
Epoch: 10, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5420300960540771
Epoch: 11, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.570392370223999
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5774431228637695
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 14 cost time: 1.542651653289795
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5311529636383057
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.750455379486084
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5672187805175781
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6630115509033203
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5064013004302979
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815784).  Saving model ...
Epoch: 20 cost time: 1.397972822189331
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3695323467254639
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5739209651947021
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4984376430511475
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6075999736785889
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5794057846069336
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5062644481658936
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4105684757232666
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.390381097793579
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.595 Vali Acc: 0.816 Test Loss: 0.595 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3385393619537354
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 833108
model size : 8.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7966113090515137
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.304 Vali Acc: 0.414 Test Loss: 1.304 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 1.4656002521514893
Epoch: 2, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.137 Vali Acc: 0.546 Test Loss: 1.137 Test Acc: 0.546
Validation loss decreased (-0.414461 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 1.4141955375671387
Epoch: 3, Steps: 10 | Train Loss: 0.966 Vali Loss: 0.931 Vali Acc: 0.684 Test Loss: 0.931 Test Acc: 0.684
Validation loss decreased (-0.546041 --> -0.684201).  Saving model ...
Epoch: 4 cost time: 1.6952412128448486
Epoch: 4, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.781 Vali Acc: 0.730 Test Loss: 0.781 Test Acc: 0.730
Validation loss decreased (-0.684201 --> -0.730255).  Saving model ...
Epoch: 5 cost time: 1.5636694431304932
Epoch: 5, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.658 Vali Acc: 0.750 Test Loss: 0.658 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.47318696975708
Epoch: 6, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.4884181022644043
Epoch: 7, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.6442866325378418
Epoch: 8, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809206).  Saving model ...
Epoch: 9 cost time: 1.667759895324707
Epoch: 9, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.487 Vali Acc: 0.789 Test Loss: 0.487 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4669551849365234
Epoch: 10, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6684327125549316
Epoch: 11, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 12 cost time: 1.6324489116668701
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 13 cost time: 1.5623807907104492
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.645028829574585
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6753575801849365
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.664398193359375
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5079247951507568
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6127829551696777
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6258442401885986
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5272283554077148
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6097266674041748
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5187852382659912
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.829 Test Loss: 0.546 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828942).  Saving model ...
Epoch: 23 cost time: 1.5638401508331299
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.667550802230835
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5884969234466553
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6274471282958984
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3615517616271973
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4985158443450928
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.829 Test Loss: 0.568 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3911521434783936
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.829 Test Loss: 0.575 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3222789764404297
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.829 Test Loss: 0.581 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4634175300598145
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4143600463867188
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 833108
model size : 8.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.110017776489258
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.261 Vali Acc: 0.428 Test Loss: 1.261 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 1.5393762588500977
Epoch: 2, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.128 Vali Acc: 0.605 Test Loss: 1.128 Test Acc: 0.605
Validation loss decreased (-0.427619 --> -0.605252).  Saving model ...
Epoch: 3 cost time: 1.4685440063476562
Epoch: 3, Steps: 10 | Train Loss: 1.000 Vali Loss: 0.951 Vali Acc: 0.684 Test Loss: 0.951 Test Acc: 0.684
Validation loss decreased (-0.605252 --> -0.684201).  Saving model ...
Epoch: 4 cost time: 1.4096295833587646
Epoch: 4, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.808 Vali Acc: 0.737 Test Loss: 0.808 Test Acc: 0.737
Validation loss decreased (-0.684201 --> -0.736834).  Saving model ...
Epoch: 5 cost time: 1.4759578704833984
Epoch: 5, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.396268367767334
Epoch: 6, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
Validation loss decreased (-0.749993 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.3559856414794922
Epoch: 7, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 1.507298231124878
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.491 Vali Acc: 0.842 Test Loss: 0.491 Test Acc: 0.842
Validation loss decreased (-0.796047 --> -0.842100).  Saving model ...
Epoch: 9 cost time: 1.642871379852295
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.459 Vali Acc: 0.809 Test Loss: 0.459 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5647306442260742
Epoch: 10, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.442 Vali Acc: 0.809 Test Loss: 0.442 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.64442777633667
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.439 Vali Acc: 0.809 Test Loss: 0.439 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4120371341705322
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.437 Vali Acc: 0.816 Test Loss: 0.437 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3906536102294922
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.435 Vali Acc: 0.809 Test Loss: 0.435 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2768023014068604
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.435 Vali Acc: 0.816 Test Loss: 0.435 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5505688190460205
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.448 Vali Acc: 0.803 Test Loss: 0.448 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5650670528411865
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.458 Vali Acc: 0.822 Test Loss: 0.458 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5049846172332764
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8083713054656982
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 833108
model size : 8.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6757655143737793
Epoch: 1, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.325 Vali Acc: 0.434 Test Loss: 1.325 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 1.363142490386963
Epoch: 2, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
Validation loss decreased (-0.434197 --> -0.532884).  Saving model ...
Epoch: 3 cost time: 1.3994171619415283
Epoch: 3, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.898 Vali Acc: 0.678 Test Loss: 0.898 Test Acc: 0.678
Validation loss decreased (-0.532884 --> -0.677623).  Saving model ...
Epoch: 4 cost time: 1.441948652267456
Epoch: 4, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.740 Vali Acc: 0.737 Test Loss: 0.740 Test Acc: 0.737
Validation loss decreased (-0.677623 --> -0.736835).  Saving model ...
Epoch: 5 cost time: 1.4861204624176025
Epoch: 5, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
Validation loss decreased (-0.736835 --> -0.796046).  Saving model ...
Epoch: 6 cost time: 1.4847404956817627
Epoch: 6, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4707787036895752
Epoch: 7, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809205).  Saving model ...
Epoch: 8 cost time: 1.516484260559082
Epoch: 8, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6109390258789062
Epoch: 9, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 10 cost time: 1.6623692512512207
Epoch: 10, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.584967851638794
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5238621234893799
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7489352226257324
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 14 cost time: 1.4983930587768555
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.487 Vali Acc: 0.836 Test Loss: 0.487 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 15 cost time: 1.4935240745544434
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.769132375717163
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.510 Vali Acc: 0.836 Test Loss: 0.510 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6252429485321045
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3933699131011963
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.528 Vali Acc: 0.829 Test Loss: 0.528 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6388018131256104
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.534 Vali Acc: 0.816 Test Loss: 0.534 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5777418613433838
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5331697463989258
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.637831687927246
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4697537422180176
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5774216651916504
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 570964
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.287365674972534
Epoch: 1, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.340 Vali Acc: 0.428 Test Loss: 1.340 Test Acc: 0.428
Validation loss decreased (inf --> -0.427618).  Saving model ...
Epoch: 2 cost time: 1.7680068016052246
Epoch: 2, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.129 Vali Acc: 0.572 Test Loss: 1.129 Test Acc: 0.572
Validation loss decreased (-0.427618 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.6613690853118896
Epoch: 3, Steps: 10 | Train Loss: 0.894 Vali Loss: 0.917 Vali Acc: 0.684 Test Loss: 0.917 Test Acc: 0.684
Validation loss decreased (-0.572357 --> -0.684201).  Saving model ...
Epoch: 4 cost time: 1.653468370437622
Epoch: 4, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.751 Vali Acc: 0.757 Test Loss: 0.751 Test Acc: 0.757
Validation loss decreased (-0.684201 --> -0.756571).  Saving model ...
Epoch: 5 cost time: 1.617617130279541
Epoch: 5, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.634 Vali Acc: 0.776 Test Loss: 0.634 Test Acc: 0.776
Validation loss decreased (-0.756571 --> -0.776309).  Saving model ...
Epoch: 6 cost time: 1.3435540199279785
Epoch: 6, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.3925564289093018
Epoch: 7, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809205).  Saving model ...
Epoch: 8 cost time: 1.429607629776001
Epoch: 8, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 1.387803077697754
Epoch: 9, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.346679925918579
Epoch: 10, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2576005458831787
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.390868902206421
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.463 Vali Acc: 0.816 Test Loss: 0.463 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 13 cost time: 1.4270997047424316
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.451 Vali Acc: 0.836 Test Loss: 0.451 Test Acc: 0.836
Validation loss decreased (-0.815785 --> -0.835522).  Saving model ...
Epoch: 14 cost time: 1.5359582901000977
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.459 Vali Acc: 0.829 Test Loss: 0.459 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5726344585418701
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.470 Vali Acc: 0.816 Test Loss: 0.470 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4373743534088135
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.475 Vali Acc: 0.829 Test Loss: 0.475 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.442460298538208
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5378787517547607
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.491 Vali Acc: 0.829 Test Loss: 0.491 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4138438701629639
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4786393642425537
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.41097092628479
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.446319818496704
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.500 Vali Acc: 0.829 Test Loss: 0.500 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.625800371170044
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 570964
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4299769401550293
Epoch: 1, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.364 Vali Acc: 0.441 Test Loss: 1.364 Test Acc: 0.441
Validation loss decreased (inf --> -0.440776).  Saving model ...
Epoch: 2 cost time: 1.3105483055114746
Epoch: 2, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.159 Vali Acc: 0.546 Test Loss: 1.159 Test Acc: 0.546
Validation loss decreased (-0.440776 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 1.452460765838623
Epoch: 3, Steps: 10 | Train Loss: 0.931 Vali Loss: 0.951 Vali Acc: 0.651 Test Loss: 0.951 Test Acc: 0.651
Validation loss decreased (-0.546041 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 1.4387011528015137
Epoch: 4, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
Validation loss decreased (-0.651306 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 1.3288750648498535
Epoch: 5, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
Validation loss decreased (-0.749992 --> -0.776309).  Saving model ...
Epoch: 6 cost time: 1.3404655456542969
Epoch: 6, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
Validation loss decreased (-0.776309 --> -0.802626).  Saving model ...
Epoch: 7 cost time: 1.3474764823913574
Epoch: 7, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.518 Vali Acc: 0.829 Test Loss: 0.518 Test Acc: 0.829
Validation loss decreased (-0.802626 --> -0.828942).  Saving model ...
Epoch: 8 cost time: 1.597475290298462
Epoch: 8, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3895111083984375
Epoch: 9, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.449 Vali Acc: 0.809 Test Loss: 0.449 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5459482669830322
Epoch: 10, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4584810733795166
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5008275508880615
Epoch: 12, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.445 Vali Acc: 0.822 Test Loss: 0.445 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4435794353485107
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.436 Vali Acc: 0.836 Test Loss: 0.436 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835522).  Saving model ...
Epoch: 14 cost time: 1.5133321285247803
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.442 Vali Acc: 0.836 Test Loss: 0.442 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3471300601959229
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4913661479949951
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.451 Vali Acc: 0.842 Test Loss: 0.451 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 17 cost time: 1.2889738082885742
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.463 Vali Acc: 0.816 Test Loss: 0.463 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.506873607635498
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.465 Vali Acc: 0.842 Test Loss: 0.465 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4388179779052734
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.473 Vali Acc: 0.829 Test Loss: 0.473 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7649307250976562
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.473 Vali Acc: 0.836 Test Loss: 0.473 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3941140174865723
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4623594284057617
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3107361793518066
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4231629371643066
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4258441925048828
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4455270767211914
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 570964
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.1780126094818115
Epoch: 1, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.384 Vali Acc: 0.368 Test Loss: 1.384 Test Acc: 0.368
Validation loss decreased (inf --> -0.368407).  Saving model ...
Epoch: 2 cost time: 1.3422682285308838
Epoch: 2, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.213 Vali Acc: 0.539 Test Loss: 1.213 Test Acc: 0.539
Validation loss decreased (-0.368407 --> -0.539462).  Saving model ...
Epoch: 3 cost time: 1.5181498527526855
Epoch: 3, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.030 Vali Acc: 0.651 Test Loss: 1.030 Test Acc: 0.651
Validation loss decreased (-0.539462 --> -0.651305).  Saving model ...
Epoch: 4 cost time: 1.6082606315612793
Epoch: 4, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.872 Vali Acc: 0.691 Test Loss: 0.872 Test Acc: 0.691
Validation loss decreased (-0.651305 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.4250707626342773
Epoch: 5, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.736 Vali Acc: 0.724 Test Loss: 0.736 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.5022025108337402
Epoch: 6, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.644 Vali Acc: 0.763 Test Loss: 0.644 Test Acc: 0.763
Validation loss decreased (-0.723677 --> -0.763151).  Saving model ...
Epoch: 7 cost time: 1.4453411102294922
Epoch: 7, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.4064981937408447
Epoch: 8, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
Validation loss decreased (-0.782889 --> -0.815784).  Saving model ...
Epoch: 9 cost time: 1.3119621276855469
Epoch: 9, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6038696765899658
Epoch: 10, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.451 Vali Acc: 0.822 Test Loss: 0.451 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822364).  Saving model ...
Epoch: 11 cost time: 1.573164939880371
Epoch: 11, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.448 Vali Acc: 0.809 Test Loss: 0.448 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5660550594329834
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.440 Vali Acc: 0.816 Test Loss: 0.440 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5789954662322998
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.426 Vali Acc: 0.803 Test Loss: 0.426 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9602384567260742
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.443 Vali Acc: 0.822 Test Loss: 0.443 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 15 cost time: 1.6476600170135498
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.445 Vali Acc: 0.816 Test Loss: 0.445 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6588726043701172
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.441 Vali Acc: 0.803 Test Loss: 0.441 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5171866416931152
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.459 Vali Acc: 0.809 Test Loss: 0.459 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.961000680923462
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.457 Vali Acc: 0.816 Test Loss: 0.457 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5864601135253906
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6575305461883545
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8165614604949951
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6006860733032227
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8165879249572754
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7069587707519531
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 570964
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6966018676757812
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.418 Vali Acc: 0.296 Test Loss: 1.418 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 1.4759671688079834
Epoch: 2, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.203 Vali Acc: 0.513 Test Loss: 1.203 Test Acc: 0.513
Validation loss decreased (-0.296038 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 1.458012580871582
Epoch: 3, Steps: 10 | Train Loss: 0.972 Vali Loss: 0.993 Vali Acc: 0.612 Test Loss: 0.993 Test Acc: 0.612
Validation loss decreased (-0.513146 --> -0.611832).  Saving model ...
Epoch: 4 cost time: 1.4029278755187988
Epoch: 4, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.828 Vali Acc: 0.664 Test Loss: 0.828 Test Acc: 0.664
Validation loss decreased (-0.611832 --> -0.664465).  Saving model ...
Epoch: 5 cost time: 1.449803113937378
Epoch: 5, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.704 Vali Acc: 0.730 Test Loss: 0.704 Test Acc: 0.730
Validation loss decreased (-0.664465 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 1.5960924625396729
Epoch: 6, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.615 Vali Acc: 0.770 Test Loss: 0.615 Test Acc: 0.770
Validation loss decreased (-0.730256 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.2867512702941895
Epoch: 7, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.5454964637756348
Epoch: 8, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.5221776962280273
Epoch: 9, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.44219970703125
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.4249308109283447
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.422424077987671
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.6764001846313477
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.6105804443359375
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8544714450836182
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 16 cost time: 1.5865261554718018
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6590075492858887
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6101913452148438
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7013671398162842
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5849974155426025
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7243261337280273
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6090519428253174
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7441635131835938
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.586 Vali Acc: 0.809 Test Loss: 0.586 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.50095534324646
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5622587203979492
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.601 Vali Acc: 0.803 Test Loss: 0.601 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 439892
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.230801105499268
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.428 Vali Acc: 0.316 Test Loss: 1.428 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 1.62632417678833
Epoch: 2, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.214 Vali Acc: 0.513 Test Loss: 1.214 Test Acc: 0.513
Validation loss decreased (-0.315775 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 1.5842149257659912
Epoch: 3, Steps: 10 | Train Loss: 0.998 Vali Loss: 0.994 Vali Acc: 0.625 Test Loss: 0.994 Test Acc: 0.625
Validation loss decreased (-0.513146 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.2806050777435303
Epoch: 4, Steps: 10 | Train Loss: 0.711 Vali Loss: 0.825 Vali Acc: 0.684 Test Loss: 0.825 Test Acc: 0.684
Validation loss decreased (-0.624990 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 1.455101728439331
Epoch: 5, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.697 Vali Acc: 0.743 Test Loss: 0.697 Test Acc: 0.743
Validation loss decreased (-0.684202 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 1.4069790840148926
Epoch: 6, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.3571131229400635
Epoch: 7, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.373034954071045
Epoch: 8, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7047898769378662
Epoch: 9, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.5161981582641602
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.5179734230041504
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.4685626029968262
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.4807345867156982
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3711161613464355
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 15 cost time: 1.5599429607391357
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.481654405593872
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4107465744018555
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4174716472625732
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4007041454315186
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5057477951049805
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3690674304962158
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3137505054473877
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5876448154449463
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.585 Vali Acc: 0.796 Test Loss: 0.585 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3785099983215332
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 439892
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.779144048690796
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.425 Vali Acc: 0.283 Test Loss: 1.425 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.3815088272094727
Epoch: 2, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.282880 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.4679172039031982
Epoch: 3, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.013 Vali Acc: 0.625 Test Loss: 1.013 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.4379756450653076
Epoch: 4, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.842 Vali Acc: 0.678 Test Loss: 0.842 Test Acc: 0.678
Validation loss decreased (-0.624990 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 1.6053893566131592
Epoch: 5, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.718 Vali Acc: 0.724 Test Loss: 0.718 Test Acc: 0.724
Validation loss decreased (-0.677623 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.6108508110046387
Epoch: 6, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.5672943592071533
Epoch: 7, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.4939453601837158
Epoch: 8, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.4063620567321777
Epoch: 9, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802627).  Saving model ...
Epoch: 10 cost time: 1.53428053855896
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.471341609954834
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.486 Vali Acc: 0.803 Test Loss: 0.486 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 12 cost time: 1.295353889465332
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5155484676361084
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 14 cost time: 1.5004029273986816
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 15 cost time: 1.3849220275878906
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.524827241897583
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5596506595611572
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5627186298370361
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4722318649291992
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4338951110839844
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8099377155303955
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7948007583618164
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8591806888580322
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.61606764793396
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 439892
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.50638484954834
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.377 Vali Acc: 0.322 Test Loss: 1.377 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.795797348022461
Epoch: 2, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.216 Vali Acc: 0.533 Test Loss: 1.216 Test Acc: 0.533
Validation loss decreased (-0.322355 --> -0.532883).  Saving model ...
Epoch: 3 cost time: 1.483579397201538
Epoch: 3, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.029 Vali Acc: 0.625 Test Loss: 1.029 Test Acc: 0.625
Validation loss decreased (-0.532883 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.4891879558563232
Epoch: 4, Steps: 10 | Train Loss: 0.788 Vali Loss: 0.874 Vali Acc: 0.678 Test Loss: 0.874 Test Acc: 0.678
Validation loss decreased (-0.624990 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 1.3964917659759521
Epoch: 5, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.752 Vali Acc: 0.711 Test Loss: 0.752 Test Acc: 0.711
Validation loss decreased (-0.677623 --> -0.710519).  Saving model ...
Epoch: 6 cost time: 1.4706082344055176
Epoch: 6, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.645 Vali Acc: 0.757 Test Loss: 0.645 Test Acc: 0.757
Validation loss decreased (-0.710519 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.621504306793213
Epoch: 7, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.6202399730682373
Epoch: 8, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.4750537872314453
Epoch: 9, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 10 cost time: 1.593445062637329
Epoch: 10, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.476 Vali Acc: 0.789 Test Loss: 0.476 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 11 cost time: 1.7764441967010498
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.470 Vali Acc: 0.796 Test Loss: 0.470 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 12 cost time: 1.569765329360962
Epoch: 12, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.467 Vali Acc: 0.796 Test Loss: 0.467 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 1.690032958984375
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.477 Vali Acc: 0.796 Test Loss: 0.477 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4996190071105957
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.472 Vali Acc: 0.789 Test Loss: 0.472 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5272877216339111
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.476 Vali Acc: 0.803 Test Loss: 0.476 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 1.570838451385498
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.482 Vali Acc: 0.789 Test Loss: 0.482 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5234942436218262
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.515608787536621
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.495 Vali Acc: 0.789 Test Loss: 0.495 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.378011703491211
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3906574249267578
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4828681945800781
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4136087894439697
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4615769386291504
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3856534957885742
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5282108783721924
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 439892
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9582250118255615
Epoch: 1, Steps: 10 | Train Loss: 1.529 Vali Loss: 1.302 Vali Acc: 0.388 Test Loss: 1.302 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 1.45975923538208
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.111 Vali Acc: 0.572 Test Loss: 1.111 Test Acc: 0.572
Validation loss decreased (-0.388145 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.597623586654663
Epoch: 3, Steps: 10 | Train Loss: 0.975 Vali Loss: 0.912 Vali Acc: 0.658 Test Loss: 0.912 Test Acc: 0.658
Validation loss decreased (-0.572357 --> -0.657886).  Saving model ...
Epoch: 4 cost time: 1.6220178604125977
Epoch: 4, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.765 Vali Acc: 0.711 Test Loss: 0.765 Test Acc: 0.711
Validation loss decreased (-0.657886 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.5771899223327637
Epoch: 5, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.661 Vali Acc: 0.743 Test Loss: 0.661 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 1.578977108001709
Epoch: 6, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.597 Vali Acc: 0.750 Test Loss: 0.597 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.657529354095459
Epoch: 7, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.4191246032714844
Epoch: 8, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6081233024597168
Epoch: 9, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 10 cost time: 1.3821995258331299
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.3414523601531982
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4581520557403564
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6760690212249756
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.666454792022705
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4661636352539062
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3789842128753662
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6723434925079346
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6303894519805908
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5707168579101562
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7001972198486328
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.9483816623687744
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7556822299957275
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5707464218139648
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.599 Vali Acc: 0.829 Test Loss: 0.599 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828941).  Saving model ...
Epoch: 24 cost time: 1.7225239276885986
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6184120178222656
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5882830619812012
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.666529655456543
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7526206970214844
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5634486675262451
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6497745513916016
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.642 Vali Acc: 0.829 Test Loss: 0.642 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.839287281036377
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8137609958648682
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.653 Vali Acc: 0.822 Test Loss: 0.653 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7180240154266357
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.660 Vali Acc: 0.822 Test Loss: 0.660 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 374356
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.197867155075073
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.314 Vali Acc: 0.421 Test Loss: 1.314 Test Acc: 0.421
Validation loss decreased (inf --> -0.421039).  Saving model ...
Epoch: 2 cost time: 1.43742036819458
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.119 Vali Acc: 0.572 Test Loss: 1.119 Test Acc: 0.572
Validation loss decreased (-0.421039 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.4519681930541992
Epoch: 3, Steps: 10 | Train Loss: 0.973 Vali Loss: 0.922 Vali Acc: 0.632 Test Loss: 0.922 Test Acc: 0.632
Validation loss decreased (-0.572357 --> -0.631570).  Saving model ...
Epoch: 4 cost time: 1.4835374355316162
Epoch: 4, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.772 Vali Acc: 0.697 Test Loss: 0.772 Test Acc: 0.697
Validation loss decreased (-0.631570 --> -0.697361).  Saving model ...
Epoch: 5 cost time: 1.5481703281402588
Epoch: 5, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.664 Vali Acc: 0.750 Test Loss: 0.664 Test Acc: 0.750
Validation loss decreased (-0.697361 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.4747815132141113
Epoch: 6, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.593 Vali Acc: 0.776 Test Loss: 0.593 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.3925399780273438
Epoch: 7, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.4310328960418701
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.5475022792816162
Epoch: 9, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802627).  Saving model ...
Epoch: 10 cost time: 1.5085408687591553
Epoch: 10, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.33174729347229
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4770140647888184
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3666059970855713
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5206444263458252
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4037387371063232
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.413827896118164
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4466912746429443
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.4598321914672852
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4740471839904785
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3904337882995605
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3859238624572754
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4552738666534424
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 23 cost time: 1.4220044612884521
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5286707878112793
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5277738571166992
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.593 Vali Acc: 0.809 Test Loss: 0.593 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.432464361190796
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5664441585540771
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4161124229431152
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.816 Test Loss: 0.608 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4485218524932861
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3082008361816406
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5245392322540283
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5223519802093506
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 374356
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6735482215881348
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.311 Vali Acc: 0.375 Test Loss: 1.311 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.446702241897583
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.126 Vali Acc: 0.579 Test Loss: 1.126 Test Acc: 0.579
Validation loss decreased (-0.374987 --> -0.578936).  Saving model ...
Epoch: 3 cost time: 1.6975173950195312
Epoch: 3, Steps: 10 | Train Loss: 1.000 Vali Loss: 0.931 Vali Acc: 0.678 Test Loss: 0.931 Test Acc: 0.678
Validation loss decreased (-0.578936 --> -0.677622).  Saving model ...
Epoch: 4 cost time: 1.4426841735839844
Epoch: 4, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.776 Vali Acc: 0.724 Test Loss: 0.776 Test Acc: 0.724
Validation loss decreased (-0.677622 --> -0.723676).  Saving model ...
Epoch: 5 cost time: 1.6301288604736328
Epoch: 5, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.660 Vali Acc: 0.763 Test Loss: 0.660 Test Acc: 0.763
Validation loss decreased (-0.723676 --> -0.763151).  Saving model ...
Epoch: 6 cost time: 1.6470837593078613
Epoch: 6, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.5124311447143555
Epoch: 7, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.4562599658966064
Epoch: 8, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 9 cost time: 1.4083280563354492
Epoch: 9, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.469 Vali Acc: 0.796 Test Loss: 0.469 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 10 cost time: 1.4972126483917236
Epoch: 10, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.463 Vali Acc: 0.796 Test Loss: 0.463 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 11 cost time: 1.392984390258789
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815785).  Saving model ...
Epoch: 12 cost time: 1.4431297779083252
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6030058860778809
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.469252586364746
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 15 cost time: 1.5582170486450195
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 16 cost time: 1.3650598526000977
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.496 Vali Acc: 0.829 Test Loss: 0.496 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 17 cost time: 1.419956922531128
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.494 Vali Acc: 0.829 Test Loss: 0.494 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 18 cost time: 1.3557438850402832
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.493 Vali Acc: 0.829 Test Loss: 0.493 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 19 cost time: 1.3769032955169678
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.599027395248413
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.505 Vali Acc: 0.836 Test Loss: 0.505 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 21 cost time: 1.5995759963989258
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7136037349700928
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.510 Vali Acc: 0.836 Test Loss: 0.510 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6982214450836182
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.519 Vali Acc: 0.829 Test Loss: 0.519 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5451545715332031
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.52561616897583
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.529 Vali Acc: 0.829 Test Loss: 0.529 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5056898593902588
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.829 Test Loss: 0.537 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4399497509002686
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.597578763961792
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3575809001922607
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4087352752685547
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.829 Test Loss: 0.559 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 374356
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7846271991729736
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.324 Vali Acc: 0.408 Test Loss: 1.324 Test Acc: 0.408
Validation loss decreased (inf --> -0.407881).  Saving model ...
Epoch: 2 cost time: 1.3608849048614502
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.160 Vali Acc: 0.572 Test Loss: 1.160 Test Acc: 0.572
Validation loss decreased (-0.407881 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.3843538761138916
Epoch: 3, Steps: 10 | Train Loss: 1.058 Vali Loss: 0.983 Vali Acc: 0.697 Test Loss: 0.983 Test Acc: 0.697
Validation loss decreased (-0.572357 --> -0.697359).  Saving model ...
Epoch: 4 cost time: 1.2843739986419678
Epoch: 4, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.828 Vali Acc: 0.697 Test Loss: 0.828 Test Acc: 0.697
Validation loss decreased (-0.697359 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 1.3960356712341309
Epoch: 5, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.701 Vali Acc: 0.763 Test Loss: 0.701 Test Acc: 0.763
Validation loss decreased (-0.697360 --> -0.763151).  Saving model ...
Epoch: 6 cost time: 1.5255913734436035
Epoch: 6, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.4986896514892578
Epoch: 7, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
Validation loss decreased (-0.776310 --> -0.822363).  Saving model ...
Epoch: 8 cost time: 1.534729242324829
Epoch: 8, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3544957637786865
Epoch: 9, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.463 Vali Acc: 0.822 Test Loss: 0.463 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 10 cost time: 1.3507256507873535
Epoch: 10, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.438 Vali Acc: 0.809 Test Loss: 0.438 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4295618534088135
Epoch: 11, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.450 Vali Acc: 0.829 Test Loss: 0.450 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 12 cost time: 1.4353523254394531
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5491950511932373
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5970418453216553
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.456 Vali Acc: 0.829 Test Loss: 0.456 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5920655727386475
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.461 Vali Acc: 0.829 Test Loss: 0.461 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4533233642578125
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3791310787200928
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3701651096343994
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4641776084899902
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.478 Vali Acc: 0.849 Test Loss: 0.478 Test Acc: 0.849
Validation loss decreased (-0.828943 --> -0.848679).  Saving model ...
Epoch: 20 cost time: 1.4595530033111572
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4706165790557861
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.491 Vali Acc: 0.849 Test Loss: 0.491 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4389982223510742
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.599675178527832
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.503 Vali Acc: 0.829 Test Loss: 0.503 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.607192039489746
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.511 Vali Acc: 0.836 Test Loss: 0.511 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3558552265167236
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5910420417785645
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5713727474212646
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.529 Vali Acc: 0.836 Test Loss: 0.529 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5897774696350098
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.829 Test Loss: 0.535 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.581739902496338
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 374356
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.990800619125366
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.442 Vali Acc: 0.382 Test Loss: 1.442 Test Acc: 0.382
Validation loss decreased (inf --> -0.381565).  Saving model ...
Epoch: 2 cost time: 1.3084437847137451
Epoch: 2, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.318 Vali Acc: 0.421 Test Loss: 1.318 Test Acc: 0.421
Validation loss decreased (-0.381565 --> -0.421039).  Saving model ...
Epoch: 3 cost time: 1.2904915809631348
Epoch: 3, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
Validation loss decreased (-0.421039 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.315965175628662
Epoch: 4, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.010 Vali Acc: 0.586 Test Loss: 1.010 Test Acc: 0.586
Validation loss decreased (-0.499988 --> -0.585516).  Saving model ...
Epoch: 5 cost time: 1.2994236946105957
Epoch: 5, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.865 Vali Acc: 0.658 Test Loss: 0.865 Test Acc: 0.658
Validation loss decreased (-0.585516 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.2028815746307373
Epoch: 6, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.764 Vali Acc: 0.704 Test Loss: 0.764 Test Acc: 0.704
Validation loss decreased (-0.657886 --> -0.703940).  Saving model ...
Epoch: 7 cost time: 1.3966548442840576
Epoch: 7, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.678 Vali Acc: 0.757 Test Loss: 0.678 Test Acc: 0.757
Validation loss decreased (-0.703940 --> -0.756572).  Saving model ...
Epoch: 8 cost time: 1.2445769309997559
Epoch: 8, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.2818119525909424
Epoch: 9, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 1.3489606380462646
Epoch: 10, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.3392534255981445
Epoch: 11, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.3244833946228027
Epoch: 12, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.3014085292816162
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.246530294418335
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 1.2383537292480469
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 16 cost time: 1.3811759948730469
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.316239833831787
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2767333984375
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 19 cost time: 1.1353726387023926
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.485964298248291
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.27120041847229
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4123997688293457
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5362107753753662
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3688178062438965
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3746929168701172
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4294745922088623
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4065167903900146
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3668527603149414
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1137492
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4072649478912354
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.429 Vali Acc: 0.368 Test Loss: 1.429 Test Acc: 0.368
Validation loss decreased (inf --> -0.368407).  Saving model ...
Epoch: 2 cost time: 1.4893312454223633
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.308 Vali Acc: 0.395 Test Loss: 1.308 Test Acc: 0.395
Validation loss decreased (-0.368407 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.296170711517334
Epoch: 3, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.150 Vali Acc: 0.507 Test Loss: 1.150 Test Acc: 0.507
Validation loss decreased (-0.394724 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.4618537425994873
Epoch: 4, Steps: 10 | Train Loss: 0.936 Vali Loss: 0.998 Vali Acc: 0.625 Test Loss: 0.998 Test Acc: 0.625
Validation loss decreased (-0.506567 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 1.1478750705718994
Epoch: 5, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.850 Vali Acc: 0.691 Test Loss: 0.850 Test Acc: 0.691
Validation loss decreased (-0.624990 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 1.4493565559387207
Epoch: 6, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.740 Vali Acc: 0.704 Test Loss: 0.740 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703940).  Saving model ...
Epoch: 7 cost time: 1.3989109992980957
Epoch: 7, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.657 Vali Acc: 0.757 Test Loss: 0.657 Test Acc: 0.757
Validation loss decreased (-0.703940 --> -0.756572).  Saving model ...
Epoch: 8 cost time: 1.2399582862854004
Epoch: 8, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.3501243591308594
Epoch: 9, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.467743158340454
Epoch: 10, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.508551836013794
Epoch: 11, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.3528671264648438
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809206).  Saving model ...
Epoch: 13 cost time: 1.3889610767364502
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 14 cost time: 1.2056448459625244
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.480 Vali Acc: 0.822 Test Loss: 0.480 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 15 cost time: 1.2508981227874756
Epoch: 15, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1907434463500977
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.478 Vali Acc: 0.829 Test Loss: 0.478 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 17 cost time: 1.1711461544036865
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2761273384094238
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2286159992218018
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.396505355834961
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.479628562927246
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2318706512451172
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2607591152191162
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3392627239227295
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.505 Vali Acc: 0.816 Test Loss: 0.505 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2376043796539307
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4362411499023438
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1137492
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7356936931610107
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.419 Vali Acc: 0.316 Test Loss: 1.419 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 1.3307547569274902
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.306 Vali Acc: 0.401 Test Loss: 1.306 Test Acc: 0.401
Validation loss decreased (-0.315775 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.4306395053863525
Epoch: 3, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.156 Vali Acc: 0.487 Test Loss: 1.156 Test Acc: 0.487
Validation loss decreased (-0.401303 --> -0.486831).  Saving model ...
Epoch: 4 cost time: 1.4599487781524658
Epoch: 4, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.009 Vali Acc: 0.605 Test Loss: 1.009 Test Acc: 0.605
Validation loss decreased (-0.486831 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 1.3330793380737305
Epoch: 5, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.871 Vali Acc: 0.737 Test Loss: 0.871 Test Acc: 0.737
Validation loss decreased (-0.605253 --> -0.736833).  Saving model ...
Epoch: 6 cost time: 1.4539432525634766
Epoch: 6, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.759 Vali Acc: 0.724 Test Loss: 0.759 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3973712921142578
Epoch: 7, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.669 Vali Acc: 0.770 Test Loss: 0.669 Test Acc: 0.770
Validation loss decreased (-0.736833 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 1.4201273918151855
Epoch: 8, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.607 Vali Acc: 0.770 Test Loss: 0.607 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.4740631580352783
Epoch: 9, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.5087699890136719
Epoch: 10, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.362776756286621
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809206).  Saving model ...
Epoch: 12 cost time: 1.4668347835540771
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 13 cost time: 1.383375883102417
Epoch: 13, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.392667531967163
Epoch: 14, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.452 Vali Acc: 0.796 Test Loss: 0.452 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5058228969573975
Epoch: 15, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.448 Vali Acc: 0.803 Test Loss: 0.448 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4225432872772217
Epoch: 16, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.443 Vali Acc: 0.816 Test Loss: 0.443 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 17 cost time: 1.5310583114624023
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 18 cost time: 1.5162408351898193
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.454 Vali Acc: 0.829 Test Loss: 0.454 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 19 cost time: 1.7201907634735107
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.373321294784546
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5721228122711182
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.449 Vali Acc: 0.822 Test Loss: 0.449 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6503708362579346
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.451 Vali Acc: 0.816 Test Loss: 0.451 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4510703086853027
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.453 Vali Acc: 0.829 Test Loss: 0.453 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 24 cost time: 1.5824365615844727
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.455 Vali Acc: 0.829 Test Loss: 0.455 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5670714378356934
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.459 Vali Acc: 0.829 Test Loss: 0.459 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4549496173858643
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.466 Vali Acc: 0.829 Test Loss: 0.466 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.704350471496582
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.355233907699585
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5421249866485596
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.471 Vali Acc: 0.836 Test Loss: 0.471 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 30 cost time: 1.430621862411499
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5259568691253662
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3751635551452637
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.477 Vali Acc: 0.829 Test Loss: 0.477 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6156702041625977
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.481 Vali Acc: 0.829 Test Loss: 0.481 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.447950839996338
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3063199520111084
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4154112339019775
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.496 Vali Acc: 0.836 Test Loss: 0.496 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4130680561065674
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.500 Vali Acc: 0.829 Test Loss: 0.500 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4646916389465332
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.4065840244293213
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.504 Vali Acc: 0.829 Test Loss: 0.504 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 1137492
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.377718925476074
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.428 Vali Acc: 0.283 Test Loss: 1.428 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.3224294185638428
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.333 Vali Acc: 0.382 Test Loss: 1.333 Test Acc: 0.382
Validation loss decreased (-0.282880 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.2149674892425537
Epoch: 3, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.212 Vali Acc: 0.493 Test Loss: 1.212 Test Acc: 0.493
Validation loss decreased (-0.381566 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.31099534034729
Epoch: 4, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.083 Vali Acc: 0.605 Test Loss: 1.083 Test Acc: 0.605
Validation loss decreased (-0.493409 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 1.3857898712158203
Epoch: 5, Steps: 10 | Train Loss: 0.889 Vali Loss: 0.955 Vali Acc: 0.691 Test Loss: 0.955 Test Acc: 0.691
Validation loss decreased (-0.605252 --> -0.690780).  Saving model ...
Epoch: 6 cost time: 1.2892773151397705
Epoch: 6, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.847 Vali Acc: 0.704 Test Loss: 0.847 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.3877372741699219
Epoch: 7, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.751 Vali Acc: 0.743 Test Loss: 0.751 Test Acc: 0.743
Validation loss decreased (-0.703939 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.4234144687652588
Epoch: 8, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
Validation loss decreased (-0.743414 --> -0.782888).  Saving model ...
Epoch: 9 cost time: 1.288970708847046
Epoch: 9, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.613 Vali Acc: 0.763 Test Loss: 0.613 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2786014080047607
Epoch: 10, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.198957920074463
Epoch: 11, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.314723253250122
Epoch: 12, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809206).  Saving model ...
Epoch: 13 cost time: 1.0878465175628662
Epoch: 13, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 14 cost time: 1.261918544769287
Epoch: 14, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3373801708221436
Epoch: 15, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.468 Vali Acc: 0.803 Test Loss: 0.468 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3043384552001953
Epoch: 16, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.463 Vali Acc: 0.803 Test Loss: 0.463 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5631434917449951
Epoch: 17, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.470 Vali Acc: 0.789 Test Loss: 0.470 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3894143104553223
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.484 Vali Acc: 0.796 Test Loss: 0.484 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4767134189605713
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.484 Vali Acc: 0.796 Test Loss: 0.484 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.333984136581421
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3196845054626465
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2014405727386475
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4403762817382812
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1137492
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7548036575317383
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.412 Vali Acc: 0.303 Test Loss: 1.412 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 1.122725486755371
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.276 Vali Acc: 0.401 Test Loss: 1.276 Test Acc: 0.401
Validation loss decreased (-0.302617 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.2081685066223145
Epoch: 3, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.133 Vali Acc: 0.520 Test Loss: 1.133 Test Acc: 0.520
Validation loss decreased (-0.401303 --> -0.519726).  Saving model ...
Epoch: 4 cost time: 1.1459383964538574
Epoch: 4, Steps: 10 | Train Loss: 0.977 Vali Loss: 0.996 Vali Acc: 0.612 Test Loss: 0.996 Test Acc: 0.612
Validation loss decreased (-0.519726 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.3454742431640625
Epoch: 5, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.878 Vali Acc: 0.625 Test Loss: 0.878 Test Acc: 0.625
Validation loss decreased (-0.611832 --> -0.624991).  Saving model ...
Epoch: 6 cost time: 1.3143463134765625
Epoch: 6, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.780 Vali Acc: 0.684 Test Loss: 0.780 Test Acc: 0.684
Validation loss decreased (-0.624991 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.5859854221343994
Epoch: 7, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.710 Vali Acc: 0.704 Test Loss: 0.710 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 8 cost time: 1.3205251693725586
Epoch: 8, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
Validation loss decreased (-0.703940 --> -0.756572).  Saving model ...
Epoch: 9 cost time: 1.3166797161102295
Epoch: 9, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.2822942733764648
Epoch: 10, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.2570013999938965
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.3000340461730957
Epoch: 12, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.3323006629943848
Epoch: 13, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.5538959503173828
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 15 cost time: 1.2465336322784424
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.405397653579712
Epoch: 16, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 1.1823220252990723
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.417611837387085
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.23868989944458
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 20 cost time: 1.4144976139068604
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.191999912261963
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 22 cost time: 1.273949384689331
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2390735149383545
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2653369903564453
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2897837162017822
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1808722019195557
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0862503051757812
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2762751579284668
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2202832698822021
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2230632305145264
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3461005687713623
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 613204
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.742800235748291
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.415 Vali Acc: 0.322 Test Loss: 1.415 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 1.6313419342041016
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.284 Vali Acc: 0.388 Test Loss: 1.284 Test Acc: 0.388
Validation loss decreased (-0.322354 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.4886877536773682
Epoch: 3, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.141 Vali Acc: 0.553 Test Loss: 1.141 Test Acc: 0.553
Validation loss decreased (-0.388145 --> -0.552620).  Saving model ...
Epoch: 4 cost time: 1.2422170639038086
Epoch: 4, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.002 Vali Acc: 0.605 Test Loss: 1.002 Test Acc: 0.605
Validation loss decreased (-0.552620 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 1.246016263961792
Epoch: 5, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.885 Vali Acc: 0.671 Test Loss: 0.885 Test Acc: 0.671
Validation loss decreased (-0.605253 --> -0.671044).  Saving model ...
Epoch: 6 cost time: 1.5305333137512207
Epoch: 6, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.787 Vali Acc: 0.691 Test Loss: 0.787 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690782).  Saving model ...
Epoch: 7 cost time: 1.416755199432373
Epoch: 7, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.713 Vali Acc: 0.724 Test Loss: 0.713 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.295696496963501
Epoch: 8, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 1.3459556102752686
Epoch: 9, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 1.2585070133209229
Epoch: 10, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4898746013641357
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.5418403148651123
Epoch: 12, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.258561134338379
Epoch: 13, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.443692684173584
Epoch: 14, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.2736382484436035
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.522428274154663
Epoch: 16, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 17 cost time: 1.443359613418579
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5868604183197021
Epoch: 18, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 19 cost time: 1.4514625072479248
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5122804641723633
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5110852718353271
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5857658386230469
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5903546810150146
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4530746936798096
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3053958415985107
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5753650665283203
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 27 cost time: 1.5052964687347412
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.411224126815796
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.386277198791504
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2964401245117188
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.594292163848877
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3474540710449219
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3946704864501953
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.473452091217041
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4734883308410645
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.551 Vali Acc: 0.816 Test Loss: 0.551 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4156382083892822
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 613204
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.316765785217285
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.422 Vali Acc: 0.263 Test Loss: 1.422 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.2830395698547363
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.298 Vali Acc: 0.401 Test Loss: 1.298 Test Acc: 0.401
Validation loss decreased (-0.263144 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.2700929641723633
Epoch: 3, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.164 Vali Acc: 0.533 Test Loss: 1.164 Test Acc: 0.533
Validation loss decreased (-0.401303 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 1.2949495315551758
Epoch: 4, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.026 Vali Acc: 0.599 Test Loss: 1.026 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598674).  Saving model ...
Epoch: 5 cost time: 1.2930879592895508
Epoch: 5, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.902 Vali Acc: 0.658 Test Loss: 0.902 Test Acc: 0.658
Validation loss decreased (-0.598674 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.3939437866210938
Epoch: 6, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.800 Vali Acc: 0.724 Test Loss: 0.800 Test Acc: 0.724
Validation loss decreased (-0.657886 --> -0.723676).  Saving model ...
Epoch: 7 cost time: 1.351381540298462
Epoch: 7, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.719 Vali Acc: 0.730 Test Loss: 0.719 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.3163104057312012
Epoch: 8, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.648 Vali Acc: 0.763 Test Loss: 0.648 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763151).  Saving model ...
Epoch: 9 cost time: 1.3350086212158203
Epoch: 9, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.597 Vali Acc: 0.776 Test Loss: 0.597 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.4668538570404053
Epoch: 10, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.2793128490447998
Epoch: 11, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.3435828685760498
Epoch: 12, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4757740497589111
Epoch: 13, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 14 cost time: 1.3531250953674316
Epoch: 14, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 15 cost time: 1.401686191558838
Epoch: 15, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 1.3235340118408203
Epoch: 16, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.470 Vali Acc: 0.803 Test Loss: 0.470 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 17 cost time: 1.318380355834961
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 18 cost time: 1.4520645141601562
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.458 Vali Acc: 0.829 Test Loss: 0.458 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828943).  Saving model ...
Epoch: 19 cost time: 1.4188416004180908
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.456 Vali Acc: 0.803 Test Loss: 0.456 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3403096199035645
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.453 Vali Acc: 0.816 Test Loss: 0.453 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3085989952087402
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4386048316955566
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.463 Vali Acc: 0.822 Test Loss: 0.463 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2383174896240234
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.465 Vali Acc: 0.816 Test Loss: 0.465 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2641100883483887
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4011871814727783
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.472 Vali Acc: 0.816 Test Loss: 0.472 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5181033611297607
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.174675703048706
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3098328113555908
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 613204
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4013051986694336
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.414 Vali Acc: 0.329 Test Loss: 1.414 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.1596384048461914
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.312 Vali Acc: 0.447 Test Loss: 1.312 Test Acc: 0.447
Validation loss decreased (-0.328933 --> -0.447355).  Saving model ...
Epoch: 3 cost time: 1.0752837657928467
Epoch: 3, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.194 Vali Acc: 0.546 Test Loss: 1.194 Test Acc: 0.546
Validation loss decreased (-0.447355 --> -0.546041).  Saving model ...
Epoch: 4 cost time: 1.1391234397888184
Epoch: 4, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.074 Vali Acc: 0.625 Test Loss: 1.074 Test Acc: 0.625
Validation loss decreased (-0.546041 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.224236249923706
Epoch: 5, Steps: 10 | Train Loss: 0.913 Vali Loss: 0.954 Vali Acc: 0.691 Test Loss: 0.954 Test Acc: 0.691
Validation loss decreased (-0.624989 --> -0.690780).  Saving model ...
Epoch: 6 cost time: 1.0894291400909424
Epoch: 6, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.850 Vali Acc: 0.730 Test Loss: 0.850 Test Acc: 0.730
Validation loss decreased (-0.690780 --> -0.730255).  Saving model ...
Epoch: 7 cost time: 1.1181867122650146
Epoch: 7, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.762 Vali Acc: 0.757 Test Loss: 0.762 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756571).  Saving model ...
Epoch: 8 cost time: 1.2717559337615967
Epoch: 8, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
Validation loss decreased (-0.756571 --> -0.789467).  Saving model ...
Epoch: 9 cost time: 1.1728229522705078
Epoch: 9, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 10 cost time: 1.273148536682129
Epoch: 10, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1758151054382324
Epoch: 11, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3693029880523682
Epoch: 12, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 1.0820274353027344
Epoch: 13, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 14 cost time: 1.025911569595337
Epoch: 14, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.127190351486206
Epoch: 15, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.465 Vali Acc: 0.816 Test Loss: 0.465 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 16 cost time: 1.1474225521087646
Epoch: 16, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.462 Vali Acc: 0.822 Test Loss: 0.462 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 17 cost time: 1.1652946472167969
Epoch: 17, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2077348232269287
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.454 Vali Acc: 0.822 Test Loss: 0.454 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 19 cost time: 1.1398320198059082
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.464 Vali Acc: 0.822 Test Loss: 0.464 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1667706966400146
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.460 Vali Acc: 0.829 Test Loss: 0.460 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 21 cost time: 1.1478478908538818
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0740694999694824
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0533123016357422
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.473 Vali Acc: 0.822 Test Loss: 0.473 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1845767498016357
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1938402652740479
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.488 Vali Acc: 0.816 Test Loss: 0.488 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.309607982635498
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2187893390655518
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.047757863998413
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2471706867218018
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2055909633636475
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 613204
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.358293294906616
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.407 Vali Acc: 0.349 Test Loss: 1.407 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.2682673931121826
Epoch: 2, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.279 Vali Acc: 0.421 Test Loss: 1.279 Test Acc: 0.421
Validation loss decreased (-0.348670 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 1.2731895446777344
Epoch: 3, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.123 Vali Acc: 0.546 Test Loss: 1.123 Test Acc: 0.546
Validation loss decreased (-0.421040 --> -0.546041).  Saving model ...
Epoch: 4 cost time: 1.1660969257354736
Epoch: 4, Steps: 10 | Train Loss: 0.919 Vali Loss: 0.982 Vali Acc: 0.572 Test Loss: 0.982 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572359).  Saving model ...
Epoch: 5 cost time: 1.200510025024414
Epoch: 5, Steps: 10 | Train Loss: 0.751 Vali Loss: 0.862 Vali Acc: 0.618 Test Loss: 0.862 Test Acc: 0.618
Validation loss decreased (-0.572359 --> -0.618412).  Saving model ...
Epoch: 6 cost time: 1.2593703269958496
Epoch: 6, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.761 Vali Acc: 0.724 Test Loss: 0.761 Test Acc: 0.724
Validation loss decreased (-0.618412 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 1.1848492622375488
Epoch: 7, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.688 Vali Acc: 0.743 Test Loss: 0.688 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.5324633121490479
Epoch: 8, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.625 Vali Acc: 0.770 Test Loss: 0.625 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.5321745872497559
Epoch: 9, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.2386164665222168
Epoch: 10, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.2293791770935059
Epoch: 11, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2765722274780273
Epoch: 12, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.28120756149292
Epoch: 13, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.505 Vali Acc: 0.816 Test Loss: 0.505 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.3372430801391602
Epoch: 14, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 1.2961161136627197
Epoch: 15, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 16 cost time: 1.2140684127807617
Epoch: 16, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1422712802886963
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.504 Vali Acc: 0.822 Test Loss: 0.504 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2202861309051514
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2338674068450928
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 20 cost time: 1.2027380466461182
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.502 Vali Acc: 0.829 Test Loss: 0.502 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 21 cost time: 1.1919324398040771
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4879648685455322
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2186205387115479
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4024336338043213
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1618611812591553
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3906645774841309
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1744298934936523
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.21042799949646
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4387078285217285
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2735919952392578
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 351060
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3949921131134033
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.387 Vali Acc: 0.329 Test Loss: 1.387 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.2887859344482422
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.269 Vali Acc: 0.421 Test Loss: 1.269 Test Acc: 0.421
Validation loss decreased (-0.328934 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 1.1265459060668945
Epoch: 3, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.118 Vali Acc: 0.566 Test Loss: 1.118 Test Acc: 0.566
Validation loss decreased (-0.421040 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.2336983680725098
Epoch: 4, Steps: 10 | Train Loss: 0.926 Vali Loss: 0.982 Vali Acc: 0.625 Test Loss: 0.982 Test Acc: 0.625
Validation loss decreased (-0.565778 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 1.2372303009033203
Epoch: 5, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
Validation loss decreased (-0.624990 --> -0.717097).  Saving model ...
Epoch: 6 cost time: 1.1030404567718506
Epoch: 6, Steps: 10 | Train Loss: 0.630 Vali Loss: 0.762 Vali Acc: 0.730 Test Loss: 0.762 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 1.1278996467590332
Epoch: 7, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.689 Vali Acc: 0.763 Test Loss: 0.689 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 1.21223783493042
Epoch: 8, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.1932258605957031
Epoch: 9, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.2321667671203613
Epoch: 10, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.2018766403198242
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.3892934322357178
Epoch: 12, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.506 Vali Acc: 0.829 Test Loss: 0.506 Test Acc: 0.829
Validation loss decreased (-0.802626 --> -0.828942).  Saving model ...
Epoch: 13 cost time: 1.195023775100708
Epoch: 13, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3200786113739014
Epoch: 14, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3361332416534424
Epoch: 15, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1478114128112793
Epoch: 16, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2395529747009277
Epoch: 17, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.420595407485962
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1713817119598389
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3447377681732178
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1554791927337646
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.503 Vali Acc: 0.816 Test Loss: 0.503 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.258768081665039
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 351060
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8557679653167725
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.384 Vali Acc: 0.316 Test Loss: 1.384 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.4512176513671875
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.275 Vali Acc: 0.428 Test Loss: 1.275 Test Acc: 0.428
Validation loss decreased (-0.315776 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.3327314853668213
Epoch: 3, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.138 Vali Acc: 0.507 Test Loss: 1.138 Test Acc: 0.507
Validation loss decreased (-0.427619 --> -0.506568).  Saving model ...
Epoch: 4 cost time: 1.427042007446289
Epoch: 4, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.004 Vali Acc: 0.592 Test Loss: 1.004 Test Acc: 0.592
Validation loss decreased (-0.506568 --> -0.592095).  Saving model ...
Epoch: 5 cost time: 1.5840153694152832
Epoch: 5, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.884 Vali Acc: 0.671 Test Loss: 0.884 Test Acc: 0.671
Validation loss decreased (-0.592095 --> -0.671044).  Saving model ...
Epoch: 6 cost time: 1.4722061157226562
Epoch: 6, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.781 Vali Acc: 0.730 Test Loss: 0.781 Test Acc: 0.730
Validation loss decreased (-0.671044 --> -0.730255).  Saving model ...
Epoch: 7 cost time: 1.382474660873413
Epoch: 7, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.700 Vali Acc: 0.783 Test Loss: 0.700 Test Acc: 0.783
Validation loss decreased (-0.730255 --> -0.782888).  Saving model ...
Epoch: 8 cost time: 1.3147785663604736
Epoch: 8, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.633 Vali Acc: 0.803 Test Loss: 0.633 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 9 cost time: 1.382063865661621
Epoch: 9, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4888486862182617
Epoch: 10, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.4796700477600098
Epoch: 11, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.570925235748291
Epoch: 12, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.282576084136963
Epoch: 13, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822364).  Saving model ...
Epoch: 14 cost time: 1.39021897315979
Epoch: 14, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.465 Vali Acc: 0.816 Test Loss: 0.465 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4862031936645508
Epoch: 15, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 16 cost time: 1.3423051834106445
Epoch: 16, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.456 Vali Acc: 0.829 Test Loss: 0.456 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 17 cost time: 1.2797353267669678
Epoch: 17, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.457 Vali Acc: 0.829 Test Loss: 0.457 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4606947898864746
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.454 Vali Acc: 0.809 Test Loss: 0.454 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4693725109100342
Epoch: 19, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.453 Vali Acc: 0.829 Test Loss: 0.453 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 20 cost time: 1.6170556545257568
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.452 Vali Acc: 0.836 Test Loss: 0.452 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 21 cost time: 1.5236997604370117
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.455 Vali Acc: 0.842 Test Loss: 0.455 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 22 cost time: 1.576200246810913
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.463 Vali Acc: 0.829 Test Loss: 0.463 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4278011322021484
Epoch: 23, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3855388164520264
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.466 Vali Acc: 0.836 Test Loss: 0.466 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3606507778167725
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.463 Vali Acc: 0.842 Test Loss: 0.463 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2946512699127197
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.470 Vali Acc: 0.836 Test Loss: 0.470 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2628722190856934
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.468 Vali Acc: 0.842 Test Loss: 0.468 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3205780982971191
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.468 Vali Acc: 0.849 Test Loss: 0.468 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 29 cost time: 1.3091626167297363
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.475 Vali Acc: 0.842 Test Loss: 0.475 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.580838918685913
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.476 Vali Acc: 0.842 Test Loss: 0.476 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3840372562408447
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.481 Vali Acc: 0.842 Test Loss: 0.481 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3739066123962402
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.487 Vali Acc: 0.842 Test Loss: 0.487 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3709981441497803
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.488 Vali Acc: 0.836 Test Loss: 0.488 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3352320194244385
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.486 Vali Acc: 0.842 Test Loss: 0.486 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1663811206817627
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.490 Vali Acc: 0.836 Test Loss: 0.490 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4653334617614746
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.500 Vali Acc: 0.836 Test Loss: 0.500 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.484969139099121
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.501 Vali Acc: 0.842 Test Loss: 0.501 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3479807376861572
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.501 Vali Acc: 0.842 Test Loss: 0.501 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 351060
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.638948917388916
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.388 Vali Acc: 0.257 Test Loss: 1.388 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.1680638790130615
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.297 Vali Acc: 0.388 Test Loss: 1.297 Test Acc: 0.388
Validation loss decreased (-0.256565 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.2083704471588135
Epoch: 3, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.388145 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2055659294128418
Epoch: 4, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.071 Vali Acc: 0.592 Test Loss: 1.071 Test Acc: 0.592
Validation loss decreased (-0.499988 --> -0.592095).  Saving model ...
Epoch: 5 cost time: 1.2084357738494873
Epoch: 5, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.960 Vali Acc: 0.638 Test Loss: 0.960 Test Acc: 0.638
Validation loss decreased (-0.592095 --> -0.638148).  Saving model ...
Epoch: 6 cost time: 1.120967149734497
Epoch: 6, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.857 Vali Acc: 0.704 Test Loss: 0.857 Test Acc: 0.704
Validation loss decreased (-0.638148 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.0414202213287354
Epoch: 7, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.769 Vali Acc: 0.724 Test Loss: 0.769 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.1229472160339355
Epoch: 8, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
Validation loss decreased (-0.723677 --> -0.782888).  Saving model ...
Epoch: 9 cost time: 1.0604188442230225
Epoch: 9, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 10 cost time: 1.1400823593139648
Epoch: 10, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.578 Vali Acc: 0.776 Test Loss: 0.578 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2073514461517334
Epoch: 11, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.2104637622833252
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.04146409034729
Epoch: 13, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.504 Vali Acc: 0.836 Test Loss: 0.504 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835521).  Saving model ...
Epoch: 14 cost time: 1.0440354347229004
Epoch: 14, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.495 Vali Acc: 0.842 Test Loss: 0.495 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 15 cost time: 1.2065339088439941
Epoch: 15, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.480 Vali Acc: 0.822 Test Loss: 0.480 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2412683963775635
Epoch: 16, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.484 Vali Acc: 0.849 Test Loss: 0.484 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848679).  Saving model ...
Epoch: 17 cost time: 1.2385146617889404
Epoch: 17, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1629481315612793
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.474 Vali Acc: 0.822 Test Loss: 0.474 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1964688301086426
Epoch: 19, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.08750319480896
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2868728637695312
Epoch: 21, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2846100330352783
Epoch: 22, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0954456329345703
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.503 Vali Acc: 0.842 Test Loss: 0.503 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.268526315689087
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0276784896850586
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.117643117904663
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 351060
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5554609298706055
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.328 Vali Acc: 0.362 Test Loss: 1.328 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 1.1500368118286133
Epoch: 2, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.212 Vali Acc: 0.441 Test Loss: 1.212 Test Acc: 0.441
Validation loss decreased (-0.361829 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 1.1992111206054688
Epoch: 3, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.075 Vali Acc: 0.559 Test Loss: 1.075 Test Acc: 0.559
Validation loss decreased (-0.440777 --> -0.559200).  Saving model ...
Epoch: 4 cost time: 1.2140567302703857
Epoch: 4, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.937 Vali Acc: 0.664 Test Loss: 0.937 Test Acc: 0.664
Validation loss decreased (-0.559200 --> -0.664464).  Saving model ...
Epoch: 5 cost time: 1.1687426567077637
Epoch: 5, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.825 Vali Acc: 0.671 Test Loss: 0.825 Test Acc: 0.671
Validation loss decreased (-0.664464 --> -0.671044).  Saving model ...
Epoch: 6 cost time: 1.2298777103424072
Epoch: 6, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.735 Vali Acc: 0.697 Test Loss: 0.735 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 1.2852866649627686
Epoch: 7, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.668 Vali Acc: 0.711 Test Loss: 0.668 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710520).  Saving model ...
Epoch: 8 cost time: 1.1710515022277832
Epoch: 8, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.622 Vali Acc: 0.743 Test Loss: 0.622 Test Acc: 0.743
Validation loss decreased (-0.710520 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.2513792514801025
Epoch: 9, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.1949262619018555
Epoch: 10, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.3870232105255127
Epoch: 11, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.3324711322784424
Epoch: 12, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 1.3958733081817627
Epoch: 13, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.189471960067749
Epoch: 14, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 15 cost time: 1.2538280487060547
Epoch: 15, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.486 Vali Acc: 0.829 Test Loss: 0.486 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 16 cost time: 1.201021432876587
Epoch: 16, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.485 Vali Acc: 0.829 Test Loss: 0.485 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 17 cost time: 1.341341257095337
Epoch: 17, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2405517101287842
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.492 Vali Acc: 0.836 Test Loss: 0.492 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 19 cost time: 1.1465425491333008
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.211669921875
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2589240074157715
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1787211894989014
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3952157497406006
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.522 Vali Acc: 0.829 Test Loss: 0.522 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2457618713378906
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1934947967529297
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.525 Vali Acc: 0.829 Test Loss: 0.525 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2521483898162842
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.527 Vali Acc: 0.829 Test Loss: 0.527 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.306330919265747
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.534 Vali Acc: 0.829 Test Loss: 0.534 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3020339012145996
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.539 Vali Acc: 0.836 Test Loss: 0.539 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 219988
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.686187267303467
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.349 Vali Acc: 0.303 Test Loss: 1.349 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.3863742351531982
Epoch: 2, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.234 Vali Acc: 0.395 Test Loss: 1.234 Test Acc: 0.395
Validation loss decreased (-0.302618 --> -0.394725).  Saving model ...
Epoch: 3 cost time: 1.3116729259490967
Epoch: 3, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.099 Vali Acc: 0.553 Test Loss: 1.099 Test Acc: 0.553
Validation loss decreased (-0.394725 --> -0.552621).  Saving model ...
Epoch: 4 cost time: 1.4335401058197021
Epoch: 4, Steps: 10 | Train Loss: 0.932 Vali Loss: 0.963 Vali Acc: 0.638 Test Loss: 0.963 Test Acc: 0.638
Validation loss decreased (-0.552621 --> -0.638148).  Saving model ...
Epoch: 5 cost time: 1.3924713134765625
Epoch: 5, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.849 Vali Acc: 0.658 Test Loss: 0.849 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.2441322803497314
Epoch: 6, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.754 Vali Acc: 0.697 Test Loss: 0.754 Test Acc: 0.697
Validation loss decreased (-0.657886 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 1.1291983127593994
Epoch: 7, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.683 Vali Acc: 0.684 Test Loss: 0.683 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5141863822937012
Epoch: 8, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.632 Vali Acc: 0.711 Test Loss: 0.632 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710520).  Saving model ...
Epoch: 9 cost time: 1.3189172744750977
Epoch: 9, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
Validation loss decreased (-0.710520 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.3431239128112793
Epoch: 10, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.5092418193817139
Epoch: 11, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.4946441650390625
Epoch: 12, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.4255139827728271
Epoch: 13, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.4085044860839844
Epoch: 14, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3942739963531494
Epoch: 15, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.303772211074829
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 17 cost time: 1.220945119857788
Epoch: 17, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 18 cost time: 1.3337976932525635
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2377469539642334
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 20 cost time: 1.235398769378662
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.491 Vali Acc: 0.836 Test Loss: 0.491 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 21 cost time: 1.271575689315796
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3171765804290771
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3460028171539307
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2193291187286377
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3233530521392822
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2445123195648193
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3764359951019287
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.409341812133789
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.405935287475586
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3148143291473389
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.531 Vali Acc: 0.829 Test Loss: 0.531 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 219988
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6552982330322266
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.338 Vali Acc: 0.336 Test Loss: 1.338 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.300201416015625
Epoch: 2, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.234 Vali Acc: 0.428 Test Loss: 1.234 Test Acc: 0.428
Validation loss decreased (-0.335513 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.4254777431488037
Epoch: 3, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.110 Vali Acc: 0.586 Test Loss: 1.110 Test Acc: 0.586
Validation loss decreased (-0.427619 --> -0.585515).  Saving model ...
Epoch: 4 cost time: 1.4761106967926025
Epoch: 4, Steps: 10 | Train Loss: 0.971 Vali Loss: 0.980 Vali Acc: 0.605 Test Loss: 0.980 Test Acc: 0.605
Validation loss decreased (-0.585515 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 1.2352838516235352
Epoch: 5, Steps: 10 | Train Loss: 0.821 Vali Loss: 0.867 Vali Acc: 0.645 Test Loss: 0.867 Test Acc: 0.645
Validation loss decreased (-0.605253 --> -0.644728).  Saving model ...
Epoch: 6 cost time: 1.426985740661621
Epoch: 6, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.775 Vali Acc: 0.671 Test Loss: 0.775 Test Acc: 0.671
Validation loss decreased (-0.644728 --> -0.671045).  Saving model ...
Epoch: 7 cost time: 1.2517516613006592
Epoch: 7, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
Validation loss decreased (-0.671045 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.2816271781921387
Epoch: 8, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.636 Vali Acc: 0.730 Test Loss: 0.636 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 9 cost time: 1.1949315071105957
Epoch: 9, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.2825984954833984
Epoch: 10, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.1507806777954102
Epoch: 11, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.2076849937438965
Epoch: 12, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 1.2581069469451904
Epoch: 13, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815785).  Saving model ...
Epoch: 14 cost time: 1.0775048732757568
Epoch: 14, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.473 Vali Acc: 0.796 Test Loss: 0.473 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2235002517700195
Epoch: 15, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.464 Vali Acc: 0.796 Test Loss: 0.464 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2062249183654785
Epoch: 16, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.404210090637207
Epoch: 17, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.455 Vali Acc: 0.816 Test Loss: 0.455 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 18 cost time: 1.405951738357544
Epoch: 18, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.460 Vali Acc: 0.836 Test Loss: 0.460 Test Acc: 0.836
Validation loss decreased (-0.815785 --> -0.835522).  Saving model ...
Epoch: 19 cost time: 1.4682369232177734
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3644554615020752
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.468 Vali Acc: 0.809 Test Loss: 0.468 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4412181377410889
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.463 Vali Acc: 0.822 Test Loss: 0.463 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.225825309753418
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.468 Vali Acc: 0.829 Test Loss: 0.468 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3678653240203857
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2365021705627441
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.473 Vali Acc: 0.829 Test Loss: 0.473 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3964409828186035
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.480 Vali Acc: 0.836 Test Loss: 0.480 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3742241859436035
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3210372924804688
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.479 Vali Acc: 0.836 Test Loss: 0.479 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2548863887786865
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 219988
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.646898031234741
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.372 Vali Acc: 0.257 Test Loss: 1.372 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.3042457103729248
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.281 Vali Acc: 0.395 Test Loss: 1.281 Test Acc: 0.395
Validation loss decreased (-0.256565 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.3223564624786377
Epoch: 3, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.175 Vali Acc: 0.566 Test Loss: 1.175 Test Acc: 0.566
Validation loss decreased (-0.394724 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.2374093532562256
Epoch: 4, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.059 Vali Acc: 0.632 Test Loss: 1.059 Test Acc: 0.632
Validation loss decreased (-0.565778 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 1.1655235290527344
Epoch: 5, Steps: 10 | Train Loss: 0.904 Vali Loss: 0.954 Vali Acc: 0.678 Test Loss: 0.954 Test Acc: 0.678
Validation loss decreased (-0.631568 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 1.261889934539795
Epoch: 6, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.856 Vali Acc: 0.691 Test Loss: 0.856 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 1.277285099029541
Epoch: 7, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.772 Vali Acc: 0.704 Test Loss: 0.772 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703940).  Saving model ...
Epoch: 8 cost time: 1.2646715641021729
Epoch: 8, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.708 Vali Acc: 0.743 Test Loss: 0.708 Test Acc: 0.743
Validation loss decreased (-0.703940 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.2212154865264893
Epoch: 9, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.646 Vali Acc: 0.770 Test Loss: 0.646 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769730).  Saving model ...
Epoch: 10 cost time: 1.231687307357788
Epoch: 10, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.1465022563934326
Epoch: 11, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.2079401016235352
Epoch: 12, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.183516263961792
Epoch: 13, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 14 cost time: 1.1723225116729736
Epoch: 14, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 15 cost time: 1.3645305633544922
Epoch: 15, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 16 cost time: 1.1148757934570312
Epoch: 16, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 17 cost time: 1.2183277606964111
Epoch: 17, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1088929176330566
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 19 cost time: 1.1245307922363281
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1703565120697021
Epoch: 20, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 21 cost time: 1.1853773593902588
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1912360191345215
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.480 Vali Acc: 0.816 Test Loss: 0.480 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1748979091644287
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.488 Vali Acc: 0.829 Test Loss: 0.488 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 24 cost time: 1.2224128246307373
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.280184030532837
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.498 Vali Acc: 0.829 Test Loss: 0.498 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.150183916091919
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2208309173583984
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.506 Vali Acc: 0.829 Test Loss: 0.506 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2537012100219727
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.509 Vali Acc: 0.829 Test Loss: 0.509 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2511341571807861
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3038227558135986
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.421051025390625
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4345333576202393
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4000873565673828
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 219988
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.126266241073608
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.441 Vali Acc: 0.309 Test Loss: 1.441 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 1.4648258686065674
Epoch: 2, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.320 Vali Acc: 0.461 Test Loss: 1.320 Test Acc: 0.461
Validation loss decreased (-0.309196 --> -0.460513).  Saving model ...
Epoch: 3 cost time: 1.3848164081573486
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.181 Vali Acc: 0.539 Test Loss: 1.181 Test Acc: 0.539
Validation loss decreased (-0.460513 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.4653229713439941
Epoch: 4, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.028 Vali Acc: 0.618 Test Loss: 1.028 Test Acc: 0.618
Validation loss decreased (-0.539462 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 1.3602898120880127
Epoch: 5, Steps: 10 | Train Loss: 0.794 Vali Loss: 0.904 Vali Acc: 0.658 Test Loss: 0.904 Test Acc: 0.658
Validation loss decreased (-0.618411 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.344106674194336
Epoch: 6, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.795 Vali Acc: 0.697 Test Loss: 0.795 Test Acc: 0.697
Validation loss decreased (-0.657886 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 1.4721362590789795
Epoch: 7, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.716 Vali Acc: 0.730 Test Loss: 0.716 Test Acc: 0.730
Validation loss decreased (-0.697360 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.4297945499420166
Epoch: 8, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.3644459247589111
Epoch: 9, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.612 Vali Acc: 0.770 Test Loss: 0.612 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.3759522438049316
Epoch: 10, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2877557277679443
Epoch: 11, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.4784562587738037
Epoch: 12, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.345869779586792
Epoch: 13, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.3647570610046387
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.4938831329345703
Epoch: 15, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.4151902198791504
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.3700923919677734
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3028299808502197
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.382711410522461
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2542731761932373
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.359023094177246
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 22 cost time: 1.2769291400909424
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3673052787780762
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.165998935699463
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 25 cost time: 1.4739792346954346
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4591405391693115
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4935407638549805
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1461083889007568
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3132662773132324
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.331756353378296
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1409506797790527
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2711517810821533
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2798385620117188
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3232841491699219
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 154452
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6540677547454834
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.438 Vali Acc: 0.289 Test Loss: 1.438 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.4118537902832031
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.321 Vali Acc: 0.395 Test Loss: 1.321 Test Acc: 0.395
Validation loss decreased (-0.289459 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.3018743991851807
Epoch: 3, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.186 Vali Acc: 0.526 Test Loss: 1.186 Test Acc: 0.526
Validation loss decreased (-0.394724 --> -0.526304).  Saving model ...
Epoch: 4 cost time: 1.2433180809020996
Epoch: 4, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.036 Vali Acc: 0.664 Test Loss: 1.036 Test Acc: 0.664
Validation loss decreased (-0.526304 --> -0.664463).  Saving model ...
Epoch: 5 cost time: 1.3482697010040283
Epoch: 5, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.916 Vali Acc: 0.684 Test Loss: 0.916 Test Acc: 0.684
Validation loss decreased (-0.664463 --> -0.684201).  Saving model ...
Epoch: 6 cost time: 1.2538225650787354
Epoch: 6, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.808 Vali Acc: 0.704 Test Loss: 0.808 Test Acc: 0.704
Validation loss decreased (-0.684201 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.4130852222442627
Epoch: 7, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.725 Vali Acc: 0.730 Test Loss: 0.725 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.232039451599121
Epoch: 8, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.665 Vali Acc: 0.730 Test Loss: 0.665 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 9 cost time: 1.3990960121154785
Epoch: 9, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.619 Vali Acc: 0.750 Test Loss: 0.619 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.5128600597381592
Epoch: 10, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.436629056930542
Epoch: 11, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.2278735637664795
Epoch: 12, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.1624300479888916
Epoch: 13, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.423140048980713
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.3983521461486816
Epoch: 15, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.4060993194580078
Epoch: 16, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 1.4825453758239746
Epoch: 17, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5124826431274414
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.452646017074585
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3540821075439453
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4588594436645508
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3560912609100342
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2235925197601318
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4495928287506104
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2427706718444824
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.366760492324829
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 154452
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6330690383911133
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.437 Vali Acc: 0.270 Test Loss: 1.437 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.3177409172058105
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.328 Vali Acc: 0.414 Test Loss: 1.328 Test Acc: 0.414
Validation loss decreased (-0.269722 --> -0.414460).  Saving model ...
Epoch: 3 cost time: 1.3369081020355225
Epoch: 3, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.201 Vali Acc: 0.553 Test Loss: 1.201 Test Acc: 0.553
Validation loss decreased (-0.414460 --> -0.552620).  Saving model ...
Epoch: 4 cost time: 1.2532188892364502
Epoch: 4, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.061 Vali Acc: 0.645 Test Loss: 1.061 Test Acc: 0.645
Validation loss decreased (-0.552620 --> -0.644726).  Saving model ...
Epoch: 5 cost time: 1.4916760921478271
Epoch: 5, Steps: 10 | Train Loss: 0.860 Vali Loss: 0.939 Vali Acc: 0.664 Test Loss: 0.939 Test Acc: 0.664
Validation loss decreased (-0.644726 --> -0.664464).  Saving model ...
Epoch: 6 cost time: 1.1911120414733887
Epoch: 6, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.827 Vali Acc: 0.697 Test Loss: 0.827 Test Acc: 0.697
Validation loss decreased (-0.664464 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 1.178147554397583
Epoch: 7, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.734 Vali Acc: 0.717 Test Loss: 0.734 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.1479077339172363
Epoch: 8, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 1.1635770797729492
Epoch: 9, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.3462867736816406
Epoch: 10, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.1957557201385498
Epoch: 11, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.1746857166290283
Epoch: 12, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.2124731540679932
Epoch: 13, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 14 cost time: 1.2109363079071045
Epoch: 14, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 15 cost time: 1.3847973346710205
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 16 cost time: 1.170417070388794
Epoch: 16, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.470 Vali Acc: 0.822 Test Loss: 0.470 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 17 cost time: 1.1625521183013916
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.480 Vali Acc: 0.789 Test Loss: 0.480 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1688907146453857
Epoch: 18, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.467 Vali Acc: 0.816 Test Loss: 0.467 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0914356708526611
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.475 Vali Acc: 0.816 Test Loss: 0.475 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2658984661102295
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3448667526245117
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.287811279296875
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3784294128417969
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.473 Vali Acc: 0.816 Test Loss: 0.473 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2732558250427246
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3884479999542236
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3208062648773193
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 154452
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3135581016540527
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.412 Vali Acc: 0.243 Test Loss: 1.412 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.174487590789795
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.324 Vali Acc: 0.421 Test Loss: 1.324 Test Acc: 0.421
Validation loss decreased (-0.243407 --> -0.421039).  Saving model ...
Epoch: 3 cost time: 1.215738296508789
Epoch: 3, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.220 Vali Acc: 0.533 Test Loss: 1.220 Test Acc: 0.533
Validation loss decreased (-0.421039 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 1.1215105056762695
Epoch: 4, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.100 Vali Acc: 0.592 Test Loss: 1.100 Test Acc: 0.592
Validation loss decreased (-0.532883 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 1.2148122787475586
Epoch: 5, Steps: 10 | Train Loss: 0.959 Vali Loss: 0.990 Vali Acc: 0.638 Test Loss: 0.990 Test Acc: 0.638
Validation loss decreased (-0.592094 --> -0.638148).  Saving model ...
Epoch: 6 cost time: 1.2771449089050293
Epoch: 6, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.884 Vali Acc: 0.678 Test Loss: 0.884 Test Acc: 0.678
Validation loss decreased (-0.638148 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 1.076545000076294
Epoch: 7, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.793 Vali Acc: 0.697 Test Loss: 0.793 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 0.9606120586395264
Epoch: 8, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.713 Vali Acc: 0.724 Test Loss: 0.713 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 1.1852161884307861
Epoch: 9, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.642 Vali Acc: 0.757 Test Loss: 0.642 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.2007923126220703
Epoch: 10, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.2223410606384277
Epoch: 11, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.2679643630981445
Epoch: 12, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 13 cost time: 1.3624296188354492
Epoch: 13, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 14 cost time: 1.5509860515594482
Epoch: 14, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 15 cost time: 1.5225260257720947
Epoch: 15, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.476 Vali Acc: 0.803 Test Loss: 0.476 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 1.4584910869598389
Epoch: 16, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 17 cost time: 1.4062254428863525
Epoch: 17, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.482 Vali Acc: 0.796 Test Loss: 0.482 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4110159873962402
Epoch: 18, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.467 Vali Acc: 0.803 Test Loss: 0.467 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1805267333984375
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.463 Vali Acc: 0.803 Test Loss: 0.463 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 1.303328037261963
Epoch: 20, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.473 Vali Acc: 0.803 Test Loss: 0.473 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1012616157531738
Epoch: 21, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.467 Vali Acc: 0.783 Test Loss: 0.467 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.126539707183838
Epoch: 22, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.468 Vali Acc: 0.796 Test Loss: 0.468 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2803597450256348
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.472 Vali Acc: 0.803 Test Loss: 0.472 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0956013202667236
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
Validation loss decreased (-0.802627 --> -0.822364).  Saving model ...
Epoch: 25 cost time: 1.4355111122131348
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.479 Vali Acc: 0.796 Test Loss: 0.479 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2995078563690186
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0317459106445312
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.529043436050415
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5455310344696045
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3753936290740967
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4728384017944336
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.348926305770874
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2422027587890625
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2612056732177734
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 154452
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5280823707580566
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.468 Vali Acc: 0.283 Test Loss: 1.468 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.3080418109893799
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.326 Vali Acc: 0.336 Test Loss: 1.326 Test Acc: 0.336
Validation loss decreased (-0.282880 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.4876387119293213
Epoch: 3, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.164 Vali Acc: 0.441 Test Loss: 1.164 Test Acc: 0.441
Validation loss decreased (-0.335513 --> -0.440778).  Saving model ...
Epoch: 4 cost time: 1.0224401950836182
Epoch: 4, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.020 Vali Acc: 0.559 Test Loss: 1.020 Test Acc: 0.559
Validation loss decreased (-0.440778 --> -0.559200).  Saving model ...
Epoch: 5 cost time: 1.371704339981079
Epoch: 5, Steps: 10 | Train Loss: 0.798 Vali Loss: 0.897 Vali Acc: 0.638 Test Loss: 0.897 Test Acc: 0.638
Validation loss decreased (-0.559200 --> -0.638149).  Saving model ...
Epoch: 6 cost time: 1.3738617897033691
Epoch: 6, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.795 Vali Acc: 0.691 Test Loss: 0.795 Test Acc: 0.691
Validation loss decreased (-0.638149 --> -0.690782).  Saving model ...
Epoch: 7 cost time: 1.2760071754455566
Epoch: 7, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.712 Vali Acc: 0.737 Test Loss: 0.712 Test Acc: 0.737
Validation loss decreased (-0.690782 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.1203482151031494
Epoch: 8, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.649 Vali Acc: 0.737 Test Loss: 0.649 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.639589548110962
Epoch: 9, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.3590302467346191
Epoch: 10, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.3853504657745361
Epoch: 11, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.542320966720581
Epoch: 12, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.520 Vali Acc: 0.829 Test Loss: 0.520 Test Acc: 0.829
Validation loss decreased (-0.782889 --> -0.828942).  Saving model ...
Epoch: 13 cost time: 1.222808837890625
Epoch: 13, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4236128330230713
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.513660192489624
Epoch: 15, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.282256841659546
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3337173461914062
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2262053489685059
Epoch: 18, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3237605094909668
Epoch: 19, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3156936168670654
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.503 Vali Acc: 0.829 Test Loss: 0.503 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 21 cost time: 1.4301283359527588
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2515559196472168
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.172628402709961
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3474128246307373
Epoch: 24, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2095963954925537
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2771010398864746
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.233400821685791
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.520 Vali Acc: 0.829 Test Loss: 0.520 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2730629444122314
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.523 Vali Acc: 0.829 Test Loss: 0.523 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3163323402404785
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3382298946380615
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.531 Vali Acc: 0.829 Test Loss: 0.531 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 121684
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.757845401763916
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.460 Vali Acc: 0.296 Test Loss: 1.460 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 1.480607509613037
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.327 Vali Acc: 0.349 Test Loss: 1.327 Test Acc: 0.349
Validation loss decreased (-0.296038 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 1.145158290863037
Epoch: 3, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.175 Vali Acc: 0.493 Test Loss: 1.175 Test Acc: 0.493
Validation loss decreased (-0.348671 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.246203899383545
Epoch: 4, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.029 Vali Acc: 0.572 Test Loss: 1.029 Test Acc: 0.572
Validation loss decreased (-0.493409 --> -0.572358).  Saving model ...
Epoch: 5 cost time: 1.390580415725708
Epoch: 5, Steps: 10 | Train Loss: 0.839 Vali Loss: 0.905 Vali Acc: 0.638 Test Loss: 0.905 Test Acc: 0.638
Validation loss decreased (-0.572358 --> -0.638149).  Saving model ...
Epoch: 6 cost time: 1.547569990158081
Epoch: 6, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.802 Vali Acc: 0.711 Test Loss: 0.802 Test Acc: 0.711
Validation loss decreased (-0.638149 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.354349136352539
Epoch: 7, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.711 Vali Acc: 0.724 Test Loss: 0.711 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.3972301483154297
Epoch: 8, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
Validation loss decreased (-0.723677 --> -0.763151).  Saving model ...
Epoch: 9 cost time: 1.4002950191497803
Epoch: 9, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.213057518005371
Epoch: 10, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.5472602844238281
Epoch: 11, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
Validation loss decreased (-0.769731 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.4112834930419922
Epoch: 12, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1905133724212646
Epoch: 13, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1281013488769531
Epoch: 14, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3451240062713623
Epoch: 15, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 16 cost time: 1.2597525119781494
Epoch: 16, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.472 Vali Acc: 0.803 Test Loss: 0.472 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2446587085723877
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 18 cost time: 1.6039819717407227
Epoch: 18, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.471 Vali Acc: 0.829 Test Loss: 0.471 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 19 cost time: 1.2481927871704102
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4233689308166504
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.718959093093872
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3145575523376465
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.480 Vali Acc: 0.822 Test Loss: 0.480 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3352115154266357
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5327949523925781
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5547211170196533
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3782968521118164
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.490 Vali Acc: 0.829 Test Loss: 0.490 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4476771354675293
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2788362503051758
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 121684
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.825321674346924
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.424 Vali Acc: 0.263 Test Loss: 1.424 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.5056664943695068
Epoch: 2, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.302 Vali Acc: 0.362 Test Loss: 1.302 Test Acc: 0.362
Validation loss decreased (-0.263144 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.4773521423339844
Epoch: 3, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.166 Vali Acc: 0.520 Test Loss: 1.166 Test Acc: 0.520
Validation loss decreased (-0.361829 --> -0.519725).  Saving model ...
Epoch: 4 cost time: 1.2754974365234375
Epoch: 4, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.036 Vali Acc: 0.592 Test Loss: 1.036 Test Acc: 0.592
Validation loss decreased (-0.519725 --> -0.592095).  Saving model ...
Epoch: 5 cost time: 1.2901127338409424
Epoch: 5, Steps: 10 | Train Loss: 0.870 Vali Loss: 0.916 Vali Acc: 0.658 Test Loss: 0.916 Test Acc: 0.658
Validation loss decreased (-0.592095 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.317723274230957
Epoch: 6, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.815 Vali Acc: 0.678 Test Loss: 0.815 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 1.3115711212158203
Epoch: 7, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.724 Vali Acc: 0.770 Test Loss: 0.724 Test Acc: 0.770
Validation loss decreased (-0.677623 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 1.3540897369384766
Epoch: 8, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.650 Vali Acc: 0.770 Test Loss: 0.650 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 9 cost time: 1.0689799785614014
Epoch: 9, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.593 Vali Acc: 0.776 Test Loss: 0.593 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.0835943222045898
Epoch: 10, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.2540936470031738
Epoch: 11, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.1876087188720703
Epoch: 12, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.1574411392211914
Epoch: 13, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 14 cost time: 1.1419086456298828
Epoch: 14, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 15 cost time: 1.4808986186981201
Epoch: 15, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 16 cost time: 1.366483449935913
Epoch: 16, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.450 Vali Acc: 0.816 Test Loss: 0.450 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.435474157333374
Epoch: 17, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.445 Vali Acc: 0.822 Test Loss: 0.445 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6012096405029297
Epoch: 18, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.450 Vali Acc: 0.849 Test Loss: 0.450 Test Acc: 0.849
Validation loss decreased (-0.828943 --> -0.848680).  Saving model ...
Epoch: 19 cost time: 1.3182182312011719
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.317223310470581
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.448 Vali Acc: 0.829 Test Loss: 0.448 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3947241306304932
Epoch: 21, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.449 Vali Acc: 0.836 Test Loss: 0.449 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.318530559539795
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.446 Vali Acc: 0.803 Test Loss: 0.446 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3728694915771484
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.448 Vali Acc: 0.803 Test Loss: 0.448 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2991294860839844
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.452 Vali Acc: 0.842 Test Loss: 0.452 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5365972518920898
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.453 Vali Acc: 0.803 Test Loss: 0.453 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4848747253417969
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.458 Vali Acc: 0.822 Test Loss: 0.458 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.467390537261963
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.460 Vali Acc: 0.836 Test Loss: 0.460 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2927742004394531
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.456 Vali Acc: 0.836 Test Loss: 0.456 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 121684
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2621047496795654
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.410 Vali Acc: 0.289 Test Loss: 1.410 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.1783201694488525
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.310 Vali Acc: 0.408 Test Loss: 1.310 Test Acc: 0.408
Validation loss decreased (-0.289460 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.1829872131347656
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.201 Vali Acc: 0.526 Test Loss: 1.201 Test Acc: 0.526
Validation loss decreased (-0.407882 --> -0.526304).  Saving model ...
Epoch: 4 cost time: 1.2487423419952393
Epoch: 4, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.087 Vali Acc: 0.612 Test Loss: 1.087 Test Acc: 0.612
Validation loss decreased (-0.526304 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 1.177474021911621
Epoch: 5, Steps: 10 | Train Loss: 0.933 Vali Loss: 0.975 Vali Acc: 0.678 Test Loss: 0.975 Test Acc: 0.678
Validation loss decreased (-0.611831 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 1.4178109169006348
Epoch: 6, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.878 Vali Acc: 0.691 Test Loss: 0.878 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 1.335404634475708
Epoch: 7, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.690781 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.4075732231140137
Epoch: 8, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.702 Vali Acc: 0.776 Test Loss: 0.702 Test Acc: 0.776
Validation loss decreased (-0.749992 --> -0.776309).  Saving model ...
Epoch: 9 cost time: 1.3440351486206055
Epoch: 9, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
Validation loss decreased (-0.776309 --> -0.802625).  Saving model ...
Epoch: 10 cost time: 1.3047564029693604
Epoch: 10, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
Validation loss decreased (-0.802625 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 1.4448926448822021
Epoch: 11, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2861251831054688
Epoch: 12, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4482405185699463
Epoch: 13, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 14 cost time: 1.3238732814788818
Epoch: 14, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2684895992279053
Epoch: 15, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 16 cost time: 1.2916862964630127
Epoch: 16, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5383884906768799
Epoch: 17, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.457 Vali Acc: 0.809 Test Loss: 0.457 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.247201919555664
Epoch: 18, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.462 Vali Acc: 0.822 Test Loss: 0.462 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1609303951263428
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.459 Vali Acc: 0.796 Test Loss: 0.459 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.324125051498413
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4580085277557373
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.466 Vali Acc: 0.829 Test Loss: 0.466 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 22 cost time: 1.3381762504577637
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2891969680786133
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2467048168182373
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3544175624847412
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0941455364227295
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3255376815795898
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2317442893981934
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.30454421043396
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.498 Vali Acc: 0.829 Test Loss: 0.498 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4765846729278564
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.502 Vali Acc: 0.829 Test Loss: 0.502 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2969939708709717
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 121684
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.783479928970337
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.404 Vali Acc: 0.257 Test Loss: 1.404 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.262406349182129
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.337 Vali Acc: 0.329 Test Loss: 1.337 Test Acc: 0.329
Validation loss decreased (-0.256565 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.5716044902801514
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.250 Vali Acc: 0.414 Test Loss: 1.250 Test Acc: 0.414
Validation loss decreased (-0.328934 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.424300193786621
Epoch: 4, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
Validation loss decreased (-0.414461 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2888431549072266
Epoch: 5, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.060 Vali Acc: 0.625 Test Loss: 1.060 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.2509894371032715
Epoch: 6, Steps: 10 | Train Loss: 0.883 Vali Loss: 0.973 Vali Acc: 0.671 Test Loss: 0.973 Test Acc: 0.671
Validation loss decreased (-0.624989 --> -0.671043).  Saving model ...
Epoch: 7 cost time: 1.542595386505127
Epoch: 7, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.895 Vali Acc: 0.704 Test Loss: 0.895 Test Acc: 0.704
Validation loss decreased (-0.671043 --> -0.703938).  Saving model ...
Epoch: 8 cost time: 1.2875702381134033
Epoch: 8, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.822 Vali Acc: 0.704 Test Loss: 0.822 Test Acc: 0.704
Validation loss decreased (-0.703938 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 1.4362423419952393
Epoch: 9, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.764 Vali Acc: 0.724 Test Loss: 0.764 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 1.2218248844146729
Epoch: 10, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.715 Vali Acc: 0.730 Test Loss: 0.715 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.3047893047332764
Epoch: 11, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.672 Vali Acc: 0.757 Test Loss: 0.672 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 1.4666070938110352
Epoch: 12, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.3265633583068848
Epoch: 13, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.2793190479278564
Epoch: 14, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.2549095153808594
Epoch: 15, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.2484049797058105
Epoch: 16, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.3230063915252686
Epoch: 17, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1048154830932617
Epoch: 18, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.5205435752868652
Epoch: 19, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.2577037811279297
Epoch: 20, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.1511766910552979
Epoch: 21, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4422352313995361
Epoch: 22, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.362617015838623
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4081785678863525
Epoch: 24, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.329479694366455
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.159480333328247
Epoch: 26, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3095102310180664
Epoch: 27, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.438978672027588
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4281518459320068
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5755999088287354
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 552404
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9076879024505615
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.384 Vali Acc: 0.309 Test Loss: 1.384 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.3447778224945068
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.315 Vali Acc: 0.362 Test Loss: 1.315 Test Acc: 0.362
Validation loss decreased (-0.309197 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.112238883972168
Epoch: 3, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.235 Vali Acc: 0.493 Test Loss: 1.235 Test Acc: 0.493
Validation loss decreased (-0.361829 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.1800956726074219
Epoch: 4, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.139 Vali Acc: 0.572 Test Loss: 1.139 Test Acc: 0.572
Validation loss decreased (-0.493409 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 1.2144749164581299
Epoch: 5, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.051 Vali Acc: 0.625 Test Loss: 1.051 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.1501796245574951
Epoch: 6, Steps: 10 | Train Loss: 0.896 Vali Loss: 0.957 Vali Acc: 0.664 Test Loss: 0.957 Test Acc: 0.664
Validation loss decreased (-0.624989 --> -0.664464).  Saving model ...
Epoch: 7 cost time: 1.2726833820343018
Epoch: 7, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.875 Vali Acc: 0.724 Test Loss: 0.875 Test Acc: 0.724
Validation loss decreased (-0.664464 --> -0.723675).  Saving model ...
Epoch: 8 cost time: 1.1709487438201904
Epoch: 8, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.799 Vali Acc: 0.757 Test Loss: 0.799 Test Acc: 0.757
Validation loss decreased (-0.723675 --> -0.756571).  Saving model ...
Epoch: 9 cost time: 1.4581248760223389
Epoch: 9, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.741 Vali Acc: 0.757 Test Loss: 0.741 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756572).  Saving model ...
Epoch: 10 cost time: 1.3823797702789307
Epoch: 10, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3036739826202393
Epoch: 11, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.648 Vali Acc: 0.757 Test Loss: 0.648 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 1.6125011444091797
Epoch: 12, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.3472585678100586
Epoch: 13, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.4816021919250488
Epoch: 14, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3556382656097412
Epoch: 15, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 1.5530333518981934
Epoch: 16, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.4675884246826172
Epoch: 17, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4235503673553467
Epoch: 18, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3697412014007568
Epoch: 19, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4946582317352295
Epoch: 20, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 21 cost time: 1.5614042282104492
Epoch: 21, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2912545204162598
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 23 cost time: 1.266397476196289
Epoch: 23, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3303627967834473
Epoch: 24, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 25 cost time: 1.2565879821777344
Epoch: 25, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 26 cost time: 1.4042115211486816
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1277282238006592
Epoch: 27, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 28 cost time: 1.2602293491363525
Epoch: 28, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4449222087860107
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 30 cost time: 1.379394769668579
Epoch: 30, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 31 cost time: 1.2227070331573486
Epoch: 31, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 32 cost time: 1.535548448562622
Epoch: 32, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4189202785491943
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.421280860900879
Epoch: 34, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4813222885131836
Epoch: 35, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6987254619598389
Epoch: 36, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.617234468460083
Epoch: 37, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.473205804824829
Epoch: 38, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2835803031921387
Epoch: 39, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.4828922748565674
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6045901775360107
Epoch: 41, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 552404
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4826483726501465
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.370 Vali Acc: 0.283 Test Loss: 1.370 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.2834985256195068
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.307 Vali Acc: 0.349 Test Loss: 1.307 Test Acc: 0.349
Validation loss decreased (-0.282881 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 1.2823657989501953
Epoch: 3, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.230 Vali Acc: 0.507 Test Loss: 1.230 Test Acc: 0.507
Validation loss decreased (-0.348671 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.2007787227630615
Epoch: 4, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.130 Vali Acc: 0.605 Test Loss: 1.130 Test Acc: 0.605
Validation loss decreased (-0.506567 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 1.203984022140503
Epoch: 5, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.039 Vali Acc: 0.684 Test Loss: 1.039 Test Acc: 0.684
Validation loss decreased (-0.605252 --> -0.684200).  Saving model ...
Epoch: 6 cost time: 1.290733814239502
Epoch: 6, Steps: 10 | Train Loss: 0.916 Vali Loss: 0.956 Vali Acc: 0.697 Test Loss: 0.956 Test Acc: 0.697
Validation loss decreased (-0.684200 --> -0.697359).  Saving model ...
Epoch: 7 cost time: 1.2806305885314941
Epoch: 7, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.875 Vali Acc: 0.730 Test Loss: 0.875 Test Acc: 0.730
Validation loss decreased (-0.697359 --> -0.730254).  Saving model ...
Epoch: 8 cost time: 1.153221845626831
Epoch: 8, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.800 Vali Acc: 0.737 Test Loss: 0.800 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736834).  Saving model ...
Epoch: 9 cost time: 1.2002296447753906
Epoch: 9, Steps: 10 | Train Loss: 0.608 Vali Loss: 0.737 Vali Acc: 0.750 Test Loss: 0.737 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 1.1481618881225586
Epoch: 10, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.688 Vali Acc: 0.763 Test Loss: 0.688 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 11 cost time: 1.1368505954742432
Epoch: 11, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 0.9546747207641602
Epoch: 12, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 1.154940128326416
Epoch: 13, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1514079570770264
Epoch: 14, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1640403270721436
Epoch: 15, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.2264537811279297
Epoch: 16, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4261457920074463
Epoch: 17, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 18 cost time: 1.3246009349822998
Epoch: 18, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 19 cost time: 1.221670150756836
Epoch: 19, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.465 Vali Acc: 0.816 Test Loss: 0.465 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 20 cost time: 1.2029807567596436
Epoch: 20, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3937959671020508
Epoch: 21, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4654150009155273
Epoch: 22, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.460 Vali Acc: 0.803 Test Loss: 0.460 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3340609073638916
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.319849967956543
Epoch: 24, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.453 Vali Acc: 0.816 Test Loss: 0.453 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 25 cost time: 1.4033849239349365
Epoch: 25, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.442 Vali Acc: 0.809 Test Loss: 0.442 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3132710456848145
Epoch: 26, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.442 Vali Acc: 0.836 Test Loss: 0.442 Test Acc: 0.836
Validation loss decreased (-0.815785 --> -0.835522).  Saving model ...
Epoch: 27 cost time: 1.2478899955749512
Epoch: 27, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.432 Vali Acc: 0.816 Test Loss: 0.432 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2384579181671143
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.443 Vali Acc: 0.822 Test Loss: 0.443 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3587512969970703
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.440 Vali Acc: 0.809 Test Loss: 0.440 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.293410062789917
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.434 Vali Acc: 0.809 Test Loss: 0.434 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2822303771972656
Epoch: 31, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.440 Vali Acc: 0.822 Test Loss: 0.440 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.346144437789917
Epoch: 32, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.445 Vali Acc: 0.836 Test Loss: 0.445 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2695939540863037
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.435 Vali Acc: 0.822 Test Loss: 0.435 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6034808158874512
Epoch: 34, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.436 Vali Acc: 0.816 Test Loss: 0.436 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.381211280822754
Epoch: 35, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.444 Vali Acc: 0.816 Test Loss: 0.444 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4881970882415771
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.444 Vali Acc: 0.829 Test Loss: 0.444 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 552404
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.077185153961182
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.353 Vali Acc: 0.336 Test Loss: 1.353 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.3235206604003906
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.296 Vali Acc: 0.447 Test Loss: 1.296 Test Acc: 0.447
Validation loss decreased (-0.335513 --> -0.447355).  Saving model ...
Epoch: 3 cost time: 1.3105759620666504
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.229 Vali Acc: 0.513 Test Loss: 1.229 Test Acc: 0.513
Validation loss decreased (-0.447355 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 1.2981185913085938
Epoch: 4, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.146 Vali Acc: 0.612 Test Loss: 1.146 Test Acc: 0.612
Validation loss decreased (-0.513146 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 1.4238255023956299
Epoch: 5, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.067 Vali Acc: 0.664 Test Loss: 1.067 Test Acc: 0.664
Validation loss decreased (-0.611831 --> -0.664463).  Saving model ...
Epoch: 6 cost time: 1.215318202972412
Epoch: 6, Steps: 10 | Train Loss: 0.964 Vali Loss: 0.988 Vali Acc: 0.704 Test Loss: 0.988 Test Acc: 0.704
Validation loss decreased (-0.664463 --> -0.703937).  Saving model ...
Epoch: 7 cost time: 1.2354588508605957
Epoch: 7, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.913 Vali Acc: 0.730 Test Loss: 0.913 Test Acc: 0.730
Validation loss decreased (-0.703937 --> -0.730254).  Saving model ...
Epoch: 8 cost time: 1.2688302993774414
Epoch: 8, Steps: 10 | Train Loss: 0.784 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
Validation loss decreased (-0.730254 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 1.1382544040679932
Epoch: 9, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.771 Vali Acc: 0.757 Test Loss: 0.771 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756571).  Saving model ...
Epoch: 10 cost time: 1.3289036750793457
Epoch: 10, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.712 Vali Acc: 0.770 Test Loss: 0.712 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769730).  Saving model ...
Epoch: 11 cost time: 1.2611899375915527
Epoch: 11, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.660 Vali Acc: 0.776 Test Loss: 0.660 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 12 cost time: 1.413761854171753
Epoch: 12, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 13 cost time: 1.2784500122070312
Epoch: 13, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.6322588920593262
Epoch: 14, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 15 cost time: 1.1736764907836914
Epoch: 15, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 16 cost time: 1.3575549125671387
Epoch: 16, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3480010032653809
Epoch: 17, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.327080249786377
Epoch: 18, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 19 cost time: 1.4436180591583252
Epoch: 19, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2332642078399658
Epoch: 20, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.347827672958374
Epoch: 21, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 22 cost time: 1.369673490524292
Epoch: 22, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.603400468826294
Epoch: 23, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.459 Vali Acc: 0.809 Test Loss: 0.459 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.329941987991333
Epoch: 24, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.452 Vali Acc: 0.816 Test Loss: 0.452 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4026567935943604
Epoch: 25, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.444 Vali Acc: 0.829 Test Loss: 0.444 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 26 cost time: 1.183703899383545
Epoch: 26, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.446 Vali Acc: 0.829 Test Loss: 0.446 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.247497320175171
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.444 Vali Acc: 0.822 Test Loss: 0.444 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4780206680297852
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2164368629455566
Epoch: 29, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.442 Vali Acc: 0.816 Test Loss: 0.442 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2217648029327393
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.441 Vali Acc: 0.816 Test Loss: 0.441 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2226941585540771
Epoch: 31, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.445 Vali Acc: 0.822 Test Loss: 0.445 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2906477451324463
Epoch: 32, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 33 cost time: 1.232426404953003
Epoch: 33, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9927577972412109
Epoch: 34, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.477 Vali Acc: 0.836 Test Loss: 0.477 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2222397327423096
Epoch: 35, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.468 Vali Acc: 0.816 Test Loss: 0.468 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.193850040435791
Epoch: 36, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2308588027954102
Epoch: 37, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1420783996582031
Epoch: 38, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2439968585968018
Epoch: 39, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.4499456882476807
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.3751513957977295
Epoch: 41, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.456261157989502
Epoch: 42, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 552404
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.680250644683838
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.503 Vali Acc: 0.316 Test Loss: 1.503 Test Acc: 0.316
Validation loss decreased (inf --> -0.315774).  Saving model ...
Epoch: 2 cost time: 1.229684591293335
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.421 Vali Acc: 0.342 Test Loss: 1.421 Test Acc: 0.342
Validation loss decreased (-0.315774 --> -0.342091).  Saving model ...
Epoch: 3 cost time: 1.5425689220428467
Epoch: 3, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.328 Vali Acc: 0.414 Test Loss: 1.328 Test Acc: 0.414
Validation loss decreased (-0.342091 --> -0.414460).  Saving model ...
Epoch: 4 cost time: 1.2910547256469727
Epoch: 4, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.414460 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.150864839553833
Epoch: 5, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.120 Vali Acc: 0.579 Test Loss: 1.120 Test Acc: 0.579
Validation loss decreased (-0.499988 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 1.290494441986084
Epoch: 6, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.026 Vali Acc: 0.599 Test Loss: 1.026 Test Acc: 0.599
Validation loss decreased (-0.578936 --> -0.598674).  Saving model ...
Epoch: 7 cost time: 1.2058773040771484
Epoch: 7, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.948 Vali Acc: 0.625 Test Loss: 0.948 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624991).  Saving model ...
Epoch: 8 cost time: 1.2211065292358398
Epoch: 8, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.869 Vali Acc: 0.645 Test Loss: 0.869 Test Acc: 0.645
Validation loss decreased (-0.624991 --> -0.644728).  Saving model ...
Epoch: 9 cost time: 1.178386926651001
Epoch: 9, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.799 Vali Acc: 0.684 Test Loss: 0.799 Test Acc: 0.684
Validation loss decreased (-0.644728 --> -0.684203).  Saving model ...
Epoch: 10 cost time: 1.2944579124450684
Epoch: 10, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.750 Vali Acc: 0.704 Test Loss: 0.750 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 1.3695507049560547
Epoch: 11, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.706 Vali Acc: 0.750 Test Loss: 0.706 Test Acc: 0.750
Validation loss decreased (-0.703940 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.4180688858032227
Epoch: 12, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 1.5900158882141113
Epoch: 13, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.4457206726074219
Epoch: 14, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.618 Vali Acc: 0.750 Test Loss: 0.618 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.3488965034484863
Epoch: 15, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.5815634727478027
Epoch: 16, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.5918231010437012
Epoch: 17, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.3813939094543457
Epoch: 18, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.2840571403503418
Epoch: 19, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.4958391189575195
Epoch: 20, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 1.3668031692504883
Epoch: 21, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.549 Vali Acc: 0.776 Test Loss: 0.549 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4349005222320557
Epoch: 22, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2668259143829346
Epoch: 23, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.383545160293579
Epoch: 24, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 1.3895115852355957
Epoch: 25, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 26 cost time: 1.2335660457611084
Epoch: 26, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2459006309509277
Epoch: 27, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1897516250610352
Epoch: 28, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 1.2765719890594482
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.1743018627166748
Epoch: 30, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.629347801208496
Epoch: 31, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3854053020477295
Epoch: 32, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5777671337127686
Epoch: 33, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4378595352172852
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5342991352081299
Epoch: 35, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.351736307144165
Epoch: 36, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3626668453216553
Epoch: 37, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.493016004562378
Epoch: 38, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.671504259109497
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 40 cost time: 1.368704080581665
Epoch: 40, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4651398658752441
Epoch: 41, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.445420742034912
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.271411657333374
Epoch: 43, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.382591724395752
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.192636489868164
Epoch: 45, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.448559284210205
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2446942329406738
Epoch: 47, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.433591365814209
Epoch: 48, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.4807651042938232
Epoch: 49, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822362).  Saving model ...
Epoch: 50 cost time: 1.3760526180267334
Epoch: 50, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4422509670257568
Epoch: 51, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.425840139389038
Epoch: 52, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.4518969058990479
Epoch: 53, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.477403163909912
Epoch: 54, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.4066760540008545
Epoch: 55, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.5516581535339355
Epoch: 56, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.640129566192627
Epoch: 57, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.4102678298950195
Epoch: 58, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.4269909858703613
Epoch: 59, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 290260
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3931846618652344
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.463 Vali Acc: 0.296 Test Loss: 1.463 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 1.2852509021759033
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.390 Vali Acc: 0.355 Test Loss: 1.390 Test Acc: 0.355
Validation loss decreased (-0.296038 --> -0.355249).  Saving model ...
Epoch: 3 cost time: 1.2331926822662354
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.299 Vali Acc: 0.421 Test Loss: 1.299 Test Acc: 0.421
Validation loss decreased (-0.355249 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 0.9826734066009521
Epoch: 4, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.193 Vali Acc: 0.539 Test Loss: 1.193 Test Acc: 0.539
Validation loss decreased (-0.421040 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.3412604331970215
Epoch: 5, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.088 Vali Acc: 0.579 Test Loss: 1.088 Test Acc: 0.579
Validation loss decreased (-0.539462 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 1.2109158039093018
Epoch: 6, Steps: 10 | Train Loss: 0.938 Vali Loss: 0.996 Vali Acc: 0.632 Test Loss: 0.996 Test Acc: 0.632
Validation loss decreased (-0.578936 --> -0.631569).  Saving model ...
Epoch: 7 cost time: 1.3800671100616455
Epoch: 7, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.916 Vali Acc: 0.651 Test Loss: 0.916 Test Acc: 0.651
Validation loss decreased (-0.631569 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 1.35308837890625
Epoch: 8, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.838 Vali Acc: 0.671 Test Loss: 0.838 Test Acc: 0.671
Validation loss decreased (-0.651307 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.2842602729797363
Epoch: 9, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.770 Vali Acc: 0.724 Test Loss: 0.770 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 1.3582050800323486
Epoch: 10, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.721 Vali Acc: 0.730 Test Loss: 0.721 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.528045654296875
Epoch: 11, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.674 Vali Acc: 0.750 Test Loss: 0.674 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.6023011207580566
Epoch: 12, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.639 Vali Acc: 0.743 Test Loss: 0.639 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4509179592132568
Epoch: 13, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.611 Vali Acc: 0.757 Test Loss: 0.611 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.4466559886932373
Epoch: 14, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.2352426052093506
Epoch: 15, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.3668546676635742
Epoch: 16, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.5012280941009521
Epoch: 17, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.1950318813323975
Epoch: 18, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3580870628356934
Epoch: 19, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.523505449295044
Epoch: 20, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 21 cost time: 1.3588390350341797
Epoch: 21, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 22 cost time: 1.246751070022583
Epoch: 22, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 23 cost time: 1.594245433807373
Epoch: 23, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 24 cost time: 1.3837568759918213
Epoch: 24, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1240689754486084
Epoch: 25, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3215844631195068
Epoch: 26, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 27 cost time: 1.2631096839904785
Epoch: 27, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2470118999481201
Epoch: 28, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.483 Vali Acc: 0.836 Test Loss: 0.483 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 29 cost time: 1.285398244857788
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5386786460876465
Epoch: 30, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.175156593322754
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.489 Vali Acc: 0.829 Test Loss: 0.489 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2300713062286377
Epoch: 32, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.490 Vali Acc: 0.829 Test Loss: 0.490 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1973671913146973
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1769349575042725
Epoch: 34, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3643848896026611
Epoch: 35, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.5584981441497803
Epoch: 36, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.515 Vali Acc: 0.816 Test Loss: 0.515 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5007407665252686
Epoch: 37, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3168184757232666
Epoch: 38, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 290260
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4028055667877197
Epoch: 1, Steps: 10 | Train Loss: 1.519 Vali Loss: 1.465 Vali Acc: 0.316 Test Loss: 1.465 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 1.1463162899017334
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.398 Vali Acc: 0.342 Test Loss: 1.398 Test Acc: 0.342
Validation loss decreased (-0.315775 --> -0.342091).  Saving model ...
Epoch: 3 cost time: 1.3527114391326904
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.311 Vali Acc: 0.414 Test Loss: 1.311 Test Acc: 0.414
Validation loss decreased (-0.342091 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.1760072708129883
Epoch: 4, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.211 Vali Acc: 0.513 Test Loss: 1.211 Test Acc: 0.513
Validation loss decreased (-0.414461 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 1.228395938873291
Epoch: 5, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.115 Vali Acc: 0.586 Test Loss: 1.115 Test Acc: 0.586
Validation loss decreased (-0.513146 --> -0.585515).  Saving model ...
Epoch: 6 cost time: 1.2667360305786133
Epoch: 6, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.027 Vali Acc: 0.645 Test Loss: 1.027 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 1.1277461051940918
Epoch: 7, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.942 Vali Acc: 0.664 Test Loss: 0.942 Test Acc: 0.664
Validation loss decreased (-0.644727 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 1.278416633605957
Epoch: 8, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.865 Vali Acc: 0.678 Test Loss: 0.865 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 1.101712942123413
Epoch: 9, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.794 Vali Acc: 0.717 Test Loss: 0.794 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717097).  Saving model ...
Epoch: 10 cost time: 1.3550491333007812
Epoch: 10, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.739 Vali Acc: 0.717 Test Loss: 0.739 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.1075546741485596
Epoch: 11, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 1.2870666980743408
Epoch: 12, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.648 Vali Acc: 0.750 Test Loss: 0.648 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.4858570098876953
Epoch: 13, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.613 Vali Acc: 0.770 Test Loss: 0.613 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.124419927597046
Epoch: 14, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.2517180442810059
Epoch: 15, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.3848323822021484
Epoch: 16, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.3584632873535156
Epoch: 17, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.4394927024841309
Epoch: 18, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 1.3102669715881348
Epoch: 19, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.2167015075683594
Epoch: 20, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 21 cost time: 1.2577331066131592
Epoch: 21, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 22 cost time: 1.3268535137176514
Epoch: 22, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.490 Vali Acc: 0.796 Test Loss: 0.490 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2705657482147217
Epoch: 23, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 24 cost time: 1.3059096336364746
Epoch: 24, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 25 cost time: 1.1006884574890137
Epoch: 25, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3276920318603516
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 27 cost time: 1.169769048690796
Epoch: 27, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3313663005828857
Epoch: 28, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.464 Vali Acc: 0.803 Test Loss: 0.464 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.305239200592041
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.468 Vali Acc: 0.803 Test Loss: 0.468 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1557965278625488
Epoch: 30, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 31 cost time: 1.2573473453521729
Epoch: 31, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.470 Vali Acc: 0.822 Test Loss: 0.470 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2794220447540283
Epoch: 32, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4080896377563477
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.467 Vali Acc: 0.822 Test Loss: 0.467 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.341423749923706
Epoch: 34, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.464 Vali Acc: 0.836 Test Loss: 0.464 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 35 cost time: 1.3341152667999268
Epoch: 35, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1307039260864258
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2625017166137695
Epoch: 37, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0644409656524658
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.291029691696167
Epoch: 39, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3213489055633545
Epoch: 40, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.4304909706115723
Epoch: 41, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.346186637878418
Epoch: 42, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2949731349945068
Epoch: 43, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.3972690105438232
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 290260
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6495907306671143
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.446 Vali Acc: 0.257 Test Loss: 1.446 Test Acc: 0.257
Validation loss decreased (inf --> -0.256564).  Saving model ...
Epoch: 2 cost time: 1.1679117679595947
Epoch: 2, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.389 Vali Acc: 0.322 Test Loss: 1.389 Test Acc: 0.322
Validation loss decreased (-0.256564 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.3957314491271973
Epoch: 3, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.316 Vali Acc: 0.395 Test Loss: 1.316 Test Acc: 0.395
Validation loss decreased (-0.322355 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.4183661937713623
Epoch: 4, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.394724 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.4380245208740234
Epoch: 5, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.159 Vali Acc: 0.546 Test Loss: 1.159 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 1.2927238941192627
Epoch: 6, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.088 Vali Acc: 0.592 Test Loss: 1.088 Test Acc: 0.592
Validation loss decreased (-0.546041 --> -0.592094).  Saving model ...
Epoch: 7 cost time: 1.1841695308685303
Epoch: 7, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.012 Vali Acc: 0.625 Test Loss: 1.012 Test Acc: 0.625
Validation loss decreased (-0.592094 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 1.4651122093200684
Epoch: 8, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.935 Vali Acc: 0.664 Test Loss: 0.935 Test Acc: 0.664
Validation loss decreased (-0.624990 --> -0.664464).  Saving model ...
Epoch: 9 cost time: 1.2859549522399902
Epoch: 9, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.861 Vali Acc: 0.691 Test Loss: 0.861 Test Acc: 0.691
Validation loss decreased (-0.664464 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 1.2314717769622803
Epoch: 10, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.802 Vali Acc: 0.711 Test Loss: 0.802 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710518).  Saving model ...
Epoch: 11 cost time: 1.1176831722259521
Epoch: 11, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.742 Vali Acc: 0.730 Test Loss: 0.742 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 12 cost time: 1.3708102703094482
Epoch: 12, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.693 Vali Acc: 0.743 Test Loss: 0.693 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 1.331287145614624
Epoch: 13, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.650 Vali Acc: 0.750 Test Loss: 0.650 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 1.0834481716156006
Epoch: 14, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.611 Vali Acc: 0.763 Test Loss: 0.611 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.2199246883392334
Epoch: 15, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 1.425903558731079
Epoch: 16, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.1500017642974854
Epoch: 17, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.222594976425171
Epoch: 18, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.1633758544921875
Epoch: 19, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 20 cost time: 1.1225593090057373
Epoch: 20, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 21 cost time: 1.0688862800598145
Epoch: 21, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 22 cost time: 1.2246472835540771
Epoch: 22, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 23 cost time: 1.2802245616912842
Epoch: 23, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.491 Vali Acc: 0.783 Test Loss: 0.491 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2026913166046143
Epoch: 24, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.494 Vali Acc: 0.757 Test Loss: 0.494 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2032372951507568
Epoch: 25, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2196297645568848
Epoch: 26, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 27 cost time: 1.3756492137908936
Epoch: 27, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.496 Vali Acc: 0.796 Test Loss: 0.496 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3185229301452637
Epoch: 28, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 29 cost time: 1.2785987854003906
Epoch: 29, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.457254409790039
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.279423475265503
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 32 cost time: 1.2357373237609863
Epoch: 32, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4090321063995361
Epoch: 33, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3289732933044434
Epoch: 34, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3239665031433105
Epoch: 35, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 36 cost time: 1.4811429977416992
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4232170581817627
Epoch: 37, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 38 cost time: 1.3004589080810547
Epoch: 38, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.461366891860962
Epoch: 39, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3744490146636963
Epoch: 40, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.256779432296753
Epoch: 41, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.274289846420288
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2657551765441895
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2095913887023926
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.3516767024993896
Epoch: 45, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3274734020233154
Epoch: 46, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.411001205444336
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 290260
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.582603693008423
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.416 Vali Acc: 0.309 Test Loss: 1.416 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 1.3471336364746094
Epoch: 2, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.346 Vali Acc: 0.336 Test Loss: 1.346 Test Acc: 0.336
Validation loss decreased (-0.309196 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.2463982105255127
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.259 Vali Acc: 0.434 Test Loss: 1.259 Test Acc: 0.434
Validation loss decreased (-0.335513 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 1.382897138595581
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.169 Vali Acc: 0.526 Test Loss: 1.169 Test Acc: 0.526
Validation loss decreased (-0.434198 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 1.3632333278656006
Epoch: 5, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.076 Vali Acc: 0.572 Test Loss: 1.076 Test Acc: 0.572
Validation loss decreased (-0.526304 --> -0.572358).  Saving model ...
Epoch: 6 cost time: 1.6126692295074463
Epoch: 6, Steps: 10 | Train Loss: 0.918 Vali Loss: 0.987 Vali Acc: 0.625 Test Loss: 0.987 Test Acc: 0.625
Validation loss decreased (-0.572358 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 1.4622256755828857
Epoch: 7, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.905 Vali Acc: 0.651 Test Loss: 0.905 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 1.2652437686920166
Epoch: 8, Steps: 10 | Train Loss: 0.741 Vali Loss: 0.836 Vali Acc: 0.704 Test Loss: 0.836 Test Acc: 0.704
Validation loss decreased (-0.651307 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 1.3598275184631348
Epoch: 9, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.771 Vali Acc: 0.730 Test Loss: 0.771 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730255).  Saving model ...
Epoch: 10 cost time: 1.355699062347412
Epoch: 10, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.710 Vali Acc: 0.750 Test Loss: 0.710 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 1.3594563007354736
Epoch: 11, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.670 Vali Acc: 0.737 Test Loss: 0.670 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6588413715362549
Epoch: 12, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.3118736743927002
Epoch: 13, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.607 Vali Acc: 0.770 Test Loss: 0.607 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.4502792358398438
Epoch: 14, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.321770191192627
Epoch: 15, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 1.3097033500671387
Epoch: 16, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.550652027130127
Epoch: 17, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 18 cost time: 1.2260239124298096
Epoch: 18, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 19 cost time: 1.2286405563354492
Epoch: 19, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.2510006427764893
Epoch: 20, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5596513748168945
Epoch: 21, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.527 Vali Acc: 0.770 Test Loss: 0.527 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2416424751281738
Epoch: 22, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.527 Vali Acc: 0.770 Test Loss: 0.527 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4012956619262695
Epoch: 23, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.3825907707214355
Epoch: 24, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3594727516174316
Epoch: 25, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5186412334442139
Epoch: 26, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.555976152420044
Epoch: 27, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.522 Vali Acc: 0.776 Test Loss: 0.522 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3131835460662842
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3890278339385986
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.423783302307129
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2885236740112305
Epoch: 31, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.417433738708496
Epoch: 32, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0694036483764648
Epoch: 33, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2952897548675537
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 35 cost time: 1.1430530548095703
Epoch: 35, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0932843685150146
Epoch: 36, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2110323905944824
Epoch: 37, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2936716079711914
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2896037101745605
Epoch: 39, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.433152437210083
Epoch: 40, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2625508308410645
Epoch: 41, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2199885845184326
Epoch: 42, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2519512176513672
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.3820810317993164
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 159188
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.751838445663452
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.428 Vali Acc: 0.283 Test Loss: 1.428 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.1687817573547363
Epoch: 2, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.356 Vali Acc: 0.342 Test Loss: 1.356 Test Acc: 0.342
Validation loss decreased (-0.282880 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.2752697467803955
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.272 Vali Acc: 0.408 Test Loss: 1.272 Test Acc: 0.408
Validation loss decreased (-0.342092 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 1.403602123260498
Epoch: 4, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.181 Vali Acc: 0.539 Test Loss: 1.181 Test Acc: 0.539
Validation loss decreased (-0.407882 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.3521666526794434
Epoch: 5, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.087 Vali Acc: 0.566 Test Loss: 1.087 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565779).  Saving model ...
Epoch: 6 cost time: 1.2717938423156738
Epoch: 6, Steps: 10 | Train Loss: 0.941 Vali Loss: 0.996 Vali Acc: 0.638 Test Loss: 0.996 Test Acc: 0.638
Validation loss decreased (-0.565779 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 1.3641366958618164
Epoch: 7, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.915 Vali Acc: 0.684 Test Loss: 0.915 Test Acc: 0.684
Validation loss decreased (-0.638148 --> -0.684201).  Saving model ...
Epoch: 8 cost time: 1.266967535018921
Epoch: 8, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.839 Vali Acc: 0.724 Test Loss: 0.839 Test Acc: 0.724
Validation loss decreased (-0.684201 --> -0.723676).  Saving model ...
Epoch: 9 cost time: 1.1304869651794434
Epoch: 9, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.772 Vali Acc: 0.730 Test Loss: 0.772 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730255).  Saving model ...
Epoch: 10 cost time: 1.1540839672088623
Epoch: 10, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.714 Vali Acc: 0.730 Test Loss: 0.714 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.279780626296997
Epoch: 11, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.669 Vali Acc: 0.743 Test Loss: 0.669 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.1953003406524658
Epoch: 12, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.4157564640045166
Epoch: 13, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.4378535747528076
Epoch: 14, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.372131109237671
Epoch: 15, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.3259150981903076
Epoch: 16, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.438004493713379
Epoch: 17, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.540 Vali Acc: 0.763 Test Loss: 0.540 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.4426016807556152
Epoch: 18, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.2610347270965576
Epoch: 19, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.516 Vali Acc: 0.776 Test Loss: 0.516 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3836452960968018
Epoch: 20, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 21 cost time: 1.4423589706420898
Epoch: 21, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 1.3028991222381592
Epoch: 22, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0764529705047607
Epoch: 23, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 24 cost time: 1.0130815505981445
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.226485252380371
Epoch: 25, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3113512992858887
Epoch: 26, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4055814743041992
Epoch: 27, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 28 cost time: 1.443049430847168
Epoch: 28, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4898595809936523
Epoch: 29, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1010897159576416
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 31 cost time: 1.473015308380127
Epoch: 31, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5727717876434326
Epoch: 32, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4260108470916748
Epoch: 33, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2055702209472656
Epoch: 34, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2125606536865234
Epoch: 35, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.272495985031128
Epoch: 36, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1512072086334229
Epoch: 37, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2389788627624512
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.3186547756195068
Epoch: 39, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4923484325408936
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 41 cost time: 1.2357604503631592
Epoch: 41, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.19337797164917
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1643691062927246
Epoch: 43, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3013763427734375
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4216902256011963
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2398500442504883
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.4583897590637207
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3066515922546387
Epoch: 48, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1860675811767578
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3252475261688232
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 159188
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.614713430404663
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.441 Vali Acc: 0.217 Test Loss: 1.441 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 1.3747804164886475
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.377 Vali Acc: 0.303 Test Loss: 1.377 Test Acc: 0.303
Validation loss decreased (-0.217091 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.281132459640503
Epoch: 3, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.292 Vali Acc: 0.421 Test Loss: 1.292 Test Acc: 0.421
Validation loss decreased (-0.302618 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.2264974117279053
Epoch: 4, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.206 Vali Acc: 0.467 Test Loss: 1.206 Test Acc: 0.467
Validation loss decreased (-0.421040 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 1.1232030391693115
Epoch: 5, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.116 Vali Acc: 0.520 Test Loss: 1.116 Test Acc: 0.520
Validation loss decreased (-0.467093 --> -0.519726).  Saving model ...
Epoch: 6 cost time: 1.1886651515960693
Epoch: 6, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.032 Vali Acc: 0.572 Test Loss: 1.032 Test Acc: 0.572
Validation loss decreased (-0.519726 --> -0.572358).  Saving model ...
Epoch: 7 cost time: 1.197063684463501
Epoch: 7, Steps: 10 | Train Loss: 0.850 Vali Loss: 0.949 Vali Acc: 0.612 Test Loss: 0.949 Test Acc: 0.612
Validation loss decreased (-0.572358 --> -0.611833).  Saving model ...
Epoch: 8 cost time: 1.1645219326019287
Epoch: 8, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.874 Vali Acc: 0.691 Test Loss: 0.874 Test Acc: 0.691
Validation loss decreased (-0.611833 --> -0.690781).  Saving model ...
Epoch: 9 cost time: 1.1658740043640137
Epoch: 9, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.805 Vali Acc: 0.717 Test Loss: 0.805 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717097).  Saving model ...
Epoch: 10 cost time: 1.2723841667175293
Epoch: 10, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.743 Vali Acc: 0.724 Test Loss: 0.743 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.3801071643829346
Epoch: 11, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.696 Vali Acc: 0.743 Test Loss: 0.696 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.2413926124572754
Epoch: 12, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.658 Vali Acc: 0.750 Test Loss: 0.658 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 1.2389907836914062
Epoch: 13, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.617 Vali Acc: 0.757 Test Loss: 0.617 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.2516155242919922
Epoch: 14, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.367704153060913
Epoch: 15, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.121605396270752
Epoch: 16, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 17 cost time: 1.4849741458892822
Epoch: 17, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 18 cost time: 1.4540908336639404
Epoch: 18, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 1.6454858779907227
Epoch: 19, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5152063369750977
Epoch: 20, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 1.4959335327148438
Epoch: 21, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.480 Vali Acc: 0.816 Test Loss: 0.480 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 22 cost time: 1.418874979019165
Epoch: 22, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.480 Vali Acc: 0.796 Test Loss: 0.480 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2311797142028809
Epoch: 23, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1775321960449219
Epoch: 24, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5194289684295654
Epoch: 25, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.470 Vali Acc: 0.803 Test Loss: 0.470 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6258978843688965
Epoch: 26, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6608970165252686
Epoch: 27, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.466 Vali Acc: 0.829 Test Loss: 0.466 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 28 cost time: 1.4966645240783691
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.463 Vali Acc: 0.822 Test Loss: 0.463 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4425926208496094
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4695794582366943
Epoch: 30, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4800195693969727
Epoch: 31, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.449859380722046
Epoch: 32, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.463 Vali Acc: 0.816 Test Loss: 0.463 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4993648529052734
Epoch: 33, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4936895370483398
Epoch: 34, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.467 Vali Acc: 0.816 Test Loss: 0.467 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4662036895751953
Epoch: 35, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.475 Vali Acc: 0.816 Test Loss: 0.475 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.603639841079712
Epoch: 36, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.5878236293792725
Epoch: 37, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 159188
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.093961477279663
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.455 Vali Acc: 0.243 Test Loss: 1.455 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.2707231044769287
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.399 Vali Acc: 0.276 Test Loss: 1.399 Test Acc: 0.276
Validation loss decreased (-0.243407 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 1.2001986503601074
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.329 Vali Acc: 0.388 Test Loss: 1.329 Test Acc: 0.388
Validation loss decreased (-0.276302 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 1.114945411682129
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.257 Vali Acc: 0.480 Test Loss: 1.257 Test Acc: 0.480
Validation loss decreased (-0.388145 --> -0.480251).  Saving model ...
Epoch: 5 cost time: 1.152480125427246
Epoch: 5, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
Validation loss decreased (-0.480251 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 1.1042556762695312
Epoch: 6, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.105 Vali Acc: 0.572 Test Loss: 1.105 Test Acc: 0.572
Validation loss decreased (-0.532883 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 1.159437894821167
Epoch: 7, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.026 Vali Acc: 0.605 Test Loss: 1.026 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605253).  Saving model ...
Epoch: 8 cost time: 1.528113842010498
Epoch: 8, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.954 Vali Acc: 0.618 Test Loss: 0.954 Test Acc: 0.618
Validation loss decreased (-0.605253 --> -0.618412).  Saving model ...
Epoch: 9 cost time: 1.2447073459625244
Epoch: 9, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.882 Vali Acc: 0.625 Test Loss: 0.882 Test Acc: 0.625
Validation loss decreased (-0.618412 --> -0.624991).  Saving model ...
Epoch: 10 cost time: 1.3738133907318115
Epoch: 10, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.818 Vali Acc: 0.671 Test Loss: 0.818 Test Acc: 0.671
Validation loss decreased (-0.624991 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 1.2982792854309082
Epoch: 11, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.765 Vali Acc: 0.684 Test Loss: 0.765 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684203).  Saving model ...
Epoch: 12 cost time: 1.3667471408843994
Epoch: 12, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.723 Vali Acc: 0.691 Test Loss: 0.723 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 13 cost time: 1.2920563220977783
Epoch: 13, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.677 Vali Acc: 0.711 Test Loss: 0.677 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710520).  Saving model ...
Epoch: 14 cost time: 1.519378423690796
Epoch: 14, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
Validation loss decreased (-0.710520 --> -0.717099).  Saving model ...
Epoch: 15 cost time: 1.270033836364746
Epoch: 15, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.604 Vali Acc: 0.724 Test Loss: 0.604 Test Acc: 0.724
Validation loss decreased (-0.717099 --> -0.723678).  Saving model ...
Epoch: 16 cost time: 1.3567636013031006
Epoch: 16, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.582 Vali Acc: 0.743 Test Loss: 0.582 Test Acc: 0.743
Validation loss decreased (-0.723678 --> -0.743415).  Saving model ...
Epoch: 17 cost time: 1.2477924823760986
Epoch: 17, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.566 Vali Acc: 0.743 Test Loss: 0.566 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 18 cost time: 1.429880142211914
Epoch: 18, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.550 Vali Acc: 0.743 Test Loss: 0.550 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743416).  Saving model ...
Epoch: 19 cost time: 1.1379632949829102
Epoch: 19, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.533 Vali Acc: 0.750 Test Loss: 0.533 Test Acc: 0.750
Validation loss decreased (-0.743416 --> -0.749995).  Saving model ...
Epoch: 20 cost time: 1.118499994277954
Epoch: 20, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.525 Vali Acc: 0.763 Test Loss: 0.525 Test Acc: 0.763
Validation loss decreased (-0.749995 --> -0.763153).  Saving model ...
Epoch: 21 cost time: 1.1062836647033691
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.508 Vali Acc: 0.763 Test Loss: 0.508 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 22 cost time: 1.2274808883666992
Epoch: 22, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
Validation loss decreased (-0.763153 --> -0.789469).  Saving model ...
Epoch: 23 cost time: 1.1376140117645264
Epoch: 23, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.489 Vali Acc: 0.783 Test Loss: 0.489 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0945830345153809
Epoch: 24, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 25 cost time: 1.2348096370697021
Epoch: 25, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 26 cost time: 1.2668957710266113
Epoch: 26, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.479 Vali Acc: 0.789 Test Loss: 0.479 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 27 cost time: 1.4490761756896973
Epoch: 27, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.474 Vali Acc: 0.789 Test Loss: 0.474 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 28 cost time: 1.240778923034668
Epoch: 28, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809206).  Saving model ...
Epoch: 29 cost time: 1.3446085453033447
Epoch: 29, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.463 Vali Acc: 0.796 Test Loss: 0.463 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.127887487411499
Epoch: 30, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.469 Vali Acc: 0.803 Test Loss: 0.469 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2748394012451172
Epoch: 31, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.461 Vali Acc: 0.803 Test Loss: 0.461 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2375609874725342
Epoch: 32, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.459 Vali Acc: 0.803 Test Loss: 0.459 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2051546573638916
Epoch: 33, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1056387424468994
Epoch: 34, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2148468494415283
Epoch: 35, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2649414539337158
Epoch: 36, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.379392385482788
Epoch: 37, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.480 Vali Acc: 0.796 Test Loss: 0.480 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2455544471740723
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.473 Vali Acc: 0.796 Test Loss: 0.473 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 159188
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6337637901306152
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.379 Vali Acc: 0.322 Test Loss: 1.379 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.3499984741210938
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.314 Vali Acc: 0.342 Test Loss: 1.314 Test Acc: 0.342
Validation loss decreased (-0.322355 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.2042248249053955
Epoch: 3, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.230 Vali Acc: 0.395 Test Loss: 1.230 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394725).  Saving model ...
Epoch: 4 cost time: 1.323019027709961
Epoch: 4, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
Validation loss decreased (-0.394725 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 1.3437552452087402
Epoch: 5, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.046 Vali Acc: 0.612 Test Loss: 1.046 Test Acc: 0.612
Validation loss decreased (-0.499989 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.22715425491333
Epoch: 6, Steps: 10 | Train Loss: 0.916 Vali Loss: 0.959 Vali Acc: 0.592 Test Loss: 0.959 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3083326816558838
Epoch: 7, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.887 Vali Acc: 0.645 Test Loss: 0.887 Test Acc: 0.645
Validation loss decreased (-0.611832 --> -0.644728).  Saving model ...
Epoch: 8 cost time: 1.4058740139007568
Epoch: 8, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.822 Vali Acc: 0.651 Test Loss: 0.822 Test Acc: 0.651
Validation loss decreased (-0.644728 --> -0.651308).  Saving model ...
Epoch: 9 cost time: 1.481586217880249
Epoch: 9, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.766 Vali Acc: 0.671 Test Loss: 0.766 Test Acc: 0.671
Validation loss decreased (-0.651308 --> -0.671045).  Saving model ...
Epoch: 10 cost time: 1.3411073684692383
Epoch: 10, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.715 Vali Acc: 0.724 Test Loss: 0.715 Test Acc: 0.724
Validation loss decreased (-0.671045 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.3273706436157227
Epoch: 11, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.676 Vali Acc: 0.730 Test Loss: 0.676 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 12 cost time: 1.404818058013916
Epoch: 12, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.2057197093963623
Epoch: 13, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.630 Vali Acc: 0.743 Test Loss: 0.630 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 14 cost time: 1.3474843502044678
Epoch: 14, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.331207513809204
Epoch: 15, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 1.5672409534454346
Epoch: 16, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3427035808563232
Epoch: 17, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.561 Vali Acc: 0.750 Test Loss: 0.561 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3896098136901855
Epoch: 18, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.552 Vali Acc: 0.757 Test Loss: 0.552 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 19 cost time: 1.4557631015777588
Epoch: 19, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.551 Vali Acc: 0.743 Test Loss: 0.551 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3685665130615234
Epoch: 20, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.549 Vali Acc: 0.757 Test Loss: 0.549 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 21 cost time: 1.4928953647613525
Epoch: 21, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 1.621889591217041
Epoch: 22, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.532 Vali Acc: 0.770 Test Loss: 0.532 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3863236904144287
Epoch: 23, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4289968013763428
Epoch: 24, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.318315029144287
Epoch: 25, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 26 cost time: 1.2268929481506348
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.203942060470581
Epoch: 27, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.183192491531372
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3333077430725098
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2446751594543457
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.392944097518921
Epoch: 31, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2946510314941406
Epoch: 32, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3870258331298828
Epoch: 33, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3755946159362793
Epoch: 34, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 35 cost time: 1.1888384819030762
Epoch: 35, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.122398853302002
Epoch: 36, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 37 cost time: 1.4221301078796387
Epoch: 37, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.212442398071289
Epoch: 38, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4216289520263672
Epoch: 39, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3419339656829834
Epoch: 40, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2973637580871582
Epoch: 41, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.564 Vali Acc: 0.796 Test Loss: 0.564 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4486143589019775
Epoch: 42, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.5128107070922852
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.5071344375610352
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.2430598735809326
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.242973804473877
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 93652
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4463555812835693
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.377 Vali Acc: 0.296 Test Loss: 1.377 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.209536075592041
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.315 Vali Acc: 0.362 Test Loss: 1.315 Test Acc: 0.362
Validation loss decreased (-0.296039 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.4154455661773682
Epoch: 3, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.234 Vali Acc: 0.408 Test Loss: 1.234 Test Acc: 0.408
Validation loss decreased (-0.361829 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 1.3384125232696533
Epoch: 4, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.147 Vali Acc: 0.520 Test Loss: 1.147 Test Acc: 0.520
Validation loss decreased (-0.407882 --> -0.519725).  Saving model ...
Epoch: 5 cost time: 1.1659307479858398
Epoch: 5, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.056 Vali Acc: 0.605 Test Loss: 1.056 Test Acc: 0.605
Validation loss decreased (-0.519725 --> -0.605253).  Saving model ...
Epoch: 6 cost time: 1.449300765991211
Epoch: 6, Steps: 10 | Train Loss: 0.916 Vali Loss: 0.970 Vali Acc: 0.612 Test Loss: 0.970 Test Acc: 0.612
Validation loss decreased (-0.605253 --> -0.611832).  Saving model ...
Epoch: 7 cost time: 1.4921047687530518
Epoch: 7, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.896 Vali Acc: 0.625 Test Loss: 0.896 Test Acc: 0.625
Validation loss decreased (-0.611832 --> -0.624991).  Saving model ...
Epoch: 8 cost time: 1.3284857273101807
Epoch: 8, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.828 Vali Acc: 0.645 Test Loss: 0.828 Test Acc: 0.645
Validation loss decreased (-0.624991 --> -0.644729).  Saving model ...
Epoch: 9 cost time: 1.1492271423339844
Epoch: 9, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.769 Vali Acc: 0.678 Test Loss: 0.769 Test Acc: 0.678
Validation loss decreased (-0.644729 --> -0.677624).  Saving model ...
Epoch: 10 cost time: 1.2083678245544434
Epoch: 10, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.721 Vali Acc: 0.711 Test Loss: 0.721 Test Acc: 0.711
Validation loss decreased (-0.677624 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.2485754489898682
Epoch: 11, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.678 Vali Acc: 0.717 Test Loss: 0.678 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 12 cost time: 1.241772174835205
Epoch: 12, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.654 Vali Acc: 0.737 Test Loss: 0.654 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.1937804222106934
Epoch: 13, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 1.4015412330627441
Epoch: 14, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.3726866245269775
Epoch: 15, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.588 Vali Acc: 0.750 Test Loss: 0.588 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 1.2220451831817627
Epoch: 16, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.217029333114624
Epoch: 17, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.2422714233398438
Epoch: 18, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.3335983753204346
Epoch: 19, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.2922136783599854
Epoch: 20, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.2635948657989502
Epoch: 21, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 22 cost time: 1.5338599681854248
Epoch: 22, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.2282657623291016
Epoch: 23, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 24 cost time: 1.2805190086364746
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 25 cost time: 1.076551914215088
Epoch: 25, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 26 cost time: 1.374403476715088
Epoch: 26, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 27 cost time: 1.4730124473571777
Epoch: 27, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3256323337554932
Epoch: 28, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 29 cost time: 1.2674434185028076
Epoch: 29, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 30 cost time: 1.4292850494384766
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.506 Vali Acc: 0.816 Test Loss: 0.506 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2306947708129883
Epoch: 31, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.326554775238037
Epoch: 32, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.505 Vali Acc: 0.816 Test Loss: 0.505 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4383904933929443
Epoch: 33, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.503 Vali Acc: 0.816 Test Loss: 0.503 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3284971714019775
Epoch: 34, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3678491115570068
Epoch: 35, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.337935209274292
Epoch: 36, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.259873390197754
Epoch: 37, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1897804737091064
Epoch: 38, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2159745693206787
Epoch: 39, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 93652
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.90980863571167
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.370 Vali Acc: 0.329 Test Loss: 1.370 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.3138837814331055
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.314 Vali Acc: 0.362 Test Loss: 1.314 Test Acc: 0.362
Validation loss decreased (-0.328934 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.3941164016723633
Epoch: 3, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.240 Vali Acc: 0.428 Test Loss: 1.240 Test Acc: 0.428
Validation loss decreased (-0.361829 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.2651796340942383
Epoch: 4, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.158 Vali Acc: 0.553 Test Loss: 1.158 Test Acc: 0.553
Validation loss decreased (-0.427619 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.1926624774932861
Epoch: 5, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.070 Vali Acc: 0.605 Test Loss: 1.070 Test Acc: 0.605
Validation loss decreased (-0.552620 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 1.5405278205871582
Epoch: 6, Steps: 10 | Train Loss: 0.930 Vali Loss: 0.981 Vali Acc: 0.625 Test Loss: 0.981 Test Acc: 0.625
Validation loss decreased (-0.605252 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 1.4338617324829102
Epoch: 7, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.906 Vali Acc: 0.658 Test Loss: 0.906 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657886).  Saving model ...
Epoch: 8 cost time: 1.2578718662261963
Epoch: 8, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.839 Vali Acc: 0.691 Test Loss: 0.839 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690781).  Saving model ...
Epoch: 9 cost time: 1.3219504356384277
Epoch: 9, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.779 Vali Acc: 0.724 Test Loss: 0.779 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723676).  Saving model ...
Epoch: 10 cost time: 1.3052537441253662
Epoch: 10, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.731 Vali Acc: 0.730 Test Loss: 0.731 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.2296161651611328
Epoch: 11, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.685 Vali Acc: 0.757 Test Loss: 0.685 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 1.317772626876831
Epoch: 12, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.653 Vali Acc: 0.750 Test Loss: 0.653 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.129664659500122
Epoch: 13, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.622 Vali Acc: 0.757 Test Loss: 0.622 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.3505866527557373
Epoch: 14, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.4044811725616455
Epoch: 15, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.4425663948059082
Epoch: 16, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.3442144393920898
Epoch: 17, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.2144110202789307
Epoch: 18, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.5084185600280762
Epoch: 19, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 20 cost time: 1.2967982292175293
Epoch: 20, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 21 cost time: 1.4151809215545654
Epoch: 21, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 1.2769138813018799
Epoch: 22, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.487 Vali Acc: 0.796 Test Loss: 0.487 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 23 cost time: 1.216937780380249
Epoch: 23, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.479 Vali Acc: 0.796 Test Loss: 0.479 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 24 cost time: 1.3238894939422607
Epoch: 24, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.477 Vali Acc: 0.796 Test Loss: 0.477 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 25 cost time: 1.1394197940826416
Epoch: 25, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.468 Vali Acc: 0.803 Test Loss: 0.468 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 26 cost time: 1.314859390258789
Epoch: 26, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.471 Vali Acc: 0.809 Test Loss: 0.471 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 27 cost time: 1.1587650775909424
Epoch: 27, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.467 Vali Acc: 0.796 Test Loss: 0.467 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3244588375091553
Epoch: 28, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 29 cost time: 1.317373275756836
Epoch: 29, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.455 Vali Acc: 0.809 Test Loss: 0.455 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 30 cost time: 1.494920253753662
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.458 Vali Acc: 0.816 Test Loss: 0.458 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 31 cost time: 1.3930141925811768
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2517149448394775
Epoch: 32, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3361659049987793
Epoch: 33, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2923648357391357
Epoch: 34, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 35 cost time: 1.2061200141906738
Epoch: 35, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.464 Vali Acc: 0.822 Test Loss: 0.464 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1338586807250977
Epoch: 36, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3757846355438232
Epoch: 37, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2004506587982178
Epoch: 38, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2102386951446533
Epoch: 39, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3842637538909912
Epoch: 40, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.4188456535339355
Epoch: 41, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.345092535018921
Epoch: 42, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2334191799163818
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2196588516235352
Epoch: 44, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 93652
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.496569871902466
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.363 Vali Acc: 0.296 Test Loss: 1.363 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.3936028480529785
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.319 Vali Acc: 0.355 Test Loss: 1.319 Test Acc: 0.355
Validation loss decreased (-0.296039 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.241725206375122
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.257 Vali Acc: 0.487 Test Loss: 1.257 Test Acc: 0.487
Validation loss decreased (-0.355250 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 1.229783296585083
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.188 Vali Acc: 0.553 Test Loss: 1.188 Test Acc: 0.553
Validation loss decreased (-0.486830 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.2585351467132568
Epoch: 5, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.116 Vali Acc: 0.625 Test Loss: 1.116 Test Acc: 0.625
Validation loss decreased (-0.552620 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.1995940208435059
Epoch: 6, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.042 Vali Acc: 0.651 Test Loss: 1.042 Test Acc: 0.651
Validation loss decreased (-0.624989 --> -0.651305).  Saving model ...
Epoch: 7 cost time: 1.300539493560791
Epoch: 7, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.976 Vali Acc: 0.645 Test Loss: 0.976 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2865171432495117
Epoch: 8, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.907 Vali Acc: 0.678 Test Loss: 0.907 Test Acc: 0.678
Validation loss decreased (-0.651305 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 1.2344708442687988
Epoch: 9, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.844 Vali Acc: 0.691 Test Loss: 0.844 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 1.323190450668335
Epoch: 10, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.793 Vali Acc: 0.743 Test Loss: 0.793 Test Acc: 0.743
Validation loss decreased (-0.690781 --> -0.743413).  Saving model ...
Epoch: 11 cost time: 1.371976375579834
Epoch: 11, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.502753496170044
Epoch: 12, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.702 Vali Acc: 0.770 Test Loss: 0.702 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 13 cost time: 1.2920527458190918
Epoch: 13, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.666 Vali Acc: 0.763 Test Loss: 0.666 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5080554485321045
Epoch: 14, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.633 Vali Acc: 0.776 Test Loss: 0.633 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 15 cost time: 1.3513438701629639
Epoch: 15, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.5155079364776611
Epoch: 16, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.7744569778442383
Epoch: 17, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.549377202987671
Epoch: 18, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.454439640045166
Epoch: 19, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4432566165924072
Epoch: 20, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2914903163909912
Epoch: 21, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3918066024780273
Epoch: 22, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.308760643005371
Epoch: 23, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.506 Vali Acc: 0.770 Test Loss: 0.506 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3742926120758057
Epoch: 24, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4738664627075195
Epoch: 25, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4219639301300049
Epoch: 26, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4943058490753174
Epoch: 27, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 93652
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6933138370513916
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.513 Vali Acc: 0.191 Test Loss: 1.513 Test Acc: 0.191
Validation loss decreased (inf --> -0.190774).  Saving model ...
Epoch: 2 cost time: 1.511451005935669
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.443 Vali Acc: 0.224 Test Loss: 1.443 Test Acc: 0.224
Validation loss decreased (-0.190774 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 1.4754045009613037
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.349 Vali Acc: 0.355 Test Loss: 1.349 Test Acc: 0.355
Validation loss decreased (-0.223670 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.3576934337615967
Epoch: 4, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.252 Vali Acc: 0.441 Test Loss: 1.252 Test Acc: 0.441
Validation loss decreased (-0.355250 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 1.4656226634979248
Epoch: 5, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.141 Vali Acc: 0.526 Test Loss: 1.141 Test Acc: 0.526
Validation loss decreased (-0.440777 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 1.2583892345428467
Epoch: 6, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.041 Vali Acc: 0.566 Test Loss: 1.041 Test Acc: 0.566
Validation loss decreased (-0.526304 --> -0.565779).  Saving model ...
Epoch: 7 cost time: 1.3988971710205078
Epoch: 7, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.957 Vali Acc: 0.618 Test Loss: 0.957 Test Acc: 0.618
Validation loss decreased (-0.565779 --> -0.618411).  Saving model ...
Epoch: 8 cost time: 1.3600194454193115
Epoch: 8, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.883 Vali Acc: 0.651 Test Loss: 0.883 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651307).  Saving model ...
Epoch: 9 cost time: 1.3432090282440186
Epoch: 9, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.821 Vali Acc: 0.711 Test Loss: 0.821 Test Acc: 0.711
Validation loss decreased (-0.651307 --> -0.710518).  Saving model ...
Epoch: 10 cost time: 1.3099308013916016
Epoch: 10, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.760 Vali Acc: 0.711 Test Loss: 0.760 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.1912100315093994
Epoch: 11, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.707 Vali Acc: 0.730 Test Loss: 0.707 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 12 cost time: 1.3055365085601807
Epoch: 12, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 1.171546220779419
Epoch: 13, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.648 Vali Acc: 0.757 Test Loss: 0.648 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 14 cost time: 1.2001597881317139
Epoch: 14, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.291790246963501
Epoch: 15, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.3604116439819336
Epoch: 16, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.2705979347229004
Epoch: 17, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3332130908966064
Epoch: 18, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.554 Vali Acc: 0.789 Test Loss: 0.554 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.2183971405029297
Epoch: 19, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.2971079349517822
Epoch: 20, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2258827686309814
Epoch: 21, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.491903305053711
Epoch: 22, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 1.3051302433013916
Epoch: 23, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.4892654418945312
Epoch: 24, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5057368278503418
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4470562934875488
Epoch: 26, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3420484066009521
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.536 Vali Acc: 0.770 Test Loss: 0.536 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.245560884475708
Epoch: 28, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.360358476638794
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4503843784332275
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4551928043365479
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3954577445983887
Epoch: 32, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.377354383468628
Epoch: 33, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 60884
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4783542156219482
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.493 Vali Acc: 0.224 Test Loss: 1.493 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 1.141831636428833
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.426 Vali Acc: 0.270 Test Loss: 1.426 Test Acc: 0.270
Validation loss decreased (-0.223669 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.0934486389160156
Epoch: 3, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.337 Vali Acc: 0.336 Test Loss: 1.337 Test Acc: 0.336
Validation loss decreased (-0.269723 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.217207670211792
Epoch: 4, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.240 Vali Acc: 0.461 Test Loss: 1.240 Test Acc: 0.461
Validation loss decreased (-0.335513 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 1.3161392211914062
Epoch: 5, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (-0.460514 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.298635482788086
Epoch: 6, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.038 Vali Acc: 0.612 Test Loss: 1.038 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611832).  Saving model ...
Epoch: 7 cost time: 1.5636272430419922
Epoch: 7, Steps: 10 | Train Loss: 0.811 Vali Loss: 0.955 Vali Acc: 0.645 Test Loss: 0.955 Test Acc: 0.645
Validation loss decreased (-0.611832 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 1.2847154140472412
Epoch: 8, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.880 Vali Acc: 0.697 Test Loss: 0.880 Test Acc: 0.697
Validation loss decreased (-0.644727 --> -0.697360).  Saving model ...
Epoch: 9 cost time: 1.5383846759796143
Epoch: 9, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717097).  Saving model ...
Epoch: 10 cost time: 1.4979686737060547
Epoch: 10, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.755 Vali Acc: 0.730 Test Loss: 0.755 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.1705689430236816
Epoch: 11, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.704 Vali Acc: 0.724 Test Loss: 0.704 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2480709552764893
Epoch: 12, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.669 Vali Acc: 0.757 Test Loss: 0.669 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 1.2124831676483154
Epoch: 13, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.637 Vali Acc: 0.763 Test Loss: 0.637 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.233975887298584
Epoch: 14, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.610 Vali Acc: 0.770 Test Loss: 0.610 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.2988901138305664
Epoch: 15, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.585 Vali Acc: 0.770 Test Loss: 0.585 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 1.0598835945129395
Epoch: 16, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.3669731616973877
Epoch: 17, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.4293711185455322
Epoch: 18, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.361600399017334
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.5290226936340332
Epoch: 20, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2586948871612549
Epoch: 21, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 1.462266445159912
Epoch: 22, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 23 cost time: 1.395704746246338
Epoch: 23, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5305283069610596
Epoch: 24, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4796833992004395
Epoch: 25, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2939081192016602
Epoch: 26, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 27 cost time: 1.235471248626709
Epoch: 27, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4056355953216553
Epoch: 28, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.507 Vali Acc: 0.776 Test Loss: 0.507 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2059032917022705
Epoch: 29, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2120788097381592
Epoch: 30, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1236658096313477
Epoch: 31, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2838692665100098
Epoch: 32, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2971174716949463
Epoch: 33, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.4287919998168945
Epoch: 34, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4605329036712646
Epoch: 35, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3259525299072266
Epoch: 36, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 60884
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4845311641693115
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.460 Vali Acc: 0.197 Test Loss: 1.460 Test Acc: 0.197
Validation loss decreased (inf --> -0.197354).  Saving model ...
Epoch: 2 cost time: 1.1727268695831299
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.400 Vali Acc: 0.263 Test Loss: 1.400 Test Acc: 0.263
Validation loss decreased (-0.197354 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 1.155747413635254
Epoch: 3, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.322 Vali Acc: 0.336 Test Loss: 1.322 Test Acc: 0.336
Validation loss decreased (-0.263144 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.4246056079864502
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.235 Vali Acc: 0.421 Test Loss: 1.235 Test Acc: 0.421
Validation loss decreased (-0.335513 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 1.2299556732177734
Epoch: 5, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.139 Vali Acc: 0.507 Test Loss: 1.139 Test Acc: 0.507
Validation loss decreased (-0.421040 --> -0.506568).  Saving model ...
Epoch: 6 cost time: 1.29494047164917
Epoch: 6, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.054 Vali Acc: 0.572 Test Loss: 1.054 Test Acc: 0.572
Validation loss decreased (-0.506568 --> -0.572358).  Saving model ...
Epoch: 7 cost time: 1.1311523914337158
Epoch: 7, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.971 Vali Acc: 0.612 Test Loss: 0.971 Test Acc: 0.612
Validation loss decreased (-0.572358 --> -0.611832).  Saving model ...
Epoch: 8 cost time: 1.3663585186004639
Epoch: 8, Steps: 10 | Train Loss: 0.791 Vali Loss: 0.898 Vali Acc: 0.671 Test Loss: 0.898 Test Acc: 0.671
Validation loss decreased (-0.611832 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.2624790668487549
Epoch: 9, Steps: 10 | Train Loss: 0.650 Vali Loss: 0.832 Vali Acc: 0.691 Test Loss: 0.832 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 1.4402894973754883
Epoch: 10, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.772 Vali Acc: 0.691 Test Loss: 0.772 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690782).  Saving model ...
Epoch: 11 cost time: 1.3375511169433594
Epoch: 11, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.716 Vali Acc: 0.730 Test Loss: 0.716 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730256).  Saving model ...
Epoch: 12 cost time: 1.4575893878936768
Epoch: 12, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.677 Vali Acc: 0.743 Test Loss: 0.677 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 1.1830501556396484
Epoch: 13, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.638 Vali Acc: 0.763 Test Loss: 0.638 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.196190357208252
Epoch: 14, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.604 Vali Acc: 0.763 Test Loss: 0.604 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.218299388885498
Epoch: 15, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.2058236598968506
Epoch: 16, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.2028882503509521
Epoch: 17, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.3197331428527832
Epoch: 18, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 1.234076976776123
Epoch: 19, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2146131992340088
Epoch: 20, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3226954936981201
Epoch: 21, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.496 Vali Acc: 0.776 Test Loss: 0.496 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2195854187011719
Epoch: 22, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3504865169525146
Epoch: 23, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.483 Vali Acc: 0.776 Test Loss: 0.483 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1944966316223145
Epoch: 24, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3841865062713623
Epoch: 25, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.474 Vali Acc: 0.789 Test Loss: 0.474 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3639936447143555
Epoch: 26, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809206).  Saving model ...
Epoch: 27 cost time: 1.1862249374389648
Epoch: 27, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.473 Vali Acc: 0.783 Test Loss: 0.473 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2823805809020996
Epoch: 28, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.473 Vali Acc: 0.789 Test Loss: 0.473 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2734861373901367
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0589823722839355
Epoch: 30, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.475 Vali Acc: 0.796 Test Loss: 0.475 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0890610218048096
Epoch: 31, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.471 Vali Acc: 0.796 Test Loss: 0.471 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.252288818359375
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.467 Vali Acc: 0.816 Test Loss: 0.467 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 33 cost time: 1.3680486679077148
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.468 Vali Acc: 0.809 Test Loss: 0.468 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2300024032592773
Epoch: 34, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.156010627746582
Epoch: 35, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.41025710105896
Epoch: 36, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3379595279693604
Epoch: 37, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.474 Vali Acc: 0.796 Test Loss: 0.474 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3785405158996582
Epoch: 38, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 39 cost time: 1.370882272720337
Epoch: 39, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.471 Vali Acc: 0.809 Test Loss: 0.471 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1260144710540771
Epoch: 40, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2018818855285645
Epoch: 41, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2658767700195312
Epoch: 42, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2329344749450684
Epoch: 43, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3350908756256104
Epoch: 44, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 45 cost time: 1.1171903610229492
Epoch: 45, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.346458911895752
Epoch: 46, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.24894118309021
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3743178844451904
Epoch: 48, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3371760845184326
Epoch: 49, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2450876235961914
Epoch: 50, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2599835395812988
Epoch: 51, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.5265851020812988
Epoch: 52, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.2795238494873047
Epoch: 53, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.240004539489746
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 60884
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2687184810638428
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.452 Vali Acc: 0.191 Test Loss: 1.452 Test Acc: 0.191
Validation loss decreased (inf --> -0.190775).  Saving model ...
Epoch: 2 cost time: 1.1418201923370361
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.402 Vali Acc: 0.309 Test Loss: 1.402 Test Acc: 0.309
Validation loss decreased (-0.190775 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.1732640266418457
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.336 Vali Acc: 0.388 Test Loss: 1.336 Test Acc: 0.388
Validation loss decreased (-0.309197 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 1.0539166927337646
Epoch: 4, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.266 Vali Acc: 0.428 Test Loss: 1.266 Test Acc: 0.428
Validation loss decreased (-0.388145 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 1.0688023567199707
Epoch: 5, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.189 Vali Acc: 0.487 Test Loss: 1.189 Test Acc: 0.487
Validation loss decreased (-0.427619 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 1.1638545989990234
Epoch: 6, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.113 Vali Acc: 0.546 Test Loss: 1.113 Test Acc: 0.546
Validation loss decreased (-0.486830 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 1.1562941074371338
Epoch: 7, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.043 Vali Acc: 0.592 Test Loss: 1.043 Test Acc: 0.592
Validation loss decreased (-0.546041 --> -0.592095).  Saving model ...
Epoch: 8 cost time: 1.3021855354309082
Epoch: 8, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.973 Vali Acc: 0.651 Test Loss: 0.973 Test Acc: 0.651
Validation loss decreased (-0.592095 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 1.1697804927825928
Epoch: 9, Steps: 10 | Train Loss: 0.757 Vali Loss: 0.910 Vali Acc: 0.651 Test Loss: 0.910 Test Acc: 0.651
Validation loss decreased (-0.651306 --> -0.651307).  Saving model ...
Epoch: 10 cost time: 1.330122470855713
Epoch: 10, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.847 Vali Acc: 0.664 Test Loss: 0.847 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664465).  Saving model ...
Epoch: 11 cost time: 1.4731409549713135
Epoch: 11, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.788 Vali Acc: 0.697 Test Loss: 0.788 Test Acc: 0.697
Validation loss decreased (-0.664465 --> -0.697361).  Saving model ...
Epoch: 12 cost time: 1.3861048221588135
Epoch: 12, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.743 Vali Acc: 0.691 Test Loss: 0.743 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4181427955627441
Epoch: 13, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.701 Vali Acc: 0.730 Test Loss: 0.701 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 14 cost time: 1.2941346168518066
Epoch: 14, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 1.2412538528442383
Epoch: 15, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.641 Vali Acc: 0.757 Test Loss: 0.641 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 1.2474372386932373
Epoch: 16, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.20546293258667
Epoch: 17, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.592 Vali Acc: 0.757 Test Loss: 0.592 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.239914894104004
Epoch: 18, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.572 Vali Acc: 0.750 Test Loss: 0.572 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1805098056793213
Epoch: 19, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.559 Vali Acc: 0.750 Test Loss: 0.559 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3073375225067139
Epoch: 20, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.550 Vali Acc: 0.750 Test Loss: 0.550 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.111600637435913
Epoch: 21, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.537 Vali Acc: 0.750 Test Loss: 0.537 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3587257862091064
Epoch: 22, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.526 Vali Acc: 0.757 Test Loss: 0.526 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3558070659637451
Epoch: 23, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769732).  Saving model ...
Epoch: 24 cost time: 1.3026559352874756
Epoch: 24, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.514 Vali Acc: 0.763 Test Loss: 0.514 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2335937023162842
Epoch: 25, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.504 Vali Acc: 0.750 Test Loss: 0.504 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1763205528259277
Epoch: 26, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.498 Vali Acc: 0.770 Test Loss: 0.498 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 27 cost time: 1.394099473953247
Epoch: 27, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.499 Vali Acc: 0.770 Test Loss: 0.499 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.313581943511963
Epoch: 28, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.497 Vali Acc: 0.776 Test Loss: 0.497 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 29 cost time: 1.2947866916656494
Epoch: 29, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 30 cost time: 1.2899260520935059
Epoch: 30, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.495 Vali Acc: 0.770 Test Loss: 0.495 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4303216934204102
Epoch: 31, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.486 Vali Acc: 0.776 Test Loss: 0.486 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 32 cost time: 1.191638708114624
Epoch: 32, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.486 Vali Acc: 0.783 Test Loss: 0.486 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 33 cost time: 1.3319361209869385
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.493 Vali Acc: 0.783 Test Loss: 0.493 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.461742877960205
Epoch: 34, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.488 Vali Acc: 0.776 Test Loss: 0.488 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3166720867156982
Epoch: 35, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 36 cost time: 1.372779369354248
Epoch: 36, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.499 Vali Acc: 0.776 Test Loss: 0.499 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3192307949066162
Epoch: 37, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.496 Vali Acc: 0.776 Test Loss: 0.496 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2146501541137695
Epoch: 38, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.381319522857666
Epoch: 39, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2441747188568115
Epoch: 40, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3305714130401611
Epoch: 41, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 42 cost time: 1.1876499652862549
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 43 cost time: 1.4059438705444336
Epoch: 43, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4370079040527344
Epoch: 44, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 45 cost time: 1.4813482761383057
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3324801921844482
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.5037081241607666
Epoch: 47, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3028650283813477
Epoch: 48, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3930799961090088
Epoch: 49, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3432347774505615
Epoch: 50, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.3841214179992676
Epoch: 51, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.3642165660858154
Epoch: 52, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.3011302947998047
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.5911946296691895
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 55 cost time: 1.12919282913208
Epoch: 55, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.3814542293548584
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.23236083984375
Epoch: 57, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.6323437690734863
Epoch: 58, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.3389499187469482
Epoch: 59, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.1636977195739746
Epoch: 60, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.2862286567687988
Epoch: 61, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.3195109367370605
Epoch: 62, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.3929266929626465
Epoch: 63, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.4593830108642578
Epoch: 64, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 60884
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.329948902130127
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.283 Vali Acc: 0.342 Test Loss: 1.283 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.32133150100708
Epoch: 2, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.224 Vali Acc: 0.434 Test Loss: 1.224 Test Acc: 0.434
Validation loss decreased (-0.342092 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.11824369430542
Epoch: 3, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.149 Vali Acc: 0.526 Test Loss: 1.149 Test Acc: 0.526
Validation loss decreased (-0.434198 --> -0.526304).  Saving model ...
Epoch: 4 cost time: 1.2614820003509521
Epoch: 4, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.070 Vali Acc: 0.559 Test Loss: 1.070 Test Acc: 0.559
Validation loss decreased (-0.526304 --> -0.559200).  Saving model ...
Epoch: 5 cost time: 1.1777374744415283
Epoch: 5, Steps: 10 | Train Loss: 0.988 Vali Loss: 0.987 Vali Acc: 0.592 Test Loss: 0.987 Test Acc: 0.592
Validation loss decreased (-0.559200 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 1.3114244937896729
Epoch: 6, Steps: 10 | Train Loss: 0.871 Vali Loss: 0.912 Vali Acc: 0.625 Test Loss: 0.912 Test Acc: 0.625
Validation loss decreased (-0.592095 --> -0.624991).  Saving model ...
Epoch: 7 cost time: 1.2870614528656006
Epoch: 7, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.841 Vali Acc: 0.651 Test Loss: 0.841 Test Acc: 0.651
Validation loss decreased (-0.624991 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 1.3007493019104004
Epoch: 8, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.785 Vali Acc: 0.704 Test Loss: 0.785 Test Acc: 0.704
Validation loss decreased (-0.651307 --> -0.703940).  Saving model ...
Epoch: 9 cost time: 1.2338860034942627
Epoch: 9, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.736 Vali Acc: 0.711 Test Loss: 0.736 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.2170591354370117
Epoch: 10, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.691 Vali Acc: 0.730 Test Loss: 0.691 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.4299371242523193
Epoch: 11, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.1159520149230957
Epoch: 12, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.3015422821044922
Epoch: 13, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.3433926105499268
Epoch: 14, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.584 Vali Acc: 0.750 Test Loss: 0.584 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.2164218425750732
Epoch: 15, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.575 Vali Acc: 0.750 Test Loss: 0.575 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 1.2540268898010254
Epoch: 16, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.2329554557800293
Epoch: 17, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.2094347476959229
Epoch: 18, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.1144561767578125
Epoch: 19, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.1913809776306152
Epoch: 20, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 1.0908644199371338
Epoch: 21, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3100533485412598
Epoch: 22, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.100985050201416
Epoch: 23, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 24 cost time: 1.0981040000915527
Epoch: 24, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.165700912475586
Epoch: 25, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 26 cost time: 1.1380951404571533
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3850817680358887
Epoch: 27, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2765402793884277
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 29 cost time: 1.3042998313903809
Epoch: 29, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4481515884399414
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.324655532836914
Epoch: 31, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2367253303527832
Epoch: 32, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4159183502197266
Epoch: 33, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4010021686553955
Epoch: 34, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2941021919250488
Epoch: 35, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1552152633666992
Epoch: 36, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4100170135498047
Epoch: 37, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1250097751617432
Epoch: 38, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 44500
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.421769380569458
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.286 Vali Acc: 0.434 Test Loss: 1.286 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 1.1062889099121094
Epoch: 2, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.230 Vali Acc: 0.461 Test Loss: 1.230 Test Acc: 0.461
Validation loss decreased (-0.434198 --> -0.460514).  Saving model ...
Epoch: 3 cost time: 1.3623607158660889
Epoch: 3, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.157 Vali Acc: 0.507 Test Loss: 1.157 Test Acc: 0.507
Validation loss decreased (-0.460514 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.2209668159484863
Epoch: 4, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.080 Vali Acc: 0.572 Test Loss: 1.080 Test Acc: 0.572
Validation loss decreased (-0.506567 --> -0.572358).  Saving model ...
Epoch: 5 cost time: 1.1464197635650635
Epoch: 5, Steps: 10 | Train Loss: 0.992 Vali Loss: 0.999 Vali Acc: 0.579 Test Loss: 0.999 Test Acc: 0.579
Validation loss decreased (-0.572358 --> -0.578937).  Saving model ...
Epoch: 6 cost time: 1.2795977592468262
Epoch: 6, Steps: 10 | Train Loss: 0.887 Vali Loss: 0.921 Vali Acc: 0.618 Test Loss: 0.921 Test Acc: 0.618
Validation loss decreased (-0.578937 --> -0.618412).  Saving model ...
Epoch: 7 cost time: 1.2227966785430908
Epoch: 7, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.846 Vali Acc: 0.658 Test Loss: 0.846 Test Acc: 0.658
Validation loss decreased (-0.618412 --> -0.657886).  Saving model ...
Epoch: 8 cost time: 1.4046990871429443
Epoch: 8, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.785 Vali Acc: 0.691 Test Loss: 0.785 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690782).  Saving model ...
Epoch: 9 cost time: 1.3254539966583252
Epoch: 9, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.731 Vali Acc: 0.711 Test Loss: 0.731 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.265458583831787
Epoch: 10, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.685 Vali Acc: 0.730 Test Loss: 0.685 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.2491590976715088
Epoch: 11, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.647 Vali Acc: 0.730 Test Loss: 0.647 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 12 cost time: 1.1469919681549072
Epoch: 12, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.617 Vali Acc: 0.750 Test Loss: 0.617 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.3436360359191895
Epoch: 13, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.589 Vali Acc: 0.750 Test Loss: 0.589 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.1509971618652344
Epoch: 14, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.570 Vali Acc: 0.730 Test Loss: 0.570 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3509953022003174
Epoch: 15, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1654071807861328
Epoch: 16, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763153).  Saving model ...
Epoch: 17 cost time: 1.2095317840576172
Epoch: 17, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 18 cost time: 1.3192470073699951
Epoch: 18, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 1.2067508697509766
Epoch: 19, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1675024032592773
Epoch: 20, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.233503818511963
Epoch: 21, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.316044807434082
Epoch: 22, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1188249588012695
Epoch: 23, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.180344581604004
Epoch: 24, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 25 cost time: 1.2355594635009766
Epoch: 25, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 26 cost time: 1.2152950763702393
Epoch: 26, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.492 Vali Acc: 0.789 Test Loss: 0.492 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3302531242370605
Epoch: 27, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.487 Vali Acc: 0.789 Test Loss: 0.487 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2807879447937012
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2241566181182861
Epoch: 29, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.488 Vali Acc: 0.789 Test Loss: 0.488 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2145860195159912
Epoch: 30, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3199000358581543
Epoch: 31, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.492 Vali Acc: 0.789 Test Loss: 0.492 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4638454914093018
Epoch: 32, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.489 Vali Acc: 0.783 Test Loss: 0.489 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.19822096824646
Epoch: 33, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.350595474243164
Epoch: 34, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3042316436767578
Epoch: 35, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 44500
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5759079456329346
Epoch: 1, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.290 Vali Acc: 0.395 Test Loss: 1.290 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 1.2296624183654785
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.238 Vali Acc: 0.493 Test Loss: 1.238 Test Acc: 0.493
Validation loss decreased (-0.394724 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 1.2171034812927246
Epoch: 3, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.171 Vali Acc: 0.546 Test Loss: 1.171 Test Acc: 0.546
Validation loss decreased (-0.493409 --> -0.546041).  Saving model ...
Epoch: 4 cost time: 1.1485214233398438
Epoch: 4, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.098 Vali Acc: 0.599 Test Loss: 1.098 Test Acc: 0.599
Validation loss decreased (-0.546041 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 1.1784334182739258
Epoch: 5, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.017 Vali Acc: 0.605 Test Loss: 1.017 Test Acc: 0.605
Validation loss decreased (-0.598673 --> -0.605253).  Saving model ...
Epoch: 6 cost time: 1.3273639678955078
Epoch: 6, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.938 Vali Acc: 0.658 Test Loss: 0.938 Test Acc: 0.658
Validation loss decreased (-0.605253 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 1.298555850982666
Epoch: 7, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.866 Vali Acc: 0.711 Test Loss: 0.866 Test Acc: 0.711
Validation loss decreased (-0.657885 --> -0.710518).  Saving model ...
Epoch: 8 cost time: 1.3360464572906494
Epoch: 8, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.807 Vali Acc: 0.743 Test Loss: 0.807 Test Acc: 0.743
Validation loss decreased (-0.710518 --> -0.743413).  Saving model ...
Epoch: 9 cost time: 1.296008825302124
Epoch: 9, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.750 Vali Acc: 0.743 Test Loss: 0.750 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743414).  Saving model ...
Epoch: 10 cost time: 1.2669949531555176
Epoch: 10, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.702 Vali Acc: 0.737 Test Loss: 0.702 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2004444599151611
Epoch: 11, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.661 Vali Acc: 0.743 Test Loss: 0.661 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.3450632095336914
Epoch: 12, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.627 Vali Acc: 0.750 Test Loss: 0.627 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.4621121883392334
Epoch: 13, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.1720221042633057
Epoch: 14, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.569 Vali Acc: 0.770 Test Loss: 0.569 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.4007267951965332
Epoch: 15, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.553 Vali Acc: 0.763 Test Loss: 0.553 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4042065143585205
Epoch: 16, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.3485448360443115
Epoch: 17, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3637568950653076
Epoch: 18, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 1.5244100093841553
Epoch: 19, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809206).  Saving model ...
Epoch: 20 cost time: 1.2219114303588867
Epoch: 20, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2103831768035889
Epoch: 21, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.469 Vali Acc: 0.803 Test Loss: 0.469 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1736197471618652
Epoch: 22, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 23 cost time: 1.2487547397613525
Epoch: 23, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 24 cost time: 1.1740996837615967
Epoch: 24, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.470 Vali Acc: 0.803 Test Loss: 0.470 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3283417224884033
Epoch: 25, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3305397033691406
Epoch: 26, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4709663391113281
Epoch: 27, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6256370544433594
Epoch: 28, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.459 Vali Acc: 0.829 Test Loss: 0.459 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 29 cost time: 1.2580022811889648
Epoch: 29, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.462 Vali Acc: 0.816 Test Loss: 0.462 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3369364738464355
Epoch: 30, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.468 Vali Acc: 0.809 Test Loss: 0.468 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4510486125946045
Epoch: 31, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.473 Vali Acc: 0.816 Test Loss: 0.473 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5337696075439453
Epoch: 32, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.472 Vali Acc: 0.816 Test Loss: 0.472 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5054919719696045
Epoch: 33, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2757461071014404
Epoch: 34, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4202139377593994
Epoch: 35, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.291724443435669
Epoch: 36, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5144670009613037
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3983464241027832
Epoch: 38, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 44500
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2647883892059326
Epoch: 1, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.345 Vali Acc: 0.329 Test Loss: 1.345 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.1941304206848145
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.302 Vali Acc: 0.375 Test Loss: 1.302 Test Acc: 0.375
Validation loss decreased (-0.328934 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.1945714950561523
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.242 Vali Acc: 0.441 Test Loss: 1.242 Test Acc: 0.441
Validation loss decreased (-0.374987 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 1.1407580375671387
Epoch: 4, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.181 Vali Acc: 0.474 Test Loss: 1.181 Test Acc: 0.474
Validation loss decreased (-0.440777 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 1.3649334907531738
Epoch: 5, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.109 Vali Acc: 0.553 Test Loss: 1.109 Test Acc: 0.553
Validation loss decreased (-0.473672 --> -0.552620).  Saving model ...
Epoch: 6 cost time: 1.2929813861846924
Epoch: 6, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.040 Vali Acc: 0.618 Test Loss: 1.040 Test Acc: 0.618
Validation loss decreased (-0.552620 --> -0.618411).  Saving model ...
Epoch: 7 cost time: 1.2288720607757568
Epoch: 7, Steps: 10 | Train Loss: 0.845 Vali Loss: 0.973 Vali Acc: 0.638 Test Loss: 0.973 Test Acc: 0.638
Validation loss decreased (-0.618411 --> -0.638148).  Saving model ...
Epoch: 8 cost time: 1.196117877960205
Epoch: 8, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.911 Vali Acc: 0.658 Test Loss: 0.911 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657886).  Saving model ...
Epoch: 9 cost time: 1.2965004444122314
Epoch: 9, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.851 Vali Acc: 0.678 Test Loss: 0.851 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 10 cost time: 1.226574420928955
Epoch: 10, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.796 Vali Acc: 0.671 Test Loss: 0.796 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2608919143676758
Epoch: 11, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.751 Vali Acc: 0.704 Test Loss: 0.751 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703940).  Saving model ...
Epoch: 12 cost time: 1.1961259841918945
Epoch: 12, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.704 Vali Acc: 0.757 Test Loss: 0.704 Test Acc: 0.757
Validation loss decreased (-0.703940 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 1.1422374248504639
Epoch: 13, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 1.2919495105743408
Epoch: 14, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.634 Vali Acc: 0.770 Test Loss: 0.634 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.3122475147247314
Epoch: 15, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.612 Vali Acc: 0.757 Test Loss: 0.612 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3237521648406982
Epoch: 16, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.590 Vali Acc: 0.770 Test Loss: 0.590 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 17 cost time: 1.2440648078918457
Epoch: 17, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.3111522197723389
Epoch: 18, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4041988849639893
Epoch: 19, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.263721227645874
Epoch: 20, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2625188827514648
Epoch: 21, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.516 Vali Acc: 0.776 Test Loss: 0.516 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2097046375274658
Epoch: 22, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.508 Vali Acc: 0.770 Test Loss: 0.508 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2907872200012207
Epoch: 23, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.507 Vali Acc: 0.776 Test Loss: 0.507 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2789793014526367
Epoch: 24, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 25 cost time: 1.1895968914031982
Epoch: 25, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.495 Vali Acc: 0.783 Test Loss: 0.495 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 26 cost time: 1.154085636138916
Epoch: 26, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
Validation loss decreased (-0.782890 --> -0.809205).  Saving model ...
Epoch: 27 cost time: 1.232297420501709
Epoch: 27, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.487 Vali Acc: 0.789 Test Loss: 0.487 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1305832862854004
Epoch: 28, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3570988178253174
Epoch: 29, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2235689163208008
Epoch: 30, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.224043607711792
Epoch: 31, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.278615951538086
Epoch: 32, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.485 Vali Acc: 0.796 Test Loss: 0.485 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2967033386230469
Epoch: 33, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3778493404388428
Epoch: 34, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.495 Vali Acc: 0.789 Test Loss: 0.495 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.318708896636963
Epoch: 35, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1852350234985352
Epoch: 36, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 44500
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4668140411376953
Epoch: 1, Steps: 10 | Train Loss: 1.575 Vali Loss: 1.408 Vali Acc: 0.224 Test Loss: 1.408 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.2693817615509033
Epoch: 2, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.371 Vali Acc: 0.276 Test Loss: 1.371 Test Acc: 0.276
Validation loss decreased (-0.223670 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 1.3309879302978516
Epoch: 3, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.321 Vali Acc: 0.336 Test Loss: 1.321 Test Acc: 0.336
Validation loss decreased (-0.276302 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.0357897281646729
Epoch: 4, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.272 Vali Acc: 0.421 Test Loss: 1.272 Test Acc: 0.421
Validation loss decreased (-0.335513 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 1.2832353115081787
Epoch: 5, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.212 Vali Acc: 0.513 Test Loss: 1.212 Test Acc: 0.513
Validation loss decreased (-0.421040 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 1.29618239402771
Epoch: 6, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.154 Vali Acc: 0.579 Test Loss: 1.154 Test Acc: 0.579
Validation loss decreased (-0.513146 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 1.123060941696167
Epoch: 7, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.097 Vali Acc: 0.612 Test Loss: 1.097 Test Acc: 0.612
Validation loss decreased (-0.578936 --> -0.611831).  Saving model ...
Epoch: 8 cost time: 1.2456169128417969
Epoch: 8, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.040 Vali Acc: 0.645 Test Loss: 1.040 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644726).  Saving model ...
Epoch: 9 cost time: 1.355456829071045
Epoch: 9, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.981 Vali Acc: 0.671 Test Loss: 0.981 Test Acc: 0.671
Validation loss decreased (-0.644726 --> -0.671043).  Saving model ...
Epoch: 10 cost time: 1.2491459846496582
Epoch: 10, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.929 Vali Acc: 0.664 Test Loss: 0.929 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3681366443634033
Epoch: 11, Steps: 10 | Train Loss: 0.724 Vali Loss: 0.882 Vali Acc: 0.711 Test Loss: 0.882 Test Acc: 0.711
Validation loss decreased (-0.671043 --> -0.710517).  Saving model ...
Epoch: 12 cost time: 1.2719700336456299
Epoch: 12, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.836 Vali Acc: 0.724 Test Loss: 0.836 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723676).  Saving model ...
Epoch: 13 cost time: 1.2875630855560303
Epoch: 13, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.791 Vali Acc: 0.743 Test Loss: 0.791 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743413).  Saving model ...
Epoch: 14 cost time: 1.2665178775787354
Epoch: 14, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.757 Vali Acc: 0.763 Test Loss: 0.757 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 15 cost time: 1.4512195587158203
Epoch: 15, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.728 Vali Acc: 0.750 Test Loss: 0.728 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3193833827972412
Epoch: 16, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.699 Vali Acc: 0.757 Test Loss: 0.699 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.319575548171997
Epoch: 17, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.671 Vali Acc: 0.770 Test Loss: 0.671 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769730).  Saving model ...
Epoch: 18 cost time: 1.2123756408691406
Epoch: 18, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.650 Vali Acc: 0.763 Test Loss: 0.650 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2193078994750977
Epoch: 19, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 1.2486777305603027
Epoch: 20, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 21 cost time: 1.2772934436798096
Epoch: 21, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3941152095794678
Epoch: 22, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2984280586242676
Epoch: 23, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.230290174484253
Epoch: 24, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 25 cost time: 1.2312545776367188
Epoch: 25, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 26 cost time: 1.1237752437591553
Epoch: 26, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 27 cost time: 1.196472406387329
Epoch: 27, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 28 cost time: 1.0237042903900146
Epoch: 28, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.124553918838501
Epoch: 29, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.520 Vali Acc: 0.829 Test Loss: 0.520 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 30 cost time: 1.3505947589874268
Epoch: 30, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2716665267944336
Epoch: 31, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.182504653930664
Epoch: 32, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2612457275390625
Epoch: 33, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2968225479125977
Epoch: 34, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1692185401916504
Epoch: 35, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.294154167175293
Epoch: 36, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3305788040161133
Epoch: 37, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1385774612426758
Epoch: 38, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2848107814788818
Epoch: 39, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.504 Vali Acc: 0.822 Test Loss: 0.504 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 272148
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2938344478607178
Epoch: 1, Steps: 10 | Train Loss: 1.570 Vali Loss: 1.412 Vali Acc: 0.243 Test Loss: 1.412 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.1814017295837402
Epoch: 2, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.371 Vali Acc: 0.316 Test Loss: 1.371 Test Acc: 0.316
Validation loss decreased (-0.243407 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.280203104019165
Epoch: 3, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.321 Vali Acc: 0.355 Test Loss: 1.321 Test Acc: 0.355
Validation loss decreased (-0.315776 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.2387535572052002
Epoch: 4, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.268 Vali Acc: 0.474 Test Loss: 1.268 Test Acc: 0.474
Validation loss decreased (-0.355250 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 1.2565131187438965
Epoch: 5, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.210 Vali Acc: 0.526 Test Loss: 1.210 Test Acc: 0.526
Validation loss decreased (-0.473672 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 1.3136858940124512
Epoch: 6, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.154 Vali Acc: 0.579 Test Loss: 1.154 Test Acc: 0.579
Validation loss decreased (-0.526304 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 1.106614112854004
Epoch: 7, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.092 Vali Acc: 0.632 Test Loss: 1.092 Test Acc: 0.632
Validation loss decreased (-0.578936 --> -0.631568).  Saving model ...
Epoch: 8 cost time: 1.1668827533721924
Epoch: 8, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.036 Vali Acc: 0.651 Test Loss: 1.036 Test Acc: 0.651
Validation loss decreased (-0.631568 --> -0.651305).  Saving model ...
Epoch: 9 cost time: 1.1576662063598633
Epoch: 9, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.979 Vali Acc: 0.684 Test Loss: 0.979 Test Acc: 0.684
Validation loss decreased (-0.651305 --> -0.684201).  Saving model ...
Epoch: 10 cost time: 1.1284587383270264
Epoch: 10, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.925 Vali Acc: 0.737 Test Loss: 0.925 Test Acc: 0.737
Validation loss decreased (-0.684201 --> -0.736833).  Saving model ...
Epoch: 11 cost time: 1.0857141017913818
Epoch: 11, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.876 Vali Acc: 0.730 Test Loss: 0.876 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.487328052520752
Epoch: 12, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.833 Vali Acc: 0.743 Test Loss: 0.833 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743413).  Saving model ...
Epoch: 13 cost time: 1.2936294078826904
Epoch: 13, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.791 Vali Acc: 0.770 Test Loss: 0.791 Test Acc: 0.770
Validation loss decreased (-0.743413 --> -0.769729).  Saving model ...
Epoch: 14 cost time: 1.3996086120605469
Epoch: 14, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.754 Vali Acc: 0.789 Test Loss: 0.754 Test Acc: 0.789
Validation loss decreased (-0.769729 --> -0.789466).  Saving model ...
Epoch: 15 cost time: 1.386312484741211
Epoch: 15, Steps: 10 | Train Loss: 0.569 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3183088302612305
Epoch: 16, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.690 Vali Acc: 0.789 Test Loss: 0.690 Test Acc: 0.789
Validation loss decreased (-0.789466 --> -0.789467).  Saving model ...
Epoch: 17 cost time: 1.3489313125610352
Epoch: 17, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.664 Vali Acc: 0.789 Test Loss: 0.664 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 18 cost time: 1.2509925365447998
Epoch: 18, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.646 Vali Acc: 0.816 Test Loss: 0.646 Test Acc: 0.816
Validation loss decreased (-0.789467 --> -0.815783).  Saving model ...
Epoch: 19 cost time: 1.3447000980377197
Epoch: 19, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1896944046020508
Epoch: 20, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.614 Vali Acc: 0.822 Test Loss: 0.614 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 21 cost time: 1.221285104751587
Epoch: 21, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.598 Vali Acc: 0.816 Test Loss: 0.598 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2230322360992432
Epoch: 22, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.591 Vali Acc: 0.816 Test Loss: 0.591 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1866726875305176
Epoch: 23, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3575775623321533
Epoch: 24, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.565 Vali Acc: 0.829 Test Loss: 0.565 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828942).  Saving model ...
Epoch: 25 cost time: 1.2947919368743896
Epoch: 25, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3458309173583984
Epoch: 26, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3028638362884521
Epoch: 27, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2598717212677002
Epoch: 28, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.426603078842163
Epoch: 29, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2767994403839111
Epoch: 30, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3331522941589355
Epoch: 31, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.221940040588379
Epoch: 32, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1888291835784912
Epoch: 33, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1766765117645264
Epoch: 34, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.519 Vali Acc: 0.829 Test Loss: 0.519 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 35 cost time: 1.37440824508667
Epoch: 35, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2289550304412842
Epoch: 36, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2812223434448242
Epoch: 37, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.516 Vali Acc: 0.836 Test Loss: 0.516 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 38 cost time: 1.3353867530822754
Epoch: 38, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.384756326675415
Epoch: 39, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.226332664489746
Epoch: 40, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.205458402633667
Epoch: 41, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2705471515655518
Epoch: 42, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1826982498168945
Epoch: 43, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.194169521331787
Epoch: 44, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2042477130889893
Epoch: 45, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.189732313156128
Epoch: 46, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.178483486175537
Epoch: 47, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 272148
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4063615798950195
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.436 Vali Acc: 0.224 Test Loss: 1.436 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.0836012363433838
Epoch: 2, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
Validation loss decreased (-0.223670 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.1072659492492676
Epoch: 3, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.347 Vali Acc: 0.342 Test Loss: 1.347 Test Acc: 0.342
Validation loss decreased (-0.269723 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.1878304481506348
Epoch: 4, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.296 Vali Acc: 0.408 Test Loss: 1.296 Test Acc: 0.408
Validation loss decreased (-0.342092 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 1.2368085384368896
Epoch: 5, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.238 Vali Acc: 0.513 Test Loss: 1.238 Test Acc: 0.513
Validation loss decreased (-0.407882 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 1.1884312629699707
Epoch: 6, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.180 Vali Acc: 0.579 Test Loss: 1.180 Test Acc: 0.579
Validation loss decreased (-0.513146 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 1.179076910018921
Epoch: 7, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.117 Vali Acc: 0.572 Test Loss: 1.117 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3305768966674805
Epoch: 8, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.063 Vali Acc: 0.632 Test Loss: 1.063 Test Acc: 0.632
Validation loss decreased (-0.578936 --> -0.631568).  Saving model ...
Epoch: 9 cost time: 1.2068464756011963
Epoch: 9, Steps: 10 | Train Loss: 0.914 Vali Loss: 0.998 Vali Acc: 0.632 Test Loss: 0.998 Test Acc: 0.632
Validation loss decreased (-0.631568 --> -0.631569).  Saving model ...
Epoch: 10 cost time: 1.297166109085083
Epoch: 10, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.935 Vali Acc: 0.717 Test Loss: 0.935 Test Acc: 0.717
Validation loss decreased (-0.631569 --> -0.717096).  Saving model ...
Epoch: 11 cost time: 1.079637050628662
Epoch: 11, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.888 Vali Acc: 0.724 Test Loss: 0.888 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 12 cost time: 1.2914743423461914
Epoch: 12, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.843 Vali Acc: 0.743 Test Loss: 0.843 Test Acc: 0.743
Validation loss decreased (-0.723675 --> -0.743413).  Saving model ...
Epoch: 13 cost time: 1.2150242328643799
Epoch: 13, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.796 Vali Acc: 0.763 Test Loss: 0.796 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 14 cost time: 1.3527512550354004
Epoch: 14, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.759 Vali Acc: 0.763 Test Loss: 0.759 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763150).  Saving model ...
Epoch: 15 cost time: 1.1212501525878906
Epoch: 15, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
Validation loss decreased (-0.763150 --> -0.782888).  Saving model ...
Epoch: 16 cost time: 1.11232590675354
Epoch: 16, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 17 cost time: 1.1666772365570068
Epoch: 17, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 18 cost time: 1.3070626258850098
Epoch: 18, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 19 cost time: 1.3443958759307861
Epoch: 19, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 20 cost time: 1.2787063121795654
Epoch: 20, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.1584148406982422
Epoch: 21, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1783473491668701
Epoch: 22, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2956547737121582
Epoch: 23, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2499606609344482
Epoch: 24, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2412309646606445
Epoch: 25, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.26735258102417
Epoch: 26, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2670700550079346
Epoch: 27, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2645375728607178
Epoch: 28, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2610816955566406
Epoch: 29, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.259847640991211
Epoch: 30, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.478 Vali Acc: 0.796 Test Loss: 0.478 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 272148
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1392529010772705
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.407 Vali Acc: 0.224 Test Loss: 1.407 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.164569616317749
Epoch: 2, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.373 Vali Acc: 0.257 Test Loss: 1.373 Test Acc: 0.257
Validation loss decreased (-0.223670 --> -0.256565).  Saving model ...
Epoch: 3 cost time: 1.3115296363830566
Epoch: 3, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.327 Vali Acc: 0.355 Test Loss: 1.327 Test Acc: 0.355
Validation loss decreased (-0.256565 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.2703027725219727
Epoch: 4, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.281 Vali Acc: 0.474 Test Loss: 1.281 Test Acc: 0.474
Validation loss decreased (-0.355250 --> -0.473671).  Saving model ...
Epoch: 5 cost time: 1.2283070087432861
Epoch: 5, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.230 Vali Acc: 0.520 Test Loss: 1.230 Test Acc: 0.520
Validation loss decreased (-0.473671 --> -0.519725).  Saving model ...
Epoch: 6 cost time: 1.1824696063995361
Epoch: 6, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.176 Vali Acc: 0.559 Test Loss: 1.176 Test Acc: 0.559
Validation loss decreased (-0.519725 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 1.2394781112670898
Epoch: 7, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.117 Vali Acc: 0.592 Test Loss: 1.117 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 1.269092321395874
Epoch: 8, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.063 Vali Acc: 0.632 Test Loss: 1.063 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631568).  Saving model ...
Epoch: 9 cost time: 1.2409756183624268
Epoch: 9, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.004 Vali Acc: 0.704 Test Loss: 1.004 Test Acc: 0.704
Validation loss decreased (-0.631568 --> -0.703937).  Saving model ...
Epoch: 10 cost time: 1.4044091701507568
Epoch: 10, Steps: 10 | Train Loss: 0.887 Vali Loss: 0.946 Vali Acc: 0.711 Test Loss: 0.946 Test Acc: 0.711
Validation loss decreased (-0.703937 --> -0.710517).  Saving model ...
Epoch: 11 cost time: 1.0416996479034424
Epoch: 11, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.894 Vali Acc: 0.737 Test Loss: 0.894 Test Acc: 0.737
Validation loss decreased (-0.710517 --> -0.736833).  Saving model ...
Epoch: 12 cost time: 1.1772010326385498
Epoch: 12, Steps: 10 | Train Loss: 0.776 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
Validation loss decreased (-0.736833 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 1.0866992473602295
Epoch: 13, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.805 Vali Acc: 0.770 Test Loss: 0.805 Test Acc: 0.770
Validation loss decreased (-0.749992 --> -0.769729).  Saving model ...
Epoch: 14 cost time: 1.3017370700836182
Epoch: 14, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782887).  Saving model ...
Epoch: 15 cost time: 1.1098971366882324
Epoch: 15, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
Validation loss decreased (-0.782887 --> -0.802624).  Saving model ...
Epoch: 16 cost time: 1.206650972366333
Epoch: 16, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.690 Vali Acc: 0.809 Test Loss: 0.690 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809204).  Saving model ...
Epoch: 17 cost time: 1.1035373210906982
Epoch: 17, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.664 Vali Acc: 0.796 Test Loss: 0.664 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1118090152740479
Epoch: 18, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.630 Vali Acc: 0.816 Test Loss: 0.630 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 19 cost time: 1.3628125190734863
Epoch: 19, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 20 cost time: 1.1664040088653564
Epoch: 20, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1449229717254639
Epoch: 21, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
Validation loss decreased (-0.822362 --> -0.822363).  Saving model ...
Epoch: 22 cost time: 1.1541204452514648
Epoch: 22, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3299102783203125
Epoch: 23, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.355821132659912
Epoch: 24, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3019399642944336
Epoch: 25, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.161245346069336
Epoch: 26, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2298645973205566
Epoch: 27, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3830242156982422
Epoch: 28, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.147691011428833
Epoch: 29, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 30 cost time: 1.2232012748718262
Epoch: 30, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 31 cost time: 1.1983118057250977
Epoch: 31, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.474 Vali Acc: 0.822 Test Loss: 0.474 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 32 cost time: 1.101708173751831
Epoch: 32, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.182387113571167
Epoch: 33, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 34 cost time: 1.1768815517425537
Epoch: 34, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.461 Vali Acc: 0.803 Test Loss: 0.461 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1462442874908447
Epoch: 35, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.156987190246582
Epoch: 36, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.451 Vali Acc: 0.816 Test Loss: 0.451 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2404601573944092
Epoch: 37, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3086888790130615
Epoch: 38, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1526293754577637
Epoch: 39, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2111036777496338
Epoch: 40, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.335935354232788
Epoch: 41, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2257945537567139
Epoch: 42, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.229043960571289
Epoch: 43, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.467 Vali Acc: 0.816 Test Loss: 0.467 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 272148
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.578004837036133
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.388 Vali Acc: 0.283 Test Loss: 1.388 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.2950019836425781
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.359 Vali Acc: 0.289 Test Loss: 1.359 Test Acc: 0.289
Validation loss decreased (-0.282881 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 1.1864876747131348
Epoch: 3, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.318 Vali Acc: 0.362 Test Loss: 1.318 Test Acc: 0.362
Validation loss decreased (-0.289460 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.1008820533752441
Epoch: 4, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.275 Vali Acc: 0.421 Test Loss: 1.275 Test Acc: 0.421
Validation loss decreased (-0.361829 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 1.363142967224121
Epoch: 5, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.222 Vali Acc: 0.474 Test Loss: 1.222 Test Acc: 0.474
Validation loss decreased (-0.421040 --> -0.473672).  Saving model ...
Epoch: 6 cost time: 1.2378251552581787
Epoch: 6, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.473672 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.1456823348999023
Epoch: 7, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
Validation loss decreased (-0.499988 --> -0.532884).  Saving model ...
Epoch: 8 cost time: 1.2426257133483887
Epoch: 8, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.064 Vali Acc: 0.539 Test Loss: 1.064 Test Acc: 0.539
Validation loss decreased (-0.532884 --> -0.539463).  Saving model ...
Epoch: 9 cost time: 1.163989543914795
Epoch: 9, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.024 Vali Acc: 0.572 Test Loss: 1.024 Test Acc: 0.572
Validation loss decreased (-0.539463 --> -0.572358).  Saving model ...
Epoch: 10 cost time: 1.193530797958374
Epoch: 10, Steps: 10 | Train Loss: 0.849 Vali Loss: 0.977 Vali Acc: 0.599 Test Loss: 0.977 Test Acc: 0.599
Validation loss decreased (-0.572358 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 1.324568510055542
Epoch: 11, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.935 Vali Acc: 0.618 Test Loss: 0.935 Test Acc: 0.618
Validation loss decreased (-0.598674 --> -0.618412).  Saving model ...
Epoch: 12 cost time: 1.2853937149047852
Epoch: 12, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.889 Vali Acc: 0.645 Test Loss: 0.889 Test Acc: 0.645
Validation loss decreased (-0.618412 --> -0.644728).  Saving model ...
Epoch: 13 cost time: 1.1505982875823975
Epoch: 13, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.841 Vali Acc: 0.664 Test Loss: 0.841 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664465).  Saving model ...
Epoch: 14 cost time: 1.3080599308013916
Epoch: 14, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.804 Vali Acc: 0.684 Test Loss: 0.804 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 15 cost time: 1.2568297386169434
Epoch: 15, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.779 Vali Acc: 0.704 Test Loss: 0.779 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 1.20051908493042
Epoch: 16, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.747 Vali Acc: 0.717 Test Loss: 0.747 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 17 cost time: 1.3301782608032227
Epoch: 17, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749993).  Saving model ...
Epoch: 18 cost time: 1.0975279808044434
Epoch: 18, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.696 Vali Acc: 0.750 Test Loss: 0.696 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 19 cost time: 1.3116507530212402
Epoch: 19, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 1.147994041442871
Epoch: 20, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 21 cost time: 1.2914612293243408
Epoch: 21, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 1.2749607563018799
Epoch: 22, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 23 cost time: 1.1319506168365479
Epoch: 23, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 24 cost time: 1.2323172092437744
Epoch: 24, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 25 cost time: 1.176114559173584
Epoch: 25, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 26 cost time: 1.1435327529907227
Epoch: 26, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 27 cost time: 1.0697486400604248
Epoch: 27, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 28 cost time: 1.2194392681121826
Epoch: 28, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 29 cost time: 1.0219357013702393
Epoch: 29, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.201850175857544
Epoch: 30, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1696250438690186
Epoch: 31, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.164621353149414
Epoch: 32, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2465450763702393
Epoch: 33, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.535 Vali Acc: 0.829 Test Loss: 0.535 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828942).  Saving model ...
Epoch: 34 cost time: 1.1428260803222656
Epoch: 34, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2333664894104004
Epoch: 35, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2508599758148193
Epoch: 36, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2436480522155762
Epoch: 37, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1457889080047607
Epoch: 38, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.217897653579712
Epoch: 39, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.512 Vali Acc: 0.829 Test Loss: 0.512 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 40 cost time: 1.3542444705963135
Epoch: 40, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 41 cost time: 1.2458946704864502
Epoch: 41, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.268202543258667
Epoch: 42, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.516 Vali Acc: 0.829 Test Loss: 0.516 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2910959720611572
Epoch: 43, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.516 Vali Acc: 0.829 Test Loss: 0.516 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2420287132263184
Epoch: 44, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2372791767120361
Epoch: 45, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.533 Vali Acc: 0.829 Test Loss: 0.533 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1681585311889648
Epoch: 46, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.534 Vali Acc: 0.829 Test Loss: 0.534 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3029420375823975
Epoch: 47, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.530 Vali Acc: 0.829 Test Loss: 0.530 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0844905376434326
Epoch: 48, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1122791767120361
Epoch: 49, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.519 Vali Acc: 0.829 Test Loss: 0.519 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.242990255355835
Epoch: 50, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.529 Vali Acc: 0.829 Test Loss: 0.529 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 141076
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.722914934158325
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.388 Vali Acc: 0.296 Test Loss: 1.388 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.302495002746582
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.361 Vali Acc: 0.322 Test Loss: 1.361 Test Acc: 0.322
Validation loss decreased (-0.296039 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.1594431400299072
Epoch: 3, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.320 Vali Acc: 0.375 Test Loss: 1.320 Test Acc: 0.375
Validation loss decreased (-0.322355 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.2793834209442139
Epoch: 4, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.273 Vali Acc: 0.408 Test Loss: 1.273 Test Acc: 0.408
Validation loss decreased (-0.374987 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 1.2682523727416992
Epoch: 5, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.222 Vali Acc: 0.507 Test Loss: 1.222 Test Acc: 0.507
Validation loss decreased (-0.407882 --> -0.506567).  Saving model ...
Epoch: 6 cost time: 1.3492100238800049
Epoch: 6, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.168 Vali Acc: 0.539 Test Loss: 1.168 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 1.4184753894805908
Epoch: 7, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.113 Vali Acc: 0.579 Test Loss: 1.113 Test Acc: 0.579
Validation loss decreased (-0.539462 --> -0.578936).  Saving model ...
Epoch: 8 cost time: 1.2885313034057617
Epoch: 8, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.058 Vali Acc: 0.572 Test Loss: 1.058 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2168145179748535
Epoch: 9, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.013 Vali Acc: 0.612 Test Loss: 1.013 Test Acc: 0.612
Validation loss decreased (-0.578936 --> -0.611832).  Saving model ...
Epoch: 10 cost time: 1.2176618576049805
Epoch: 10, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.967 Vali Acc: 0.612 Test Loss: 0.967 Test Acc: 0.612
Validation loss decreased (-0.611832 --> -0.611832).  Saving model ...
Epoch: 11 cost time: 1.1989309787750244
Epoch: 11, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.920 Vali Acc: 0.632 Test Loss: 0.920 Test Acc: 0.632
Validation loss decreased (-0.611832 --> -0.631570).  Saving model ...
Epoch: 12 cost time: 1.1701993942260742
Epoch: 12, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.874 Vali Acc: 0.658 Test Loss: 0.874 Test Acc: 0.658
Validation loss decreased (-0.631570 --> -0.657886).  Saving model ...
Epoch: 13 cost time: 1.1895034313201904
Epoch: 13, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.826 Vali Acc: 0.678 Test Loss: 0.826 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 14 cost time: 1.3754208087921143
Epoch: 14, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.786 Vali Acc: 0.717 Test Loss: 0.786 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717097).  Saving model ...
Epoch: 15 cost time: 1.1698100566864014
Epoch: 15, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.758 Vali Acc: 0.743 Test Loss: 0.758 Test Acc: 0.743
Validation loss decreased (-0.717097 --> -0.743413).  Saving model ...
Epoch: 16 cost time: 1.3460030555725098
Epoch: 16, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.729 Vali Acc: 0.743 Test Loss: 0.729 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743414).  Saving model ...
Epoch: 17 cost time: 1.1650288105010986
Epoch: 17, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.700 Vali Acc: 0.757 Test Loss: 0.700 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 18 cost time: 1.2253961563110352
Epoch: 18, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.678 Vali Acc: 0.770 Test Loss: 0.678 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 19 cost time: 1.1498868465423584
Epoch: 19, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 1.2338361740112305
Epoch: 20, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.633 Vali Acc: 0.776 Test Loss: 0.633 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.423353672027588
Epoch: 21, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 22 cost time: 1.3272743225097656
Epoch: 22, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 1.2127435207366943
Epoch: 23, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 24 cost time: 1.2839007377624512
Epoch: 24, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2893083095550537
Epoch: 25, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2460565567016602
Epoch: 26, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 27 cost time: 1.1549263000488281
Epoch: 27, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 28 cost time: 1.2676928043365479
Epoch: 28, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 29 cost time: 1.2604680061340332
Epoch: 29, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1065044403076172
Epoch: 30, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3903849124908447
Epoch: 31, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5589656829833984
Epoch: 32, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 33 cost time: 1.2707338333129883
Epoch: 33, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3875024318695068
Epoch: 34, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 35 cost time: 1.2256371974945068
Epoch: 35, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2868843078613281
Epoch: 36, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2912135124206543
Epoch: 37, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 38 cost time: 1.343592882156372
Epoch: 38, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1661736965179443
Epoch: 39, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2289173603057861
Epoch: 40, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.478409767150879
Epoch: 41, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2190444469451904
Epoch: 42, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2634382247924805
Epoch: 43, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 44 cost time: 1.2285962104797363
Epoch: 44, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 45 cost time: 1.1588468551635742
Epoch: 45, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 46 cost time: 1.1269006729125977
Epoch: 46, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 47 cost time: 1.1722383499145508
Epoch: 47, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.534 Vali Acc: 0.829 Test Loss: 0.534 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 48 cost time: 1.0560297966003418
Epoch: 48, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2132649421691895
Epoch: 49, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.338860034942627
Epoch: 50, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1567318439483643
Epoch: 51, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2850489616394043
Epoch: 52, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.3743278980255127
Epoch: 53, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.171675682067871
Epoch: 54, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.1900603771209717
Epoch: 55, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.184356927871704
Epoch: 56, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.1255581378936768
Epoch: 57, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 141076
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1553561687469482
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.358 Vali Acc: 0.362 Test Loss: 1.358 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 1.0926477909088135
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.330 Vali Acc: 0.382 Test Loss: 1.330 Test Acc: 0.382
Validation loss decreased (-0.361829 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.1225981712341309
Epoch: 3, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.295 Vali Acc: 0.414 Test Loss: 1.295 Test Acc: 0.414
Validation loss decreased (-0.381566 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.023256778717041
Epoch: 4, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.254 Vali Acc: 0.447 Test Loss: 1.254 Test Acc: 0.447
Validation loss decreased (-0.414461 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 1.116290807723999
Epoch: 5, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.202 Vali Acc: 0.493 Test Loss: 1.202 Test Acc: 0.493
Validation loss decreased (-0.447356 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 1.2251403331756592
Epoch: 6, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.156 Vali Acc: 0.526 Test Loss: 1.156 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526304).  Saving model ...
Epoch: 7 cost time: 1.118943214416504
Epoch: 7, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.100 Vali Acc: 0.566 Test Loss: 1.100 Test Acc: 0.566
Validation loss decreased (-0.526304 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 1.277050495147705
Epoch: 8, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.050 Vali Acc: 0.592 Test Loss: 1.050 Test Acc: 0.592
Validation loss decreased (-0.565778 --> -0.592095).  Saving model ...
Epoch: 9 cost time: 1.1057093143463135
Epoch: 9, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.005 Vali Acc: 0.638 Test Loss: 1.005 Test Acc: 0.638
Validation loss decreased (-0.592095 --> -0.638148).  Saving model ...
Epoch: 10 cost time: 1.1282684803009033
Epoch: 10, Steps: 10 | Train Loss: 0.882 Vali Loss: 0.954 Vali Acc: 0.651 Test Loss: 0.954 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 1.217482566833496
Epoch: 11, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.914 Vali Acc: 0.664 Test Loss: 0.914 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664465).  Saving model ...
Epoch: 12 cost time: 1.3009552955627441
Epoch: 12, Steps: 10 | Train Loss: 0.741 Vali Loss: 0.867 Vali Acc: 0.684 Test Loss: 0.867 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 13 cost time: 1.1997389793395996
Epoch: 13, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.823 Vali Acc: 0.711 Test Loss: 0.823 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710518).  Saving model ...
Epoch: 14 cost time: 1.135709524154663
Epoch: 14, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.783 Vali Acc: 0.730 Test Loss: 0.783 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 1.2039530277252197
Epoch: 15, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.755 Vali Acc: 0.724 Test Loss: 0.755 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3367371559143066
Epoch: 16, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.724 Vali Acc: 0.763 Test Loss: 0.724 Test Acc: 0.763
Validation loss decreased (-0.730255 --> -0.763151).  Saving model ...
Epoch: 17 cost time: 1.2393791675567627
Epoch: 17, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.698 Vali Acc: 0.763 Test Loss: 0.698 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 18 cost time: 1.1255924701690674
Epoch: 18, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.675 Vali Acc: 0.757 Test Loss: 0.675 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0243456363677979
Epoch: 19, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.650 Vali Acc: 0.776 Test Loss: 0.650 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 20 cost time: 1.038508415222168
Epoch: 20, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 21 cost time: 1.0303006172180176
Epoch: 21, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.615 Vali Acc: 0.770 Test Loss: 0.615 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1697781085968018
Epoch: 22, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.3526010513305664
Epoch: 23, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 24 cost time: 1.2000455856323242
Epoch: 24, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2521369457244873
Epoch: 25, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 26 cost time: 1.2830207347869873
Epoch: 26, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2911171913146973
Epoch: 27, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3566665649414062
Epoch: 28, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 29 cost time: 1.1428465843200684
Epoch: 29, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2363219261169434
Epoch: 30, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1916189193725586
Epoch: 31, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2183473110198975
Epoch: 32, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2576591968536377
Epoch: 33, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2933578491210938
Epoch: 34, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2700543403625488
Epoch: 35, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.293229103088379
Epoch: 36, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2647621631622314
Epoch: 37, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.24741530418396
Epoch: 38, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 141076
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3414931297302246
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.369 Vali Acc: 0.303 Test Loss: 1.369 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.2359542846679688
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.346 Vali Acc: 0.336 Test Loss: 1.346 Test Acc: 0.336
Validation loss decreased (-0.302618 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.131230115890503
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.315 Vali Acc: 0.349 Test Loss: 1.315 Test Acc: 0.349
Validation loss decreased (-0.335513 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 1.183426856994629
Epoch: 4, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.274 Vali Acc: 0.428 Test Loss: 1.274 Test Acc: 0.428
Validation loss decreased (-0.348671 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 1.208235263824463
Epoch: 5, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.229 Vali Acc: 0.467 Test Loss: 1.229 Test Acc: 0.467
Validation loss decreased (-0.427619 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.2868950366973877
Epoch: 6, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.181 Vali Acc: 0.526 Test Loss: 1.181 Test Acc: 0.526
Validation loss decreased (-0.467093 --> -0.526304).  Saving model ...
Epoch: 7 cost time: 1.1539993286132812
Epoch: 7, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.127 Vali Acc: 0.579 Test Loss: 1.127 Test Acc: 0.579
Validation loss decreased (-0.526304 --> -0.578936).  Saving model ...
Epoch: 8 cost time: 1.1880319118499756
Epoch: 8, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.075 Vali Acc: 0.605 Test Loss: 1.075 Test Acc: 0.605
Validation loss decreased (-0.578936 --> -0.605252).  Saving model ...
Epoch: 9 cost time: 1.3054602146148682
Epoch: 9, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.026 Vali Acc: 0.638 Test Loss: 1.026 Test Acc: 0.638
Validation loss decreased (-0.605252 --> -0.638148).  Saving model ...
Epoch: 10 cost time: 1.1833922863006592
Epoch: 10, Steps: 10 | Train Loss: 0.924 Vali Loss: 0.981 Vali Acc: 0.658 Test Loss: 0.981 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 11 cost time: 1.0852885246276855
Epoch: 11, Steps: 10 | Train Loss: 0.850 Vali Loss: 0.936 Vali Acc: 0.658 Test Loss: 0.936 Test Acc: 0.658
Validation loss decreased (-0.657885 --> -0.657885).  Saving model ...
Epoch: 12 cost time: 1.1727581024169922
Epoch: 12, Steps: 10 | Train Loss: 0.801 Vali Loss: 0.888 Vali Acc: 0.684 Test Loss: 0.888 Test Acc: 0.684
Validation loss decreased (-0.657885 --> -0.684202).  Saving model ...
Epoch: 13 cost time: 1.1659181118011475
Epoch: 13, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.843 Vali Acc: 0.711 Test Loss: 0.843 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710518).  Saving model ...
Epoch: 14 cost time: 1.2120048999786377
Epoch: 14, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.807 Vali Acc: 0.711 Test Loss: 0.807 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710518).  Saving model ...
Epoch: 15 cost time: 1.0683703422546387
Epoch: 15, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.771 Vali Acc: 0.743 Test Loss: 0.771 Test Acc: 0.743
Validation loss decreased (-0.710518 --> -0.743413).  Saving model ...
Epoch: 16 cost time: 1.1360063552856445
Epoch: 16, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.737 Vali Acc: 0.724 Test Loss: 0.737 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0675601959228516
Epoch: 17, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.701 Vali Acc: 0.757 Test Loss: 0.701 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756572).  Saving model ...
Epoch: 18 cost time: 1.1686513423919678
Epoch: 18, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.677 Vali Acc: 0.757 Test Loss: 0.677 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 19 cost time: 1.0560331344604492
Epoch: 19, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 1.094529628753662
Epoch: 20, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 21 cost time: 1.3073503971099854
Epoch: 21, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.600 Vali Acc: 0.796 Test Loss: 0.600 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 22 cost time: 1.0997076034545898
Epoch: 22, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.2410221099853516
Epoch: 23, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.2311985492706299
Epoch: 24, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 25 cost time: 1.2653872966766357
Epoch: 25, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 26 cost time: 1.1967616081237793
Epoch: 26, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1179556846618652
Epoch: 27, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 28 cost time: 1.1170454025268555
Epoch: 28, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.195479154586792
Epoch: 29, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2485499382019043
Epoch: 30, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1081955432891846
Epoch: 31, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.482 Vali Acc: 0.796 Test Loss: 0.482 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2563724517822266
Epoch: 32, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.478 Vali Acc: 0.796 Test Loss: 0.478 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.20041823387146
Epoch: 33, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 34 cost time: 1.1048016548156738
Epoch: 34, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.472 Vali Acc: 0.803 Test Loss: 0.472 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3256404399871826
Epoch: 35, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.471 Vali Acc: 0.809 Test Loss: 0.471 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1449291706085205
Epoch: 36, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0851504802703857
Epoch: 37, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.19972825050354
Epoch: 38, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.473 Vali Acc: 0.803 Test Loss: 0.473 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1586651802062988
Epoch: 39, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 40 cost time: 1.1147198677062988
Epoch: 40, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1592435836791992
Epoch: 41, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.469 Vali Acc: 0.803 Test Loss: 0.469 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2063634395599365
Epoch: 42, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2539453506469727
Epoch: 43, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.475 Vali Acc: 0.816 Test Loss: 0.475 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 44 cost time: 1.2625184059143066
Epoch: 44, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3545002937316895
Epoch: 45, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2776374816894531
Epoch: 46, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2186203002929688
Epoch: 47, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.199164628982544
Epoch: 48, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2379584312438965
Epoch: 49, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2508580684661865
Epoch: 50, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2861900329589844
Epoch: 51, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.1205365657806396
Epoch: 52, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0836689472198486
Epoch: 53, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 141076
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.513779878616333
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.387 Vali Acc: 0.303 Test Loss: 1.387 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.0750601291656494
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.351 Vali Acc: 0.329 Test Loss: 1.351 Test Acc: 0.329
Validation loss decreased (-0.302618 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.1323838233947754
Epoch: 3, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.305 Vali Acc: 0.382 Test Loss: 1.305 Test Acc: 0.382
Validation loss decreased (-0.328934 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 1.2591848373413086
Epoch: 4, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.255 Vali Acc: 0.428 Test Loss: 1.255 Test Acc: 0.428
Validation loss decreased (-0.381566 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 1.1082887649536133
Epoch: 5, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.204 Vali Acc: 0.434 Test Loss: 1.204 Test Acc: 0.434
Validation loss decreased (-0.427619 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 1.2940666675567627
Epoch: 6, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.150 Vali Acc: 0.513 Test Loss: 1.150 Test Acc: 0.513
Validation loss decreased (-0.434198 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 1.3554928302764893
Epoch: 7, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.090 Vali Acc: 0.586 Test Loss: 1.090 Test Acc: 0.586
Validation loss decreased (-0.513146 --> -0.585515).  Saving model ...
Epoch: 8 cost time: 1.2189040184020996
Epoch: 8, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.038 Vali Acc: 0.592 Test Loss: 1.038 Test Acc: 0.592
Validation loss decreased (-0.585515 --> -0.592095).  Saving model ...
Epoch: 9 cost time: 1.2242164611816406
Epoch: 9, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.991 Vali Acc: 0.632 Test Loss: 0.991 Test Acc: 0.632
Validation loss decreased (-0.592095 --> -0.631569).  Saving model ...
Epoch: 10 cost time: 1.1914441585540771
Epoch: 10, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.945 Vali Acc: 0.625 Test Loss: 0.945 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3397746086120605
Epoch: 11, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.904 Vali Acc: 0.651 Test Loss: 0.904 Test Acc: 0.651
Validation loss decreased (-0.631569 --> -0.651307).  Saving model ...
Epoch: 12 cost time: 1.2139575481414795
Epoch: 12, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.859 Vali Acc: 0.678 Test Loss: 0.859 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 13 cost time: 1.0897290706634521
Epoch: 13, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.822 Vali Acc: 0.684 Test Loss: 0.822 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 1.2711162567138672
Epoch: 14, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.780 Vali Acc: 0.697 Test Loss: 0.780 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 15 cost time: 1.2624356746673584
Epoch: 15, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 16 cost time: 0.9990122318267822
Epoch: 16, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.725 Vali Acc: 0.711 Test Loss: 0.725 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 17 cost time: 1.1399333477020264
Epoch: 17, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.698 Vali Acc: 0.724 Test Loss: 0.698 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 1.1483407020568848
Epoch: 18, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.676 Vali Acc: 0.730 Test Loss: 0.676 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 1.2042386531829834
Epoch: 19, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.657 Vali Acc: 0.737 Test Loss: 0.657 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 20 cost time: 1.2026937007904053
Epoch: 20, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.635 Vali Acc: 0.763 Test Loss: 0.635 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 1.2109992504119873
Epoch: 21, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 1.215360403060913
Epoch: 22, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.606 Vali Acc: 0.770 Test Loss: 0.606 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 23 cost time: 1.18684983253479
Epoch: 23, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 24 cost time: 1.164147138595581
Epoch: 24, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 1.2571756839752197
Epoch: 25, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 26 cost time: 1.1745083332061768
Epoch: 26, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.1720678806304932
Epoch: 27, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.1306064128875732
Epoch: 28, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 1.1731393337249756
Epoch: 29, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 30 cost time: 1.3033788204193115
Epoch: 30, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 1.11012864112854
Epoch: 31, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 32 cost time: 1.3711814880371094
Epoch: 32, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2542026042938232
Epoch: 33, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2556326389312744
Epoch: 34, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 35 cost time: 1.242039442062378
Epoch: 35, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.518 Vali Acc: 0.829 Test Loss: 0.518 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828942).  Saving model ...
Epoch: 36 cost time: 1.2498867511749268
Epoch: 36, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0869669914245605
Epoch: 37, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1988632678985596
Epoch: 38, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2229528427124023
Epoch: 39, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0703246593475342
Epoch: 40, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.284132957458496
Epoch: 41, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2229020595550537
Epoch: 42, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2481484413146973
Epoch: 43, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1410505771636963
Epoch: 44, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.205603837966919
Epoch: 45, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 75540
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.252857208251953
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.384 Vali Acc: 0.303 Test Loss: 1.384 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.1854405403137207
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.348 Vali Acc: 0.336 Test Loss: 1.348 Test Acc: 0.336
Validation loss decreased (-0.302618 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.1248440742492676
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.307 Vali Acc: 0.362 Test Loss: 1.307 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.1606945991516113
Epoch: 4, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.259 Vali Acc: 0.414 Test Loss: 1.259 Test Acc: 0.414
Validation loss decreased (-0.361829 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.3892896175384521
Epoch: 5, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.210 Vali Acc: 0.461 Test Loss: 1.210 Test Acc: 0.461
Validation loss decreased (-0.414461 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 1.3659780025482178
Epoch: 6, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.159 Vali Acc: 0.507 Test Loss: 1.159 Test Acc: 0.507
Validation loss decreased (-0.460514 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.3830599784851074
Epoch: 7, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.104 Vali Acc: 0.546 Test Loss: 1.104 Test Acc: 0.546
Validation loss decreased (-0.506567 --> -0.546042).  Saving model ...
Epoch: 8 cost time: 1.0824315547943115
Epoch: 8, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.053 Vali Acc: 0.599 Test Loss: 1.053 Test Acc: 0.599
Validation loss decreased (-0.546042 --> -0.598674).  Saving model ...
Epoch: 9 cost time: 1.276336669921875
Epoch: 9, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 1.3019745349884033
Epoch: 10, Steps: 10 | Train Loss: 0.818 Vali Loss: 0.957 Vali Acc: 0.632 Test Loss: 0.957 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631569).  Saving model ...
Epoch: 11 cost time: 1.2773046493530273
Epoch: 11, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.911 Vali Acc: 0.658 Test Loss: 0.911 Test Acc: 0.658
Validation loss decreased (-0.631569 --> -0.657886).  Saving model ...
Epoch: 12 cost time: 1.298356533050537
Epoch: 12, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.869 Vali Acc: 0.691 Test Loss: 0.869 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690781).  Saving model ...
Epoch: 13 cost time: 1.3867781162261963
Epoch: 13, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.828 Vali Acc: 0.697 Test Loss: 0.828 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697360).  Saving model ...
Epoch: 14 cost time: 1.4044482707977295
Epoch: 14, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.793 Vali Acc: 0.697 Test Loss: 0.793 Test Acc: 0.697
Validation loss decreased (-0.697360 --> -0.697360).  Saving model ...
Epoch: 15 cost time: 1.2118449211120605
Epoch: 15, Steps: 10 | Train Loss: 0.539 Vali Loss: 0.759 Vali Acc: 0.697 Test Loss: 0.759 Test Acc: 0.697
Validation loss decreased (-0.697360 --> -0.697361).  Saving model ...
Epoch: 16 cost time: 1.2031543254852295
Epoch: 16, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.732 Vali Acc: 0.730 Test Loss: 0.732 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 17 cost time: 1.301265001296997
Epoch: 17, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.705 Vali Acc: 0.743 Test Loss: 0.705 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 18 cost time: 1.1797008514404297
Epoch: 18, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.682 Vali Acc: 0.743 Test Loss: 0.682 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 1.247114896774292
Epoch: 19, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.665 Vali Acc: 0.737 Test Loss: 0.665 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1181626319885254
Epoch: 20, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.644 Vali Acc: 0.750 Test Loss: 0.644 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 21 cost time: 1.2506098747253418
Epoch: 21, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.631 Vali Acc: 0.776 Test Loss: 0.631 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776309).  Saving model ...
Epoch: 22 cost time: 1.211768627166748
Epoch: 22, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.121610403060913
Epoch: 23, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.305966854095459
Epoch: 24, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0812036991119385
Epoch: 25, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 1.1670608520507812
Epoch: 26, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 1.1114671230316162
Epoch: 27, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.1449041366577148
Epoch: 28, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 1.2705025672912598
Epoch: 29, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.253140926361084
Epoch: 30, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 31 cost time: 1.243668556213379
Epoch: 31, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 32 cost time: 1.2138898372650146
Epoch: 32, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 33 cost time: 1.2860949039459229
Epoch: 33, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 34 cost time: 1.2915287017822266
Epoch: 34, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2337100505828857
Epoch: 35, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 1.3028991222381592
Epoch: 36, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1158478260040283
Epoch: 37, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2689151763916016
Epoch: 38, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1979987621307373
Epoch: 39, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1543235778808594
Epoch: 40, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2187716960906982
Epoch: 41, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2233119010925293
Epoch: 42, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2481462955474854
Epoch: 43, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2122414112091064
Epoch: 44, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.1715342998504639
Epoch: 45, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 75540
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.401933431625366
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.334 Vali Acc: 0.375 Test Loss: 1.334 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.2428922653198242
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.305 Vali Acc: 0.447 Test Loss: 1.305 Test Acc: 0.447
Validation loss decreased (-0.374987 --> -0.447355).  Saving model ...
Epoch: 3 cost time: 1.1227631568908691
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.270 Vali Acc: 0.454 Test Loss: 1.270 Test Acc: 0.454
Validation loss decreased (-0.447355 --> -0.453935).  Saving model ...
Epoch: 4 cost time: 1.1961076259613037
Epoch: 4, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.230 Vali Acc: 0.487 Test Loss: 1.230 Test Acc: 0.487
Validation loss decreased (-0.453935 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.1990909576416016
Epoch: 5, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.186 Vali Acc: 0.520 Test Loss: 1.186 Test Acc: 0.520
Validation loss decreased (-0.486830 --> -0.519725).  Saving model ...
Epoch: 6 cost time: 1.1114461421966553
Epoch: 6, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.139 Vali Acc: 0.579 Test Loss: 1.139 Test Acc: 0.579
Validation loss decreased (-0.519725 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 1.1799516677856445
Epoch: 7, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.092 Vali Acc: 0.572 Test Loss: 1.092 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2133831977844238
Epoch: 8, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.043 Vali Acc: 0.638 Test Loss: 1.043 Test Acc: 0.638
Validation loss decreased (-0.578936 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 1.1744444370269775
Epoch: 9, Steps: 10 | Train Loss: 0.914 Vali Loss: 0.998 Vali Acc: 0.625 Test Loss: 0.998 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1799445152282715
Epoch: 10, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.957 Vali Acc: 0.632 Test Loss: 0.957 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2105708122253418
Epoch: 11, Steps: 10 | Train Loss: 0.753 Vali Loss: 0.913 Vali Acc: 0.678 Test Loss: 0.913 Test Acc: 0.678
Validation loss decreased (-0.638147 --> -0.677622).  Saving model ...
Epoch: 12 cost time: 1.2522563934326172
Epoch: 12, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.871 Vali Acc: 0.684 Test Loss: 0.871 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684202).  Saving model ...
Epoch: 13 cost time: 1.1936767101287842
Epoch: 13, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.830 Vali Acc: 0.704 Test Loss: 0.830 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703939).  Saving model ...
Epoch: 14 cost time: 1.274646282196045
Epoch: 14, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.791 Vali Acc: 0.691 Test Loss: 0.791 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3092217445373535
Epoch: 15, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.754 Vali Acc: 0.697 Test Loss: 0.754 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.222172737121582
Epoch: 16, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.725 Vali Acc: 0.724 Test Loss: 0.725 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 1.2688324451446533
Epoch: 17, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.692 Vali Acc: 0.730 Test Loss: 0.692 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 1.1774299144744873
Epoch: 18, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 19 cost time: 1.2373509407043457
Epoch: 19, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.648 Vali Acc: 0.763 Test Loss: 0.648 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763151).  Saving model ...
Epoch: 20 cost time: 1.2215464115142822
Epoch: 20, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.628 Vali Acc: 0.776 Test Loss: 0.628 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 1.318293809890747
Epoch: 21, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809204).  Saving model ...
Epoch: 22 cost time: 1.2102971076965332
Epoch: 22, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815784).  Saving model ...
Epoch: 23 cost time: 1.0659024715423584
Epoch: 23, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1887335777282715
Epoch: 24, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1945421695709229
Epoch: 25, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 26 cost time: 1.1388087272644043
Epoch: 26, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2123286724090576
Epoch: 27, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2443876266479492
Epoch: 28, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2108521461486816
Epoch: 29, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1422040462493896
Epoch: 30, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 1.273618459701538
Epoch: 31, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 32 cost time: 1.2663543224334717
Epoch: 32, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.503 Vali Acc: 0.816 Test Loss: 0.503 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 33 cost time: 1.201432228088379
Epoch: 33, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 34 cost time: 1.3316309452056885
Epoch: 34, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.491 Vali Acc: 0.836 Test Loss: 0.491 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835521).  Saving model ...
Epoch: 35 cost time: 1.2903430461883545
Epoch: 35, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2679355144500732
Epoch: 36, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.488 Vali Acc: 0.829 Test Loss: 0.488 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2921793460845947
Epoch: 37, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3480987548828125
Epoch: 38, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3865976333618164
Epoch: 39, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2018001079559326
Epoch: 40, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3113856315612793
Epoch: 41, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1701858043670654
Epoch: 42, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.478 Vali Acc: 0.836 Test Loss: 0.478 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 43 cost time: 1.1772558689117432
Epoch: 43, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2516708374023438
Epoch: 44, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1925311088562012
Epoch: 45, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1581153869628906
Epoch: 46, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1801371574401855
Epoch: 47, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2131943702697754
Epoch: 48, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.154639482498169
Epoch: 49, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.4009597301483154
Epoch: 50, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.495 Vali Acc: 0.842 Test Loss: 0.495 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842100).  Saving model ...
Epoch: 51 cost time: 1.279505729675293
Epoch: 51, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.488 Vali Acc: 0.849 Test Loss: 0.488 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848679).  Saving model ...
Epoch: 52 cost time: 1.1942992210388184
Epoch: 52, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3048210144042969
Epoch: 53, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.497 Vali Acc: 0.829 Test Loss: 0.497 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2060818672180176
Epoch: 54, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.2580289840698242
Epoch: 55, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1325397491455078
Epoch: 56, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.2561404705047607
Epoch: 57, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0603506565093994
Epoch: 58, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.1457154750823975
Epoch: 59, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.513 Vali Acc: 0.829 Test Loss: 0.513 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.1417622566223145
Epoch: 60, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.300079107284546
Epoch: 61, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 75540
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6561615467071533
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.320 Vali Acc: 0.414 Test Loss: 1.320 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 1.2379143238067627
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.298 Vali Acc: 0.434 Test Loss: 1.298 Test Acc: 0.434
Validation loss decreased (-0.414460 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.3798317909240723
Epoch: 3, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.266 Vali Acc: 0.493 Test Loss: 1.266 Test Acc: 0.493
Validation loss decreased (-0.434198 --> -0.493408).  Saving model ...
Epoch: 4 cost time: 1.313514232635498
Epoch: 4, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.230 Vali Acc: 0.507 Test Loss: 1.230 Test Acc: 0.507
Validation loss decreased (-0.493408 --> -0.506567).  Saving model ...
Epoch: 5 cost time: 1.2041161060333252
Epoch: 5, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.191 Vali Acc: 0.566 Test Loss: 1.191 Test Acc: 0.566
Validation loss decreased (-0.506567 --> -0.565778).  Saving model ...
Epoch: 6 cost time: 1.3293349742889404
Epoch: 6, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.147 Vali Acc: 0.599 Test Loss: 1.147 Test Acc: 0.599
Validation loss decreased (-0.565778 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 1.228393793106079
Epoch: 7, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.103 Vali Acc: 0.612 Test Loss: 1.103 Test Acc: 0.612
Validation loss decreased (-0.598673 --> -0.611831).  Saving model ...
Epoch: 8 cost time: 1.29164457321167
Epoch: 8, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.058 Vali Acc: 0.658 Test Loss: 1.058 Test Acc: 0.658
Validation loss decreased (-0.611831 --> -0.657884).  Saving model ...
Epoch: 9 cost time: 1.2795147895812988
Epoch: 9, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.020 Vali Acc: 0.664 Test Loss: 1.020 Test Acc: 0.664
Validation loss decreased (-0.657884 --> -0.664463).  Saving model ...
Epoch: 10 cost time: 1.1053433418273926
Epoch: 10, Steps: 10 | Train Loss: 0.919 Vali Loss: 0.976 Vali Acc: 0.684 Test Loss: 0.976 Test Acc: 0.684
Validation loss decreased (-0.664463 --> -0.684201).  Saving model ...
Epoch: 11 cost time: 1.2463674545288086
Epoch: 11, Steps: 10 | Train Loss: 0.841 Vali Loss: 0.931 Vali Acc: 0.697 Test Loss: 0.931 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697359).  Saving model ...
Epoch: 12 cost time: 1.1928284168243408
Epoch: 12, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.890 Vali Acc: 0.711 Test Loss: 0.890 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710517).  Saving model ...
Epoch: 13 cost time: 1.30159592628479
Epoch: 13, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.855 Vali Acc: 0.730 Test Loss: 0.855 Test Acc: 0.730
Validation loss decreased (-0.710517 --> -0.730255).  Saving model ...
Epoch: 14 cost time: 1.1706902980804443
Epoch: 14, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.807 Vali Acc: 0.757 Test Loss: 0.807 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756571).  Saving model ...
Epoch: 15 cost time: 1.3287231922149658
Epoch: 15, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.772 Vali Acc: 0.757 Test Loss: 0.772 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756571).  Saving model ...
Epoch: 16 cost time: 1.1983065605163574
Epoch: 16, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.735 Vali Acc: 0.750 Test Loss: 0.735 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1633408069610596
Epoch: 17, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.705 Vali Acc: 0.757 Test Loss: 0.705 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756572).  Saving model ...
Epoch: 18 cost time: 1.574427843093872
Epoch: 18, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.673 Vali Acc: 0.776 Test Loss: 0.673 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 19 cost time: 1.3068664073944092
Epoch: 19, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 20 cost time: 1.3860347270965576
Epoch: 20, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 21 cost time: 1.3213086128234863
Epoch: 21, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 1.3426146507263184
Epoch: 22, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.2879559993743896
Epoch: 23, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.167604684829712
Epoch: 24, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 25 cost time: 1.317899227142334
Epoch: 25, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4372992515563965
Epoch: 26, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 27 cost time: 1.2442748546600342
Epoch: 27, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 28 cost time: 1.2739722728729248
Epoch: 28, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.497 Vali Acc: 0.829 Test Loss: 0.497 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828942).  Saving model ...
Epoch: 29 cost time: 1.309657096862793
Epoch: 29, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4795448780059814
Epoch: 30, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2122232913970947
Epoch: 31, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3202717304229736
Epoch: 32, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2297518253326416
Epoch: 33, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828943).  Saving model ...
Epoch: 34 cost time: 1.1859195232391357
Epoch: 34, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3803191184997559
Epoch: 35, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3270421028137207
Epoch: 36, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.472320556640625
Epoch: 37, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2274980545043945
Epoch: 38, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3882381916046143
Epoch: 39, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4130291938781738
Epoch: 40, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.3865845203399658
Epoch: 41, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.4933233261108398
Epoch: 42, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.471 Vali Acc: 0.836 Test Loss: 0.471 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 43 cost time: 1.3872654438018799
Epoch: 43, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.297370433807373
Epoch: 44, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.332151174545288
Epoch: 45, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.475 Vali Acc: 0.829 Test Loss: 0.475 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2440996170043945
Epoch: 46, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0309181213378906
Epoch: 47, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2522060871124268
Epoch: 48, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3633394241333008
Epoch: 49, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2848765850067139
Epoch: 50, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.495 Vali Acc: 0.829 Test Loss: 0.495 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.24163818359375
Epoch: 51, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.3234212398529053
Epoch: 52, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 75540
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3105907440185547
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.397 Vali Acc: 0.309 Test Loss: 1.397 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.2504606246948242
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.363 Vali Acc: 0.336 Test Loss: 1.363 Test Acc: 0.336
Validation loss decreased (-0.309197 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.1455802917480469
Epoch: 3, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.320 Vali Acc: 0.362 Test Loss: 1.320 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.207521677017212
Epoch: 4, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.273 Vali Acc: 0.388 Test Loss: 1.273 Test Acc: 0.388
Validation loss decreased (-0.361829 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 1.206974744796753
Epoch: 5, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.224 Vali Acc: 0.434 Test Loss: 1.224 Test Acc: 0.434
Validation loss decreased (-0.388145 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 1.2330875396728516
Epoch: 6, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.174 Vali Acc: 0.493 Test Loss: 1.174 Test Acc: 0.493
Validation loss decreased (-0.434198 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 1.2543814182281494
Epoch: 7, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.124 Vali Acc: 0.526 Test Loss: 1.124 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526305).  Saving model ...
Epoch: 8 cost time: 1.2541546821594238
Epoch: 8, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.078 Vali Acc: 0.566 Test Loss: 1.078 Test Acc: 0.566
Validation loss decreased (-0.526305 --> -0.565779).  Saving model ...
Epoch: 9 cost time: 1.0974757671356201
Epoch: 9, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.031 Vali Acc: 0.579 Test Loss: 1.031 Test Acc: 0.579
Validation loss decreased (-0.565779 --> -0.578937).  Saving model ...
Epoch: 10 cost time: 1.2653825283050537
Epoch: 10, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.987 Vali Acc: 0.625 Test Loss: 0.987 Test Acc: 0.625
Validation loss decreased (-0.578937 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 1.2697012424468994
Epoch: 11, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.942 Vali Acc: 0.632 Test Loss: 0.942 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631570).  Saving model ...
Epoch: 12 cost time: 1.266777753829956
Epoch: 12, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.902 Vali Acc: 0.658 Test Loss: 0.902 Test Acc: 0.658
Validation loss decreased (-0.631570 --> -0.657886).  Saving model ...
Epoch: 13 cost time: 1.4030334949493408
Epoch: 13, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.863 Vali Acc: 0.658 Test Loss: 0.863 Test Acc: 0.658
Validation loss decreased (-0.657886 --> -0.657886).  Saving model ...
Epoch: 14 cost time: 1.2605860233306885
Epoch: 14, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.824 Vali Acc: 0.671 Test Loss: 0.824 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671044).  Saving model ...
Epoch: 15 cost time: 1.2959802150726318
Epoch: 15, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.791 Vali Acc: 0.697 Test Loss: 0.791 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697361).  Saving model ...
Epoch: 16 cost time: 1.2024383544921875
Epoch: 16, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.764 Vali Acc: 0.691 Test Loss: 0.764 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2541217803955078
Epoch: 17, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.733 Vali Acc: 0.697 Test Loss: 0.733 Test Acc: 0.697
Validation loss decreased (-0.697361 --> -0.697361).  Saving model ...
Epoch: 18 cost time: 1.2983429431915283
Epoch: 18, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.714 Vali Acc: 0.711 Test Loss: 0.714 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 19 cost time: 1.275517225265503
Epoch: 19, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.694 Vali Acc: 0.724 Test Loss: 0.694 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 20 cost time: 1.3316514492034912
Epoch: 20, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.675 Vali Acc: 0.724 Test Loss: 0.675 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 21 cost time: 1.2494995594024658
Epoch: 21, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.663 Vali Acc: 0.743 Test Loss: 0.663 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 22 cost time: 1.3640153408050537
Epoch: 22, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.385512351989746
Epoch: 23, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.635 Vali Acc: 0.757 Test Loss: 0.635 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 24 cost time: 1.1103878021240234
Epoch: 24, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.620 Vali Acc: 0.750 Test Loss: 0.620 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1200785636901855
Epoch: 25, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 1.2911956310272217
Epoch: 26, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 1.0797483921051025
Epoch: 27, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.595 Vali Acc: 0.776 Test Loss: 0.595 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.1480333805084229
Epoch: 28, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 29 cost time: 1.1272945404052734
Epoch: 29, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.585 Vali Acc: 0.770 Test Loss: 0.585 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1486639976501465
Epoch: 30, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1954402923583984
Epoch: 31, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 32 cost time: 1.1924855709075928
Epoch: 32, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 33 cost time: 1.2100467681884766
Epoch: 33, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 1.1215755939483643
Epoch: 34, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 1.389314889907837
Epoch: 35, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.551 Vali Acc: 0.796 Test Loss: 0.551 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 36 cost time: 1.3157932758331299
Epoch: 36, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.12276029586792
Epoch: 37, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3688509464263916
Epoch: 38, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2996160984039307
Epoch: 39, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2193853855133057
Epoch: 40, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2308769226074219
Epoch: 41, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1286089420318604
Epoch: 42, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.252629041671753
Epoch: 43, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 44 cost time: 1.1586048603057861
Epoch: 44, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 45 cost time: 1.2091310024261475
Epoch: 45, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2047810554504395
Epoch: 46, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2255222797393799
Epoch: 47, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.190305471420288
Epoch: 48, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.287975549697876
Epoch: 49, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.318009614944458
Epoch: 50, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.192230463027954
Epoch: 51, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2153918743133545
Epoch: 52, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.3707358837127686
Epoch: 53, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.274139642715454
Epoch: 54, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 42772
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4370498657226562
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.399 Vali Acc: 0.296 Test Loss: 1.399 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.4588308334350586
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.366 Vali Acc: 0.336 Test Loss: 1.366 Test Acc: 0.336
Validation loss decreased (-0.296039 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.25193190574646
Epoch: 3, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.323 Vali Acc: 0.388 Test Loss: 1.323 Test Acc: 0.388
Validation loss decreased (-0.335513 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 1.3529224395751953
Epoch: 4, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.278 Vali Acc: 0.408 Test Loss: 1.278 Test Acc: 0.408
Validation loss decreased (-0.388145 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 1.284670352935791
Epoch: 5, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.234 Vali Acc: 0.454 Test Loss: 1.234 Test Acc: 0.454
Validation loss decreased (-0.407882 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 1.2588648796081543
Epoch: 6, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.186 Vali Acc: 0.480 Test Loss: 1.186 Test Acc: 0.480
Validation loss decreased (-0.453935 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 1.292856216430664
Epoch: 7, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.137 Vali Acc: 0.507 Test Loss: 1.137 Test Acc: 0.507
Validation loss decreased (-0.480251 --> -0.506568).  Saving model ...
Epoch: 8 cost time: 1.3066401481628418
Epoch: 8, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.088 Vali Acc: 0.566 Test Loss: 1.088 Test Acc: 0.566
Validation loss decreased (-0.506568 --> -0.565779).  Saving model ...
Epoch: 9 cost time: 1.3469133377075195
Epoch: 9, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.043 Vali Acc: 0.599 Test Loss: 1.043 Test Acc: 0.599
Validation loss decreased (-0.565779 --> -0.598674).  Saving model ...
Epoch: 10 cost time: 1.276404857635498
Epoch: 10, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.001 Vali Acc: 0.599 Test Loss: 1.001 Test Acc: 0.599
Validation loss decreased (-0.598674 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 1.2906980514526367
Epoch: 11, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.952 Vali Acc: 0.651 Test Loss: 0.952 Test Acc: 0.651
Validation loss decreased (-0.598674 --> -0.651306).  Saving model ...
Epoch: 12 cost time: 1.3171274662017822
Epoch: 12, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.910 Vali Acc: 0.651 Test Loss: 0.910 Test Acc: 0.651
Validation loss decreased (-0.651306 --> -0.651307).  Saving model ...
Epoch: 13 cost time: 1.4086573123931885
Epoch: 13, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.867 Vali Acc: 0.664 Test Loss: 0.867 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664465).  Saving model ...
Epoch: 14 cost time: 1.312500238418579
Epoch: 14, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.825 Vali Acc: 0.691 Test Loss: 0.825 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690781).  Saving model ...
Epoch: 15 cost time: 1.1511650085449219
Epoch: 15, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.795 Vali Acc: 0.697 Test Loss: 0.795 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697360).  Saving model ...
Epoch: 16 cost time: 1.259552001953125
Epoch: 16, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.765 Vali Acc: 0.691 Test Loss: 0.765 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2627134323120117
Epoch: 17, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.733 Vali Acc: 0.730 Test Loss: 0.733 Test Acc: 0.730
Validation loss decreased (-0.697360 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 1.3164052963256836
Epoch: 18, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.712 Vali Acc: 0.737 Test Loss: 0.712 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 19 cost time: 1.325632095336914
Epoch: 19, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.687 Vali Acc: 0.737 Test Loss: 0.687 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 20 cost time: 1.3056144714355469
Epoch: 20, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.669 Vali Acc: 0.750 Test Loss: 0.669 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 1.2925629615783691
Epoch: 21, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 1.1711523532867432
Epoch: 22, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.638 Vali Acc: 0.763 Test Loss: 0.638 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 1.2179057598114014
Epoch: 23, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 24 cost time: 1.2637219429016113
Epoch: 24, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 25 cost time: 1.1132826805114746
Epoch: 25, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 1.2330234050750732
Epoch: 26, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 27 cost time: 1.354219675064087
Epoch: 27, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 28 cost time: 1.3505315780639648
Epoch: 28, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 29 cost time: 1.1639437675476074
Epoch: 29, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.4546823501586914
Epoch: 30, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2232933044433594
Epoch: 31, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3231046199798584
Epoch: 32, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 33 cost time: 1.3111038208007812
Epoch: 33, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3305892944335938
Epoch: 34, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1908769607543945
Epoch: 35, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 36 cost time: 1.3298280239105225
Epoch: 36, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2614250183105469
Epoch: 37, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3762667179107666
Epoch: 38, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4200949668884277
Epoch: 39, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2566776275634766
Epoch: 40, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3416481018066406
Epoch: 41, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1399598121643066
Epoch: 42, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2742981910705566
Epoch: 43, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.210160255432129
Epoch: 44, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.251784324645996
Epoch: 45, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 42772
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4700520038604736
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.403 Vali Acc: 0.316 Test Loss: 1.403 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 1.1407737731933594
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.375 Vali Acc: 0.322 Test Loss: 1.375 Test Acc: 0.322
Validation loss decreased (-0.315775 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.1287720203399658
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.340 Vali Acc: 0.336 Test Loss: 1.340 Test Acc: 0.336
Validation loss decreased (-0.322355 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.184696912765503
Epoch: 4, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.294 Vali Acc: 0.388 Test Loss: 1.294 Test Acc: 0.388
Validation loss decreased (-0.335513 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 1.1355345249176025
Epoch: 5, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.247 Vali Acc: 0.428 Test Loss: 1.247 Test Acc: 0.428
Validation loss decreased (-0.388145 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 1.2489023208618164
Epoch: 6, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.201 Vali Acc: 0.487 Test Loss: 1.201 Test Acc: 0.487
Validation loss decreased (-0.427619 --> -0.486830).  Saving model ...
Epoch: 7 cost time: 1.1596710681915283
Epoch: 7, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.152 Vali Acc: 0.520 Test Loss: 1.152 Test Acc: 0.520
Validation loss decreased (-0.486830 --> -0.519725).  Saving model ...
Epoch: 8 cost time: 1.1255712509155273
Epoch: 8, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.108 Vali Acc: 0.559 Test Loss: 1.108 Test Acc: 0.559
Validation loss decreased (-0.519725 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 1.337810754776001
Epoch: 9, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.063 Vali Acc: 0.566 Test Loss: 1.063 Test Acc: 0.566
Validation loss decreased (-0.559199 --> -0.565779).  Saving model ...
Epoch: 10 cost time: 1.320573329925537
Epoch: 10, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.019 Vali Acc: 0.592 Test Loss: 1.019 Test Acc: 0.592
Validation loss decreased (-0.565779 --> -0.592095).  Saving model ...
Epoch: 11 cost time: 1.409602403640747
Epoch: 11, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.975 Vali Acc: 0.605 Test Loss: 0.975 Test Acc: 0.605
Validation loss decreased (-0.592095 --> -0.605253).  Saving model ...
Epoch: 12 cost time: 1.1753785610198975
Epoch: 12, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.934 Vali Acc: 0.625 Test Loss: 0.934 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624991).  Saving model ...
Epoch: 13 cost time: 1.392857313156128
Epoch: 13, Steps: 10 | Train Loss: 0.711 Vali Loss: 0.894 Vali Acc: 0.651 Test Loss: 0.894 Test Acc: 0.651
Validation loss decreased (-0.624991 --> -0.651307).  Saving model ...
Epoch: 14 cost time: 1.206268310546875
Epoch: 14, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.853 Vali Acc: 0.678 Test Loss: 0.853 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 15 cost time: 1.2232246398925781
Epoch: 15, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.817 Vali Acc: 0.697 Test Loss: 0.817 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697360).  Saving model ...
Epoch: 16 cost time: 1.0363805294036865
Epoch: 16, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.783 Vali Acc: 0.711 Test Loss: 0.783 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710518).  Saving model ...
Epoch: 17 cost time: 1.166024923324585
Epoch: 17, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.752 Vali Acc: 0.730 Test Loss: 0.752 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 1.1746056079864502
Epoch: 18, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.727 Vali Acc: 0.757 Test Loss: 0.727 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 19 cost time: 1.173086404800415
Epoch: 19, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.699 Vali Acc: 0.770 Test Loss: 0.699 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 20 cost time: 1.0873215198516846
Epoch: 20, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.679 Vali Acc: 0.776 Test Loss: 0.679 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 21 cost time: 1.4354844093322754
Epoch: 21, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 1.2788279056549072
Epoch: 22, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 23 cost time: 1.2771327495574951
Epoch: 23, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 24 cost time: 1.3700783252716064
Epoch: 24, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 1.3616933822631836
Epoch: 25, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 26 cost time: 1.512662649154663
Epoch: 26, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.2549450397491455
Epoch: 27, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.2102363109588623
Epoch: 28, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 1.301039457321167
Epoch: 29, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.564 Vali Acc: 0.796 Test Loss: 0.564 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 30 cost time: 1.296100378036499
Epoch: 30, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3657822608947754
Epoch: 31, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.285339117050171
Epoch: 32, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4000673294067383
Epoch: 33, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3252089023590088
Epoch: 34, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3218927383422852
Epoch: 35, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 36 cost time: 1.2597215175628662
Epoch: 36, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2583606243133545
Epoch: 37, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.262317180633545
Epoch: 38, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1482679843902588
Epoch: 39, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 40 cost time: 1.1955184936523438
Epoch: 40, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 41 cost time: 1.1318011283874512
Epoch: 41, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2624032497406006
Epoch: 42, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3092176914215088
Epoch: 43, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3241550922393799
Epoch: 44, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2498207092285156
Epoch: 45, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.289705753326416
Epoch: 46, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2599048614501953
Epoch: 47, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3166406154632568
Epoch: 48, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.229304552078247
Epoch: 49, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4110767841339111
Epoch: 50, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 42772
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6143581867218018
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.398 Vali Acc: 0.309 Test Loss: 1.398 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.3263137340545654
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.373 Vali Acc: 0.336 Test Loss: 1.373 Test Acc: 0.336
Validation loss decreased (-0.309197 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.364227533340454
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.340 Vali Acc: 0.375 Test Loss: 1.340 Test Acc: 0.375
Validation loss decreased (-0.335513 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.291353464126587
Epoch: 4, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.302 Vali Acc: 0.408 Test Loss: 1.302 Test Acc: 0.408
Validation loss decreased (-0.374987 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 1.1820149421691895
Epoch: 5, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.262 Vali Acc: 0.447 Test Loss: 1.262 Test Acc: 0.447
Validation loss decreased (-0.407882 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 1.2533228397369385
Epoch: 6, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
Validation loss decreased (-0.447356 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.299187183380127
Epoch: 7, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.176 Vali Acc: 0.546 Test Loss: 1.176 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546041).  Saving model ...
Epoch: 8 cost time: 1.3380258083343506
Epoch: 8, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.132 Vali Acc: 0.572 Test Loss: 1.132 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572357).  Saving model ...
Epoch: 9 cost time: 1.3073010444641113
Epoch: 9, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.094 Vali Acc: 0.612 Test Loss: 1.094 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611831).  Saving model ...
Epoch: 10 cost time: 1.3148131370544434
Epoch: 10, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.046 Vali Acc: 0.645 Test Loss: 1.046 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644726).  Saving model ...
Epoch: 11 cost time: 1.218369483947754
Epoch: 11, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.002 Vali Acc: 0.664 Test Loss: 1.002 Test Acc: 0.664
Validation loss decreased (-0.644726 --> -0.664464).  Saving model ...
Epoch: 12 cost time: 1.32362961769104
Epoch: 12, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.964 Vali Acc: 0.684 Test Loss: 0.964 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 13 cost time: 1.3315401077270508
Epoch: 13, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.923 Vali Acc: 0.684 Test Loss: 0.923 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684201).  Saving model ...
Epoch: 14 cost time: 1.4307479858398438
Epoch: 14, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.883 Vali Acc: 0.717 Test Loss: 0.883 Test Acc: 0.717
Validation loss decreased (-0.684201 --> -0.717096).  Saving model ...
Epoch: 15 cost time: 1.3270254135131836
Epoch: 15, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.849 Vali Acc: 0.711 Test Loss: 0.849 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4884357452392578
Epoch: 16, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.815 Vali Acc: 0.717 Test Loss: 0.815 Test Acc: 0.717
Validation loss decreased (-0.717096 --> -0.717097).  Saving model ...
Epoch: 17 cost time: 1.2028942108154297
Epoch: 17, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.780 Vali Acc: 0.730 Test Loss: 0.780 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730255).  Saving model ...
Epoch: 18 cost time: 1.423163890838623
Epoch: 18, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.751 Vali Acc: 0.743 Test Loss: 0.751 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 1.2964293956756592
Epoch: 19, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.719 Vali Acc: 0.730 Test Loss: 0.719 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.392735242843628
Epoch: 20, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.692 Vali Acc: 0.750 Test Loss: 0.692 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 1.2115612030029297
Epoch: 21, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 22 cost time: 1.3920073509216309
Epoch: 22, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.653 Vali Acc: 0.776 Test Loss: 0.653 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 23 cost time: 1.351097583770752
Epoch: 23, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.630 Vali Acc: 0.770 Test Loss: 0.630 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.413748025894165
Epoch: 24, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.611 Vali Acc: 0.776 Test Loss: 0.611 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 25 cost time: 1.1746435165405273
Epoch: 25, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 1.1942107677459717
Epoch: 26, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 1.229637622833252
Epoch: 27, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2209630012512207
Epoch: 28, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.559 Vali Acc: 0.770 Test Loss: 0.559 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2197802066802979
Epoch: 29, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.151252269744873
Epoch: 30, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 31 cost time: 1.3280141353607178
Epoch: 31, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 32 cost time: 1.2265512943267822
Epoch: 32, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3443806171417236
Epoch: 33, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2657954692840576
Epoch: 34, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.308250904083252
Epoch: 35, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3719360828399658
Epoch: 36, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 37 cost time: 1.2286148071289062
Epoch: 37, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 38 cost time: 1.3148281574249268
Epoch: 38, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 39 cost time: 1.2609732151031494
Epoch: 39, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1740655899047852
Epoch: 40, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1791162490844727
Epoch: 41, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.322317361831665
Epoch: 42, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2389016151428223
Epoch: 43, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 44 cost time: 1.3029475212097168
Epoch: 44, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1111795902252197
Epoch: 45, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.199960708618164
Epoch: 46, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 47 cost time: 1.235410213470459
Epoch: 47, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 48 cost time: 1.1826608180999756
Epoch: 48, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.3688316345214844
Epoch: 49, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 50 cost time: 1.2315685749053955
Epoch: 50, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2167811393737793
Epoch: 51, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1527669429779053
Epoch: 52, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2180981636047363
Epoch: 53, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.2401490211486816
Epoch: 54, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1669414043426514
Epoch: 55, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.2612159252166748
Epoch: 56, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.1428043842315674
Epoch: 57, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.2800259590148926
Epoch: 58, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.3026816844940186
Epoch: 59, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 42772
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0758094787597656
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.480 Vali Acc: 0.283 Test Loss: 1.480 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.0591158866882324
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.440 Vali Acc: 0.296 Test Loss: 1.440 Test Acc: 0.296
Validation loss decreased (-0.282880 --> -0.296038).  Saving model ...
Epoch: 3 cost time: 1.1467015743255615
Epoch: 3, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.386 Vali Acc: 0.322 Test Loss: 1.386 Test Acc: 0.322
Validation loss decreased (-0.296038 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 1.110114574432373
Epoch: 4, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.327 Vali Acc: 0.375 Test Loss: 1.327 Test Acc: 0.375
Validation loss decreased (-0.322355 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.1479156017303467
Epoch: 5, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.264 Vali Acc: 0.474 Test Loss: 1.264 Test Acc: 0.474
Validation loss decreased (-0.374987 --> -0.473672).  Saving model ...
Epoch: 6 cost time: 1.0581109523773193
Epoch: 6, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.206 Vali Acc: 0.526 Test Loss: 1.206 Test Acc: 0.526
Validation loss decreased (-0.473672 --> -0.526304).  Saving model ...
Epoch: 7 cost time: 1.1463243961334229
Epoch: 7, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.147 Vali Acc: 0.559 Test Loss: 1.147 Test Acc: 0.559
Validation loss decreased (-0.526304 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 1.2782979011535645
Epoch: 8, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.089 Vali Acc: 0.605 Test Loss: 1.089 Test Acc: 0.605
Validation loss decreased (-0.559199 --> -0.605252).  Saving model ...
Epoch: 9 cost time: 1.2003233432769775
Epoch: 9, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.033 Vali Acc: 0.638 Test Loss: 1.033 Test Acc: 0.638
Validation loss decreased (-0.605252 --> -0.638148).  Saving model ...
Epoch: 10 cost time: 1.1819181442260742
Epoch: 10, Steps: 10 | Train Loss: 0.856 Vali Loss: 0.977 Vali Acc: 0.651 Test Loss: 0.977 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 1.1968390941619873
Epoch: 11, Steps: 10 | Train Loss: 0.778 Vali Loss: 0.928 Vali Acc: 0.684 Test Loss: 0.928 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684201).  Saving model ...
Epoch: 12 cost time: 1.2061574459075928
Epoch: 12, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.882 Vali Acc: 0.684 Test Loss: 0.882 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684202).  Saving model ...
Epoch: 13 cost time: 1.1028406620025635
Epoch: 13, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.838 Vali Acc: 0.684 Test Loss: 0.838 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 1.2255854606628418
Epoch: 14, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.799 Vali Acc: 0.684 Test Loss: 0.799 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 15 cost time: 1.1497759819030762
Epoch: 15, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.765 Vali Acc: 0.704 Test Loss: 0.765 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 1.1003925800323486
Epoch: 16, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.730 Vali Acc: 0.717 Test Loss: 0.730 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 17 cost time: 1.2566585540771484
Epoch: 17, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.702 Vali Acc: 0.757 Test Loss: 0.702 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756572).  Saving model ...
Epoch: 18 cost time: 1.1211159229278564
Epoch: 18, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 19 cost time: 1.1445093154907227
Epoch: 19, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.661 Vali Acc: 0.743 Test Loss: 0.661 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1818592548370361
Epoch: 20, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 1.172661304473877
Epoch: 21, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 1.2554841041564941
Epoch: 22, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.611 Vali Acc: 0.776 Test Loss: 0.611 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.118412733078003
Epoch: 23, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.602 Vali Acc: 0.776 Test Loss: 0.602 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1454694271087646
Epoch: 24, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1780657768249512
Epoch: 25, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796047).  Saving model ...
Epoch: 26 cost time: 1.2100858688354492
Epoch: 26, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 27 cost time: 1.1548373699188232
Epoch: 27, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 28 cost time: 1.218233585357666
Epoch: 28, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 29 cost time: 1.1714153289794922
Epoch: 29, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.184990406036377
Epoch: 30, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0962581634521484
Epoch: 31, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 32 cost time: 1.0723278522491455
Epoch: 32, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0457379817962646
Epoch: 33, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1648032665252686
Epoch: 34, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1212284564971924
Epoch: 35, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1628119945526123
Epoch: 36, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 37 cost time: 0.97125244140625
Epoch: 37, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1081221103668213
Epoch: 38, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 39 cost time: 1.1647541522979736
Epoch: 39, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2757294178009033
Epoch: 40, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1882035732269287
Epoch: 41, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 42 cost time: 1.16217041015625
Epoch: 42, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 43 cost time: 1.1612002849578857
Epoch: 43, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 44 cost time: 1.179316520690918
Epoch: 44, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 45 cost time: 1.1034770011901855
Epoch: 45, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1340937614440918
Epoch: 46, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.207519292831421
Epoch: 47, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 48 cost time: 1.2276482582092285
Epoch: 48, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2045533657073975
Epoch: 49, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0946431159973145
Epoch: 50, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1595566272735596
Epoch: 51, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.1984508037567139
Epoch: 52, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1360418796539307
Epoch: 53, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.535 Vali Acc: 0.829 Test Loss: 0.535 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 54 cost time: 1.0314099788665771
Epoch: 54, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1211066246032715
Epoch: 55, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1968038082122803
Epoch: 56, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.305185317993164
Epoch: 57, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0005617141723633
Epoch: 58, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.543 Vali Acc: 0.829 Test Loss: 0.543 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1792683601379395
Epoch: 59, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.1895875930786133
Epoch: 60, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.546 Vali Acc: 0.829 Test Loss: 0.546 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.1371731758117676
Epoch: 61, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.548 Vali Acc: 0.829 Test Loss: 0.548 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.3788948059082031
Epoch: 62, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.2281484603881836
Epoch: 63, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 26388
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9805803298950195
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.500 Vali Acc: 0.243 Test Loss: 1.500 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 1.2280957698822021
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.461 Vali Acc: 0.257 Test Loss: 1.461 Test Acc: 0.257
Validation loss decreased (-0.243406 --> -0.256564).  Saving model ...
Epoch: 3 cost time: 1.1362395286560059
Epoch: 3, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.410 Vali Acc: 0.296 Test Loss: 1.410 Test Acc: 0.296
Validation loss decreased (-0.256564 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 1.1927731037139893
Epoch: 4, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.353 Vali Acc: 0.342 Test Loss: 1.353 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 1.0486648082733154
Epoch: 5, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.288 Vali Acc: 0.447 Test Loss: 1.288 Test Acc: 0.447
Validation loss decreased (-0.342092 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 1.0966060161590576
Epoch: 6, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.230 Vali Acc: 0.474 Test Loss: 1.230 Test Acc: 0.474
Validation loss decreased (-0.447356 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 1.1086721420288086
Epoch: 7, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.171 Vali Acc: 0.520 Test Loss: 1.171 Test Acc: 0.520
Validation loss decreased (-0.473672 --> -0.519725).  Saving model ...
Epoch: 8 cost time: 1.0723142623901367
Epoch: 8, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.114 Vali Acc: 0.566 Test Loss: 1.114 Test Acc: 0.566
Validation loss decreased (-0.519725 --> -0.565778).  Saving model ...
Epoch: 9 cost time: 1.2603914737701416
Epoch: 9, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.058 Vali Acc: 0.599 Test Loss: 1.058 Test Acc: 0.599
Validation loss decreased (-0.565778 --> -0.598674).  Saving model ...
Epoch: 10 cost time: 1.184889316558838
Epoch: 10, Steps: 10 | Train Loss: 0.860 Vali Loss: 0.999 Vali Acc: 0.651 Test Loss: 0.999 Test Acc: 0.651
Validation loss decreased (-0.598674 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 1.143653154373169
Epoch: 11, Steps: 10 | Train Loss: 0.801 Vali Loss: 0.949 Vali Acc: 0.671 Test Loss: 0.949 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671043).  Saving model ...
Epoch: 12 cost time: 1.2736847400665283
Epoch: 12, Steps: 10 | Train Loss: 0.741 Vali Loss: 0.902 Vali Acc: 0.671 Test Loss: 0.902 Test Acc: 0.671
Validation loss decreased (-0.671043 --> -0.671044).  Saving model ...
Epoch: 13 cost time: 1.2482337951660156
Epoch: 13, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.853 Vali Acc: 0.697 Test Loss: 0.853 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697360).  Saving model ...
Epoch: 14 cost time: 1.1870791912078857
Epoch: 14, Steps: 10 | Train Loss: 0.648 Vali Loss: 0.814 Vali Acc: 0.684 Test Loss: 0.814 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1583549976348877
Epoch: 15, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.778 Vali Acc: 0.691 Test Loss: 0.778 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1234309673309326
Epoch: 16, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.743 Vali Acc: 0.724 Test Loss: 0.743 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 1.1462104320526123
Epoch: 17, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.711 Vali Acc: 0.724 Test Loss: 0.711 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 1.1432650089263916
Epoch: 18, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.686 Vali Acc: 0.743 Test Loss: 0.686 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 1.2566101551055908
Epoch: 19, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.671 Vali Acc: 0.743 Test Loss: 0.671 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 20 cost time: 1.1559321880340576
Epoch: 20, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.644 Vali Acc: 0.770 Test Loss: 0.644 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 1.0205790996551514
Epoch: 21, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 1.084341287612915
Epoch: 22, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.612 Vali Acc: 0.770 Test Loss: 0.612 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0437769889831543
Epoch: 23, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.251638412475586
Epoch: 24, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1438250541687012
Epoch: 25, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 26 cost time: 1.2263426780700684
Epoch: 26, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2984991073608398
Epoch: 27, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.558 Vali Acc: 0.796 Test Loss: 0.558 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0719521045684814
Epoch: 28, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0343587398529053
Epoch: 29, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1302287578582764
Epoch: 30, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 1.1589503288269043
Epoch: 31, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2233052253723145
Epoch: 32, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1201448440551758
Epoch: 33, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1891229152679443
Epoch: 34, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.146784782409668
Epoch: 35, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 36 cost time: 1.2040739059448242
Epoch: 36, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1209313869476318
Epoch: 37, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0621731281280518
Epoch: 38, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1822328567504883
Epoch: 39, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1806304454803467
Epoch: 40, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1765263080596924
Epoch: 41, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1235871315002441
Epoch: 42, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 43 cost time: 0.9709212779998779
Epoch: 43, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.112549066543579
Epoch: 44, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0492327213287354
Epoch: 45, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.231147050857544
Epoch: 46, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1764681339263916
Epoch: 47, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1834807395935059
Epoch: 48, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.200596809387207
Epoch: 49, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1101880073547363
Epoch: 50, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0996792316436768
Epoch: 51, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 52 cost time: 1.0731470584869385
Epoch: 52, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.1130170822143555
Epoch: 53, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1553990840911865
Epoch: 54, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0725536346435547
Epoch: 55, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.0801961421966553
Epoch: 56, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.0679678916931152
Epoch: 57, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.197249174118042
Epoch: 58, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.108133316040039
Epoch: 59, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.1198813915252686
Epoch: 60, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.1166691780090332
Epoch: 61, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 26388
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.265789747238159
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.498 Vali Acc: 0.224 Test Loss: 1.498 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 1.08258056640625
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.463 Vali Acc: 0.237 Test Loss: 1.463 Test Acc: 0.237
Validation loss decreased (-0.223669 --> -0.236827).  Saving model ...
Epoch: 3 cost time: 1.0426101684570312
Epoch: 3, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
Validation loss decreased (-0.236827 --> -0.269723).  Saving model ...
Epoch: 4 cost time: 1.1267035007476807
Epoch: 4, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.364 Vali Acc: 0.336 Test Loss: 1.364 Test Acc: 0.336
Validation loss decreased (-0.269723 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 1.0953927040100098
Epoch: 5, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.308 Vali Acc: 0.395 Test Loss: 1.308 Test Acc: 0.395
Validation loss decreased (-0.335513 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 1.0843133926391602
Epoch: 6, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.253 Vali Acc: 0.513 Test Loss: 1.253 Test Acc: 0.513
Validation loss decreased (-0.394724 --> -0.513145).  Saving model ...
Epoch: 7 cost time: 1.0816593170166016
Epoch: 7, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.197 Vali Acc: 0.566 Test Loss: 1.197 Test Acc: 0.566
Validation loss decreased (-0.513145 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 1.0877182483673096
Epoch: 8, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.143 Vali Acc: 0.586 Test Loss: 1.143 Test Acc: 0.586
Validation loss decreased (-0.565778 --> -0.585515).  Saving model ...
Epoch: 9 cost time: 1.2088801860809326
Epoch: 9, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.092 Vali Acc: 0.586 Test Loss: 1.092 Test Acc: 0.586
Validation loss decreased (-0.585515 --> -0.585515).  Saving model ...
Epoch: 10 cost time: 1.131704330444336
Epoch: 10, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.035 Vali Acc: 0.632 Test Loss: 1.035 Test Acc: 0.632
Validation loss decreased (-0.585515 --> -0.631569).  Saving model ...
Epoch: 11 cost time: 1.2782011032104492
Epoch: 11, Steps: 10 | Train Loss: 0.820 Vali Loss: 0.988 Vali Acc: 0.632 Test Loss: 0.988 Test Acc: 0.632
Validation loss decreased (-0.631569 --> -0.631569).  Saving model ...
Epoch: 12 cost time: 1.2012529373168945
Epoch: 12, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.937 Vali Acc: 0.664 Test Loss: 0.937 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664464).  Saving model ...
Epoch: 13 cost time: 1.337599515914917
Epoch: 13, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.887 Vali Acc: 0.684 Test Loss: 0.887 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 1.2068259716033936
Epoch: 14, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.846 Vali Acc: 0.671 Test Loss: 0.846 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1468982696533203
Epoch: 15, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.809 Vali Acc: 0.684 Test Loss: 0.809 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684202).  Saving model ...
Epoch: 16 cost time: 1.1439955234527588
Epoch: 16, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.778 Vali Acc: 0.704 Test Loss: 0.778 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 1.2021589279174805
Epoch: 17, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 18 cost time: 1.1999866962432861
Epoch: 18, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.715 Vali Acc: 0.730 Test Loss: 0.715 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 1.170414924621582
Epoch: 19, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1479885578155518
Epoch: 20, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.659 Vali Acc: 0.750 Test Loss: 0.659 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 1.1952714920043945
Epoch: 21, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.643 Vali Acc: 0.743 Test Loss: 0.643 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1659629344940186
Epoch: 22, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 1.1656498908996582
Epoch: 23, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.611 Vali Acc: 0.763 Test Loss: 0.611 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 1.2289164066314697
Epoch: 24, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.596 Vali Acc: 0.770 Test Loss: 0.596 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 25 cost time: 1.216756820678711
Epoch: 25, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 1.090876579284668
Epoch: 26, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.290248155593872
Epoch: 27, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 28 cost time: 1.1428797245025635
Epoch: 28, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.546 Vali Acc: 0.770 Test Loss: 0.546 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.226073980331421
Epoch: 29, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 1.1052136421203613
Epoch: 30, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 31 cost time: 1.1159186363220215
Epoch: 31, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 1.107844591140747
Epoch: 32, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815784).  Saving model ...
Epoch: 33 cost time: 1.1712892055511475
Epoch: 33, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1736092567443848
Epoch: 34, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.503 Vali Acc: 0.789 Test Loss: 0.503 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.156710147857666
Epoch: 35, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.503 Vali Acc: 0.789 Test Loss: 0.503 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1913630962371826
Epoch: 36, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1053452491760254
Epoch: 37, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0326061248779297
Epoch: 38, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1310386657714844
Epoch: 39, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.130228042602539
Epoch: 40, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1567673683166504
Epoch: 41, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822364).  Saving model ...
Epoch: 42 cost time: 1.1323232650756836
Epoch: 42, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0831284523010254
Epoch: 43, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3218238353729248
Epoch: 44, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2502434253692627
Epoch: 45, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.192023515701294
Epoch: 46, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.177159070968628
Epoch: 47, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2454798221588135
Epoch: 48, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3399596214294434
Epoch: 49, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2549796104431152
Epoch: 50, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.1465163230895996
Epoch: 51, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 26388
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.553964138031006
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.457 Vali Acc: 0.257 Test Loss: 1.457 Test Acc: 0.257
Validation loss decreased (inf --> -0.256564).  Saving model ...
Epoch: 2 cost time: 1.1822504997253418
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.431 Vali Acc: 0.276 Test Loss: 1.431 Test Acc: 0.276
Validation loss decreased (-0.256564 --> -0.276301).  Saving model ...
Epoch: 3 cost time: 1.1198406219482422
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.396 Vali Acc: 0.316 Test Loss: 1.396 Test Acc: 0.316
Validation loss decreased (-0.276301 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 1.084092617034912
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.352 Vali Acc: 0.336 Test Loss: 1.352 Test Acc: 0.336
Validation loss decreased (-0.315776 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 1.0926826000213623
Epoch: 5, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.304 Vali Acc: 0.428 Test Loss: 1.304 Test Acc: 0.428
Validation loss decreased (-0.335513 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 1.1267266273498535
Epoch: 6, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.257 Vali Acc: 0.493 Test Loss: 1.257 Test Acc: 0.493
Validation loss decreased (-0.427619 --> -0.493408).  Saving model ...
Epoch: 7 cost time: 1.1295921802520752
Epoch: 7, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.211 Vali Acc: 0.546 Test Loss: 1.211 Test Acc: 0.546
Validation loss decreased (-0.493408 --> -0.546041).  Saving model ...
Epoch: 8 cost time: 1.1394898891448975
Epoch: 8, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.164 Vali Acc: 0.592 Test Loss: 1.164 Test Acc: 0.592
Validation loss decreased (-0.546041 --> -0.592094).  Saving model ...
Epoch: 9 cost time: 1.1907260417938232
Epoch: 9, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.116 Vali Acc: 0.605 Test Loss: 1.116 Test Acc: 0.605
Validation loss decreased (-0.592094 --> -0.605252).  Saving model ...
Epoch: 10 cost time: 1.1427562236785889
Epoch: 10, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.067 Vali Acc: 0.645 Test Loss: 1.067 Test Acc: 0.645
Validation loss decreased (-0.605252 --> -0.644726).  Saving model ...
Epoch: 11 cost time: 1.2255148887634277
Epoch: 11, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.023 Vali Acc: 0.651 Test Loss: 1.023 Test Acc: 0.651
Validation loss decreased (-0.644726 --> -0.651306).  Saving model ...
Epoch: 12 cost time: 1.2389695644378662
Epoch: 12, Steps: 10 | Train Loss: 0.845 Vali Loss: 0.978 Vali Acc: 0.691 Test Loss: 0.978 Test Acc: 0.691
Validation loss decreased (-0.651306 --> -0.690780).  Saving model ...
Epoch: 13 cost time: 1.2097883224487305
Epoch: 13, Steps: 10 | Train Loss: 0.777 Vali Loss: 0.935 Vali Acc: 0.711 Test Loss: 0.935 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710517).  Saving model ...
Epoch: 14 cost time: 1.2092957496643066
Epoch: 14, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.895 Vali Acc: 0.711 Test Loss: 0.895 Test Acc: 0.711
Validation loss decreased (-0.710517 --> -0.710517).  Saving model ...
Epoch: 15 cost time: 1.406285047531128
Epoch: 15, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.862 Vali Acc: 0.717 Test Loss: 0.862 Test Acc: 0.717
Validation loss decreased (-0.710517 --> -0.717097).  Saving model ...
Epoch: 16 cost time: 1.2792689800262451
Epoch: 16, Steps: 10 | Train Loss: 0.640 Vali Loss: 0.825 Vali Acc: 0.711 Test Loss: 0.825 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1351478099822998
Epoch: 17, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.790 Vali Acc: 0.717 Test Loss: 0.790 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717097).  Saving model ...
Epoch: 18 cost time: 1.2962303161621094
Epoch: 18, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.760 Vali Acc: 0.730 Test Loss: 0.760 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 1.197028636932373
Epoch: 19, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.735 Vali Acc: 0.737 Test Loss: 0.735 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 20 cost time: 1.2513012886047363
Epoch: 20, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.703 Vali Acc: 0.730 Test Loss: 0.703 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.176210641860962
Epoch: 21, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.680 Vali Acc: 0.743 Test Loss: 0.680 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 22 cost time: 1.2382183074951172
Epoch: 22, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3466544151306152
Epoch: 23, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.642 Vali Acc: 0.743 Test Loss: 0.642 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 24 cost time: 1.2530691623687744
Epoch: 24, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.626 Vali Acc: 0.743 Test Loss: 0.626 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 1.1448588371276855
Epoch: 25, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 26 cost time: 1.103933334350586
Epoch: 26, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 27 cost time: 1.23177170753479
Epoch: 27, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 28 cost time: 1.1881639957427979
Epoch: 28, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.2206177711486816
Epoch: 29, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.564 Vali Acc: 0.770 Test Loss: 0.564 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 30 cost time: 1.3725650310516357
Epoch: 30, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 31 cost time: 1.2161667346954346
Epoch: 31, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 32 cost time: 1.105738639831543
Epoch: 32, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2071232795715332
Epoch: 33, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 34 cost time: 1.2079336643218994
Epoch: 34, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 35 cost time: 1.2161681652069092
Epoch: 35, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.204585075378418
Epoch: 36, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796047).  Saving model ...
Epoch: 37 cost time: 1.104668378829956
Epoch: 37, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 38 cost time: 1.1360228061676025
Epoch: 38, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 39 cost time: 1.2425436973571777
Epoch: 39, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 40 cost time: 1.1400837898254395
Epoch: 40, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2305238246917725
Epoch: 41, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 42 cost time: 1.0521245002746582
Epoch: 42, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 43 cost time: 1.1471681594848633
Epoch: 43, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2029333114624023
Epoch: 44, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 45 cost time: 1.1516914367675781
Epoch: 45, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1451263427734375
Epoch: 46, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2134950160980225
Epoch: 47, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2740778923034668
Epoch: 48, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2071478366851807
Epoch: 49, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2942464351654053
Epoch: 50, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1132168769836426
Epoch: 51, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 52 cost time: 1.1218132972717285
Epoch: 52, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2071592807769775
Epoch: 53, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1727581024169922
Epoch: 54, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.1781790256500244
Epoch: 55, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.112299919128418
Epoch: 56, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.0821936130523682
Epoch: 57, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0742030143737793
Epoch: 58, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.1238784790039062
Epoch: 59, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.265312910079956
Epoch: 60, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.169501781463623
Epoch: 61, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 26388
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.289306640625
Epoch: 1, Steps: 10 | Train Loss: 1.529 Vali Loss: 1.406 Vali Acc: 0.289 Test Loss: 1.406 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.1355204582214355
Epoch: 2, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.371 Vali Acc: 0.296 Test Loss: 1.371 Test Acc: 0.296
Validation loss decreased (-0.289460 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.1908481121063232
Epoch: 3, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.328 Vali Acc: 0.342 Test Loss: 1.328 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.0589632987976074
Epoch: 4, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.282 Vali Acc: 0.362 Test Loss: 1.282 Test Acc: 0.362
Validation loss decreased (-0.342092 --> -0.361829).  Saving model ...
Epoch: 5 cost time: 1.1657710075378418
Epoch: 5, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.229 Vali Acc: 0.414 Test Loss: 1.229 Test Acc: 0.414
Validation loss decreased (-0.361829 --> -0.414461).  Saving model ...
Epoch: 6 cost time: 1.0997190475463867
Epoch: 6, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.176 Vali Acc: 0.493 Test Loss: 1.176 Test Acc: 0.493
Validation loss decreased (-0.414461 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 1.0995001792907715
Epoch: 7, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.116 Vali Acc: 0.559 Test Loss: 1.116 Test Acc: 0.559
Validation loss decreased (-0.493409 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 1.0839495658874512
Epoch: 8, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.063 Vali Acc: 0.586 Test Loss: 1.063 Test Acc: 0.586
Validation loss decreased (-0.559199 --> -0.585516).  Saving model ...
Epoch: 9 cost time: 1.1406259536743164
Epoch: 9, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.007 Vali Acc: 0.605 Test Loss: 1.007 Test Acc: 0.605
Validation loss decreased (-0.585516 --> -0.605253).  Saving model ...
Epoch: 10 cost time: 1.2066941261291504
Epoch: 10, Steps: 10 | Train Loss: 0.843 Vali Loss: 0.954 Vali Acc: 0.625 Test Loss: 0.954 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 1.1307010650634766
Epoch: 11, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.908 Vali Acc: 0.645 Test Loss: 0.908 Test Acc: 0.645
Validation loss decreased (-0.624990 --> -0.644728).  Saving model ...
Epoch: 12 cost time: 1.1565048694610596
Epoch: 12, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.863 Vali Acc: 0.645 Test Loss: 0.863 Test Acc: 0.645
Validation loss decreased (-0.644728 --> -0.644728).  Saving model ...
Epoch: 13 cost time: 1.1729421615600586
Epoch: 13, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.830 Vali Acc: 0.664 Test Loss: 0.830 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664465).  Saving model ...
Epoch: 14 cost time: 1.1042442321777344
Epoch: 14, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.794 Vali Acc: 0.684 Test Loss: 0.794 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684203).  Saving model ...
Epoch: 15 cost time: 1.2511730194091797
Epoch: 15, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.760 Vali Acc: 0.711 Test Loss: 0.760 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 16 cost time: 1.1926839351654053
Epoch: 16, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.728 Vali Acc: 0.724 Test Loss: 0.728 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 1.196761131286621
Epoch: 17, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.701 Vali Acc: 0.730 Test Loss: 0.701 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 1.1905996799468994
Epoch: 18, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 19 cost time: 1.2661807537078857
Epoch: 19, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.647 Vali Acc: 0.757 Test Loss: 0.647 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 20 cost time: 1.1529176235198975
Epoch: 20, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.629 Vali Acc: 0.763 Test Loss: 0.629 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 1.032580852508545
Epoch: 21, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.610 Vali Acc: 0.770 Test Loss: 0.610 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 1.210214614868164
Epoch: 22, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1873514652252197
Epoch: 23, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 24 cost time: 1.0828475952148438
Epoch: 24, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 25 cost time: 1.1405529975891113
Epoch: 25, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 1.0793704986572266
Epoch: 26, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1692512035369873
Epoch: 27, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1812047958374023
Epoch: 28, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 29 cost time: 1.1296496391296387
Epoch: 29, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 30 cost time: 1.2890005111694336
Epoch: 30, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.180227518081665
Epoch: 31, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.146219253540039
Epoch: 32, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1132392883300781
Epoch: 33, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 34 cost time: 1.1293556690216064
Epoch: 34, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 35 cost time: 1.267699956893921
Epoch: 35, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 36 cost time: 1.2105989456176758
Epoch: 36, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822363).  Saving model ...
Epoch: 37 cost time: 1.1751790046691895
Epoch: 37, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1343662738800049
Epoch: 38, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.234907627105713
Epoch: 39, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2512848377227783
Epoch: 40, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3212625980377197
Epoch: 41, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.262153148651123
Epoch: 42, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1876018047332764
Epoch: 43, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1239020824432373
Epoch: 44, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.2140557765960693
Epoch: 45, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1174311637878418
Epoch: 46, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 18196
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.413925886154175
Epoch: 1, Steps: 10 | Train Loss: 1.518 Vali Loss: 1.389 Vali Acc: 0.283 Test Loss: 1.389 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.077282190322876
Epoch: 2, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.358 Vali Acc: 0.322 Test Loss: 1.358 Test Acc: 0.322
Validation loss decreased (-0.282881 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.0588641166687012
Epoch: 3, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.316 Vali Acc: 0.342 Test Loss: 1.316 Test Acc: 0.342
Validation loss decreased (-0.322355 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.1997931003570557
Epoch: 4, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.269 Vali Acc: 0.375 Test Loss: 1.269 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.2344460487365723
Epoch: 5, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.223 Vali Acc: 0.421 Test Loss: 1.223 Test Acc: 0.421
Validation loss decreased (-0.374987 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 1.1148061752319336
Epoch: 6, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.171 Vali Acc: 0.507 Test Loss: 1.171 Test Acc: 0.507
Validation loss decreased (-0.421040 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.140489101409912
Epoch: 7, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.115 Vali Acc: 0.572 Test Loss: 1.115 Test Acc: 0.572
Validation loss decreased (-0.506567 --> -0.572357).  Saving model ...
Epoch: 8 cost time: 1.0622410774230957
Epoch: 8, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.065 Vali Acc: 0.625 Test Loss: 1.065 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.050248622894287
Epoch: 9, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.010 Vali Acc: 0.625 Test Loss: 1.010 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.9738404750823975
Epoch: 10, Steps: 10 | Train Loss: 0.869 Vali Loss: 0.954 Vali Acc: 0.632 Test Loss: 0.954 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631569).  Saving model ...
Epoch: 11 cost time: 1.0152502059936523
Epoch: 11, Steps: 10 | Train Loss: 0.811 Vali Loss: 0.911 Vali Acc: 0.651 Test Loss: 0.911 Test Acc: 0.651
Validation loss decreased (-0.631569 --> -0.651307).  Saving model ...
Epoch: 12 cost time: 1.202380657196045
Epoch: 12, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.865 Vali Acc: 0.664 Test Loss: 0.865 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664465).  Saving model ...
Epoch: 13 cost time: 1.1654486656188965
Epoch: 13, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.828 Vali Acc: 0.671 Test Loss: 0.828 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671044).  Saving model ...
Epoch: 14 cost time: 1.0797977447509766
Epoch: 14, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.786 Vali Acc: 0.697 Test Loss: 0.786 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697361).  Saving model ...
Epoch: 15 cost time: 1.1247162818908691
Epoch: 15, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.753 Vali Acc: 0.704 Test Loss: 0.753 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 1.170257806777954
Epoch: 16, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.723 Vali Acc: 0.704 Test Loss: 0.723 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 1.4121136665344238
Epoch: 17, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.696 Vali Acc: 0.730 Test Loss: 0.696 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 1.2258262634277344
Epoch: 18, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.670 Vali Acc: 0.730 Test Loss: 0.670 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 1.1701035499572754
Epoch: 19, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.646 Vali Acc: 0.724 Test Loss: 0.646 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.195042610168457
Epoch: 20, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.630 Vali Acc: 0.743 Test Loss: 0.630 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 21 cost time: 1.1352534294128418
Epoch: 21, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 1.0099906921386719
Epoch: 22, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.1589224338531494
Epoch: 23, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.275834321975708
Epoch: 24, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 25 cost time: 1.2808794975280762
Epoch: 25, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 26 cost time: 0.9991245269775391
Epoch: 26, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0715086460113525
Epoch: 27, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 28 cost time: 1.133760690689087
Epoch: 28, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1559479236602783
Epoch: 29, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3545396327972412
Epoch: 30, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3083274364471436
Epoch: 31, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 32 cost time: 1.0771641731262207
Epoch: 32, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4463245868682861
Epoch: 33, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 34 cost time: 1.3220460414886475
Epoch: 34, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1896698474884033
Epoch: 35, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1329751014709473
Epoch: 36, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2239112854003906
Epoch: 37, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 38 cost time: 1.1763982772827148
Epoch: 38, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 39 cost time: 1.105654239654541
Epoch: 39, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1857807636260986
Epoch: 40, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.194021224975586
Epoch: 41, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2331492900848389
Epoch: 42, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0338068008422852
Epoch: 43, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0487091541290283
Epoch: 44, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.214423418045044
Epoch: 45, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.093186616897583
Epoch: 46, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2649366855621338
Epoch: 47, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.1661925315856934
Epoch: 48, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 18196
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.276552677154541
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.378 Vali Acc: 0.263 Test Loss: 1.378 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.12270188331604
Epoch: 2, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.349 Vali Acc: 0.303 Test Loss: 1.349 Test Acc: 0.303
Validation loss decreased (-0.263144 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.107654094696045
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.311 Vali Acc: 0.355 Test Loss: 1.311 Test Acc: 0.355
Validation loss decreased (-0.302618 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 0.9846150875091553
Epoch: 4, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.267 Vali Acc: 0.401 Test Loss: 1.267 Test Acc: 0.401
Validation loss decreased (-0.355250 --> -0.401303).  Saving model ...
Epoch: 5 cost time: 1.1487462520599365
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.224 Vali Acc: 0.461 Test Loss: 1.224 Test Acc: 0.461
Validation loss decreased (-0.401303 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 1.1419641971588135
Epoch: 6, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.178 Vali Acc: 0.520 Test Loss: 1.178 Test Acc: 0.520
Validation loss decreased (-0.460514 --> -0.519725).  Saving model ...
Epoch: 7 cost time: 1.2238705158233643
Epoch: 7, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.128 Vali Acc: 0.546 Test Loss: 1.128 Test Acc: 0.546
Validation loss decreased (-0.519725 --> -0.546041).  Saving model ...
Epoch: 8 cost time: 1.2935459613800049
Epoch: 8, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.080 Vali Acc: 0.586 Test Loss: 1.080 Test Acc: 0.586
Validation loss decreased (-0.546041 --> -0.585516).  Saving model ...
Epoch: 9 cost time: 1.046933889389038
Epoch: 9, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.028 Vali Acc: 0.592 Test Loss: 1.028 Test Acc: 0.592
Validation loss decreased (-0.585516 --> -0.592095).  Saving model ...
Epoch: 10 cost time: 1.1246609687805176
Epoch: 10, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.977 Vali Acc: 0.612 Test Loss: 0.977 Test Acc: 0.612
Validation loss decreased (-0.592095 --> -0.611832).  Saving model ...
Epoch: 11 cost time: 1.0311894416809082
Epoch: 11, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.931 Vali Acc: 0.625 Test Loss: 0.931 Test Acc: 0.625
Validation loss decreased (-0.611832 --> -0.624991).  Saving model ...
Epoch: 12 cost time: 1.2133705615997314
Epoch: 12, Steps: 10 | Train Loss: 0.767 Vali Loss: 0.884 Vali Acc: 0.651 Test Loss: 0.884 Test Acc: 0.651
Validation loss decreased (-0.624991 --> -0.651307).  Saving model ...
Epoch: 13 cost time: 1.1182184219360352
Epoch: 13, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.847 Vali Acc: 0.671 Test Loss: 0.847 Test Acc: 0.671
Validation loss decreased (-0.651307 --> -0.671044).  Saving model ...
Epoch: 14 cost time: 1.123114824295044
Epoch: 14, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.810 Vali Acc: 0.691 Test Loss: 0.810 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690781).  Saving model ...
Epoch: 15 cost time: 1.1655676364898682
Epoch: 15, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.777 Vali Acc: 0.704 Test Loss: 0.777 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 1.1678211688995361
Epoch: 16, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 17 cost time: 1.1472728252410889
Epoch: 17, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.719 Vali Acc: 0.697 Test Loss: 0.719 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0830283164978027
Epoch: 18, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.694 Vali Acc: 0.704 Test Loss: 0.694 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2338898181915283
Epoch: 19, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717099).  Saving model ...
Epoch: 20 cost time: 1.238823652267456
Epoch: 20, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 21 cost time: 1.253352165222168
Epoch: 21, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.636 Vali Acc: 0.737 Test Loss: 0.636 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 22 cost time: 1.1496765613555908
Epoch: 22, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 1.1420226097106934
Epoch: 23, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 1.2524425983428955
Epoch: 24, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2116196155548096
Epoch: 25, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 1.1746854782104492
Epoch: 26, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 1.1169342994689941
Epoch: 27, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 1.0934169292449951
Epoch: 28, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 29 cost time: 1.2029547691345215
Epoch: 29, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 30 cost time: 1.2171533107757568
Epoch: 30, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1031737327575684
Epoch: 31, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 32 cost time: 1.103332281112671
Epoch: 32, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2890453338623047
Epoch: 33, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1911039352416992
Epoch: 34, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 35 cost time: 1.2112598419189453
Epoch: 35, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2217955589294434
Epoch: 36, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 37 cost time: 1.1432149410247803
Epoch: 37, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2043006420135498
Epoch: 38, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2120208740234375
Epoch: 39, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2144997119903564
Epoch: 40, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.483 Vali Acc: 0.816 Test Loss: 0.483 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1656596660614014
Epoch: 41, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1868982315063477
Epoch: 42, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 43 cost time: 1.1799449920654297
Epoch: 43, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.480 Vali Acc: 0.816 Test Loss: 0.480 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9863603115081787
Epoch: 44, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.027461051940918
Epoch: 45, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.213280200958252
Epoch: 46, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.483 Vali Acc: 0.816 Test Loss: 0.483 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0646843910217285
Epoch: 47, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1918556690216064
Epoch: 48, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1076116561889648
Epoch: 49, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1572747230529785
Epoch: 50, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.1748087406158447
Epoch: 51, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.068885087966919
Epoch: 52, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 18196
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9279708862304688
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.399 Vali Acc: 0.257 Test Loss: 1.399 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.071936845779419
Epoch: 2, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.374 Vali Acc: 0.303 Test Loss: 1.374 Test Acc: 0.303
Validation loss decreased (-0.256565 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.0993003845214844
Epoch: 3, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.341 Vali Acc: 0.342 Test Loss: 1.341 Test Acc: 0.342
Validation loss decreased (-0.302618 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.1691555976867676
Epoch: 4, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.307 Vali Acc: 0.368 Test Loss: 1.307 Test Acc: 0.368
Validation loss decreased (-0.342092 --> -0.368408).  Saving model ...
Epoch: 5 cost time: 1.1423900127410889
Epoch: 5, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.270 Vali Acc: 0.441 Test Loss: 1.270 Test Acc: 0.441
Validation loss decreased (-0.368408 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 1.2977454662322998
Epoch: 6, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.229 Vali Acc: 0.507 Test Loss: 1.229 Test Acc: 0.507
Validation loss decreased (-0.440777 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.2748990058898926
Epoch: 7, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.184 Vali Acc: 0.566 Test Loss: 1.184 Test Acc: 0.566
Validation loss decreased (-0.506567 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 1.0924606323242188
Epoch: 8, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.140 Vali Acc: 0.566 Test Loss: 1.140 Test Acc: 0.566
Validation loss decreased (-0.565778 --> -0.565778).  Saving model ...
Epoch: 9 cost time: 1.1687710285186768
Epoch: 9, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.096 Vali Acc: 0.559 Test Loss: 1.096 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1992430686950684
Epoch: 10, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.050 Vali Acc: 0.579 Test Loss: 1.050 Test Acc: 0.579
Validation loss decreased (-0.565778 --> -0.578937).  Saving model ...
Epoch: 11 cost time: 0.9747552871704102
Epoch: 11, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.006 Vali Acc: 0.605 Test Loss: 1.006 Test Acc: 0.605
Validation loss decreased (-0.578937 --> -0.605253).  Saving model ...
Epoch: 12 cost time: 1.0669965744018555
Epoch: 12, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.964 Vali Acc: 0.632 Test Loss: 0.964 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631569).  Saving model ...
Epoch: 13 cost time: 1.1969130039215088
Epoch: 13, Steps: 10 | Train Loss: 0.783 Vali Loss: 0.926 Vali Acc: 0.651 Test Loss: 0.926 Test Acc: 0.651
Validation loss decreased (-0.631569 --> -0.651307).  Saving model ...
Epoch: 14 cost time: 0.9716649055480957
Epoch: 14, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.891 Vali Acc: 0.658 Test Loss: 0.891 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657886).  Saving model ...
Epoch: 15 cost time: 1.0673034191131592
Epoch: 15, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.852 Vali Acc: 0.678 Test Loss: 0.852 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 16 cost time: 0.9934303760528564
Epoch: 16, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.821 Vali Acc: 0.684 Test Loss: 0.821 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 1.1101820468902588
Epoch: 17, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.790 Vali Acc: 0.684 Test Loss: 0.790 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 18 cost time: 0.9913139343261719
Epoch: 18, Steps: 10 | Train Loss: 0.579 Vali Loss: 0.760 Vali Acc: 0.711 Test Loss: 0.760 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 19 cost time: 1.0791220664978027
Epoch: 19, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.730 Vali Acc: 0.757 Test Loss: 0.730 Test Acc: 0.757
Validation loss decreased (-0.710519 --> -0.756572).  Saving model ...
Epoch: 20 cost time: 1.1269972324371338
Epoch: 20, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.704 Vali Acc: 0.770 Test Loss: 0.704 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 1.0884337425231934
Epoch: 21, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 1.122410535812378
Epoch: 22, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.664 Vali Acc: 0.776 Test Loss: 0.664 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1554856300354004
Epoch: 23, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.646 Vali Acc: 0.770 Test Loss: 0.646 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.187422752380371
Epoch: 24, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.635 Vali Acc: 0.763 Test Loss: 0.635 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0173556804656982
Epoch: 25, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0479168891906738
Epoch: 26, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796047).  Saving model ...
Epoch: 27 cost time: 1.1658458709716797
Epoch: 27, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 28 cost time: 1.0324325561523438
Epoch: 28, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 29 cost time: 1.080610990524292
Epoch: 29, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9896748065948486
Epoch: 30, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0068416595458984
Epoch: 31, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1861536502838135
Epoch: 32, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0419197082519531
Epoch: 33, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.113466501235962
Epoch: 34, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9498753547668457
Epoch: 35, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1933212280273438
Epoch: 36, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0792653560638428
Epoch: 37, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0912628173828125
Epoch: 38, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 18196
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1846816539764404
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.289 Vali Acc: 0.421 Test Loss: 1.289 Test Acc: 0.421
Validation loss decreased (inf --> -0.421040).  Saving model ...
Epoch: 2 cost time: 1.0493783950805664
Epoch: 2, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.007 Vali Acc: 0.632 Test Loss: 1.007 Test Acc: 0.632
Validation loss decreased (-0.421040 --> -0.631569).  Saving model ...
Epoch: 3 cost time: 1.1394751071929932
Epoch: 3, Steps: 10 | Train Loss: 0.650 Vali Loss: 0.770 Vali Acc: 0.691 Test Loss: 0.770 Test Acc: 0.691
Validation loss decreased (-0.631569 --> -0.690782).  Saving model ...
Epoch: 4 cost time: 1.0433909893035889
Epoch: 4, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
Validation loss decreased (-0.690782 --> -0.736836).  Saving model ...
Epoch: 5 cost time: 1.1478331089019775
Epoch: 5, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.549 Vali Acc: 0.776 Test Loss: 0.549 Test Acc: 0.776
Validation loss decreased (-0.736836 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.1778266429901123
Epoch: 6, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 7 cost time: 1.0161898136138916
Epoch: 7, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1005215644836426
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 9 cost time: 0.9330530166625977
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 10 cost time: 1.2733793258666992
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2386507987976074
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0603747367858887
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0704801082611084
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.002981185913086
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0906448364257812
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1149046421051025
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1387436389923096
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9725961685180664
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.187023401260376
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2732441425323486
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.796 Test Loss: 0.600 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1558501720428467
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1303668022155762
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1054797172546387
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2704428
model size : 20.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9326536655426025
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.300 Vali Acc: 0.421 Test Loss: 1.300 Test Acc: 0.421
Validation loss decreased (inf --> -0.421040).  Saving model ...
Epoch: 2 cost time: 0.9342086315155029
Epoch: 2, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.022 Vali Acc: 0.612 Test Loss: 1.022 Test Acc: 0.612
Validation loss decreased (-0.421040 --> -0.611832).  Saving model ...
Epoch: 3 cost time: 1.0071437358856201
Epoch: 3, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.783 Vali Acc: 0.664 Test Loss: 0.783 Test Acc: 0.664
Validation loss decreased (-0.611832 --> -0.664466).  Saving model ...
Epoch: 4 cost time: 1.0115962028503418
Epoch: 4, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.636 Vali Acc: 0.730 Test Loss: 0.636 Test Acc: 0.730
Validation loss decreased (-0.664466 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 0.9974851608276367
Epoch: 5, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
Validation loss decreased (-0.730257 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 0.9181160926818848
Epoch: 6, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789469).  Saving model ...
Epoch: 7 cost time: 1.0381157398223877
Epoch: 7, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 8 cost time: 0.9956605434417725
Epoch: 8, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 9 cost time: 0.981773853302002
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 10 cost time: 0.9880142211914062
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8984603881835938
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9051511287689209
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9849088191986084
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9452660083770752
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0014259815216064
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.895421028137207
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 0.8900961875915527
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.046846628189087
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9828894138336182
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0354762077331543
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9781653881072998
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0625300407409668
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0211994647979736
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.947324275970459
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.014498233795166
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8954322338104248
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2704428
model size : 20.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.126603603363037
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.298 Vali Acc: 0.375 Test Loss: 1.298 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.02500581741333
Epoch: 2, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.043 Vali Acc: 0.599 Test Loss: 1.043 Test Acc: 0.599
Validation loss decreased (-0.374987 --> -0.598674).  Saving model ...
Epoch: 3 cost time: 1.170623540878296
Epoch: 3, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.804 Vali Acc: 0.658 Test Loss: 0.804 Test Acc: 0.658
Validation loss decreased (-0.598674 --> -0.657887).  Saving model ...
Epoch: 4 cost time: 1.0059266090393066
Epoch: 4, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.651 Vali Acc: 0.737 Test Loss: 0.651 Test Acc: 0.737
Validation loss decreased (-0.657887 --> -0.736836).  Saving model ...
Epoch: 5 cost time: 0.9317827224731445
Epoch: 5, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 0.9168145656585693
Epoch: 6, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776311).  Saving model ...
Epoch: 7 cost time: 0.9376544952392578
Epoch: 7, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 8 cost time: 1.1389515399932861
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.486 Vali Acc: 0.803 Test Loss: 0.486 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 9 cost time: 1.0013737678527832
Epoch: 9, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 10 cost time: 1.017413854598999
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 1.0084891319274902
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0472643375396729
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0604841709136963
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9900038242340088
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.007561445236206
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9941041469573975
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.796 Test Loss: 0.558 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0062634944915771
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9977960586547852
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0553014278411865
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1067512035369873
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 2704428
model size : 20.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3057098388671875
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.298 Vali Acc: 0.414 Test Loss: 1.298 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 0.9477362632751465
Epoch: 2, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.078 Vali Acc: 0.572 Test Loss: 1.078 Test Acc: 0.572
Validation loss decreased (-0.414461 --> -0.572358).  Saving model ...
Epoch: 3 cost time: 1.096052646636963
Epoch: 3, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.852 Vali Acc: 0.704 Test Loss: 0.852 Test Acc: 0.704
Validation loss decreased (-0.572358 --> -0.703939).  Saving model ...
Epoch: 4 cost time: 1.1892905235290527
Epoch: 4, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 5 cost time: 1.0565402507781982
Epoch: 5, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
Validation loss decreased (-0.736835 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.0700433254241943
Epoch: 6, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9652760028839111
Epoch: 7, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.140411615371704
Epoch: 8, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 0.8938117027282715
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.025583267211914
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.013956069946289
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0544581413269043
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.0201807022094727
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0186131000518799
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1917672157287598
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1095995903015137
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9365901947021484
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.642 Vali Acc: 0.796 Test Loss: 0.642 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9848525524139404
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.996269702911377
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.087902545928955
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9510903358459473
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9222900867462158
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2704428
model size : 20.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0166451930999756
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.261 Vali Acc: 0.428 Test Loss: 1.261 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 0.9831905364990234
Epoch: 2, Steps: 10 | Train Loss: 1.027 Vali Loss: 0.972 Vali Acc: 0.645 Test Loss: 0.972 Test Acc: 0.645
Validation loss decreased (-0.427619 --> -0.644727).  Saving model ...
Epoch: 3 cost time: 1.071462631225586
Epoch: 3, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.734 Vali Acc: 0.737 Test Loss: 0.734 Test Acc: 0.737
Validation loss decreased (-0.644727 --> -0.736835).  Saving model ...
Epoch: 4 cost time: 1.0457546710968018
Epoch: 4, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.615 Vali Acc: 0.763 Test Loss: 0.615 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 5 cost time: 1.0425841808319092
Epoch: 5, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 6 cost time: 1.1172826290130615
Epoch: 6, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 7 cost time: 1.042076587677002
Epoch: 7, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 8 cost time: 1.0302329063415527
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0575451850891113
Epoch: 9, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0292811393737793
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9859519004821777
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1088714599609375
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.0716397762298584
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9526960849761963
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0459387302398682
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9725096225738525
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0236289501190186
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.141817331314087
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0674269199371338
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9900486469268799
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1131982803344727
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.035609245300293
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1655852
model size : 16.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0954904556274414
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.264 Vali Acc: 0.434 Test Loss: 1.264 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 0.9257848262786865
Epoch: 2, Steps: 10 | Train Loss: 1.051 Vali Loss: 0.993 Vali Acc: 0.645 Test Loss: 0.993 Test Acc: 0.645
Validation loss decreased (-0.434198 --> -0.644727).  Saving model ...
Epoch: 3 cost time: 1.0888328552246094
Epoch: 3, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.749 Vali Acc: 0.704 Test Loss: 0.749 Test Acc: 0.704
Validation loss decreased (-0.644727 --> -0.703940).  Saving model ...
Epoch: 4 cost time: 0.9617888927459717
Epoch: 4, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
Validation loss decreased (-0.703940 --> -0.756573).  Saving model ...
Epoch: 5 cost time: 0.9694294929504395
Epoch: 5, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 0.9362592697143555
Epoch: 6, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.487 Vali Acc: 0.783 Test Loss: 0.487 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782890).  Saving model ...
Epoch: 7 cost time: 0.9659078121185303
Epoch: 7, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.479 Vali Acc: 0.796 Test Loss: 0.479 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 8 cost time: 1.0211288928985596
Epoch: 8, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9938511848449707
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9473657608032227
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8924422264099121
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9845609664916992
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.0484893321990967
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.0070781707763672
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0308396816253662
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.836 Test Loss: 0.537 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835521).  Saving model ...
Epoch: 16 cost time: 0.9665496349334717
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1021504402160645
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.829 Test Loss: 0.552 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0814006328582764
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.836 Test Loss: 0.559 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0194268226623535
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9946179389953613
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0044775009155273
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.010951042175293
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0557496547698975
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.829 Test Loss: 0.591 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0008983612060547
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0273659229278564
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.829 Test Loss: 0.598 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 1655852
model size : 16.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.997950553894043
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.290 Vali Acc: 0.401 Test Loss: 1.290 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 0.9967234134674072
Epoch: 2, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.041 Vali Acc: 0.638 Test Loss: 1.041 Test Acc: 0.638
Validation loss decreased (-0.401303 --> -0.638147).  Saving model ...
Epoch: 3 cost time: 0.9933149814605713
Epoch: 3, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.792 Vali Acc: 0.711 Test Loss: 0.792 Test Acc: 0.711
Validation loss decreased (-0.638147 --> -0.710518).  Saving model ...
Epoch: 4 cost time: 0.9803214073181152
Epoch: 4, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.646 Vali Acc: 0.757 Test Loss: 0.646 Test Acc: 0.757
Validation loss decreased (-0.710518 --> -0.756572).  Saving model ...
Epoch: 5 cost time: 0.9001932144165039
Epoch: 5, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 0.9443497657775879
Epoch: 6, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
Validation loss decreased (-0.763152 --> -0.796048).  Saving model ...
Epoch: 7 cost time: 0.9241516590118408
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.482 Vali Acc: 0.796 Test Loss: 0.482 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 8 cost time: 1.0097577571868896
Epoch: 8, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0631287097930908
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 1.1315441131591797
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0586597919464111
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1202383041381836
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1223084926605225
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0386149883270264
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 1.0248925685882568
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.007584571838379
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0767107009887695
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0276894569396973
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0431463718414307
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1356258392333984
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0843236446380615
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9966855049133301
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8893444538116455
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0399913787841797
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1655852
model size : 16.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.271474838256836
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.318 Vali Acc: 0.401 Test Loss: 1.318 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 0.9638447761535645
Epoch: 2, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.103 Vali Acc: 0.572 Test Loss: 1.103 Test Acc: 0.572
Validation loss decreased (-0.401303 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.070737600326538
Epoch: 3, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.858 Vali Acc: 0.671 Test Loss: 0.858 Test Acc: 0.671
Validation loss decreased (-0.572357 --> -0.671044).  Saving model ...
Epoch: 4 cost time: 0.8804521560668945
Epoch: 4, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.704 Vali Acc: 0.717 Test Loss: 0.704 Test Acc: 0.717
Validation loss decreased (-0.671044 --> -0.717098).  Saving model ...
Epoch: 5 cost time: 1.0649363994598389
Epoch: 5, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.606 Vali Acc: 0.743 Test Loss: 0.606 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 0.9521090984344482
Epoch: 6, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
Validation loss decreased (-0.743415 --> -0.789468).  Saving model ...
Epoch: 7 cost time: 1.0840237140655518
Epoch: 7, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.522 Vali Acc: 0.776 Test Loss: 0.522 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9501514434814453
Epoch: 8, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.0213305950164795
Epoch: 9, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0100131034851074
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9671318531036377
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.0402600765228271
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0141282081604004
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1039130687713623
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9568362236022949
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0562224388122559
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0888245105743408
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.633 Vali Acc: 0.783 Test Loss: 0.633 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9840669631958008
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9280545711517334
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1164612770080566
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.662 Vali Acc: 0.776 Test Loss: 0.662 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0275938510894775
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.667 Vali Acc: 0.783 Test Loss: 0.667 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1655852
model size : 16.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9242937564849854
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.261 Vali Acc: 0.421 Test Loss: 1.261 Test Acc: 0.421
Validation loss decreased (inf --> -0.421040).  Saving model ...
Epoch: 2 cost time: 1.0244908332824707
Epoch: 2, Steps: 10 | Train Loss: 0.997 Vali Loss: 0.967 Vali Acc: 0.605 Test Loss: 0.967 Test Acc: 0.605
Validation loss decreased (-0.421040 --> -0.605253).  Saving model ...
Epoch: 3 cost time: 1.0046989917755127
Epoch: 3, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.740 Vali Acc: 0.697 Test Loss: 0.740 Test Acc: 0.697
Validation loss decreased (-0.605253 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 1.0178234577178955
Epoch: 4, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.615 Vali Acc: 0.743 Test Loss: 0.615 Test Acc: 0.743
Validation loss decreased (-0.697361 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 0.9858372211456299
Epoch: 5, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.02718186378479
Epoch: 6, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.518 Vali Acc: 0.770 Test Loss: 0.518 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769732).  Saving model ...
Epoch: 7 cost time: 1.0695641040802002
Epoch: 7, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
Validation loss decreased (-0.769732 --> -0.789469).  Saving model ...
Epoch: 8 cost time: 1.0202817916870117
Epoch: 8, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.035043478012085
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0771079063415527
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 0.9571917057037354
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.016110897064209
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1379022598266602
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.538 Vali Acc: 0.816 Test Loss: 0.538 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.1481997966766357
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.136965274810791
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1195852756500244
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1250014305114746
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1024374961853027
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1688625812530518
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.156689167022705
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1041438579559326
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1013474464416504
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.796 Test Loss: 0.606 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.08284592628479
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1131564
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.942983388900757
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.271 Vali Acc: 0.428 Test Loss: 1.271 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 0.9075837135314941
Epoch: 2, Steps: 10 | Train Loss: 1.008 Vali Loss: 0.989 Vali Acc: 0.566 Test Loss: 0.989 Test Acc: 0.566
Validation loss decreased (-0.427619 --> -0.565780).  Saving model ...
Epoch: 3 cost time: 0.9228978157043457
Epoch: 3, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.754 Vali Acc: 0.711 Test Loss: 0.754 Test Acc: 0.711
Validation loss decreased (-0.565780 --> -0.710519).  Saving model ...
Epoch: 4 cost time: 0.9579613208770752
Epoch: 4, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.623 Vali Acc: 0.730 Test Loss: 0.623 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 1.0956318378448486
Epoch: 5, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.542 Vali Acc: 0.757 Test Loss: 0.542 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756574).  Saving model ...
Epoch: 6 cost time: 1.0532019138336182
Epoch: 6, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
Validation loss decreased (-0.756574 --> -0.782890).  Saving model ...
Epoch: 7 cost time: 1.0226447582244873
Epoch: 7, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.494 Vali Acc: 0.776 Test Loss: 0.494 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9689674377441406
Epoch: 8, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 9 cost time: 0.9269406795501709
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 10 cost time: 1.0167958736419678
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.005671739578247
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9841964244842529
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0351247787475586
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0259020328521729
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9847390651702881
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0370171070098877
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 17 cost time: 1.085169792175293
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9763021469116211
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.998748779296875
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9628143310546875
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9592735767364502
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9414713382720947
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9388232231140137
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0787925720214844
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0225248336791992
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0399153232574463
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1131564
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9895782470703125
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.272 Vali Acc: 0.454 Test Loss: 1.272 Test Acc: 0.454
Validation loss decreased (inf --> -0.453935).  Saving model ...
Epoch: 2 cost time: 1.1730377674102783
Epoch: 2, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.008 Vali Acc: 0.605 Test Loss: 1.008 Test Acc: 0.605
Validation loss decreased (-0.453935 --> -0.605253).  Saving model ...
Epoch: 3 cost time: 1.0942113399505615
Epoch: 3, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.773 Vali Acc: 0.684 Test Loss: 0.773 Test Acc: 0.684
Validation loss decreased (-0.605253 --> -0.684203).  Saving model ...
Epoch: 4 cost time: 1.0358355045318604
Epoch: 4, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.632 Vali Acc: 0.743 Test Loss: 0.632 Test Acc: 0.743
Validation loss decreased (-0.684203 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 1.2020978927612305
Epoch: 5, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.0970568656921387
Epoch: 6, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.508 Vali Acc: 0.776 Test Loss: 0.508 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 7 cost time: 1.0883400440216064
Epoch: 7, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 8 cost time: 1.0307941436767578
Epoch: 8, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9867291450500488
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809206).  Saving model ...
Epoch: 10 cost time: 0.9520998001098633
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9857854843139648
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0695972442626953
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1713602542877197
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0815629959106445
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0703272819519043
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0546255111694336
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.040846824645996
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.081718921661377
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1535837650299072
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1131564
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.23848032951355
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.301 Vali Acc: 0.461 Test Loss: 1.301 Test Acc: 0.461
Validation loss decreased (inf --> -0.460513).  Saving model ...
Epoch: 2 cost time: 1.1097378730773926
Epoch: 2, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.065 Vali Acc: 0.632 Test Loss: 1.065 Test Acc: 0.632
Validation loss decreased (-0.460513 --> -0.631568).  Saving model ...
Epoch: 3 cost time: 0.9964358806610107
Epoch: 3, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.836 Vali Acc: 0.671 Test Loss: 0.836 Test Acc: 0.671
Validation loss decreased (-0.631568 --> -0.671044).  Saving model ...
Epoch: 4 cost time: 0.9279711246490479
Epoch: 4, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.686 Vali Acc: 0.750 Test Loss: 0.686 Test Acc: 0.750
Validation loss decreased (-0.671044 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 1.088315486907959
Epoch: 5, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.789468).  Saving model ...
Epoch: 6 cost time: 0.9589946269989014
Epoch: 6, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9779295921325684
Epoch: 7, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 0.9817376136779785
Epoch: 8, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1509919166564941
Epoch: 9, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.2325842380523682
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2518587112426758
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1866545677185059
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1146576404571533
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0792937278747559
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.585 Vali Acc: 0.796 Test Loss: 0.585 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.014868974685669
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0097031593322754
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.075700044631958
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9496729373931885
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.628 Vali Acc: 0.796 Test Loss: 0.628 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8676257133483887
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1131564
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.886723041534424
Epoch: 1, Steps: 10 | Train Loss: 1.508 Vali Loss: 1.317 Vali Acc: 0.368 Test Loss: 1.317 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 0.8830592632293701
Epoch: 2, Steps: 10 | Train Loss: 1.180 Vali Loss: 0.997 Vali Acc: 0.625 Test Loss: 0.997 Test Acc: 0.625
Validation loss decreased (-0.368408 --> -0.624990).  Saving model ...
Epoch: 3 cost time: 0.87339186668396
Epoch: 3, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.774 Vali Acc: 0.697 Test Loss: 0.774 Test Acc: 0.697
Validation loss decreased (-0.624990 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 0.9948208332061768
Epoch: 4, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.641 Vali Acc: 0.737 Test Loss: 0.641 Test Acc: 0.737
Validation loss decreased (-0.697361 --> -0.736836).  Saving model ...
Epoch: 5 cost time: 0.9758198261260986
Epoch: 5, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.736836 --> -0.802626).  Saving model ...
Epoch: 6 cost time: 0.9806199073791504
Epoch: 6, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9633133411407471
Epoch: 7, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 8 cost time: 0.8835859298706055
Epoch: 8, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 9 cost time: 0.9412622451782227
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.925011157989502
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.130204677581787
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8760519027709961
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8390600681304932
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8548579216003418
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.582 Vali Acc: 0.796 Test Loss: 0.582 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9127273559570312
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9873661994934082
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.949702262878418
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.979515790939331
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 869420
model size : 13.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.025357246398926
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.335 Vali Acc: 0.355 Test Loss: 1.335 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 0.9735827445983887
Epoch: 2, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.021 Vali Acc: 0.638 Test Loss: 1.021 Test Acc: 0.638
Validation loss decreased (-0.355250 --> -0.638148).  Saving model ...
Epoch: 3 cost time: 0.9632565975189209
Epoch: 3, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.791 Vali Acc: 0.684 Test Loss: 0.791 Test Acc: 0.684
Validation loss decreased (-0.638148 --> -0.684203).  Saving model ...
Epoch: 4 cost time: 0.9151933193206787
Epoch: 4, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
Validation loss decreased (-0.684203 --> -0.736836).  Saving model ...
Epoch: 5 cost time: 0.9089572429656982
Epoch: 5, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
Validation loss decreased (-0.736836 --> -0.782889).  Saving model ...
Epoch: 6 cost time: 0.8460376262664795
Epoch: 6, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 7 cost time: 0.8615221977233887
Epoch: 7, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 8 cost time: 0.9150545597076416
Epoch: 8, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 9 cost time: 0.939579963684082
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 10 cost time: 0.9318869113922119
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.925208330154419
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0362699031829834
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1414246559143066
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9832000732421875
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9952700138092041
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.097862720489502
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0610780715942383
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9603047370910645
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1008710861206055
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 869420
model size : 13.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0144526958465576
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.336 Vali Acc: 0.382 Test Loss: 1.336 Test Acc: 0.382
Validation loss decreased (inf --> -0.381566).  Saving model ...
Epoch: 2 cost time: 0.918205976486206
Epoch: 2, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.042 Vali Acc: 0.645 Test Loss: 1.042 Test Acc: 0.645
Validation loss decreased (-0.381566 --> -0.644726).  Saving model ...
Epoch: 3 cost time: 0.8910441398620605
Epoch: 3, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.814 Vali Acc: 0.664 Test Loss: 0.814 Test Acc: 0.664
Validation loss decreased (-0.644726 --> -0.664466).  Saving model ...
Epoch: 4 cost time: 1.0536844730377197
Epoch: 4, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.658 Vali Acc: 0.757 Test Loss: 0.658 Test Acc: 0.757
Validation loss decreased (-0.664466 --> -0.756572).  Saving model ...
Epoch: 5 cost time: 0.785912275314331
Epoch: 5, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 0.9476251602172852
Epoch: 6, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 0.8306365013122559
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809206).  Saving model ...
Epoch: 8 cost time: 1.094517469406128
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 9 cost time: 1.0724637508392334
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0332906246185303
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9563794136047363
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9667267799377441
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9460294246673584
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0263919830322266
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0297832489013672
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0978388786315918
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.102165937423706
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.035658836364746
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 869420
model size : 13.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2180016040802
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.329 Vali Acc: 0.349 Test Loss: 1.329 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 0.9684860706329346
Epoch: 2, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.073 Vali Acc: 0.645 Test Loss: 1.073 Test Acc: 0.645
Validation loss decreased (-0.348671 --> -0.644726).  Saving model ...
Epoch: 3 cost time: 1.1146447658538818
Epoch: 3, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.858 Vali Acc: 0.684 Test Loss: 0.858 Test Acc: 0.684
Validation loss decreased (-0.644726 --> -0.684202).  Saving model ...
Epoch: 4 cost time: 0.9352169036865234
Epoch: 4, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.701 Vali Acc: 0.730 Test Loss: 0.701 Test Acc: 0.730
Validation loss decreased (-0.684202 --> -0.730256).  Saving model ...
Epoch: 5 cost time: 0.9676623344421387
Epoch: 5, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
Validation loss decreased (-0.730256 --> -0.789468).  Saving model ...
Epoch: 6 cost time: 0.9836776256561279
Epoch: 6, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.015815258026123
Epoch: 7, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 1.0318725109100342
Epoch: 8, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 9 cost time: 0.9668636322021484
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 0.9778704643249512
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0491249561309814
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.563 Vali Acc: 0.796 Test Loss: 0.563 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0832185745239258
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0158789157867432
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.920820951461792
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.604 Vali Acc: 0.796 Test Loss: 0.604 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9606900215148926
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9491703510284424
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9783804416656494
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0106167793273926
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.644 Vali Acc: 0.803 Test Loss: 0.644 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1031265258789062
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 869420
model size : 13.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.994248390197754
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.347 Vali Acc: 0.368 Test Loss: 1.347 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.038677453994751
Epoch: 2, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.025 Vali Acc: 0.566 Test Loss: 1.025 Test Acc: 0.566
Validation loss decreased (-0.368408 --> -0.565779).  Saving model ...
Epoch: 3 cost time: 1.0240349769592285
Epoch: 3, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
Validation loss decreased (-0.565779 --> -0.710519).  Saving model ...
Epoch: 4 cost time: 1.009227991104126
Epoch: 4, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.623 Vali Acc: 0.750 Test Loss: 0.623 Test Acc: 0.750
Validation loss decreased (-0.710519 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 0.8542094230651855
Epoch: 5, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 0.9847702980041504
Epoch: 6, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782890).  Saving model ...
Epoch: 7 cost time: 1.343479871749878
Epoch: 7, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.479 Vali Acc: 0.796 Test Loss: 0.479 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 8 cost time: 1.1123435497283936
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9942684173583984
Epoch: 9, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 10 cost time: 1.0393264293670654
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0505974292755127
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.158611536026001
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2632620334625244
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0430080890655518
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.044666051864624
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1052923202514648
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.053633451461792
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1152799129486084
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.288912057876587
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.349440097808838
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.803 Test Loss: 0.581 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0884835720062256
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 738348
model size : 12.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.859233856201172
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.345 Vali Acc: 0.336 Test Loss: 1.345 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.186763048171997
Epoch: 2, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.036 Vali Acc: 0.553 Test Loss: 1.036 Test Acc: 0.553
Validation loss decreased (-0.335513 --> -0.552621).  Saving model ...
Epoch: 3 cost time: 1.28303861618042
Epoch: 3, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.793 Vali Acc: 0.691 Test Loss: 0.793 Test Acc: 0.691
Validation loss decreased (-0.552621 --> -0.690782).  Saving model ...
Epoch: 4 cost time: 1.2700636386871338
Epoch: 4, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
Validation loss decreased (-0.690782 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.2955238819122314
Epoch: 5, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.548 Vali Acc: 0.776 Test Loss: 0.548 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.1855852603912354
Epoch: 6, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 7 cost time: 1.2648591995239258
Epoch: 7, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.466 Vali Acc: 0.796 Test Loss: 0.466 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 8 cost time: 1.220569133758545
Epoch: 8, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 9 cost time: 1.119741439819336
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 10 cost time: 1.0158636569976807
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 1.092606544494629
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1172478199005127
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.505 Vali Acc: 0.816 Test Loss: 0.505 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0908751487731934
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0043067932128906
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0074231624603271
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 16 cost time: 1.2236707210540771
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1644878387451172
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9722683429718018
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1250872611999512
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1403050422668457
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9238152503967285
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0766804218292236
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.809 Test Loss: 0.576 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9789323806762695
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0906033515930176
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9726266860961914
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 738348
model size : 12.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3385114669799805
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.345 Vali Acc: 0.414 Test Loss: 1.345 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 1.010451316833496
Epoch: 2, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.061 Vali Acc: 0.599 Test Loss: 1.061 Test Acc: 0.599
Validation loss decreased (-0.414460 --> -0.598674).  Saving model ...
Epoch: 3 cost time: 1.234961986541748
Epoch: 3, Steps: 10 | Train Loss: 0.757 Vali Loss: 0.821 Vali Acc: 0.671 Test Loss: 0.821 Test Acc: 0.671
Validation loss decreased (-0.598674 --> -0.671044).  Saving model ...
Epoch: 4 cost time: 1.1000392436981201
Epoch: 4, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.654 Vali Acc: 0.724 Test Loss: 0.654 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723678).  Saving model ...
Epoch: 5 cost time: 1.0051400661468506
Epoch: 5, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.564 Vali Acc: 0.770 Test Loss: 0.564 Test Acc: 0.770
Validation loss decreased (-0.723678 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.0034940242767334
Epoch: 6, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 7 cost time: 1.1638448238372803
Epoch: 7, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.469 Vali Acc: 0.796 Test Loss: 0.469 Test Acc: 0.796
Validation loss decreased (-0.769732 --> -0.796048).  Saving model ...
Epoch: 8 cost time: 1.0270824432373047
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.462 Vali Acc: 0.803 Test Loss: 0.462 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 9 cost time: 0.9993717670440674
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 10 cost time: 1.0728235244750977
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.141080617904663
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0903382301330566
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1084997653961182
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1490437984466553
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9571247100830078
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1849379539489746
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1795003414154053
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2623779773712158
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.551 Vali Acc: 0.796 Test Loss: 0.551 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3581092357635498
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 738348
model size : 12.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5108511447906494
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.351 Vali Acc: 0.309 Test Loss: 1.351 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.0748002529144287
Epoch: 2, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.101 Vali Acc: 0.572 Test Loss: 1.101 Test Acc: 0.572
Validation loss decreased (-0.309197 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.1026406288146973
Epoch: 3, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.872 Vali Acc: 0.691 Test Loss: 0.872 Test Acc: 0.691
Validation loss decreased (-0.572357 --> -0.690781).  Saving model ...
Epoch: 4 cost time: 1.1034178733825684
Epoch: 4, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.701 Vali Acc: 0.730 Test Loss: 0.701 Test Acc: 0.730
Validation loss decreased (-0.690781 --> -0.730256).  Saving model ...
Epoch: 5 cost time: 0.9789111614227295
Epoch: 5, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.598 Vali Acc: 0.757 Test Loss: 0.598 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 0.9656832218170166
Epoch: 6, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.552 Vali Acc: 0.763 Test Loss: 0.552 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.0586516857147217
Epoch: 7, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782890).  Saving model ...
Epoch: 8 cost time: 0.9905910491943359
Epoch: 8, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 9 cost time: 1.033803939819336
Epoch: 9, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
Validation loss decreased (-0.782890 --> -0.802627).  Saving model ...
Epoch: 10 cost time: 1.2738454341888428
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.068850040435791
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.157789945602417
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.554 Vali Acc: 0.816 Test Loss: 0.554 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.0751030445098877
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0881977081298828
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1484670639038086
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.092761516571045
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0011074542999268
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0192794799804688
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.629 Vali Acc: 0.789 Test Loss: 0.629 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9850056171417236
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.000622272491455
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.156205654144287
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9363477230072021
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.796 Test Loss: 0.664 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 738348
model size : 12.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.128013849258423
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.296 Vali Acc: 0.434 Test Loss: 1.296 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 1.045041561126709
Epoch: 2, Steps: 10 | Train Loss: 1.083 Vali Loss: 0.996 Vali Acc: 0.612 Test Loss: 0.996 Test Acc: 0.612
Validation loss decreased (-0.434198 --> -0.611832).  Saving model ...
Epoch: 3 cost time: 1.044640064239502
Epoch: 3, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.766 Vali Acc: 0.697 Test Loss: 0.766 Test Acc: 0.697
Validation loss decreased (-0.611832 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 0.934096097946167
Epoch: 4, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.629 Vali Acc: 0.704 Test Loss: 0.629 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703941).  Saving model ...
Epoch: 5 cost time: 1.002988576889038
Epoch: 5, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.563 Vali Acc: 0.743 Test Loss: 0.563 Test Acc: 0.743
Validation loss decreased (-0.703941 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.1436529159545898
Epoch: 6, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776311).  Saving model ...
Epoch: 7 cost time: 1.0005152225494385
Epoch: 7, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
Validation loss decreased (-0.776311 --> -0.809206).  Saving model ...
Epoch: 8 cost time: 0.9648852348327637
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0251727104187012
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9597094058990479
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 1.2051725387573242
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1493518352508545
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.938697099685669
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1316070556640625
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9828708171844482
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0641999244689941
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.923365592956543
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9732298851013184
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.576 Vali Acc: 0.789 Test Loss: 0.576 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0090246200561523
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.796 Test Loss: 0.589 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0358400344848633
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 672812
model size : 12.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.902928590774536
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.308 Vali Acc: 0.414 Test Loss: 1.308 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 0.9216606616973877
Epoch: 2, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.026 Vali Acc: 0.605 Test Loss: 1.026 Test Acc: 0.605
Validation loss decreased (-0.414461 --> -0.605253).  Saving model ...
Epoch: 3 cost time: 0.9570891857147217
Epoch: 3, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.794 Vali Acc: 0.671 Test Loss: 0.794 Test Acc: 0.671
Validation loss decreased (-0.605253 --> -0.671045).  Saving model ...
Epoch: 4 cost time: 0.9374141693115234
Epoch: 4, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.649 Vali Acc: 0.711 Test Loss: 0.649 Test Acc: 0.711
Validation loss decreased (-0.671045 --> -0.710520).  Saving model ...
Epoch: 5 cost time: 1.002772569656372
Epoch: 5, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
Validation loss decreased (-0.710520 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 0.8963897228240967
Epoch: 6, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 0.9197292327880859
Epoch: 7, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.505 Vali Acc: 0.783 Test Loss: 0.505 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 8 cost time: 0.8690185546875
Epoch: 8, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 9 cost time: 0.8939900398254395
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 0.8984155654907227
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9024875164031982
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 0.8785264492034912
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9224648475646973
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9707005023956299
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9216105937957764
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8166673183441162
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9282336235046387
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8954463005065918
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8888905048370361
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8368468284606934
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9940667152404785
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 672812
model size : 12.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0347890853881836
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.306 Vali Acc: 0.408 Test Loss: 1.306 Test Acc: 0.408
Validation loss decreased (inf --> -0.407882).  Saving model ...
Epoch: 2 cost time: 0.8978903293609619
Epoch: 2, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.047 Vali Acc: 0.645 Test Loss: 1.047 Test Acc: 0.645
Validation loss decreased (-0.407882 --> -0.644726).  Saving model ...
Epoch: 3 cost time: 0.9843189716339111
Epoch: 3, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.817 Vali Acc: 0.691 Test Loss: 0.817 Test Acc: 0.691
Validation loss decreased (-0.644726 --> -0.690781).  Saving model ...
Epoch: 4 cost time: 1.122586727142334
Epoch: 4, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.666 Vali Acc: 0.711 Test Loss: 0.666 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710520).  Saving model ...
Epoch: 5 cost time: 1.0812225341796875
Epoch: 5, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.582 Vali Acc: 0.763 Test Loss: 0.582 Test Acc: 0.763
Validation loss decreased (-0.710520 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 0.8932716846466064
Epoch: 6, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.542 Vali Acc: 0.757 Test Loss: 0.542 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9736814498901367
Epoch: 7, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.502 Vali Acc: 0.776 Test Loss: 0.502 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776311).  Saving model ...
Epoch: 8 cost time: 0.916175365447998
Epoch: 8, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.916034460067749
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
Validation loss decreased (-0.776311 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 0.9838104248046875
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0238399505615234
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0003228187561035
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9479351043701172
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0326595306396484
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0122263431549072
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1040899753570557
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9469845294952393
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9655086994171143
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.953209638595581
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 672812
model size : 12.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2793140411376953
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.297 Vali Acc: 0.395 Test Loss: 1.297 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 0.9662876129150391
Epoch: 2, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.080 Vali Acc: 0.592 Test Loss: 1.080 Test Acc: 0.592
Validation loss decreased (-0.394724 --> -0.592094).  Saving model ...
Epoch: 3 cost time: 0.9349339008331299
Epoch: 3, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.861 Vali Acc: 0.658 Test Loss: 0.861 Test Acc: 0.658
Validation loss decreased (-0.592094 --> -0.657886).  Saving model ...
Epoch: 4 cost time: 0.9524476528167725
Epoch: 4, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.703 Vali Acc: 0.717 Test Loss: 0.703 Test Acc: 0.717
Validation loss decreased (-0.657886 --> -0.717098).  Saving model ...
Epoch: 5 cost time: 1.008746862411499
Epoch: 5, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.603 Vali Acc: 0.750 Test Loss: 0.603 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 0.9058117866516113
Epoch: 6, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.561 Vali Acc: 0.757 Test Loss: 0.561 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.025176763534546
Epoch: 7, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.531 Vali Acc: 0.770 Test Loss: 0.531 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769732).  Saving model ...
Epoch: 8 cost time: 1.046522617340088
Epoch: 8, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 0.9522607326507568
Epoch: 9, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 0.9794187545776367
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0299139022827148
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9980418682098389
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0844106674194336
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1152443885803223
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1497552394866943
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.614 Vali Acc: 0.776 Test Loss: 0.614 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9359731674194336
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.630 Vali Acc: 0.776 Test Loss: 0.630 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9686853885650635
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.640 Vali Acc: 0.776 Test Loss: 0.640 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9967441558837891
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.776 Test Loss: 0.652 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9367496967315674
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 672812
model size : 12.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.995797872543335
Epoch: 1, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.333 Vali Acc: 0.388 Test Loss: 1.333 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 0.9599683284759521
Epoch: 2, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.148 Vali Acc: 0.507 Test Loss: 1.148 Test Acc: 0.507
Validation loss decreased (-0.388145 --> -0.506567).  Saving model ...
Epoch: 3 cost time: 0.9661033153533936
Epoch: 3, Steps: 10 | Train Loss: 0.918 Vali Loss: 0.959 Vali Acc: 0.612 Test Loss: 0.959 Test Acc: 0.612
Validation loss decreased (-0.506567 --> -0.611833).  Saving model ...
Epoch: 4 cost time: 0.9225106239318848
Epoch: 4, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.802 Vali Acc: 0.704 Test Loss: 0.802 Test Acc: 0.704
Validation loss decreased (-0.611833 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 1.0574417114257812
Epoch: 5, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.704 Vali Acc: 0.730 Test Loss: 0.704 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 1.017686128616333
Epoch: 6, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 0.9604198932647705
Epoch: 7, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 0.9897482395172119
Epoch: 8, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.088742733001709
Epoch: 9, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 0.9544589519500732
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.090804100036621
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0470819473266602
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 13 cost time: 1.04410719871521
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.050401210784912
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 15 cost time: 1.0070204734802246
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9183025360107422
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0333402156829834
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0010089874267578
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9163391590118408
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0279688835144043
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 21 cost time: 1.06882905960083
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.534 Vali Acc: 0.816 Test Loss: 0.534 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9884219169616699
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0513484477996826
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9505829811096191
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.028759479522705
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0962774753570557
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.020958423614502
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0010426044464111
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0622780323028564
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9968132972717285
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1221164
model size : 9.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.124005079269409
Epoch: 1, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.306 Vali Acc: 0.421 Test Loss: 1.306 Test Acc: 0.421
Validation loss decreased (inf --> -0.421040).  Saving model ...
Epoch: 2 cost time: 0.9531850814819336
Epoch: 2, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.130 Vali Acc: 0.526 Test Loss: 1.130 Test Acc: 0.526
Validation loss decreased (-0.421040 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 0.9987993240356445
Epoch: 3, Steps: 10 | Train Loss: 0.945 Vali Loss: 0.947 Vali Acc: 0.664 Test Loss: 0.947 Test Acc: 0.664
Validation loss decreased (-0.526304 --> -0.664464).  Saving model ...
Epoch: 4 cost time: 0.9920506477355957
Epoch: 4, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.793 Vali Acc: 0.704 Test Loss: 0.793 Test Acc: 0.704
Validation loss decreased (-0.664464 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 0.9964373111724854
Epoch: 5, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.1108531951904297
Epoch: 6, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.601 Vali Acc: 0.776 Test Loss: 0.601 Test Acc: 0.776
Validation loss decreased (-0.717098 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.0686748027801514
Epoch: 7, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 0.9983110427856445
Epoch: 8, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 9 cost time: 1.0532004833221436
Epoch: 9, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 10 cost time: 1.165893793106079
Epoch: 10, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815785).  Saving model ...
Epoch: 11 cost time: 0.9103662967681885
Epoch: 11, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.474 Vali Acc: 0.809 Test Loss: 0.474 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9975712299346924
Epoch: 12, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.456 Vali Acc: 0.816 Test Loss: 0.456 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 13 cost time: 1.1573712825775146
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1515872478485107
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
Validation loss decreased (-0.815785 --> -0.835522).  Saving model ...
Epoch: 15 cost time: 0.9818625450134277
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9808640480041504
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.463 Vali Acc: 0.822 Test Loss: 0.463 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9746565818786621
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.474 Vali Acc: 0.829 Test Loss: 0.474 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0729165077209473
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.473 Vali Acc: 0.842 Test Loss: 0.473 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 19 cost time: 1.1191985607147217
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.482 Vali Acc: 0.836 Test Loss: 0.482 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0132946968078613
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0170319080352783
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.496 Vali Acc: 0.836 Test Loss: 0.496 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0724787712097168
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.497 Vali Acc: 0.829 Test Loss: 0.497 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.063749074935913
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.503 Vali Acc: 0.836 Test Loss: 0.503 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0707101821899414
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1405117511749268
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.510 Vali Acc: 0.836 Test Loss: 0.510 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1530725955963135
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.114819049835205
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.514 Vali Acc: 0.842 Test Loss: 0.514 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0258045196533203
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.523 Vali Acc: 0.836 Test Loss: 0.523 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 1221164
model size : 9.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8112587928771973
Epoch: 1, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.303 Vali Acc: 0.414 Test Loss: 1.303 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 0.8669891357421875
Epoch: 2, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.149 Vali Acc: 0.546 Test Loss: 1.149 Test Acc: 0.546
Validation loss decreased (-0.414461 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 0.9870102405548096
Epoch: 3, Steps: 10 | Train Loss: 0.989 Vali Loss: 0.981 Vali Acc: 0.638 Test Loss: 0.981 Test Acc: 0.638
Validation loss decreased (-0.546041 --> -0.638148).  Saving model ...
Epoch: 4 cost time: 1.0204839706420898
Epoch: 4, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.830 Vali Acc: 0.730 Test Loss: 0.830 Test Acc: 0.730
Validation loss decreased (-0.638148 --> -0.730255).  Saving model ...
Epoch: 5 cost time: 0.959707498550415
Epoch: 5, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.724 Vali Acc: 0.717 Test Loss: 0.724 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0031774044036865
Epoch: 6, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.631 Vali Acc: 0.776 Test Loss: 0.631 Test Acc: 0.776
Validation loss decreased (-0.730255 --> -0.776309).  Saving model ...
Epoch: 7 cost time: 0.9429266452789307
Epoch: 7, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
Validation loss decreased (-0.776309 --> -0.802626).  Saving model ...
Epoch: 8 cost time: 0.8480865955352783
Epoch: 8, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8544528484344482
Epoch: 9, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 10 cost time: 0.8306729793548584
Epoch: 10, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 11 cost time: 0.9884893894195557
Epoch: 11, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1507594585418701
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9773910045623779
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.468 Vali Acc: 0.836 Test Loss: 0.468 Test Acc: 0.836
Validation loss decreased (-0.815785 --> -0.835522).  Saving model ...
Epoch: 14 cost time: 0.8806219100952148
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0541138648986816
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.467 Vali Acc: 0.829 Test Loss: 0.467 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9066131114959717
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8899044990539551
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.475 Vali Acc: 0.836 Test Loss: 0.475 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9890468120574951
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.476 Vali Acc: 0.836 Test Loss: 0.476 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.021862268447876
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.483 Vali Acc: 0.836 Test Loss: 0.483 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9549376964569092
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.487 Vali Acc: 0.836 Test Loss: 0.487 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9665329456329346
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.501 Vali Acc: 0.836 Test Loss: 0.501 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.958371639251709
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.504 Vali Acc: 0.842 Test Loss: 0.504 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842100).  Saving model ...
Epoch: 23 cost time: 0.9322478771209717
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.508 Vali Acc: 0.842 Test Loss: 0.508 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8931472301483154
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.515 Vali Acc: 0.842 Test Loss: 0.515 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9730868339538574
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.516 Vali Acc: 0.842 Test Loss: 0.516 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0878422260284424
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.503 Vali Acc: 0.842 Test Loss: 0.503 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 27 cost time: 1.062429428100586
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.523 Vali Acc: 0.842 Test Loss: 0.523 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9571552276611328
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
Validation loss decreased (-0.842100 --> -0.855258).  Saving model ...
Epoch: 29 cost time: 0.8810231685638428
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.524 Vali Acc: 0.849 Test Loss: 0.524 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9622116088867188
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.529 Vali Acc: 0.842 Test Loss: 0.529 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0019688606262207
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.842 Test Loss: 0.539 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.028069257736206
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.544 Vali Acc: 0.849 Test Loss: 0.544 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.067281723022461
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.849 Test Loss: 0.547 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9598612785339355
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.849 Test Loss: 0.556 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9063959121704102
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.849 Test Loss: 0.560 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9269840717315674
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.563 Vali Acc: 0.842 Test Loss: 0.563 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8135395050048828
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.842 Test Loss: 0.571 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1018755435943604
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.849 Test Loss: 0.580 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 1221164
model size : 9.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9463906288146973
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.325 Vali Acc: 0.395 Test Loss: 1.325 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 0.9128282070159912
Epoch: 2, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.199 Vali Acc: 0.539 Test Loss: 1.199 Test Acc: 0.539
Validation loss decreased (-0.394724 --> -0.539462).  Saving model ...
Epoch: 3 cost time: 1.036104440689087
Epoch: 3, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.050 Vali Acc: 0.638 Test Loss: 1.050 Test Acc: 0.638
Validation loss decreased (-0.539462 --> -0.638147).  Saving model ...
Epoch: 4 cost time: 0.9088668823242188
Epoch: 4, Steps: 10 | Train Loss: 0.834 Vali Loss: 0.907 Vali Acc: 0.691 Test Loss: 0.907 Test Acc: 0.691
Validation loss decreased (-0.638147 --> -0.690780).  Saving model ...
Epoch: 5 cost time: 0.9244439601898193
Epoch: 5, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.797 Vali Acc: 0.737 Test Loss: 0.797 Test Acc: 0.737
Validation loss decreased (-0.690780 --> -0.736834).  Saving model ...
Epoch: 6 cost time: 0.880640983581543
Epoch: 6, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.694 Vali Acc: 0.757 Test Loss: 0.694 Test Acc: 0.757
Validation loss decreased (-0.736834 --> -0.756572).  Saving model ...
Epoch: 7 cost time: 0.8600544929504395
Epoch: 7, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.621 Vali Acc: 0.750 Test Loss: 0.621 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.897207498550415
Epoch: 8, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 0.9599764347076416
Epoch: 9, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 0.9455087184906006
Epoch: 10, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 11 cost time: 0.922431230545044
Epoch: 11, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.530 Vali Acc: 0.770 Test Loss: 0.530 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9110031127929688
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 0.8849442005157471
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 14 cost time: 0.9082748889923096
Epoch: 14, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 15 cost time: 0.9599134922027588
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1299402713775635
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 17 cost time: 0.9381089210510254
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9562113285064697
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9829223155975342
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0125129222869873
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.932452917098999
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.04937744140625
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8760490417480469
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0337233543395996
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0843942165374756
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9510235786437988
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1221164
model size : 9.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.033417224884033
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.310 Vali Acc: 0.401 Test Loss: 1.310 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 1.025460958480835
Epoch: 2, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.142 Vali Acc: 0.546 Test Loss: 1.142 Test Acc: 0.546
Validation loss decreased (-0.401303 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 1.0088045597076416
Epoch: 3, Steps: 10 | Train Loss: 0.952 Vali Loss: 0.935 Vali Acc: 0.651 Test Loss: 0.935 Test Acc: 0.651
Validation loss decreased (-0.546041 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 0.9477348327636719
Epoch: 4, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
Validation loss decreased (-0.651306 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.017113208770752
Epoch: 5, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.665 Vali Acc: 0.763 Test Loss: 0.665 Test Acc: 0.763
Validation loss decreased (-0.710519 --> -0.763151).  Saving model ...
Epoch: 6 cost time: 1.021634578704834
Epoch: 6, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 0.9215519428253174
Epoch: 7, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 0.9190983772277832
Epoch: 8, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 0.936546802520752
Epoch: 9, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 10 cost time: 0.938213586807251
Epoch: 10, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 0.9108247756958008
Epoch: 11, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 12 cost time: 0.8802578449249268
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8446857929229736
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8890962600708008
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9183621406555176
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9681472778320312
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0150911808013916
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.494 Vali Acc: 0.829 Test Loss: 0.494 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 18 cost time: 0.9719359874725342
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0116231441497803
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0134499073028564
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9260077476501465
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9305322170257568
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9490938186645508
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9144766330718994
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9516201019287109
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9164483547210693
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9366886615753174
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 696876
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0644097328186035
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.303 Vali Acc: 0.428 Test Loss: 1.303 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 0.9903786182403564
Epoch: 2, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.142 Vali Acc: 0.526 Test Loss: 1.142 Test Acc: 0.526
Validation loss decreased (-0.427619 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 0.8569226264953613
Epoch: 3, Steps: 10 | Train Loss: 0.966 Vali Loss: 0.942 Vali Acc: 0.651 Test Loss: 0.942 Test Acc: 0.651
Validation loss decreased (-0.526304 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 0.91245436668396
Epoch: 4, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.784 Vali Acc: 0.711 Test Loss: 0.784 Test Acc: 0.711
Validation loss decreased (-0.651306 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 0.960407018661499
Epoch: 5, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
Validation loss decreased (-0.710518 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 0.9215881824493408
Epoch: 6, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
Validation loss decreased (-0.749993 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 0.9402117729187012
Epoch: 7, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 8 cost time: 0.8006484508514404
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 9 cost time: 0.9173307418823242
Epoch: 9, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 10 cost time: 0.8150100708007812
Epoch: 10, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 11 cost time: 0.8768038749694824
Epoch: 11, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 12 cost time: 1.0012013912200928
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9669070243835449
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.473 Vali Acc: 0.829 Test Loss: 0.473 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 14 cost time: 0.937546968460083
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.466 Vali Acc: 0.836 Test Loss: 0.466 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 15 cost time: 0.984774112701416
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.470 Vali Acc: 0.816 Test Loss: 0.470 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8824622631072998
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9269869327545166
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.471 Vali Acc: 0.829 Test Loss: 0.471 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9181480407714844
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9162812232971191
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.487 Vali Acc: 0.836 Test Loss: 0.487 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9486966133117676
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.494 Vali Acc: 0.829 Test Loss: 0.494 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8990654945373535
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8584489822387695
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.506 Vali Acc: 0.829 Test Loss: 0.506 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9936819076538086
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.514 Vali Acc: 0.829 Test Loss: 0.514 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9180948734283447
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.520 Vali Acc: 0.829 Test Loss: 0.520 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 696876
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.066148519515991
Epoch: 1, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.331 Vali Acc: 0.382 Test Loss: 1.331 Test Acc: 0.382
Validation loss decreased (inf --> -0.381566).  Saving model ...
Epoch: 2 cost time: 1.114058256149292
Epoch: 2, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.191 Vali Acc: 0.559 Test Loss: 1.191 Test Acc: 0.559
Validation loss decreased (-0.381566 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 0.9853353500366211
Epoch: 3, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.005 Vali Acc: 0.651 Test Loss: 1.005 Test Acc: 0.651
Validation loss decreased (-0.559199 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 0.9655137062072754
Epoch: 4, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.852 Vali Acc: 0.684 Test Loss: 0.852 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 1.0294690132141113
Epoch: 5, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.732 Vali Acc: 0.717 Test Loss: 0.732 Test Acc: 0.717
Validation loss decreased (-0.684202 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.1002259254455566
Epoch: 6, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.650 Vali Acc: 0.750 Test Loss: 0.650 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.0211267471313477
Epoch: 7, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 0.9699723720550537
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
Validation loss decreased (-0.763152 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 0.9899437427520752
Epoch: 9, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 0.9498965740203857
Epoch: 10, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9533898830413818
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 12 cost time: 1.0623469352722168
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0522372722625732
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 14 cost time: 1.0268807411193848
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 15 cost time: 1.0575604438781738
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0484938621520996
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 17 cost time: 1.0201609134674072
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9573698043823242
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.494 Vali Acc: 0.842 Test Loss: 0.494 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 19 cost time: 1.02132248878479
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0124342441558838
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0412211418151855
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0922553539276123
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0206246376037598
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9679539203643799
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9860067367553711
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.829 Test Loss: 0.527 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9677188396453857
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9603488445281982
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9415130615234375
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 696876
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7548415660858154
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.349 Vali Acc: 0.329 Test Loss: 1.349 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 0.9766209125518799
Epoch: 2, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.227 Vali Acc: 0.566 Test Loss: 1.227 Test Acc: 0.566
Validation loss decreased (-0.328934 --> -0.565777).  Saving model ...
Epoch: 3 cost time: 1.0694694519042969
Epoch: 3, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.063 Vali Acc: 0.678 Test Loss: 1.063 Test Acc: 0.678
Validation loss decreased (-0.565777 --> -0.677621).  Saving model ...
Epoch: 4 cost time: 0.9329655170440674
Epoch: 4, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.913 Vali Acc: 0.704 Test Loss: 0.913 Test Acc: 0.704
Validation loss decreased (-0.677621 --> -0.703938).  Saving model ...
Epoch: 5 cost time: 0.9838948249816895
Epoch: 5, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.790 Vali Acc: 0.763 Test Loss: 0.790 Test Acc: 0.763
Validation loss decreased (-0.703938 --> -0.763150).  Saving model ...
Epoch: 6 cost time: 1.0287442207336426
Epoch: 6, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
Validation loss decreased (-0.763150 --> -0.789467).  Saving model ...
Epoch: 7 cost time: 0.9773139953613281
Epoch: 7, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 8 cost time: 0.9681558609008789
Epoch: 8, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9907875061035156
Epoch: 9, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.0517210960388184
Epoch: 10, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.871009349822998
Epoch: 11, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8549690246582031
Epoch: 12, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.499 Vali Acc: 0.783 Test Loss: 0.499 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0380768775939941
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 0.9653518199920654
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.00053071975708
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.065439224243164
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9265499114990234
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8350129127502441
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9513692855834961
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0380637645721436
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9781644344329834
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8635756969451904
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9390871524810791
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 696876
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.970341205596924
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.359 Vali Acc: 0.362 Test Loss: 1.359 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 0.8114042282104492
Epoch: 2, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.154 Vali Acc: 0.533 Test Loss: 1.154 Test Acc: 0.533
Validation loss decreased (-0.361829 --> -0.532883).  Saving model ...
Epoch: 3 cost time: 0.9330923557281494
Epoch: 3, Steps: 10 | Train Loss: 0.944 Vali Loss: 0.967 Vali Acc: 0.651 Test Loss: 0.967 Test Acc: 0.651
Validation loss decreased (-0.532883 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 0.9586169719696045
Epoch: 4, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.818 Vali Acc: 0.697 Test Loss: 0.818 Test Acc: 0.697
Validation loss decreased (-0.651306 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 0.9243078231811523
Epoch: 5, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 0.8449394702911377
Epoch: 6, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 7 cost time: 0.9588658809661865
Epoch: 7, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.574 Vali Acc: 0.750 Test Loss: 0.574 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.1087048053741455
Epoch: 8, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 0.957772970199585
Epoch: 9, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.529 Vali Acc: 0.770 Test Loss: 0.529 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 10 cost time: 0.9327330589294434
Epoch: 10, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 11 cost time: 0.9147977828979492
Epoch: 11, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.0230486392974854
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 0.8644866943359375
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.930811882019043
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0022873878479004
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0580108165740967
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8664853572845459
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9888405799865723
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9651656150817871
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.012315273284912
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0019373893737793
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9453067779541016
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.796 Test Loss: 0.558 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 434732
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0757455825805664
Epoch: 1, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.349 Vali Acc: 0.395 Test Loss: 1.349 Test Acc: 0.395
Validation loss decreased (inf --> -0.394723).  Saving model ...
Epoch: 2 cost time: 0.9661426544189453
Epoch: 2, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.158 Vali Acc: 0.513 Test Loss: 1.158 Test Acc: 0.513
Validation loss decreased (-0.394723 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 0.9281017780303955
Epoch: 3, Steps: 10 | Train Loss: 0.944 Vali Loss: 0.977 Vali Acc: 0.618 Test Loss: 0.977 Test Acc: 0.618
Validation loss decreased (-0.513146 --> -0.618411).  Saving model ...
Epoch: 4 cost time: 0.9674956798553467
Epoch: 4, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.828 Vali Acc: 0.697 Test Loss: 0.828 Test Acc: 0.697
Validation loss decreased (-0.618411 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 0.9779183864593506
Epoch: 5, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.698 Vali Acc: 0.737 Test Loss: 0.698 Test Acc: 0.737
Validation loss decreased (-0.697360 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.0105926990509033
Epoch: 6, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 0.9018287658691406
Epoch: 7, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 0.9134883880615234
Epoch: 8, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 0.910557746887207
Epoch: 9, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 10 cost time: 0.9560971260070801
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.509 Vali Acc: 0.770 Test Loss: 0.509 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 11 cost time: 0.9202895164489746
Epoch: 11, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 12 cost time: 0.9757630825042725
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 0.9081802368164062
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7838730812072754
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 15 cost time: 0.7519752979278564
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 0.8944621086120605
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8838021755218506
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0046758651733398
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8857719898223877
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.95296311378479
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 0.9846906661987305
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 22 cost time: 0.9318506717681885
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9849715232849121
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0665950775146484
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0271449089050293
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1882028579711914
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.551 Vali Acc: 0.816 Test Loss: 0.551 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.049328327178955
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1434621810913086
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9740314483642578
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0808405876159668
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9801948070526123
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 434732
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1241061687469482
Epoch: 1, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.346 Vali Acc: 0.368 Test Loss: 1.346 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 0.9826021194458008
Epoch: 2, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.173 Vali Acc: 0.533 Test Loss: 1.173 Test Acc: 0.533
Validation loss decreased (-0.368408 --> -0.532883).  Saving model ...
Epoch: 3 cost time: 1.0613791942596436
Epoch: 3, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.006 Vali Acc: 0.612 Test Loss: 1.006 Test Acc: 0.612
Validation loss decreased (-0.532883 --> -0.611832).  Saving model ...
Epoch: 4 cost time: 1.1063733100891113
Epoch: 4, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.861 Vali Acc: 0.658 Test Loss: 0.861 Test Acc: 0.658
Validation loss decreased (-0.611832 --> -0.657886).  Saving model ...
Epoch: 5 cost time: 0.9631400108337402
Epoch: 5, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.727 Vali Acc: 0.737 Test Loss: 0.727 Test Acc: 0.737
Validation loss decreased (-0.657886 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.131995677947998
Epoch: 6, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769730).  Saving model ...
Epoch: 7 cost time: 0.9991421699523926
Epoch: 7, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.0104074478149414
Epoch: 8, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1014294624328613
Epoch: 9, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 10 cost time: 1.2257330417633057
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 11 cost time: 1.0428152084350586
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 12 cost time: 1.083404541015625
Epoch: 12, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 13 cost time: 1.2184793949127197
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3014581203460693
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2650060653686523
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2150931358337402
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822363).  Saving model ...
Epoch: 17 cost time: 0.97918701171875
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.185910940170288
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1568264961242676
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2242741584777832
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9906163215637207
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1804876327514648
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3707122802734375
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 24 cost time: 1.1151514053344727
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.521 Vali Acc: 0.829 Test Loss: 0.521 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.257225751876831
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.521 Vali Acc: 0.829 Test Loss: 0.521 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3136107921600342
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2598278522491455
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.536 Vali Acc: 0.836 Test Loss: 0.536 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 28 cost time: 1.257655382156372
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1896765232086182
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.829 Test Loss: 0.551 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3126718997955322
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.829 Test Loss: 0.549 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1984329223632812
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.556 Vali Acc: 0.829 Test Loss: 0.556 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3025379180908203
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.559 Vali Acc: 0.836 Test Loss: 0.559 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.424767017364502
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3494043350219727
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3497490882873535
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.836 Test Loss: 0.573 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2941646575927734
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.582 Vali Acc: 0.829 Test Loss: 0.582 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.347351312637329
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.836 Test Loss: 0.586 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 434732
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9868977069854736
Epoch: 1, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.333 Vali Acc: 0.414 Test Loss: 1.333 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 1.4030647277832031
Epoch: 2, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.191 Vali Acc: 0.572 Test Loss: 1.191 Test Acc: 0.572
Validation loss decreased (-0.414460 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 1.2759120464324951
Epoch: 3, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.048 Vali Acc: 0.645 Test Loss: 1.048 Test Acc: 0.645
Validation loss decreased (-0.572357 --> -0.644726).  Saving model ...
Epoch: 4 cost time: 1.3157844543457031
Epoch: 4, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.912 Vali Acc: 0.691 Test Loss: 0.912 Test Acc: 0.691
Validation loss decreased (-0.644726 --> -0.690780).  Saving model ...
Epoch: 5 cost time: 1.329300880432129
Epoch: 5, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.780 Vali Acc: 0.697 Test Loss: 0.780 Test Acc: 0.697
Validation loss decreased (-0.690780 --> -0.697361).  Saving model ...
Epoch: 6 cost time: 1.2402551174163818
Epoch: 6, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
Validation loss decreased (-0.697361 --> -0.756572).  Saving model ...
Epoch: 7 cost time: 1.3465049266815186
Epoch: 7, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.618 Vali Acc: 0.750 Test Loss: 0.618 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2610116004943848
Epoch: 8, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.1847381591796875
Epoch: 9, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 10 cost time: 1.4109907150268555
Epoch: 10, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
Validation loss decreased (-0.763153 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.3464970588684082
Epoch: 11, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.4151833057403564
Epoch: 12, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3161735534667969
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.374417781829834
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.507 Vali Acc: 0.776 Test Loss: 0.507 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2310833930969238
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 16 cost time: 1.0783326625823975
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1991705894470215
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2093665599822998
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2744967937469482
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2993049621582031
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4209599494934082
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 22 cost time: 1.1546905040740967
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.260908842086792
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.551 Vali Acc: 0.796 Test Loss: 0.551 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2755873203277588
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.333148717880249
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3650727272033691
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4276936054229736
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.267012596130371
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2444238662719727
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3181374073028564
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.600 Vali Acc: 0.796 Test Loss: 0.600 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3294677734375
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 434732
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1003236770629883
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.384 Vali Acc: 0.309 Test Loss: 1.384 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.195570945739746
Epoch: 2, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.201 Vali Acc: 0.474 Test Loss: 1.201 Test Acc: 0.474
Validation loss decreased (-0.309197 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.120053768157959
Epoch: 3, Steps: 10 | Train Loss: 0.954 Vali Loss: 0.983 Vali Acc: 0.618 Test Loss: 0.983 Test Acc: 0.618
Validation loss decreased (-0.473672 --> -0.618411).  Saving model ...
Epoch: 4 cost time: 1.188807487487793
Epoch: 4, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.819 Vali Acc: 0.704 Test Loss: 0.819 Test Acc: 0.704
Validation loss decreased (-0.618411 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 1.400360345840454
Epoch: 5, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.703 Vali Acc: 0.737 Test Loss: 0.703 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.448089838027954
Epoch: 6, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.273212194442749
Epoch: 7, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.0991215705871582
Epoch: 8, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.3119392395019531
Epoch: 9, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.325742483139038
Epoch: 10, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.347909688949585
Epoch: 11, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.275958776473999
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 13 cost time: 1.262484073638916
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.2295498847961426
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1784989833831787
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.312967300415039
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1386525630950928
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2203314304351807
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.166646957397461
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9428188800811768
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2328240871429443
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2478854656219482
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.551 Vali Acc: 0.796 Test Loss: 0.551 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2190227508544922
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 303660
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.923081159591675
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.397 Vali Acc: 0.303 Test Loss: 1.397 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.1252434253692627
Epoch: 2, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.222 Vali Acc: 0.434 Test Loss: 1.222 Test Acc: 0.434
Validation loss decreased (-0.302618 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.253796100616455
Epoch: 3, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.009 Vali Acc: 0.612 Test Loss: 1.009 Test Acc: 0.612
Validation loss decreased (-0.434198 --> -0.611832).  Saving model ...
Epoch: 4 cost time: 1.2884595394134521
Epoch: 4, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.845 Vali Acc: 0.711 Test Loss: 0.845 Test Acc: 0.711
Validation loss decreased (-0.611832 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 1.1952950954437256
Epoch: 5, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.224048137664795
Epoch: 6, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.643 Vali Acc: 0.757 Test Loss: 0.643 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.225642442703247
Epoch: 7, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.2425649166107178
Epoch: 8, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.287872552871704
Epoch: 9, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 1.2405855655670166
Epoch: 10, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 1.1540307998657227
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1290924549102783
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1299376487731934
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2408840656280518
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1857497692108154
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3332645893096924
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2083971500396729
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0713729858398438
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1691808700561523
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2506825923919678
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 303660
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.86256742477417
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.376 Vali Acc: 0.322 Test Loss: 1.376 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.3047468662261963
Epoch: 2, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.223 Vali Acc: 0.447 Test Loss: 1.223 Test Acc: 0.447
Validation loss decreased (-0.322355 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 1.302746057510376
Epoch: 3, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.031 Vali Acc: 0.605 Test Loss: 1.031 Test Acc: 0.605
Validation loss decreased (-0.447356 --> -0.605253).  Saving model ...
Epoch: 4 cost time: 1.3576741218566895
Epoch: 4, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.872 Vali Acc: 0.717 Test Loss: 0.872 Test Acc: 0.717
Validation loss decreased (-0.605253 --> -0.717097).  Saving model ...
Epoch: 5 cost time: 1.1664631366729736
Epoch: 5, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.751 Vali Acc: 0.704 Test Loss: 0.751 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2469947338104248
Epoch: 6, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.663 Vali Acc: 0.750 Test Loss: 0.663 Test Acc: 0.750
Validation loss decreased (-0.717097 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.250197410583496
Epoch: 7, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.3853216171264648
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3934738636016846
Epoch: 9, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2524855136871338
Epoch: 10, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.500 Vali Acc: 0.776 Test Loss: 0.500 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 11 cost time: 1.1324715614318848
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.501 Vali Acc: 0.770 Test Loss: 0.501 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2702209949493408
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
Validation loss decreased (-0.776311 --> -0.802627).  Saving model ...
Epoch: 13 cost time: 1.3502545356750488
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3109056949615479
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.227921962738037
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3276324272155762
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3141376972198486
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.505 Vali Acc: 0.783 Test Loss: 0.505 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9829847812652588
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2487294673919678
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3653624057769775
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1255557537078857
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2574598789215088
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 303660
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9740166664123535
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.369 Vali Acc: 0.316 Test Loss: 1.369 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.231999397277832
Epoch: 2, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.244 Vali Acc: 0.487 Test Loss: 1.244 Test Acc: 0.487
Validation loss decreased (-0.315776 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.2278306484222412
Epoch: 3, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.084 Vali Acc: 0.605 Test Loss: 1.084 Test Acc: 0.605
Validation loss decreased (-0.486830 --> -0.605252).  Saving model ...
Epoch: 4 cost time: 1.333463191986084
Epoch: 4, Steps: 10 | Train Loss: 0.829 Vali Loss: 0.937 Vali Acc: 0.664 Test Loss: 0.937 Test Acc: 0.664
Validation loss decreased (-0.605252 --> -0.664464).  Saving model ...
Epoch: 5 cost time: 1.262040138244629
Epoch: 5, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.815 Vali Acc: 0.678 Test Loss: 0.815 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677623).  Saving model ...
Epoch: 6 cost time: 1.333794355392456
Epoch: 6, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 1.0531213283538818
Epoch: 7, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.2287745475769043
Epoch: 8, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 0.972036600112915
Epoch: 9, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.047572135925293
Epoch: 10, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.528 Vali Acc: 0.763 Test Loss: 0.528 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 11 cost time: 1.085578441619873
Epoch: 11, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.763153 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.1023597717285156
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.516 Vali Acc: 0.770 Test Loss: 0.516 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1120343208312988
Epoch: 13, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3208568096160889
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1513643264770508
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1861343383789062
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1151044368743896
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1030235290527344
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1478602886199951
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1263251304626465
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2466602325439453
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 303660
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.80818772315979
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.303 Vali Acc: 0.434 Test Loss: 1.303 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 1.273827075958252
Epoch: 2, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.106 Vali Acc: 0.592 Test Loss: 1.106 Test Acc: 0.592
Validation loss decreased (-0.434197 --> -0.592094).  Saving model ...
Epoch: 3 cost time: 1.226494550704956
Epoch: 3, Steps: 10 | Train Loss: 0.909 Vali Loss: 0.928 Vali Acc: 0.691 Test Loss: 0.928 Test Acc: 0.691
Validation loss decreased (-0.592094 --> -0.690780).  Saving model ...
Epoch: 4 cost time: 1.2299103736877441
Epoch: 4, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
Validation loss decreased (-0.690780 --> -0.717097).  Saving model ...
Epoch: 5 cost time: 1.1517894268035889
Epoch: 5, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.683 Vali Acc: 0.750 Test Loss: 0.683 Test Acc: 0.750
Validation loss decreased (-0.717097 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.2385964393615723
Epoch: 6, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.613 Vali Acc: 0.770 Test Loss: 0.613 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.1216130256652832
Epoch: 7, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.2495203018188477
Epoch: 8, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.152928113937378
Epoch: 9, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 10 cost time: 1.163684368133545
Epoch: 10, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 11 cost time: 1.2054436206817627
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 12 cost time: 1.2186048030853271
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.2321252822875977
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2072257995605469
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2168984413146973
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1986756324768066
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2421815395355225
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2281601428985596
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2547838687896729
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.180647850036621
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.173644781112671
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1151745319366455
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 238124
model size : 5.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7413110733032227
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.317 Vali Acc: 0.388 Test Loss: 1.317 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 1.0464637279510498
Epoch: 2, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.128 Vali Acc: 0.533 Test Loss: 1.128 Test Acc: 0.533
Validation loss decreased (-0.388145 --> -0.532883).  Saving model ...
Epoch: 3 cost time: 1.2584316730499268
Epoch: 3, Steps: 10 | Train Loss: 0.941 Vali Loss: 0.953 Vali Acc: 0.671 Test Loss: 0.953 Test Acc: 0.671
Validation loss decreased (-0.532883 --> -0.671043).  Saving model ...
Epoch: 4 cost time: 1.2905595302581787
Epoch: 4, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.808 Vali Acc: 0.697 Test Loss: 0.808 Test Acc: 0.697
Validation loss decreased (-0.671043 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 1.3361849784851074
Epoch: 5, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.703 Vali Acc: 0.743 Test Loss: 0.703 Test Acc: 0.743
Validation loss decreased (-0.697360 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 1.338899850845337
Epoch: 6, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.3006267547607422
Epoch: 7, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.1709015369415283
Epoch: 8, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.1030094623565674
Epoch: 9, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.512 Vali Acc: 0.770 Test Loss: 0.512 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 10 cost time: 1.2699666023254395
Epoch: 10, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 1.3644306659698486
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 12 cost time: 1.2862107753753662
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 13 cost time: 1.254197359085083
Epoch: 13, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.3379061222076416
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1417922973632812
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.1794140338897705
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0797717571258545
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 18 cost time: 1.27577805519104
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1901798248291016
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1610405445098877
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4102964401245117
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1269569396972656
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2579576969146729
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2427289485931396
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.301279067993164
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.313096046447754
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2792854309082031
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 238124
model size : 5.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5074617862701416
Epoch: 1, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.317 Vali Acc: 0.388 Test Loss: 1.317 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 1.0020668506622314
Epoch: 2, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.148 Vali Acc: 0.559 Test Loss: 1.148 Test Acc: 0.559
Validation loss decreased (-0.388145 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 1.0448582172393799
Epoch: 3, Steps: 10 | Train Loss: 0.982 Vali Loss: 0.987 Vali Acc: 0.632 Test Loss: 0.987 Test Acc: 0.632
Validation loss decreased (-0.559199 --> -0.631569).  Saving model ...
Epoch: 4 cost time: 1.2766697406768799
Epoch: 4, Steps: 10 | Train Loss: 0.777 Vali Loss: 0.847 Vali Acc: 0.684 Test Loss: 0.847 Test Acc: 0.684
Validation loss decreased (-0.631569 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 1.3294413089752197
Epoch: 5, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.738 Vali Acc: 0.724 Test Loss: 0.738 Test Acc: 0.724
Validation loss decreased (-0.684202 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.3450489044189453
Epoch: 6, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.650 Vali Acc: 0.776 Test Loss: 0.650 Test Acc: 0.776
Validation loss decreased (-0.723677 --> -0.776309).  Saving model ...
Epoch: 7 cost time: 1.2922687530517578
Epoch: 7, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.3572287559509277
Epoch: 8, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.0717556476593018
Epoch: 9, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3005344867706299
Epoch: 10, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809206).  Saving model ...
Epoch: 11 cost time: 1.2921092510223389
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.484 Vali Acc: 0.796 Test Loss: 0.484 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3272154331207275
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 13 cost time: 1.0765349864959717
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1596741676330566
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3076636791229248
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.308969259262085
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.489 Vali Acc: 0.796 Test Loss: 0.489 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2798514366149902
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2903671264648438
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3888437747955322
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2973346710205078
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3804757595062256
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1433444023132324
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 238124
model size : 5.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.185481548309326
Epoch: 1, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.338 Vali Acc: 0.342 Test Loss: 1.338 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.3813879489898682
Epoch: 2, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.192 Vali Acc: 0.559 Test Loss: 1.192 Test Acc: 0.559
Validation loss decreased (-0.342092 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 1.3993196487426758
Epoch: 3, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.049 Vali Acc: 0.638 Test Loss: 1.049 Test Acc: 0.638
Validation loss decreased (-0.559199 --> -0.638147).  Saving model ...
Epoch: 4 cost time: 1.1803042888641357
Epoch: 4, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.918 Vali Acc: 0.664 Test Loss: 0.918 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664465).  Saving model ...
Epoch: 5 cost time: 1.1736118793487549
Epoch: 5, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.806 Vali Acc: 0.730 Test Loss: 0.806 Test Acc: 0.730
Validation loss decreased (-0.664465 --> -0.730255).  Saving model ...
Epoch: 6 cost time: 1.0997333526611328
Epoch: 6, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.706 Vali Acc: 0.743 Test Loss: 0.706 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.2998502254486084
Epoch: 7, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.636 Vali Acc: 0.776 Test Loss: 0.636 Test Acc: 0.776
Validation loss decreased (-0.743414 --> -0.776309).  Saving model ...
Epoch: 8 cost time: 1.304429531097412
Epoch: 8, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.39363694190979
Epoch: 9, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2358710765838623
Epoch: 10, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.1295850276947021
Epoch: 11, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3238964080810547
Epoch: 12, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 13 cost time: 1.2290058135986328
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.192873477935791
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 15 cost time: 1.3634922504425049
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2607486248016357
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.102503776550293
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.131434440612793
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.197525978088379
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1376852989196777
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1096858978271484
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.550 Vali Acc: 0.789 Test Loss: 0.550 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1693084239959717
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 1.268465518951416
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2739508152008057
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3176665306091309
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.278529405593872
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2499964237213135
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.333078145980835
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2454757690429688
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.255699872970581
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.243910551071167
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3592560291290283
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2610845565795898
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.621 Vali Acc: 0.776 Test Loss: 0.621 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1825408935546875
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.626 Vali Acc: 0.789 Test Loss: 0.626 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3562736511230469
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.639 Vali Acc: 0.776 Test Loss: 0.639 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2072727680206299
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1878585815429688
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.648 Vali Acc: 0.776 Test Loss: 0.648 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1767876148223877
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.192199468612671
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 238124
model size : 5.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4759514331817627
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.359 Vali Acc: 0.289 Test Loss: 1.359 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.1917698383331299
Epoch: 2, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.180 Vali Acc: 0.474 Test Loss: 1.180 Test Acc: 0.474
Validation loss decreased (-0.289460 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.325505018234253
Epoch: 3, Steps: 10 | Train Loss: 0.999 Vali Loss: 0.973 Vali Acc: 0.625 Test Loss: 0.973 Test Acc: 0.625
Validation loss decreased (-0.473672 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.4241576194763184
Epoch: 4, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.818 Vali Acc: 0.691 Test Loss: 0.818 Test Acc: 0.691
Validation loss decreased (-0.624990 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.273937702178955
Epoch: 5, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
Validation loss decreased (-0.690781 --> -0.756572).  Saving model ...
Epoch: 6 cost time: 1.2082111835479736
Epoch: 6, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.618 Vali Acc: 0.776 Test Loss: 0.618 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.1535038948059082
Epoch: 7, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.558 Vali Acc: 0.796 Test Loss: 0.558 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 1.000746488571167
Epoch: 8, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 9 cost time: 1.0640463829040527
Epoch: 9, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2523479461669922
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2130534648895264
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4983432292938232
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 13 cost time: 1.290773630142212
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 14 cost time: 1.2745778560638428
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.381577968597412
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 16 cost time: 1.2487726211547852
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2619659900665283
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.443704605102539
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3204607963562012
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.514 Vali Acc: 0.829 Test Loss: 0.514 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 20 cost time: 1.3614449501037598
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4520463943481445
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.535 Vali Acc: 0.829 Test Loss: 0.535 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2204973697662354
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4032087326049805
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3155055046081543
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.551 Vali Acc: 0.829 Test Loss: 0.551 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3421151638031006
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.556 Vali Acc: 0.829 Test Loss: 0.556 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2077889442443848
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4055707454681396
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4371960163116455
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.574 Vali Acc: 0.829 Test Loss: 0.574 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3626456260681152
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 205356
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6654675006866455
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.353 Vali Acc: 0.303 Test Loss: 1.353 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.2729132175445557
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.183 Vali Acc: 0.428 Test Loss: 1.183 Test Acc: 0.428
Validation loss decreased (-0.302618 --> -0.427620).  Saving model ...
Epoch: 3 cost time: 1.3955671787261963
Epoch: 3, Steps: 10 | Train Loss: 0.997 Vali Loss: 0.983 Vali Acc: 0.586 Test Loss: 0.983 Test Acc: 0.586
Validation loss decreased (-0.427620 --> -0.585516).  Saving model ...
Epoch: 4 cost time: 1.3360810279846191
Epoch: 4, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.830 Vali Acc: 0.691 Test Loss: 0.830 Test Acc: 0.691
Validation loss decreased (-0.585516 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.192915916442871
Epoch: 5, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.705 Vali Acc: 0.737 Test Loss: 0.705 Test Acc: 0.737
Validation loss decreased (-0.690781 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.1623926162719727
Epoch: 6, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.2830371856689453
Epoch: 7, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.1873648166656494
Epoch: 8, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.1796305179595947
Epoch: 9, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.407080888748169
Epoch: 10, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 11 cost time: 1.3027491569519043
Epoch: 11, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 12 cost time: 1.3718023300170898
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.480 Vali Acc: 0.816 Test Loss: 0.480 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 13 cost time: 1.2568178176879883
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.475 Vali Acc: 0.829 Test Loss: 0.475 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 14 cost time: 1.24369478225708
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3478102684020996
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4485797882080078
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.486 Vali Acc: 0.829 Test Loss: 0.486 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3548989295959473
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.486 Vali Acc: 0.829 Test Loss: 0.486 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3629748821258545
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.495 Vali Acc: 0.829 Test Loss: 0.495 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0998570919036865
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.504 Vali Acc: 0.822 Test Loss: 0.504 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2417380809783936
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2844038009643555
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.522 Vali Acc: 0.829 Test Loss: 0.522 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3725433349609375
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.518 Vali Acc: 0.829 Test Loss: 0.518 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2151751518249512
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.524 Vali Acc: 0.836 Test Loss: 0.524 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 24 cost time: 1.0258798599243164
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.530 Vali Acc: 0.836 Test Loss: 0.530 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3263373374938965
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1389379501342773
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.541 Vali Acc: 0.836 Test Loss: 0.541 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.283576488494873
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.544 Vali Acc: 0.842 Test Loss: 0.544 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 28 cost time: 1.345940351486206
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.559 Vali Acc: 0.836 Test Loss: 0.559 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4531385898590088
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.829 Test Loss: 0.573 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3315577507019043
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.836 Test Loss: 0.567 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2558574676513672
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.569 Vali Acc: 0.836 Test Loss: 0.569 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.111684799194336
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.842 Test Loss: 0.582 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1948747634887695
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.590 Vali Acc: 0.836 Test Loss: 0.590 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.314460039138794
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.584 Vali Acc: 0.836 Test Loss: 0.584 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1994149684906006
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.590 Vali Acc: 0.842 Test Loss: 0.590 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1352355480194092
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.842 Test Loss: 0.599 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0650341510772705
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.842 Test Loss: 0.602 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 205356
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3010058403015137
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.348 Vali Acc: 0.316 Test Loss: 1.348 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.1236109733581543
Epoch: 2, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.193 Vali Acc: 0.447 Test Loss: 1.193 Test Acc: 0.447
Validation loss decreased (-0.315776 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 0.9226179122924805
Epoch: 3, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.012 Vali Acc: 0.579 Test Loss: 1.012 Test Acc: 0.579
Validation loss decreased (-0.447356 --> -0.578937).  Saving model ...
Epoch: 4 cost time: 1.1096360683441162
Epoch: 4, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.866 Vali Acc: 0.684 Test Loss: 0.866 Test Acc: 0.684
Validation loss decreased (-0.578937 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 1.2134225368499756
Epoch: 5, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.737 Vali Acc: 0.737 Test Loss: 0.737 Test Acc: 0.737
Validation loss decreased (-0.684202 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.3379526138305664
Epoch: 6, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
Validation loss decreased (-0.736835 --> -0.782888).  Saving model ...
Epoch: 7 cost time: 1.3570756912231445
Epoch: 7, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0928370952606201
Epoch: 8, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
Validation loss decreased (-0.782888 --> -0.809205).  Saving model ...
Epoch: 9 cost time: 1.2005267143249512
Epoch: 9, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 10 cost time: 1.1137139797210693
Epoch: 10, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2260382175445557
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.474 Vali Acc: 0.836 Test Loss: 0.474 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835522).  Saving model ...
Epoch: 12 cost time: 1.2881882190704346
Epoch: 12, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.474 Vali Acc: 0.836 Test Loss: 0.474 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 13 cost time: 1.259223222732544
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3682188987731934
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.473 Vali Acc: 0.836 Test Loss: 0.473 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 15 cost time: 1.070082187652588
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2687585353851318
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.478 Vali Acc: 0.836 Test Loss: 0.478 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3263216018676758
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.479 Vali Acc: 0.836 Test Loss: 0.479 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2107679843902588
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.479 Vali Acc: 0.836 Test Loss: 0.479 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1707344055175781
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.228757381439209
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.489 Vali Acc: 0.829 Test Loss: 0.489 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1985905170440674
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9880645275115967
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.502 Vali Acc: 0.829 Test Loss: 0.502 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0620801448822021
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1536052227020264
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 205356
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.639671564102173
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.333 Vali Acc: 0.355 Test Loss: 1.333 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.1428930759429932
Epoch: 2, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.202 Vali Acc: 0.559 Test Loss: 1.202 Test Acc: 0.559
Validation loss decreased (-0.355250 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 1.0350658893585205
Epoch: 3, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.045 Vali Acc: 0.605 Test Loss: 1.045 Test Acc: 0.605
Validation loss decreased (-0.559199 --> -0.605253).  Saving model ...
Epoch: 4 cost time: 1.165067434310913
Epoch: 4, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.910 Vali Acc: 0.730 Test Loss: 0.910 Test Acc: 0.730
Validation loss decreased (-0.605253 --> -0.730254).  Saving model ...
Epoch: 5 cost time: 1.0931079387664795
Epoch: 5, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.783 Vali Acc: 0.743 Test Loss: 0.783 Test Acc: 0.743
Validation loss decreased (-0.730254 --> -0.743413).  Saving model ...
Epoch: 6 cost time: 1.1531915664672852
Epoch: 6, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.688 Vali Acc: 0.763 Test Loss: 0.688 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763151).  Saving model ...
Epoch: 7 cost time: 1.1815950870513916
Epoch: 7, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
Validation loss decreased (-0.763151 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.1805715560913086
Epoch: 8, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 9 cost time: 1.2628393173217773
Epoch: 9, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2178955078125
Epoch: 10, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8999559879302979
Epoch: 11, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.297184944152832
Epoch: 12, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 13 cost time: 1.2437036037445068
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1303272247314453
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2713422775268555
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2581112384796143
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.058838129043579
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2329645156860352
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.085543155670166
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2413218021392822
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2600650787353516
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2707850933074951
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 205356
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6612563133239746
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.356 Vali Acc: 0.296 Test Loss: 1.356 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.1527912616729736
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.254 Vali Acc: 0.401 Test Loss: 1.254 Test Acc: 0.401
Validation loss decreased (-0.296039 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.339921474456787
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (-0.401303 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 1.1931631565093994
Epoch: 4, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.004 Vali Acc: 0.612 Test Loss: 1.004 Test Acc: 0.612
Validation loss decreased (-0.532883 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.2496721744537354
Epoch: 5, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.891 Vali Acc: 0.651 Test Loss: 0.891 Test Acc: 0.651
Validation loss decreased (-0.611832 --> -0.651307).  Saving model ...
Epoch: 6 cost time: 1.1680686473846436
Epoch: 6, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.800 Vali Acc: 0.704 Test Loss: 0.800 Test Acc: 0.704
Validation loss decreased (-0.651307 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.2257721424102783
Epoch: 7, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.723 Vali Acc: 0.737 Test Loss: 0.723 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.376105785369873
Epoch: 8, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.663 Vali Acc: 0.750 Test Loss: 0.663 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 1.2616221904754639
Epoch: 9, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.0667405128479004
Epoch: 10, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.145378589630127
Epoch: 11, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.2689778804779053
Epoch: 12, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.1823866367340088
Epoch: 13, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9433953762054443
Epoch: 14, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.504 Vali Acc: 0.776 Test Loss: 0.504 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2558555603027344
Epoch: 15, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.495 Vali Acc: 0.783 Test Loss: 0.495 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 16 cost time: 1.2293434143066406
Epoch: 16, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.482 Vali Acc: 0.789 Test Loss: 0.482 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 17 cost time: 1.2637884616851807
Epoch: 17, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.488 Vali Acc: 0.789 Test Loss: 0.488 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9878759384155273
Epoch: 18, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.482 Vali Acc: 0.783 Test Loss: 0.482 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4167585372924805
Epoch: 19, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.476 Vali Acc: 0.789 Test Loss: 0.476 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 20 cost time: 1.3077080249786377
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.476 Vali Acc: 0.789 Test Loss: 0.476 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1860313415527344
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.473 Vali Acc: 0.783 Test Loss: 0.473 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2655432224273682
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3083930015563965
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.476 Vali Acc: 0.803 Test Loss: 0.476 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 24 cost time: 1.199282169342041
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.478 Vali Acc: 0.803 Test Loss: 0.478 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.269151210784912
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.484 Vali Acc: 0.796 Test Loss: 0.484 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2288737297058105
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.487 Vali Acc: 0.796 Test Loss: 0.487 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1282553672790527
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.489 Vali Acc: 0.796 Test Loss: 0.489 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2993664741516113
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.490 Vali Acc: 0.796 Test Loss: 0.490 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2302320003509521
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.025740623474121
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1893346309661865
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2807917594909668
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.222149133682251
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 34 cost time: 1.166306495666504
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2679812908172607
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 36 cost time: 1.0495223999023438
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 37 cost time: 1.2000527381896973
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4506604671478271
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3357439041137695
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.14341139793396
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.218970537185669
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.212278127670288
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.126640796661377
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2897677421569824
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.457190990447998
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.3691520690917969
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 577836
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8436715602874756
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.333 Vali Acc: 0.316 Test Loss: 1.333 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.2286899089813232
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.239 Vali Acc: 0.447 Test Loss: 1.239 Test Acc: 0.447
Validation loss decreased (-0.315776 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 1.1177561283111572
Epoch: 3, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.127 Vali Acc: 0.553 Test Loss: 1.127 Test Acc: 0.553
Validation loss decreased (-0.447356 --> -0.552620).  Saving model ...
Epoch: 4 cost time: 1.2409336566925049
Epoch: 4, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.008 Vali Acc: 0.618 Test Loss: 1.008 Test Acc: 0.618
Validation loss decreased (-0.552620 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 1.2773988246917725
Epoch: 5, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.901 Vali Acc: 0.671 Test Loss: 0.901 Test Acc: 0.671
Validation loss decreased (-0.618411 --> -0.671044).  Saving model ...
Epoch: 6 cost time: 1.116795539855957
Epoch: 6, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.809 Vali Acc: 0.750 Test Loss: 0.809 Test Acc: 0.750
Validation loss decreased (-0.671044 --> -0.749992).  Saving model ...
Epoch: 7 cost time: 1.1097304821014404
Epoch: 7, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.731 Vali Acc: 0.763 Test Loss: 0.731 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 1.2029969692230225
Epoch: 8, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.670 Vali Acc: 0.776 Test Loss: 0.670 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 9 cost time: 1.2142720222473145
Epoch: 9, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 10 cost time: 1.053391933441162
Epoch: 10, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.1846129894256592
Epoch: 11, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0724561214447021
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.1199536323547363
Epoch: 13, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9309542179107666
Epoch: 14, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1796977519989014
Epoch: 15, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.491 Vali Acc: 0.789 Test Loss: 0.491 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0498909950256348
Epoch: 16, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.479 Vali Acc: 0.796 Test Loss: 0.479 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 17 cost time: 1.3613393306732178
Epoch: 17, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 18 cost time: 1.397031545639038
Epoch: 18, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 19 cost time: 1.2641477584838867
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.471 Vali Acc: 0.809 Test Loss: 0.471 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 20 cost time: 1.1244440078735352
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2814903259277344
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 22 cost time: 1.0397586822509766
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1529529094696045
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2286417484283447
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 25 cost time: 1.139791488647461
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.476 Vali Acc: 0.803 Test Loss: 0.476 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2746045589447021
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2539706230163574
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1978719234466553
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1463115215301514
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3174409866333008
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4081861972808838
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0304107666015625
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.183786153793335
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8609809875488281
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 577836
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3688454627990723
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.347 Vali Acc: 0.336 Test Loss: 1.347 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.0024082660675049
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.263 Vali Acc: 0.434 Test Loss: 1.263 Test Acc: 0.434
Validation loss decreased (-0.335513 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.0882947444915771
Epoch: 3, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.161 Vali Acc: 0.559 Test Loss: 1.161 Test Acc: 0.559
Validation loss decreased (-0.434198 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.0457773208618164
Epoch: 4, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.053 Vali Acc: 0.618 Test Loss: 1.053 Test Acc: 0.618
Validation loss decreased (-0.559199 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 1.068429946899414
Epoch: 5, Steps: 10 | Train Loss: 0.888 Vali Loss: 0.948 Vali Acc: 0.651 Test Loss: 0.948 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 0.8738148212432861
Epoch: 6, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.860 Vali Acc: 0.684 Test Loss: 0.860 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684202).  Saving model ...
Epoch: 7 cost time: 0.9867606163024902
Epoch: 7, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.780 Vali Acc: 0.737 Test Loss: 0.780 Test Acc: 0.737
Validation loss decreased (-0.684202 --> -0.736834).  Saving model ...
Epoch: 8 cost time: 0.9461839199066162
Epoch: 8, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
Validation loss decreased (-0.736834 --> -0.769730).  Saving model ...
Epoch: 9 cost time: 1.0513551235198975
Epoch: 9, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.664 Vali Acc: 0.776 Test Loss: 0.664 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 1.156146764755249
Epoch: 10, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 11 cost time: 1.0715587139129639
Epoch: 11, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.587 Vali Acc: 0.796 Test Loss: 0.587 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.0220458507537842
Epoch: 12, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2436838150024414
Epoch: 13, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.306992769241333
Epoch: 14, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2453162670135498
Epoch: 15, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3635168075561523
Epoch: 16, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.1167469024658203
Epoch: 17, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2972826957702637
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.374561071395874
Epoch: 19, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 1.2214221954345703
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.1617786884307861
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 22 cost time: 0.9014670848846436
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0053300857543945
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.506 Vali Acc: 0.816 Test Loss: 0.506 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0383667945861816
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1046652793884277
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9645857810974121
Epoch: 26, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 27 cost time: 1.200791358947754
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2019984722137451
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1965222358703613
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4005200862884521
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.352285385131836
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3281140327453613
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3566718101501465
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2168552875518799
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.551 Vali Acc: 0.816 Test Loss: 0.551 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3109066486358643
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.572 Vali Acc: 0.796 Test Loss: 0.572 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4230248928070068
Epoch: 36, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.551 Vali Acc: 0.816 Test Loss: 0.551 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 577836
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.43666672706604
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.353 Vali Acc: 0.342 Test Loss: 1.353 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.2432234287261963
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.283 Vali Acc: 0.434 Test Loss: 1.283 Test Acc: 0.434
Validation loss decreased (-0.342092 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.0656039714813232
Epoch: 3, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.196 Vali Acc: 0.566 Test Loss: 1.196 Test Acc: 0.566
Validation loss decreased (-0.434198 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 0.9949986934661865
Epoch: 4, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.101 Vali Acc: 0.618 Test Loss: 1.101 Test Acc: 0.618
Validation loss decreased (-0.565778 --> -0.618410).  Saving model ...
Epoch: 5 cost time: 1.008862018585205
Epoch: 5, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.006 Vali Acc: 0.704 Test Loss: 1.006 Test Acc: 0.704
Validation loss decreased (-0.618410 --> -0.703937).  Saving model ...
Epoch: 6 cost time: 1.1070642471313477
Epoch: 6, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.922 Vali Acc: 0.697 Test Loss: 0.922 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1162419319152832
Epoch: 7, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.838 Vali Acc: 0.737 Test Loss: 0.838 Test Acc: 0.737
Validation loss decreased (-0.703937 --> -0.736834).  Saving model ...
Epoch: 8 cost time: 1.2575008869171143
Epoch: 8, Steps: 10 | Train Loss: 0.610 Vali Loss: 0.765 Vali Acc: 0.750 Test Loss: 0.765 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 1.1189422607421875
Epoch: 9, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.707 Vali Acc: 0.750 Test Loss: 0.707 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 1.0917649269104004
Epoch: 10, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.656 Vali Acc: 0.776 Test Loss: 0.656 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776309).  Saving model ...
Epoch: 11 cost time: 1.0319664478302002
Epoch: 11, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.3705151081085205
Epoch: 12, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.3515830039978027
Epoch: 13, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.563 Vali Acc: 0.796 Test Loss: 0.563 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.2006022930145264
Epoch: 14, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.548 Vali Acc: 0.776 Test Loss: 0.548 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1877753734588623
Epoch: 15, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0736336708068848
Epoch: 16, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3382647037506104
Epoch: 17, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3008143901824951
Epoch: 18, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1562438011169434
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1282639503479004
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2965278625488281
Epoch: 21, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3067283630371094
Epoch: 22, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3138015270233154
Epoch: 23, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 577836
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.005774736404419
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.438 Vali Acc: 0.342 Test Loss: 1.438 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 1.048032522201538
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.324 Vali Acc: 0.395 Test Loss: 1.324 Test Acc: 0.395
Validation loss decreased (-0.342091 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 0.9457039833068848
Epoch: 3, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.188 Vali Acc: 0.461 Test Loss: 1.188 Test Acc: 0.461
Validation loss decreased (-0.394724 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 1.321836233139038
Epoch: 4, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.056 Vali Acc: 0.605 Test Loss: 1.056 Test Acc: 0.605
Validation loss decreased (-0.460514 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 1.282233715057373
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.936 Vali Acc: 0.651 Test Loss: 0.936 Test Acc: 0.651
Validation loss decreased (-0.605253 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.0335381031036377
Epoch: 6, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.827 Vali Acc: 0.711 Test Loss: 0.827 Test Acc: 0.711
Validation loss decreased (-0.651306 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.1334648132324219
Epoch: 7, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.747 Vali Acc: 0.730 Test Loss: 0.747 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.0086112022399902
Epoch: 8, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.684 Vali Acc: 0.743 Test Loss: 0.684 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.2093381881713867
Epoch: 9, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.0772957801818848
Epoch: 10, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.2986397743225098
Epoch: 11, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.2471413612365723
Epoch: 12, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.3242089748382568
Epoch: 13, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.256152868270874
Epoch: 14, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809206).  Saving model ...
Epoch: 15 cost time: 1.3072707653045654
Epoch: 15, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.492 Vali Acc: 0.803 Test Loss: 0.492 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3344199657440186
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.483 Vali Acc: 0.816 Test Loss: 0.483 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 17 cost time: 1.0069704055786133
Epoch: 17, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.483 Vali Acc: 0.822 Test Loss: 0.483 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 18 cost time: 1.2957520484924316
Epoch: 18, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0674216747283936
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2137451171875
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1635441780090332
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 22 cost time: 1.1983931064605713
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 23 cost time: 1.0877106189727783
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.468 Vali Acc: 0.829 Test Loss: 0.468 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 24 cost time: 0.879326581954956
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.230332851409912
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.483 Vali Acc: 0.836 Test Loss: 0.483 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 26 cost time: 1.2183349132537842
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.474 Vali Acc: 0.829 Test Loss: 0.474 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2559502124786377
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.483 Vali Acc: 0.836 Test Loss: 0.483 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2280092239379883
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3639614582061768
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2636332511901855
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.489 Vali Acc: 0.842 Test Loss: 0.489 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 31 cost time: 1.0358455181121826
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.490 Vali Acc: 0.842 Test Loss: 0.490 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0239050388336182
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.496 Vali Acc: 0.836 Test Loss: 0.496 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1572237014770508
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.497 Vali Acc: 0.836 Test Loss: 0.497 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0320448875427246
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.496 Vali Acc: 0.836 Test Loss: 0.496 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.040912389755249
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.500 Vali Acc: 0.849 Test Loss: 0.500 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848679).  Saving model ...
Epoch: 36 cost time: 1.0885097980499268
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.503 Vali Acc: 0.849 Test Loss: 0.503 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1462128162384033
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.505 Vali Acc: 0.849 Test Loss: 0.505 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.035202980041504
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.505 Vali Acc: 0.849 Test Loss: 0.505 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1734364032745361
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.505 Vali Acc: 0.849 Test Loss: 0.505 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.302821397781372
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.512 Vali Acc: 0.836 Test Loss: 0.512 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.004939317703247
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.519 Vali Acc: 0.836 Test Loss: 0.519 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.192748785018921
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.520 Vali Acc: 0.842 Test Loss: 0.520 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.191739797592163
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.527 Vali Acc: 0.836 Test Loss: 0.527 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.172515630722046
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.528 Vali Acc: 0.849 Test Loss: 0.528 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.141430139541626
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.532 Vali Acc: 0.842 Test Loss: 0.532 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 315692
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.605083465576172
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.428 Vali Acc: 0.336 Test Loss: 1.428 Test Acc: 0.336
Validation loss decreased (inf --> -0.335512).  Saving model ...
Epoch: 2 cost time: 1.332029104232788
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.321 Vali Acc: 0.388 Test Loss: 1.321 Test Acc: 0.388
Validation loss decreased (-0.335512 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.1829583644866943
Epoch: 3, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.193 Vali Acc: 0.447 Test Loss: 1.193 Test Acc: 0.447
Validation loss decreased (-0.388145 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.162062168121338
Epoch: 4, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.065 Vali Acc: 0.572 Test Loss: 1.065 Test Acc: 0.572
Validation loss decreased (-0.447356 --> -0.572358).  Saving model ...
Epoch: 5 cost time: 1.1176087856292725
Epoch: 5, Steps: 10 | Train Loss: 0.870 Vali Loss: 0.953 Vali Acc: 0.645 Test Loss: 0.953 Test Acc: 0.645
Validation loss decreased (-0.572358 --> -0.644727).  Saving model ...
Epoch: 6 cost time: 1.1462314128875732
Epoch: 6, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.846 Vali Acc: 0.704 Test Loss: 0.846 Test Acc: 0.704
Validation loss decreased (-0.644727 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.3091161251068115
Epoch: 7, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.762 Vali Acc: 0.724 Test Loss: 0.762 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.2914931774139404
Epoch: 8, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.695 Vali Acc: 0.757 Test Loss: 0.695 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756572).  Saving model ...
Epoch: 9 cost time: 1.179001808166504
Epoch: 9, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.640 Vali Acc: 0.757 Test Loss: 0.640 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 0.9774467945098877
Epoch: 10, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.195275068283081
Epoch: 11, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.563 Vali Acc: 0.796 Test Loss: 0.563 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.3913304805755615
Epoch: 12, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.306739091873169
Epoch: 13, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.398249864578247
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 15 cost time: 1.0664021968841553
Epoch: 15, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 16 cost time: 1.1759836673736572
Epoch: 16, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 17 cost time: 1.2950375080108643
Epoch: 17, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.485 Vali Acc: 0.796 Test Loss: 0.485 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 18 cost time: 1.4904813766479492
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 19 cost time: 1.2157611846923828
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.481 Vali Acc: 0.796 Test Loss: 0.481 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.235685110092163
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.478 Vali Acc: 0.796 Test Loss: 0.478 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3020122051239014
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.479 Vali Acc: 0.796 Test Loss: 0.479 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2254743576049805
Epoch: 22, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.473 Vali Acc: 0.796 Test Loss: 0.473 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1490535736083984
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 24 cost time: 1.2135155200958252
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1909148693084717
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.487 Vali Acc: 0.796 Test Loss: 0.487 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9400582313537598
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 27 cost time: 1.202970027923584
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8997046947479248
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2302799224853516
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3406164646148682
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1613471508026123
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2244291305541992
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.023249626159668
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1453289985656738
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1988790035247803
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2617683410644531
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 315692
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8451154232025146
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.422 Vali Acc: 0.283 Test Loss: 1.422 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.3411943912506104
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.330 Vali Acc: 0.368 Test Loss: 1.330 Test Acc: 0.368
Validation loss decreased (-0.282881 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.2271428108215332
Epoch: 3, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
Validation loss decreased (-0.368408 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.283010721206665
Epoch: 4, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.100 Vali Acc: 0.592 Test Loss: 1.100 Test Acc: 0.592
Validation loss decreased (-0.467093 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 1.310279369354248
Epoch: 5, Steps: 10 | Train Loss: 0.932 Vali Loss: 0.996 Vali Acc: 0.638 Test Loss: 0.996 Test Acc: 0.638
Validation loss decreased (-0.592094 --> -0.638148).  Saving model ...
Epoch: 6 cost time: 1.1628921031951904
Epoch: 6, Steps: 10 | Train Loss: 0.779 Vali Loss: 0.890 Vali Acc: 0.691 Test Loss: 0.890 Test Acc: 0.691
Validation loss decreased (-0.638148 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 1.1706173419952393
Epoch: 7, Steps: 10 | Train Loss: 0.639 Vali Loss: 0.806 Vali Acc: 0.743 Test Loss: 0.806 Test Acc: 0.743
Validation loss decreased (-0.690781 --> -0.743413).  Saving model ...
Epoch: 8 cost time: 1.0464789867401123
Epoch: 8, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.733 Vali Acc: 0.743 Test Loss: 0.733 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.1718451976776123
Epoch: 9, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.670 Vali Acc: 0.776 Test Loss: 0.670 Test Acc: 0.776
Validation loss decreased (-0.743414 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 1.3155770301818848
Epoch: 10, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.2615704536437988
Epoch: 11, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
Validation loss decreased (-0.782889 --> -0.822363).  Saving model ...
Epoch: 12 cost time: 1.0680956840515137
Epoch: 12, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2597129344940186
Epoch: 13, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9905939102172852
Epoch: 14, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3570668697357178
Epoch: 15, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.218717098236084
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 17 cost time: 1.1549243927001953
Epoch: 17, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 18 cost time: 1.1118850708007812
Epoch: 18, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.506 Vali Acc: 0.829 Test Loss: 0.506 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 19 cost time: 0.8862404823303223
Epoch: 19, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.050443172454834
Epoch: 20, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1180694103240967
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.100539207458496
Epoch: 22, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.040076732635498
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 24 cost time: 0.892108678817749
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1230905055999756
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.503 Vali Acc: 0.829 Test Loss: 0.503 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2790741920471191
Epoch: 26, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.114922285079956
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3182220458984375
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9564332962036133
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.503 Vali Acc: 0.816 Test Loss: 0.503 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2238876819610596
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.334324598312378
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1364586353302002
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3165245056152344
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 315692
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7289066314697266
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.374 Vali Acc: 0.309 Test Loss: 1.374 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.1479213237762451
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
Validation loss decreased (-0.309197 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.036785364151001
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.213 Vali Acc: 0.507 Test Loss: 1.213 Test Acc: 0.507
Validation loss decreased (-0.374987 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 0.9451401233673096
Epoch: 4, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.116 Vali Acc: 0.592 Test Loss: 1.116 Test Acc: 0.592
Validation loss decreased (-0.506567 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 1.0846412181854248
Epoch: 5, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.023 Vali Acc: 0.651 Test Loss: 1.023 Test Acc: 0.651
Validation loss decreased (-0.592094 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.0939297676086426
Epoch: 6, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.925 Vali Acc: 0.704 Test Loss: 0.925 Test Acc: 0.704
Validation loss decreased (-0.651306 --> -0.703938).  Saving model ...
Epoch: 7 cost time: 1.0886356830596924
Epoch: 7, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.841 Vali Acc: 0.717 Test Loss: 0.841 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717097).  Saving model ...
Epoch: 8 cost time: 1.132943868637085
Epoch: 8, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.766 Vali Acc: 0.737 Test Loss: 0.766 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736834).  Saving model ...
Epoch: 9 cost time: 0.9812495708465576
Epoch: 9, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.700 Vali Acc: 0.776 Test Loss: 0.700 Test Acc: 0.776
Validation loss decreased (-0.736834 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 1.0988740921020508
Epoch: 10, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 11 cost time: 1.2893171310424805
Epoch: 11, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.605 Vali Acc: 0.816 Test Loss: 0.605 Test Acc: 0.816
Validation loss decreased (-0.782888 --> -0.815783).  Saving model ...
Epoch: 12 cost time: 1.1780130863189697
Epoch: 12, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1331839561462402
Epoch: 13, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1224400997161865
Epoch: 14, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0475718975067139
Epoch: 15, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.146155834197998
Epoch: 16, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0597114562988281
Epoch: 17, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.197983741760254
Epoch: 18, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.908851146697998
Epoch: 19, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9228172302246094
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.062826156616211
Epoch: 21, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 315692
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7174530029296875
Epoch: 1, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.320 Vali Acc: 0.368 Test Loss: 1.320 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 0.9895288944244385
Epoch: 2, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.228 Vali Acc: 0.467 Test Loss: 1.228 Test Acc: 0.467
Validation loss decreased (-0.368408 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 1.2190873622894287
Epoch: 3, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.110 Vali Acc: 0.520 Test Loss: 1.110 Test Acc: 0.520
Validation loss decreased (-0.467093 --> -0.519726).  Saving model ...
Epoch: 4 cost time: 0.8951008319854736
Epoch: 4, Steps: 10 | Train Loss: 0.914 Vali Loss: 0.992 Vali Acc: 0.592 Test Loss: 0.992 Test Acc: 0.592
Validation loss decreased (-0.519726 --> -0.592095).  Saving model ...
Epoch: 5 cost time: 0.9889850616455078
Epoch: 5, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.887 Vali Acc: 0.632 Test Loss: 0.887 Test Acc: 0.632
Validation loss decreased (-0.592095 --> -0.631570).  Saving model ...
Epoch: 6 cost time: 0.9448151588439941
Epoch: 6, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.802 Vali Acc: 0.678 Test Loss: 0.802 Test Acc: 0.678
Validation loss decreased (-0.631570 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 1.0060253143310547
Epoch: 7, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.728 Vali Acc: 0.691 Test Loss: 0.728 Test Acc: 0.691
Validation loss decreased (-0.677624 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 1.2464840412139893
Epoch: 8, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.667 Vali Acc: 0.711 Test Loss: 0.667 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710520).  Saving model ...
Epoch: 9 cost time: 1.2287957668304443
Epoch: 9, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.617 Vali Acc: 0.743 Test Loss: 0.617 Test Acc: 0.743
Validation loss decreased (-0.710520 --> -0.743415).  Saving model ...
Epoch: 10 cost time: 1.2041409015655518
Epoch: 10, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.0333330631256104
Epoch: 11, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.235349178314209
Epoch: 12, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.549 Vali Acc: 0.750 Test Loss: 0.549 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2233777046203613
Epoch: 13, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.244950532913208
Epoch: 14, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.2411248683929443
Epoch: 15, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.3332984447479248
Epoch: 16, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1983802318572998
Epoch: 17, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.492 Vali Acc: 0.803 Test Loss: 0.492 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3812658786773682
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822364).  Saving model ...
Epoch: 19 cost time: 1.1855804920196533
Epoch: 19, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.129042148590088
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0912775993347168
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.141085147857666
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 23 cost time: 1.2301583290100098
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.494 Vali Acc: 0.829 Test Loss: 0.494 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.246826410293579
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.492 Vali Acc: 0.842 Test Loss: 0.492 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842100).  Saving model ...
Epoch: 25 cost time: 0.9165847301483154
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.281463384628296
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.493 Vali Acc: 0.842 Test Loss: 0.493 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1466455459594727
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0419056415557861
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.280287742614746
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0778965950012207
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.508 Vali Acc: 0.842 Test Loss: 0.508 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2137248516082764
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.513 Vali Acc: 0.836 Test Loss: 0.513 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.249018669128418
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.513 Vali Acc: 0.829 Test Loss: 0.513 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2033557891845703
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.516 Vali Acc: 0.836 Test Loss: 0.516 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0983517169952393
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.524 Vali Acc: 0.836 Test Loss: 0.524 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 184620
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.501309394836426
Epoch: 1, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.329 Vali Acc: 0.349 Test Loss: 1.329 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 0.9863348007202148
Epoch: 2, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.244 Vali Acc: 0.408 Test Loss: 1.244 Test Acc: 0.408
Validation loss decreased (-0.348671 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 0.9650192260742188
Epoch: 3, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.134 Vali Acc: 0.487 Test Loss: 1.134 Test Acc: 0.487
Validation loss decreased (-0.407882 --> -0.486831).  Saving model ...
Epoch: 4 cost time: 1.0841424465179443
Epoch: 4, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.021 Vali Acc: 0.539 Test Loss: 1.021 Test Acc: 0.539
Validation loss decreased (-0.486831 --> -0.539463).  Saving model ...
Epoch: 5 cost time: 1.1196515560150146
Epoch: 5, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.917 Vali Acc: 0.612 Test Loss: 0.917 Test Acc: 0.612
Validation loss decreased (-0.539463 --> -0.611833).  Saving model ...
Epoch: 6 cost time: 0.9789187908172607
Epoch: 6, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.829 Vali Acc: 0.625 Test Loss: 0.829 Test Acc: 0.625
Validation loss decreased (-0.611833 --> -0.624992).  Saving model ...
Epoch: 7 cost time: 0.988746166229248
Epoch: 7, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.753 Vali Acc: 0.684 Test Loss: 0.753 Test Acc: 0.684
Validation loss decreased (-0.624992 --> -0.684203).  Saving model ...
Epoch: 8 cost time: 1.0640816688537598
Epoch: 8, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.691 Vali Acc: 0.711 Test Loss: 0.691 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 0.9565198421478271
Epoch: 9, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.638 Vali Acc: 0.724 Test Loss: 0.638 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723678).  Saving model ...
Epoch: 10 cost time: 1.1832656860351562
Epoch: 10, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
Validation loss decreased (-0.723678 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.1172785758972168
Epoch: 11, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.0917840003967285
Epoch: 12, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0650672912597656
Epoch: 13, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.2864482402801514
Epoch: 14, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.335144281387329
Epoch: 15, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 16 cost time: 1.0784502029418945
Epoch: 16, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0741589069366455
Epoch: 17, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 18 cost time: 0.9531862735748291
Epoch: 18, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.254584789276123
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2615103721618652
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 1.3106834888458252
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1281938552856445
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 23 cost time: 1.0767741203308105
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2269432544708252
Epoch: 24, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2483439445495605
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0648043155670166
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.927490234375
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2170000076293945
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1143605709075928
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1016864776611328
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1257281303405762
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2430400848388672
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 33 cost time: 1.052657127380371
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1592164039611816
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.829 Test Loss: 0.531 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 35 cost time: 1.0361337661743164
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2104060649871826
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.198134183883667
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1579821109771729
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1842586994171143
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0696094036102295
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1076898574829102
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0817453861236572
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0803453922271729
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.1018681526184082
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 184620
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7922215461730957
Epoch: 1, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.340 Vali Acc: 0.309 Test Loss: 1.340 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.3581280708312988
Epoch: 2, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.261 Vali Acc: 0.401 Test Loss: 1.261 Test Acc: 0.401
Validation loss decreased (-0.309197 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.1991956233978271
Epoch: 3, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.156 Vali Acc: 0.474 Test Loss: 1.156 Test Acc: 0.474
Validation loss decreased (-0.401303 --> -0.473673).  Saving model ...
Epoch: 4 cost time: 1.237708330154419
Epoch: 4, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.047 Vali Acc: 0.566 Test Loss: 1.047 Test Acc: 0.566
Validation loss decreased (-0.473673 --> -0.565779).  Saving model ...
Epoch: 5 cost time: 1.3090403079986572
Epoch: 5, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.947 Vali Acc: 0.605 Test Loss: 0.947 Test Acc: 0.605
Validation loss decreased (-0.565779 --> -0.605254).  Saving model ...
Epoch: 6 cost time: 1.2327656745910645
Epoch: 6, Steps: 10 | Train Loss: 0.722 Vali Loss: 0.859 Vali Acc: 0.678 Test Loss: 0.859 Test Acc: 0.678
Validation loss decreased (-0.605254 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 1.0322859287261963
Epoch: 7, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.780 Vali Acc: 0.697 Test Loss: 0.780 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 1.285851240158081
Epoch: 8, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.714 Vali Acc: 0.724 Test Loss: 0.714 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 0.9670047760009766
Epoch: 9, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.658 Vali Acc: 0.763 Test Loss: 0.658 Test Acc: 0.763
Validation loss decreased (-0.723677 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 1.233677864074707
Epoch: 10, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.619 Vali Acc: 0.776 Test Loss: 0.619 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.2306807041168213
Epoch: 11, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.2894561290740967
Epoch: 12, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.270768165588379
Epoch: 13, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.377295970916748
Epoch: 14, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.27402925491333
Epoch: 15, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.1773736476898193
Epoch: 16, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4030745029449463
Epoch: 17, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 18 cost time: 1.2496044635772705
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 1.2559428215026855
Epoch: 19, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.1411442756652832
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4393293857574463
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9838740825653076
Epoch: 22, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9999992847442627
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.108381748199463
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 25 cost time: 1.0257313251495361
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.047276258468628
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2841532230377197
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3040001392364502
Epoch: 28, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2080061435699463
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 30 cost time: 1.3497958183288574
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.538 Vali Acc: 0.829 Test Loss: 0.538 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 31 cost time: 1.0648117065429688
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2276291847229004
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3228769302368164
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1960318088531494
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1698729991912842
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.559 Vali Acc: 0.829 Test Loss: 0.559 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3675494194030762
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2265543937683105
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2037646770477295
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1304497718811035
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2782421112060547
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.586 Vali Acc: 0.809 Test Loss: 0.586 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 184620
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5131137371063232
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.383 Vali Acc: 0.250 Test Loss: 1.383 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3280689716339111
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.312 Vali Acc: 0.368 Test Loss: 1.312 Test Acc: 0.368
Validation loss decreased (-0.249986 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.1976628303527832
Epoch: 3, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.215 Vali Acc: 0.487 Test Loss: 1.215 Test Acc: 0.487
Validation loss decreased (-0.368408 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 1.1224663257598877
Epoch: 4, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.111 Vali Acc: 0.605 Test Loss: 1.111 Test Acc: 0.605
Validation loss decreased (-0.486830 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 1.0445449352264404
Epoch: 5, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.013 Vali Acc: 0.664 Test Loss: 1.013 Test Acc: 0.664
Validation loss decreased (-0.605252 --> -0.664464).  Saving model ...
Epoch: 6 cost time: 1.0394384860992432
Epoch: 6, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.922 Vali Acc: 0.691 Test Loss: 0.922 Test Acc: 0.691
Validation loss decreased (-0.664464 --> -0.690780).  Saving model ...
Epoch: 7 cost time: 1.0751984119415283
Epoch: 7, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.839 Vali Acc: 0.717 Test Loss: 0.839 Test Acc: 0.717
Validation loss decreased (-0.690780 --> -0.717097).  Saving model ...
Epoch: 8 cost time: 1.216094732284546
Epoch: 8, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.768 Vali Acc: 0.737 Test Loss: 0.768 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736834).  Saving model ...
Epoch: 9 cost time: 1.0895538330078125
Epoch: 9, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.706 Vali Acc: 0.743 Test Loss: 0.706 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 10 cost time: 1.145984411239624
Epoch: 10, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.653 Vali Acc: 0.757 Test Loss: 0.653 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 1.1089777946472168
Epoch: 11, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.614 Vali Acc: 0.776 Test Loss: 0.614 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.1488707065582275
Epoch: 12, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.583 Vali Acc: 0.776 Test Loss: 0.583 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.229954481124878
Epoch: 13, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.037733793258667
Epoch: 14, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.1552066802978516
Epoch: 15, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1074800491333008
Epoch: 16, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.123547077178955
Epoch: 17, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.163088321685791
Epoch: 18, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0959460735321045
Epoch: 19, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1139719486236572
Epoch: 20, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.175734281539917
Epoch: 21, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 22 cost time: 1.2266886234283447
Epoch: 22, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1324620246887207
Epoch: 23, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1710004806518555
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0580291748046875
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1816353797912598
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0345935821533203
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0965838432312012
Epoch: 28, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.238053560256958
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0874133110046387
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1194121837615967
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 184620
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8862082958221436
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.429 Vali Acc: 0.197 Test Loss: 1.429 Test Acc: 0.197
Validation loss decreased (inf --> -0.197354).  Saving model ...
Epoch: 2 cost time: 0.9505512714385986
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.318 Vali Acc: 0.355 Test Loss: 1.318 Test Acc: 0.355
Validation loss decreased (-0.197354 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.1410412788391113
Epoch: 3, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.355250 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2745141983032227
Epoch: 4, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.048 Vali Acc: 0.546 Test Loss: 1.048 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546042).  Saving model ...
Epoch: 5 cost time: 1.2816908359527588
Epoch: 5, Steps: 10 | Train Loss: 0.887 Vali Loss: 0.928 Vali Acc: 0.645 Test Loss: 0.928 Test Acc: 0.645
Validation loss decreased (-0.546042 --> -0.644728).  Saving model ...
Epoch: 6 cost time: 1.0965960025787354
Epoch: 6, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.821 Vali Acc: 0.711 Test Loss: 0.821 Test Acc: 0.711
Validation loss decreased (-0.644728 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.2473018169403076
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.732 Vali Acc: 0.763 Test Loss: 0.732 Test Acc: 0.763
Validation loss decreased (-0.710518 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 1.2641441822052002
Epoch: 8, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.670 Vali Acc: 0.750 Test Loss: 0.670 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3465375900268555
Epoch: 9, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.310089349746704
Epoch: 10, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.1218290328979492
Epoch: 11, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.2341375350952148
Epoch: 12, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.2471632957458496
Epoch: 13, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0310416221618652
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 15 cost time: 1.3158419132232666
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.492 Vali Acc: 0.803 Test Loss: 0.492 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 1.2648677825927734
Epoch: 16, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.213989496231079
Epoch: 17, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.479 Vali Acc: 0.796 Test Loss: 0.479 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3450613021850586
Epoch: 18, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.478 Vali Acc: 0.803 Test Loss: 0.478 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 19 cost time: 1.3012175559997559
Epoch: 19, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 1.33176589012146
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.476 Vali Acc: 0.796 Test Loss: 0.476 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2630226612091064
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 22 cost time: 1.4136533737182617
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.475 Vali Acc: 0.796 Test Loss: 0.475 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2217178344726562
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.473 Vali Acc: 0.796 Test Loss: 0.473 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2967841625213623
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1322762966156006
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2351856231689453
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9822545051574707
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2983887195587158
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.489 Vali Acc: 0.796 Test Loss: 0.489 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.13309645652771
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1232638359069824
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2233877182006836
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 119084
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6251466274261475
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.428 Vali Acc: 0.224 Test Loss: 1.428 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.2238736152648926
Epoch: 2, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.326 Vali Acc: 0.329 Test Loss: 1.326 Test Acc: 0.329
Validation loss decreased (-0.223670 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.149369716644287
Epoch: 3, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.200 Vali Acc: 0.487 Test Loss: 1.200 Test Acc: 0.487
Validation loss decreased (-0.328934 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 1.1892201900482178
Epoch: 4, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.071 Vali Acc: 0.592 Test Loss: 1.071 Test Acc: 0.592
Validation loss decreased (-0.486830 --> -0.592095).  Saving model ...
Epoch: 5 cost time: 1.2573282718658447
Epoch: 5, Steps: 10 | Train Loss: 0.910 Vali Loss: 0.957 Vali Acc: 0.651 Test Loss: 0.957 Test Acc: 0.651
Validation loss decreased (-0.592095 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.382483959197998
Epoch: 6, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.852 Vali Acc: 0.704 Test Loss: 0.852 Test Acc: 0.704
Validation loss decreased (-0.651306 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.2909901142120361
Epoch: 7, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.763 Vali Acc: 0.750 Test Loss: 0.763 Test Acc: 0.750
Validation loss decreased (-0.703939 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.3040268421173096
Epoch: 8, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.694 Vali Acc: 0.763 Test Loss: 0.694 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763151).  Saving model ...
Epoch: 9 cost time: 1.2975502014160156
Epoch: 9, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.636 Vali Acc: 0.776 Test Loss: 0.636 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 1.2364897727966309
Epoch: 10, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.2153100967407227
Epoch: 11, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.563 Vali Acc: 0.796 Test Loss: 0.563 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.2925834655761719
Epoch: 12, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.1972949504852295
Epoch: 13, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2085978984832764
Epoch: 14, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 15 cost time: 1.16849684715271
Epoch: 15, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822364).  Saving model ...
Epoch: 16 cost time: 1.2350897789001465
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.178589105606079
Epoch: 17, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.975473165512085
Epoch: 18, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.473 Vali Acc: 0.816 Test Loss: 0.473 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1666791439056396
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.32883882522583
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2842857837677002
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.473 Vali Acc: 0.816 Test Loss: 0.473 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2553324699401855
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.064988136291504
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2018229961395264
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 25 cost time: 1.151308536529541
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2731385231018066
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.484 Vali Acc: 0.829 Test Loss: 0.484 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2148053646087646
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1868770122528076
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.059098720550537
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.483 Vali Acc: 0.822 Test Loss: 0.483 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2171733379364014
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2389466762542725
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.157649278640747
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1742744445800781
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0948631763458252
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.503 Vali Acc: 0.816 Test Loss: 0.503 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 119084
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.595360040664673
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.404 Vali Acc: 0.257 Test Loss: 1.404 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 0.9050431251525879
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.319 Vali Acc: 0.382 Test Loss: 1.319 Test Acc: 0.382
Validation loss decreased (-0.256565 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.175295352935791
Epoch: 3, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.212 Vali Acc: 0.533 Test Loss: 1.212 Test Acc: 0.533
Validation loss decreased (-0.381566 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 1.2131786346435547
Epoch: 4, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.096 Vali Acc: 0.559 Test Loss: 1.096 Test Acc: 0.559
Validation loss decreased (-0.532883 --> -0.559200).  Saving model ...
Epoch: 5 cost time: 1.049117088317871
Epoch: 5, Steps: 10 | Train Loss: 0.946 Vali Loss: 0.989 Vali Acc: 0.625 Test Loss: 0.989 Test Acc: 0.625
Validation loss decreased (-0.559200 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 1.022937536239624
Epoch: 6, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.888 Vali Acc: 0.671 Test Loss: 0.888 Test Acc: 0.671
Validation loss decreased (-0.624990 --> -0.671044).  Saving model ...
Epoch: 7 cost time: 1.1357901096343994
Epoch: 7, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.802 Vali Acc: 0.724 Test Loss: 0.802 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723676).  Saving model ...
Epoch: 8 cost time: 1.1020071506500244
Epoch: 8, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.730 Vali Acc: 0.737 Test Loss: 0.730 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 0.9401748180389404
Epoch: 9, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.669 Vali Acc: 0.763 Test Loss: 0.669 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 1.195801019668579
Epoch: 10, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.619 Vali Acc: 0.776 Test Loss: 0.619 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.0293622016906738
Epoch: 11, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.587 Vali Acc: 0.796 Test Loss: 0.587 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.1723957061767578
Epoch: 12, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.0755281448364258
Epoch: 13, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.087378978729248
Epoch: 14, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.524 Vali Acc: 0.829 Test Loss: 0.524 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828942).  Saving model ...
Epoch: 15 cost time: 1.2418572902679443
Epoch: 15, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.513 Vali Acc: 0.829 Test Loss: 0.513 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 16 cost time: 1.1687781810760498
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0796597003936768
Epoch: 17, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2761459350585938
Epoch: 18, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 19 cost time: 1.2116551399230957
Epoch: 19, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0513324737548828
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1382341384887695
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 22 cost time: 1.127828598022461
Epoch: 22, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.489 Vali Acc: 0.829 Test Loss: 0.489 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 23 cost time: 1.0900225639343262
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.488 Vali Acc: 0.836 Test Loss: 0.488 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 24 cost time: 0.9565753936767578
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.493 Vali Acc: 0.829 Test Loss: 0.493 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.088153600692749
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.501 Vali Acc: 0.836 Test Loss: 0.501 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1654059886932373
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.511 Vali Acc: 0.836 Test Loss: 0.511 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1286733150482178
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.503 Vali Acc: 0.836 Test Loss: 0.503 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.287118673324585
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.158069372177124
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.511 Vali Acc: 0.836 Test Loss: 0.511 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1999046802520752
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.520 Vali Acc: 0.829 Test Loss: 0.520 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0515449047088623
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9152228832244873
Epoch: 32, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0828964710235596
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.528 Vali Acc: 0.829 Test Loss: 0.528 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 119084
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6804280281066895
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.378 Vali Acc: 0.322 Test Loss: 1.378 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 0.9039738178253174
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.309 Vali Acc: 0.461 Test Loss: 1.309 Test Acc: 0.461
Validation loss decreased (-0.322355 --> -0.460513).  Saving model ...
Epoch: 3 cost time: 1.0162005424499512
Epoch: 3, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.221 Vali Acc: 0.605 Test Loss: 1.221 Test Acc: 0.605
Validation loss decreased (-0.460513 --> -0.605251).  Saving model ...
Epoch: 4 cost time: 0.9991891384124756
Epoch: 4, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.122 Vali Acc: 0.684 Test Loss: 1.122 Test Acc: 0.684
Validation loss decreased (-0.605251 --> -0.684199).  Saving model ...
Epoch: 5 cost time: 1.1704189777374268
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.028 Vali Acc: 0.684 Test Loss: 1.028 Test Acc: 0.684
Validation loss decreased (-0.684199 --> -0.684200).  Saving model ...
Epoch: 6 cost time: 1.0811514854431152
Epoch: 6, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.935 Vali Acc: 0.730 Test Loss: 0.935 Test Acc: 0.730
Validation loss decreased (-0.684200 --> -0.730254).  Saving model ...
Epoch: 7 cost time: 0.9159634113311768
Epoch: 7, Steps: 10 | Train Loss: 0.750 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
Validation loss decreased (-0.730254 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.0916001796722412
Epoch: 8, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 1.0929479598999023
Epoch: 9, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.706 Vali Acc: 0.770 Test Loss: 0.706 Test Acc: 0.770
Validation loss decreased (-0.749992 --> -0.769730).  Saving model ...
Epoch: 10 cost time: 1.0338997840881348
Epoch: 10, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.651 Vali Acc: 0.770 Test Loss: 0.651 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 11 cost time: 1.0564875602722168
Epoch: 11, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.0613629817962646
Epoch: 12, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
Validation loss decreased (-0.776310 --> -0.822363).  Saving model ...
Epoch: 13 cost time: 1.0575013160705566
Epoch: 13, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0840671062469482
Epoch: 14, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0907540321350098
Epoch: 15, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0375487804412842
Epoch: 16, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.073958158493042
Epoch: 17, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0126547813415527
Epoch: 18, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1219022274017334
Epoch: 19, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2955522537231445
Epoch: 20, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0980324745178223
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.046830654144287
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 119084
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9100735187530518
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.355 Vali Acc: 0.355 Test Loss: 1.355 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.3255703449249268
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.261 Vali Acc: 0.480 Test Loss: 1.261 Test Acc: 0.480
Validation loss decreased (-0.355250 --> -0.480251).  Saving model ...
Epoch: 3 cost time: 1.0864019393920898
Epoch: 3, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.138 Vali Acc: 0.539 Test Loss: 1.138 Test Acc: 0.539
Validation loss decreased (-0.480251 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.1188130378723145
Epoch: 4, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.013 Vali Acc: 0.632 Test Loss: 1.013 Test Acc: 0.632
Validation loss decreased (-0.539462 --> -0.631569).  Saving model ...
Epoch: 5 cost time: 1.3697898387908936
Epoch: 5, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.896 Vali Acc: 0.697 Test Loss: 0.896 Test Acc: 0.697
Validation loss decreased (-0.631569 --> -0.697359).  Saving model ...
Epoch: 6 cost time: 1.262030839920044
Epoch: 6, Steps: 10 | Train Loss: 0.711 Vali Loss: 0.798 Vali Acc: 0.724 Test Loss: 0.798 Test Acc: 0.724
Validation loss decreased (-0.697359 --> -0.723676).  Saving model ...
Epoch: 7 cost time: 1.0752904415130615
Epoch: 7, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.717 Vali Acc: 0.757 Test Loss: 0.717 Test Acc: 0.757
Validation loss decreased (-0.723676 --> -0.756572).  Saving model ...
Epoch: 8 cost time: 1.1638953685760498
Epoch: 8, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
Validation loss decreased (-0.756572 --> -0.796046).  Saving model ...
Epoch: 9 cost time: 1.3310329914093018
Epoch: 9, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.097769021987915
Epoch: 10, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 0.9826724529266357
Epoch: 11, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 12 cost time: 1.1603634357452393
Epoch: 12, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 13 cost time: 1.1289031505584717
Epoch: 13, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 14 cost time: 1.3435876369476318
Epoch: 14, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.330620288848877
Epoch: 15, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2268974781036377
Epoch: 16, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2509524822235107
Epoch: 17, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 18 cost time: 1.1690754890441895
Epoch: 18, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3062968254089355
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.467 Vali Acc: 0.829 Test Loss: 0.467 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 20 cost time: 1.211545705795288
Epoch: 20, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.464 Vali Acc: 0.822 Test Loss: 0.464 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1311159133911133
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.903813362121582
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.463 Vali Acc: 0.816 Test Loss: 0.463 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2238671779632568
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.466 Vali Acc: 0.829 Test Loss: 0.466 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 24 cost time: 1.138134241104126
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.468 Vali Acc: 0.829 Test Loss: 0.468 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2383723258972168
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.473 Vali Acc: 0.829 Test Loss: 0.473 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1837890148162842
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.481 Vali Acc: 0.836 Test Loss: 0.481 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 27 cost time: 0.9921393394470215
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3271589279174805
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.334850549697876
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2480957508087158
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.492 Vali Acc: 0.836 Test Loss: 0.492 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3042593002319336
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1631083488464355
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4042251110076904
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2157011032104492
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.505 Vali Acc: 0.836 Test Loss: 0.505 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.281179666519165
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.511 Vali Acc: 0.836 Test Loss: 0.511 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2971184253692627
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.514 Vali Acc: 0.829 Test Loss: 0.514 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 86316
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6804323196411133
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.368 Vali Acc: 0.322 Test Loss: 1.368 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.2690942287445068
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.279 Vali Acc: 0.414 Test Loss: 1.279 Test Acc: 0.414
Validation loss decreased (-0.322355 --> -0.414461).  Saving model ...
Epoch: 3 cost time: 1.1147990226745605
Epoch: 3, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.161 Vali Acc: 0.526 Test Loss: 1.161 Test Acc: 0.526
Validation loss decreased (-0.414461 --> -0.526304).  Saving model ...
Epoch: 4 cost time: 1.0795400142669678
Epoch: 4, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.042 Vali Acc: 0.632 Test Loss: 1.042 Test Acc: 0.632
Validation loss decreased (-0.526304 --> -0.631569).  Saving model ...
Epoch: 5 cost time: 1.2817723751068115
Epoch: 5, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.926 Vali Acc: 0.678 Test Loss: 0.926 Test Acc: 0.678
Validation loss decreased (-0.631569 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 1.1350901126861572
Epoch: 6, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.828 Vali Acc: 0.717 Test Loss: 0.828 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717097).  Saving model ...
Epoch: 7 cost time: 1.182521104812622
Epoch: 7, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.747 Vali Acc: 0.770 Test Loss: 0.747 Test Acc: 0.770
Validation loss decreased (-0.717097 --> -0.769729).  Saving model ...
Epoch: 8 cost time: 1.071833610534668
Epoch: 8, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
Validation loss decreased (-0.769729 --> -0.802625).  Saving model ...
Epoch: 9 cost time: 1.1329185962677002
Epoch: 9, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.145817518234253
Epoch: 10, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.0214450359344482
Epoch: 11, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.1070177555084229
Epoch: 12, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 13 cost time: 1.1558749675750732
Epoch: 13, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.510 Vali Acc: 0.836 Test Loss: 0.510 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835521).  Saving model ...
Epoch: 14 cost time: 1.229745626449585
Epoch: 14, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.500 Vali Acc: 0.829 Test Loss: 0.500 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1072797775268555
Epoch: 15, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2892515659332275
Epoch: 16, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1953344345092773
Epoch: 17, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.477 Vali Acc: 0.836 Test Loss: 0.477 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 18 cost time: 1.0603156089782715
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.468 Vali Acc: 0.803 Test Loss: 0.468 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2429955005645752
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.462 Vali Acc: 0.816 Test Loss: 0.462 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2523279190063477
Epoch: 20, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.466 Vali Acc: 0.836 Test Loss: 0.466 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 21 cost time: 1.091951608657837
Epoch: 21, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.113823413848877
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.462 Vali Acc: 0.816 Test Loss: 0.462 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0354301929473877
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.470 Vali Acc: 0.836 Test Loss: 0.470 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3049287796020508
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.468 Vali Acc: 0.816 Test Loss: 0.468 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2234234809875488
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0595250129699707
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.482 Vali Acc: 0.836 Test Loss: 0.482 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.209594964981079
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9751846790313721
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.213515043258667
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2006149291992188
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.491 Vali Acc: 0.836 Test Loss: 0.491 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 86316
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5749833583831787
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.400 Vali Acc: 0.250 Test Loss: 1.400 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.0375216007232666
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.319 Vali Acc: 0.375 Test Loss: 1.319 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.1487324237823486
Epoch: 3, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.210 Vali Acc: 0.507 Test Loss: 1.210 Test Acc: 0.507
Validation loss decreased (-0.374987 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.0957472324371338
Epoch: 4, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.100 Vali Acc: 0.579 Test Loss: 1.100 Test Acc: 0.579
Validation loss decreased (-0.506567 --> -0.578936).  Saving model ...
Epoch: 5 cost time: 0.8914957046508789
Epoch: 5, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.987 Vali Acc: 0.658 Test Loss: 0.987 Test Acc: 0.658
Validation loss decreased (-0.578936 --> -0.657885).  Saving model ...
Epoch: 6 cost time: 1.0766808986663818
Epoch: 6, Steps: 10 | Train Loss: 0.778 Vali Loss: 0.886 Vali Acc: 0.671 Test Loss: 0.886 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671044).  Saving model ...
Epoch: 7 cost time: 1.096628189086914
Epoch: 7, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.800 Vali Acc: 0.757 Test Loss: 0.800 Test Acc: 0.757
Validation loss decreased (-0.671044 --> -0.756571).  Saving model ...
Epoch: 8 cost time: 0.9991321563720703
Epoch: 8, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.718 Vali Acc: 0.757 Test Loss: 0.718 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756572).  Saving model ...
Epoch: 9 cost time: 1.1965794563293457
Epoch: 9, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 0.9814825057983398
Epoch: 10, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.776309 --> -0.809204).  Saving model ...
Epoch: 11 cost time: 1.1886513233184814
Epoch: 11, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.0788302421569824
Epoch: 12, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0759179592132568
Epoch: 13, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0684807300567627
Epoch: 14, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.097902536392212
Epoch: 15, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2851512432098389
Epoch: 16, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0999844074249268
Epoch: 17, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.05586838722229
Epoch: 18, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0959558486938477
Epoch: 19, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0326521396636963
Epoch: 20, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822364).  Saving model ...
Epoch: 21 cost time: 0.8216638565063477
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0653958320617676
Epoch: 22, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9141969680786133
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0035200119018555
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1022987365722656
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1359002590179443
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.254824161529541
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9028093814849854
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1678855419158936
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2596948146820068
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 86316
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6340315341949463
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.402 Vali Acc: 0.263 Test Loss: 1.402 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.0480597019195557
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.334 Vali Acc: 0.375 Test Loss: 1.334 Test Acc: 0.375
Validation loss decreased (-0.263144 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.0407030582427979
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.243 Vali Acc: 0.513 Test Loss: 1.243 Test Acc: 0.513
Validation loss decreased (-0.374987 --> -0.513145).  Saving model ...
Epoch: 4 cost time: 1.212010145187378
Epoch: 4, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.145 Vali Acc: 0.592 Test Loss: 1.145 Test Acc: 0.592
Validation loss decreased (-0.513145 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 1.2809216976165771
Epoch: 5, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.044 Vali Acc: 0.664 Test Loss: 1.044 Test Acc: 0.664
Validation loss decreased (-0.592094 --> -0.664463).  Saving model ...
Epoch: 6 cost time: 1.1544983386993408
Epoch: 6, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.950 Vali Acc: 0.684 Test Loss: 0.950 Test Acc: 0.684
Validation loss decreased (-0.664463 --> -0.684201).  Saving model ...
Epoch: 7 cost time: 1.209589958190918
Epoch: 7, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.863 Vali Acc: 0.724 Test Loss: 0.863 Test Acc: 0.724
Validation loss decreased (-0.684201 --> -0.723676).  Saving model ...
Epoch: 8 cost time: 0.9289810657501221
Epoch: 8, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.777 Vali Acc: 0.763 Test Loss: 0.777 Test Acc: 0.763
Validation loss decreased (-0.723676 --> -0.763150).  Saving model ...
Epoch: 9 cost time: 1.1002373695373535
Epoch: 9, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
Validation loss decreased (-0.763150 --> -0.782888).  Saving model ...
Epoch: 10 cost time: 1.1249313354492188
Epoch: 10, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.658 Vali Acc: 0.789 Test Loss: 0.658 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 11 cost time: 1.2213590145111084
Epoch: 11, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 12 cost time: 1.10675048828125
Epoch: 12, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.1357576847076416
Epoch: 13, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 0.8388803005218506
Epoch: 14, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 1.0843532085418701
Epoch: 15, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0872180461883545
Epoch: 16, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.102524995803833
Epoch: 17, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0579044818878174
Epoch: 18, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0173568725585938
Epoch: 19, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1464934349060059
Epoch: 20, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1480722427368164
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 22 cost time: 1.0446534156799316
Epoch: 22, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9915566444396973
Epoch: 23, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0094149112701416
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.009526252746582
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0409226417541504
Epoch: 26, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0195708274841309
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1511502265930176
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.025273084640503
Epoch: 29, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0284578800201416
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2008275985717773
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 86316
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.59798526763916
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.317 Vali Acc: 0.316 Test Loss: 1.317 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.241243839263916
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.216 Vali Acc: 0.467 Test Loss: 1.216 Test Acc: 0.467
Validation loss decreased (-0.315776 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 1.2556660175323486
Epoch: 3, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.088 Vali Acc: 0.618 Test Loss: 1.088 Test Acc: 0.618
Validation loss decreased (-0.467093 --> -0.618410).  Saving model ...
Epoch: 4 cost time: 1.2115063667297363
Epoch: 4, Steps: 10 | Train Loss: 0.997 Vali Loss: 0.953 Vali Acc: 0.697 Test Loss: 0.953 Test Acc: 0.697
Validation loss decreased (-0.618410 --> -0.697359).  Saving model ...
Epoch: 5 cost time: 1.2257401943206787
Epoch: 5, Steps: 10 | Train Loss: 0.809 Vali Loss: 0.838 Vali Acc: 0.737 Test Loss: 0.838 Test Acc: 0.737
Validation loss decreased (-0.697359 --> -0.736834).  Saving model ...
Epoch: 6 cost time: 1.231020450592041
Epoch: 6, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.746 Vali Acc: 0.750 Test Loss: 0.746 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.343106746673584
Epoch: 7, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.672 Vali Acc: 0.763 Test Loss: 0.672 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 1.4030108451843262
Epoch: 8, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.622 Vali Acc: 0.757 Test Loss: 0.622 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3168294429779053
Epoch: 9, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.574 Vali Acc: 0.757 Test Loss: 0.574 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2284388542175293
Epoch: 10, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.1651301383972168
Epoch: 11, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 12 cost time: 1.1150341033935547
Epoch: 12, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 1.3008060455322266
Epoch: 13, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815785).  Saving model ...
Epoch: 14 cost time: 1.4101977348327637
Epoch: 14, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2149322032928467
Epoch: 15, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.458 Vali Acc: 0.816 Test Loss: 0.458 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 16 cost time: 1.060396432876587
Epoch: 16, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2514762878417969
Epoch: 17, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 18 cost time: 0.9445302486419678
Epoch: 18, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 19 cost time: 1.0436489582061768
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.450 Vali Acc: 0.809 Test Loss: 0.450 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.077967643737793
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.449 Vali Acc: 0.816 Test Loss: 0.449 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9675564765930176
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.451 Vali Acc: 0.822 Test Loss: 0.451 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.151050329208374
Epoch: 22, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 23 cost time: 1.07871675491333
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.226872444152832
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.449 Vali Acc: 0.822 Test Loss: 0.449 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.002685785293579
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.454 Vali Acc: 0.816 Test Loss: 0.454 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.169684648513794
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.454 Vali Acc: 0.809 Test Loss: 0.454 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2588975429534912
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.462 Vali Acc: 0.822 Test Loss: 0.462 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1867165565490723
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.467 Vali Acc: 0.816 Test Loss: 0.467 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9956915378570557
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0940794944763184
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.472 Vali Acc: 0.816 Test Loss: 0.472 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1094284057617188
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 32 cost time: 1.2869601249694824
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.478 Vali Acc: 0.829 Test Loss: 0.478 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2101631164550781
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.480 Vali Acc: 0.822 Test Loss: 0.480 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2882091999053955
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1920125484466553
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3008522987365723
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.487 Vali Acc: 0.829 Test Loss: 0.487 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2978711128234863
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2369604110717773
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.138967752456665
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9368290901184082
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.015573263168335
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 69932
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7379302978515625
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.312 Vali Acc: 0.316 Test Loss: 1.312 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.1310439109802246
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.223 Vali Acc: 0.474 Test Loss: 1.223 Test Acc: 0.474
Validation loss decreased (-0.315776 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.1711313724517822
Epoch: 3, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.103 Vali Acc: 0.572 Test Loss: 1.103 Test Acc: 0.572
Validation loss decreased (-0.473672 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 1.1808922290802002
Epoch: 4, Steps: 10 | Train Loss: 1.011 Vali Loss: 0.978 Vali Acc: 0.697 Test Loss: 0.978 Test Acc: 0.697
Validation loss decreased (-0.572357 --> -0.697359).  Saving model ...
Epoch: 5 cost time: 1.0931487083435059
Epoch: 5, Steps: 10 | Train Loss: 0.832 Vali Loss: 0.867 Vali Acc: 0.776 Test Loss: 0.867 Test Acc: 0.776
Validation loss decreased (-0.697359 --> -0.776307).  Saving model ...
Epoch: 6 cost time: 1.0867741107940674
Epoch: 6, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.772 Vali Acc: 0.743 Test Loss: 0.772 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3368303775787354
Epoch: 7, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.696 Vali Acc: 0.743 Test Loss: 0.696 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.350848913192749
Epoch: 8, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.642 Vali Acc: 0.763 Test Loss: 0.642 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.141862392425537
Epoch: 9, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
Validation loss decreased (-0.776307 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.1620500087738037
Epoch: 10, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4460980892181396
Epoch: 11, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.217712640762329
Epoch: 12, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.2789454460144043
Epoch: 13, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 14 cost time: 1.116628646850586
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 15 cost time: 1.1822025775909424
Epoch: 15, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.475 Vali Acc: 0.836 Test Loss: 0.475 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 16 cost time: 1.292123794555664
Epoch: 16, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.336796760559082
Epoch: 17, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0497725009918213
Epoch: 18, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0506103038787842
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.466 Vali Acc: 0.836 Test Loss: 0.466 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 20 cost time: 0.9905121326446533
Epoch: 20, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.462 Vali Acc: 0.829 Test Loss: 0.462 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.327336311340332
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.463 Vali Acc: 0.829 Test Loss: 0.463 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0048465728759766
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.458 Vali Acc: 0.816 Test Loss: 0.458 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.158714771270752
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.463 Vali Acc: 0.829 Test Loss: 0.463 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2850725650787354
Epoch: 24, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1095662117004395
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.462 Vali Acc: 0.816 Test Loss: 0.462 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1930534839630127
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.462 Vali Acc: 0.816 Test Loss: 0.462 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1216514110565186
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.140028476715088
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1768839359283447
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 69932
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.878096342086792
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.305 Vali Acc: 0.349 Test Loss: 1.305 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.2127163410186768
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.348671 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.0401256084442139
Epoch: 3, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.125 Vali Acc: 0.625 Test Loss: 1.125 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 1.1020593643188477
Epoch: 4, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.013 Vali Acc: 0.704 Test Loss: 1.013 Test Acc: 0.704
Validation loss decreased (-0.624989 --> -0.703937).  Saving model ...
Epoch: 5 cost time: 0.8196501731872559
Epoch: 5, Steps: 10 | Train Loss: 0.882 Vali Loss: 0.913 Vali Acc: 0.757 Test Loss: 0.913 Test Acc: 0.757
Validation loss decreased (-0.703937 --> -0.756570).  Saving model ...
Epoch: 6 cost time: 1.0423252582550049
Epoch: 6, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.821 Vali Acc: 0.757 Test Loss: 0.821 Test Acc: 0.757
Validation loss decreased (-0.756570 --> -0.756571).  Saving model ...
Epoch: 7 cost time: 1.1789612770080566
Epoch: 7, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.743 Vali Acc: 0.783 Test Loss: 0.743 Test Acc: 0.783
Validation loss decreased (-0.756571 --> -0.782887).  Saving model ...
Epoch: 8 cost time: 1.3561680316925049
Epoch: 8, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
Validation loss decreased (-0.782887 --> -0.782888).  Saving model ...
Epoch: 9 cost time: 1.1277568340301514
Epoch: 9, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.634 Vali Acc: 0.776 Test Loss: 0.634 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0364949703216553
Epoch: 10, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 0.9591269493103027
Epoch: 11, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.001427173614502
Epoch: 12, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1053991317749023
Epoch: 13, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0177624225616455
Epoch: 14, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 1.160057544708252
Epoch: 15, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1745960712432861
Epoch: 16, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9790458679199219
Epoch: 17, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2207062244415283
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9105138778686523
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9952266216278076
Epoch: 20, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1865270137786865
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1938507556915283
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 23 cost time: 1.062812089920044
Epoch: 23, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0189199447631836
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8512039184570312
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8637022972106934
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0616331100463867
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9701504707336426
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.515 Vali Acc: 0.816 Test Loss: 0.515 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1787190437316895
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.050288438796997
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1044178009033203
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.032379388809204
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 69932
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9023685455322266
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.300 Vali Acc: 0.401 Test Loss: 1.300 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 1.0055510997772217
Epoch: 2, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.237 Vali Acc: 0.493 Test Loss: 1.237 Test Acc: 0.493
Validation loss decreased (-0.401303 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 1.0981366634368896
Epoch: 3, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.152 Vali Acc: 0.625 Test Loss: 1.152 Test Acc: 0.625
Validation loss decreased (-0.493409 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 1.181875467300415
Epoch: 4, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.058 Vali Acc: 0.697 Test Loss: 1.058 Test Acc: 0.697
Validation loss decreased (-0.624988 --> -0.697358).  Saving model ...
Epoch: 5 cost time: 1.0415732860565186
Epoch: 5, Steps: 10 | Train Loss: 0.948 Vali Loss: 0.968 Vali Acc: 0.704 Test Loss: 0.968 Test Acc: 0.704
Validation loss decreased (-0.697358 --> -0.703938).  Saving model ...
Epoch: 6 cost time: 0.8316032886505127
Epoch: 6, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.883 Vali Acc: 0.730 Test Loss: 0.883 Test Acc: 0.730
Validation loss decreased (-0.703938 --> -0.730254).  Saving model ...
Epoch: 7 cost time: 0.9080500602722168
Epoch: 7, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.805 Vali Acc: 0.743 Test Loss: 0.805 Test Acc: 0.743
Validation loss decreased (-0.730254 --> -0.743413).  Saving model ...
Epoch: 8 cost time: 1.0644404888153076
Epoch: 8, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.740 Vali Acc: 0.763 Test Loss: 0.740 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 9 cost time: 1.1383006572723389
Epoch: 9, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.684 Vali Acc: 0.776 Test Loss: 0.684 Test Acc: 0.776
Validation loss decreased (-0.763150 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 1.0040428638458252
Epoch: 10, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.639 Vali Acc: 0.783 Test Loss: 0.639 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 11 cost time: 0.9067502021789551
Epoch: 11, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
Validation loss decreased (-0.782888 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.0562617778778076
Epoch: 12, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.158736228942871
Epoch: 13, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1163341999053955
Epoch: 14, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 15 cost time: 1.0648066997528076
Epoch: 15, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 16 cost time: 0.9646706581115723
Epoch: 16, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9626166820526123
Epoch: 17, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 18 cost time: 1.0459315776824951
Epoch: 18, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 19 cost time: 1.0415380001068115
Epoch: 19, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.514 Vali Acc: 0.829 Test Loss: 0.514 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1336736679077148
Epoch: 20, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.873262882232666
Epoch: 21, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0238916873931885
Epoch: 22, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9942173957824707
Epoch: 23, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.014465570449829
Epoch: 24, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.958280086517334
Epoch: 25, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9293792247772217
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9318318367004395
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9164910316467285
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 69932
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.1344895362854
Epoch: 1, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.408 Vali Acc: 0.316 Test Loss: 1.408 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 1.318835735321045
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.349 Vali Acc: 0.362 Test Loss: 1.349 Test Acc: 0.362
Validation loss decreased (-0.315775 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.0847811698913574
Epoch: 3, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.274 Vali Acc: 0.441 Test Loss: 1.274 Test Acc: 0.441
Validation loss decreased (-0.361829 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 1.1611809730529785
Epoch: 4, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.194 Vali Acc: 0.513 Test Loss: 1.194 Test Acc: 0.513
Validation loss decreased (-0.440777 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 1.2687745094299316
Epoch: 5, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.115 Vali Acc: 0.572 Test Loss: 1.115 Test Acc: 0.572
Validation loss decreased (-0.513146 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.2804813385009766
Epoch: 6, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.032 Vali Acc: 0.572 Test Loss: 1.032 Test Acc: 0.572
Validation loss decreased (-0.572357 --> -0.572358).  Saving model ...
Epoch: 7 cost time: 1.2533509731292725
Epoch: 7, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.962 Vali Acc: 0.579 Test Loss: 0.962 Test Acc: 0.579
Validation loss decreased (-0.572358 --> -0.578938).  Saving model ...
Epoch: 8 cost time: 1.3704116344451904
Epoch: 8, Steps: 10 | Train Loss: 0.718 Vali Loss: 0.894 Vali Acc: 0.632 Test Loss: 0.894 Test Acc: 0.632
Validation loss decreased (-0.578938 --> -0.631570).  Saving model ...
Epoch: 9 cost time: 1.057837963104248
Epoch: 9, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.836 Vali Acc: 0.658 Test Loss: 0.836 Test Acc: 0.658
Validation loss decreased (-0.631570 --> -0.657886).  Saving model ...
Epoch: 10 cost time: 0.9704127311706543
Epoch: 10, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.784 Vali Acc: 0.684 Test Loss: 0.784 Test Acc: 0.684
Validation loss decreased (-0.657886 --> -0.684203).  Saving model ...
Epoch: 11 cost time: 1.1544592380523682
Epoch: 11, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.734 Vali Acc: 0.697 Test Loss: 0.734 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 12 cost time: 1.3920085430145264
Epoch: 12, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.698 Vali Acc: 0.711 Test Loss: 0.698 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 13 cost time: 1.1864571571350098
Epoch: 13, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.668 Vali Acc: 0.730 Test Loss: 0.668 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 14 cost time: 1.297314167022705
Epoch: 14, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.645 Vali Acc: 0.737 Test Loss: 0.645 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 15 cost time: 1.2209889888763428
Epoch: 15, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.624 Vali Acc: 0.730 Test Loss: 0.624 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2215831279754639
Epoch: 16, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.610 Vali Acc: 0.750 Test Loss: 0.610 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 0.9458293914794922
Epoch: 17, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 18 cost time: 1.241142749786377
Epoch: 18, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.584 Vali Acc: 0.763 Test Loss: 0.584 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1547598838806152
Epoch: 19, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1706485748291016
Epoch: 20, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3024981021881104
Epoch: 21, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.342865228652954
Epoch: 22, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.3312249183654785
Epoch: 23, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.549 Vali Acc: 0.776 Test Loss: 0.549 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.148421049118042
Epoch: 24, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3716018199920654
Epoch: 25, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2536015510559082
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.187253713607788
Epoch: 27, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.212552547454834
Epoch: 28, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 29 cost time: 1.1709575653076172
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0763323307037354
Epoch: 30, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.543 Vali Acc: 0.770 Test Loss: 0.543 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4277186393737793
Epoch: 31, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 32 cost time: 1.0526728630065918
Epoch: 32, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.076932668685913
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.541 Vali Acc: 0.750 Test Loss: 0.541 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.086848497390747
Epoch: 34, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9681878089904785
Epoch: 35, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.956754207611084
Epoch: 36, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1577401161193848
Epoch: 37, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2706091403961182
Epoch: 38, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2462141513824463
Epoch: 39, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1265573501586914
Epoch: 40, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1944868564605713
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 280748
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.295661211013794
Epoch: 1, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.399 Vali Acc: 0.309 Test Loss: 1.399 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.3062992095947266
Epoch: 2, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.341 Vali Acc: 0.355 Test Loss: 1.341 Test Acc: 0.355
Validation loss decreased (-0.309197 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.0823333263397217
Epoch: 3, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.271 Vali Acc: 0.395 Test Loss: 1.271 Test Acc: 0.395
Validation loss decreased (-0.355250 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.1533031463623047
Epoch: 4, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.197 Vali Acc: 0.493 Test Loss: 1.197 Test Acc: 0.493
Validation loss decreased (-0.394724 --> -0.493409).  Saving model ...
Epoch: 5 cost time: 1.0242958068847656
Epoch: 5, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.121 Vali Acc: 0.539 Test Loss: 1.121 Test Acc: 0.539
Validation loss decreased (-0.493409 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 1.1845054626464844
Epoch: 6, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.041 Vali Acc: 0.592 Test Loss: 1.041 Test Acc: 0.592
Validation loss decreased (-0.539462 --> -0.592095).  Saving model ...
Epoch: 7 cost time: 1.1379995346069336
Epoch: 7, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.974 Vali Acc: 0.579 Test Loss: 0.974 Test Acc: 0.579
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4176435470581055
Epoch: 8, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.906 Vali Acc: 0.632 Test Loss: 0.906 Test Acc: 0.632
Validation loss decreased (-0.592095 --> -0.631570).  Saving model ...
Epoch: 9 cost time: 1.0872673988342285
Epoch: 9, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.849 Vali Acc: 0.651 Test Loss: 0.849 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651307).  Saving model ...
Epoch: 10 cost time: 1.0423214435577393
Epoch: 10, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.794 Vali Acc: 0.691 Test Loss: 0.794 Test Acc: 0.691
Validation loss decreased (-0.651307 --> -0.690782).  Saving model ...
Epoch: 11 cost time: 0.9692680835723877
Epoch: 11, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.745 Vali Acc: 0.717 Test Loss: 0.745 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 12 cost time: 1.1788864135742188
Epoch: 12, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.709 Vali Acc: 0.711 Test Loss: 0.709 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.177396535873413
Epoch: 13, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 14 cost time: 1.0802042484283447
Epoch: 14, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.647 Vali Acc: 0.743 Test Loss: 0.647 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 1.1533770561218262
Epoch: 15, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 0.9948925971984863
Epoch: 16, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.611 Vali Acc: 0.757 Test Loss: 0.611 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 0.9674410820007324
Epoch: 17, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 18 cost time: 1.0884852409362793
Epoch: 18, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 19 cost time: 1.0279591083526611
Epoch: 19, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.570 Vali Acc: 0.763 Test Loss: 0.570 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9766204357147217
Epoch: 20, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1709206104278564
Epoch: 21, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.548 Vali Acc: 0.776 Test Loss: 0.548 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 0.9459600448608398
Epoch: 22, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.2016098499298096
Epoch: 23, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.013472557067871
Epoch: 24, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 1.1676957607269287
Epoch: 25, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 26 cost time: 0.9418463706970215
Epoch: 26, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2635974884033203
Epoch: 27, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 1.168712854385376
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0118589401245117
Epoch: 29, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 30 cost time: 1.0580425262451172
Epoch: 30, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0840175151824951
Epoch: 31, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2868537902832031
Epoch: 32, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1319093704223633
Epoch: 33, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 34 cost time: 0.917421817779541
Epoch: 34, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0977323055267334
Epoch: 35, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1787338256835938
Epoch: 36, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2061598300933838
Epoch: 37, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1049094200134277
Epoch: 38, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1852431297302246
Epoch: 39, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2724058628082275
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.3877906799316406
Epoch: 41, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.5309481620788574
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.318753719329834
Epoch: 43, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 280748
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4453091621398926
Epoch: 1, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.388 Vali Acc: 0.289 Test Loss: 1.388 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.2341573238372803
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.337 Vali Acc: 0.368 Test Loss: 1.337 Test Acc: 0.368
Validation loss decreased (-0.289460 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.1930787563323975
Epoch: 3, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.275 Vali Acc: 0.428 Test Loss: 1.275 Test Acc: 0.428
Validation loss decreased (-0.368408 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.2707862854003906
Epoch: 4, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.205 Vali Acc: 0.493 Test Loss: 1.205 Test Acc: 0.493
Validation loss decreased (-0.427619 --> -0.493409).  Saving model ...
Epoch: 5 cost time: 1.2298588752746582
Epoch: 5, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.137 Vali Acc: 0.539 Test Loss: 1.137 Test Acc: 0.539
Validation loss decreased (-0.493409 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 1.2146525382995605
Epoch: 6, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.064 Vali Acc: 0.566 Test Loss: 1.064 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565779).  Saving model ...
Epoch: 7 cost time: 1.2280731201171875
Epoch: 7, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.001 Vali Acc: 0.605 Test Loss: 1.001 Test Acc: 0.605
Validation loss decreased (-0.565779 --> -0.605253).  Saving model ...
Epoch: 8 cost time: 1.1729865074157715
Epoch: 8, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.934 Vali Acc: 0.651 Test Loss: 0.934 Test Acc: 0.651
Validation loss decreased (-0.605253 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 1.3070170879364014
Epoch: 9, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.878 Vali Acc: 0.658 Test Loss: 0.878 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657886).  Saving model ...
Epoch: 10 cost time: 1.0895836353302002
Epoch: 10, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.822 Vali Acc: 0.671 Test Loss: 0.822 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 1.1975109577178955
Epoch: 11, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.772 Vali Acc: 0.691 Test Loss: 0.772 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690782).  Saving model ...
Epoch: 12 cost time: 1.2263808250427246
Epoch: 12, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 13 cost time: 1.1658070087432861
Epoch: 13, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.694 Vali Acc: 0.711 Test Loss: 0.694 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0822362899780273
Epoch: 14, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.665 Vali Acc: 0.724 Test Loss: 0.665 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 15 cost time: 1.2036421298980713
Epoch: 15, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.640 Vali Acc: 0.737 Test Loss: 0.640 Test Acc: 0.737
Validation loss decreased (-0.723678 --> -0.736836).  Saving model ...
Epoch: 16 cost time: 1.2557146549224854
Epoch: 16, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.621 Vali Acc: 0.730 Test Loss: 0.621 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2320985794067383
Epoch: 17, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 18 cost time: 1.1432030200958252
Epoch: 18, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.1518778800964355
Epoch: 19, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 1.1267027854919434
Epoch: 20, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 21 cost time: 1.0736353397369385
Epoch: 21, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1298859119415283
Epoch: 22, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 23 cost time: 1.0110681056976318
Epoch: 23, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 0.9403207302093506
Epoch: 24, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.983349084854126
Epoch: 25, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.536 Vali Acc: 0.770 Test Loss: 0.536 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.306687593460083
Epoch: 26, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 1.2054095268249512
Epoch: 27, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.2093505859375
Epoch: 28, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3346457481384277
Epoch: 29, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2437245845794678
Epoch: 30, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 31 cost time: 1.179579496383667
Epoch: 31, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1982073783874512
Epoch: 32, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 33 cost time: 1.1745474338531494
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2548482418060303
Epoch: 34, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2513775825500488
Epoch: 35, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.271857500076294
Epoch: 36, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.532 Vali Acc: 0.770 Test Loss: 0.532 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2829539775848389
Epoch: 37, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.159226655960083
Epoch: 38, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3056960105895996
Epoch: 39, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.224482774734497
Epoch: 40, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2358217239379883
Epoch: 41, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1368403434753418
Epoch: 42, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 280748
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1279456615448
Epoch: 1, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.371 Vali Acc: 0.250 Test Loss: 1.371 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.0233469009399414
Epoch: 2, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.329 Vali Acc: 0.322 Test Loss: 1.329 Test Acc: 0.322
Validation loss decreased (-0.249986 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.0618581771850586
Epoch: 3, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.277 Vali Acc: 0.428 Test Loss: 1.277 Test Acc: 0.428
Validation loss decreased (-0.322355 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.1117603778839111
Epoch: 4, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.220 Vali Acc: 0.467 Test Loss: 1.220 Test Acc: 0.467
Validation loss decreased (-0.427619 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 0.9638519287109375
Epoch: 5, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.161 Vali Acc: 0.533 Test Loss: 1.161 Test Acc: 0.533
Validation loss decreased (-0.467093 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 1.152759075164795
Epoch: 6, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.098 Vali Acc: 0.572 Test Loss: 1.098 Test Acc: 0.572
Validation loss decreased (-0.532883 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 1.2048816680908203
Epoch: 7, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.042 Vali Acc: 0.618 Test Loss: 1.042 Test Acc: 0.618
Validation loss decreased (-0.572357 --> -0.618411).  Saving model ...
Epoch: 8 cost time: 1.0099897384643555
Epoch: 8, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.982 Vali Acc: 0.651 Test Loss: 0.982 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 1.0341224670410156
Epoch: 9, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.928 Vali Acc: 0.664 Test Loss: 0.928 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664464).  Saving model ...
Epoch: 10 cost time: 0.9601230621337891
Epoch: 10, Steps: 10 | Train Loss: 0.686 Vali Loss: 0.876 Vali Acc: 0.678 Test Loss: 0.876 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677623).  Saving model ...
Epoch: 11 cost time: 1.0454366207122803
Epoch: 11, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.825 Vali Acc: 0.717 Test Loss: 0.825 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717097).  Saving model ...
Epoch: 12 cost time: 1.1074624061584473
Epoch: 12, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
Validation loss decreased (-0.717097 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 1.1123487949371338
Epoch: 13, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.744 Vali Acc: 0.730 Test Loss: 0.744 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2475802898406982
Epoch: 14, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.713 Vali Acc: 0.743 Test Loss: 0.713 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.96030592918396
Epoch: 15, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.682 Vali Acc: 0.743 Test Loss: 0.682 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9461054801940918
Epoch: 16, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.661 Vali Acc: 0.757 Test Loss: 0.661 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756572).  Saving model ...
Epoch: 17 cost time: 1.2454261779785156
Epoch: 17, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.639 Vali Acc: 0.757 Test Loss: 0.639 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 18 cost time: 1.1462376117706299
Epoch: 18, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.623 Vali Acc: 0.763 Test Loss: 0.623 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.0285868644714355
Epoch: 19, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.611 Vali Acc: 0.763 Test Loss: 0.611 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 0.9877326488494873
Epoch: 20, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.180840253829956
Epoch: 21, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.586 Vali Acc: 0.763 Test Loss: 0.586 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 22 cost time: 1.1765031814575195
Epoch: 22, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 0.9826095104217529
Epoch: 23, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 24 cost time: 1.1869914531707764
Epoch: 24, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0298616886138916
Epoch: 25, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1054012775421143
Epoch: 26, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.559 Vali Acc: 0.757 Test Loss: 0.559 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1090011596679688
Epoch: 27, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.554 Vali Acc: 0.763 Test Loss: 0.554 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0441617965698242
Epoch: 28, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.551 Vali Acc: 0.763 Test Loss: 0.551 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2585432529449463
Epoch: 29, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0470960140228271
Epoch: 30, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0148134231567383
Epoch: 31, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2509841918945312
Epoch: 32, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8421692848205566
Epoch: 33, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.547 Vali Acc: 0.750 Test Loss: 0.547 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 280748
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.473755121231079
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.310 Vali Acc: 0.447 Test Loss: 1.310 Test Acc: 0.447
Validation loss decreased (inf --> -0.447355).  Saving model ...
Epoch: 2 cost time: 1.1214616298675537
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.250 Vali Acc: 0.513 Test Loss: 1.250 Test Acc: 0.513
Validation loss decreased (-0.447355 --> -0.513145).  Saving model ...
Epoch: 3 cost time: 1.0314669609069824
Epoch: 3, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.183 Vali Acc: 0.553 Test Loss: 1.183 Test Acc: 0.553
Validation loss decreased (-0.513145 --> -0.552620).  Saving model ...
Epoch: 4 cost time: 1.387305498123169
Epoch: 4, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.106 Vali Acc: 0.586 Test Loss: 1.106 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 1.2929916381835938
Epoch: 5, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.028 Vali Acc: 0.658 Test Loss: 1.028 Test Acc: 0.658
Validation loss decreased (-0.585515 --> -0.657884).  Saving model ...
Epoch: 6 cost time: 1.273362398147583
Epoch: 6, Steps: 10 | Train Loss: 0.957 Vali Loss: 0.948 Vali Acc: 0.697 Test Loss: 0.948 Test Acc: 0.697
Validation loss decreased (-0.657884 --> -0.697359).  Saving model ...
Epoch: 7 cost time: 1.1391642093658447
Epoch: 7, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.875 Vali Acc: 0.717 Test Loss: 0.875 Test Acc: 0.717
Validation loss decreased (-0.697359 --> -0.717097).  Saving model ...
Epoch: 8 cost time: 1.065347671508789
Epoch: 8, Steps: 10 | Train Loss: 0.709 Vali Loss: 0.814 Vali Acc: 0.730 Test Loss: 0.814 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730255).  Saving model ...
Epoch: 9 cost time: 1.2457151412963867
Epoch: 9, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.765 Vali Acc: 0.750 Test Loss: 0.765 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 1.3053240776062012
Epoch: 10, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 1.2143521308898926
Epoch: 11, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.683 Vali Acc: 0.770 Test Loss: 0.683 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 1.211777925491333
Epoch: 12, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.649 Vali Acc: 0.763 Test Loss: 0.649 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3317675590515137
Epoch: 13, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.1000351905822754
Epoch: 14, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.221620798110962
Epoch: 15, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 1.3899109363555908
Epoch: 16, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2765507698059082
Epoch: 17, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.552 Vali Acc: 0.757 Test Loss: 0.552 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0943424701690674
Epoch: 18, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.1432850360870361
Epoch: 19, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 1.1760072708129883
Epoch: 20, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.529 Vali Acc: 0.770 Test Loss: 0.529 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4494786262512207
Epoch: 21, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.522 Vali Acc: 0.776 Test Loss: 0.522 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0878527164459229
Epoch: 22, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 23 cost time: 1.3426461219787598
Epoch: 23, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.512 Vali Acc: 0.770 Test Loss: 0.512 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2601089477539062
Epoch: 24, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3893229961395264
Epoch: 25, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 26 cost time: 0.9657199382781982
Epoch: 26, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3266212940216064
Epoch: 27, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.498 Vali Acc: 0.776 Test Loss: 0.498 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3233413696289062
Epoch: 28, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 29 cost time: 0.9960794448852539
Epoch: 29, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 30 cost time: 1.1425228118896484
Epoch: 30, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0783629417419434
Epoch: 31, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0202991962432861
Epoch: 32, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1116790771484375
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0123441219329834
Epoch: 34, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 35 cost time: 1.1888110637664795
Epoch: 35, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2128589153289795
Epoch: 36, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4897949695587158
Epoch: 37, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 38 cost time: 1.2504918575286865
Epoch: 38, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2582743167877197
Epoch: 39, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3038420677185059
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3331108093261719
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3259146213531494
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2654714584350586
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3743619918823242
Epoch: 44, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2001452445983887
Epoch: 45, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3057947158813477
Epoch: 46, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.040541648864746
Epoch: 47, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 149676
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3054280281066895
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.299 Vali Acc: 0.467 Test Loss: 1.299 Test Acc: 0.467
Validation loss decreased (inf --> -0.467092).  Saving model ...
Epoch: 2 cost time: 1.248523235321045
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
Validation loss decreased (-0.467092 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.0848519802093506
Epoch: 3, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.184 Vali Acc: 0.566 Test Loss: 1.184 Test Acc: 0.566
Validation loss decreased (-0.499988 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.180605411529541
Epoch: 4, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.110 Vali Acc: 0.586 Test Loss: 1.110 Test Acc: 0.586
Validation loss decreased (-0.565778 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 1.1584134101867676
Epoch: 5, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.034 Vali Acc: 0.645 Test Loss: 1.034 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644727).  Saving model ...
Epoch: 6 cost time: 1.1843650341033936
Epoch: 6, Steps: 10 | Train Loss: 0.973 Vali Loss: 0.959 Vali Acc: 0.711 Test Loss: 0.959 Test Acc: 0.711
Validation loss decreased (-0.644727 --> -0.710517).  Saving model ...
Epoch: 7 cost time: 1.055424451828003
Epoch: 7, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.888 Vali Acc: 0.737 Test Loss: 0.888 Test Acc: 0.737
Validation loss decreased (-0.710517 --> -0.736833).  Saving model ...
Epoch: 8 cost time: 1.1861615180969238
Epoch: 8, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.826 Vali Acc: 0.737 Test Loss: 0.826 Test Acc: 0.737
Validation loss decreased (-0.736833 --> -0.736834).  Saving model ...
Epoch: 9 cost time: 1.257049322128296
Epoch: 9, Steps: 10 | Train Loss: 0.648 Vali Loss: 0.778 Vali Acc: 0.763 Test Loss: 0.778 Test Acc: 0.763
Validation loss decreased (-0.736834 --> -0.763150).  Saving model ...
Epoch: 10 cost time: 1.077606439590454
Epoch: 10, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.735 Vali Acc: 0.757 Test Loss: 0.735 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0829834938049316
Epoch: 11, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.693 Vali Acc: 0.776 Test Loss: 0.693 Test Acc: 0.776
Validation loss decreased (-0.763150 --> -0.776309).  Saving model ...
Epoch: 12 cost time: 1.2098681926727295
Epoch: 12, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.656 Vali Acc: 0.763 Test Loss: 0.656 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1995573043823242
Epoch: 13, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.625 Vali Acc: 0.770 Test Loss: 0.625 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1770269870758057
Epoch: 14, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.2373926639556885
Epoch: 15, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.583 Vali Acc: 0.776 Test Loss: 0.583 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.3041181564331055
Epoch: 16, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.084667682647705
Epoch: 17, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.439774990081787
Epoch: 18, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.1090223789215088
Epoch: 19, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.3185198307037354
Epoch: 20, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 1.2817964553833008
Epoch: 21, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 22 cost time: 1.2763752937316895
Epoch: 22, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 23 cost time: 1.2832741737365723
Epoch: 23, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 24 cost time: 1.3226776123046875
Epoch: 24, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.491 Vali Acc: 0.776 Test Loss: 0.491 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3395543098449707
Epoch: 25, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 26 cost time: 1.0316100120544434
Epoch: 26, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2756011486053467
Epoch: 27, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.477 Vali Acc: 0.796 Test Loss: 0.477 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2519919872283936
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.474 Vali Acc: 0.809 Test Loss: 0.474 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 29 cost time: 1.0630455017089844
Epoch: 29, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.474 Vali Acc: 0.822 Test Loss: 0.474 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 30 cost time: 1.264404535293579
Epoch: 30, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 31 cost time: 1.2947430610656738
Epoch: 31, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3626511096954346
Epoch: 32, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.475 Vali Acc: 0.796 Test Loss: 0.475 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1050817966461182
Epoch: 33, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3027145862579346
Epoch: 34, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0479059219360352
Epoch: 35, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.474 Vali Acc: 0.809 Test Loss: 0.474 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1466753482818604
Epoch: 36, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.473 Vali Acc: 0.822 Test Loss: 0.473 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9616689682006836
Epoch: 37, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 38 cost time: 1.1295902729034424
Epoch: 38, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.227975845336914
Epoch: 39, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.474 Vali Acc: 0.822 Test Loss: 0.474 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2789671421051025
Epoch: 40, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1743853092193604
Epoch: 41, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0389111042022705
Epoch: 42, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1419081687927246
Epoch: 43, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1880874633789062
Epoch: 44, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.059854507446289
Epoch: 45, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.015620470046997
Epoch: 46, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.149273157119751
Epoch: 47, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 149676
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2985408306121826
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.313 Vali Acc: 0.428 Test Loss: 1.313 Test Acc: 0.428
Validation loss decreased (inf --> -0.427618).  Saving model ...
Epoch: 2 cost time: 1.0635175704956055
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.267 Vali Acc: 0.474 Test Loss: 1.267 Test Acc: 0.474
Validation loss decreased (-0.427618 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.007908582687378
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.213 Vali Acc: 0.533 Test Loss: 1.213 Test Acc: 0.533
Validation loss decreased (-0.473672 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 0.9382534027099609
Epoch: 4, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.147 Vali Acc: 0.605 Test Loss: 1.147 Test Acc: 0.605
Validation loss decreased (-0.532883 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 1.0945169925689697
Epoch: 5, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.078 Vali Acc: 0.612 Test Loss: 1.078 Test Acc: 0.612
Validation loss decreased (-0.605252 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 0.9591870307922363
Epoch: 6, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.009 Vali Acc: 0.658 Test Loss: 1.009 Test Acc: 0.658
Validation loss decreased (-0.611831 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 0.9698574542999268
Epoch: 7, Steps: 10 | Train Loss: 0.871 Vali Loss: 0.943 Vali Acc: 0.697 Test Loss: 0.943 Test Acc: 0.697
Validation loss decreased (-0.657885 --> -0.697359).  Saving model ...
Epoch: 8 cost time: 0.9568347930908203
Epoch: 8, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.882 Vali Acc: 0.717 Test Loss: 0.882 Test Acc: 0.717
Validation loss decreased (-0.697359 --> -0.717096).  Saving model ...
Epoch: 9 cost time: 0.999812126159668
Epoch: 9, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.830 Vali Acc: 0.724 Test Loss: 0.830 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723676).  Saving model ...
Epoch: 10 cost time: 1.0458195209503174
Epoch: 10, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.784 Vali Acc: 0.730 Test Loss: 0.784 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730255).  Saving model ...
Epoch: 11 cost time: 1.0254485607147217
Epoch: 11, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.739 Vali Acc: 0.750 Test Loss: 0.739 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.1851506233215332
Epoch: 12, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.699 Vali Acc: 0.763 Test Loss: 0.699 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 13 cost time: 1.2331809997558594
Epoch: 13, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 1.2312045097351074
Epoch: 14, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.636 Vali Acc: 0.770 Test Loss: 0.636 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 15 cost time: 0.9614806175231934
Epoch: 15, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.614 Vali Acc: 0.776 Test Loss: 0.614 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.1286230087280273
Epoch: 16, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2013249397277832
Epoch: 17, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.1511943340301514
Epoch: 18, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.0292327404022217
Epoch: 19, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9275839328765869
Epoch: 20, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.537 Vali Acc: 0.776 Test Loss: 0.537 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8416085243225098
Epoch: 21, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 1.0848424434661865
Epoch: 22, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.520 Vali Acc: 0.763 Test Loss: 0.520 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1223225593566895
Epoch: 23, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 24 cost time: 0.9597816467285156
Epoch: 24, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 25 cost time: 0.9193072319030762
Epoch: 25, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 26 cost time: 1.0036015510559082
Epoch: 26, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.497 Vali Acc: 0.776 Test Loss: 0.497 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2139041423797607
Epoch: 27, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.491 Vali Acc: 0.783 Test Loss: 0.491 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 28 cost time: 1.0128257274627686
Epoch: 28, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 29 cost time: 0.9529821872711182
Epoch: 29, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 30 cost time: 1.0455706119537354
Epoch: 30, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 31 cost time: 0.8361895084381104
Epoch: 31, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 32 cost time: 1.0885143280029297
Epoch: 32, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1076269149780273
Epoch: 33, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 34 cost time: 0.9761486053466797
Epoch: 34, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 35 cost time: 1.0389418601989746
Epoch: 35, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9085676670074463
Epoch: 36, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2002036571502686
Epoch: 37, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.485 Vali Acc: 0.796 Test Loss: 0.485 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1506097316741943
Epoch: 38, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.488 Vali Acc: 0.789 Test Loss: 0.488 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1390297412872314
Epoch: 39, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.093907117843628
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.495 Vali Acc: 0.783 Test Loss: 0.495 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2496869564056396
Epoch: 41, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1181719303131104
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2171785831451416
Epoch: 43, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.191727876663208
Epoch: 44, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 149676
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4915084838867188
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.328 Vali Acc: 0.368 Test Loss: 1.328 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 0.9660089015960693
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.293 Vali Acc: 0.441 Test Loss: 1.293 Test Acc: 0.441
Validation loss decreased (-0.368408 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 1.1412115097045898
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.251 Vali Acc: 0.480 Test Loss: 1.251 Test Acc: 0.480
Validation loss decreased (-0.440777 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 0.9772861003875732
Epoch: 4, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.198 Vali Acc: 0.546 Test Loss: 1.198 Test Acc: 0.546
Validation loss decreased (-0.480251 --> -0.546041).  Saving model ...
Epoch: 5 cost time: 1.0805811882019043
Epoch: 5, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.138 Vali Acc: 0.592 Test Loss: 1.138 Test Acc: 0.592
Validation loss decreased (-0.546041 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.0126843452453613
Epoch: 6, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.075 Vali Acc: 0.651 Test Loss: 1.075 Test Acc: 0.651
Validation loss decreased (-0.592094 --> -0.651305).  Saving model ...
Epoch: 7 cost time: 1.037487506866455
Epoch: 7, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.016 Vali Acc: 0.697 Test Loss: 1.016 Test Acc: 0.697
Validation loss decreased (-0.651305 --> -0.697358).  Saving model ...
Epoch: 8 cost time: 1.0761170387268066
Epoch: 8, Steps: 10 | Train Loss: 0.890 Vali Loss: 0.958 Vali Acc: 0.717 Test Loss: 0.958 Test Acc: 0.717
Validation loss decreased (-0.697358 --> -0.717096).  Saving model ...
Epoch: 9 cost time: 0.9418628215789795
Epoch: 9, Steps: 10 | Train Loss: 0.783 Vali Loss: 0.911 Vali Acc: 0.704 Test Loss: 0.911 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0881633758544922
Epoch: 10, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.864 Vali Acc: 0.704 Test Loss: 0.864 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.093048334121704
Epoch: 11, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.818 Vali Acc: 0.730 Test Loss: 0.818 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730255).  Saving model ...
Epoch: 12 cost time: 1.011385202407837
Epoch: 12, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.776 Vali Acc: 0.730 Test Loss: 0.776 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730255).  Saving model ...
Epoch: 13 cost time: 0.993927001953125
Epoch: 13, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.736 Vali Acc: 0.743 Test Loss: 0.736 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 14 cost time: 1.064971685409546
Epoch: 14, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.705 Vali Acc: 0.730 Test Loss: 0.705 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9388012886047363
Epoch: 15, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.675 Vali Acc: 0.730 Test Loss: 0.675 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0562324523925781
Epoch: 16, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0986607074737549
Epoch: 17, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.0212528705596924
Epoch: 18, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.603 Vali Acc: 0.770 Test Loss: 0.603 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 19 cost time: 1.0962347984313965
Epoch: 19, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.944800853729248
Epoch: 20, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0968244075775146
Epoch: 21, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9412410259246826
Epoch: 22, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.137732982635498
Epoch: 23, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1560473442077637
Epoch: 24, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.542 Vali Acc: 0.757 Test Loss: 0.542 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.986652135848999
Epoch: 25, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.540 Vali Acc: 0.757 Test Loss: 0.540 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.169675350189209
Epoch: 26, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.534 Vali Acc: 0.770 Test Loss: 0.534 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 27 cost time: 1.1201508045196533
Epoch: 27, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.529 Vali Acc: 0.763 Test Loss: 0.529 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9056313037872314
Epoch: 28, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.527 Vali Acc: 0.763 Test Loss: 0.527 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1520447731018066
Epoch: 29, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.525 Vali Acc: 0.763 Test Loss: 0.525 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.105865716934204
Epoch: 30, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.525 Vali Acc: 0.757 Test Loss: 0.525 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8935248851776123
Epoch: 31, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.522 Vali Acc: 0.757 Test Loss: 0.522 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1573798656463623
Epoch: 32, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.519 Vali Acc: 0.763 Test Loss: 0.519 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1584913730621338
Epoch: 33, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.520 Vali Acc: 0.757 Test Loss: 0.520 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9491333961486816
Epoch: 34, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.518 Vali Acc: 0.763 Test Loss: 0.518 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.076648473739624
Epoch: 35, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.519 Vali Acc: 0.763 Test Loss: 0.519 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0792312622070312
Epoch: 36, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.522 Vali Acc: 0.757 Test Loss: 0.522 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 149676
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2377116680145264
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.483 Vali Acc: 0.250 Test Loss: 1.483 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.0692968368530273
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.421 Vali Acc: 0.309 Test Loss: 1.421 Test Acc: 0.309
Validation loss decreased (-0.249985 --> -0.309196).  Saving model ...
Epoch: 3 cost time: 0.8640110492706299
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.340 Vali Acc: 0.382 Test Loss: 1.340 Test Acc: 0.382
Validation loss decreased (-0.309196 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 1.1406934261322021
Epoch: 4, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.381566 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.062375783920288
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.171 Vali Acc: 0.559 Test Loss: 1.171 Test Acc: 0.559
Validation loss decreased (-0.499987 --> -0.559199).  Saving model ...
Epoch: 6 cost time: 1.1263906955718994
Epoch: 6, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.086 Vali Acc: 0.592 Test Loss: 1.086 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 7 cost time: 1.113490343093872
Epoch: 7, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.009 Vali Acc: 0.612 Test Loss: 1.009 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611832).  Saving model ...
Epoch: 8 cost time: 1.1700778007507324
Epoch: 8, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.938 Vali Acc: 0.632 Test Loss: 0.938 Test Acc: 0.632
Validation loss decreased (-0.611832 --> -0.631570).  Saving model ...
Epoch: 9 cost time: 1.066535234451294
Epoch: 9, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.874 Vali Acc: 0.658 Test Loss: 0.874 Test Acc: 0.658
Validation loss decreased (-0.631570 --> -0.657886).  Saving model ...
Epoch: 10 cost time: 0.9105539321899414
Epoch: 10, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.817 Vali Acc: 0.671 Test Loss: 0.817 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 0.8980052471160889
Epoch: 11, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.767 Vali Acc: 0.697 Test Loss: 0.767 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697361).  Saving model ...
Epoch: 12 cost time: 0.917689323425293
Epoch: 12, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.727 Vali Acc: 0.697 Test Loss: 0.727 Test Acc: 0.697
Validation loss decreased (-0.697361 --> -0.697361).  Saving model ...
Epoch: 13 cost time: 0.863358736038208
Epoch: 13, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.694 Vali Acc: 0.711 Test Loss: 0.694 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 14 cost time: 0.9684000015258789
Epoch: 14, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.1103124618530273
Epoch: 15, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.645 Vali Acc: 0.757 Test Loss: 0.645 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 16 cost time: 0.9609203338623047
Epoch: 16, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.2882421016693115
Epoch: 17, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.610 Vali Acc: 0.776 Test Loss: 0.610 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.1702651977539062
Epoch: 18, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.597 Vali Acc: 0.770 Test Loss: 0.597 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9825377464294434
Epoch: 19, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3611869812011719
Epoch: 20, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.570 Vali Acc: 0.763 Test Loss: 0.570 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3031055927276611
Epoch: 21, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.559 Vali Acc: 0.770 Test Loss: 0.559 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1211202144622803
Epoch: 22, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.247955083847046
Epoch: 23, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.1091129779815674
Epoch: 24, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4553096294403076
Epoch: 25, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 1.1520297527313232
Epoch: 26, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.0833611488342285
Epoch: 27, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.1653892993927002
Epoch: 28, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1138322353363037
Epoch: 29, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3027944564819336
Epoch: 30, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2496287822723389
Epoch: 31, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 32 cost time: 1.2289633750915527
Epoch: 32, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 33 cost time: 1.2748043537139893
Epoch: 33, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 34 cost time: 1.237328052520752
Epoch: 34, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2760298252105713
Epoch: 35, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.21586275100708
Epoch: 36, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 37 cost time: 1.1732687950134277
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 38 cost time: 1.2948765754699707
Epoch: 38, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.144817590713501
Epoch: 39, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0347166061401367
Epoch: 40, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2671968936920166
Epoch: 41, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3760685920715332
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0209763050079346
Epoch: 43, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1176035404205322
Epoch: 44, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.081770658493042
Epoch: 45, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0454425811767578
Epoch: 46, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.3078980445861816
Epoch: 47, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 84140
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.745857000350952
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.483 Vali Acc: 0.237 Test Loss: 1.483 Test Acc: 0.237
Validation loss decreased (inf --> -0.236827).  Saving model ...
Epoch: 2 cost time: 1.1978960037231445
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.424 Vali Acc: 0.270 Test Loss: 1.424 Test Acc: 0.270
Validation loss decreased (-0.236827 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.0598418712615967
Epoch: 3, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.346 Vali Acc: 0.382 Test Loss: 1.346 Test Acc: 0.382
Validation loss decreased (-0.269723 --> -0.381565).  Saving model ...
Epoch: 4 cost time: 1.2012078762054443
Epoch: 4, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.267 Vali Acc: 0.480 Test Loss: 1.267 Test Acc: 0.480
Validation loss decreased (-0.381565 --> -0.480250).  Saving model ...
Epoch: 5 cost time: 1.1587069034576416
Epoch: 5, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.183 Vali Acc: 0.520 Test Loss: 1.183 Test Acc: 0.520
Validation loss decreased (-0.480250 --> -0.519725).  Saving model ...
Epoch: 6 cost time: 1.1192491054534912
Epoch: 6, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.100 Vali Acc: 0.586 Test Loss: 1.100 Test Acc: 0.586
Validation loss decreased (-0.519725 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 1.2058417797088623
Epoch: 7, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.022 Vali Acc: 0.612 Test Loss: 1.022 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611832).  Saving model ...
Epoch: 8 cost time: 1.0928287506103516
Epoch: 8, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.952 Vali Acc: 0.618 Test Loss: 0.952 Test Acc: 0.618
Validation loss decreased (-0.611832 --> -0.618412).  Saving model ...
Epoch: 9 cost time: 1.1077446937561035
Epoch: 9, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.886 Vali Acc: 0.645 Test Loss: 0.886 Test Acc: 0.645
Validation loss decreased (-0.618412 --> -0.644728).  Saving model ...
Epoch: 10 cost time: 1.0682611465454102
Epoch: 10, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.826 Vali Acc: 0.658 Test Loss: 0.826 Test Acc: 0.658
Validation loss decreased (-0.644728 --> -0.657886).  Saving model ...
Epoch: 11 cost time: 1.01552414894104
Epoch: 11, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.775 Vali Acc: 0.684 Test Loss: 0.775 Test Acc: 0.684
Validation loss decreased (-0.657886 --> -0.684203).  Saving model ...
Epoch: 12 cost time: 1.1804084777832031
Epoch: 12, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.731 Vali Acc: 0.704 Test Loss: 0.731 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 13 cost time: 1.1180713176727295
Epoch: 13, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.693 Vali Acc: 0.711 Test Loss: 0.693 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 14 cost time: 1.1538703441619873
Epoch: 14, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.664 Vali Acc: 0.743 Test Loss: 0.664 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743414).  Saving model ...
Epoch: 15 cost time: 1.0317652225494385
Epoch: 15, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.641 Vali Acc: 0.757 Test Loss: 0.641 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 1.2273552417755127
Epoch: 16, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.1930782794952393
Epoch: 17, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.178027629852295
Epoch: 18, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.0692317485809326
Epoch: 19, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.877575159072876
Epoch: 20, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1336474418640137
Epoch: 21, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 22 cost time: 1.1622974872589111
Epoch: 22, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 1.2272677421569824
Epoch: 23, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.284592628479004
Epoch: 24, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.210052251815796
Epoch: 25, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 26 cost time: 1.2034261226654053
Epoch: 26, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.1880733966827393
Epoch: 27, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 1.0890233516693115
Epoch: 28, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0593163967132568
Epoch: 29, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1077837944030762
Epoch: 30, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 1.188023567199707
Epoch: 31, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.174414873123169
Epoch: 32, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2690520286560059
Epoch: 33, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 34 cost time: 1.2455670833587646
Epoch: 34, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 35 cost time: 1.1894676685333252
Epoch: 35, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2424421310424805
Epoch: 36, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.080373764038086
Epoch: 37, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2539911270141602
Epoch: 38, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.195183277130127
Epoch: 39, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1337029933929443
Epoch: 40, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0432541370391846
Epoch: 41, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2056503295898438
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1894645690917969
Epoch: 43, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.1928176879882812
Epoch: 44, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 84140
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.193113327026367
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.431 Vali Acc: 0.283 Test Loss: 1.431 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.04715895652771
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.381 Vali Acc: 0.322 Test Loss: 1.381 Test Acc: 0.322
Validation loss decreased (-0.282880 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 0.9195358753204346
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.314 Vali Acc: 0.368 Test Loss: 1.314 Test Acc: 0.368
Validation loss decreased (-0.322355 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.013251781463623
Epoch: 4, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.246 Vali Acc: 0.480 Test Loss: 1.246 Test Acc: 0.480
Validation loss decreased (-0.368408 --> -0.480251).  Saving model ...
Epoch: 5 cost time: 1.0540225505828857
Epoch: 5, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.176 Vali Acc: 0.553 Test Loss: 1.176 Test Acc: 0.553
Validation loss decreased (-0.480251 --> -0.552620).  Saving model ...
Epoch: 6 cost time: 0.8974413871765137
Epoch: 6, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.104 Vali Acc: 0.586 Test Loss: 1.104 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 0.9529578685760498
Epoch: 7, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.034 Vali Acc: 0.586 Test Loss: 1.034 Test Acc: 0.586
Validation loss decreased (-0.585515 --> -0.585516).  Saving model ...
Epoch: 8 cost time: 1.0352299213409424
Epoch: 8, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.970 Vali Acc: 0.651 Test Loss: 0.970 Test Acc: 0.651
Validation loss decreased (-0.585516 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 0.8603217601776123
Epoch: 9, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.908 Vali Acc: 0.638 Test Loss: 0.908 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1125226020812988
Epoch: 10, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.850 Vali Acc: 0.678 Test Loss: 0.850 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677623).  Saving model ...
Epoch: 11 cost time: 1.0694355964660645
Epoch: 11, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.799 Vali Acc: 0.691 Test Loss: 0.799 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690781).  Saving model ...
Epoch: 12 cost time: 0.9573037624359131
Epoch: 12, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.758 Vali Acc: 0.711 Test Loss: 0.758 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 13 cost time: 1.0616521835327148
Epoch: 13, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.720 Vali Acc: 0.717 Test Loss: 0.720 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 14 cost time: 1.0177106857299805
Epoch: 14, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.687 Vali Acc: 0.730 Test Loss: 0.687 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 1.054950475692749
Epoch: 15, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.662 Vali Acc: 0.743 Test Loss: 0.662 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 16 cost time: 1.0190560817718506
Epoch: 16, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 1.012042760848999
Epoch: 17, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.0141410827636719
Epoch: 18, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.110515832901001
Epoch: 19, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 1.0271363258361816
Epoch: 20, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1477670669555664
Epoch: 21, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.564 Vali Acc: 0.743 Test Loss: 0.564 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0565669536590576
Epoch: 22, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0144627094268799
Epoch: 23, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 24 cost time: 1.0532457828521729
Epoch: 24, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0191006660461426
Epoch: 25, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 1.2118396759033203
Epoch: 26, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1126251220703125
Epoch: 27, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8861942291259766
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9861505031585693
Epoch: 29, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.529 Vali Acc: 0.770 Test Loss: 0.529 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0855937004089355
Epoch: 30, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.527 Vali Acc: 0.770 Test Loss: 0.527 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0803112983703613
Epoch: 31, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.531 Vali Acc: 0.770 Test Loss: 0.531 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.090329885482788
Epoch: 32, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.524 Vali Acc: 0.770 Test Loss: 0.524 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.12923264503479
Epoch: 33, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0518584251403809
Epoch: 34, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.524 Vali Acc: 0.770 Test Loss: 0.524 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0313787460327148
Epoch: 35, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 84140
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3892858028411865
Epoch: 1, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.393 Vali Acc: 0.283 Test Loss: 1.393 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.0220005512237549
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.355 Vali Acc: 0.309 Test Loss: 1.355 Test Acc: 0.309
Validation loss decreased (-0.282881 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.9304237365722656
Epoch: 3, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.305 Vali Acc: 0.421 Test Loss: 1.305 Test Acc: 0.421
Validation loss decreased (-0.309197 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.2162065505981445
Epoch: 4, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.253 Vali Acc: 0.513 Test Loss: 1.253 Test Acc: 0.513
Validation loss decreased (-0.421040 --> -0.513145).  Saving model ...
Epoch: 5 cost time: 1.1667709350585938
Epoch: 5, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.197 Vali Acc: 0.572 Test Loss: 1.197 Test Acc: 0.572
Validation loss decreased (-0.513145 --> -0.572356).  Saving model ...
Epoch: 6 cost time: 1.038832187652588
Epoch: 6, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.136 Vali Acc: 0.612 Test Loss: 1.136 Test Acc: 0.612
Validation loss decreased (-0.572356 --> -0.611831).  Saving model ...
Epoch: 7 cost time: 1.169907569885254
Epoch: 7, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.077 Vali Acc: 0.645 Test Loss: 1.077 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644726).  Saving model ...
Epoch: 8 cost time: 0.9794650077819824
Epoch: 8, Steps: 10 | Train Loss: 0.877 Vali Loss: 1.019 Vali Acc: 0.645 Test Loss: 1.019 Test Acc: 0.645
Validation loss decreased (-0.644726 --> -0.644727).  Saving model ...
Epoch: 9 cost time: 1.172393560409546
Epoch: 9, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.957 Vali Acc: 0.684 Test Loss: 0.957 Test Acc: 0.684
Validation loss decreased (-0.644727 --> -0.684201).  Saving model ...
Epoch: 10 cost time: 1.1610934734344482
Epoch: 10, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.898 Vali Acc: 0.697 Test Loss: 0.898 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 1.0954279899597168
Epoch: 11, Steps: 10 | Train Loss: 0.629 Vali Loss: 0.848 Vali Acc: 0.704 Test Loss: 0.848 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703939).  Saving model ...
Epoch: 12 cost time: 1.115168571472168
Epoch: 12, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.807 Vali Acc: 0.717 Test Loss: 0.807 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 13 cost time: 1.1840968132019043
Epoch: 13, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.766 Vali Acc: 0.711 Test Loss: 0.766 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.247298002243042
Epoch: 14, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.727 Vali Acc: 0.730 Test Loss: 0.727 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 1.2142510414123535
Epoch: 15, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.696 Vali Acc: 0.730 Test Loss: 0.696 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 16 cost time: 1.247237205505371
Epoch: 16, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.669 Vali Acc: 0.730 Test Loss: 0.669 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 17 cost time: 1.0595877170562744
Epoch: 17, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 18 cost time: 1.0924410820007324
Epoch: 18, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 19 cost time: 1.1342270374298096
Epoch: 19, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 20 cost time: 1.0910532474517822
Epoch: 20, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.598 Vali Acc: 0.743 Test Loss: 0.598 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 21 cost time: 1.1197102069854736
Epoch: 21, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.583 Vali Acc: 0.730 Test Loss: 0.583 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1575469970703125
Epoch: 22, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.572 Vali Acc: 0.730 Test Loss: 0.572 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1737442016601562
Epoch: 23, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.564 Vali Acc: 0.724 Test Loss: 0.564 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1575195789337158
Epoch: 24, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9840569496154785
Epoch: 25, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1953849792480469
Epoch: 26, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.548 Vali Acc: 0.730 Test Loss: 0.548 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0406060218811035
Epoch: 27, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.542 Vali Acc: 0.730 Test Loss: 0.542 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.009700059890747
Epoch: 28, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9620075225830078
Epoch: 29, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.539 Vali Acc: 0.743 Test Loss: 0.539 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743416).  Saving model ...
Epoch: 30 cost time: 1.0780246257781982
Epoch: 30, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0511744022369385
Epoch: 31, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1081008911132812
Epoch: 32, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.535 Vali Acc: 0.730 Test Loss: 0.535 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0532715320587158
Epoch: 33, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.534 Vali Acc: 0.737 Test Loss: 0.534 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0368053913116455
Epoch: 34, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.027796745300293
Epoch: 35, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.539 Vali Acc: 0.743 Test Loss: 0.539 Test Acc: 0.743
Validation loss decreased (-0.743416 --> -0.743416).  Saving model ...
Epoch: 36 cost time: 1.0602171421051025
Epoch: 36, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.544 Vali Acc: 0.743 Test Loss: 0.544 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9040446281433105
Epoch: 37, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.098008394241333
Epoch: 38, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.066643476486206
Epoch: 39, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.552 Vali Acc: 0.743 Test Loss: 0.552 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0884263515472412
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.556 Vali Acc: 0.750 Test Loss: 0.556 Test Acc: 0.750
Validation loss decreased (-0.743416 --> -0.749994).  Saving model ...
Epoch: 41 cost time: 1.0857477188110352
Epoch: 41, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8411648273468018
Epoch: 42, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.568 Vali Acc: 0.743 Test Loss: 0.568 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1634321212768555
Epoch: 43, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.743 Test Loss: 0.574 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1617581844329834
Epoch: 44, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.204371690750122
Epoch: 45, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1338627338409424
Epoch: 46, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1564884185791016
Epoch: 47, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.580 Vali Acc: 0.737 Test Loss: 0.580 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0936391353607178
Epoch: 48, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9794800281524658
Epoch: 49, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.129821538925171
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.596 Vali Acc: 0.737 Test Loss: 0.596 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.75
model parameter : 84140
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.434396505355835
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.484 Vali Acc: 0.191 Test Loss: 1.484 Test Acc: 0.191
Validation loss decreased (inf --> -0.190775).  Saving model ...
Epoch: 2 cost time: 1.2466464042663574
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.423 Vali Acc: 0.250 Test Loss: 1.423 Test Acc: 0.250
Validation loss decreased (-0.190775 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.3616228103637695
Epoch: 3, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.336 Vali Acc: 0.368 Test Loss: 1.336 Test Acc: 0.368
Validation loss decreased (-0.249986 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.2338595390319824
Epoch: 4, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.241 Vali Acc: 0.447 Test Loss: 1.241 Test Acc: 0.447
Validation loss decreased (-0.368408 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 1.1053392887115479
Epoch: 5, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.149 Vali Acc: 0.539 Test Loss: 1.149 Test Acc: 0.539
Validation loss decreased (-0.447356 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 1.2473382949829102
Epoch: 6, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.065 Vali Acc: 0.566 Test Loss: 1.065 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565779).  Saving model ...
Epoch: 7 cost time: 1.0491573810577393
Epoch: 7, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.983 Vali Acc: 0.599 Test Loss: 0.983 Test Acc: 0.599
Validation loss decreased (-0.565779 --> -0.598674).  Saving model ...
Epoch: 8 cost time: 1.2718424797058105
Epoch: 8, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.910 Vali Acc: 0.651 Test Loss: 0.910 Test Acc: 0.651
Validation loss decreased (-0.598674 --> -0.651307).  Saving model ...
Epoch: 9 cost time: 1.2190024852752686
Epoch: 9, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.849 Vali Acc: 0.658 Test Loss: 0.849 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657886).  Saving model ...
Epoch: 10 cost time: 1.1299958229064941
Epoch: 10, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.789 Vali Acc: 0.678 Test Loss: 0.789 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677624).  Saving model ...
Epoch: 11 cost time: 1.0254526138305664
Epoch: 11, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.746 Vali Acc: 0.711 Test Loss: 0.746 Test Acc: 0.711
Validation loss decreased (-0.677624 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 1.169079303741455
Epoch: 12, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.713 Vali Acc: 0.724 Test Loss: 0.713 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 13 cost time: 1.0971319675445557
Epoch: 13, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.681 Vali Acc: 0.730 Test Loss: 0.681 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 14 cost time: 1.196469783782959
Epoch: 14, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 1.3214538097381592
Epoch: 15, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.633 Vali Acc: 0.743 Test Loss: 0.633 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1192271709442139
Epoch: 16, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.610 Vali Acc: 0.750 Test Loss: 0.610 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 1.2151024341583252
Epoch: 17, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 1.0944335460662842
Epoch: 18, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 1.1380927562713623
Epoch: 19, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 1.0159275531768799
Epoch: 20, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 21 cost time: 1.0712931156158447
Epoch: 21, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.551 Vali Acc: 0.763 Test Loss: 0.551 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.144921064376831
Epoch: 22, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 23 cost time: 1.1901111602783203
Epoch: 23, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.532 Vali Acc: 0.770 Test Loss: 0.532 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 24 cost time: 0.9666061401367188
Epoch: 24, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 25 cost time: 1.0676934719085693
Epoch: 25, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 26 cost time: 1.260758638381958
Epoch: 26, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 27 cost time: 1.3132851123809814
Epoch: 27, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 28 cost time: 1.2348380088806152
Epoch: 28, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 29 cost time: 1.3525559902191162
Epoch: 29, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 30 cost time: 1.0572669506072998
Epoch: 30, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 31 cost time: 1.2157609462738037
Epoch: 31, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 32 cost time: 1.2370789051055908
Epoch: 32, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 33 cost time: 1.1952528953552246
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 34 cost time: 1.2815327644348145
Epoch: 34, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 35 cost time: 1.5129625797271729
Epoch: 35, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4021682739257812
Epoch: 36, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 37 cost time: 1.3467676639556885
Epoch: 37, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0897846221923828
Epoch: 38, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1822190284729004
Epoch: 39, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.216383457183838
Epoch: 40, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2682609558105469
Epoch: 41, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1048262119293213
Epoch: 42, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3294289112091064
Epoch: 43, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2391211986541748
Epoch: 44, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.1337816715240479
Epoch: 45, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2803013324737549
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 51372
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.724423885345459
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.481 Vali Acc: 0.204 Test Loss: 1.481 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 1.1867408752441406
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
Validation loss decreased (-0.203933 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 1.1858863830566406
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.342 Vali Acc: 0.329 Test Loss: 1.342 Test Acc: 0.329
Validation loss decreased (-0.243407 --> -0.328934).  Saving model ...
Epoch: 4 cost time: 1.0123655796051025
Epoch: 4, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.252 Vali Acc: 0.421 Test Loss: 1.252 Test Acc: 0.421
Validation loss decreased (-0.328934 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 1.170785665512085
Epoch: 5, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.167 Vali Acc: 0.493 Test Loss: 1.167 Test Acc: 0.493
Validation loss decreased (-0.421040 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 1.0739729404449463
Epoch: 6, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.084 Vali Acc: 0.559 Test Loss: 1.084 Test Acc: 0.559
Validation loss decreased (-0.493409 --> -0.559200).  Saving model ...
Epoch: 7 cost time: 1.089794635772705
Epoch: 7, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.001 Vali Acc: 0.599 Test Loss: 1.001 Test Acc: 0.599
Validation loss decreased (-0.559200 --> -0.598674).  Saving model ...
Epoch: 8 cost time: 0.8237330913543701
Epoch: 8, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.928 Vali Acc: 0.664 Test Loss: 0.928 Test Acc: 0.664
Validation loss decreased (-0.598674 --> -0.664464).  Saving model ...
Epoch: 9 cost time: 0.9779272079467773
Epoch: 9, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.867 Vali Acc: 0.684 Test Loss: 0.867 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684202).  Saving model ...
Epoch: 10 cost time: 1.037470817565918
Epoch: 10, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.808 Vali Acc: 0.704 Test Loss: 0.808 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703939).  Saving model ...
Epoch: 11 cost time: 0.7726438045501709
Epoch: 11, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.762 Vali Acc: 0.697 Test Loss: 0.762 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9658248424530029
Epoch: 12, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.725 Vali Acc: 0.724 Test Loss: 0.725 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 13 cost time: 0.9718453884124756
Epoch: 13, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.693 Vali Acc: 0.737 Test Loss: 0.693 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 14 cost time: 0.8661015033721924
Epoch: 14, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.660 Vali Acc: 0.750 Test Loss: 0.660 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 0.8674039840698242
Epoch: 15, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.640 Vali Acc: 0.743 Test Loss: 0.640 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9583988189697266
Epoch: 16, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.0725183486938477
Epoch: 17, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.597 Vali Acc: 0.770 Test Loss: 0.597 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 18 cost time: 1.1126041412353516
Epoch: 18, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.583 Vali Acc: 0.757 Test Loss: 0.583 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2487947940826416
Epoch: 19, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 0.962618350982666
Epoch: 20, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.199814796447754
Epoch: 21, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0748958587646484
Epoch: 22, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.1549937725067139
Epoch: 23, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 24 cost time: 1.057657241821289
Epoch: 24, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1364467144012451
Epoch: 25, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 26 cost time: 1.1154963970184326
Epoch: 26, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0978443622589111
Epoch: 27, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.062960147857666
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1963889598846436
Epoch: 29, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.176976203918457
Epoch: 30, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 31 cost time: 1.283095121383667
Epoch: 31, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1426000595092773
Epoch: 32, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9808557033538818
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0532910823822021
Epoch: 34, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1291961669921875
Epoch: 35, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0994329452514648
Epoch: 36, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 37 cost time: 1.0226123332977295
Epoch: 37, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 38 cost time: 1.209442377090454
Epoch: 38, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0783195495605469
Epoch: 39, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9601483345031738
Epoch: 40, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2272751331329346
Epoch: 41, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1302099227905273
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.067939043045044
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0435068607330322
Epoch: 44, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1043460369110107
Epoch: 45, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1589159965515137
Epoch: 46, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0016648769378662
Epoch: 47, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 51372
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5773887634277344
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.474 Vali Acc: 0.204 Test Loss: 1.474 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 1.0939867496490479
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.425 Vali Acc: 0.276 Test Loss: 1.425 Test Acc: 0.276
Validation loss decreased (-0.203933 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 1.0230693817138672
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.355 Vali Acc: 0.342 Test Loss: 1.355 Test Acc: 0.342
Validation loss decreased (-0.276302 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 0.9642665386199951
Epoch: 4, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.274 Vali Acc: 0.388 Test Loss: 1.274 Test Acc: 0.388
Validation loss decreased (-0.342092 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 0.9964592456817627
Epoch: 5, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.197 Vali Acc: 0.507 Test Loss: 1.197 Test Acc: 0.507
Validation loss decreased (-0.388145 --> -0.506567).  Saving model ...
Epoch: 6 cost time: 0.9220366477966309
Epoch: 6, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.123 Vali Acc: 0.546 Test Loss: 1.123 Test Acc: 0.546
Validation loss decreased (-0.506567 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 1.1167140007019043
Epoch: 7, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.041 Vali Acc: 0.572 Test Loss: 1.041 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572358).  Saving model ...
Epoch: 8 cost time: 1.0913586616516113
Epoch: 8, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.968 Vali Acc: 0.638 Test Loss: 0.968 Test Acc: 0.638
Validation loss decreased (-0.572358 --> -0.638148).  Saving model ...
Epoch: 9 cost time: 1.0306243896484375
Epoch: 9, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.908 Vali Acc: 0.671 Test Loss: 0.908 Test Acc: 0.671
Validation loss decreased (-0.638148 --> -0.671044).  Saving model ...
Epoch: 10 cost time: 0.9788298606872559
Epoch: 10, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.848 Vali Acc: 0.691 Test Loss: 0.848 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690781).  Saving model ...
Epoch: 11 cost time: 1.1664037704467773
Epoch: 11, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.799 Vali Acc: 0.704 Test Loss: 0.799 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703939).  Saving model ...
Epoch: 12 cost time: 1.170475959777832
Epoch: 12, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.758 Vali Acc: 0.704 Test Loss: 0.758 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703940).  Saving model ...
Epoch: 13 cost time: 1.0392110347747803
Epoch: 13, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.720 Vali Acc: 0.724 Test Loss: 0.720 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 14 cost time: 1.1017112731933594
Epoch: 14, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.679 Vali Acc: 0.730 Test Loss: 0.679 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 1.0870342254638672
Epoch: 15, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.654 Vali Acc: 0.750 Test Loss: 0.654 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 0.9372706413269043
Epoch: 16, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 1.042473554611206
Epoch: 17, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 0.9582266807556152
Epoch: 18, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.590 Vali Acc: 0.750 Test Loss: 0.590 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 1.0407440662384033
Epoch: 19, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 1.0361096858978271
Epoch: 20, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 21 cost time: 1.0243620872497559
Epoch: 21, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 22 cost time: 1.0433580875396729
Epoch: 22, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1662182807922363
Epoch: 23, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1596331596374512
Epoch: 24, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0138437747955322
Epoch: 25, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 26 cost time: 1.0180771350860596
Epoch: 26, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.156022071838379
Epoch: 27, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1111798286437988
Epoch: 28, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1879997253417969
Epoch: 29, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.509 Vali Acc: 0.776 Test Loss: 0.509 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1565947532653809
Epoch: 30, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0492241382598877
Epoch: 31, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.048339605331421
Epoch: 32, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1062235832214355
Epoch: 33, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0689384937286377
Epoch: 34, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.179063320159912
Epoch: 35, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 51372
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.422668933868408
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.408 Vali Acc: 0.283 Test Loss: 1.408 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.9777405261993408
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.371 Vali Acc: 0.316 Test Loss: 1.371 Test Acc: 0.316
Validation loss decreased (-0.282881 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.0261332988739014
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.317 Vali Acc: 0.401 Test Loss: 1.317 Test Acc: 0.401
Validation loss decreased (-0.315776 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 0.9453368186950684
Epoch: 4, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
Validation loss decreased (-0.401303 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.9651997089385986
Epoch: 5, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.194 Vali Acc: 0.559 Test Loss: 1.194 Test Acc: 0.559
Validation loss decreased (-0.499987 --> -0.559199).  Saving model ...
Epoch: 6 cost time: 0.842195987701416
Epoch: 6, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.133 Vali Acc: 0.566 Test Loss: 1.133 Test Acc: 0.566
Validation loss decreased (-0.559199 --> -0.565778).  Saving model ...
Epoch: 7 cost time: 1.0003249645233154
Epoch: 7, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.068 Vali Acc: 0.612 Test Loss: 1.068 Test Acc: 0.612
Validation loss decreased (-0.565778 --> -0.611831).  Saving model ...
Epoch: 8 cost time: 1.1131370067596436
Epoch: 8, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.008 Vali Acc: 0.678 Test Loss: 1.008 Test Acc: 0.678
Validation loss decreased (-0.611831 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 1.0014808177947998
Epoch: 9, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.954 Vali Acc: 0.658 Test Loss: 0.954 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9893043041229248
Epoch: 10, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.898 Vali Acc: 0.678 Test Loss: 0.898 Test Acc: 0.678
Validation loss decreased (-0.677622 --> -0.677623).  Saving model ...
Epoch: 11 cost time: 1.0447890758514404
Epoch: 11, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.849 Vali Acc: 0.717 Test Loss: 0.849 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717097).  Saving model ...
Epoch: 12 cost time: 0.9067304134368896
Epoch: 12, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.807 Vali Acc: 0.697 Test Loss: 0.807 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.968963623046875
Epoch: 13, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.767 Vali Acc: 0.711 Test Loss: 0.767 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9968917369842529
Epoch: 14, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.726 Vali Acc: 0.737 Test Loss: 0.726 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.049670696258545
Epoch: 15, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.702 Vali Acc: 0.730 Test Loss: 0.702 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9947457313537598
Epoch: 16, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.674 Vali Acc: 0.743 Test Loss: 0.674 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 17 cost time: 1.0826420783996582
Epoch: 17, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.646 Vali Acc: 0.743 Test Loss: 0.646 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 18 cost time: 1.1158990859985352
Epoch: 18, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.626 Vali Acc: 0.730 Test Loss: 0.626 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1007146835327148
Epoch: 19, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.608 Vali Acc: 0.750 Test Loss: 0.608 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 20 cost time: 1.1300945281982422
Epoch: 20, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 21 cost time: 0.8156521320343018
Epoch: 21, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 22 cost time: 1.1185050010681152
Epoch: 22, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.567 Vali Acc: 0.770 Test Loss: 0.567 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 23 cost time: 0.925938606262207
Epoch: 23, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 24 cost time: 0.9605517387390137
Epoch: 24, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.553 Vali Acc: 0.757 Test Loss: 0.553 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0028271675109863
Epoch: 25, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.548 Vali Acc: 0.743 Test Loss: 0.548 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.801311731338501
Epoch: 26, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.543 Vali Acc: 0.750 Test Loss: 0.543 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9307210445404053
Epoch: 27, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.534 Vali Acc: 0.750 Test Loss: 0.534 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.971820592880249
Epoch: 28, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.530 Vali Acc: 0.750 Test Loss: 0.530 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9726734161376953
Epoch: 29, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.526 Vali Acc: 0.757 Test Loss: 0.526 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0172789096832275
Epoch: 30, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.524 Vali Acc: 0.757 Test Loss: 0.524 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7742946147918701
Epoch: 31, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.523 Vali Acc: 0.750 Test Loss: 0.523 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0965502262115479
Epoch: 32, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.525 Vali Acc: 0.757 Test Loss: 0.525 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0690436363220215
Epoch: 33, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.528 Vali Acc: 0.757 Test Loss: 0.528 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 51372
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1887896060943604
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.401 Vali Acc: 0.303 Test Loss: 1.401 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.144479751586914
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.331 Vali Acc: 0.342 Test Loss: 1.331 Test Acc: 0.342
Validation loss decreased (-0.302618 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.0860474109649658
Epoch: 3, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.248 Vali Acc: 0.467 Test Loss: 1.248 Test Acc: 0.467
Validation loss decreased (-0.342092 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.0108067989349365
Epoch: 4, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.164 Vali Acc: 0.539 Test Loss: 1.164 Test Acc: 0.539
Validation loss decreased (-0.467093 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.0949482917785645
Epoch: 5, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.080 Vali Acc: 0.572 Test Loss: 1.080 Test Acc: 0.572
Validation loss decreased (-0.539462 --> -0.572358).  Saving model ...
Epoch: 6 cost time: 1.0576426982879639
Epoch: 6, Steps: 10 | Train Loss: 0.906 Vali Loss: 0.997 Vali Acc: 0.618 Test Loss: 0.997 Test Acc: 0.618
Validation loss decreased (-0.572358 --> -0.618411).  Saving model ...
Epoch: 7 cost time: 1.1502776145935059
Epoch: 7, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.916 Vali Acc: 0.664 Test Loss: 0.916 Test Acc: 0.664
Validation loss decreased (-0.618411 --> -0.664465).  Saving model ...
Epoch: 8 cost time: 0.9862585067749023
Epoch: 8, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.848 Vali Acc: 0.671 Test Loss: 0.848 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.0186126232147217
Epoch: 9, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.788 Vali Acc: 0.691 Test Loss: 0.788 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690782).  Saving model ...
Epoch: 10 cost time: 0.9822866916656494
Epoch: 10, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.056856393814087
Epoch: 11, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.693 Vali Acc: 0.737 Test Loss: 0.693 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 0.991502046585083
Epoch: 12, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.656 Vali Acc: 0.743 Test Loss: 0.656 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 1.0681979656219482
Epoch: 13, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.630 Vali Acc: 0.757 Test Loss: 0.630 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.027763843536377
Epoch: 14, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.603 Vali Acc: 0.757 Test Loss: 0.603 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.044414758682251
Epoch: 15, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 1.0452611446380615
Epoch: 16, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.14091157913208
Epoch: 17, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.553 Vali Acc: 0.757 Test Loss: 0.553 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0219612121582031
Epoch: 18, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 19 cost time: 1.0037391185760498
Epoch: 19, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 20 cost time: 1.0787568092346191
Epoch: 20, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 21 cost time: 1.066652774810791
Epoch: 21, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 22 cost time: 1.0287368297576904
Epoch: 22, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 23 cost time: 1.104973316192627
Epoch: 23, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 24 cost time: 0.8620431423187256
Epoch: 24, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 25 cost time: 1.1294567584991455
Epoch: 25, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0842769145965576
Epoch: 26, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.000471591949463
Epoch: 27, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 28 cost time: 0.957740306854248
Epoch: 28, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1738662719726562
Epoch: 29, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 30 cost time: 1.1396620273590088
Epoch: 30, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 31 cost time: 1.1082818508148193
Epoch: 31, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.090186357498169
Epoch: 32, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9544422626495361
Epoch: 33, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.127617359161377
Epoch: 34, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 35 cost time: 1.2829644680023193
Epoch: 35, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.139042615890503
Epoch: 36, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1023571491241455
Epoch: 37, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0639498233795166
Epoch: 38, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.496 Vali Acc: 0.796 Test Loss: 0.496 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9154303073883057
Epoch: 39, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8630425930023193
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9067821502685547
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9797520637512207
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9412391185760498
Epoch: 43, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8650493621826172
Epoch: 44, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 34988
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7896556854248047
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.276 Test Loss: 1.384 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.1183717250823975
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.321 Vali Acc: 0.375 Test Loss: 1.321 Test Acc: 0.375
Validation loss decreased (-0.276302 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.0742135047912598
Epoch: 3, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.247 Vali Acc: 0.428 Test Loss: 1.247 Test Acc: 0.428
Validation loss decreased (-0.374987 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 0.9281129837036133
Epoch: 4, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.171 Vali Acc: 0.533 Test Loss: 1.171 Test Acc: 0.533
Validation loss decreased (-0.427619 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 1.0584778785705566
Epoch: 5, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.093 Vali Acc: 0.566 Test Loss: 1.093 Test Acc: 0.566
Validation loss decreased (-0.532883 --> -0.565779).  Saving model ...
Epoch: 6 cost time: 0.9734094142913818
Epoch: 6, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.017 Vali Acc: 0.605 Test Loss: 1.017 Test Acc: 0.605
Validation loss decreased (-0.565779 --> -0.605253).  Saving model ...
Epoch: 7 cost time: 1.0180583000183105
Epoch: 7, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.936 Vali Acc: 0.664 Test Loss: 0.936 Test Acc: 0.664
Validation loss decreased (-0.605253 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 1.1609852313995361
Epoch: 8, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.868 Vali Acc: 0.697 Test Loss: 0.868 Test Acc: 0.697
Validation loss decreased (-0.664464 --> -0.697360).  Saving model ...
Epoch: 9 cost time: 1.1908907890319824
Epoch: 9, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.808 Vali Acc: 0.717 Test Loss: 0.808 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717097).  Saving model ...
Epoch: 10 cost time: 1.1914234161376953
Epoch: 10, Steps: 10 | Train Loss: 0.579 Vali Loss: 0.756 Vali Acc: 0.711 Test Loss: 0.756 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1268160343170166
Epoch: 11, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.711 Vali Acc: 0.730 Test Loss: 0.711 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 12 cost time: 1.1107726097106934
Epoch: 12, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.673 Vali Acc: 0.743 Test Loss: 0.673 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 0.9949588775634766
Epoch: 13, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.0414495468139648
Epoch: 14, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.617 Vali Acc: 0.757 Test Loss: 0.617 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.0449638366699219
Epoch: 15, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 0.8344709873199463
Epoch: 16, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9805622100830078
Epoch: 17, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.562 Vali Acc: 0.750 Test Loss: 0.562 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0599238872528076
Epoch: 18, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.1030819416046143
Epoch: 19, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9477314949035645
Epoch: 20, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.528 Vali Acc: 0.763 Test Loss: 0.528 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0772974491119385
Epoch: 21, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 22 cost time: 1.0890312194824219
Epoch: 22, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 23 cost time: 1.0691452026367188
Epoch: 23, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796048).  Saving model ...
Epoch: 24 cost time: 1.0225186347961426
Epoch: 24, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9872088432312012
Epoch: 25, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9859554767608643
Epoch: 26, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.188047170639038
Epoch: 27, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.496 Vali Acc: 0.796 Test Loss: 0.496 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 28 cost time: 0.9100327491760254
Epoch: 28, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.496 Vali Acc: 0.796 Test Loss: 0.496 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0988154411315918
Epoch: 29, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1215178966522217
Epoch: 30, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 31 cost time: 1.187638759613037
Epoch: 31, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.490 Vali Acc: 0.796 Test Loss: 0.490 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.156442642211914
Epoch: 32, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.491 Vali Acc: 0.789 Test Loss: 0.491 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1108980178833008
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 34 cost time: 1.0674879550933838
Epoch: 34, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.487 Vali Acc: 0.796 Test Loss: 0.487 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.10439133644104
Epoch: 35, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.481 Vali Acc: 0.796 Test Loss: 0.481 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0464742183685303
Epoch: 36, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.478 Vali Acc: 0.796 Test Loss: 0.478 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1973605155944824
Epoch: 37, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.485 Vali Acc: 0.796 Test Loss: 0.485 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.069833755493164
Epoch: 38, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1236598491668701
Epoch: 39, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.485 Vali Acc: 0.796 Test Loss: 0.485 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1549034118652344
Epoch: 40, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1814606189727783
Epoch: 41, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 42 cost time: 1.0610172748565674
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 43 cost time: 0.876103401184082
Epoch: 43, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1360454559326172
Epoch: 44, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0639503002166748
Epoch: 45, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.488 Vali Acc: 0.816 Test Loss: 0.488 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0416615009307861
Epoch: 46, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0470669269561768
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0296287536621094
Epoch: 48, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0479085445404053
Epoch: 49, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.050333023071289
Epoch: 50, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0537633895874023
Epoch: 51, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.9331955909729004
Epoch: 52, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 34988
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.208359718322754
Epoch: 1, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.373 Vali Acc: 0.309 Test Loss: 1.373 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 0.9805586338043213
Epoch: 2, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.320 Vali Acc: 0.395 Test Loss: 1.320 Test Acc: 0.395
Validation loss decreased (-0.309197 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 0.9510974884033203
Epoch: 3, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.258 Vali Acc: 0.421 Test Loss: 1.258 Test Acc: 0.421
Validation loss decreased (-0.394724 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 0.8414435386657715
Epoch: 4, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.193 Vali Acc: 0.487 Test Loss: 1.193 Test Acc: 0.487
Validation loss decreased (-0.421040 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 0.9843041896820068
Epoch: 5, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.125 Vali Acc: 0.546 Test Loss: 1.125 Test Acc: 0.546
Validation loss decreased (-0.486830 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 1.0334372520446777
Epoch: 6, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.058 Vali Acc: 0.592 Test Loss: 1.058 Test Acc: 0.592
Validation loss decreased (-0.546041 --> -0.592095).  Saving model ...
Epoch: 7 cost time: 0.9844770431518555
Epoch: 7, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.984 Vali Acc: 0.638 Test Loss: 0.984 Test Acc: 0.638
Validation loss decreased (-0.592095 --> -0.638148).  Saving model ...
Epoch: 8 cost time: 0.9792277812957764
Epoch: 8, Steps: 10 | Train Loss: 0.778 Vali Loss: 0.918 Vali Acc: 0.671 Test Loss: 0.918 Test Acc: 0.671
Validation loss decreased (-0.638148 --> -0.671043).  Saving model ...
Epoch: 9 cost time: 0.9905281066894531
Epoch: 9, Steps: 10 | Train Loss: 0.685 Vali Loss: 0.858 Vali Acc: 0.691 Test Loss: 0.858 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 1.1588232517242432
Epoch: 10, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.802 Vali Acc: 0.717 Test Loss: 0.802 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717097).  Saving model ...
Epoch: 11 cost time: 1.0619137287139893
Epoch: 11, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.756 Vali Acc: 0.711 Test Loss: 0.756 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0263056755065918
Epoch: 12, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.716 Vali Acc: 0.730 Test Loss: 0.716 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 13 cost time: 0.9357261657714844
Epoch: 13, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.683 Vali Acc: 0.730 Test Loss: 0.683 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 14 cost time: 1.09663987159729
Epoch: 14, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.651 Vali Acc: 0.743 Test Loss: 0.651 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 1.0724904537200928
Epoch: 15, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.620 Vali Acc: 0.743 Test Loss: 0.620 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 16 cost time: 1.0827016830444336
Epoch: 16, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.601 Vali Acc: 0.757 Test Loss: 0.601 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.0366098880767822
Epoch: 17, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.588 Vali Acc: 0.750 Test Loss: 0.588 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0526313781738281
Epoch: 18, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.0729703903198242
Epoch: 19, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.99851393699646
Epoch: 20, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 21 cost time: 1.0568673610687256
Epoch: 21, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 1.029188871383667
Epoch: 22, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0641276836395264
Epoch: 23, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.532 Vali Acc: 0.763 Test Loss: 0.532 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0503418445587158
Epoch: 24, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 25 cost time: 1.05003023147583
Epoch: 25, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 26 cost time: 0.9009513854980469
Epoch: 26, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 27 cost time: 1.0499694347381592
Epoch: 27, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 28 cost time: 1.1132771968841553
Epoch: 28, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0867729187011719
Epoch: 29, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 30 cost time: 1.0177581310272217
Epoch: 30, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.505 Vali Acc: 0.783 Test Loss: 0.505 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 31 cost time: 0.9907896518707275
Epoch: 31, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.508 Vali Acc: 0.776 Test Loss: 0.508 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0263726711273193
Epoch: 32, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.019921064376831
Epoch: 33, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 34 cost time: 0.9893167018890381
Epoch: 34, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0208516120910645
Epoch: 35, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9833757877349854
Epoch: 36, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0260367393493652
Epoch: 37, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0711331367492676
Epoch: 38, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9271736145019531
Epoch: 39, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9983017444610596
Epoch: 40, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.005650520324707
Epoch: 41, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9067130088806152
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0490946769714355
Epoch: 43, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 34988
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8070313930511475
Epoch: 1, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.349 Vali Acc: 0.342 Test Loss: 1.349 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 0.8579163551330566
Epoch: 2, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.310 Vali Acc: 0.395 Test Loss: 1.310 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 0.8823294639587402
Epoch: 3, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.262 Vali Acc: 0.434 Test Loss: 1.262 Test Acc: 0.434
Validation loss decreased (-0.394724 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 0.8703391551971436
Epoch: 4, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.210 Vali Acc: 0.480 Test Loss: 1.210 Test Acc: 0.480
Validation loss decreased (-0.434198 --> -0.480251).  Saving model ...
Epoch: 5 cost time: 1.0298194885253906
Epoch: 5, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.157 Vali Acc: 0.526 Test Loss: 1.157 Test Acc: 0.526
Validation loss decreased (-0.480251 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 0.9941146373748779
Epoch: 6, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.103 Vali Acc: 0.553 Test Loss: 1.103 Test Acc: 0.553
Validation loss decreased (-0.526304 --> -0.552621).  Saving model ...
Epoch: 7 cost time: 1.1968035697937012
Epoch: 7, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.040 Vali Acc: 0.632 Test Loss: 1.040 Test Acc: 0.632
Validation loss decreased (-0.552621 --> -0.631569).  Saving model ...
Epoch: 8 cost time: 1.0773990154266357
Epoch: 8, Steps: 10 | Train Loss: 0.855 Vali Loss: 0.981 Vali Acc: 0.638 Test Loss: 0.981 Test Acc: 0.638
Validation loss decreased (-0.631569 --> -0.638148).  Saving model ...
Epoch: 9 cost time: 0.9384200572967529
Epoch: 9, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.928 Vali Acc: 0.658 Test Loss: 0.928 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 10 cost time: 1.113006353378296
Epoch: 10, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.874 Vali Acc: 0.671 Test Loss: 0.874 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 1.0927464962005615
Epoch: 11, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.829 Vali Acc: 0.678 Test Loss: 0.829 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677623).  Saving model ...
Epoch: 12 cost time: 1.0141394138336182
Epoch: 12, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.786 Vali Acc: 0.697 Test Loss: 0.786 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 13 cost time: 1.1709578037261963
Epoch: 13, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.752 Vali Acc: 0.704 Test Loss: 0.752 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 14 cost time: 1.1094486713409424
Epoch: 14, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.720 Vali Acc: 0.697 Test Loss: 0.720 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.058079719543457
Epoch: 15, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 16 cost time: 0.9801757335662842
Epoch: 16, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.665 Vali Acc: 0.724 Test Loss: 0.665 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 17 cost time: 0.9363772869110107
Epoch: 17, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.650 Vali Acc: 0.730 Test Loss: 0.650 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 18 cost time: 1.0801730155944824
Epoch: 18, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.631 Vali Acc: 0.730 Test Loss: 0.631 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 19 cost time: 1.217668056488037
Epoch: 19, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.615 Vali Acc: 0.730 Test Loss: 0.615 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 20 cost time: 1.0945472717285156
Epoch: 20, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.600 Vali Acc: 0.730 Test Loss: 0.600 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 21 cost time: 0.8673403263092041
Epoch: 21, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.590 Vali Acc: 0.743 Test Loss: 0.590 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 22 cost time: 1.1208045482635498
Epoch: 22, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.582 Vali Acc: 0.750 Test Loss: 0.582 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 23 cost time: 1.1758856773376465
Epoch: 23, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.574 Vali Acc: 0.750 Test Loss: 0.574 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 24 cost time: 1.1373398303985596
Epoch: 24, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.564 Vali Acc: 0.730 Test Loss: 0.564 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1188428401947021
Epoch: 25, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0224125385284424
Epoch: 26, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9728479385375977
Epoch: 27, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.555 Vali Acc: 0.743 Test Loss: 0.555 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0494303703308105
Epoch: 28, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.553 Vali Acc: 0.750 Test Loss: 0.553 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 29 cost time: 1.0420317649841309
Epoch: 29, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.550 Vali Acc: 0.743 Test Loss: 0.550 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8761003017425537
Epoch: 30, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.088991403579712
Epoch: 31, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.547 Vali Acc: 0.743 Test Loss: 0.547 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1295900344848633
Epoch: 32, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.551 Vali Acc: 0.750 Test Loss: 0.551 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 33 cost time: 0.9656221866607666
Epoch: 33, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.549 Vali Acc: 0.757 Test Loss: 0.549 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 34 cost time: 1.0796425342559814
Epoch: 34, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.551 Vali Acc: 0.743 Test Loss: 0.551 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0998854637145996
Epoch: 35, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.555 Vali Acc: 0.750 Test Loss: 0.555 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1335880756378174
Epoch: 36, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.555 Vali Acc: 0.750 Test Loss: 0.555 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0207760334014893
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1306180953979492
Epoch: 38, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.077263355255127
Epoch: 39, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.568 Vali Acc: 0.743 Test Loss: 0.568 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0159029960632324
Epoch: 40, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.569 Vali Acc: 0.743 Test Loss: 0.569 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0705084800720215
Epoch: 41, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.573 Vali Acc: 0.743 Test Loss: 0.573 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0260326862335205
Epoch: 42, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.580 Vali Acc: 0.743 Test Loss: 0.580 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.974682092666626
Epoch: 43, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.587 Vali Acc: 0.743 Test Loss: 0.587 Test Acc: 0.743
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.756578947368421
model parameter : 34988
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.981909990310669
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.409 Vali Acc: 0.322 Test Loss: 1.409 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 1.1074059009552002
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.344 Vali Acc: 0.342 Test Loss: 1.344 Test Acc: 0.342
Validation loss decreased (-0.322354 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.1676604747772217
Epoch: 3, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.265 Vali Acc: 0.454 Test Loss: 1.265 Test Acc: 0.454
Validation loss decreased (-0.342092 --> -0.453935).  Saving model ...
Epoch: 4 cost time: 1.1701664924621582
Epoch: 4, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.176 Vali Acc: 0.546 Test Loss: 1.176 Test Acc: 0.546
Validation loss decreased (-0.453935 --> -0.546041).  Saving model ...
Epoch: 5 cost time: 1.0550031661987305
Epoch: 5, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.088 Vali Acc: 0.605 Test Loss: 1.088 Test Acc: 0.605
Validation loss decreased (-0.546041 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 1.1197519302368164
Epoch: 6, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.003 Vali Acc: 0.632 Test Loss: 1.003 Test Acc: 0.632
Validation loss decreased (-0.605252 --> -0.631569).  Saving model ...
Epoch: 7 cost time: 1.0984513759613037
Epoch: 7, Steps: 10 | Train Loss: 0.871 Vali Loss: 0.928 Vali Acc: 0.664 Test Loss: 0.928 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 1.0686297416687012
Epoch: 8, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.860 Vali Acc: 0.678 Test Loss: 0.860 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 1.0696406364440918
Epoch: 9, Steps: 10 | Train Loss: 0.709 Vali Loss: 0.803 Vali Acc: 0.697 Test Loss: 0.803 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697360).  Saving model ...
Epoch: 10 cost time: 1.09765625
Epoch: 10, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.0287272930145264
Epoch: 11, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717098).  Saving model ...
Epoch: 12 cost time: 1.177992582321167
Epoch: 12, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.671 Vali Acc: 0.730 Test Loss: 0.671 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 13 cost time: 1.1469111442565918
Epoch: 13, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 1.114980697631836
Epoch: 14, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.621 Vali Acc: 0.750 Test Loss: 0.621 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.062169075012207
Epoch: 15, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.597 Vali Acc: 0.743 Test Loss: 0.597 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0349223613739014
Epoch: 16, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.581 Vali Acc: 0.743 Test Loss: 0.581 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1141729354858398
Epoch: 17, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.3091273307800293
Epoch: 18, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.114018440246582
Epoch: 19, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.0355923175811768
Epoch: 20, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2106473445892334
Epoch: 21, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2334179878234863
Epoch: 22, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1904985904693604
Epoch: 23, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.088944911956787
Epoch: 24, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 25 cost time: 1.1469018459320068
Epoch: 25, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 26 cost time: 1.053354263305664
Epoch: 26, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1590495109558105
Epoch: 27, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.503 Vali Acc: 0.816 Test Loss: 0.503 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 28 cost time: 1.11716628074646
Epoch: 28, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1358888149261475
Epoch: 29, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 30 cost time: 1.082829236984253
Epoch: 30, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 31 cost time: 1.045532464981079
Epoch: 31, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 32 cost time: 1.11775541305542
Epoch: 32, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 33 cost time: 1.2618613243103027
Epoch: 33, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1534297466278076
Epoch: 34, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 35 cost time: 1.1948411464691162
Epoch: 35, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 1.121225357055664
Epoch: 36, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1035346984863281
Epoch: 37, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0723278522491455
Epoch: 38, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1374151706695557
Epoch: 39, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0711660385131836
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3049142360687256
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9870190620422363
Epoch: 42, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1466436386108398
Epoch: 43, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2544384002685547
Epoch: 44, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2419428825378418
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 26796
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6391937732696533
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.401 Vali Acc: 0.309 Test Loss: 1.401 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.2554891109466553
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.340 Vali Acc: 0.336 Test Loss: 1.340 Test Acc: 0.336
Validation loss decreased (-0.309197 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.2434823513031006
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.266 Vali Acc: 0.428 Test Loss: 1.266 Test Acc: 0.428
Validation loss decreased (-0.335513 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.078777551651001
Epoch: 4, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.183 Vali Acc: 0.520 Test Loss: 1.183 Test Acc: 0.520
Validation loss decreased (-0.427619 --> -0.519725).  Saving model ...
Epoch: 5 cost time: 1.127159595489502
Epoch: 5, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.099 Vali Acc: 0.592 Test Loss: 1.099 Test Acc: 0.592
Validation loss decreased (-0.519725 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.1582698822021484
Epoch: 6, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.017 Vali Acc: 0.645 Test Loss: 1.017 Test Acc: 0.645
Validation loss decreased (-0.592094 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 1.1288161277770996
Epoch: 7, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.946 Vali Acc: 0.684 Test Loss: 0.946 Test Acc: 0.684
Validation loss decreased (-0.644727 --> -0.684201).  Saving model ...
Epoch: 8 cost time: 1.1588618755340576
Epoch: 8, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.876 Vali Acc: 0.684 Test Loss: 0.876 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684202).  Saving model ...
Epoch: 9 cost time: 1.1341350078582764
Epoch: 9, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.816 Vali Acc: 0.691 Test Loss: 0.816 Test Acc: 0.691
Validation loss decreased (-0.684202 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 0.9292325973510742
Epoch: 10, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.761 Vali Acc: 0.717 Test Loss: 0.761 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.0784826278686523
Epoch: 11, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.715 Vali Acc: 0.730 Test Loss: 0.715 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 12 cost time: 1.0027918815612793
Epoch: 12, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.676 Vali Acc: 0.757 Test Loss: 0.676 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 1.388411521911621
Epoch: 13, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.650 Vali Acc: 0.743 Test Loss: 0.650 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1411173343658447
Epoch: 14, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.621 Vali Acc: 0.757 Test Loss: 0.621 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.1657674312591553
Epoch: 15, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.13818359375
Epoch: 16, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1262633800506592
Epoch: 17, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0108551979064941
Epoch: 18, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 19 cost time: 0.9642200469970703
Epoch: 19, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 0.946012020111084
Epoch: 20, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 21 cost time: 0.9235560894012451
Epoch: 21, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 0.9333164691925049
Epoch: 22, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.022223711013794
Epoch: 23, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 24 cost time: 1.2967581748962402
Epoch: 24, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 25 cost time: 1.2700221538543701
Epoch: 25, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 26 cost time: 1.0861351490020752
Epoch: 26, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 27 cost time: 0.9222414493560791
Epoch: 27, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 28 cost time: 1.1195740699768066
Epoch: 28, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2770335674285889
Epoch: 29, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.488 Vali Acc: 0.816 Test Loss: 0.488 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 30 cost time: 1.1241331100463867
Epoch: 30, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.067505121231079
Epoch: 31, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1735365390777588
Epoch: 32, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0403828620910645
Epoch: 33, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.486 Vali Acc: 0.803 Test Loss: 0.486 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2324984073638916
Epoch: 34, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9830329418182373
Epoch: 35, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0972120761871338
Epoch: 36, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.162951946258545
Epoch: 37, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2264111042022705
Epoch: 38, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.486 Vali Acc: 0.803 Test Loss: 0.486 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0646638870239258
Epoch: 39, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 26796
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1813788414001465
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.408 Vali Acc: 0.263 Test Loss: 1.408 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.019615650177002
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.357 Vali Acc: 0.276 Test Loss: 1.357 Test Acc: 0.276
Validation loss decreased (-0.263144 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 1.0415422916412354
Epoch: 3, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.294 Vali Acc: 0.362 Test Loss: 1.294 Test Acc: 0.362
Validation loss decreased (-0.276302 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.1587944030761719
Epoch: 4, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.223 Vali Acc: 0.434 Test Loss: 1.223 Test Acc: 0.434
Validation loss decreased (-0.361829 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 1.0194551944732666
Epoch: 5, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.149 Vali Acc: 0.533 Test Loss: 1.149 Test Acc: 0.533
Validation loss decreased (-0.434198 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 1.0133695602416992
Epoch: 6, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.076 Vali Acc: 0.618 Test Loss: 1.076 Test Acc: 0.618
Validation loss decreased (-0.532883 --> -0.618410).  Saving model ...
Epoch: 7 cost time: 0.9371645450592041
Epoch: 7, Steps: 10 | Train Loss: 0.911 Vali Loss: 1.003 Vali Acc: 0.645 Test Loss: 1.003 Test Acc: 0.645
Validation loss decreased (-0.618410 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 1.01363205909729
Epoch: 8, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.936 Vali Acc: 0.697 Test Loss: 0.936 Test Acc: 0.697
Validation loss decreased (-0.644727 --> -0.697359).  Saving model ...
Epoch: 9 cost time: 1.0431253910064697
Epoch: 9, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.878 Vali Acc: 0.684 Test Loss: 0.878 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0863900184631348
Epoch: 10, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.821 Vali Acc: 0.697 Test Loss: 0.821 Test Acc: 0.697
Validation loss decreased (-0.697359 --> -0.697360).  Saving model ...
Epoch: 11 cost time: 1.0201537609100342
Epoch: 11, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.771 Vali Acc: 0.697 Test Loss: 0.771 Test Acc: 0.697
Validation loss decreased (-0.697360 --> -0.697361).  Saving model ...
Epoch: 12 cost time: 1.0843212604522705
Epoch: 12, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.728 Vali Acc: 0.711 Test Loss: 0.728 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 13 cost time: 0.8802273273468018
Epoch: 13, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.698 Vali Acc: 0.711 Test Loss: 0.698 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 14 cost time: 1.0252630710601807
Epoch: 14, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.665 Vali Acc: 0.717 Test Loss: 0.665 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717099).  Saving model ...
Epoch: 15 cost time: 0.8430500030517578
Epoch: 15, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.637 Vali Acc: 0.724 Test Loss: 0.637 Test Acc: 0.724
Validation loss decreased (-0.717099 --> -0.723678).  Saving model ...
Epoch: 16 cost time: 1.0734992027282715
Epoch: 16, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.614 Vali Acc: 0.750 Test Loss: 0.614 Test Acc: 0.750
Validation loss decreased (-0.723678 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 1.008936882019043
Epoch: 17, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.598 Vali Acc: 0.743 Test Loss: 0.598 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1299214363098145
Epoch: 18, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.580 Vali Acc: 0.737 Test Loss: 0.580 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.096710205078125
Epoch: 19, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 1.1507999897003174
Epoch: 20, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.553 Vali Acc: 0.763 Test Loss: 0.553 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 1.0479531288146973
Epoch: 21, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0586793422698975
Epoch: 22, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.542 Vali Acc: 0.757 Test Loss: 0.542 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1288254261016846
Epoch: 23, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.526 Vali Acc: 0.763 Test Loss: 0.526 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 24 cost time: 1.1409895420074463
Epoch: 24, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.523 Vali Acc: 0.763 Test Loss: 0.523 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 25 cost time: 1.0369853973388672
Epoch: 25, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.522 Vali Acc: 0.763 Test Loss: 0.522 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 26 cost time: 1.158632516860962
Epoch: 26, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 27 cost time: 1.059497356414795
Epoch: 27, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 28 cost time: 1.1124484539031982
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 29 cost time: 1.14554762840271
Epoch: 29, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0148696899414062
Epoch: 30, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0608091354370117
Epoch: 31, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 32 cost time: 0.9089348316192627
Epoch: 32, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1757104396820068
Epoch: 33, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0160229206085205
Epoch: 34, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1891353130340576
Epoch: 35, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796047).  Saving model ...
Epoch: 36 cost time: 1.1114168167114258
Epoch: 36, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 37 cost time: 1.0165235996246338
Epoch: 37, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0797593593597412
Epoch: 38, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9529719352722168
Epoch: 39, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0262572765350342
Epoch: 40, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 41 cost time: 1.0544617176055908
Epoch: 41, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1284582614898682
Epoch: 42, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.181788444519043
Epoch: 43, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.055673599243164
Epoch: 44, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0763864517211914
Epoch: 45, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1231398582458496
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1767847537994385
Epoch: 47, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1288018226623535
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.127263069152832
Epoch: 49, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9486076831817627
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 26796
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.329664707183838
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.9863371849060059
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.369 Vali Acc: 0.270 Test Loss: 1.369 Test Acc: 0.270
Validation loss decreased (-0.243407 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.1268374919891357
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.319 Vali Acc: 0.329 Test Loss: 1.319 Test Acc: 0.329
Validation loss decreased (-0.269723 --> -0.328934).  Saving model ...
Epoch: 4 cost time: 1.0610663890838623
Epoch: 4, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.261 Vali Acc: 0.467 Test Loss: 1.261 Test Acc: 0.467
Validation loss decreased (-0.328934 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 0.959252119064331
Epoch: 5, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.201 Vali Acc: 0.546 Test Loss: 1.201 Test Acc: 0.546
Validation loss decreased (-0.467093 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 1.0512583255767822
Epoch: 6, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.139 Vali Acc: 0.579 Test Loss: 1.139 Test Acc: 0.579
Validation loss decreased (-0.546041 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 1.0111982822418213
Epoch: 7, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.080 Vali Acc: 0.638 Test Loss: 1.080 Test Acc: 0.638
Validation loss decreased (-0.578936 --> -0.638147).  Saving model ...
Epoch: 8 cost time: 1.0598869323730469
Epoch: 8, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.017 Vali Acc: 0.697 Test Loss: 1.017 Test Acc: 0.697
Validation loss decreased (-0.638147 --> -0.697358).  Saving model ...
Epoch: 9 cost time: 1.0477797985076904
Epoch: 9, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.959 Vali Acc: 0.717 Test Loss: 0.959 Test Acc: 0.717
Validation loss decreased (-0.697358 --> -0.717096).  Saving model ...
Epoch: 10 cost time: 0.9331862926483154
Epoch: 10, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.901 Vali Acc: 0.724 Test Loss: 0.901 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 11 cost time: 1.0801365375518799
Epoch: 11, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.854 Vali Acc: 0.737 Test Loss: 0.854 Test Acc: 0.737
Validation loss decreased (-0.723675 --> -0.736834).  Saving model ...
Epoch: 12 cost time: 1.1668431758880615
Epoch: 12, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.808 Vali Acc: 0.724 Test Loss: 0.808 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1147866249084473
Epoch: 13, Steps: 10 | Train Loss: 0.539 Vali Loss: 0.773 Vali Acc: 0.724 Test Loss: 0.773 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0256061553955078
Epoch: 14, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.736 Vali Acc: 0.724 Test Loss: 0.736 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8659708499908447
Epoch: 15, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.706 Vali Acc: 0.724 Test Loss: 0.706 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0707650184631348
Epoch: 16, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.676 Vali Acc: 0.737 Test Loss: 0.676 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736835).  Saving model ...
Epoch: 17 cost time: 0.9364466667175293
Epoch: 17, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.649 Vali Acc: 0.737 Test Loss: 0.649 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 18 cost time: 0.96211838722229
Epoch: 18, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 19 cost time: 1.053497076034546
Epoch: 19, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.611 Vali Acc: 0.743 Test Loss: 0.611 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 20 cost time: 0.9762754440307617
Epoch: 20, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0248088836669922
Epoch: 21, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0723316669464111
Epoch: 22, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.586 Vali Acc: 0.730 Test Loss: 0.586 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0531463623046875
Epoch: 23, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.574 Vali Acc: 0.743 Test Loss: 0.574 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 24 cost time: 0.9098320007324219
Epoch: 24, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1159658432006836
Epoch: 25, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1190567016601562
Epoch: 26, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 27 cost time: 1.152897596359253
Epoch: 27, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.559 Vali Acc: 0.750 Test Loss: 0.559 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 28 cost time: 1.1821134090423584
Epoch: 28, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.552 Vali Acc: 0.743 Test Loss: 0.552 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0605924129486084
Epoch: 29, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.552 Vali Acc: 0.743 Test Loss: 0.552 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9099025726318359
Epoch: 30, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.553 Vali Acc: 0.743 Test Loss: 0.553 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9769287109375
Epoch: 31, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.550 Vali Acc: 0.743 Test Loss: 0.550 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0871095657348633
Epoch: 32, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.552 Vali Acc: 0.743 Test Loss: 0.552 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1656866073608398
Epoch: 33, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 34 cost time: 1.0501484870910645
Epoch: 34, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.551 Vali Acc: 0.750 Test Loss: 0.551 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2671458721160889
Epoch: 35, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9586925506591797
Epoch: 36, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.552 Vali Acc: 0.750 Test Loss: 0.552 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1311113834381104
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.553 Vali Acc: 0.743 Test Loss: 0.553 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9695963859558105
Epoch: 38, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0334548950195312
Epoch: 39, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.554 Vali Acc: 0.743 Test Loss: 0.554 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0982716083526611
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.557 Vali Acc: 0.743 Test Loss: 0.557 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2010865211486816
Epoch: 41, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0248267650604248
Epoch: 42, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.562 Vali Acc: 0.750 Test Loss: 0.562 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9398784637451172
Epoch: 43, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.756578947368421
model parameter : 26796
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.039203405380249
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.341 Vali Acc: 0.289 Test Loss: 1.341 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 0.9955945014953613
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.312 Vali Acc: 0.342 Test Loss: 1.312 Test Acc: 0.342
Validation loss decreased (-0.289460 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.0643205642700195
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.273 Vali Acc: 0.375 Test Loss: 1.273 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.9775254726409912
Epoch: 4, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.228 Vali Acc: 0.441 Test Loss: 1.228 Test Acc: 0.441
Validation loss decreased (-0.374987 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 0.9581561088562012
Epoch: 5, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.182 Vali Acc: 0.520 Test Loss: 1.182 Test Acc: 0.520
Validation loss decreased (-0.440777 --> -0.519725).  Saving model ...
Epoch: 6 cost time: 1.0272862911224365
Epoch: 6, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.134 Vali Acc: 0.559 Test Loss: 1.134 Test Acc: 0.559
Validation loss decreased (-0.519725 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 0.9348726272583008
Epoch: 7, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.083 Vali Acc: 0.612 Test Loss: 1.083 Test Acc: 0.612
Validation loss decreased (-0.559199 --> -0.611831).  Saving model ...
Epoch: 8 cost time: 1.0328903198242188
Epoch: 8, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.035 Vali Acc: 0.658 Test Loss: 1.035 Test Acc: 0.658
Validation loss decreased (-0.611831 --> -0.657884).  Saving model ...
Epoch: 9 cost time: 0.8321492671966553
Epoch: 9, Steps: 10 | Train Loss: 0.901 Vali Loss: 0.986 Vali Acc: 0.664 Test Loss: 0.986 Test Acc: 0.664
Validation loss decreased (-0.657884 --> -0.664464).  Saving model ...
Epoch: 10 cost time: 0.9493362903594971
Epoch: 10, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.939 Vali Acc: 0.684 Test Loss: 0.939 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 11 cost time: 0.8989932537078857
Epoch: 11, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.895 Vali Acc: 0.691 Test Loss: 0.895 Test Acc: 0.691
Validation loss decreased (-0.684201 --> -0.690781).  Saving model ...
Epoch: 12 cost time: 0.8518023490905762
Epoch: 12, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.854 Vali Acc: 0.697 Test Loss: 0.854 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697360).  Saving model ...
Epoch: 13 cost time: 0.965278148651123
Epoch: 13, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.817 Vali Acc: 0.711 Test Loss: 0.817 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710518).  Saving model ...
Epoch: 14 cost time: 0.9693036079406738
Epoch: 14, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.784 Vali Acc: 0.730 Test Loss: 0.784 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 1.0335161685943604
Epoch: 15, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.752 Vali Acc: 0.724 Test Loss: 0.752 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0028109550476074
Epoch: 16, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.722 Vali Acc: 0.737 Test Loss: 0.722 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736835).  Saving model ...
Epoch: 17 cost time: 1.0371148586273193
Epoch: 17, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.698 Vali Acc: 0.737 Test Loss: 0.698 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 18 cost time: 1.0463175773620605
Epoch: 18, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.677 Vali Acc: 0.743 Test Loss: 0.677 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 1.1056749820709229
Epoch: 19, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.659 Vali Acc: 0.757 Test Loss: 0.659 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 20 cost time: 0.9259753227233887
Epoch: 20, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.638 Vali Acc: 0.770 Test Loss: 0.638 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 1.097400188446045
Epoch: 21, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 1.2636637687683105
Epoch: 22, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.616 Vali Acc: 0.770 Test Loss: 0.616 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1501402854919434
Epoch: 23, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.608 Vali Acc: 0.750 Test Loss: 0.608 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1187083721160889
Epoch: 24, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2158069610595703
Epoch: 25, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2038908004760742
Epoch: 26, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.2191531658172607
Epoch: 27, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.563 Vali Acc: 0.796 Test Loss: 0.563 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.1392607688903809
Epoch: 28, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2801291942596436
Epoch: 29, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.20798921585083
Epoch: 30, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2658960819244385
Epoch: 31, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 32 cost time: 1.3080368041992188
Epoch: 32, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3007879257202148
Epoch: 33, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1365270614624023
Epoch: 34, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 35 cost time: 1.1615395545959473
Epoch: 35, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 36 cost time: 1.1840085983276367
Epoch: 36, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1465330123901367
Epoch: 37, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 38 cost time: 1.213552474975586
Epoch: 38, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 39 cost time: 1.1886897087097168
Epoch: 39, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 40 cost time: 1.204024076461792
Epoch: 40, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 41 cost time: 1.228384256362915
Epoch: 41, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 42 cost time: 1.2582850456237793
Epoch: 42, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 43 cost time: 1.1628944873809814
Epoch: 43, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 44 cost time: 1.201582908630371
Epoch: 44, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3916525840759277
Epoch: 45, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2094297409057617
Epoch: 46, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815784).  Saving model ...
Epoch: 47 cost time: 1.0849850177764893
Epoch: 47, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 48 cost time: 1.0381269454956055
Epoch: 48, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0061962604522705
Epoch: 49, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0688464641571045
Epoch: 50, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.506 Vali Acc: 0.816 Test Loss: 0.506 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 51 cost time: 1.3191349506378174
Epoch: 51, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 52 cost time: 1.2628746032714844
Epoch: 52, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2585725784301758
Epoch: 53, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1204800605773926
Epoch: 54, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.363260269165039
Epoch: 55, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.506 Vali Acc: 0.816 Test Loss: 0.506 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1642084121704102
Epoch: 56, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.217353105545044
Epoch: 57, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.2104225158691406
Epoch: 58, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 59 cost time: 1.2712554931640625
Epoch: 59, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.2760636806488037
Epoch: 60, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1766870021820068
Epoch: 61, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.9865562915802002
Epoch: 62, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.2056124210357666
Epoch: 63, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.1713464260101318
Epoch: 64, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.2361149787902832
Epoch: 65, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.0218400955200195
Epoch: 66, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.0502369403839111
Epoch: 67, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.9847841262817383
Epoch: 68, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 138348
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5955429077148438
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.345 Vali Acc: 0.296 Test Loss: 1.345 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.0786380767822266
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.318 Vali Acc: 0.309 Test Loss: 1.318 Test Acc: 0.309
Validation loss decreased (-0.296039 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.9195654392242432
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.278 Vali Acc: 0.382 Test Loss: 1.278 Test Acc: 0.382
Validation loss decreased (-0.309197 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 0.954355001449585
Epoch: 4, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.235 Vali Acc: 0.461 Test Loss: 1.235 Test Acc: 0.461
Validation loss decreased (-0.381566 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 0.8041763305664062
Epoch: 5, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.188 Vali Acc: 0.526 Test Loss: 1.188 Test Acc: 0.526
Validation loss decreased (-0.460514 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 0.8171248435974121
Epoch: 6, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.138 Vali Acc: 0.586 Test Loss: 1.138 Test Acc: 0.586
Validation loss decreased (-0.526304 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 0.9648933410644531
Epoch: 7, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.088 Vali Acc: 0.612 Test Loss: 1.088 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611831).  Saving model ...
Epoch: 8 cost time: 0.8968827724456787
Epoch: 8, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.039 Vali Acc: 0.678 Test Loss: 1.039 Test Acc: 0.678
Validation loss decreased (-0.611831 --> -0.677621).  Saving model ...
Epoch: 9 cost time: 0.9665274620056152
Epoch: 9, Steps: 10 | Train Loss: 0.934 Vali Loss: 0.992 Vali Acc: 0.697 Test Loss: 0.992 Test Acc: 0.697
Validation loss decreased (-0.677621 --> -0.697359).  Saving model ...
Epoch: 10 cost time: 1.0121560096740723
Epoch: 10, Steps: 10 | Train Loss: 0.839 Vali Loss: 0.942 Vali Acc: 0.697 Test Loss: 0.942 Test Acc: 0.697
Validation loss decreased (-0.697359 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 1.0450267791748047
Epoch: 11, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.896 Vali Acc: 0.704 Test Loss: 0.896 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703938).  Saving model ...
Epoch: 12 cost time: 1.089630365371704
Epoch: 12, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.854 Vali Acc: 0.697 Test Loss: 0.854 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9719138145446777
Epoch: 13, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.816 Vali Acc: 0.711 Test Loss: 0.816 Test Acc: 0.711
Validation loss decreased (-0.703938 --> -0.710518).  Saving model ...
Epoch: 14 cost time: 1.1603975296020508
Epoch: 14, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.784 Vali Acc: 0.730 Test Loss: 0.784 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 1.067284345626831
Epoch: 15, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.752 Vali Acc: 0.743 Test Loss: 0.752 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 16 cost time: 1.0738391876220703
Epoch: 16, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.723 Vali Acc: 0.743 Test Loss: 0.723 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 17 cost time: 1.1076385974884033
Epoch: 17, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.699 Vali Acc: 0.730 Test Loss: 0.699 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.056441068649292
Epoch: 18, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.678 Vali Acc: 0.757 Test Loss: 0.678 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 19 cost time: 1.2261953353881836
Epoch: 19, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.661 Vali Acc: 0.757 Test Loss: 0.661 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 20 cost time: 0.9967796802520752
Epoch: 20, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 0.8755030632019043
Epoch: 21, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 1.0637121200561523
Epoch: 22, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9278731346130371
Epoch: 23, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9914755821228027
Epoch: 24, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.596 Vali Acc: 0.757 Test Loss: 0.596 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9879586696624756
Epoch: 25, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0937678813934326
Epoch: 26, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1162991523742676
Epoch: 27, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1795752048492432
Epoch: 28, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.075066328048706
Epoch: 29, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.555 Vali Acc: 0.757 Test Loss: 0.555 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0790774822235107
Epoch: 30, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0441691875457764
Epoch: 31, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 138348
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3135859966278076
Epoch: 1, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.330 Vali Acc: 0.388 Test Loss: 1.330 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 1.0566232204437256
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.305 Vali Acc: 0.388 Test Loss: 1.305 Test Acc: 0.388
Validation loss decreased (-0.388145 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.009737491607666
Epoch: 3, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.273 Vali Acc: 0.408 Test Loss: 1.273 Test Acc: 0.408
Validation loss decreased (-0.388145 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 1.1446959972381592
Epoch: 4, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.233 Vali Acc: 0.434 Test Loss: 1.233 Test Acc: 0.434
Validation loss decreased (-0.407882 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 1.1798791885375977
Epoch: 5, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.190 Vali Acc: 0.493 Test Loss: 1.190 Test Acc: 0.493
Validation loss decreased (-0.434198 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 1.0215423107147217
Epoch: 6, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.145 Vali Acc: 0.539 Test Loss: 1.145 Test Acc: 0.539
Validation loss decreased (-0.493409 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 1.0303540229797363
Epoch: 7, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.102 Vali Acc: 0.559 Test Loss: 1.102 Test Acc: 0.559
Validation loss decreased (-0.539462 --> -0.559200).  Saving model ...
Epoch: 8 cost time: 0.9000229835510254
Epoch: 8, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.055 Vali Acc: 0.612 Test Loss: 1.055 Test Acc: 0.612
Validation loss decreased (-0.559200 --> -0.611832).  Saving model ...
Epoch: 9 cost time: 1.1090893745422363
Epoch: 9, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.012 Vali Acc: 0.632 Test Loss: 1.012 Test Acc: 0.632
Validation loss decreased (-0.611832 --> -0.631569).  Saving model ...
Epoch: 10 cost time: 1.0621192455291748
Epoch: 10, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.969 Vali Acc: 0.678 Test Loss: 0.969 Test Acc: 0.678
Validation loss decreased (-0.631569 --> -0.677622).  Saving model ...
Epoch: 11 cost time: 1.0521557331085205
Epoch: 11, Steps: 10 | Train Loss: 0.841 Vali Loss: 0.929 Vali Acc: 0.678 Test Loss: 0.929 Test Acc: 0.678
Validation loss decreased (-0.677622 --> -0.677622).  Saving model ...
Epoch: 12 cost time: 1.0530977249145508
Epoch: 12, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.889 Vali Acc: 0.691 Test Loss: 0.889 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690781).  Saving model ...
Epoch: 13 cost time: 1.0687165260314941
Epoch: 13, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.851 Vali Acc: 0.724 Test Loss: 0.851 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723676).  Saving model ...
Epoch: 14 cost time: 1.0290873050689697
Epoch: 14, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.822 Vali Acc: 0.717 Test Loss: 0.822 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1011817455291748
Epoch: 15, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.789 Vali Acc: 0.724 Test Loss: 0.789 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723676).  Saving model ...
Epoch: 16 cost time: 1.0398368835449219
Epoch: 16, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.761 Vali Acc: 0.724 Test Loss: 0.761 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 1.0713765621185303
Epoch: 17, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.734 Vali Acc: 0.724 Test Loss: 0.734 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 1.1462805271148682
Epoch: 18, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.711 Vali Acc: 0.730 Test Loss: 0.711 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 0.9674022197723389
Epoch: 19, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 20 cost time: 0.9383213520050049
Epoch: 20, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 1.064420461654663
Epoch: 21, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.653 Vali Acc: 0.743 Test Loss: 0.653 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 22 cost time: 0.9620749950408936
Epoch: 22, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.642 Vali Acc: 0.743 Test Loss: 0.642 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 23 cost time: 0.9518585205078125
Epoch: 23, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 24 cost time: 0.9765589237213135
Epoch: 24, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.616 Vali Acc: 0.763 Test Loss: 0.616 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 25 cost time: 0.9784512519836426
Epoch: 25, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 1.0765373706817627
Epoch: 26, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 1.007408857345581
Epoch: 27, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 28 cost time: 1.06583571434021
Epoch: 28, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 29 cost time: 1.0049705505371094
Epoch: 29, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 30 cost time: 1.069631814956665
Epoch: 30, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 1.0756218433380127
Epoch: 31, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 0.9376521110534668
Epoch: 32, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 0.993133544921875
Epoch: 33, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 34 cost time: 1.0922932624816895
Epoch: 34, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9673452377319336
Epoch: 35, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.530 Vali Acc: 0.770 Test Loss: 0.530 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.032721996307373
Epoch: 36, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.532 Vali Acc: 0.763 Test Loss: 0.532 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9760589599609375
Epoch: 37, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 38 cost time: 1.240156888961792
Epoch: 38, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0946812629699707
Epoch: 39, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 40 cost time: 1.0824599266052246
Epoch: 40, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.510 Vali Acc: 0.770 Test Loss: 0.510 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.03798246383667
Epoch: 41, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 42 cost time: 1.0083601474761963
Epoch: 42, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 43 cost time: 0.9668810367584229
Epoch: 43, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.510 Vali Acc: 0.770 Test Loss: 0.510 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0650155544281006
Epoch: 44, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9939029216766357
Epoch: 45, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1156861782073975
Epoch: 46, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1071078777313232
Epoch: 47, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0950629711151123
Epoch: 48, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.150744915008545
Epoch: 49, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0055499076843262
Epoch: 50, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 51 cost time: 1.0798053741455078
Epoch: 51, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9294366836547852
Epoch: 52, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0420598983764648
Epoch: 53, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0377740859985352
Epoch: 54, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 55 cost time: 0.9396300315856934
Epoch: 55, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 56 cost time: 0.9285638332366943
Epoch: 56, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0109779834747314
Epoch: 57, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 58 cost time: 0.9990136623382568
Epoch: 58, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1720504760742188
Epoch: 59, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0661280155181885
Epoch: 60, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.134782075881958
Epoch: 61, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.1510593891143799
Epoch: 62, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.9245402812957764
Epoch: 63, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.0108022689819336
Epoch: 64, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.0338969230651855
Epoch: 65, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.123265027999878
Epoch: 66, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.14267897605896
Epoch: 67, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.561 Vali Acc: 0.789 Test Loss: 0.561 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 138348
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.332268238067627
Epoch: 1, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.360 Vali Acc: 0.289 Test Loss: 1.360 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.0115809440612793
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.339 Vali Acc: 0.336 Test Loss: 1.339 Test Acc: 0.336
Validation loss decreased (-0.289460 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.0569133758544922
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.310 Vali Acc: 0.355 Test Loss: 1.310 Test Acc: 0.355
Validation loss decreased (-0.335513 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.1175684928894043
Epoch: 4, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.276 Vali Acc: 0.408 Test Loss: 1.276 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 0.9175467491149902
Epoch: 5, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.238 Vali Acc: 0.493 Test Loss: 1.238 Test Acc: 0.493
Validation loss decreased (-0.407882 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 0.7706685066223145
Epoch: 6, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.202 Vali Acc: 0.546 Test Loss: 1.202 Test Acc: 0.546
Validation loss decreased (-0.493409 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 0.9281785488128662
Epoch: 7, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.162 Vali Acc: 0.618 Test Loss: 1.162 Test Acc: 0.618
Validation loss decreased (-0.546041 --> -0.618409).  Saving model ...
Epoch: 8 cost time: 1.0005097389221191
Epoch: 8, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.122 Vali Acc: 0.632 Test Loss: 1.122 Test Acc: 0.632
Validation loss decreased (-0.618409 --> -0.631568).  Saving model ...
Epoch: 9 cost time: 0.9938182830810547
Epoch: 9, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.082 Vali Acc: 0.691 Test Loss: 1.082 Test Acc: 0.691
Validation loss decreased (-0.631568 --> -0.690779).  Saving model ...
Epoch: 10 cost time: 1.0361266136169434
Epoch: 10, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.044 Vali Acc: 0.691 Test Loss: 1.044 Test Acc: 0.691
Validation loss decreased (-0.690779 --> -0.690779).  Saving model ...
Epoch: 11 cost time: 1.1557395458221436
Epoch: 11, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.007 Vali Acc: 0.697 Test Loss: 1.007 Test Acc: 0.697
Validation loss decreased (-0.690779 --> -0.697358).  Saving model ...
Epoch: 12 cost time: 0.9645199775695801
Epoch: 12, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.968 Vali Acc: 0.711 Test Loss: 0.968 Test Acc: 0.711
Validation loss decreased (-0.697358 --> -0.710517).  Saving model ...
Epoch: 13 cost time: 0.9206476211547852
Epoch: 13, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.932 Vali Acc: 0.730 Test Loss: 0.932 Test Acc: 0.730
Validation loss decreased (-0.710517 --> -0.730254).  Saving model ...
Epoch: 14 cost time: 0.8776350021362305
Epoch: 14, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.898 Vali Acc: 0.730 Test Loss: 0.898 Test Acc: 0.730
Validation loss decreased (-0.730254 --> -0.730254).  Saving model ...
Epoch: 15 cost time: 1.0526318550109863
Epoch: 15, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.864 Vali Acc: 0.743 Test Loss: 0.864 Test Acc: 0.743
Validation loss decreased (-0.730254 --> -0.743412).  Saving model ...
Epoch: 16 cost time: 0.9883427619934082
Epoch: 16, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.743412 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 0.9892048835754395
Epoch: 17, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.804 Vali Acc: 0.763 Test Loss: 0.804 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763150).  Saving model ...
Epoch: 18 cost time: 0.9659578800201416
Epoch: 18, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.779 Vali Acc: 0.750 Test Loss: 0.779 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.079857587814331
Epoch: 19, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.757 Vali Acc: 0.750 Test Loss: 0.757 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0454537868499756
Epoch: 20, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1476707458496094
Epoch: 21, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.713 Vali Acc: 0.737 Test Loss: 0.713 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9748015403747559
Epoch: 22, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0217664241790771
Epoch: 23, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 0.9038300514221191
Epoch: 24, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.661 Vali Acc: 0.763 Test Loss: 0.661 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 25 cost time: 0.928924560546875
Epoch: 25, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.643 Vali Acc: 0.770 Test Loss: 0.643 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 26 cost time: 0.9283151626586914
Epoch: 26, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 0.8624839782714844
Epoch: 27, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.0094773769378662
Epoch: 28, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.609 Vali Acc: 0.763 Test Loss: 0.609 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9885411262512207
Epoch: 29, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.601 Vali Acc: 0.757 Test Loss: 0.601 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9330518245697021
Epoch: 30, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.596 Vali Acc: 0.770 Test Loss: 0.596 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.797377347946167
Epoch: 31, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 1.1076936721801758
Epoch: 32, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 0.9792532920837402
Epoch: 33, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 34 cost time: 1.1023995876312256
Epoch: 34, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 35 cost time: 0.9383182525634766
Epoch: 35, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0676078796386719
Epoch: 36, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0761873722076416
Epoch: 37, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 1.114900827407837
Epoch: 38, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0374770164489746
Epoch: 39, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0056748390197754
Epoch: 40, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0533466339111328
Epoch: 41, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8284292221069336
Epoch: 42, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0012195110321045
Epoch: 43, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0328309535980225
Epoch: 44, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9985814094543457
Epoch: 45, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0072298049926758
Epoch: 46, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9559938907623291
Epoch: 47, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 138348
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1004936695098877
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.433 Vali Acc: 0.250 Test Loss: 1.433 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.9205589294433594
Epoch: 2, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.402 Vali Acc: 0.283 Test Loss: 1.402 Test Acc: 0.283
Validation loss decreased (-0.249986 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 0.9365799427032471
Epoch: 3, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.360 Vali Acc: 0.316 Test Loss: 1.360 Test Acc: 0.316
Validation loss decreased (-0.282881 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 0.9320976734161377
Epoch: 4, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.316 Vali Acc: 0.336 Test Loss: 1.316 Test Acc: 0.336
Validation loss decreased (-0.315776 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 0.972642183303833
Epoch: 5, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.269 Vali Acc: 0.434 Test Loss: 1.269 Test Acc: 0.434
Validation loss decreased (-0.335513 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 1.0542066097259521
Epoch: 6, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.216 Vali Acc: 0.480 Test Loss: 1.216 Test Acc: 0.480
Validation loss decreased (-0.434198 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 0.8807034492492676
Epoch: 7, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.166 Vali Acc: 0.533 Test Loss: 1.166 Test Acc: 0.533
Validation loss decreased (-0.480251 --> -0.532883).  Saving model ...
Epoch: 8 cost time: 1.1148972511291504
Epoch: 8, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.116 Vali Acc: 0.559 Test Loss: 1.116 Test Acc: 0.559
Validation loss decreased (-0.532883 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 1.2178099155426025
Epoch: 9, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.068 Vali Acc: 0.592 Test Loss: 1.068 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592095).  Saving model ...
Epoch: 10 cost time: 0.9828896522521973
Epoch: 10, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.017 Vali Acc: 0.625 Test Loss: 1.017 Test Acc: 0.625
Validation loss decreased (-0.592095 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.9493978023529053
Epoch: 11, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.973 Vali Acc: 0.651 Test Loss: 0.973 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651306).  Saving model ...
Epoch: 12 cost time: 1.0383131504058838
Epoch: 12, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.931 Vali Acc: 0.638 Test Loss: 0.931 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8756589889526367
Epoch: 13, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.889 Vali Acc: 0.658 Test Loss: 0.889 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657886).  Saving model ...
Epoch: 14 cost time: 0.9861431121826172
Epoch: 14, Steps: 10 | Train Loss: 0.674 Vali Loss: 0.851 Vali Acc: 0.678 Test Loss: 0.851 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 15 cost time: 1.001662254333496
Epoch: 15, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.819 Vali Acc: 0.684 Test Loss: 0.819 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684202).  Saving model ...
Epoch: 16 cost time: 1.088026523590088
Epoch: 16, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.788 Vali Acc: 0.704 Test Loss: 0.788 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703939).  Saving model ...
Epoch: 17 cost time: 1.0919322967529297
Epoch: 17, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.762 Vali Acc: 0.724 Test Loss: 0.762 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 1.0466351509094238
Epoch: 18, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.738 Vali Acc: 0.730 Test Loss: 0.738 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 1.1338984966278076
Epoch: 19, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 20 cost time: 1.076167345046997
Epoch: 20, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.699 Vali Acc: 0.757 Test Loss: 0.699 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 21 cost time: 1.108963966369629
Epoch: 21, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 22 cost time: 1.1334609985351562
Epoch: 22, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.665 Vali Acc: 0.763 Test Loss: 0.665 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 23 cost time: 1.0496242046356201
Epoch: 23, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.649 Vali Acc: 0.757 Test Loss: 0.649 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0796644687652588
Epoch: 24, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.634 Vali Acc: 0.770 Test Loss: 0.634 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 0.9654932022094727
Epoch: 25, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 1.1221446990966797
Epoch: 26, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 27 cost time: 0.9991321563720703
Epoch: 27, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1009273529052734
Epoch: 28, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9862771034240723
Epoch: 29, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.038851261138916
Epoch: 30, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0656592845916748
Epoch: 31, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0171947479248047
Epoch: 32, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0811097621917725
Epoch: 33, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1477365493774414
Epoch: 34, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0196802616119385
Epoch: 35, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9933977127075195
Epoch: 36, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 72812
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.409064769744873
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.420 Vali Acc: 0.243 Test Loss: 1.420 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.8967535495758057
Epoch: 2, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
Validation loss decreased (-0.243407 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.1117193698883057
Epoch: 3, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.355 Vali Acc: 0.342 Test Loss: 1.355 Test Acc: 0.342
Validation loss decreased (-0.269723 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.1676347255706787
Epoch: 4, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.312 Vali Acc: 0.408 Test Loss: 1.312 Test Acc: 0.408
Validation loss decreased (-0.342092 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 0.8873443603515625
Epoch: 5, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.267 Vali Acc: 0.428 Test Loss: 1.267 Test Acc: 0.428
Validation loss decreased (-0.407882 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 1.0933966636657715
Epoch: 6, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.216 Vali Acc: 0.493 Test Loss: 1.216 Test Acc: 0.493
Validation loss decreased (-0.427619 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 0.9797630310058594
Epoch: 7, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.166 Vali Acc: 0.507 Test Loss: 1.166 Test Acc: 0.507
Validation loss decreased (-0.493409 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 1.1114211082458496
Epoch: 8, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.117 Vali Acc: 0.546 Test Loss: 1.117 Test Acc: 0.546
Validation loss decreased (-0.506567 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 0.985992431640625
Epoch: 9, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.071 Vali Acc: 0.586 Test Loss: 1.071 Test Acc: 0.586
Validation loss decreased (-0.546041 --> -0.585516).  Saving model ...
Epoch: 10 cost time: 0.9862749576568604
Epoch: 10, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.020 Vali Acc: 0.599 Test Loss: 1.020 Test Acc: 0.599
Validation loss decreased (-0.585516 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 1.0594592094421387
Epoch: 11, Steps: 10 | Train Loss: 0.809 Vali Loss: 0.978 Vali Acc: 0.618 Test Loss: 0.978 Test Acc: 0.618
Validation loss decreased (-0.598674 --> -0.618411).  Saving model ...
Epoch: 12 cost time: 1.0580296516418457
Epoch: 12, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.936 Vali Acc: 0.632 Test Loss: 0.936 Test Acc: 0.632
Validation loss decreased (-0.618411 --> -0.631570).  Saving model ...
Epoch: 13 cost time: 1.0179753303527832
Epoch: 13, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.895 Vali Acc: 0.671 Test Loss: 0.895 Test Acc: 0.671
Validation loss decreased (-0.631570 --> -0.671044).  Saving model ...
Epoch: 14 cost time: 0.9884448051452637
Epoch: 14, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.855 Vali Acc: 0.684 Test Loss: 0.855 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684202).  Saving model ...
Epoch: 15 cost time: 0.926929235458374
Epoch: 15, Steps: 10 | Train Loss: 0.639 Vali Loss: 0.823 Vali Acc: 0.711 Test Loss: 0.823 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710518).  Saving model ...
Epoch: 16 cost time: 0.9814190864562988
Epoch: 16, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.788 Vali Acc: 0.724 Test Loss: 0.788 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723676).  Saving model ...
Epoch: 17 cost time: 0.8962497711181641
Epoch: 17, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.765 Vali Acc: 0.724 Test Loss: 0.765 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 0.9462268352508545
Epoch: 18, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.742 Vali Acc: 0.737 Test Loss: 0.742 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 19 cost time: 1.1111254692077637
Epoch: 19, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.723 Vali Acc: 0.750 Test Loss: 0.723 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 1.0395147800445557
Epoch: 20, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.706 Vali Acc: 0.737 Test Loss: 0.706 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.055281639099121
Epoch: 21, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.688 Vali Acc: 0.743 Test Loss: 0.688 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9638917446136475
Epoch: 22, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.670 Vali Acc: 0.757 Test Loss: 0.670 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 23 cost time: 0.9677717685699463
Epoch: 23, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.655 Vali Acc: 0.750 Test Loss: 0.655 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.948603630065918
Epoch: 24, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.639 Vali Acc: 0.763 Test Loss: 0.639 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 25 cost time: 0.9847793579101562
Epoch: 25, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1646997928619385
Epoch: 26, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.613 Vali Acc: 0.757 Test Loss: 0.613 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0845723152160645
Epoch: 27, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 28 cost time: 0.9801797866821289
Epoch: 28, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 29 cost time: 0.7913916110992432
Epoch: 29, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.056549072265625
Epoch: 30, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 1.0514719486236572
Epoch: 31, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 32 cost time: 0.9580612182617188
Epoch: 32, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.572 Vali Acc: 0.776 Test Loss: 0.572 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8883836269378662
Epoch: 33, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9358954429626465
Epoch: 34, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 35 cost time: 0.8224670886993408
Epoch: 35, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8551440238952637
Epoch: 36, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9222590923309326
Epoch: 37, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0650293827056885
Epoch: 38, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9643213748931885
Epoch: 39, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0000410079956055
Epoch: 40, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.546 Vali Acc: 0.770 Test Loss: 0.546 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0121190547943115
Epoch: 41, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0297808647155762
Epoch: 42, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 43 cost time: 1.0483856201171875
Epoch: 43, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.550 Vali Acc: 0.789 Test Loss: 0.550 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 44 cost time: 0.9686205387115479
Epoch: 44, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9644911289215088
Epoch: 45, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0096750259399414
Epoch: 46, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9970555305480957
Epoch: 47, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0025486946105957
Epoch: 48, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9480676651000977
Epoch: 49, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9820668697357178
Epoch: 50, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.0225389003753662
Epoch: 51, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 52 cost time: 0.958918571472168
Epoch: 52, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0537645816802979
Epoch: 53, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0371489524841309
Epoch: 54, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8779780864715576
Epoch: 55, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.853729248046875
Epoch: 56, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.93107008934021
Epoch: 57, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.9871270656585693
Epoch: 58, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9844386577606201
Epoch: 59, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.004957675933838
Epoch: 60, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.963942289352417
Epoch: 61, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 72812
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2376129627227783
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.418 Vali Acc: 0.211 Test Loss: 1.418 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 0.8750944137573242
Epoch: 2, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.392 Vali Acc: 0.243 Test Loss: 1.392 Test Acc: 0.243
Validation loss decreased (-0.210512 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 0.9853510856628418
Epoch: 3, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.356 Vali Acc: 0.303 Test Loss: 1.356 Test Acc: 0.303
Validation loss decreased (-0.243407 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 1.0412144660949707
Epoch: 4, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.316 Vali Acc: 0.322 Test Loss: 1.316 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 5 cost time: 1.030883550643921
Epoch: 5, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.274 Vali Acc: 0.395 Test Loss: 1.274 Test Acc: 0.395
Validation loss decreased (-0.322355 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 0.9499280452728271
Epoch: 6, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.226 Vali Acc: 0.421 Test Loss: 1.226 Test Acc: 0.421
Validation loss decreased (-0.394724 --> -0.421040).  Saving model ...
Epoch: 7 cost time: 1.0412061214447021
Epoch: 7, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.179 Vali Acc: 0.467 Test Loss: 1.179 Test Acc: 0.467
Validation loss decreased (-0.421040 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 1.1477015018463135
Epoch: 8, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (-0.467093 --> -0.532883).  Saving model ...
Epoch: 9 cost time: 1.0780572891235352
Epoch: 9, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.086 Vali Acc: 0.599 Test Loss: 1.086 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598673).  Saving model ...
Epoch: 10 cost time: 1.0349793434143066
Epoch: 10, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.040 Vali Acc: 0.605 Test Loss: 1.040 Test Acc: 0.605
Validation loss decreased (-0.598673 --> -0.605253).  Saving model ...
Epoch: 11 cost time: 0.9839174747467041
Epoch: 11, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.996 Vali Acc: 0.651 Test Loss: 0.996 Test Acc: 0.651
Validation loss decreased (-0.605253 --> -0.651306).  Saving model ...
Epoch: 12 cost time: 0.9667363166809082
Epoch: 12, Steps: 10 | Train Loss: 0.835 Vali Loss: 0.954 Vali Acc: 0.671 Test Loss: 0.954 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671043).  Saving model ...
Epoch: 13 cost time: 1.024104118347168
Epoch: 13, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.916 Vali Acc: 0.697 Test Loss: 0.916 Test Acc: 0.697
Validation loss decreased (-0.671043 --> -0.697359).  Saving model ...
Epoch: 14 cost time: 1.0357568264007568
Epoch: 14, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.876 Vali Acc: 0.717 Test Loss: 0.876 Test Acc: 0.717
Validation loss decreased (-0.697359 --> -0.717097).  Saving model ...
Epoch: 15 cost time: 1.0500545501708984
Epoch: 15, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.845 Vali Acc: 0.743 Test Loss: 0.845 Test Acc: 0.743
Validation loss decreased (-0.717097 --> -0.743413).  Saving model ...
Epoch: 16 cost time: 1.0286896228790283
Epoch: 16, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.816 Vali Acc: 0.757 Test Loss: 0.816 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756571).  Saving model ...
Epoch: 17 cost time: 1.0760796070098877
Epoch: 17, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.787 Vali Acc: 0.757 Test Loss: 0.787 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756571).  Saving model ...
Epoch: 18 cost time: 0.9169888496398926
Epoch: 18, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.762 Vali Acc: 0.750 Test Loss: 0.762 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9758238792419434
Epoch: 19, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.740 Vali Acc: 0.743 Test Loss: 0.740 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9436807632446289
Epoch: 20, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0077590942382812
Epoch: 21, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.697 Vali Acc: 0.757 Test Loss: 0.697 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756572).  Saving model ...
Epoch: 22 cost time: 0.9485821723937988
Epoch: 22, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8902935981750488
Epoch: 23, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.670 Vali Acc: 0.757 Test Loss: 0.670 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 24 cost time: 0.9047489166259766
Epoch: 24, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.654 Vali Acc: 0.770 Test Loss: 0.654 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 0.9703173637390137
Epoch: 25, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 26 cost time: 1.0542206764221191
Epoch: 26, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.627 Vali Acc: 0.770 Test Loss: 0.627 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 1.0683348178863525
Epoch: 27, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.619 Vali Acc: 0.770 Test Loss: 0.619 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 28 cost time: 0.8185980319976807
Epoch: 28, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 29 cost time: 1.0764617919921875
Epoch: 29, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 0.9369058609008789
Epoch: 30, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 31 cost time: 1.0666453838348389
Epoch: 31, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9887673854827881
Epoch: 32, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0023977756500244
Epoch: 33, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 1.0553357601165771
Epoch: 34, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 1.0196056365966797
Epoch: 35, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 36 cost time: 1.0491020679473877
Epoch: 36, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 37 cost time: 1.0245599746704102
Epoch: 37, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 0.9611802101135254
Epoch: 38, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 39 cost time: 0.9717187881469727
Epoch: 39, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 40 cost time: 0.9766039848327637
Epoch: 40, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 41 cost time: 0.8827643394470215
Epoch: 41, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 42 cost time: 1.0063211917877197
Epoch: 42, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0856022834777832
Epoch: 43, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.001389980316162
Epoch: 44, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9387040138244629
Epoch: 45, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 46 cost time: 0.8953409194946289
Epoch: 46, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9458951950073242
Epoch: 47, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9516382217407227
Epoch: 48, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9016180038452148
Epoch: 49, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9698688983917236
Epoch: 50, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0032525062561035
Epoch: 51, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.8230807781219482
Epoch: 52, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.8735196590423584
Epoch: 53, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.9994723796844482
Epoch: 54, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9804565906524658
Epoch: 55, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 72812
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.311044216156006
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.442 Vali Acc: 0.178 Test Loss: 1.442 Test Acc: 0.178
Validation loss decreased (inf --> -0.177617).  Saving model ...
Epoch: 2 cost time: 0.9240257740020752
Epoch: 2, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.420 Vali Acc: 0.184 Test Loss: 1.420 Test Acc: 0.184
Validation loss decreased (-0.177617 --> -0.184196).  Saving model ...
Epoch: 3 cost time: 0.8786230087280273
Epoch: 3, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.390 Vali Acc: 0.263 Test Loss: 1.390 Test Acc: 0.263
Validation loss decreased (-0.184196 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 0.8173606395721436
Epoch: 4, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.354 Vali Acc: 0.355 Test Loss: 1.354 Test Acc: 0.355
Validation loss decreased (-0.263144 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 0.922299861907959
Epoch: 5, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.317 Vali Acc: 0.421 Test Loss: 1.317 Test Acc: 0.421
Validation loss decreased (-0.355250 --> -0.421039).  Saving model ...
Epoch: 6 cost time: 1.0229716300964355
Epoch: 6, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.277 Vali Acc: 0.487 Test Loss: 1.277 Test Acc: 0.487
Validation loss decreased (-0.421039 --> -0.486829).  Saving model ...
Epoch: 7 cost time: 0.884122371673584
Epoch: 7, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.236 Vali Acc: 0.526 Test Loss: 1.236 Test Acc: 0.526
Validation loss decreased (-0.486829 --> -0.526303).  Saving model ...
Epoch: 8 cost time: 0.9171061515808105
Epoch: 8, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.195 Vali Acc: 0.572 Test Loss: 1.195 Test Acc: 0.572
Validation loss decreased (-0.526303 --> -0.572356).  Saving model ...
Epoch: 9 cost time: 0.9876487255096436
Epoch: 9, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.154 Vali Acc: 0.618 Test Loss: 1.154 Test Acc: 0.618
Validation loss decreased (-0.572356 --> -0.618410).  Saving model ...
Epoch: 10 cost time: 1.120884656906128
Epoch: 10, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.113 Vali Acc: 0.632 Test Loss: 1.113 Test Acc: 0.632
Validation loss decreased (-0.618410 --> -0.631568).  Saving model ...
Epoch: 11 cost time: 0.7591104507446289
Epoch: 11, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.073 Vali Acc: 0.658 Test Loss: 1.073 Test Acc: 0.658
Validation loss decreased (-0.631568 --> -0.657884).  Saving model ...
Epoch: 12 cost time: 0.8396291732788086
Epoch: 12, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.035 Vali Acc: 0.658 Test Loss: 1.035 Test Acc: 0.658
Validation loss decreased (-0.657884 --> -0.657884).  Saving model ...
Epoch: 13 cost time: 0.9097423553466797
Epoch: 13, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.997 Vali Acc: 0.671 Test Loss: 0.997 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671043).  Saving model ...
Epoch: 14 cost time: 0.9240329265594482
Epoch: 14, Steps: 10 | Train Loss: 0.818 Vali Loss: 0.960 Vali Acc: 0.671 Test Loss: 0.960 Test Acc: 0.671
Validation loss decreased (-0.671043 --> -0.671043).  Saving model ...
Epoch: 15 cost time: 0.935014009475708
Epoch: 15, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.928 Vali Acc: 0.678 Test Loss: 0.928 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677622).  Saving model ...
Epoch: 16 cost time: 0.9263739585876465
Epoch: 16, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.897 Vali Acc: 0.684 Test Loss: 0.897 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 1.0176165103912354
Epoch: 17, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.870 Vali Acc: 0.697 Test Loss: 0.870 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697360).  Saving model ...
Epoch: 18 cost time: 0.869713306427002
Epoch: 18, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.836 Vali Acc: 0.697 Test Loss: 0.836 Test Acc: 0.697
Validation loss decreased (-0.697360 --> -0.697360).  Saving model ...
Epoch: 19 cost time: 0.966834545135498
Epoch: 19, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.814 Vali Acc: 0.704 Test Loss: 0.814 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703939).  Saving model ...
Epoch: 20 cost time: 1.038853645324707
Epoch: 20, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.790 Vali Acc: 0.704 Test Loss: 0.790 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 21 cost time: 0.8562009334564209
Epoch: 21, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.768 Vali Acc: 0.724 Test Loss: 0.768 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 22 cost time: 0.9434797763824463
Epoch: 22, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.747 Vali Acc: 0.724 Test Loss: 0.747 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 23 cost time: 0.9303174018859863
Epoch: 23, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.730 Vali Acc: 0.737 Test Loss: 0.730 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 24 cost time: 1.0069115161895752
Epoch: 24, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.711 Vali Acc: 0.743 Test Loss: 0.711 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 25 cost time: 0.9970636367797852
Epoch: 25, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9426467418670654
Epoch: 26, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.680 Vali Acc: 0.730 Test Loss: 0.680 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9774596691131592
Epoch: 27, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.671 Vali Acc: 0.743 Test Loss: 0.671 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 28 cost time: 0.9593620300292969
Epoch: 28, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 1.020848035812378
Epoch: 29, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 30 cost time: 0.9377048015594482
Epoch: 30, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.637 Vali Acc: 0.757 Test Loss: 0.637 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 31 cost time: 0.9684572219848633
Epoch: 31, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.631 Vali Acc: 0.743 Test Loss: 0.631 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9535629749298096
Epoch: 32, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.627 Vali Acc: 0.750 Test Loss: 0.627 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8776106834411621
Epoch: 33, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.625 Vali Acc: 0.743 Test Loss: 0.625 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8031563758850098
Epoch: 34, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.069488763809204
Epoch: 35, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.623 Vali Acc: 0.763 Test Loss: 0.623 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 36 cost time: 0.9747445583343506
Epoch: 36, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.615 Vali Acc: 0.757 Test Loss: 0.615 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9297714233398438
Epoch: 37, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.614 Vali Acc: 0.763 Test Loss: 0.614 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 38 cost time: 1.0678558349609375
Epoch: 38, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.616 Vali Acc: 0.763 Test Loss: 0.616 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.859060525894165
Epoch: 39, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9153993129730225
Epoch: 40, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9467012882232666
Epoch: 41, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.608 Vali Acc: 0.743 Test Loss: 0.608 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9061832427978516
Epoch: 42, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.610 Vali Acc: 0.757 Test Loss: 0.610 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9763491153717041
Epoch: 43, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.612 Vali Acc: 0.770 Test Loss: 0.612 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 44 cost time: 0.8625705242156982
Epoch: 44, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.613 Vali Acc: 0.776 Test Loss: 0.613 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 45 cost time: 0.9048972129821777
Epoch: 45, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0216035842895508
Epoch: 46, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0096876621246338
Epoch: 47, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.610 Vali Acc: 0.757 Test Loss: 0.610 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9545748233795166
Epoch: 48, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8865621089935303
Epoch: 49, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.609 Vali Acc: 0.763 Test Loss: 0.609 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0655698776245117
Epoch: 50, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.608 Vali Acc: 0.776 Test Loss: 0.608 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 51 cost time: 0.9740161895751953
Epoch: 51, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 52 cost time: 1.0953283309936523
Epoch: 52, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.606 Vali Acc: 0.770 Test Loss: 0.606 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.065239667892456
Epoch: 53, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.611 Vali Acc: 0.763 Test Loss: 0.611 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9933509826660156
Epoch: 54, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.623 Vali Acc: 0.763 Test Loss: 0.623 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9421718120574951
Epoch: 55, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.627 Vali Acc: 0.776 Test Loss: 0.627 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9646689891815186
Epoch: 56, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9913980960845947
Epoch: 57, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.626 Vali Acc: 0.757 Test Loss: 0.626 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.9077804088592529
Epoch: 58, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.0388998985290527
Epoch: 59, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.943004846572876
Epoch: 60, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.631 Vali Acc: 0.763 Test Loss: 0.631 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.9759726524353027
Epoch: 61, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.636 Vali Acc: 0.763 Test Loss: 0.636 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 72812
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1646804809570312
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.411 Vali Acc: 0.257 Test Loss: 1.411 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 0.9026064872741699
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.384 Vali Acc: 0.289 Test Loss: 1.384 Test Acc: 0.289
Validation loss decreased (-0.256565 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 0.9833114147186279
Epoch: 3, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.346 Vali Acc: 0.336 Test Loss: 1.346 Test Acc: 0.336
Validation loss decreased (-0.289460 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 0.8677201271057129
Epoch: 4, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.303 Vali Acc: 0.421 Test Loss: 1.303 Test Acc: 0.421
Validation loss decreased (-0.335513 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 0.9991281032562256
Epoch: 5, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.257 Vali Acc: 0.467 Test Loss: 1.257 Test Acc: 0.467
Validation loss decreased (-0.421040 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 0.971365213394165
Epoch: 6, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.211 Vali Acc: 0.507 Test Loss: 1.211 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.0348589420318604
Epoch: 7, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.160 Vali Acc: 0.507 Test Loss: 1.160 Test Acc: 0.507
Validation loss decreased (-0.506567 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 1.0158157348632812
Epoch: 8, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.109 Vali Acc: 0.559 Test Loss: 1.109 Test Acc: 0.559
Validation loss decreased (-0.506567 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 0.8851587772369385
Epoch: 9, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.059 Vali Acc: 0.559 Test Loss: 1.059 Test Acc: 0.559
Validation loss decreased (-0.559199 --> -0.559200).  Saving model ...
Epoch: 10 cost time: 0.868565559387207
Epoch: 10, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.012 Vali Acc: 0.572 Test Loss: 1.012 Test Acc: 0.572
Validation loss decreased (-0.559200 --> -0.572358).  Saving model ...
Epoch: 11 cost time: 0.9972245693206787
Epoch: 11, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.967 Vali Acc: 0.605 Test Loss: 0.967 Test Acc: 0.605
Validation loss decreased (-0.572358 --> -0.605253).  Saving model ...
Epoch: 12 cost time: 0.9617693424224854
Epoch: 12, Steps: 10 | Train Loss: 0.741 Vali Loss: 0.925 Vali Acc: 0.618 Test Loss: 0.925 Test Acc: 0.618
Validation loss decreased (-0.605253 --> -0.618412).  Saving model ...
Epoch: 13 cost time: 0.8399810791015625
Epoch: 13, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.881 Vali Acc: 0.625 Test Loss: 0.881 Test Acc: 0.625
Validation loss decreased (-0.618412 --> -0.624991).  Saving model ...
Epoch: 14 cost time: 0.7910056114196777
Epoch: 14, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.841 Vali Acc: 0.645 Test Loss: 0.841 Test Acc: 0.645
Validation loss decreased (-0.624991 --> -0.644728).  Saving model ...
Epoch: 15 cost time: 0.9657437801361084
Epoch: 15, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.807 Vali Acc: 0.664 Test Loss: 0.807 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664466).  Saving model ...
Epoch: 16 cost time: 0.8221123218536377
Epoch: 16, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.779 Vali Acc: 0.684 Test Loss: 0.779 Test Acc: 0.684
Validation loss decreased (-0.664466 --> -0.684203).  Saving model ...
Epoch: 17 cost time: 0.8725569248199463
Epoch: 17, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.752 Vali Acc: 0.724 Test Loss: 0.752 Test Acc: 0.724
Validation loss decreased (-0.684203 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 0.9270834922790527
Epoch: 18, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.727 Vali Acc: 0.730 Test Loss: 0.727 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 1.020737648010254
Epoch: 19, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.707 Vali Acc: 0.730 Test Loss: 0.707 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 20 cost time: 0.9558987617492676
Epoch: 20, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 0.9496109485626221
Epoch: 21, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 22 cost time: 1.0647149085998535
Epoch: 22, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.651 Vali Acc: 0.757 Test Loss: 0.651 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 23 cost time: 1.0296156406402588
Epoch: 23, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.636 Vali Acc: 0.743 Test Loss: 0.636 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9395434856414795
Epoch: 24, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.622 Vali Acc: 0.757 Test Loss: 0.622 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 25 cost time: 0.9407176971435547
Epoch: 25, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 0.969520092010498
Epoch: 26, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 0.9448609352111816
Epoch: 27, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.0755062103271484
Epoch: 28, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.580 Vali Acc: 0.770 Test Loss: 0.580 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0211851596832275
Epoch: 29, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 1.0659549236297607
Epoch: 30, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 1.046327829360962
Epoch: 31, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 1.0116584300994873
Epoch: 32, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 0.9707551002502441
Epoch: 33, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 34 cost time: 1.0603835582733154
Epoch: 34, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9381787776947021
Epoch: 35, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9845461845397949
Epoch: 36, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.98227858543396
Epoch: 37, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9427306652069092
Epoch: 38, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 39 cost time: 1.066727638244629
Epoch: 39, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 40 cost time: 0.8204946517944336
Epoch: 40, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9963805675506592
Epoch: 41, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 42 cost time: 1.0088882446289062
Epoch: 42, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0832436084747314
Epoch: 43, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0808627605438232
Epoch: 44, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8851408958435059
Epoch: 45, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0447747707366943
Epoch: 46, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9651393890380859
Epoch: 47, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.022242546081543
Epoch: 48, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9786093235015869
Epoch: 49, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 50 cost time: 1.0275540351867676
Epoch: 50, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 51 cost time: 0.9531333446502686
Epoch: 51, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0479400157928467
Epoch: 52, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0923314094543457
Epoch: 53, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0980782508850098
Epoch: 54, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.062511920928955
Epoch: 55, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9979979991912842
Epoch: 56, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.0556659698486328
Epoch: 57, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.027597188949585
Epoch: 58, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.9588124752044678
Epoch: 59, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.085425615310669
Epoch: 60, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 40044
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.153071880340576
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.397 Vali Acc: 0.276 Test Loss: 1.397 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.0604660511016846
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.372 Vali Acc: 0.309 Test Loss: 1.372 Test Acc: 0.309
Validation loss decreased (-0.276302 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.9540166854858398
Epoch: 3, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.337 Vali Acc: 0.329 Test Loss: 1.337 Test Acc: 0.329
Validation loss decreased (-0.309197 --> -0.328934).  Saving model ...
Epoch: 4 cost time: 1.0874934196472168
Epoch: 4, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.296 Vali Acc: 0.388 Test Loss: 1.296 Test Acc: 0.388
Validation loss decreased (-0.328934 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 0.9321193695068359
Epoch: 5, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.253 Vali Acc: 0.421 Test Loss: 1.253 Test Acc: 0.421
Validation loss decreased (-0.388145 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 1.0368752479553223
Epoch: 6, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.208 Vali Acc: 0.480 Test Loss: 1.208 Test Acc: 0.480
Validation loss decreased (-0.421040 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 0.9267323017120361
Epoch: 7, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.158 Vali Acc: 0.513 Test Loss: 1.158 Test Acc: 0.513
Validation loss decreased (-0.480251 --> -0.513146).  Saving model ...
Epoch: 8 cost time: 0.9968786239624023
Epoch: 8, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.110 Vali Acc: 0.553 Test Loss: 1.110 Test Acc: 0.553
Validation loss decreased (-0.513146 --> -0.552620).  Saving model ...
Epoch: 9 cost time: 0.9952526092529297
Epoch: 9, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.062 Vali Acc: 0.586 Test Loss: 1.062 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585516).  Saving model ...
Epoch: 10 cost time: 0.7958984375
Epoch: 10, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.016 Vali Acc: 0.612 Test Loss: 1.016 Test Acc: 0.612
Validation loss decreased (-0.585516 --> -0.611832).  Saving model ...
Epoch: 11 cost time: 0.857515811920166
Epoch: 11, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.970 Vali Acc: 0.599 Test Loss: 0.970 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.050105094909668
Epoch: 12, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.926 Vali Acc: 0.625 Test Loss: 0.926 Test Acc: 0.625
Validation loss decreased (-0.611832 --> -0.624991).  Saving model ...
Epoch: 13 cost time: 1.1044538021087646
Epoch: 13, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.882 Vali Acc: 0.671 Test Loss: 0.882 Test Acc: 0.671
Validation loss decreased (-0.624991 --> -0.671044).  Saving model ...
Epoch: 14 cost time: 0.9734156131744385
Epoch: 14, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.841 Vali Acc: 0.678 Test Loss: 0.841 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677623).  Saving model ...
Epoch: 15 cost time: 0.9571468830108643
Epoch: 15, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.809 Vali Acc: 0.684 Test Loss: 0.809 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684202).  Saving model ...
Epoch: 16 cost time: 0.8628156185150146
Epoch: 16, Steps: 10 | Train Loss: 0.578 Vali Loss: 0.775 Vali Acc: 0.704 Test Loss: 0.775 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 1.055408000946045
Epoch: 17, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.745 Vali Acc: 0.737 Test Loss: 0.745 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736835).  Saving model ...
Epoch: 18 cost time: 0.8809108734130859
Epoch: 18, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.720 Vali Acc: 0.730 Test Loss: 0.720 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.901324987411499
Epoch: 19, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.699 Vali Acc: 0.737 Test Loss: 0.699 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 20 cost time: 0.7929337024688721
Epoch: 20, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.676 Vali Acc: 0.737 Test Loss: 0.676 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 0.9746606349945068
Epoch: 21, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.656 Vali Acc: 0.737 Test Loss: 0.656 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 22 cost time: 0.9777283668518066
Epoch: 22, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.638 Vali Acc: 0.763 Test Loss: 0.638 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 0.9983437061309814
Epoch: 23, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.021984338760376
Epoch: 24, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.609 Vali Acc: 0.750 Test Loss: 0.609 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0709338188171387
Epoch: 25, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.596 Vali Acc: 0.743 Test Loss: 0.596 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0874345302581787
Epoch: 26, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.584 Vali Acc: 0.763 Test Loss: 0.584 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 1.0945439338684082
Epoch: 27, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.082878828048706
Epoch: 28, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 29 cost time: 0.9974648952484131
Epoch: 29, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 1.010171890258789
Epoch: 30, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.548 Vali Acc: 0.776 Test Loss: 0.548 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 0.9331881999969482
Epoch: 31, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.537 Vali Acc: 0.776 Test Loss: 0.537 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 0.9511427879333496
Epoch: 32, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 33 cost time: 0.9290997982025146
Epoch: 33, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 34 cost time: 0.9727799892425537
Epoch: 34, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9665908813476562
Epoch: 35, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0536024570465088
Epoch: 36, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0306622982025146
Epoch: 37, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8991224765777588
Epoch: 38, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8713972568511963
Epoch: 39, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 40 cost time: 0.9467048645019531
Epoch: 40, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.896937370300293
Epoch: 41, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8297040462493896
Epoch: 42, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 43 cost time: 0.9634919166564941
Epoch: 43, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9108381271362305
Epoch: 44, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9285578727722168
Epoch: 45, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9377102851867676
Epoch: 46, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 47 cost time: 1.1501214504241943
Epoch: 47, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 48 cost time: 0.9704570770263672
Epoch: 48, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9468917846679688
Epoch: 49, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.94219970703125
Epoch: 50, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8671309947967529
Epoch: 51, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0228538513183594
Epoch: 52, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0496366024017334
Epoch: 53, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.971015214920044
Epoch: 54, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.9912986755371094
Epoch: 55, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.0098848342895508
Epoch: 56, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.0373437404632568
Epoch: 57, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 40044
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1282362937927246
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.381 Vali Acc: 0.243 Test Loss: 1.381 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.9341466426849365
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.359 Vali Acc: 0.289 Test Loss: 1.359 Test Acc: 0.289
Validation loss decreased (-0.243407 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 0.8760049343109131
Epoch: 3, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.326 Vali Acc: 0.362 Test Loss: 1.326 Test Acc: 0.362
Validation loss decreased (-0.289460 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 0.8358755111694336
Epoch: 4, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.288 Vali Acc: 0.414 Test Loss: 1.288 Test Acc: 0.414
Validation loss decreased (-0.361829 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.0641727447509766
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.248 Vali Acc: 0.447 Test Loss: 1.248 Test Acc: 0.447
Validation loss decreased (-0.414461 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 0.9319472312927246
Epoch: 6, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.447356 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7882788181304932
Epoch: 7, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.152 Vali Acc: 0.546 Test Loss: 1.152 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546041).  Saving model ...
Epoch: 8 cost time: 0.966566801071167
Epoch: 8, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.107 Vali Acc: 0.559 Test Loss: 1.107 Test Acc: 0.559
Validation loss decreased (-0.546041 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 0.9337863922119141
Epoch: 9, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.064 Vali Acc: 0.572 Test Loss: 1.064 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572358).  Saving model ...
Epoch: 10 cost time: 0.9920501708984375
Epoch: 10, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.021 Vali Acc: 0.605 Test Loss: 1.021 Test Acc: 0.605
Validation loss decreased (-0.572358 --> -0.605253).  Saving model ...
Epoch: 11 cost time: 0.8947937488555908
Epoch: 11, Steps: 10 | Train Loss: 0.871 Vali Loss: 0.976 Vali Acc: 0.625 Test Loss: 0.976 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 0.9513218402862549
Epoch: 12, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.932 Vali Acc: 0.638 Test Loss: 0.932 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638149).  Saving model ...
Epoch: 13 cost time: 0.9380226135253906
Epoch: 13, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.893 Vali Acc: 0.651 Test Loss: 0.893 Test Acc: 0.651
Validation loss decreased (-0.638149 --> -0.651307).  Saving model ...
Epoch: 14 cost time: 1.0086338520050049
Epoch: 14, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.855 Vali Acc: 0.678 Test Loss: 0.855 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 15 cost time: 0.8079588413238525
Epoch: 15, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.820 Vali Acc: 0.678 Test Loss: 0.820 Test Acc: 0.678
Validation loss decreased (-0.677623 --> -0.677623).  Saving model ...
Epoch: 16 cost time: 0.901766300201416
Epoch: 16, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.791 Vali Acc: 0.704 Test Loss: 0.791 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703939).  Saving model ...
Epoch: 17 cost time: 0.8614950180053711
Epoch: 17, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.764 Vali Acc: 0.743 Test Loss: 0.764 Test Acc: 0.743
Validation loss decreased (-0.703939 --> -0.743413).  Saving model ...
Epoch: 18 cost time: 0.98386549949646
Epoch: 18, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.739 Vali Acc: 0.743 Test Loss: 0.739 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 0.862246036529541
Epoch: 19, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.717 Vali Acc: 0.730 Test Loss: 0.717 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8979055881500244
Epoch: 20, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.692 Vali Acc: 0.757 Test Loss: 0.692 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 21 cost time: 0.9048843383789062
Epoch: 21, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.671 Vali Acc: 0.757 Test Loss: 0.671 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 22 cost time: 0.9543697834014893
Epoch: 22, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.652 Vali Acc: 0.763 Test Loss: 0.652 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 23 cost time: 0.8713674545288086
Epoch: 23, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.636 Vali Acc: 0.763 Test Loss: 0.636 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 0.8863205909729004
Epoch: 24, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 25 cost time: 1.031874179840088
Epoch: 25, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.608 Vali Acc: 0.770 Test Loss: 0.608 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 0.9556849002838135
Epoch: 26, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 0.9754645824432373
Epoch: 27, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 0.9935448169708252
Epoch: 28, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0004734992980957
Epoch: 29, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 0.993995189666748
Epoch: 30, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 31 cost time: 0.9452853202819824
Epoch: 31, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 0.9949648380279541
Epoch: 32, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 33 cost time: 0.9678857326507568
Epoch: 33, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 34 cost time: 0.9189093112945557
Epoch: 34, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0794320106506348
Epoch: 35, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0857887268066406
Epoch: 36, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0595786571502686
Epoch: 37, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0017380714416504
Epoch: 38, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.860374927520752
Epoch: 39, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 40 cost time: 0.9019787311553955
Epoch: 40, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0255272388458252
Epoch: 41, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9070537090301514
Epoch: 42, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8937516212463379
Epoch: 43, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9133703708648682
Epoch: 44, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8947122097015381
Epoch: 45, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8494298458099365
Epoch: 46, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 47 cost time: 0.8575093746185303
Epoch: 47, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8858275413513184
Epoch: 48, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 49 cost time: 0.8502845764160156
Epoch: 49, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9608700275421143
Epoch: 50, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 51 cost time: 1.0132238864898682
Epoch: 51, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9809703826904297
Epoch: 52, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9919681549072266
Epoch: 53, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8273658752441406
Epoch: 54, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.953279972076416
Epoch: 55, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.0467703342437744
Epoch: 56, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.0837907791137695
Epoch: 57, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.0652174949645996
Epoch: 58, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.001770257949829
Epoch: 59, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.802159309387207
Epoch: 60, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 40044
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1344940662384033
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.371 Vali Acc: 0.283 Test Loss: 1.371 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.9383914470672607
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.351 Vali Acc: 0.336 Test Loss: 1.351 Test Acc: 0.336
Validation loss decreased (-0.282881 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.0082504749298096
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.322 Vali Acc: 0.349 Test Loss: 1.322 Test Acc: 0.349
Validation loss decreased (-0.335513 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 0.8942091464996338
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.290 Vali Acc: 0.395 Test Loss: 1.290 Test Acc: 0.395
Validation loss decreased (-0.348671 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 0.9253818988800049
Epoch: 5, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.254 Vali Acc: 0.447 Test Loss: 1.254 Test Acc: 0.447
Validation loss decreased (-0.394724 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 0.8747475147247314
Epoch: 6, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.215 Vali Acc: 0.474 Test Loss: 1.215 Test Acc: 0.474
Validation loss decreased (-0.447356 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 0.9429421424865723
Epoch: 7, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.171 Vali Acc: 0.513 Test Loss: 1.171 Test Acc: 0.513
Validation loss decreased (-0.473672 --> -0.513146).  Saving model ...
Epoch: 8 cost time: 0.9782063961029053
Epoch: 8, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.130 Vali Acc: 0.566 Test Loss: 1.130 Test Acc: 0.566
Validation loss decreased (-0.513146 --> -0.565778).  Saving model ...
Epoch: 9 cost time: 0.9443399906158447
Epoch: 9, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.090 Vali Acc: 0.586 Test Loss: 1.090 Test Acc: 0.586
Validation loss decreased (-0.565778 --> -0.585515).  Saving model ...
Epoch: 10 cost time: 0.9462273120880127
Epoch: 10, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.050 Vali Acc: 0.612 Test Loss: 1.050 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611832).  Saving model ...
Epoch: 11 cost time: 0.8931410312652588
Epoch: 11, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.010 Vali Acc: 0.638 Test Loss: 1.010 Test Acc: 0.638
Validation loss decreased (-0.611832 --> -0.638148).  Saving model ...
Epoch: 12 cost time: 0.9014894962310791
Epoch: 12, Steps: 10 | Train Loss: 0.905 Vali Loss: 0.972 Vali Acc: 0.671 Test Loss: 0.972 Test Acc: 0.671
Validation loss decreased (-0.638148 --> -0.671043).  Saving model ...
Epoch: 13 cost time: 0.8440496921539307
Epoch: 13, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.935 Vali Acc: 0.684 Test Loss: 0.935 Test Acc: 0.684
Validation loss decreased (-0.671043 --> -0.684201).  Saving model ...
Epoch: 14 cost time: 0.979741096496582
Epoch: 14, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.901 Vali Acc: 0.697 Test Loss: 0.901 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697359).  Saving model ...
Epoch: 15 cost time: 0.9351556301116943
Epoch: 15, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.870 Vali Acc: 0.717 Test Loss: 0.870 Test Acc: 0.717
Validation loss decreased (-0.697359 --> -0.717097).  Saving model ...
Epoch: 16 cost time: 0.9515142440795898
Epoch: 16, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.840 Vali Acc: 0.711 Test Loss: 0.840 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9920852184295654
Epoch: 17, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.813 Vali Acc: 0.724 Test Loss: 0.813 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723676).  Saving model ...
Epoch: 18 cost time: 1.0154590606689453
Epoch: 18, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.785 Vali Acc: 0.724 Test Loss: 0.785 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723676).  Saving model ...
Epoch: 19 cost time: 0.9112322330474854
Epoch: 19, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.760 Vali Acc: 0.730 Test Loss: 0.760 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 20 cost time: 0.9621164798736572
Epoch: 20, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 0.9596161842346191
Epoch: 21, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.712 Vali Acc: 0.750 Test Loss: 0.712 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 0.8059978485107422
Epoch: 22, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.690 Vali Acc: 0.750 Test Loss: 0.690 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 0.8845493793487549
Epoch: 23, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.672 Vali Acc: 0.750 Test Loss: 0.672 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 24 cost time: 0.9412693977355957
Epoch: 24, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.654 Vali Acc: 0.757 Test Loss: 0.654 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 25 cost time: 0.9680726528167725
Epoch: 25, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.640 Vali Acc: 0.757 Test Loss: 0.640 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 0.9373385906219482
Epoch: 26, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 0.9217040538787842
Epoch: 27, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.615 Vali Acc: 0.757 Test Loss: 0.615 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0444843769073486
Epoch: 28, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8968980312347412
Epoch: 29, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9379234313964844
Epoch: 30, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.585 Vali Acc: 0.750 Test Loss: 0.585 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9123961925506592
Epoch: 31, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.572 Vali Acc: 0.750 Test Loss: 0.572 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.930903434753418
Epoch: 32, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.567 Vali Acc: 0.750 Test Loss: 0.567 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8911774158477783
Epoch: 33, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.562 Vali Acc: 0.757 Test Loss: 0.562 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9692020416259766
Epoch: 34, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.559 Vali Acc: 0.770 Test Loss: 0.559 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 35 cost time: 0.9538149833679199
Epoch: 35, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 36 cost time: 0.9722816944122314
Epoch: 36, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9626264572143555
Epoch: 37, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9060592651367188
Epoch: 38, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.543 Vali Acc: 0.770 Test Loss: 0.543 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9330713748931885
Epoch: 39, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.013218879699707
Epoch: 40, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9234471321105957
Epoch: 41, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8548104763031006
Epoch: 42, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 43 cost time: 0.8977108001708984
Epoch: 43, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8073444366455078
Epoch: 44, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.732762336730957
Epoch: 45, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.536 Vali Acc: 0.770 Test Loss: 0.536 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9668493270874023
Epoch: 46, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 47 cost time: 0.7884442806243896
Epoch: 47, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8192682266235352
Epoch: 48, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7980914115905762
Epoch: 49, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9581265449523926
Epoch: 50, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.962470531463623
Epoch: 51, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9629762172698975
Epoch: 52, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9604120254516602
Epoch: 53, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.0082995891571045
Epoch: 54, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.9528384208679199
Epoch: 55, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.053783655166626
Epoch: 56, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 40044
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2350146770477295
Epoch: 1, Steps: 10 | Train Loss: 1.602 Vali Loss: 1.459 Vali Acc: 0.224 Test Loss: 1.459 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.0989365577697754
Epoch: 2, Steps: 10 | Train Loss: 1.533 Vali Loss: 1.427 Vali Acc: 0.257 Test Loss: 1.427 Test Acc: 0.257
Validation loss decreased (-0.223670 --> -0.256565).  Saving model ...
Epoch: 3 cost time: 0.8719367980957031
Epoch: 3, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.382 Vali Acc: 0.283 Test Loss: 1.382 Test Acc: 0.283
Validation loss decreased (-0.256565 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 1.1223483085632324
Epoch: 4, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.331 Vali Acc: 0.349 Test Loss: 1.331 Test Acc: 0.349
Validation loss decreased (-0.282881 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 1.0689682960510254
Epoch: 5, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.278 Vali Acc: 0.421 Test Loss: 1.278 Test Acc: 0.421
Validation loss decreased (-0.348671 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 0.9586982727050781
Epoch: 6, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.224 Vali Acc: 0.467 Test Loss: 1.224 Test Acc: 0.467
Validation loss decreased (-0.421040 --> -0.467093).  Saving model ...
Epoch: 7 cost time: 0.9787712097167969
Epoch: 7, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.168 Vali Acc: 0.454 Test Loss: 1.168 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9594302177429199
Epoch: 8, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.119 Vali Acc: 0.461 Test Loss: 1.119 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0254764556884766
Epoch: 9, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.068 Vali Acc: 0.493 Test Loss: 1.068 Test Acc: 0.493
Validation loss decreased (-0.467093 --> -0.493410).  Saving model ...
Epoch: 10 cost time: 1.2530810832977295
Epoch: 10, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.019 Vali Acc: 0.546 Test Loss: 1.019 Test Acc: 0.546
Validation loss decreased (-0.493410 --> -0.546042).  Saving model ...
Epoch: 11 cost time: 1.1238720417022705
Epoch: 11, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.969 Vali Acc: 0.599 Test Loss: 0.969 Test Acc: 0.599
Validation loss decreased (-0.546042 --> -0.598675).  Saving model ...
Epoch: 12 cost time: 0.9582722187042236
Epoch: 12, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.926 Vali Acc: 0.612 Test Loss: 0.926 Test Acc: 0.612
Validation loss decreased (-0.598675 --> -0.611833).  Saving model ...
Epoch: 13 cost time: 0.9924347400665283
Epoch: 13, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.882 Vali Acc: 0.632 Test Loss: 0.882 Test Acc: 0.632
Validation loss decreased (-0.611833 --> -0.631570).  Saving model ...
Epoch: 14 cost time: 0.955305814743042
Epoch: 14, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.846 Vali Acc: 0.645 Test Loss: 0.846 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644728).  Saving model ...
Epoch: 15 cost time: 1.0534067153930664
Epoch: 15, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.813 Vali Acc: 0.664 Test Loss: 0.813 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664466).  Saving model ...
Epoch: 16 cost time: 0.9308042526245117
Epoch: 16, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.780 Vali Acc: 0.671 Test Loss: 0.780 Test Acc: 0.671
Validation loss decreased (-0.664466 --> -0.671045).  Saving model ...
Epoch: 17 cost time: 0.8983199596405029
Epoch: 17, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.748 Vali Acc: 0.697 Test Loss: 0.748 Test Acc: 0.697
Validation loss decreased (-0.671045 --> -0.697361).  Saving model ...
Epoch: 18 cost time: 1.1360208988189697
Epoch: 18, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.726 Vali Acc: 0.711 Test Loss: 0.726 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 19 cost time: 0.9412553310394287
Epoch: 19, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.706 Vali Acc: 0.730 Test Loss: 0.706 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 20 cost time: 1.0429635047912598
Epoch: 20, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.689 Vali Acc: 0.730 Test Loss: 0.689 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 21 cost time: 1.0401370525360107
Epoch: 21, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 22 cost time: 0.9614224433898926
Epoch: 22, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.659 Vali Acc: 0.743 Test Loss: 0.659 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 1.0339128971099854
Epoch: 23, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 24 cost time: 1.1124749183654785
Epoch: 24, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 25 cost time: 1.124636173248291
Epoch: 25, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 0.9830596446990967
Epoch: 26, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.607 Vali Acc: 0.770 Test Loss: 0.607 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 1.0796496868133545
Epoch: 27, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.060110330581665
Epoch: 28, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.055433988571167
Epoch: 29, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1426646709442139
Epoch: 30, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.575 Vali Acc: 0.770 Test Loss: 0.575 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 31 cost time: 1.048218011856079
Epoch: 31, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.569 Vali Acc: 0.770 Test Loss: 0.569 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 32 cost time: 0.9961667060852051
Epoch: 32, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 1.1041228771209717
Epoch: 33, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 34 cost time: 1.0222678184509277
Epoch: 34, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 35 cost time: 1.0284693241119385
Epoch: 35, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 36 cost time: 1.002793550491333
Epoch: 36, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 37 cost time: 1.0076675415039062
Epoch: 37, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0721750259399414
Epoch: 38, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 39 cost time: 1.0151021480560303
Epoch: 39, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 40 cost time: 0.9458117485046387
Epoch: 40, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 41 cost time: 0.9425373077392578
Epoch: 41, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 42 cost time: 0.8897459506988525
Epoch: 42, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9639894962310791
Epoch: 43, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9001104831695557
Epoch: 44, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.080353021621704
Epoch: 45, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0349783897399902
Epoch: 46, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0650579929351807
Epoch: 47, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0545337200164795
Epoch: 48, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0014045238494873
Epoch: 49, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.98659348487854
Epoch: 50, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.043346643447876
Epoch: 51, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 23660
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.912830352783203
Epoch: 1, Steps: 10 | Train Loss: 1.566 Vali Loss: 1.455 Vali Acc: 0.230 Test Loss: 1.455 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 0.9508876800537109
Epoch: 2, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
Validation loss decreased (-0.230249 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.0576746463775635
Epoch: 3, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.383 Vali Acc: 0.303 Test Loss: 1.383 Test Acc: 0.303
Validation loss decreased (-0.269723 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 1.0051333904266357
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.335 Vali Acc: 0.342 Test Loss: 1.335 Test Acc: 0.342
Validation loss decreased (-0.302618 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 1.048084020614624
Epoch: 5, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.286 Vali Acc: 0.395 Test Loss: 1.286 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 0.980381965637207
Epoch: 6, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.235 Vali Acc: 0.474 Test Loss: 1.235 Test Acc: 0.474
Validation loss decreased (-0.394724 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 0.8990952968597412
Epoch: 7, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.179 Vali Acc: 0.507 Test Loss: 1.179 Test Acc: 0.507
Validation loss decreased (-0.473672 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 1.0574126243591309
Epoch: 8, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.129 Vali Acc: 0.539 Test Loss: 1.129 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539462).  Saving model ...
Epoch: 9 cost time: 1.0258634090423584
Epoch: 9, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.079 Vali Acc: 0.539 Test Loss: 1.079 Test Acc: 0.539
Validation loss decreased (-0.539462 --> -0.539463).  Saving model ...
Epoch: 10 cost time: 1.0498557090759277
Epoch: 10, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.027 Vali Acc: 0.566 Test Loss: 1.027 Test Acc: 0.566
Validation loss decreased (-0.539463 --> -0.565779).  Saving model ...
Epoch: 11 cost time: 0.9108397960662842
Epoch: 11, Steps: 10 | Train Loss: 0.878 Vali Loss: 0.976 Vali Acc: 0.566 Test Loss: 0.976 Test Acc: 0.566
Validation loss decreased (-0.565779 --> -0.565780).  Saving model ...
Epoch: 12 cost time: 1.035036563873291
Epoch: 12, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.932 Vali Acc: 0.572 Test Loss: 0.932 Test Acc: 0.572
Validation loss decreased (-0.565780 --> -0.572359).  Saving model ...
Epoch: 13 cost time: 1.0063204765319824
Epoch: 13, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.887 Vali Acc: 0.625 Test Loss: 0.887 Test Acc: 0.625
Validation loss decreased (-0.572359 --> -0.624991).  Saving model ...
Epoch: 14 cost time: 0.9796187877655029
Epoch: 14, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.848 Vali Acc: 0.664 Test Loss: 0.848 Test Acc: 0.664
Validation loss decreased (-0.624991 --> -0.664465).  Saving model ...
Epoch: 15 cost time: 1.0404174327850342
Epoch: 15, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.813 Vali Acc: 0.684 Test Loss: 0.813 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 16 cost time: 0.9195213317871094
Epoch: 16, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.778 Vali Acc: 0.704 Test Loss: 0.778 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 0.8813726902008057
Epoch: 17, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.748 Vali Acc: 0.724 Test Loss: 0.748 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 0.8856425285339355
Epoch: 18, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.722 Vali Acc: 0.730 Test Loss: 0.722 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 0.8938980102539062
Epoch: 19, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.701 Vali Acc: 0.724 Test Loss: 0.701 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9295430183410645
Epoch: 20, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.008556604385376
Epoch: 21, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.665 Vali Acc: 0.730 Test Loss: 0.665 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 22 cost time: 0.7937827110290527
Epoch: 22, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.651 Vali Acc: 0.730 Test Loss: 0.651 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 23 cost time: 1.1974759101867676
Epoch: 23, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.638 Vali Acc: 0.743 Test Loss: 0.638 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 24 cost time: 1.0949361324310303
Epoch: 24, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 25 cost time: 1.13517165184021
Epoch: 25, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.611 Vali Acc: 0.763 Test Loss: 0.611 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 0.934913158416748
Epoch: 26, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 0.9265661239624023
Epoch: 27, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 28 cost time: 1.0043776035308838
Epoch: 28, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.583 Vali Acc: 0.776 Test Loss: 0.583 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9866206645965576
Epoch: 29, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.0652365684509277
Epoch: 30, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 1.0259323120117188
Epoch: 31, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.040088415145874
Epoch: 32, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 33 cost time: 0.9894344806671143
Epoch: 33, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0604195594787598
Epoch: 34, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1554944515228271
Epoch: 35, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9793665409088135
Epoch: 36, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.95223069190979
Epoch: 37, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 38 cost time: 0.948155403137207
Epoch: 38, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0556056499481201
Epoch: 39, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 40 cost time: 1.1091716289520264
Epoch: 40, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 41 cost time: 1.1491029262542725
Epoch: 41, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 42 cost time: 1.134239673614502
Epoch: 42, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1070771217346191
Epoch: 43, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0866916179656982
Epoch: 44, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0884318351745605
Epoch: 45, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 46 cost time: 1.028813123703003
Epoch: 46, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0370230674743652
Epoch: 47, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0103588104248047
Epoch: 48, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9971890449523926
Epoch: 49, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0937926769256592
Epoch: 50, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9913218021392822
Epoch: 51, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.999751091003418
Epoch: 52, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.1363918781280518
Epoch: 53, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.0762476921081543
Epoch: 54, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.0190763473510742
Epoch: 55, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 23660
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4666850566864014
Epoch: 1, Steps: 10 | Train Loss: 1.518 Vali Loss: 1.428 Vali Acc: 0.263 Test Loss: 1.428 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.0275211334228516
Epoch: 2, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.402 Vali Acc: 0.270 Test Loss: 1.402 Test Acc: 0.270
Validation loss decreased (-0.263144 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.0251612663269043
Epoch: 3, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.367 Vali Acc: 0.342 Test Loss: 1.367 Test Acc: 0.342
Validation loss decreased (-0.269723 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 0.9915432929992676
Epoch: 4, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.322 Vali Acc: 0.375 Test Loss: 1.322 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.973400354385376
Epoch: 5, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.277 Vali Acc: 0.421 Test Loss: 1.277 Test Acc: 0.421
Validation loss decreased (-0.374987 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 0.8951823711395264
Epoch: 6, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.230 Vali Acc: 0.493 Test Loss: 1.230 Test Acc: 0.493
Validation loss decreased (-0.421040 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 1.0451087951660156
Epoch: 7, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.179 Vali Acc: 0.487 Test Loss: 1.179 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0064435005187988
Epoch: 8, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.131 Vali Acc: 0.526 Test Loss: 1.131 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526304).  Saving model ...
Epoch: 9 cost time: 0.977581262588501
Epoch: 9, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.084 Vali Acc: 0.559 Test Loss: 1.084 Test Acc: 0.559
Validation loss decreased (-0.526304 --> -0.559200).  Saving model ...
Epoch: 10 cost time: 0.9803953170776367
Epoch: 10, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.036 Vali Acc: 0.566 Test Loss: 1.036 Test Acc: 0.566
Validation loss decreased (-0.559200 --> -0.565779).  Saving model ...
Epoch: 11 cost time: 1.0218732357025146
Epoch: 11, Steps: 10 | Train Loss: 0.922 Vali Loss: 0.986 Vali Acc: 0.599 Test Loss: 0.986 Test Acc: 0.599
Validation loss decreased (-0.565779 --> -0.598674).  Saving model ...
Epoch: 12 cost time: 1.057389259338379
Epoch: 12, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.942 Vali Acc: 0.645 Test Loss: 0.942 Test Acc: 0.645
Validation loss decreased (-0.598674 --> -0.644727).  Saving model ...
Epoch: 13 cost time: 1.1624352931976318
Epoch: 13, Steps: 10 | Train Loss: 0.809 Vali Loss: 0.899 Vali Acc: 0.638 Test Loss: 0.899 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0545618534088135
Epoch: 14, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.861 Vali Acc: 0.651 Test Loss: 0.861 Test Acc: 0.651
Validation loss decreased (-0.644727 --> -0.651307).  Saving model ...
Epoch: 15 cost time: 0.9886925220489502
Epoch: 15, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.824 Vali Acc: 0.671 Test Loss: 0.824 Test Acc: 0.671
Validation loss decreased (-0.651307 --> -0.671044).  Saving model ...
Epoch: 16 cost time: 1.0881597995758057
Epoch: 16, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.792 Vali Acc: 0.697 Test Loss: 0.792 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697360).  Saving model ...
Epoch: 17 cost time: 1.005256175994873
Epoch: 17, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.762 Vali Acc: 0.697 Test Loss: 0.762 Test Acc: 0.697
Validation loss decreased (-0.697360 --> -0.697361).  Saving model ...
Epoch: 18 cost time: 0.8932580947875977
Epoch: 18, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.737 Vali Acc: 0.711 Test Loss: 0.737 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 19 cost time: 0.939063549041748
Epoch: 19, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 20 cost time: 1.042593002319336
Epoch: 20, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.689 Vali Acc: 0.730 Test Loss: 0.689 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 21 cost time: 1.0625128746032715
Epoch: 21, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 1.101623296737671
Epoch: 22, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.133497953414917
Epoch: 23, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 24 cost time: 1.092858076095581
Epoch: 24, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.620 Vali Acc: 0.750 Test Loss: 0.620 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9780638217926025
Epoch: 25, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.604 Vali Acc: 0.743 Test Loss: 0.604 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1030776500701904
Epoch: 26, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 1.0082967281341553
Epoch: 27, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9994468688964844
Epoch: 28, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.569 Vali Acc: 0.770 Test Loss: 0.569 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.043008804321289
Epoch: 29, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 1.0687897205352783
Epoch: 30, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0473980903625488
Epoch: 31, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 1.058694839477539
Epoch: 32, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 1.0843513011932373
Epoch: 33, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 34 cost time: 1.0308191776275635
Epoch: 34, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 35 cost time: 0.9794871807098389
Epoch: 35, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 36 cost time: 1.1472296714782715
Epoch: 36, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9648683071136475
Epoch: 37, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1161506175994873
Epoch: 38, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0832724571228027
Epoch: 39, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.505 Vali Acc: 0.776 Test Loss: 0.505 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9497175216674805
Epoch: 40, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.500 Vali Acc: 0.776 Test Loss: 0.500 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.994377851486206
Epoch: 41, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 42 cost time: 0.9408359527587891
Epoch: 42, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 43 cost time: 1.0194427967071533
Epoch: 43, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1363716125488281
Epoch: 44, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 45 cost time: 0.8549199104309082
Epoch: 45, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.491 Vali Acc: 0.789 Test Loss: 0.491 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 46 cost time: 1.038994312286377
Epoch: 46, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0165531635284424
Epoch: 47, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0447726249694824
Epoch: 48, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9877278804779053
Epoch: 49, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.00254487991333
Epoch: 50, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8035640716552734
Epoch: 51, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.8359599113464355
Epoch: 52, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.8743078708648682
Epoch: 53, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.9722657203674316
Epoch: 54, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9684562683105469
Epoch: 55, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 23660
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9616832733154297
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.437 Vali Acc: 0.211 Test Loss: 1.437 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 1.0584909915924072
Epoch: 2, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.417 Vali Acc: 0.230 Test Loss: 1.417 Test Acc: 0.230
Validation loss decreased (-0.210512 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 1.0361170768737793
Epoch: 3, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.385 Vali Acc: 0.270 Test Loss: 1.385 Test Acc: 0.270
Validation loss decreased (-0.230249 --> -0.269723).  Saving model ...
Epoch: 4 cost time: 0.9203450679779053
Epoch: 4, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.347 Vali Acc: 0.342 Test Loss: 1.347 Test Acc: 0.342
Validation loss decreased (-0.269723 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 0.9964687824249268
Epoch: 5, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.307 Vali Acc: 0.447 Test Loss: 1.307 Test Acc: 0.447
Validation loss decreased (-0.342092 --> -0.447355).  Saving model ...
Epoch: 6 cost time: 0.9908738136291504
Epoch: 6, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.447355 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.9190471172332764
Epoch: 7, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.220 Vali Acc: 0.526 Test Loss: 1.220 Test Acc: 0.526
Validation loss decreased (-0.499987 --> -0.526304).  Saving model ...
Epoch: 8 cost time: 0.9784805774688721
Epoch: 8, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.176 Vali Acc: 0.546 Test Loss: 1.176 Test Acc: 0.546
Validation loss decreased (-0.526304 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 0.8824429512023926
Epoch: 9, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.132 Vali Acc: 0.572 Test Loss: 1.132 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572357).  Saving model ...
Epoch: 10 cost time: 0.9935891628265381
Epoch: 10, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.086 Vali Acc: 0.618 Test Loss: 1.086 Test Acc: 0.618
Validation loss decreased (-0.572357 --> -0.618410).  Saving model ...
Epoch: 11 cost time: 0.9603996276855469
Epoch: 11, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.045 Vali Acc: 0.651 Test Loss: 1.045 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651305).  Saving model ...
Epoch: 12 cost time: 0.9693915843963623
Epoch: 12, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.006 Vali Acc: 0.684 Test Loss: 1.006 Test Acc: 0.684
Validation loss decreased (-0.651305 --> -0.684200).  Saving model ...
Epoch: 13 cost time: 0.8388597965240479
Epoch: 13, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.966 Vali Acc: 0.684 Test Loss: 0.966 Test Acc: 0.684
Validation loss decreased (-0.684200 --> -0.684201).  Saving model ...
Epoch: 14 cost time: 0.8480854034423828
Epoch: 14, Steps: 10 | Train Loss: 0.811 Vali Loss: 0.928 Vali Acc: 0.691 Test Loss: 0.928 Test Acc: 0.691
Validation loss decreased (-0.684201 --> -0.690780).  Saving model ...
Epoch: 15 cost time: 0.941145658493042
Epoch: 15, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.892 Vali Acc: 0.684 Test Loss: 0.892 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0894825458526611
Epoch: 16, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.859 Vali Acc: 0.704 Test Loss: 0.859 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 17 cost time: 0.9108431339263916
Epoch: 17, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.826 Vali Acc: 0.724 Test Loss: 0.826 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723676).  Saving model ...
Epoch: 18 cost time: 1.0243065357208252
Epoch: 18, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.798 Vali Acc: 0.724 Test Loss: 0.798 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723676).  Saving model ...
Epoch: 19 cost time: 1.084191083908081
Epoch: 19, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.773 Vali Acc: 0.737 Test Loss: 0.773 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736834).  Saving model ...
Epoch: 20 cost time: 1.0706913471221924
Epoch: 20, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 0.9662284851074219
Epoch: 21, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.725 Vali Acc: 0.750 Test Loss: 0.725 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 1.0651230812072754
Epoch: 22, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 0.9686658382415771
Epoch: 23, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.682 Vali Acc: 0.743 Test Loss: 0.682 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0055980682373047
Epoch: 24, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.669 Vali Acc: 0.743 Test Loss: 0.669 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.089663028717041
Epoch: 25, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.652 Vali Acc: 0.770 Test Loss: 0.652 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 26 cost time: 1.017911434173584
Epoch: 26, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.641 Vali Acc: 0.737 Test Loss: 0.641 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1012365818023682
Epoch: 27, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1189258098602295
Epoch: 28, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.616 Vali Acc: 0.763 Test Loss: 0.616 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9515118598937988
Epoch: 29, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.606 Vali Acc: 0.763 Test Loss: 0.606 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9871222972869873
Epoch: 30, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.596 Vali Acc: 0.770 Test Loss: 0.596 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 31 cost time: 1.0529453754425049
Epoch: 31, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0457375049591064
Epoch: 32, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 33 cost time: 0.9566991329193115
Epoch: 33, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 34 cost time: 1.0521965026855469
Epoch: 34, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9636855125427246
Epoch: 35, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 36 cost time: 0.8487935066223145
Epoch: 36, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9969749450683594
Epoch: 37, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 38 cost time: 0.846893310546875
Epoch: 38, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8951246738433838
Epoch: 39, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9281520843505859
Epoch: 40, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9906649589538574
Epoch: 41, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0043575763702393
Epoch: 42, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9598824977874756
Epoch: 43, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9913516044616699
Epoch: 44, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 45 cost time: 0.936814546585083
Epoch: 45, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9656577110290527
Epoch: 46, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.551 Vali Acc: 0.796 Test Loss: 0.551 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9067494869232178
Epoch: 47, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0319201946258545
Epoch: 48, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9023525714874268
Epoch: 49, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 50 cost time: 0.8266983032226562
Epoch: 50, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.950737476348877
Epoch: 51, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9751708507537842
Epoch: 52, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.564 Vali Acc: 0.796 Test Loss: 0.564 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8725576400756836
Epoch: 53, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9076497554779053
Epoch: 54, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.0048854351043701
Epoch: 55, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.073714017868042
Epoch: 56, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.943565845489502
Epoch: 57, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.034414291381836
Epoch: 58, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.0160927772521973
Epoch: 59, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 23660
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.000617027282715
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.435 Vali Acc: 0.217 Test Loss: 1.435 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 1.0706708431243896
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.405 Vali Acc: 0.243 Test Loss: 1.405 Test Acc: 0.243
Validation loss decreased (-0.217091 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 1.0018894672393799
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.367 Vali Acc: 0.322 Test Loss: 1.367 Test Acc: 0.322
Validation loss decreased (-0.243407 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 0.8900103569030762
Epoch: 4, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.321 Vali Acc: 0.382 Test Loss: 1.321 Test Acc: 0.382
Validation loss decreased (-0.322355 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 0.9176483154296875
Epoch: 5, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.270 Vali Acc: 0.408 Test Loss: 1.270 Test Acc: 0.408
Validation loss decreased (-0.381566 --> -0.407882).  Saving model ...
Epoch: 6 cost time: 0.8955593109130859
Epoch: 6, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.221 Vali Acc: 0.428 Test Loss: 1.221 Test Acc: 0.428
Validation loss decreased (-0.407882 --> -0.427619).  Saving model ...
Epoch: 7 cost time: 0.946678638458252
Epoch: 7, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.166 Vali Acc: 0.487 Test Loss: 1.166 Test Acc: 0.487
Validation loss decreased (-0.427619 --> -0.486830).  Saving model ...
Epoch: 8 cost time: 0.8968851566314697
Epoch: 8, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
Validation loss decreased (-0.486830 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.978069543838501
Epoch: 9, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.065 Vali Acc: 0.513 Test Loss: 1.065 Test Acc: 0.513
Validation loss decreased (-0.499989 --> -0.513147).  Saving model ...
Epoch: 10 cost time: 0.9756066799163818
Epoch: 10, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.015 Vali Acc: 0.526 Test Loss: 1.015 Test Acc: 0.526
Validation loss decreased (-0.513147 --> -0.526306).  Saving model ...
Epoch: 11 cost time: 0.9631145000457764
Epoch: 11, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.966 Vali Acc: 0.559 Test Loss: 0.966 Test Acc: 0.559
Validation loss decreased (-0.526306 --> -0.559201).  Saving model ...
Epoch: 12 cost time: 0.8902707099914551
Epoch: 12, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.923 Vali Acc: 0.605 Test Loss: 0.923 Test Acc: 0.605
Validation loss decreased (-0.559201 --> -0.605254).  Saving model ...
Epoch: 13 cost time: 0.9481520652770996
Epoch: 13, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.880 Vali Acc: 0.651 Test Loss: 0.880 Test Acc: 0.651
Validation loss decreased (-0.605254 --> -0.651307).  Saving model ...
Epoch: 14 cost time: 1.0138797760009766
Epoch: 14, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.843 Vali Acc: 0.651 Test Loss: 0.843 Test Acc: 0.651
Validation loss decreased (-0.651307 --> -0.651307).  Saving model ...
Epoch: 15 cost time: 0.896674394607544
Epoch: 15, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.811 Vali Acc: 0.678 Test Loss: 0.811 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 16 cost time: 0.9822919368743896
Epoch: 16, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.781 Vali Acc: 0.684 Test Loss: 0.781 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684203).  Saving model ...
Epoch: 17 cost time: 0.8668737411499023
Epoch: 17, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.754 Vali Acc: 0.684 Test Loss: 0.754 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 18 cost time: 0.89101243019104
Epoch: 18, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.727 Vali Acc: 0.691 Test Loss: 0.727 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 19 cost time: 0.9534626007080078
Epoch: 19, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.704 Vali Acc: 0.717 Test Loss: 0.704 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 20 cost time: 0.9709727764129639
Epoch: 20, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 0.9881718158721924
Epoch: 21, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.668 Vali Acc: 0.724 Test Loss: 0.668 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0176596641540527
Epoch: 22, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.648 Vali Acc: 0.730 Test Loss: 0.648 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9713492393493652
Epoch: 23, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.632 Vali Acc: 0.724 Test Loss: 0.632 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9508590698242188
Epoch: 24, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.617 Vali Acc: 0.743 Test Loss: 0.617 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 0.9313943386077881
Epoch: 25, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 0.9619045257568359
Epoch: 26, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 0.8749852180480957
Epoch: 27, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9852545261383057
Epoch: 28, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 0.9446408748626709
Epoch: 29, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 30 cost time: 1.037397861480713
Epoch: 30, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 0.8891806602478027
Epoch: 31, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.032102108001709
Epoch: 32, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.000077724456787
Epoch: 33, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.541 Vali Acc: 0.763 Test Loss: 0.541 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.910930871963501
Epoch: 34, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 35 cost time: 0.9691050052642822
Epoch: 35, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 36 cost time: 1.0548522472381592
Epoch: 36, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9059667587280273
Epoch: 37, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8849489688873291
Epoch: 38, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 39 cost time: 1.1602661609649658
Epoch: 39, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796047).  Saving model ...
Epoch: 40 cost time: 0.9092516899108887
Epoch: 40, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9306175708770752
Epoch: 41, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0282459259033203
Epoch: 42, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 43 cost time: 0.9772846698760986
Epoch: 43, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 44 cost time: 0.9989500045776367
Epoch: 44, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 45 cost time: 0.9070043563842773
Epoch: 45, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 46 cost time: 1.0641427040100098
Epoch: 46, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 47 cost time: 1.0523200035095215
Epoch: 47, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0526299476623535
Epoch: 48, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.888634204864502
Epoch: 49, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 50 cost time: 1.0215277671813965
Epoch: 50, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9581081867218018
Epoch: 51, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.081686019897461
Epoch: 52, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 53 cost time: 0.9690132141113281
Epoch: 53, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.140110731124878
Epoch: 54, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 55 cost time: 0.9696714878082275
Epoch: 55, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0537166595458984
Epoch: 56, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0067250728607178
Epoch: 57, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9482269287109375
Epoch: 58, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.0140905380249023
Epoch: 59, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.0146362781524658
Epoch: 60, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9630832672119141
Epoch: 61, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.8748016357421875
Epoch: 62, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 63 cost time: 0.8718113899230957
Epoch: 63, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 64 cost time: 0.8589680194854736
Epoch: 64, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8881900310516357
Epoch: 65, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.9713263511657715
Epoch: 66, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.9709475040435791
Epoch: 67, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.026012897491455
Epoch: 68, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.9972329139709473
Epoch: 69, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.1124563217163086
Epoch: 70, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.0158772468566895
Epoch: 71, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.944277286529541
Epoch: 72, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.0497846603393555
Epoch: 73, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 15468
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.41158390045166
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.435 Vali Acc: 0.178 Test Loss: 1.435 Test Acc: 0.178
Validation loss decreased (inf --> -0.177617).  Saving model ...
Epoch: 2 cost time: 1.11551833152771
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.408 Vali Acc: 0.224 Test Loss: 1.408 Test Acc: 0.224
Validation loss decreased (-0.177617 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 0.9141850471496582
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.369 Vali Acc: 0.283 Test Loss: 1.369 Test Acc: 0.283
Validation loss decreased (-0.223670 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 1.12961745262146
Epoch: 4, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.324 Vali Acc: 0.336 Test Loss: 1.324 Test Acc: 0.336
Validation loss decreased (-0.282881 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 0.9311187267303467
Epoch: 5, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.276 Vali Acc: 0.382 Test Loss: 1.276 Test Acc: 0.382
Validation loss decreased (-0.335513 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 0.9069433212280273
Epoch: 6, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.226 Vali Acc: 0.434 Test Loss: 1.226 Test Acc: 0.434
Validation loss decreased (-0.381566 --> -0.434198).  Saving model ...
Epoch: 7 cost time: 0.8543498516082764
Epoch: 7, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
Validation loss decreased (-0.434198 --> -0.467094).  Saving model ...
Epoch: 8 cost time: 1.0398430824279785
Epoch: 8, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.122 Vali Acc: 0.474 Test Loss: 1.122 Test Acc: 0.474
Validation loss decreased (-0.467094 --> -0.473673).  Saving model ...
Epoch: 9 cost time: 0.9522414207458496
Epoch: 9, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.074 Vali Acc: 0.520 Test Loss: 1.074 Test Acc: 0.520
Validation loss decreased (-0.473673 --> -0.519726).  Saving model ...
Epoch: 10 cost time: 1.048691987991333
Epoch: 10, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.025 Vali Acc: 0.546 Test Loss: 1.025 Test Acc: 0.546
Validation loss decreased (-0.519726 --> -0.546042).  Saving model ...
Epoch: 11 cost time: 1.0030632019042969
Epoch: 11, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.975 Vali Acc: 0.572 Test Loss: 0.975 Test Acc: 0.572
Validation loss decreased (-0.546042 --> -0.572359).  Saving model ...
Epoch: 12 cost time: 0.994854211807251
Epoch: 12, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.931 Vali Acc: 0.612 Test Loss: 0.931 Test Acc: 0.612
Validation loss decreased (-0.572359 --> -0.611833).  Saving model ...
Epoch: 13 cost time: 1.0631694793701172
Epoch: 13, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.887 Vali Acc: 0.651 Test Loss: 0.887 Test Acc: 0.651
Validation loss decreased (-0.611833 --> -0.651307).  Saving model ...
Epoch: 14 cost time: 0.9512760639190674
Epoch: 14, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.851 Vali Acc: 0.664 Test Loss: 0.851 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664465).  Saving model ...
Epoch: 15 cost time: 0.989844799041748
Epoch: 15, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.818 Vali Acc: 0.684 Test Loss: 0.818 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 16 cost time: 1.0951104164123535
Epoch: 16, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.785 Vali Acc: 0.678 Test Loss: 0.785 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9890768527984619
Epoch: 17, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.755 Vali Acc: 0.684 Test Loss: 0.755 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 18 cost time: 1.118373155593872
Epoch: 18, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.730 Vali Acc: 0.691 Test Loss: 0.730 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 19 cost time: 1.020505428314209
Epoch: 19, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.708 Vali Acc: 0.704 Test Loss: 0.708 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 20 cost time: 1.0186808109283447
Epoch: 20, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.690 Vali Acc: 0.711 Test Loss: 0.690 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 21 cost time: 0.9659662246704102
Epoch: 21, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717099).  Saving model ...
Epoch: 22 cost time: 1.0293700695037842
Epoch: 22, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.651 Vali Acc: 0.717 Test Loss: 0.651 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 23 cost time: 0.9265050888061523
Epoch: 23, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 24 cost time: 0.9643890857696533
Epoch: 24, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.619 Vali Acc: 0.730 Test Loss: 0.619 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9108891487121582
Epoch: 25, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.608 Vali Acc: 0.724 Test Loss: 0.608 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9756686687469482
Epoch: 26, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.598 Vali Acc: 0.730 Test Loss: 0.598 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0192015171051025
Epoch: 27, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.592 Vali Acc: 0.743 Test Loss: 0.592 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 28 cost time: 0.9400849342346191
Epoch: 28, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.581 Vali Acc: 0.743 Test Loss: 0.581 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 29 cost time: 0.9157390594482422
Epoch: 29, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 30 cost time: 0.8379993438720703
Epoch: 30, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 31 cost time: 0.8591647148132324
Epoch: 31, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 0.9539268016815186
Epoch: 32, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9650850296020508
Epoch: 33, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0043838024139404
Epoch: 34, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0113673210144043
Epoch: 35, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 36 cost time: 0.95131516456604
Epoch: 36, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 37 cost time: 1.0495021343231201
Epoch: 37, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 0.965782642364502
Epoch: 38, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 39 cost time: 0.97214674949646
Epoch: 39, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9714667797088623
Epoch: 40, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0399389266967773
Epoch: 41, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 42 cost time: 0.9592971801757812
Epoch: 42, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0785293579101562
Epoch: 43, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0760128498077393
Epoch: 44, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9557828903198242
Epoch: 45, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 46 cost time: 0.8530306816101074
Epoch: 46, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8602931499481201
Epoch: 47, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 48 cost time: 0.9651021957397461
Epoch: 48, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0190658569335938
Epoch: 49, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0743446350097656
Epoch: 50, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0884509086608887
Epoch: 51, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0704305171966553
Epoch: 52, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1180148124694824
Epoch: 53, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0496063232421875
Epoch: 54, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.028825044631958
Epoch: 55, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.9616303443908691
Epoch: 56, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.9627017974853516
Epoch: 57, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 15468
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2435078620910645
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.419 Vali Acc: 0.243 Test Loss: 1.419 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.9365510940551758
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.395 Vali Acc: 0.250 Test Loss: 1.395 Test Acc: 0.250
Validation loss decreased (-0.243407 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.9219470024108887
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.362 Vali Acc: 0.276 Test Loss: 1.362 Test Acc: 0.276
Validation loss decreased (-0.249986 --> -0.276302).  Saving model ...
Epoch: 4 cost time: 0.9478991031646729
Epoch: 4, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.322 Vali Acc: 0.349 Test Loss: 1.322 Test Acc: 0.349
Validation loss decreased (-0.276302 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 0.9863779544830322
Epoch: 5, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.276 Vali Acc: 0.388 Test Loss: 1.276 Test Acc: 0.388
Validation loss decreased (-0.348671 --> -0.388145).  Saving model ...
Epoch: 6 cost time: 0.9344902038574219
Epoch: 6, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.230 Vali Acc: 0.421 Test Loss: 1.230 Test Acc: 0.421
Validation loss decreased (-0.388145 --> -0.421040).  Saving model ...
Epoch: 7 cost time: 1.1114811897277832
Epoch: 7, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.182 Vali Acc: 0.447 Test Loss: 1.182 Test Acc: 0.447
Validation loss decreased (-0.421040 --> -0.447357).  Saving model ...
Epoch: 8 cost time: 0.9736123085021973
Epoch: 8, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.447357 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.9494750499725342
Epoch: 9, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.499989 --> -0.532884).  Saving model ...
Epoch: 10 cost time: 1.067087173461914
Epoch: 10, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.046 Vali Acc: 0.579 Test Loss: 1.046 Test Acc: 0.579
Validation loss decreased (-0.532884 --> -0.578937).  Saving model ...
Epoch: 11 cost time: 1.0470497608184814
Epoch: 11, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.001 Vali Acc: 0.599 Test Loss: 1.001 Test Acc: 0.599
Validation loss decreased (-0.578937 --> -0.598674).  Saving model ...
Epoch: 12 cost time: 0.9040355682373047
Epoch: 12, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.957 Vali Acc: 0.605 Test Loss: 0.957 Test Acc: 0.605
Validation loss decreased (-0.598674 --> -0.605254).  Saving model ...
Epoch: 13 cost time: 0.9404172897338867
Epoch: 13, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.912 Vali Acc: 0.645 Test Loss: 0.912 Test Acc: 0.645
Validation loss decreased (-0.605254 --> -0.644728).  Saving model ...
Epoch: 14 cost time: 0.9070947170257568
Epoch: 14, Steps: 10 | Train Loss: 0.718 Vali Loss: 0.874 Vali Acc: 0.664 Test Loss: 0.874 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664465).  Saving model ...
Epoch: 15 cost time: 0.9320476055145264
Epoch: 15, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.840 Vali Acc: 0.664 Test Loss: 0.840 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664465).  Saving model ...
Epoch: 16 cost time: 0.9308369159698486
Epoch: 16, Steps: 10 | Train Loss: 0.630 Vali Loss: 0.806 Vali Acc: 0.684 Test Loss: 0.806 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 0.887277364730835
Epoch: 17, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.774 Vali Acc: 0.711 Test Loss: 0.774 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710519).  Saving model ...
Epoch: 18 cost time: 0.9080045223236084
Epoch: 18, Steps: 10 | Train Loss: 0.534 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 0.8855733871459961
Epoch: 19, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.720 Vali Acc: 0.724 Test Loss: 0.720 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 20 cost time: 0.9276256561279297
Epoch: 20, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.697 Vali Acc: 0.757 Test Loss: 0.697 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756572).  Saving model ...
Epoch: 21 cost time: 1.0521717071533203
Epoch: 21, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.676 Vali Acc: 0.757 Test Loss: 0.676 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 22 cost time: 1.1508517265319824
Epoch: 22, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.658 Vali Acc: 0.757 Test Loss: 0.658 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 23 cost time: 1.0048444271087646
Epoch: 23, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 24 cost time: 1.0810086727142334
Epoch: 24, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.623 Vali Acc: 0.757 Test Loss: 0.623 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9280858039855957
Epoch: 25, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.609 Vali Acc: 0.743 Test Loss: 0.609 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0417640209197998
Epoch: 26, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.604 Vali Acc: 0.743 Test Loss: 0.604 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0739333629608154
Epoch: 27, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0568430423736572
Epoch: 28, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0500023365020752
Epoch: 29, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.573 Vali Acc: 0.743 Test Loss: 0.573 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.023803949356079
Epoch: 30, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.562 Vali Acc: 0.750 Test Loss: 0.562 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0058023929595947
Epoch: 31, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.914635181427002
Epoch: 32, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9083783626556396
Epoch: 33, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.540 Vali Acc: 0.763 Test Loss: 0.540 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 15468
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0936851501464844
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 0.8959629535675049
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.376 Vali Acc: 0.296 Test Loss: 1.376 Test Acc: 0.296
Validation loss decreased (-0.256565 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 0.9410934448242188
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.349 Vali Acc: 0.342 Test Loss: 1.349 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 0.9646430015563965
Epoch: 4, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.0394654273986816
Epoch: 5, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.281 Vali Acc: 0.428 Test Loss: 1.281 Test Acc: 0.428
Validation loss decreased (-0.374987 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 1.0220098495483398
Epoch: 6, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.243 Vali Acc: 0.493 Test Loss: 1.243 Test Acc: 0.493
Validation loss decreased (-0.427619 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 0.8333475589752197
Epoch: 7, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.203 Vali Acc: 0.526 Test Loss: 1.203 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526304).  Saving model ...
Epoch: 8 cost time: 1.0654881000518799
Epoch: 8, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.160 Vali Acc: 0.559 Test Loss: 1.160 Test Acc: 0.559
Validation loss decreased (-0.526304 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 0.8594636917114258
Epoch: 9, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.120 Vali Acc: 0.586 Test Loss: 1.120 Test Acc: 0.586
Validation loss decreased (-0.559199 --> -0.585515).  Saving model ...
Epoch: 10 cost time: 0.904918909072876
Epoch: 10, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.078 Vali Acc: 0.612 Test Loss: 1.078 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611831).  Saving model ...
Epoch: 11 cost time: 0.9580459594726562
Epoch: 11, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.039 Vali Acc: 0.612 Test Loss: 1.039 Test Acc: 0.612
Validation loss decreased (-0.611831 --> -0.611832).  Saving model ...
Epoch: 12 cost time: 1.1209890842437744
Epoch: 12, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.000 Vali Acc: 0.638 Test Loss: 1.000 Test Acc: 0.638
Validation loss decreased (-0.611832 --> -0.638148).  Saving model ...
Epoch: 13 cost time: 1.0747950077056885
Epoch: 13, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.960 Vali Acc: 0.658 Test Loss: 0.960 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 14 cost time: 0.9417450428009033
Epoch: 14, Steps: 10 | Train Loss: 0.784 Vali Loss: 0.925 Vali Acc: 0.658 Test Loss: 0.925 Test Acc: 0.658
Validation loss decreased (-0.657885 --> -0.657885).  Saving model ...
Epoch: 15 cost time: 0.9996073246002197
Epoch: 15, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.893 Vali Acc: 0.671 Test Loss: 0.893 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671044).  Saving model ...
Epoch: 16 cost time: 0.8667922019958496
Epoch: 16, Steps: 10 | Train Loss: 0.711 Vali Loss: 0.856 Vali Acc: 0.691 Test Loss: 0.856 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690781).  Saving model ...
Epoch: 17 cost time: 0.9966907501220703
Epoch: 17, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.828 Vali Acc: 0.711 Test Loss: 0.828 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710518).  Saving model ...
Epoch: 18 cost time: 0.8418245315551758
Epoch: 18, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.799 Vali Acc: 0.743 Test Loss: 0.799 Test Acc: 0.743
Validation loss decreased (-0.710518 --> -0.743413).  Saving model ...
Epoch: 19 cost time: 0.8561515808105469
Epoch: 19, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 0.9831466674804688
Epoch: 20, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.750 Vali Acc: 0.750 Test Loss: 0.750 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 1.1107597351074219
Epoch: 21, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.731 Vali Acc: 0.743 Test Loss: 0.731 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9757869243621826
Epoch: 22, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 0.8863294124603271
Epoch: 23, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 24 cost time: 1.0187880992889404
Epoch: 24, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.672 Vali Acc: 0.750 Test Loss: 0.672 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 25 cost time: 0.9782862663269043
Epoch: 25, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.654 Vali Acc: 0.757 Test Loss: 0.654 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 26 cost time: 1.2718079090118408
Epoch: 26, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 27 cost time: 1.1380603313446045
Epoch: 27, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.629 Vali Acc: 0.757 Test Loss: 0.629 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0955162048339844
Epoch: 28, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.616 Vali Acc: 0.770 Test Loss: 0.616 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.0956611633300781
Epoch: 29, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 1.0566060543060303
Epoch: 30, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.591 Vali Acc: 0.783 Test Loss: 0.591 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 31 cost time: 1.0572311878204346
Epoch: 31, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 32 cost time: 1.0904736518859863
Epoch: 32, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 33 cost time: 0.9445643424987793
Epoch: 33, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 34 cost time: 1.2175819873809814
Epoch: 34, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 1.044631004333496
Epoch: 35, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9464504718780518
Epoch: 36, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0124354362487793
Epoch: 37, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 38 cost time: 0.9851527214050293
Epoch: 38, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.555 Vali Acc: 0.796 Test Loss: 0.555 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 39 cost time: 0.9499228000640869
Epoch: 39, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0925719738006592
Epoch: 40, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0281076431274414
Epoch: 41, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0100135803222656
Epoch: 42, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9690206050872803
Epoch: 43, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0319018363952637
Epoch: 44, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 45 cost time: 0.910254716873169
Epoch: 45, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 46 cost time: 0.8869936466217041
Epoch: 46, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8263201713562012
Epoch: 47, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9367663860321045
Epoch: 48, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 49 cost time: 0.8713655471801758
Epoch: 49, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 50 cost time: 0.8253962993621826
Epoch: 50, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8466002941131592
Epoch: 51, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9438307285308838
Epoch: 52, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0616371631622314
Epoch: 53, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 54 cost time: 0.8454182147979736
Epoch: 54, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.912184476852417
Epoch: 55, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0110995769500732
Epoch: 56, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0444588661193848
Epoch: 57, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 58 cost time: 1.122039556503296
Epoch: 58, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.059845209121704
Epoch: 59, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0340089797973633
Epoch: 60, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.0600197315216064
Epoch: 61, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.0159640312194824
Epoch: 62, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0617644786834717
Epoch: 63, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 64 cost time: 1.0415558815002441
Epoch: 64, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0316393375396729
Epoch: 65, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.0040671825408936
Epoch: 66, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.9737534523010254
Epoch: 67, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.9894847869873047
Epoch: 68, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.2266016006469727
Epoch: 69, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.8782944679260254
Epoch: 70, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.8960726261138916
Epoch: 71, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.972480297088623
Epoch: 72, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.0719661712646484
Epoch: 73, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 15468
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.518221616744995
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.418 Vali Acc: 0.257 Test Loss: 1.418 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 0.9642724990844727
Epoch: 2, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.388 Vali Acc: 0.289 Test Loss: 1.388 Test Acc: 0.289
Validation loss decreased (-0.256565 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 0.9733645915985107
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.346 Vali Acc: 0.342 Test Loss: 1.346 Test Acc: 0.342
Validation loss decreased (-0.289460 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.1778922080993652
Epoch: 4, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.0955073833465576
Epoch: 5, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.251 Vali Acc: 0.421 Test Loss: 1.251 Test Acc: 0.421
Validation loss decreased (-0.374987 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 1.0152921676635742
Epoch: 6, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.421040 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.9768927097320557
Epoch: 7, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
Validation loss decreased (-0.499988 --> -0.532883).  Saving model ...
Epoch: 8 cost time: 1.0719172954559326
Epoch: 8, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.096 Vali Acc: 0.553 Test Loss: 1.096 Test Acc: 0.553
Validation loss decreased (-0.532883 --> -0.552621).  Saving model ...
Epoch: 9 cost time: 1.0129365921020508
Epoch: 9, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.043 Vali Acc: 0.605 Test Loss: 1.043 Test Acc: 0.605
Validation loss decreased (-0.552621 --> -0.605253).  Saving model ...
Epoch: 10 cost time: 1.058426856994629
Epoch: 10, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.994 Vali Acc: 0.625 Test Loss: 0.994 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 1.0792739391326904
Epoch: 11, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.947 Vali Acc: 0.625 Test Loss: 0.947 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 12 cost time: 0.920891284942627
Epoch: 12, Steps: 10 | Train Loss: 0.757 Vali Loss: 0.907 Vali Acc: 0.664 Test Loss: 0.907 Test Acc: 0.664
Validation loss decreased (-0.624991 --> -0.664465).  Saving model ...
Epoch: 13 cost time: 0.9194974899291992
Epoch: 13, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.868 Vali Acc: 0.684 Test Loss: 0.868 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 0.9387187957763672
Epoch: 14, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.830 Vali Acc: 0.711 Test Loss: 0.830 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710518).  Saving model ...
Epoch: 15 cost time: 0.847980260848999
Epoch: 15, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.796 Vali Acc: 0.730 Test Loss: 0.796 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 16 cost time: 1.0649480819702148
Epoch: 16, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.762 Vali Acc: 0.717 Test Loss: 0.762 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9499926567077637
Epoch: 17, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.736 Vali Acc: 0.724 Test Loss: 0.736 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.01816725730896
Epoch: 18, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.715 Vali Acc: 0.724 Test Loss: 0.715 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0363283157348633
Epoch: 19, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.692 Vali Acc: 0.737 Test Loss: 0.692 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736835).  Saving model ...
Epoch: 20 cost time: 1.0884716510772705
Epoch: 20, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.672 Vali Acc: 0.763 Test Loss: 0.672 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 0.9673013687133789
Epoch: 21, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.653 Vali Acc: 0.757 Test Loss: 0.653 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1456117630004883
Epoch: 22, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0548694133758545
Epoch: 23, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.624 Vali Acc: 0.763 Test Loss: 0.624 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 1.0374109745025635
Epoch: 24, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.611 Vali Acc: 0.757 Test Loss: 0.611 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.019759178161621
Epoch: 25, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.074113130569458
Epoch: 26, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 1.016953468322754
Epoch: 27, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.582 Vali Acc: 0.763 Test Loss: 0.582 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 28 cost time: 1.0346922874450684
Epoch: 28, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 29 cost time: 1.0729966163635254
Epoch: 29, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 30 cost time: 1.0336880683898926
Epoch: 30, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 31 cost time: 1.01680326461792
Epoch: 31, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 32 cost time: 0.8918807506561279
Epoch: 32, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 0.9948008060455322
Epoch: 33, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 34 cost time: 1.0291469097137451
Epoch: 34, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 35 cost time: 0.9704749584197998
Epoch: 35, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9203662872314453
Epoch: 36, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 37 cost time: 0.9157662391662598
Epoch: 37, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 0.9374144077301025
Epoch: 38, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9058487415313721
Epoch: 39, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0073719024658203
Epoch: 40, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 41 cost time: 0.9444794654846191
Epoch: 41, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 42 cost time: 0.9647889137268066
Epoch: 42, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 43 cost time: 1.034771203994751
Epoch: 43, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 44 cost time: 1.030886173248291
Epoch: 44, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.873741626739502
Epoch: 45, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.028188705444336
Epoch: 46, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8756427764892578
Epoch: 47, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9262838363647461
Epoch: 48, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 49 cost time: 0.9732861518859863
Epoch: 49, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9631490707397461
Epoch: 50, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9980745315551758
Epoch: 51, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8719148635864258
Epoch: 52, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8818061351776123
Epoch: 53, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.0303633213043213
Epoch: 54, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.9320328235626221
Epoch: 55, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.8773517608642578
Epoch: 56, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.8849828243255615
Epoch: 57, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.8074374198913574
Epoch: 58, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 11372
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3891499042510986
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.400 Vali Acc: 0.257 Test Loss: 1.400 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 0.9538693428039551
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.373 Vali Acc: 0.303 Test Loss: 1.373 Test Acc: 0.303
Validation loss decreased (-0.256565 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.0758860111236572
Epoch: 3, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.332 Vali Acc: 0.368 Test Loss: 1.332 Test Acc: 0.368
Validation loss decreased (-0.302618 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 0.8307435512542725
Epoch: 4, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.288 Vali Acc: 0.414 Test Loss: 1.288 Test Acc: 0.414
Validation loss decreased (-0.368408 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.0119209289550781
Epoch: 5, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.241 Vali Acc: 0.487 Test Loss: 1.241 Test Acc: 0.487
Validation loss decreased (-0.414461 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 0.973440408706665
Epoch: 6, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.486830 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.839123010635376
Epoch: 7, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.142 Vali Acc: 0.513 Test Loss: 1.142 Test Acc: 0.513
Validation loss decreased (-0.499988 --> -0.513146).  Saving model ...
Epoch: 8 cost time: 0.9983901977539062
Epoch: 8, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.093 Vali Acc: 0.546 Test Loss: 1.093 Test Acc: 0.546
Validation loss decreased (-0.513146 --> -0.546042).  Saving model ...
Epoch: 9 cost time: 1.0287494659423828
Epoch: 9, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.045 Vali Acc: 0.592 Test Loss: 1.045 Test Acc: 0.592
Validation loss decreased (-0.546042 --> -0.592095).  Saving model ...
Epoch: 10 cost time: 0.7822563648223877
Epoch: 10, Steps: 10 | Train Loss: 0.907 Vali Loss: 0.996 Vali Acc: 0.638 Test Loss: 0.996 Test Acc: 0.638
Validation loss decreased (-0.592095 --> -0.638148).  Saving model ...
Epoch: 11 cost time: 0.8383059501647949
Epoch: 11, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.951 Vali Acc: 0.658 Test Loss: 0.951 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 12 cost time: 0.9552264213562012
Epoch: 12, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.910 Vali Acc: 0.678 Test Loss: 0.910 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677622).  Saving model ...
Epoch: 13 cost time: 0.9908640384674072
Epoch: 13, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.867 Vali Acc: 0.717 Test Loss: 0.867 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717097).  Saving model ...
Epoch: 14 cost time: 1.018737554550171
Epoch: 14, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.831 Vali Acc: 0.730 Test Loss: 0.831 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 0.9504299163818359
Epoch: 15, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.796 Vali Acc: 0.757 Test Loss: 0.796 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756571).  Saving model ...
Epoch: 16 cost time: 1.0300729274749756
Epoch: 16, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.766 Vali Acc: 0.763 Test Loss: 0.766 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 17 cost time: 0.8925302028656006
Epoch: 17, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.739 Vali Acc: 0.750 Test Loss: 0.739 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9176666736602783
Epoch: 18, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.713 Vali Acc: 0.757 Test Loss: 0.713 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.864346981048584
Epoch: 19, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.695 Vali Acc: 0.763 Test Loss: 0.695 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763151).  Saving model ...
Epoch: 20 cost time: 0.9135372638702393
Epoch: 20, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.675 Vali Acc: 0.770 Test Loss: 0.675 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 0.8509509563446045
Epoch: 21, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1636559963226318
Epoch: 22, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.642 Vali Acc: 0.770 Test Loss: 0.642 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 23 cost time: 1.0021770000457764
Epoch: 23, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.626 Vali Acc: 0.770 Test Loss: 0.626 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 24 cost time: 0.9195969104766846
Epoch: 24, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.612 Vali Acc: 0.770 Test Loss: 0.612 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 25 cost time: 0.9998838901519775
Epoch: 25, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 0.9439623355865479
Epoch: 26, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 0.8752841949462891
Epoch: 27, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 0.954298734664917
Epoch: 28, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 29 cost time: 0.9356567859649658
Epoch: 29, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 1.0441815853118896
Epoch: 30, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 31 cost time: 1.0811691284179688
Epoch: 31, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9230537414550781
Epoch: 32, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 33 cost time: 1.0164759159088135
Epoch: 33, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 1.0485143661499023
Epoch: 34, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0821781158447266
Epoch: 35, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 36 cost time: 0.9588360786437988
Epoch: 36, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 37 cost time: 0.8729238510131836
Epoch: 37, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8793179988861084
Epoch: 38, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 39 cost time: 1.023139476776123
Epoch: 39, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9628121852874756
Epoch: 40, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 41 cost time: 1.0135798454284668
Epoch: 41, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.833282470703125
Epoch: 42, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9297549724578857
Epoch: 43, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0118463039398193
Epoch: 44, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8798840045928955
Epoch: 45, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 46 cost time: 0.9427506923675537
Epoch: 46, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 47 cost time: 1.0564918518066406
Epoch: 47, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0270886421203613
Epoch: 48, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9697937965393066
Epoch: 49, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8532257080078125
Epoch: 50, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9789538383483887
Epoch: 51, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.955197811126709
Epoch: 52, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.163353681564331
Epoch: 53, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.895941972732544
Epoch: 54, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.978560209274292
Epoch: 55, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9753530025482178
Epoch: 56, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 11372
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2524290084838867
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.403 Vali Acc: 0.263 Test Loss: 1.403 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.0223615169525146
Epoch: 2, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.377 Vali Acc: 0.309 Test Loss: 1.377 Test Acc: 0.309
Validation loss decreased (-0.263144 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.8512818813323975
Epoch: 3, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.342 Vali Acc: 0.362 Test Loss: 1.342 Test Acc: 0.362
Validation loss decreased (-0.309197 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 0.8201727867126465
Epoch: 4, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.303 Vali Acc: 0.421 Test Loss: 1.303 Test Acc: 0.421
Validation loss decreased (-0.361829 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 0.9091296195983887
Epoch: 5, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.262 Vali Acc: 0.474 Test Loss: 1.262 Test Acc: 0.474
Validation loss decreased (-0.421040 --> -0.473672).  Saving model ...
Epoch: 6 cost time: 0.9319801330566406
Epoch: 6, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.214 Vali Acc: 0.526 Test Loss: 1.214 Test Acc: 0.526
Validation loss decreased (-0.473672 --> -0.526304).  Saving model ...
Epoch: 7 cost time: 0.9022037982940674
Epoch: 7, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.165 Vali Acc: 0.566 Test Loss: 1.165 Test Acc: 0.566
Validation loss decreased (-0.526304 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 0.8459563255310059
Epoch: 8, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.118 Vali Acc: 0.572 Test Loss: 1.118 Test Acc: 0.572
Validation loss decreased (-0.565778 --> -0.572357).  Saving model ...
Epoch: 9 cost time: 0.8422689437866211
Epoch: 9, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.073 Vali Acc: 0.605 Test Loss: 1.073 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605252).  Saving model ...
Epoch: 10 cost time: 0.9633424282073975
Epoch: 10, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.025 Vali Acc: 0.638 Test Loss: 1.025 Test Acc: 0.638
Validation loss decreased (-0.605252 --> -0.638148).  Saving model ...
Epoch: 11 cost time: 0.9618017673492432
Epoch: 11, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.977 Vali Acc: 0.658 Test Loss: 0.977 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 12 cost time: 0.8882379531860352
Epoch: 12, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.937 Vali Acc: 0.658 Test Loss: 0.937 Test Acc: 0.658
Validation loss decreased (-0.657885 --> -0.657885).  Saving model ...
Epoch: 13 cost time: 0.9282658100128174
Epoch: 13, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.898 Vali Acc: 0.671 Test Loss: 0.898 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671044).  Saving model ...
Epoch: 14 cost time: 1.050783395767212
Epoch: 14, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.860 Vali Acc: 0.697 Test Loss: 0.860 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697360).  Saving model ...
Epoch: 15 cost time: 0.9741148948669434
Epoch: 15, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.828 Vali Acc: 0.704 Test Loss: 0.828 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703939).  Saving model ...
Epoch: 16 cost time: 0.9085707664489746
Epoch: 16, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.797 Vali Acc: 0.724 Test Loss: 0.797 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723676).  Saving model ...
Epoch: 17 cost time: 1.0531418323516846
Epoch: 17, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.766 Vali Acc: 0.730 Test Loss: 0.766 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 1.0790679454803467
Epoch: 18, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.737 Vali Acc: 0.743 Test Loss: 0.737 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 1.0793702602386475
Epoch: 19, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 1.0354244709014893
Epoch: 20, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.694 Vali Acc: 0.770 Test Loss: 0.694 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 1.0738496780395508
Epoch: 21, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0465846061706543
Epoch: 22, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.658 Vali Acc: 0.770 Test Loss: 0.658 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 23 cost time: 1.002563238143921
Epoch: 23, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.643 Vali Acc: 0.776 Test Loss: 0.643 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 24 cost time: 0.8755679130554199
Epoch: 24, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.627 Vali Acc: 0.776 Test Loss: 0.627 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 25 cost time: 0.8551836013793945
Epoch: 25, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.616 Vali Acc: 0.763 Test Loss: 0.616 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9346685409545898
Epoch: 26, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.604 Vali Acc: 0.770 Test Loss: 0.604 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8063433170318604
Epoch: 27, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8558905124664307
Epoch: 28, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0208683013916016
Epoch: 29, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 1.081183910369873
Epoch: 30, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9220485687255859
Epoch: 31, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1587278842926025
Epoch: 32, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9814131259918213
Epoch: 33, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0216693878173828
Epoch: 34, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.549 Vali Acc: 0.776 Test Loss: 0.549 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9230458736419678
Epoch: 35, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1165266036987305
Epoch: 36, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.989591121673584
Epoch: 37, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 38 cost time: 1.073906421661377
Epoch: 38, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0841617584228516
Epoch: 39, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.532 Vali Acc: 0.770 Test Loss: 0.532 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1062870025634766
Epoch: 40, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1483705043792725
Epoch: 41, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.527 Vali Acc: 0.763 Test Loss: 0.527 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2002308368682861
Epoch: 42, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 43 cost time: 1.1830744743347168
Epoch: 43, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0894315242767334
Epoch: 44, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0760152339935303
Epoch: 45, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.518 Vali Acc: 0.770 Test Loss: 0.518 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1365041732788086
Epoch: 46, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8930745124816895
Epoch: 47, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0221076011657715
Epoch: 48, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 49 cost time: 0.8470015525817871
Epoch: 49, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0712089538574219
Epoch: 50, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.524 Vali Acc: 0.763 Test Loss: 0.524 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9557170867919922
Epoch: 51, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9270229339599609
Epoch: 52, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.9615805149078369
Epoch: 53, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.0665783882141113
Epoch: 54, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.525 Vali Acc: 0.763 Test Loss: 0.525 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8859572410583496
Epoch: 55, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.530 Vali Acc: 0.757 Test Loss: 0.530 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.161323070526123
Epoch: 56, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 57 cost time: 1.1481752395629883
Epoch: 57, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0375070571899414
Epoch: 58, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.544 Vali Acc: 0.757 Test Loss: 0.544 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.053602933883667
Epoch: 59, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.1843843460083008
Epoch: 60, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.0777101516723633
Epoch: 61, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9895222187042236
Epoch: 62, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.9315366744995117
Epoch: 63, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.0055699348449707
Epoch: 64, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.1511471271514893
Epoch: 65, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.0709643363952637
Epoch: 66, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 11372
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.312732696533203
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.371 Vali Acc: 0.296 Test Loss: 1.371 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.9365220069885254
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.352 Vali Acc: 0.316 Test Loss: 1.352 Test Acc: 0.316
Validation loss decreased (-0.296039 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.0071113109588623
Epoch: 3, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.324 Vali Acc: 0.382 Test Loss: 1.324 Test Acc: 0.382
Validation loss decreased (-0.315776 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 0.9508812427520752
Epoch: 4, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.291 Vali Acc: 0.441 Test Loss: 1.291 Test Acc: 0.441
Validation loss decreased (-0.381566 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 0.8973660469055176
Epoch: 5, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.253 Vali Acc: 0.480 Test Loss: 1.253 Test Acc: 0.480
Validation loss decreased (-0.440777 --> -0.480251).  Saving model ...
Epoch: 6 cost time: 1.1183726787567139
Epoch: 6, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.211 Vali Acc: 0.513 Test Loss: 1.211 Test Acc: 0.513
Validation loss decreased (-0.480251 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 0.875511884689331
Epoch: 7, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.172 Vali Acc: 0.572 Test Loss: 1.172 Test Acc: 0.572
Validation loss decreased (-0.513146 --> -0.572357).  Saving model ...
Epoch: 8 cost time: 1.069657802581787
Epoch: 8, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.132 Vali Acc: 0.612 Test Loss: 1.132 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611831).  Saving model ...
Epoch: 9 cost time: 0.9623680114746094
Epoch: 9, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.092 Vali Acc: 0.638 Test Loss: 1.092 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638147).  Saving model ...
Epoch: 10 cost time: 1.0036556720733643
Epoch: 10, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.052 Vali Acc: 0.664 Test Loss: 1.052 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664463).  Saving model ...
Epoch: 11 cost time: 0.899747371673584
Epoch: 11, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.013 Vali Acc: 0.671 Test Loss: 1.013 Test Acc: 0.671
Validation loss decreased (-0.664463 --> -0.671042).  Saving model ...
Epoch: 12 cost time: 1.1178653240203857
Epoch: 12, Steps: 10 | Train Loss: 0.870 Vali Loss: 0.976 Vali Acc: 0.704 Test Loss: 0.976 Test Acc: 0.704
Validation loss decreased (-0.671042 --> -0.703938).  Saving model ...
Epoch: 13 cost time: 1.0138750076293945
Epoch: 13, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.939 Vali Acc: 0.730 Test Loss: 0.939 Test Acc: 0.730
Validation loss decreased (-0.703938 --> -0.730254).  Saving model ...
Epoch: 14 cost time: 0.8807618618011475
Epoch: 14, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.903 Vali Acc: 0.737 Test Loss: 0.903 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736833).  Saving model ...
Epoch: 15 cost time: 0.8422732353210449
Epoch: 15, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.870 Vali Acc: 0.743 Test Loss: 0.870 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743412).  Saving model ...
Epoch: 16 cost time: 1.0060200691223145
Epoch: 16, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.837 Vali Acc: 0.743 Test Loss: 0.837 Test Acc: 0.743
Validation loss decreased (-0.743412 --> -0.743413).  Saving model ...
Epoch: 17 cost time: 1.0574612617492676
Epoch: 17, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 0.9118938446044922
Epoch: 18, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.9248979091644287
Epoch: 19, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.761 Vali Acc: 0.737 Test Loss: 0.761 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9620451927185059
Epoch: 20, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.736 Vali Acc: 0.763 Test Loss: 0.736 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 0.9584763050079346
Epoch: 21, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 22 cost time: 1.011833667755127
Epoch: 22, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.693 Vali Acc: 0.757 Test Loss: 0.693 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1267216205596924
Epoch: 23, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.676 Vali Acc: 0.750 Test Loss: 0.676 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9978618621826172
Epoch: 24, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782888).  Saving model ...
Epoch: 25 cost time: 0.9832160472869873
Epoch: 25, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 26 cost time: 1.011955976486206
Epoch: 26, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9916298389434814
Epoch: 27, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.623 Vali Acc: 0.776 Test Loss: 0.623 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9994494915008545
Epoch: 28, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.984222412109375
Epoch: 29, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0740361213684082
Epoch: 30, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1412575244903564
Epoch: 31, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.586 Vali Acc: 0.763 Test Loss: 0.586 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0102274417877197
Epoch: 32, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0419743061065674
Epoch: 33, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.038970947265625
Epoch: 34, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 1.0823280811309814
Epoch: 35, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.565 Vali Acc: 0.757 Test Loss: 0.565 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0888264179229736
Epoch: 36, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 37 cost time: 0.8332736492156982
Epoch: 37, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 1.0306737422943115
Epoch: 38, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0086650848388672
Epoch: 39, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.008674144744873
Epoch: 40, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9875767230987549
Epoch: 41, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0496647357940674
Epoch: 42, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 43 cost time: 1.0107533931732178
Epoch: 43, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0291481018066406
Epoch: 44, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0410873889923096
Epoch: 45, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0026943683624268
Epoch: 46, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9357421398162842
Epoch: 47, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.926884651184082
Epoch: 48, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0456452369689941
Epoch: 49, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0475687980651855
Epoch: 50, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.1557550430297852
Epoch: 51, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.160750389099121
Epoch: 52, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ETSformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 11372
model size : 0.66MB
