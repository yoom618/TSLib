Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4248597621917725
Epoch: 1, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.270 Vali Acc: 0.375 Test Loss: 1.270 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.6611344814300537
Epoch: 2, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.131 Vali Acc: 0.525 Test Loss: 1.131 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524989).  Saving model ...
Epoch: 3 cost time: 0.6787841320037842
Epoch: 3, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.926 Vali Acc: 0.500 Test Loss: 0.926 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6364693641662598
Epoch: 4, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.635 Vali Acc: 0.900 Test Loss: 0.635 Test Acc: 0.900
Validation loss decreased (-0.524989 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 0.8099632263183594
Epoch: 5, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.479 Vali Acc: 0.925 Test Loss: 0.479 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 6 cost time: 0.6946895122528076
Epoch: 6, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6755280494689941
Epoch: 7, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.694800615310669
Epoch: 8, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7596919536590576
Epoch: 9, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8311774730682373
Epoch: 10, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7861692905426025
Epoch: 11, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7010188102722168
Epoch: 12, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7620136737823486
Epoch: 13, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8217360973358154
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7458419799804688
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 5479508
model size : 30.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.744170904159546
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.290 Vali Acc: 0.375 Test Loss: 1.290 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.6936547756195068
Epoch: 2, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.148 Vali Acc: 0.475 Test Loss: 1.148 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474989).  Saving model ...
Epoch: 3 cost time: 0.7254879474639893
Epoch: 3, Steps: 3 | Train Loss: 0.928 Vali Loss: 0.935 Vali Acc: 0.575 Test Loss: 0.935 Test Acc: 0.575
Validation loss decreased (-0.474989 --> -0.574991).  Saving model ...
Epoch: 4 cost time: 0.7376470565795898
Epoch: 4, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.642 Vali Acc: 0.875 Test Loss: 0.642 Test Acc: 0.875
Validation loss decreased (-0.574991 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.886481761932373
Epoch: 5, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 6 cost time: 0.7277984619140625
Epoch: 6, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7213943004608154
Epoch: 7, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9058737754821777
Epoch: 8, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7364819049835205
Epoch: 9, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.788844108581543
Epoch: 10, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7887554168701172
Epoch: 11, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7039954662322998
Epoch: 12, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.719010591506958
Epoch: 13, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8212387561798096
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8569316864013672
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 5479508
model size : 30.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.692995548248291
Epoch: 1, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.314 Vali Acc: 0.300 Test Loss: 1.314 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.7209610939025879
Epoch: 2, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.174 Vali Acc: 0.425 Test Loss: 1.174 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424988).  Saving model ...
Epoch: 3 cost time: 0.6687374114990234
Epoch: 3, Steps: 3 | Train Loss: 0.926 Vali Loss: 0.951 Vali Acc: 0.650 Test Loss: 0.951 Test Acc: 0.650
Validation loss decreased (-0.424988 --> -0.649990).  Saving model ...
Epoch: 4 cost time: 0.7171304225921631
Epoch: 4, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.655 Vali Acc: 0.875 Test Loss: 0.655 Test Acc: 0.875
Validation loss decreased (-0.649990 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 0.8065800666809082
Epoch: 5, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.481 Vali Acc: 0.925 Test Loss: 0.481 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924995).  Saving model ...
Epoch: 6 cost time: 0.7468371391296387
Epoch: 6, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8256359100341797
Epoch: 7, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8542847633361816
Epoch: 8, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7248754501342773
Epoch: 9, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7509253025054932
Epoch: 10, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924997).  Saving model ...
Epoch: 11 cost time: 0.8109538555145264
Epoch: 11, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 12 cost time: 0.8213832378387451
Epoch: 12, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7780027389526367
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7596945762634277
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7799572944641113
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7801764011383057
Epoch: 16, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8126592636108398
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7480783462524414
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7427661418914795
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.840958833694458
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7376036643981934
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 5479508
model size : 30.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7325098514556885
Epoch: 1, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.267 Vali Acc: 0.425 Test Loss: 1.267 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.7282421588897705
Epoch: 2, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.132 Vali Acc: 0.575 Test Loss: 1.132 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574989).  Saving model ...
Epoch: 3 cost time: 0.675213098526001
Epoch: 3, Steps: 3 | Train Loss: 0.911 Vali Loss: 0.909 Vali Acc: 0.775 Test Loss: 0.909 Test Acc: 0.775
Validation loss decreased (-0.574989 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 0.7651150226593018
Epoch: 4, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.629 Vali Acc: 0.950 Test Loss: 0.629 Test Acc: 0.950
Validation loss decreased (-0.774991 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 0.737339973449707
Epoch: 5, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.451 Vali Acc: 0.950 Test Loss: 0.451 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.8162407875061035
Epoch: 6, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7198798656463623
Epoch: 7, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7808017730712891
Epoch: 8, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8007557392120361
Epoch: 9, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949998).  Saving model ...
Epoch: 10 cost time: 0.8259978294372559
Epoch: 10, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 11 cost time: 0.866023063659668
Epoch: 11, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 12 cost time: 0.7430050373077393
Epoch: 12, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.847959041595459
Epoch: 13, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.7955212593078613
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.7012424468994141
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.7707746028900146
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7342181205749512
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.6879172325134277
Epoch: 18, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.7043890953063965
Epoch: 19, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.7414000034332275
Epoch: 20, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 0.6051013469696045
Epoch: 21, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 0.7362253665924072
Epoch: 22, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 0.7848730087280273
Epoch: 23, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 0.7081832885742188
Epoch: 24, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 0.6448245048522949
Epoch: 25, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.7172186374664307
Epoch: 26, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 0.594106912612915
Epoch: 27, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 0.6514358520507812
Epoch: 28, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 0.7149105072021484
Epoch: 29, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 0.6965718269348145
Epoch: 30, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 31 cost time: 0.6994645595550537
Epoch: 31, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 32 cost time: 0.8095595836639404
Epoch: 32, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 33 cost time: 0.5992336273193359
Epoch: 33, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.7466685771942139
Epoch: 34, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.8442478179931641
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6775362491607666
Epoch: 36, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8160097599029541
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7469654083251953
Epoch: 38, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8854081630706787
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8153853416442871
Epoch: 40, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6750977039337158
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7636816501617432
Epoch: 42, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7736010551452637
Epoch: 43, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7587850093841553
Epoch: 44, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 5479508
model size : 30.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.630695343017578
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.334 Vali Acc: 0.275 Test Loss: 1.334 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.7964732646942139
Epoch: 2, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.188 Vali Acc: 0.350 Test Loss: 1.188 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 0.8132514953613281
Epoch: 3, Steps: 3 | Train Loss: 0.990 Vali Loss: 0.941 Vali Acc: 0.550 Test Loss: 0.941 Test Acc: 0.550
Validation loss decreased (-0.349988 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 0.7259597778320312
Epoch: 4, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.642 Vali Acc: 0.925 Test Loss: 0.642 Test Acc: 0.925
Validation loss decreased (-0.549991 --> -0.924994).  Saving model ...
Epoch: 5 cost time: 0.7280843257904053
Epoch: 5, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.477 Vali Acc: 0.975 Test Loss: 0.477 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 6 cost time: 0.7091450691223145
Epoch: 6, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7738091945648193
Epoch: 7, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7267014980316162
Epoch: 8, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7181487083435059
Epoch: 9, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6277940273284912
Epoch: 10, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5389597415924072
Epoch: 11, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5903623104095459
Epoch: 12, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7494363784790039
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7490653991699219
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7515168190002441
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3382356
model size : 22.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4383068084716797
Epoch: 1, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.328 Vali Acc: 0.375 Test Loss: 1.328 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.7086091041564941
Epoch: 2, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.7483797073364258
Epoch: 3, Steps: 3 | Train Loss: 1.018 Vali Loss: 0.946 Vali Acc: 0.625 Test Loss: 0.946 Test Acc: 0.625
Validation loss decreased (-0.399988 --> -0.624991).  Saving model ...
Epoch: 4 cost time: 0.7771973609924316
Epoch: 4, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.644 Vali Acc: 0.950 Test Loss: 0.644 Test Acc: 0.950
Validation loss decreased (-0.624991 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 0.7037925720214844
Epoch: 5, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.469 Vali Acc: 0.950 Test Loss: 0.469 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.67635178565979
Epoch: 6, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7273285388946533
Epoch: 7, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.770801305770874
Epoch: 8, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7849280834197998
Epoch: 9, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7633130550384521
Epoch: 10, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6762609481811523
Epoch: 11, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7951736450195312
Epoch: 12, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7235751152038574
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8433749675750732
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7468738555908203
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 3382356
model size : 22.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7037911415100098
Epoch: 1, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.318 Vali Acc: 0.300 Test Loss: 1.318 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.6595466136932373
Epoch: 2, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.168 Vali Acc: 0.425 Test Loss: 1.168 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424988).  Saving model ...
Epoch: 3 cost time: 0.7369272708892822
Epoch: 3, Steps: 3 | Train Loss: 1.013 Vali Loss: 0.934 Vali Acc: 0.750 Test Loss: 0.934 Test Acc: 0.750
Validation loss decreased (-0.424988 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 0.7070558071136475
Epoch: 4, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.645 Vali Acc: 0.925 Test Loss: 0.645 Test Acc: 0.925
Validation loss decreased (-0.749991 --> -0.924994).  Saving model ...
Epoch: 5 cost time: 0.7174768447875977
Epoch: 5, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 6 cost time: 0.8275940418243408
Epoch: 6, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.421 Vali Acc: 0.950 Test Loss: 0.421 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.7510480880737305
Epoch: 7, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7160379886627197
Epoch: 8, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7799727916717529
Epoch: 9, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7840960025787354
Epoch: 10, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8097372055053711
Epoch: 11, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.775754451751709
Epoch: 12, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7604801654815674
Epoch: 13, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.669243574142456
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7166376113891602
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.688835859298706
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 3382356
model size : 22.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.645259141921997
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.6955463886260986
Epoch: 2, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.157 Vali Acc: 0.575 Test Loss: 1.157 Test Acc: 0.575
Validation loss decreased (-0.399987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 0.7325987815856934
Epoch: 3, Steps: 3 | Train Loss: 1.026 Vali Loss: 0.918 Vali Acc: 0.825 Test Loss: 0.918 Test Acc: 0.825
Validation loss decreased (-0.574988 --> -0.824991).  Saving model ...
Epoch: 4 cost time: 0.7596118450164795
Epoch: 4, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.656 Vali Acc: 0.925 Test Loss: 0.656 Test Acc: 0.925
Validation loss decreased (-0.824991 --> -0.924993).  Saving model ...
Epoch: 5 cost time: 0.70432448387146
Epoch: 5, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.472 Vali Acc: 0.975 Test Loss: 0.472 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974995).  Saving model ...
Epoch: 6 cost time: 0.7097358703613281
Epoch: 6, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6746826171875
Epoch: 7, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7197184562683105
Epoch: 8, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6795432567596436
Epoch: 9, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6681342124938965
Epoch: 10, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6865720748901367
Epoch: 11, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.925 Test Loss: 0.177 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6403753757476807
Epoch: 12, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.925 Test Loss: 0.164 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6332018375396729
Epoch: 13, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.925 Test Loss: 0.151 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6604506969451904
Epoch: 14, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.143 Vali Acc: 0.925 Test Loss: 0.143 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6174201965332031
Epoch: 15, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.925 Test Loss: 0.135 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3382356
model size : 22.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7815239429473877
Epoch: 1, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.269 Vali Acc: 0.300 Test Loss: 1.269 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.7199585437774658
Epoch: 2, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.127 Vali Acc: 0.475 Test Loss: 1.127 Test Acc: 0.475
Validation loss decreased (-0.299987 --> -0.474989).  Saving model ...
Epoch: 3 cost time: 0.7291722297668457
Epoch: 3, Steps: 3 | Train Loss: 0.945 Vali Loss: 0.883 Vali Acc: 0.675 Test Loss: 0.883 Test Acc: 0.675
Validation loss decreased (-0.474989 --> -0.674991).  Saving model ...
Epoch: 4 cost time: 0.7641260623931885
Epoch: 4, Steps: 3 | Train Loss: 0.636 Vali Loss: 0.652 Vali Acc: 0.875 Test Loss: 0.652 Test Acc: 0.875
Validation loss decreased (-0.674991 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 0.655479907989502
Epoch: 5, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.516 Vali Acc: 0.925 Test Loss: 0.516 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924995).  Saving model ...
Epoch: 6 cost time: 0.5506839752197266
Epoch: 6, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7287313938140869
Epoch: 7, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6667964458465576
Epoch: 8, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 0.5718433856964111
Epoch: 9, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 0.6762197017669678
Epoch: 10, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7352774143218994
Epoch: 11, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6455371379852295
Epoch: 12, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7254703044891357
Epoch: 13, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6417789459228516
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6027228832244873
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5890545845031738
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.925 Test Loss: 0.492 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.620039701461792
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.529 Vali Acc: 0.925 Test Loss: 0.529 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5923135280609131
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.925 Test Loss: 0.562 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5858895778656006
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.925 Test Loss: 0.583 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2333780
model size : 18.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1949970722198486
Epoch: 1, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.281 Vali Acc: 0.300 Test Loss: 1.281 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.5397555828094482
Epoch: 2, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.146 Vali Acc: 0.525 Test Loss: 1.146 Test Acc: 0.525
Validation loss decreased (-0.299987 --> -0.524989).  Saving model ...
Epoch: 3 cost time: 0.6707990169525146
Epoch: 3, Steps: 3 | Train Loss: 0.928 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
Validation loss decreased (-0.524989 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 0.5820190906524658
Epoch: 4, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.662 Vali Acc: 0.925 Test Loss: 0.662 Test Acc: 0.925
Validation loss decreased (-0.699991 --> -0.924993).  Saving model ...
Epoch: 5 cost time: 0.590416431427002
Epoch: 5, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924995).  Saving model ...
Epoch: 6 cost time: 0.6846089363098145
Epoch: 6, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6288485527038574
Epoch: 7, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7397561073303223
Epoch: 8, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7929856777191162
Epoch: 9, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 0.6399450302124023
Epoch: 10, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7175202369689941
Epoch: 11, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6860976219177246
Epoch: 12, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6336157321929932
Epoch: 13, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7200973033905029
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7806262969970703
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.664358377456665
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.74300217628479
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.456 Vali Acc: 0.925 Test Loss: 0.456 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7429113388061523
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.925 Test Loss: 0.486 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8036694526672363
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.925 Test Loss: 0.508 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2333780
model size : 18.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6671786308288574
Epoch: 1, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.288 Vali Acc: 0.275 Test Loss: 1.288 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.8036112785339355
Epoch: 2, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.161 Vali Acc: 0.450 Test Loss: 1.161 Test Acc: 0.450
Validation loss decreased (-0.274987 --> -0.449988).  Saving model ...
Epoch: 3 cost time: 0.7629992961883545
Epoch: 3, Steps: 3 | Train Loss: 0.944 Vali Loss: 0.920 Vali Acc: 0.775 Test Loss: 0.920 Test Acc: 0.775
Validation loss decreased (-0.449988 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 0.8272993564605713
Epoch: 4, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.668 Vali Acc: 0.900 Test Loss: 0.668 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899993).  Saving model ...
Epoch: 5 cost time: 0.7290661334991455
Epoch: 5, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.485 Vali Acc: 0.950 Test Loss: 0.485 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.7979259490966797
Epoch: 6, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6415953636169434
Epoch: 7, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6639578342437744
Epoch: 8, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.775275707244873
Epoch: 9, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5864472389221191
Epoch: 10, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7186102867126465
Epoch: 11, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.797698974609375
Epoch: 12, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6347439289093018
Epoch: 13, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6731619834899902
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7985777854919434
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2333780
model size : 18.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3750689029693604
Epoch: 1, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.250 Vali Acc: 0.450 Test Loss: 1.250 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.6926250457763672
Epoch: 2, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.128 Vali Acc: 0.675 Test Loss: 1.128 Test Acc: 0.675
Validation loss decreased (-0.449987 --> -0.674989).  Saving model ...
Epoch: 3 cost time: 0.6638026237487793
Epoch: 3, Steps: 3 | Train Loss: 0.908 Vali Loss: 0.885 Vali Acc: 0.900 Test Loss: 0.885 Test Acc: 0.900
Validation loss decreased (-0.674989 --> -0.899991).  Saving model ...
Epoch: 4 cost time: 0.7911255359649658
Epoch: 4, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.636 Vali Acc: 0.975 Test Loss: 0.636 Test Acc: 0.975
Validation loss decreased (-0.899991 --> -0.974994).  Saving model ...
Epoch: 5 cost time: 0.776839017868042
Epoch: 5, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.454 Vali Acc: 0.975 Test Loss: 0.454 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 6 cost time: 0.7955198287963867
Epoch: 6, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7994496822357178
Epoch: 7, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7910242080688477
Epoch: 8, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8060364723205566
Epoch: 9, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8482751846313477
Epoch: 10, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7801206111907959
Epoch: 11, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7568380832672119
Epoch: 12, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7947092056274414
Epoch: 13, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7256734371185303
Epoch: 14, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7980973720550537
Epoch: 15, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2333780
model size : 18.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5180535316467285
Epoch: 1, Steps: 3 | Train Loss: 1.490 Vali Loss: 1.267 Vali Acc: 0.250 Test Loss: 1.267 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.7680478096008301
Epoch: 2, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.122 Vali Acc: 0.300 Test Loss: 1.122 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299989).  Saving model ...
Epoch: 3 cost time: 0.6999554634094238
Epoch: 3, Steps: 3 | Train Loss: 1.077 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
Validation loss decreased (-0.299989 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 0.8113381862640381
Epoch: 4, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 0.6376328468322754
Epoch: 5, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.485 Vali Acc: 0.975 Test Loss: 0.485 Test Acc: 0.975
Validation loss decreased (-0.849994 --> -0.974995).  Saving model ...
Epoch: 6 cost time: 0.7634742259979248
Epoch: 6, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 7 cost time: 0.5964853763580322
Epoch: 7, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6901278495788574
Epoch: 8, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7458584308624268
Epoch: 9, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6597409248352051
Epoch: 10, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6871414184570312
Epoch: 11, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.590867280960083
Epoch: 12, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6603429317474365
Epoch: 13, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6319646835327148
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6639189720153809
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6651034355163574
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1809492
model size : 16.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6558704376220703
Epoch: 1, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.293 Vali Acc: 0.350 Test Loss: 1.293 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.6660816669464111
Epoch: 2, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.149 Vali Acc: 0.325 Test Loss: 1.149 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6914510726928711
Epoch: 3, Steps: 3 | Train Loss: 1.064 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.349987 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 0.6490769386291504
Epoch: 4, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.666 Vali Acc: 0.900 Test Loss: 0.666 Test Acc: 0.900
Validation loss decreased (-0.749991 --> -0.899993).  Saving model ...
Epoch: 5 cost time: 0.6650934219360352
Epoch: 5, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.482 Vali Acc: 0.975 Test Loss: 0.482 Test Acc: 0.975
Validation loss decreased (-0.899993 --> -0.974995).  Saving model ...
Epoch: 6 cost time: 0.6726484298706055
Epoch: 6, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.390 Vali Acc: 0.975 Test Loss: 0.390 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 7 cost time: 0.7074582576751709
Epoch: 7, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6828479766845703
Epoch: 8, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6056888103485107
Epoch: 9, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6836419105529785
Epoch: 10, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7366480827331543
Epoch: 11, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7275855541229248
Epoch: 12, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7176635265350342
Epoch: 13, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6957573890686035
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7089993953704834
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.631976842880249
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1809492
model size : 16.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.380711793899536
Epoch: 1, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.6819682121276855
Epoch: 2, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 0.6276185512542725
Epoch: 3, Steps: 3 | Train Loss: 1.062 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
Validation loss decreased (-0.499989 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 0.6981370449066162
Epoch: 4, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.647 Vali Acc: 0.925 Test Loss: 0.647 Test Acc: 0.925
Validation loss decreased (-0.774991 --> -0.924994).  Saving model ...
Epoch: 5 cost time: 0.6566720008850098
Epoch: 5, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.473 Vali Acc: 0.950 Test Loss: 0.473 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.7024099826812744
Epoch: 6, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.7688157558441162
Epoch: 7, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 0.7754929065704346
Epoch: 8, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7107782363891602
Epoch: 9, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7390155792236328
Epoch: 10, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6759941577911377
Epoch: 11, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7525773048400879
Epoch: 12, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7702381610870361
Epoch: 13, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6792876720428467
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7048234939575195
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6409506797790527
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6879069805145264
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1809492
model size : 16.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4833078384399414
Epoch: 1, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.322 Vali Acc: 0.300 Test Loss: 1.322 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.7159502506256104
Epoch: 2, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.175 Vali Acc: 0.450 Test Loss: 1.175 Test Acc: 0.450
Validation loss decreased (-0.299987 --> -0.449988).  Saving model ...
Epoch: 3 cost time: 0.8228943347930908
Epoch: 3, Steps: 3 | Train Loss: 1.034 Vali Loss: 0.918 Vali Acc: 0.850 Test Loss: 0.918 Test Acc: 0.850
Validation loss decreased (-0.449988 --> -0.849991).  Saving model ...
Epoch: 4 cost time: 0.70395827293396
Epoch: 4, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.666 Vali Acc: 0.925 Test Loss: 0.666 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924993).  Saving model ...
Epoch: 5 cost time: 0.7146437168121338
Epoch: 5, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.485 Vali Acc: 0.975 Test Loss: 0.485 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974995).  Saving model ...
Epoch: 6 cost time: 0.7568302154541016
Epoch: 6, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7061715126037598
Epoch: 7, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7106070518493652
Epoch: 8, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7176482677459717
Epoch: 9, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7436532974243164
Epoch: 10, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7831861972808838
Epoch: 11, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.176 Vali Acc: 0.925 Test Loss: 0.176 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.703178882598877
Epoch: 12, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.925 Test Loss: 0.158 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7112746238708496
Epoch: 13, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.148 Vali Acc: 0.925 Test Loss: 0.148 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7928614616394043
Epoch: 14, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.139 Vali Acc: 0.925 Test Loss: 0.139 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7280135154724121
Epoch: 15, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974999).  Saving model ...
Epoch: 16 cost time: 0.7313907146453857
Epoch: 16, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 17 cost time: 0.6994035243988037
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 18 cost time: 0.7263445854187012
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 19 cost time: 0.768601655960083
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.950 Test Loss: 0.127 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.825749397277832
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.950 Test Loss: 0.127 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.693436861038208
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6681535243988037
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7305970191955566
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7008421421051025
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6728315353393555
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7323992252349854
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7232260704040527
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6271810531616211
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1809492
model size : 16.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4967262744903564
Epoch: 1, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.227 Vali Acc: 0.350 Test Loss: 1.227 Test Acc: 0.350
Validation loss decreased (inf --> -0.349988).  Saving model ...
Epoch: 2 cost time: 0.648139238357544
Epoch: 2, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.089 Vali Acc: 0.450 Test Loss: 1.089 Test Acc: 0.450
Validation loss decreased (-0.349988 --> -0.449989).  Saving model ...
Epoch: 3 cost time: 0.5839827060699463
Epoch: 3, Steps: 3 | Train Loss: 0.936 Vali Loss: 0.841 Vali Acc: 0.800 Test Loss: 0.841 Test Acc: 0.800
Validation loss decreased (-0.449989 --> -0.799992).  Saving model ...
Epoch: 4 cost time: 0.7103900909423828
Epoch: 4, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.622 Vali Acc: 0.900 Test Loss: 0.622 Test Acc: 0.900
Validation loss decreased (-0.799992 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 0.7683811187744141
Epoch: 5, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6602747440338135
Epoch: 6, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 0.6584076881408691
Epoch: 7, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.7239072322845459
Epoch: 8, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 0.7130541801452637
Epoch: 9, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 10 cost time: 0.7544846534729004
Epoch: 10, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 11 cost time: 0.6579985618591309
Epoch: 11, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.64040207862854
Epoch: 12, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6902050971984863
Epoch: 13, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7196195125579834
Epoch: 14, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6915974617004395
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7832620143890381
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6555936336517334
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8010542392730713
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.900 Test Loss: 0.585 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7974159717559814
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7731280326843262
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.547 Vali Acc: 0.925 Test Loss: 0.547 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1547348
model size : 15.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4500441551208496
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.244 Vali Acc: 0.325 Test Loss: 1.244 Test Acc: 0.325
Validation loss decreased (inf --> -0.324988).  Saving model ...
Epoch: 2 cost time: 0.6596977710723877
Epoch: 2, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.110 Vali Acc: 0.450 Test Loss: 1.110 Test Acc: 0.450
Validation loss decreased (-0.324988 --> -0.449989).  Saving model ...
Epoch: 3 cost time: 0.6676199436187744
Epoch: 3, Steps: 3 | Train Loss: 0.952 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
Validation loss decreased (-0.449989 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 0.6296505928039551
Epoch: 4, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.641 Vali Acc: 0.875 Test Loss: 0.641 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.6413471698760986
Epoch: 5, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.593613862991333
Epoch: 6, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.484 Vali Acc: 0.950 Test Loss: 0.484 Test Acc: 0.950
Validation loss decreased (-0.874995 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 0.6284501552581787
Epoch: 7, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.449 Vali Acc: 0.950 Test Loss: 0.449 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 0.5994982719421387
Epoch: 8, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 0.6540913581848145
Epoch: 9, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.6387600898742676
Epoch: 10, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6469821929931641
Epoch: 11, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6535429954528809
Epoch: 12, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7777652740478516
Epoch: 13, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.731499433517456
Epoch: 14, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.663811445236206
Epoch: 15, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6503710746765137
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7062270641326904
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.532 Vali Acc: 0.925 Test Loss: 0.532 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6242177486419678
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7217104434967041
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.925 Test Loss: 0.540 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1547348
model size : 15.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5295937061309814
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.277 Vali Acc: 0.300 Test Loss: 1.277 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.653226375579834
Epoch: 2, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.142 Vali Acc: 0.425 Test Loss: 1.142 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424989).  Saving model ...
Epoch: 3 cost time: 0.6656224727630615
Epoch: 3, Steps: 3 | Train Loss: 0.992 Vali Loss: 0.885 Vali Acc: 0.850 Test Loss: 0.885 Test Acc: 0.850
Validation loss decreased (-0.424989 --> -0.849991).  Saving model ...
Epoch: 4 cost time: 0.683560848236084
Epoch: 4, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.652 Vali Acc: 0.900 Test Loss: 0.652 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899993).  Saving model ...
Epoch: 5 cost time: 0.7770495414733887
Epoch: 5, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.514 Vali Acc: 0.950 Test Loss: 0.514 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.6941914558410645
Epoch: 6, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 0.6945018768310547
Epoch: 7, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 0.6816785335540771
Epoch: 8, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 0.7375133037567139
Epoch: 9, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 10 cost time: 0.7206804752349854
Epoch: 10, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 11 cost time: 0.7129981517791748
Epoch: 11, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7731068134307861
Epoch: 12, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.736431360244751
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7042801380157471
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.738853931427002
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7088298797607422
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.66827392578125
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6709499359130859
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6466879844665527
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.651235818862915
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1547348
model size : 15.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.490088701248169
Epoch: 1, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.260 Vali Acc: 0.375 Test Loss: 1.260 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.6225259304046631
Epoch: 2, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.132 Vali Acc: 0.575 Test Loss: 1.132 Test Acc: 0.575
Validation loss decreased (-0.374987 --> -0.574989).  Saving model ...
Epoch: 3 cost time: 0.6636383533477783
Epoch: 3, Steps: 3 | Train Loss: 1.004 Vali Loss: 0.883 Vali Acc: 0.800 Test Loss: 0.883 Test Acc: 0.800
Validation loss decreased (-0.574989 --> -0.799991).  Saving model ...
Epoch: 4 cost time: 0.698871374130249
Epoch: 4, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.643 Vali Acc: 0.925 Test Loss: 0.643 Test Acc: 0.925
Validation loss decreased (-0.799991 --> -0.924994).  Saving model ...
Epoch: 5 cost time: 0.6688363552093506
Epoch: 5, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.479 Vali Acc: 0.950 Test Loss: 0.479 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.7107789516448975
Epoch: 6, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.7136397361755371
Epoch: 7, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 0.7865190505981445
Epoch: 8, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 9 cost time: 0.7294220924377441
Epoch: 9, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 0.7537314891815186
Epoch: 10, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.7166459560394287
Epoch: 11, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7367193698883057
Epoch: 12, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7478108406066895
Epoch: 13, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7175803184509277
Epoch: 14, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6820316314697266
Epoch: 15, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6639425754547119
Epoch: 16, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5879180431365967
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6336371898651123
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6972968578338623
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6619470119476318
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1547348
model size : 15.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4080193042755127
Epoch: 1, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.264 Vali Acc: 0.475 Test Loss: 1.264 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.707385778427124
Epoch: 2, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 0.6136965751647949
Epoch: 3, Steps: 3 | Train Loss: 1.035 Vali Loss: 0.869 Vali Acc: 0.600 Test Loss: 0.869 Test Acc: 0.600
Validation loss decreased (-0.499989 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 0.6577880382537842
Epoch: 4, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.631 Vali Acc: 0.900 Test Loss: 0.631 Test Acc: 0.900
Validation loss decreased (-0.599991 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 0.6580402851104736
Epoch: 5, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 0.6815211772918701
Epoch: 6, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7266020774841309
Epoch: 7, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7353947162628174
Epoch: 8, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7346060276031494
Epoch: 9, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7171335220336914
Epoch: 10, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6496589183807373
Epoch: 11, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7330179214477539
Epoch: 12, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6549687385559082
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6624355316162109
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.549 Vali Acc: 0.875 Test Loss: 0.549 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6904511451721191
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.585 Vali Acc: 0.875 Test Loss: 0.585 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1416276
model size : 15.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5894267559051514
Epoch: 1, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.280 Vali Acc: 0.425 Test Loss: 1.280 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.6774604320526123
Epoch: 2, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 0.7075479030609131
Epoch: 3, Steps: 3 | Train Loss: 1.047 Vali Loss: 0.883 Vali Acc: 0.650 Test Loss: 0.883 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649991).  Saving model ...
Epoch: 4 cost time: 0.6961102485656738
Epoch: 4, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.634 Vali Acc: 0.900 Test Loss: 0.634 Test Acc: 0.900
Validation loss decreased (-0.649991 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 0.6864733695983887
Epoch: 5, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 0.6972100734710693
Epoch: 6, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6229438781738281
Epoch: 7, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6533186435699463
Epoch: 8, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6536154747009277
Epoch: 9, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.764019250869751
Epoch: 10, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.637704610824585
Epoch: 11, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6758034229278564
Epoch: 12, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7245290279388428
Epoch: 13, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6931252479553223
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6340320110321045
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1416276
model size : 15.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2497708797454834
Epoch: 1, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.239 Vali Acc: 0.325 Test Loss: 1.239 Test Acc: 0.325
Validation loss decreased (inf --> -0.324988).  Saving model ...
Epoch: 2 cost time: 0.6777439117431641
Epoch: 2, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.118 Vali Acc: 0.525 Test Loss: 1.118 Test Acc: 0.525
Validation loss decreased (-0.324988 --> -0.524989).  Saving model ...
Epoch: 3 cost time: 0.6763210296630859
Epoch: 3, Steps: 3 | Train Loss: 1.025 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
Validation loss decreased (-0.524989 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 0.6271450519561768
Epoch: 4, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.610 Vali Acc: 0.950 Test Loss: 0.610 Test Acc: 0.950
Validation loss decreased (-0.749991 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 0.7227356433868408
Epoch: 5, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.6987552642822266
Epoch: 6, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7688436508178711
Epoch: 7, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6476249694824219
Epoch: 8, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7932772636413574
Epoch: 9, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7661206722259521
Epoch: 10, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7448689937591553
Epoch: 11, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8099930286407471
Epoch: 12, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8621556758880615
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7018642425537109
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7423503398895264
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1416276
model size : 15.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3730077743530273
Epoch: 1, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.226 Vali Acc: 0.700 Test Loss: 1.226 Test Acc: 0.700
Validation loss decreased (inf --> -0.699988).  Saving model ...
Epoch: 2 cost time: 0.6133620738983154
Epoch: 2, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.105 Vali Acc: 0.825 Test Loss: 1.105 Test Acc: 0.825
Validation loss decreased (-0.699988 --> -0.824989).  Saving model ...
Epoch: 3 cost time: 0.6785674095153809
Epoch: 3, Steps: 3 | Train Loss: 0.978 Vali Loss: 0.856 Vali Acc: 0.900 Test Loss: 0.856 Test Acc: 0.900
Validation loss decreased (-0.824989 --> -0.899991).  Saving model ...
Epoch: 4 cost time: 0.7623989582061768
Epoch: 4, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.606 Vali Acc: 0.925 Test Loss: 0.606 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924994).  Saving model ...
Epoch: 5 cost time: 0.7996571063995361
Epoch: 5, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.446 Vali Acc: 0.950 Test Loss: 0.446 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 6 cost time: 0.6989507675170898
Epoch: 6, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6764681339263916
Epoch: 7, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 0.6454260349273682
Epoch: 8, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 9 cost time: 0.7567141056060791
Epoch: 9, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 10 cost time: 0.6769907474517822
Epoch: 10, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.191 Vali Acc: 0.925 Test Loss: 0.191 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7292141914367676
Epoch: 11, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.925 Test Loss: 0.173 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7044258117675781
Epoch: 12, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.739661455154419
Epoch: 13, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.7188582420349121
Epoch: 14, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 15 cost time: 0.7334308624267578
Epoch: 15, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 16 cost time: 0.8149583339691162
Epoch: 16, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 17 cost time: 0.7421064376831055
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 18 cost time: 0.7282149791717529
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.690087080001831
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7782354354858398
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.925 Test Loss: 0.144 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6975491046905518
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.925 Test Loss: 0.145 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7351515293121338
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.925 Test Loss: 0.144 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7864542007446289
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.925 Test Loss: 0.144 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.676389217376709
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6497657299041748
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6561613082885742
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6394469738006592
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1416276
model size : 15.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.279571056365967
Epoch: 1, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.6191051006317139
Epoch: 2, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.262 Vali Acc: 0.425 Test Loss: 1.262 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.7194004058837891
Epoch: 3, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.092 Vali Acc: 0.550 Test Loss: 1.092 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 0.699411153793335
Epoch: 4, Steps: 3 | Train Loss: 0.902 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
Validation loss decreased (-0.549989 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 0.62638258934021
Epoch: 5, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.753 Vali Acc: 0.875 Test Loss: 0.753 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.7019147872924805
Epoch: 6, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 0.7046809196472168
Epoch: 7, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.518 Vali Acc: 0.950 Test Loss: 0.518 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.7303042411804199
Epoch: 8, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6665050983428955
Epoch: 9, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7009882926940918
Epoch: 10, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6970920562744141
Epoch: 11, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6876652240753174
Epoch: 12, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6962471008300781
Epoch: 13, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.649308443069458
Epoch: 14, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6419613361358643
Epoch: 15, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7203466892242432
Epoch: 16, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7143714427947998
Epoch: 17, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2477652
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.420518636703491
Epoch: 1, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.399 Vali Acc: 0.250 Test Loss: 1.399 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6345865726470947
Epoch: 2, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.307 Vali Acc: 0.350 Test Loss: 1.307 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.637704610824585
Epoch: 3, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.123 Vali Acc: 0.550 Test Loss: 1.123 Test Acc: 0.550
Validation loss decreased (-0.349987 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 0.6173360347747803
Epoch: 4, Steps: 3 | Train Loss: 0.914 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
Validation loss decreased (-0.549989 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 0.6215734481811523
Epoch: 5, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.767 Vali Acc: 0.875 Test Loss: 0.767 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.7282202243804932
Epoch: 6, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.614 Vali Acc: 0.900 Test Loss: 0.614 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.6668202877044678
Epoch: 7, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 0.6980209350585938
Epoch: 8, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7013847827911377
Epoch: 9, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6515145301818848
Epoch: 10, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7252054214477539
Epoch: 11, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7325162887573242
Epoch: 12, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7674190998077393
Epoch: 13, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8041996955871582
Epoch: 14, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8657143115997314
Epoch: 15, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 0.6177413463592529
Epoch: 16, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.62103271484375
Epoch: 17, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6622469425201416
Epoch: 18, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6984422206878662
Epoch: 19, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.745819091796875
Epoch: 20, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7659037113189697
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7679386138916016
Epoch: 22, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7516560554504395
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7495245933532715
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7389805316925049
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6898107528686523
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2477652
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3932318687438965
Epoch: 1, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.389 Vali Acc: 0.250 Test Loss: 1.389 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.569932222366333
Epoch: 2, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.298 Vali Acc: 0.275 Test Loss: 1.298 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.6704773902893066
Epoch: 3, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.125 Vali Acc: 0.525 Test Loss: 1.125 Test Acc: 0.525
Validation loss decreased (-0.274987 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 0.6589565277099609
Epoch: 4, Steps: 3 | Train Loss: 0.904 Vali Loss: 0.932 Vali Acc: 0.825 Test Loss: 0.932 Test Acc: 0.825
Validation loss decreased (-0.524989 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 0.675339937210083
Epoch: 5, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.767 Vali Acc: 0.900 Test Loss: 0.767 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 6 cost time: 0.7453312873840332
Epoch: 6, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.614 Vali Acc: 0.925 Test Loss: 0.614 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.6920840740203857
Epoch: 7, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.499 Vali Acc: 0.950 Test Loss: 0.499 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.5819916725158691
Epoch: 8, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.432 Vali Acc: 0.950 Test Loss: 0.432 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.6769697666168213
Epoch: 9, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.6840236186981201
Epoch: 10, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5823829174041748
Epoch: 11, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7054457664489746
Epoch: 12, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6767463684082031
Epoch: 13, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6544113159179688
Epoch: 14, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7130517959594727
Epoch: 15, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7119693756103516
Epoch: 16, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6795916557312012
Epoch: 17, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.75634765625
Epoch: 18, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7282369136810303
Epoch: 19, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2477652
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5132412910461426
Epoch: 1, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.387 Vali Acc: 0.350 Test Loss: 1.387 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6385476589202881
Epoch: 2, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.6234753131866455
Epoch: 3, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.122 Vali Acc: 0.725 Test Loss: 1.122 Test Acc: 0.725
Validation loss decreased (-0.499987 --> -0.724989).  Saving model ...
Epoch: 4 cost time: 0.6741397380828857
Epoch: 4, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.935 Vali Acc: 0.850 Test Loss: 0.935 Test Acc: 0.850
Validation loss decreased (-0.724989 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 0.6405513286590576
Epoch: 5, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.770 Vali Acc: 0.875 Test Loss: 0.770 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.667041540145874
Epoch: 6, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.615 Vali Acc: 0.925 Test Loss: 0.615 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.6625962257385254
Epoch: 7, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.496 Vali Acc: 0.950 Test Loss: 0.496 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.6550750732421875
Epoch: 8, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.5589361190795898
Epoch: 9, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.5957117080688477
Epoch: 10, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.6547255516052246
Epoch: 11, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.517615795135498
Epoch: 12, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.6746602058410645
Epoch: 13, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.5963799953460693
Epoch: 14, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.6321136951446533
Epoch: 15, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 16 cost time: 0.6183574199676514
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.5774095058441162
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 0.6371974945068359
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 0.6090784072875977
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.5362493991851807
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.5946111679077148
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.6566412448883057
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.6852715015411377
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 24 cost time: 0.657433032989502
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 25 cost time: 0.659142017364502
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.711803674697876
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.668344259262085
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6591298580169678
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6801896095275879
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.65793776512146
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 31 cost time: 0.5675604343414307
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 32 cost time: 0.6748740673065186
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 33 cost time: 0.6909387111663818
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 34 cost time: 0.7108008861541748
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 35 cost time: 0.6308748722076416
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 36 cost time: 0.7009072303771973
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 37 cost time: 0.6340367794036865
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 38 cost time: 0.6386356353759766
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 39 cost time: 0.6580262184143066
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 40 cost time: 0.5800800323486328
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 41 cost time: 0.6756117343902588
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 42 cost time: 0.6452798843383789
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 43 cost time: 0.6890056133270264
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.950 Test Loss: 0.133 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 44 cost time: 0.7083122730255127
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.950 Test Loss: 0.128 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 45 cost time: 0.6385180950164795
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.950 Test Loss: 0.128 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 46 cost time: 0.6904885768890381
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.950 Test Loss: 0.127 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 47 cost time: 0.6693084239959717
Epoch: 47, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.950 Test Loss: 0.127 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 48 cost time: 0.706089973449707
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.950 Test Loss: 0.127 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 49 cost time: 0.5731589794158936
Epoch: 49, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 50 cost time: 0.6288626194000244
Epoch: 50, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 51 cost time: 0.5949573516845703
Epoch: 51, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 52 cost time: 0.6966762542724609
Epoch: 52, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 53 cost time: 0.6363465785980225
Epoch: 53, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 54 cost time: 0.5880618095397949
Epoch: 54, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 55 cost time: 0.6415731906890869
Epoch: 55, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 56 cost time: 0.6411559581756592
Epoch: 56, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 57 cost time: 0.6206791400909424
Epoch: 57, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5469684600830078
Epoch: 58, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 59 cost time: 0.6513392925262451
Epoch: 59, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 60 cost time: 0.6085944175720215
Epoch: 60, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.950 Test Loss: 0.121 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 61 cost time: 0.6453859806060791
Epoch: 61, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.950 Test Loss: 0.120 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 62 cost time: 0.6995823383331299
Epoch: 62, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.950 Test Loss: 0.119 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 63 cost time: 0.6954083442687988
Epoch: 63, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7131166458129883
Epoch: 64, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.733015775680542
Epoch: 65, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.950 Test Loss: 0.121 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.6679069995880127
Epoch: 66, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.950 Test Loss: 0.120 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.6631662845611572
Epoch: 67, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.950 Test Loss: 0.119 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 68 cost time: 0.7378501892089844
Epoch: 68, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.950 Test Loss: 0.118 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 69 cost time: 0.7077620029449463
Epoch: 69, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.950 Test Loss: 0.117 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 70 cost time: 0.6991610527038574
Epoch: 70, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 71 cost time: 0.7371070384979248
Epoch: 71, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.950 Test Loss: 0.116 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6311652660369873
Epoch: 72, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.7104969024658203
Epoch: 73, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.7035887241363525
Epoch: 74, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 75 cost time: 0.7102053165435791
Epoch: 75, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6559154987335205
Epoch: 76, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.950 Test Loss: 0.114 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 77 cost time: 0.654754638671875
Epoch: 77, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.950 Test Loss: 0.113 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 78 cost time: 0.6318871974945068
Epoch: 78, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.950 Test Loss: 0.112 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 79 cost time: 0.7238771915435791
Epoch: 79, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.950 Test Loss: 0.112 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 80 cost time: 0.5628752708435059
Epoch: 80, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.950 Test Loss: 0.111 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 81 cost time: 0.6306507587432861
Epoch: 81, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.950 Test Loss: 0.111 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 82 cost time: 0.5895237922668457
Epoch: 82, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.950 Test Loss: 0.112 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6232450008392334
Epoch: 83, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.950 Test Loss: 0.112 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.5541059970855713
Epoch: 84, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.950 Test Loss: 0.110 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 85 cost time: 0.5649600028991699
Epoch: 85, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.950 Test Loss: 0.111 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.5697925090789795
Epoch: 86, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.950 Test Loss: 0.111 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.6553614139556885
Epoch: 87, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.950 Test Loss: 0.111 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.6834619045257568
Epoch: 88, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.950 Test Loss: 0.110 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.7338347434997559
Epoch: 89, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.950 Test Loss: 0.110 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.6695449352264404
Epoch: 90, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.950 Test Loss: 0.110 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.6752467155456543
Epoch: 91, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.950 Test Loss: 0.109 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 92 cost time: 0.7992653846740723
Epoch: 92, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.950 Test Loss: 0.108 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 93 cost time: 0.7360732555389404
Epoch: 93, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.950 Test Loss: 0.107 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 94 cost time: 0.6838829517364502
Epoch: 94, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.950 Test Loss: 0.107 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 95 cost time: 0.6615035533905029
Epoch: 95, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.950 Test Loss: 0.105 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 96 cost time: 0.6787395477294922
Epoch: 96, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.950 Test Loss: 0.104 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 97 cost time: 0.7693941593170166
Epoch: 97, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.950 Test Loss: 0.104 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 98 cost time: 0.7485349178314209
Epoch: 98, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.950 Test Loss: 0.104 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 99 cost time: 0.6247179508209229
Epoch: 99, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.950 Test Loss: 0.103 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 100 cost time: 0.6119410991668701
Epoch: 100, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.950 Test Loss: 0.103 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2477652
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5744521617889404
Epoch: 1, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5989303588867188
Epoch: 2, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.290 Vali Acc: 0.425 Test Loss: 1.290 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.6213359832763672
Epoch: 3, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.424987 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.6049060821533203
Epoch: 4, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
Validation loss decreased (-0.599989 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 0.5653421878814697
Epoch: 5, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.728 Vali Acc: 0.850 Test Loss: 0.728 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849993).  Saving model ...
Epoch: 6 cost time: 0.544903039932251
Epoch: 6, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.626 Vali Acc: 0.900 Test Loss: 0.626 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.6052944660186768
Epoch: 7, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.586 Vali Acc: 0.900 Test Loss: 0.586 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 8 cost time: 0.633415937423706
Epoch: 8, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6017200946807861
Epoch: 9, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 0.6283104419708252
Epoch: 10, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 0.5772809982299805
Epoch: 11, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 0.5759093761444092
Epoch: 12, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6145248413085938
Epoch: 13, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5269668102264404
Epoch: 14, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 0.6447968482971191
Epoch: 15, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6825156211853027
Epoch: 16, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6653392314910889
Epoch: 17, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7085013389587402
Epoch: 18, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.562 Vali Acc: 0.875 Test Loss: 0.562 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6864819526672363
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.574 Vali Acc: 0.875 Test Loss: 0.574 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6088416576385498
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6173303127288818
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.667180061340332
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.532 Vali Acc: 0.875 Test Loss: 0.532 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6704626083374023
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6696822643280029
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1429076
model size : 10.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4281466007232666
Epoch: 1, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.388 Vali Acc: 0.400 Test Loss: 1.388 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.6938934326171875
Epoch: 2, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.289 Vali Acc: 0.575 Test Loss: 1.289 Test Acc: 0.575
Validation loss decreased (-0.399986 --> -0.574987).  Saving model ...
Epoch: 3 cost time: 0.6605870723724365
Epoch: 3, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.098 Vali Acc: 0.650 Test Loss: 1.098 Test Acc: 0.650
Validation loss decreased (-0.574987 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 0.6264517307281494
Epoch: 4, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 0.6383483409881592
Epoch: 5, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.723 Vali Acc: 0.825 Test Loss: 0.723 Test Acc: 0.825
Validation loss decreased (-0.699991 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 0.515371561050415
Epoch: 6, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.6175093650817871
Epoch: 7, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.5775089263916016
Epoch: 8, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6767046451568604
Epoch: 9, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 0.6541793346405029
Epoch: 10, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 0.6815652847290039
Epoch: 11, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 0.6281676292419434
Epoch: 12, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.650010347366333
Epoch: 13, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6794259548187256
Epoch: 14, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.676220178604126
Epoch: 15, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6826796531677246
Epoch: 16, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6891262531280518
Epoch: 17, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7239959239959717
Epoch: 18, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.687619686126709
Epoch: 19, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6788997650146484
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7162632942199707
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1429076
model size : 10.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.549131393432617
Epoch: 1, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.5941376686096191
Epoch: 2, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.222 Vali Acc: 0.625 Test Loss: 1.222 Test Acc: 0.625
Validation loss decreased (-0.424987 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 0.7031097412109375
Epoch: 3, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.047 Vali Acc: 0.725 Test Loss: 1.047 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724990).  Saving model ...
Epoch: 4 cost time: 0.5996353626251221
Epoch: 4, Steps: 3 | Train Loss: 0.924 Vali Loss: 0.858 Vali Acc: 0.825 Test Loss: 0.858 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 0.6586771011352539
Epoch: 5, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.684 Vali Acc: 0.900 Test Loss: 0.684 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.6565027236938477
Epoch: 6, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.555 Vali Acc: 0.925 Test Loss: 0.555 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.6100974082946777
Epoch: 7, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5612657070159912
Epoch: 8, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6916956901550293
Epoch: 9, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6162717342376709
Epoch: 10, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5556344985961914
Epoch: 11, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6487536430358887
Epoch: 12, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6186990737915039
Epoch: 13, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6515214443206787
Epoch: 14, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5866837501525879
Epoch: 15, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.527508020401001
Epoch: 16, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1429076
model size : 10.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3093929290771484
Epoch: 1, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.292 Vali Acc: 0.450 Test Loss: 1.292 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.6492264270782471
Epoch: 2, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.205 Vali Acc: 0.675 Test Loss: 1.205 Test Acc: 0.675
Validation loss decreased (-0.449987 --> -0.674988).  Saving model ...
Epoch: 3 cost time: 0.6573655605316162
Epoch: 3, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.038 Vali Acc: 0.775 Test Loss: 1.038 Test Acc: 0.775
Validation loss decreased (-0.674988 --> -0.774990).  Saving model ...
Epoch: 4 cost time: 0.6344051361083984
Epoch: 4, Steps: 3 | Train Loss: 0.929 Vali Loss: 0.850 Vali Acc: 0.925 Test Loss: 0.850 Test Acc: 0.925
Validation loss decreased (-0.774990 --> -0.924992).  Saving model ...
Epoch: 5 cost time: 0.6531281471252441
Epoch: 5, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.672 Vali Acc: 0.975 Test Loss: 0.672 Test Acc: 0.975
Validation loss decreased (-0.924992 --> -0.974993).  Saving model ...
Epoch: 6 cost time: 0.6311891078948975
Epoch: 6, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.540 Vali Acc: 0.975 Test Loss: 0.540 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974995).  Saving model ...
Epoch: 7 cost time: 0.6510498523712158
Epoch: 7, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7606546878814697
Epoch: 8, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6652238368988037
Epoch: 9, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.6665840148925781
Epoch: 10, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.6916587352752686
Epoch: 11, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.6664681434631348
Epoch: 12, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7332098484039307
Epoch: 13, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.925 Test Loss: 0.181 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7062869071960449
Epoch: 14, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.175 Vali Acc: 0.925 Test Loss: 0.175 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7105386257171631
Epoch: 15, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.925 Test Loss: 0.172 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6942098140716553
Epoch: 16, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.925 Test Loss: 0.171 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6349139213562012
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.925 Test Loss: 0.170 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6952691078186035
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.925 Test Loss: 0.168 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6450073719024658
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.925 Test Loss: 0.165 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7463998794555664
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.925 Test Loss: 0.163 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6532700061798096
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.925 Test Loss: 0.160 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1429076
model size : 10.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.480844736099243
Epoch: 1, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.340 Vali Acc: 0.275 Test Loss: 1.340 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.6560463905334473
Epoch: 2, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.243 Vali Acc: 0.350 Test Loss: 1.243 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 0.684983491897583
Epoch: 3, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.109 Vali Acc: 0.550 Test Loss: 1.109 Test Acc: 0.550
Validation loss decreased (-0.349988 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 0.5943136215209961
Epoch: 4, Steps: 3 | Train Loss: 0.942 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
Validation loss decreased (-0.549989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 0.6230394840240479
Epoch: 5, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
Validation loss decreased (-0.699991 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 0.6745350360870361
Epoch: 6, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.595 Vali Acc: 0.925 Test Loss: 0.595 Test Acc: 0.925
Validation loss decreased (-0.799993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.6446926593780518
Epoch: 7, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7047533988952637
Epoch: 8, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5358517169952393
Epoch: 9, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6476526260375977
Epoch: 10, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 0.5398344993591309
Epoch: 11, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 0.5827071666717529
Epoch: 12, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6000111103057861
Epoch: 13, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5715370178222656
Epoch: 14, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6092076301574707
Epoch: 15, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6242823600769043
Epoch: 16, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6427223682403564
Epoch: 17, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6882305145263672
Epoch: 18, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6158685684204102
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6345069408416748
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7608816623687744
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 904788
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4591009616851807
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.347 Vali Acc: 0.275 Test Loss: 1.347 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.6905477046966553
Epoch: 2, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.246 Vali Acc: 0.350 Test Loss: 1.246 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 0.670283317565918
Epoch: 3, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.099 Vali Acc: 0.500 Test Loss: 1.099 Test Acc: 0.500
Validation loss decreased (-0.349988 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 0.7450826168060303
Epoch: 4, Steps: 3 | Train Loss: 0.910 Vali Loss: 0.932 Vali Acc: 0.675 Test Loss: 0.932 Test Acc: 0.675
Validation loss decreased (-0.499989 --> -0.674991).  Saving model ...
Epoch: 5 cost time: 0.7332677841186523
Epoch: 5, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.732 Vali Acc: 0.875 Test Loss: 0.732 Test Acc: 0.875
Validation loss decreased (-0.674991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 0.7243757247924805
Epoch: 6, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.584 Vali Acc: 0.950 Test Loss: 0.584 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 0.8531954288482666
Epoch: 7, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.513 Vali Acc: 0.950 Test Loss: 0.513 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.7686223983764648
Epoch: 8, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7829546928405762
Epoch: 9, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.825768232345581
Epoch: 10, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8250527381896973
Epoch: 11, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8340871334075928
Epoch: 12, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7744433879852295
Epoch: 13, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7701640129089355
Epoch: 14, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8316268920898438
Epoch: 15, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7810370922088623
Epoch: 16, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8584020137786865
Epoch: 17, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 904788
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.69857120513916
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.343 Vali Acc: 0.300 Test Loss: 1.343 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.6712250709533691
Epoch: 2, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
Validation loss decreased (-0.299987 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.6935148239135742
Epoch: 3, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
Validation loss decreased (-0.399988 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 0.6328334808349609
Epoch: 4, Steps: 3 | Train Loss: 0.881 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
Validation loss decreased (-0.649989 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 0.6397511959075928
Epoch: 5, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.714 Vali Acc: 0.900 Test Loss: 0.714 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.6809186935424805
Epoch: 6, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.567 Vali Acc: 0.975 Test Loss: 0.567 Test Acc: 0.975
Validation loss decreased (-0.899993 --> -0.974994).  Saving model ...
Epoch: 7 cost time: 0.7042572498321533
Epoch: 7, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.489 Vali Acc: 0.975 Test Loss: 0.489 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 0.7511353492736816
Epoch: 8, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.427 Vali Acc: 0.975 Test Loss: 0.427 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.7107956409454346
Epoch: 9, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.362 Vali Acc: 0.975 Test Loss: 0.362 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 0.7255330085754395
Epoch: 10, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7238876819610596
Epoch: 11, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6658639907836914
Epoch: 12, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.602017879486084
Epoch: 13, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5657711029052734
Epoch: 14, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.234 Vali Acc: 0.925 Test Loss: 0.234 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6250858306884766
Epoch: 15, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6501493453979492
Epoch: 16, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.693418025970459
Epoch: 17, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7041819095611572
Epoch: 18, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7084424495697021
Epoch: 19, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 904788
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4299373626708984
Epoch: 1, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.589160680770874
Epoch: 2, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.6502559185028076
Epoch: 3, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.6111326217651367
Epoch: 4, Steps: 3 | Train Loss: 0.848 Vali Loss: 0.883 Vali Acc: 0.800 Test Loss: 0.883 Test Acc: 0.800
Validation loss decreased (-0.599989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.6019940376281738
Epoch: 5, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.701 Vali Acc: 0.950 Test Loss: 0.701 Test Acc: 0.950
Validation loss decreased (-0.799991 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 0.6188328266143799
Epoch: 6, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.551 Vali Acc: 0.950 Test Loss: 0.551 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 0.7182879447937012
Epoch: 7, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.447 Vali Acc: 0.950 Test Loss: 0.447 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 0.6664140224456787
Epoch: 8, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.7408642768859863
Epoch: 9, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.6974411010742188
Epoch: 10, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.5785236358642578
Epoch: 11, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.6658992767333984
Epoch: 12, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6822876930236816
Epoch: 13, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.717188835144043
Epoch: 14, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.6510484218597412
Epoch: 15, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.6713550090789795
Epoch: 16, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.7072381973266602
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.6876711845397949
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.6833968162536621
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5885908603668213
Epoch: 20, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.6268401145935059
Epoch: 21, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.6151118278503418
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 0.6358118057250977
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 0.5304241180419922
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 0.600261926651001
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.5879104137420654
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 0.6329121589660645
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 0.6115884780883789
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 0.5427310466766357
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 0.6474292278289795
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 31 cost time: 0.6158967018127441
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 32 cost time: 0.5763263702392578
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 33 cost time: 0.5819785594940186
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.6528325080871582
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.7401387691497803
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.6756787300109863
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.6635603904724121
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.6571259498596191
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.6551003456115723
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.667954683303833
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.674159049987793
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.5899574756622314
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.6121389865875244
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.6581060886383057
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6181497573852539
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7296535968780518
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.604886531829834
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.6607441902160645
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.6145260334014893
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6824209690093994
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6572475433349609
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.704474687576294
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 53 cost time: 0.7114953994750977
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 54 cost time: 0.6391518115997314
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 55 cost time: 0.635136604309082
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 56 cost time: 0.6238906383514404
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6020300388336182
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5713818073272705
Epoch: 58, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6156742572784424
Epoch: 59, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6862945556640625
Epoch: 60, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.6999621391296387
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.6506571769714355
Epoch: 62, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6420512199401855
Epoch: 63, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.6360883712768555
Epoch: 64, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.6788067817687988
Epoch: 65, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 904788
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.364295244216919
Epoch: 1, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.449 Vali Acc: 0.175 Test Loss: 1.449 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.6626899242401123
Epoch: 2, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.354 Vali Acc: 0.200 Test Loss: 1.354 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.6365725994110107
Epoch: 3, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.176 Vali Acc: 0.375 Test Loss: 1.176 Test Acc: 0.375
Validation loss decreased (-0.199986 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.6720919609069824
Epoch: 4, Steps: 3 | Train Loss: 0.938 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
Validation loss decreased (-0.374988 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.6740045547485352
Epoch: 5, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.805 Vali Acc: 0.775 Test Loss: 0.805 Test Acc: 0.775
Validation loss decreased (-0.599990 --> -0.774992).  Saving model ...
Epoch: 6 cost time: 0.5940561294555664
Epoch: 6, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 0.6084244251251221
Epoch: 7, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
Validation loss decreased (-0.799993 --> -0.899994).  Saving model ...
Epoch: 8 cost time: 0.6684448719024658
Epoch: 8, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.517 Vali Acc: 0.900 Test Loss: 0.517 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 9 cost time: 0.6616857051849365
Epoch: 9, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.721672773361206
Epoch: 10, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 0.6466498374938965
Epoch: 11, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 0.6249179840087891
Epoch: 12, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 0.6448674201965332
Epoch: 13, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6480629444122314
Epoch: 14, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6753826141357422
Epoch: 15, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6088097095489502
Epoch: 16, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6646244525909424
Epoch: 17, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.605797290802002
Epoch: 18, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5966384410858154
Epoch: 19, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5477204322814941
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.447 Vali Acc: 0.925 Test Loss: 0.447 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6250014305114746
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5641665458679199
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 642644
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.271101713180542
Epoch: 1, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.457 Vali Acc: 0.150 Test Loss: 1.457 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.7429194450378418
Epoch: 2, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.360 Vali Acc: 0.200 Test Loss: 1.360 Test Acc: 0.200
Validation loss decreased (-0.149985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.6335556507110596
Epoch: 3, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.178 Vali Acc: 0.525 Test Loss: 1.178 Test Acc: 0.525
Validation loss decreased (-0.199986 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.6616795063018799
Epoch: 4, Steps: 3 | Train Loss: 0.917 Vali Loss: 0.983 Vali Acc: 0.675 Test Loss: 0.983 Test Acc: 0.675
Validation loss decreased (-0.524988 --> -0.674990).  Saving model ...
Epoch: 5 cost time: 0.5668184757232666
Epoch: 5, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774992).  Saving model ...
Epoch: 6 cost time: 0.5539934635162354
Epoch: 6, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.703 Vali Acc: 0.825 Test Loss: 0.703 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 0.6262595653533936
Epoch: 7, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 8 cost time: 0.5751559734344482
Epoch: 8, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 9 cost time: 0.6717524528503418
Epoch: 9, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.6555492877960205
Epoch: 10, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 0.6321568489074707
Epoch: 11, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 0.7366743087768555
Epoch: 12, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 0.6524131298065186
Epoch: 13, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.6392831802368164
Epoch: 14, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 0.630394458770752
Epoch: 15, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.612811803817749
Epoch: 16, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6862244606018066
Epoch: 17, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7204782962799072
Epoch: 18, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6836025714874268
Epoch: 19, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.6652288436889648
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5750589370727539
Epoch: 21, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6667840480804443
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7303335666656494
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.667820930480957
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6960275173187256
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6109435558319092
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6584124565124512
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.925 Test Loss: 0.429 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5664467811584473
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6637005805969238
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 642644
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5137243270874023
Epoch: 1, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.374 Vali Acc: 0.250 Test Loss: 1.374 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5712723731994629
Epoch: 2, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.284 Vali Acc: 0.325 Test Loss: 1.284 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.5995855331420898
Epoch: 3, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
Validation loss decreased (-0.324987 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 0.599947452545166
Epoch: 4, Steps: 3 | Train Loss: 0.924 Vali Loss: 0.927 Vali Acc: 0.800 Test Loss: 0.927 Test Acc: 0.800
Validation loss decreased (-0.649989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.6903896331787109
Epoch: 5, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.770 Vali Acc: 0.850 Test Loss: 0.770 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 0.6896836757659912
Epoch: 6, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 0.6573097705841064
Epoch: 7, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.520 Vali Acc: 0.975 Test Loss: 0.520 Test Acc: 0.975
Validation loss decreased (-0.849994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 0.61008620262146
Epoch: 8, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.429 Vali Acc: 0.950 Test Loss: 0.429 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.543947696685791
Epoch: 9, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6077723503112793
Epoch: 10, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5889773368835449
Epoch: 11, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6381402015686035
Epoch: 12, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6480696201324463
Epoch: 13, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5887587070465088
Epoch: 14, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5839812755584717
Epoch: 15, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6220400333404541
Epoch: 16, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6405904293060303
Epoch: 17, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 642644
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3646957874298096
Epoch: 1, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.385 Vali Acc: 0.200 Test Loss: 1.385 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.6049189567565918
Epoch: 2, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.297 Vali Acc: 0.325 Test Loss: 1.297 Test Acc: 0.325
Validation loss decreased (-0.199986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.6036922931671143
Epoch: 3, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.132 Vali Acc: 0.675 Test Loss: 1.132 Test Acc: 0.675
Validation loss decreased (-0.324987 --> -0.674989).  Saving model ...
Epoch: 4 cost time: 0.5766284465789795
Epoch: 4, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.954 Vali Acc: 0.875 Test Loss: 0.954 Test Acc: 0.875
Validation loss decreased (-0.674989 --> -0.874990).  Saving model ...
Epoch: 5 cost time: 0.661956787109375
Epoch: 5, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.793 Vali Acc: 0.875 Test Loss: 0.793 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.6100435256958008
Epoch: 6, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.650 Vali Acc: 0.925 Test Loss: 0.650 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 7 cost time: 0.768557071685791
Epoch: 7, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.517 Vali Acc: 0.950 Test Loss: 0.517 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.6797590255737305
Epoch: 8, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.7026088237762451
Epoch: 9, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.6554696559906006
Epoch: 10, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.6579837799072266
Epoch: 11, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.7129130363464355
Epoch: 12, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.6680357456207275
Epoch: 13, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.6434199810028076
Epoch: 14, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.6848092079162598
Epoch: 15, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 16 cost time: 0.6109042167663574
Epoch: 16, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.6785690784454346
Epoch: 17, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 0.7159287929534912
Epoch: 18, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 0.6754598617553711
Epoch: 19, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.6731886863708496
Epoch: 20, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.6102890968322754
Epoch: 21, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.6803786754608154
Epoch: 22, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.6291763782501221
Epoch: 23, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.5971181392669678
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.6966249942779541
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6559991836547852
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.6425285339355469
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.6281876564025879
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6417860984802246
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.674713134765625
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6677126884460449
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.5822465419769287
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5743758678436279
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.5198235511779785
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 35 cost time: 0.6079187393188477
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 36 cost time: 0.6314356327056885
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.950 Test Loss: 0.146 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 37 cost time: 0.6311612129211426
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 38 cost time: 0.6202692985534668
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 39 cost time: 0.608788013458252
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 40 cost time: 0.6141722202301025
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 41 cost time: 0.6160213947296143
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6547188758850098
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 43 cost time: 0.6935820579528809
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 44 cost time: 0.659625768661499
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 45 cost time: 0.6183488368988037
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 46 cost time: 0.6547002792358398
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 47 cost time: 0.6513938903808594
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6690537929534912
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6299929618835449
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 50 cost time: 0.6265201568603516
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 51 cost time: 0.6092550754547119
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6500644683837891
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 53 cost time: 0.6454553604125977
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7404000759124756
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 55 cost time: 0.6744499206542969
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 56 cost time: 0.6871557235717773
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 57 cost time: 0.634049654006958
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 58 cost time: 0.6467444896697998
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.679084300994873
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6557891368865967
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6757564544677734
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.6435010433197021
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.950 Test Loss: 0.132 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 63 cost time: 0.6313810348510742
Epoch: 63, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.950 Test Loss: 0.132 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 64 cost time: 0.6377944946289062
Epoch: 64, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.950 Test Loss: 0.132 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 65 cost time: 0.6201775074005127
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.950 Test Loss: 0.131 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 66 cost time: 0.6724362373352051
Epoch: 66, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.950 Test Loss: 0.132 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6049456596374512
Epoch: 67, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.950 Test Loss: 0.131 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 68 cost time: 0.6639618873596191
Epoch: 68, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.950 Test Loss: 0.131 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 69 cost time: 0.621614933013916
Epoch: 69, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.950 Test Loss: 0.130 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 70 cost time: 0.6383447647094727
Epoch: 70, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.950 Test Loss: 0.130 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 71 cost time: 0.5470314025878906
Epoch: 71, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.950 Test Loss: 0.129 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 72 cost time: 0.6604471206665039
Epoch: 72, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.950 Test Loss: 0.128 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 73 cost time: 0.6077630519866943
Epoch: 73, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 74 cost time: 0.6107330322265625
Epoch: 74, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 75 cost time: 0.5462992191314697
Epoch: 75, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 76 cost time: 0.6503195762634277
Epoch: 76, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.6636707782745361
Epoch: 77, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 78 cost time: 0.5829558372497559
Epoch: 78, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.7217576503753662
Epoch: 79, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.6292059421539307
Epoch: 80, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 81 cost time: 0.6957888603210449
Epoch: 81, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 82 cost time: 0.5923869609832764
Epoch: 82, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 83 cost time: 0.6381747722625732
Epoch: 83, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.6591689586639404
Epoch: 84, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.7035279273986816
Epoch: 85, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.7057454586029053
Epoch: 86, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.6377649307250977
Epoch: 87, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.6652123928070068
Epoch: 88, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.6597340106964111
Epoch: 89, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.6305077075958252
Epoch: 90, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 91 cost time: 0.6787800788879395
Epoch: 91, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.6186826229095459
Epoch: 92, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.7388617992401123
Epoch: 93, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.6774318218231201
Epoch: 94, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.6968605518341064
Epoch: 95, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.6608104705810547
Epoch: 96, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.6490452289581299
Epoch: 97, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.6061317920684814
Epoch: 98, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.6717758178710938
Epoch: 99, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.5825347900390625
Epoch: 100, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 642644
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3864035606384277
Epoch: 1, Steps: 3 | Train Loss: 1.648 Vali Loss: 1.388 Vali Acc: 0.375 Test Loss: 1.388 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6746423244476318
Epoch: 2, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.273 Vali Acc: 0.400 Test Loss: 1.273 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.6723673343658447
Epoch: 3, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 0.7191367149353027
Epoch: 4, Steps: 3 | Train Loss: 0.953 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
Validation loss decreased (-0.499989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 0.6530725955963135
Epoch: 5, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.752 Vali Acc: 0.875 Test Loss: 0.752 Test Acc: 0.875
Validation loss decreased (-0.699991 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.6850388050079346
Epoch: 6, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.7228984832763672
Epoch: 7, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.6884555816650391
Epoch: 8, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6435165405273438
Epoch: 9, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.6696979999542236
Epoch: 10, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 0.6635608673095703
Epoch: 11, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 12 cost time: 0.6233668327331543
Epoch: 12, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 0.6780638694763184
Epoch: 13, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7034642696380615
Epoch: 14, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.666447639465332
Epoch: 15, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5795412063598633
Epoch: 16, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6447417736053467
Epoch: 17, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6537129878997803
Epoch: 18, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6484708786010742
Epoch: 19, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7052066326141357
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6102244853973389
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6024255752563477
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 511572
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1946640014648438
Epoch: 1, Steps: 3 | Train Loss: 1.681 Vali Loss: 1.378 Vali Acc: 0.300 Test Loss: 1.378 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6224994659423828
Epoch: 2, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.262 Vali Acc: 0.400 Test Loss: 1.262 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.5482587814331055
Epoch: 3, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.107 Vali Acc: 0.525 Test Loss: 1.107 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 0.5942199230194092
Epoch: 4, Steps: 3 | Train Loss: 1.011 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
Validation loss decreased (-0.524989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 0.6448879241943359
Epoch: 5, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.740 Vali Acc: 0.825 Test Loss: 0.740 Test Acc: 0.825
Validation loss decreased (-0.699991 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 0.5693359375
Epoch: 6, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.6367430686950684
Epoch: 7, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.6651761531829834
Epoch: 8, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.6571300029754639
Epoch: 9, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.684730052947998
Epoch: 10, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7180418968200684
Epoch: 11, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6953120231628418
Epoch: 12, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.8877527713775635
Epoch: 13, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6547415256500244
Epoch: 14, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7704930305480957
Epoch: 15, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6263637542724609
Epoch: 16, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.716982364654541
Epoch: 17, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6790637969970703
Epoch: 18, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7178909778594971
Epoch: 19, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6387932300567627
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6814277172088623
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6866800785064697
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 511572
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.36749529838562
Epoch: 1, Steps: 3 | Train Loss: 1.639 Vali Loss: 1.345 Vali Acc: 0.400 Test Loss: 1.345 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.6557891368865967
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.236 Vali Acc: 0.475 Test Loss: 1.236 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 3 cost time: 0.5910477638244629
Epoch: 3, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.6631503105163574
Epoch: 4, Steps: 3 | Train Loss: 1.023 Vali Loss: 0.910 Vali Acc: 0.750 Test Loss: 0.910 Test Acc: 0.750
Validation loss decreased (-0.599989 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 0.5857625007629395
Epoch: 5, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.721 Vali Acc: 0.825 Test Loss: 0.721 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 0.6050007343292236
Epoch: 6, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.574 Vali Acc: 0.900 Test Loss: 0.574 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.7008473873138428
Epoch: 7, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 0.656623363494873
Epoch: 8, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.6037073135375977
Epoch: 9, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6910529136657715
Epoch: 10, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.6569275856018066
Epoch: 11, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 12 cost time: 0.6979291439056396
Epoch: 12, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.6975235939025879
Epoch: 13, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.688422679901123
Epoch: 14, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.7260513305664062
Epoch: 15, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6684756278991699
Epoch: 16, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7440154552459717
Epoch: 17, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.215 Vali Acc: 0.925 Test Loss: 0.215 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7500455379486084
Epoch: 18, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.224 Vali Acc: 0.925 Test Loss: 0.224 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7322719097137451
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6907668113708496
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6881093978881836
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6542525291442871
Epoch: 22, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7609109878540039
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.657137393951416
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.925 Test Loss: 0.234 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 511572
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3553197383880615
Epoch: 1, Steps: 3 | Train Loss: 1.540 Vali Loss: 1.315 Vali Acc: 0.475 Test Loss: 1.315 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.6683275699615479
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.722238302230835
Epoch: 3, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674989).  Saving model ...
Epoch: 4 cost time: 0.64750075340271
Epoch: 4, Steps: 3 | Train Loss: 0.982 Vali Loss: 0.881 Vali Acc: 0.800 Test Loss: 0.881 Test Acc: 0.800
Validation loss decreased (-0.674989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.6433663368225098
Epoch: 5, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.701 Vali Acc: 0.925 Test Loss: 0.701 Test Acc: 0.925
Validation loss decreased (-0.799991 --> -0.924993).  Saving model ...
Epoch: 6 cost time: 0.6301326751708984
Epoch: 6, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.562 Vali Acc: 0.975 Test Loss: 0.562 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974994).  Saving model ...
Epoch: 7 cost time: 0.6719791889190674
Epoch: 7, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.450 Vali Acc: 0.975 Test Loss: 0.450 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 0.7046239376068115
Epoch: 8, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.689995527267456
Epoch: 9, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.6667249202728271
Epoch: 10, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.260 Vali Acc: 0.975 Test Loss: 0.260 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.6330280303955078
Epoch: 11, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.6946947574615479
Epoch: 12, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.654548168182373
Epoch: 13, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.6877121925354004
Epoch: 14, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 15 cost time: 0.7433905601501465
Epoch: 15, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 16 cost time: 0.7102079391479492
Epoch: 16, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 17 cost time: 0.7505791187286377
Epoch: 17, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 18 cost time: 0.7493476867675781
Epoch: 18, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 19 cost time: 0.6687624454498291
Epoch: 19, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 20 cost time: 0.7191016674041748
Epoch: 20, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 0.6919522285461426
Epoch: 21, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7087490558624268
Epoch: 22, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7451295852661133
Epoch: 23, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7507266998291016
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 0.6696281433105469
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.7855238914489746
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 0.6666057109832764
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 0.6945736408233643
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 0.6348369121551514
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 0.6411948204040527
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 31 cost time: 0.6127235889434814
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 32 cost time: 0.6837236881256104
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 33 cost time: 0.6370537281036377
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.6166729927062988
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.6544845104217529
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.6288387775421143
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.6117463111877441
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.6327712535858154
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.5696487426757812
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.5632667541503906
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.6111435890197754
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.6319770812988281
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.679804801940918
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.5670833587646484
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.6961886882781982
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.6087815761566162
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.7627577781677246
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.6347320079803467
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.6682038307189941
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.6551244258880615
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 51 cost time: 0.5828545093536377
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 52 cost time: 0.7278530597686768
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 53 cost time: 0.7355372905731201
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7236087322235107
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6906359195709229
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6456866264343262
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6893348693847656
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.7152969837188721
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6321475505828857
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6157236099243164
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.7103960514068604
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.669898509979248
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 511572
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.297147512435913
Epoch: 1, Steps: 3 | Train Loss: 1.561 Vali Loss: 1.382 Vali Acc: 0.425 Test Loss: 1.382 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.5840549468994141
Epoch: 2, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.266 Vali Acc: 0.550 Test Loss: 1.266 Test Acc: 0.550
Validation loss decreased (-0.424986 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 0.5718929767608643
Epoch: 3, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6146373748779297
Epoch: 4, Steps: 3 | Train Loss: 0.896 Vali Loss: 0.907 Vali Acc: 0.650 Test Loss: 0.907 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649991).  Saving model ...
Epoch: 5 cost time: 0.6799166202545166
Epoch: 5, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.734 Vali Acc: 0.875 Test Loss: 0.734 Test Acc: 0.875
Validation loss decreased (-0.649991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 0.6518490314483643
Epoch: 6, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.593 Vali Acc: 0.900 Test Loss: 0.593 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.709630012512207
Epoch: 7, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.663597822189331
Epoch: 8, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6689505577087402
Epoch: 9, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.807548999786377
Epoch: 10, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8179171085357666
Epoch: 11, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 0.749830961227417
Epoch: 12, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 0.779803991317749
Epoch: 13, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.7674686908721924
Epoch: 14, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7629876136779785
Epoch: 15, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7802994251251221
Epoch: 16, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7967672348022461
Epoch: 17, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6748313903808594
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6627483367919922
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6382229328155518
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7169106006622314
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7790918350219727
Epoch: 22, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6532607078552246
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 446036
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5433413982391357
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.6560189723968506
Epoch: 2, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.6483962535858154
Epoch: 3, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.076 Vali Acc: 0.550 Test Loss: 1.076 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 0.6337392330169678
Epoch: 4, Steps: 3 | Train Loss: 0.913 Vali Loss: 0.891 Vali Acc: 0.700 Test Loss: 0.891 Test Acc: 0.700
Validation loss decreased (-0.549989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 0.657447338104248
Epoch: 5, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.718 Vali Acc: 0.900 Test Loss: 0.718 Test Acc: 0.900
Validation loss decreased (-0.699991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.6146671772003174
Epoch: 6, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.587 Vali Acc: 0.900 Test Loss: 0.587 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.5944900512695312
Epoch: 7, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6443982124328613
Epoch: 8, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 9 cost time: 0.6629786491394043
Epoch: 9, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 0.682330846786499
Epoch: 10, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6611778736114502
Epoch: 11, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6314172744750977
Epoch: 12, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 0.6482789516448975
Epoch: 13, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 0.6439456939697266
Epoch: 14, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6200909614562988
Epoch: 15, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.582801342010498
Epoch: 16, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5722064971923828
Epoch: 17, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6181795597076416
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6183104515075684
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6418278217315674
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6201298236846924
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6489772796630859
Epoch: 22, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5940289497375488
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 446036
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3980648517608643
Epoch: 1, Steps: 3 | Train Loss: 1.535 Vali Loss: 1.363 Vali Acc: 0.375 Test Loss: 1.363 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6160798072814941
Epoch: 2, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.259 Vali Acc: 0.475 Test Loss: 1.259 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.6247856616973877
Epoch: 3, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.6737256050109863
Epoch: 4, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.911 Vali Acc: 0.650 Test Loss: 0.911 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649991).  Saving model ...
Epoch: 5 cost time: 0.615234375
Epoch: 5, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.732 Vali Acc: 0.900 Test Loss: 0.732 Test Acc: 0.900
Validation loss decreased (-0.649991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.6130471229553223
Epoch: 6, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.580 Vali Acc: 0.975 Test Loss: 0.580 Test Acc: 0.975
Validation loss decreased (-0.899993 --> -0.974994).  Saving model ...
Epoch: 7 cost time: 0.5800318717956543
Epoch: 7, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.473 Vali Acc: 0.950 Test Loss: 0.473 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6046512126922607
Epoch: 8, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.522301197052002
Epoch: 9, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5495915412902832
Epoch: 10, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6016232967376709
Epoch: 11, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.585237979888916
Epoch: 12, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5962679386138916
Epoch: 13, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6246192455291748
Epoch: 14, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6174769401550293
Epoch: 15, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6834008693695068
Epoch: 16, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 446036
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.414125680923462
Epoch: 1, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.351 Vali Acc: 0.550 Test Loss: 1.351 Test Acc: 0.550
Validation loss decreased (inf --> -0.549986).  Saving model ...
Epoch: 2 cost time: 0.6083719730377197
Epoch: 2, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.261 Vali Acc: 0.750 Test Loss: 1.261 Test Acc: 0.750
Validation loss decreased (-0.549986 --> -0.749987).  Saving model ...
Epoch: 3 cost time: 0.6560318470001221
Epoch: 3, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.104 Vali Acc: 0.750 Test Loss: 1.104 Test Acc: 0.750
Validation loss decreased (-0.749987 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 0.6421103477478027
Epoch: 4, Steps: 3 | Train Loss: 0.809 Vali Loss: 0.919 Vali Acc: 0.825 Test Loss: 0.919 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 0.6744697093963623
Epoch: 5, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.744 Vali Acc: 0.875 Test Loss: 0.744 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 0.6157510280609131
Epoch: 6, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.585 Vali Acc: 0.975 Test Loss: 0.585 Test Acc: 0.975
Validation loss decreased (-0.874993 --> -0.974994).  Saving model ...
Epoch: 7 cost time: 0.6506931781768799
Epoch: 7, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6755268573760986
Epoch: 8, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.642611026763916
Epoch: 9, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6800265312194824
Epoch: 10, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6848001480102539
Epoch: 11, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6478843688964844
Epoch: 12, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6688742637634277
Epoch: 13, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6660206317901611
Epoch: 14, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6038756370544434
Epoch: 15, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5988273620605469
Epoch: 16, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.925 Test Loss: 0.190 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 446036
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5013298988342285
Epoch: 1, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.275 Vali Acc: 0.425 Test Loss: 1.275 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.6138722896575928
Epoch: 2, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.210 Vali Acc: 0.525 Test Loss: 1.210 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 0.6182944774627686
Epoch: 3, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 0.653555154800415
Epoch: 4, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.008 Vali Acc: 0.750 Test Loss: 1.008 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 0.5371289253234863
Epoch: 5, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.904 Vali Acc: 0.825 Test Loss: 0.904 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 6 cost time: 0.6519062519073486
Epoch: 6, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.805 Vali Acc: 0.850 Test Loss: 0.805 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 0.718754768371582
Epoch: 7, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.721 Vali Acc: 0.875 Test Loss: 0.721 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.6440539360046387
Epoch: 8, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.662 Vali Acc: 0.900 Test Loss: 0.662 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.5788817405700684
Epoch: 9, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.604 Vali Acc: 0.900 Test Loss: 0.604 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.7243945598602295
Epoch: 10, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.556 Vali Acc: 0.925 Test Loss: 0.556 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.7151896953582764
Epoch: 11, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6578128337860107
Epoch: 12, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6504230499267578
Epoch: 13, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7095928192138672
Epoch: 14, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.6293559074401855
Epoch: 15, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6713321208953857
Epoch: 16, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7375075817108154
Epoch: 17, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6463277339935303
Epoch: 18, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6774115562438965
Epoch: 19, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7694559097290039
Epoch: 20, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7066524028778076
Epoch: 21, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6969394683837891
Epoch: 22, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6913306713104248
Epoch: 23, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7085983753204346
Epoch: 24, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1173332
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3437540531158447
Epoch: 1, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.6280925273895264
Epoch: 2, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.204 Vali Acc: 0.550 Test Loss: 1.204 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 0.6366841793060303
Epoch: 3, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 0.639641284942627
Epoch: 4, Steps: 3 | Train Loss: 0.943 Vali Loss: 0.999 Vali Acc: 0.775 Test Loss: 0.999 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 5 cost time: 0.6302754878997803
Epoch: 5, Steps: 3 | Train Loss: 0.888 Vali Loss: 0.892 Vali Acc: 0.850 Test Loss: 0.892 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 6 cost time: 0.6126441955566406
Epoch: 6, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.788 Vali Acc: 0.875 Test Loss: 0.788 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.6128487586975098
Epoch: 7, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.703 Vali Acc: 0.900 Test Loss: 0.703 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 0.6302275657653809
Epoch: 8, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.631 Vali Acc: 0.900 Test Loss: 0.631 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 0.6133778095245361
Epoch: 9, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.568 Vali Acc: 0.900 Test Loss: 0.568 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.5973012447357178
Epoch: 10, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 0.6219313144683838
Epoch: 11, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.458 Vali Acc: 0.950 Test Loss: 0.458 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.6568760871887207
Epoch: 12, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.407 Vali Acc: 0.950 Test Loss: 0.407 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.6634092330932617
Epoch: 13, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.670781135559082
Epoch: 14, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.6988527774810791
Epoch: 15, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6697189807891846
Epoch: 16, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.660686731338501
Epoch: 17, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.6904394626617432
Epoch: 18, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6442670822143555
Epoch: 19, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6139888763427734
Epoch: 20, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6727216243743896
Epoch: 21, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6358754634857178
Epoch: 22, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7172164916992188
Epoch: 23, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6496355533599854
Epoch: 24, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7261753082275391
Epoch: 25, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6220571994781494
Epoch: 26, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6533958911895752
Epoch: 27, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1173332
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3302271366119385
Epoch: 1, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.269 Vali Acc: 0.475 Test Loss: 1.269 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.7059390544891357
Epoch: 2, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.210 Vali Acc: 0.600 Test Loss: 1.210 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 0.6510891914367676
Epoch: 3, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.111 Vali Acc: 0.750 Test Loss: 1.111 Test Acc: 0.750
Validation loss decreased (-0.599988 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 0.6016011238098145
Epoch: 4, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.004 Vali Acc: 0.800 Test Loss: 1.004 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 5 cost time: 0.5893914699554443
Epoch: 5, Steps: 3 | Train Loss: 0.878 Vali Loss: 0.892 Vali Acc: 0.875 Test Loss: 0.892 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 0.6381072998046875
Epoch: 6, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.788 Vali Acc: 0.900 Test Loss: 0.788 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 7 cost time: 0.6161985397338867
Epoch: 7, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.697 Vali Acc: 0.925 Test Loss: 0.697 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.6192591190338135
Epoch: 8, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.621 Vali Acc: 0.925 Test Loss: 0.621 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 0.7654712200164795
Epoch: 9, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.553 Vali Acc: 0.925 Test Loss: 0.553 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.6400644779205322
Epoch: 10, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.496 Vali Acc: 0.950 Test Loss: 0.496 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.6350677013397217
Epoch: 11, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.6279792785644531
Epoch: 12, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.6493716239929199
Epoch: 13, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.6189754009246826
Epoch: 14, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.6572527885437012
Epoch: 15, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6570727825164795
Epoch: 16, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.5983994007110596
Epoch: 17, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.5690231323242188
Epoch: 18, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6655356884002686
Epoch: 19, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6030609607696533
Epoch: 20, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6838266849517822
Epoch: 21, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6773066520690918
Epoch: 22, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6627554893493652
Epoch: 23, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6888349056243896
Epoch: 24, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7046413421630859
Epoch: 25, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.65787672996521
Epoch: 26, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7398362159729004
Epoch: 27, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1173332
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2890424728393555
Epoch: 1, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.313 Vali Acc: 0.350 Test Loss: 1.313 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.600231409072876
Epoch: 2, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.257 Vali Acc: 0.600 Test Loss: 1.257 Test Acc: 0.600
Validation loss decreased (-0.349987 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 0.6964223384857178
Epoch: 3, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.163 Vali Acc: 0.750 Test Loss: 1.163 Test Acc: 0.750
Validation loss decreased (-0.599987 --> -0.749988).  Saving model ...
Epoch: 4 cost time: 0.63616943359375
Epoch: 4, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.052 Vali Acc: 0.825 Test Loss: 1.052 Test Acc: 0.825
Validation loss decreased (-0.749988 --> -0.824989).  Saving model ...
Epoch: 5 cost time: 0.708634614944458
Epoch: 5, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.934 Vali Acc: 0.900 Test Loss: 0.934 Test Acc: 0.900
Validation loss decreased (-0.824989 --> -0.899991).  Saving model ...
Epoch: 6 cost time: 0.7267940044403076
Epoch: 6, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.823 Vali Acc: 0.900 Test Loss: 0.823 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 7 cost time: 0.6552543640136719
Epoch: 7, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.723 Vali Acc: 0.925 Test Loss: 0.723 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.7205095291137695
Epoch: 8, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.630 Vali Acc: 0.950 Test Loss: 0.630 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.6351256370544434
Epoch: 9, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.553 Vali Acc: 0.950 Test Loss: 0.553 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.6756992340087891
Epoch: 10, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.484 Vali Acc: 0.950 Test Loss: 0.484 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.6523234844207764
Epoch: 11, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.415 Vali Acc: 0.975 Test Loss: 0.415 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.6235392093658447
Epoch: 12, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.361 Vali Acc: 0.975 Test Loss: 0.361 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.6104602813720703
Epoch: 13, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.640101432800293
Epoch: 14, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.6315522193908691
Epoch: 15, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.6363158226013184
Epoch: 16, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.7332553863525391
Epoch: 17, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.6731998920440674
Epoch: 18, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.6492195129394531
Epoch: 19, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.6864237785339355
Epoch: 20, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.6426692008972168
Epoch: 21, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.671135425567627
Epoch: 22, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.6601657867431641
Epoch: 23, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.617506742477417
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.6681830883026123
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.6328034400939941
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.6261096000671387
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.6449465751647949
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.671917200088501
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.6988470554351807
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.6433560848236084
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 32 cost time: 0.6480603218078613
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 33 cost time: 0.6073269844055176
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.642167329788208
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.688990592956543
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.6815943717956543
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.6078546047210693
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.642186164855957
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.7190473079681396
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.6299042701721191
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.6315195560455322
Epoch: 41, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6217381954193115
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6245450973510742
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.5751218795776367
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.6102478504180908
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.5807445049285889
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.6157279014587402
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.5620696544647217
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.5099959373474121
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.6150856018066406
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5950353145599365
Epoch: 51, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 52 cost time: 0.5959105491638184
Epoch: 52, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 53 cost time: 0.5997838973999023
Epoch: 53, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 54 cost time: 0.5580966472625732
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 55 cost time: 0.6274683475494385
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 56 cost time: 0.5787842273712158
Epoch: 56, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 57 cost time: 0.6062600612640381
Epoch: 57, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 58 cost time: 0.7020931243896484
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 59 cost time: 0.6010775566101074
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 60 cost time: 0.6321191787719727
Epoch: 60, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 61 cost time: 0.6100754737854004
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 62 cost time: 0.5929405689239502
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 63 cost time: 0.6514837741851807
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 64 cost time: 0.6204836368560791
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 65 cost time: 0.6481935977935791
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 66 cost time: 0.6736433506011963
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 67 cost time: 0.700200080871582
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 68 cost time: 0.7059710025787354
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 69 cost time: 0.605703592300415
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6541345119476318
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6786613464355469
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 72 cost time: 0.6560969352722168
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 73 cost time: 0.6670079231262207
Epoch: 73, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 74 cost time: 0.6913163661956787
Epoch: 74, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 75 cost time: 0.6556274890899658
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 76 cost time: 0.8098337650299072
Epoch: 76, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.6050801277160645
Epoch: 77, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 78 cost time: 0.6086404323577881
Epoch: 78, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.6249673366546631
Epoch: 79, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.6291186809539795
Epoch: 80, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.5907013416290283
Epoch: 81, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.7110345363616943
Epoch: 82, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.6549193859100342
Epoch: 83, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.6205451488494873
Epoch: 84, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.6684374809265137
Epoch: 85, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.6533429622650146
Epoch: 86, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.596416711807251
Epoch: 87, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.6463348865509033
Epoch: 88, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.6291890144348145
Epoch: 89, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.6352336406707764
Epoch: 90, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 91 cost time: 0.703526496887207
Epoch: 91, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.715252161026001
Epoch: 92, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 93 cost time: 0.7062265872955322
Epoch: 93, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 94 cost time: 0.7242975234985352
Epoch: 94, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 95 cost time: 0.6594867706298828
Epoch: 95, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 96 cost time: 0.6456518173217773
Epoch: 96, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 97 cost time: 0.608565092086792
Epoch: 97, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 98 cost time: 0.6645710468292236
Epoch: 98, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 99 cost time: 0.6814796924591064
Epoch: 99, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 100 cost time: 0.659548282623291
Epoch: 100, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1173332
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.30008864402771
Epoch: 1, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.341 Vali Acc: 0.250 Test Loss: 1.341 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.6466519832611084
Epoch: 2, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.273 Vali Acc: 0.275 Test Loss: 1.273 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.6312291622161865
Epoch: 3, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.166 Vali Acc: 0.350 Test Loss: 1.166 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349988).  Saving model ...
Epoch: 4 cost time: 0.640625
Epoch: 4, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.349988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.652179479598999
Epoch: 5, Steps: 3 | Train Loss: 1.017 Vali Loss: 0.944 Vali Acc: 0.525 Test Loss: 0.944 Test Acc: 0.525
Validation loss decreased (-0.399989 --> -0.524991).  Saving model ...
Epoch: 6 cost time: 0.5985519886016846
Epoch: 6, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.831 Vali Acc: 0.775 Test Loss: 0.831 Test Acc: 0.775
Validation loss decreased (-0.524991 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 0.6405439376831055
Epoch: 7, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.719 Vali Acc: 0.950 Test Loss: 0.719 Test Acc: 0.950
Validation loss decreased (-0.774992 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 0.5871374607086182
Epoch: 8, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.639 Vali Acc: 0.950 Test Loss: 0.639 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.5794408321380615
Epoch: 9, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.576 Vali Acc: 0.925 Test Loss: 0.576 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5668282508850098
Epoch: 10, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.533 Vali Acc: 0.925 Test Loss: 0.533 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6703383922576904
Epoch: 11, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5866024494171143
Epoch: 12, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5286896228790283
Epoch: 13, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5913586616516113
Epoch: 14, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.5676307678222656
Epoch: 15, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.5824480056762695
Epoch: 16, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.5949361324310303
Epoch: 17, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5757479667663574
Epoch: 18, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5795450210571289
Epoch: 19, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6864371299743652
Epoch: 20, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6359086036682129
Epoch: 21, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5759735107421875
Epoch: 22, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6242518424987793
Epoch: 23, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6478960514068604
Epoch: 24, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7085535526275635
Epoch: 25, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6096253395080566
Epoch: 26, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5917377471923828
Epoch: 27, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 649044
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.392001152038574
Epoch: 1, Steps: 3 | Train Loss: 1.528 Vali Loss: 1.345 Vali Acc: 0.225 Test Loss: 1.345 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.701157808303833
Epoch: 2, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.280 Vali Acc: 0.275 Test Loss: 1.280 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.6487305164337158
Epoch: 3, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.176 Vali Acc: 0.325 Test Loss: 1.176 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324988).  Saving model ...
Epoch: 4 cost time: 0.6420872211456299
Epoch: 4, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.324988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6068007946014404
Epoch: 5, Steps: 3 | Train Loss: 1.006 Vali Loss: 0.945 Vali Acc: 0.575 Test Loss: 0.945 Test Acc: 0.575
Validation loss decreased (-0.399989 --> -0.574991).  Saving model ...
Epoch: 6 cost time: 0.6976461410522461
Epoch: 6, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
Validation loss decreased (-0.574991 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 0.6693575382232666
Epoch: 7, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.725 Vali Acc: 0.900 Test Loss: 0.725 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 0.5554947853088379
Epoch: 8, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.639 Vali Acc: 0.925 Test Loss: 0.639 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 0.629570722579956
Epoch: 9, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.6726667881011963
Epoch: 10, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6320722103118896
Epoch: 11, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.6398789882659912
Epoch: 12, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 0.6297285556793213
Epoch: 13, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.6084589958190918
Epoch: 14, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.5632226467132568
Epoch: 15, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 0.664067268371582
Epoch: 16, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.7329680919647217
Epoch: 17, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 0.7098464965820312
Epoch: 18, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 0.6373376846313477
Epoch: 19, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6609930992126465
Epoch: 20, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6715133190155029
Epoch: 21, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7198050022125244
Epoch: 22, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6974437236785889
Epoch: 23, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7113900184631348
Epoch: 24, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6107475757598877
Epoch: 25, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6519443988800049
Epoch: 26, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6470451354980469
Epoch: 27, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.7333822250366211
Epoch: 28, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6798379421234131
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.609381914138794
Epoch: 30, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6356501579284668
Epoch: 31, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6385934352874756
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7388694286346436
Epoch: 33, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6009533405303955
Epoch: 34, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6384720802307129
Epoch: 35, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.640448808670044
Epoch: 36, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5599575042724609
Epoch: 37, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 649044
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.282871961593628
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.344 Vali Acc: 0.225 Test Loss: 1.344 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.6295177936553955
Epoch: 2, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.284 Vali Acc: 0.300 Test Loss: 1.284 Test Acc: 0.300
Validation loss decreased (-0.224987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.6859197616577148
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.184 Vali Acc: 0.375 Test Loss: 1.184 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.6861441135406494
Epoch: 4, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.075 Vali Acc: 0.450 Test Loss: 1.075 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449989).  Saving model ...
Epoch: 5 cost time: 0.6610546112060547
Epoch: 5, Steps: 3 | Train Loss: 1.008 Vali Loss: 0.957 Vali Acc: 0.675 Test Loss: 0.957 Test Acc: 0.675
Validation loss decreased (-0.449989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.6934719085693359
Epoch: 6, Steps: 3 | Train Loss: 0.857 Vali Loss: 0.842 Vali Acc: 0.825 Test Loss: 0.842 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824992).  Saving model ...
Epoch: 7 cost time: 0.669663667678833
Epoch: 7, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.726 Vali Acc: 0.925 Test Loss: 0.726 Test Acc: 0.925
Validation loss decreased (-0.824992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.7135512828826904
Epoch: 8, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.634 Vali Acc: 0.925 Test Loss: 0.634 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 0.6699552536010742
Epoch: 9, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.562 Vali Acc: 0.925 Test Loss: 0.562 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.6900708675384521
Epoch: 10, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 0.6475324630737305
Epoch: 11, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.466 Vali Acc: 0.925 Test Loss: 0.466 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.6404695510864258
Epoch: 12, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 0.6705327033996582
Epoch: 13, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.6581418514251709
Epoch: 14, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.6454942226409912
Epoch: 15, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6883273124694824
Epoch: 16, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.7545115947723389
Epoch: 17, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.6530346870422363
Epoch: 18, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.6892576217651367
Epoch: 19, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.763286828994751
Epoch: 20, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7300035953521729
Epoch: 21, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7190756797790527
Epoch: 22, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7153973579406738
Epoch: 23, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7500629425048828
Epoch: 24, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.7559685707092285
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.6667828559875488
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.6859622001647949
Epoch: 27, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.6001629829406738
Epoch: 28, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6446409225463867
Epoch: 29, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.6546511650085449
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.6705789566040039
Epoch: 31, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6187989711761475
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5882987976074219
Epoch: 33, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7043530941009521
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6511342525482178
Epoch: 35, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.642035961151123
Epoch: 36, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6693670749664307
Epoch: 37, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6287782192230225
Epoch: 38, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.617870569229126
Epoch: 39, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6119837760925293
Epoch: 40, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 649044
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.232295036315918
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.328 Vali Acc: 0.300 Test Loss: 1.328 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.6078133583068848
Epoch: 2, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.272 Vali Acc: 0.350 Test Loss: 1.272 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.6428334712982178
Epoch: 3, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.178 Vali Acc: 0.475 Test Loss: 1.178 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.6500141620635986
Epoch: 4, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.076 Vali Acc: 0.625 Test Loss: 1.076 Test Acc: 0.625
Validation loss decreased (-0.474988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.6208019256591797
Epoch: 5, Steps: 3 | Train Loss: 0.978 Vali Loss: 0.960 Vali Acc: 0.825 Test Loss: 0.960 Test Acc: 0.825
Validation loss decreased (-0.624989 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.6049621105194092
Epoch: 6, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.845 Vali Acc: 0.925 Test Loss: 0.845 Test Acc: 0.925
Validation loss decreased (-0.824990 --> -0.924992).  Saving model ...
Epoch: 7 cost time: 0.6184101104736328
Epoch: 7, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.731 Vali Acc: 0.950 Test Loss: 0.731 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 0.5833032131195068
Epoch: 8, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.637 Vali Acc: 0.950 Test Loss: 0.637 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.5995376110076904
Epoch: 9, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.557 Vali Acc: 0.950 Test Loss: 0.557 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.5404496192932129
Epoch: 10, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.6072537899017334
Epoch: 11, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.438 Vali Acc: 0.975 Test Loss: 0.438 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.6085193157196045
Epoch: 12, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5492050647735596
Epoch: 13, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.326 Vali Acc: 0.975 Test Loss: 0.326 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.6272022724151611
Epoch: 14, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.6143217086791992
Epoch: 15, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.5832033157348633
Epoch: 16, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.606891393661499
Epoch: 17, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.5637872219085693
Epoch: 18, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.5982627868652344
Epoch: 19, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5954651832580566
Epoch: 20, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.5632359981536865
Epoch: 21, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.5727057456970215
Epoch: 22, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.5484957695007324
Epoch: 23, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.551095724105835
Epoch: 24, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 0.624596357345581
Epoch: 25, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.6055741310119629
Epoch: 26, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 0.5209956169128418
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 0.5418441295623779
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 0.5729756355285645
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 0.5945630073547363
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 31 cost time: 0.5612497329711914
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 32 cost time: 0.6259357929229736
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 33 cost time: 0.5989532470703125
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.6143233776092529
Epoch: 34, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.6498622894287109
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7259109020233154
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.6275711059570312
Epoch: 37, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.6103055477142334
Epoch: 38, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.6254293918609619
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.6290841102600098
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.6290159225463867
Epoch: 41, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.6409416198730469
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.6413555145263672
Epoch: 43, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.676304817199707
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.6832189559936523
Epoch: 45, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.6858489513397217
Epoch: 46, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.6529195308685303
Epoch: 47, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.6075987815856934
Epoch: 48, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.649566650390625
Epoch: 49, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.6566972732543945
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 51 cost time: 0.6747572422027588
Epoch: 51, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 52 cost time: 0.6706106662750244
Epoch: 52, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 53 cost time: 0.6588151454925537
Epoch: 53, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 54 cost time: 0.6739528179168701
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 55 cost time: 0.6431097984313965
Epoch: 55, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 56 cost time: 0.5967240333557129
Epoch: 56, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 57 cost time: 0.5946259498596191
Epoch: 57, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 58 cost time: 0.5994510650634766
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6493616104125977
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6015899181365967
Epoch: 60, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.555513858795166
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 62 cost time: 0.6484873294830322
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 63 cost time: 0.5560176372528076
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 64 cost time: 0.5807774066925049
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5870156288146973
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5038156509399414
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 67 cost time: 0.6563010215759277
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 68 cost time: 0.6238107681274414
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 69 cost time: 0.6714811325073242
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 70 cost time: 0.6169836521148682
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 71 cost time: 0.6983773708343506
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 72 cost time: 0.6047310829162598
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 73 cost time: 0.5923645496368408
Epoch: 73, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 74 cost time: 0.6766068935394287
Epoch: 74, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 75 cost time: 0.5781311988830566
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 76 cost time: 0.5702087879180908
Epoch: 76, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.5667846202850342
Epoch: 77, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6919410228729248
Epoch: 78, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.6131746768951416
Epoch: 79, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.572171688079834
Epoch: 80, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.6740155220031738
Epoch: 81, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 82 cost time: 0.611602783203125
Epoch: 82, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.5466189384460449
Epoch: 83, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.6033799648284912
Epoch: 84, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.6369400024414062
Epoch: 85, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.5552244186401367
Epoch: 86, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.5338144302368164
Epoch: 87, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.5715842247009277
Epoch: 88, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.6149671077728271
Epoch: 89, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.5681180953979492
Epoch: 90, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.5459520816802979
Epoch: 91, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 92 cost time: 0.5731077194213867
Epoch: 92, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 93 cost time: 0.5263583660125732
Epoch: 93, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 94 cost time: 0.5991063117980957
Epoch: 94, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.56406569480896
Epoch: 95, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 96 cost time: 0.5915427207946777
Epoch: 96, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 97 cost time: 0.5900628566741943
Epoch: 97, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.6172397136688232
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.5218031406402588
Epoch: 99, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.5950744152069092
Epoch: 100, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 649044
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2939019203186035
Epoch: 1, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.287 Vali Acc: 0.450 Test Loss: 1.287 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.6315958499908447
Epoch: 2, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 0.7079982757568359
Epoch: 3, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.078 Vali Acc: 0.575 Test Loss: 1.078 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.597360372543335
Epoch: 4, Steps: 3 | Train Loss: 1.135 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.6214687824249268
Epoch: 5, Steps: 3 | Train Loss: 0.935 Vali Loss: 0.871 Vali Acc: 0.600 Test Loss: 0.871 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599991).  Saving model ...
Epoch: 6 cost time: 0.6625211238861084
Epoch: 6, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.771 Vali Acc: 0.725 Test Loss: 0.771 Test Acc: 0.725
Validation loss decreased (-0.599991 --> -0.724992).  Saving model ...
Epoch: 7 cost time: 0.6237614154815674
Epoch: 7, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
Validation loss decreased (-0.724992 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 0.6318151950836182
Epoch: 8, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 0.5871973037719727
Epoch: 9, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.529 Vali Acc: 0.950 Test Loss: 0.529 Test Acc: 0.950
Validation loss decreased (-0.849994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.6360225677490234
Epoch: 10, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.498 Vali Acc: 0.975 Test Loss: 0.498 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.6579976081848145
Epoch: 11, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.452 Vali Acc: 0.975 Test Loss: 0.452 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 12 cost time: 0.5690422058105469
Epoch: 12, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5932202339172363
Epoch: 13, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.568403959274292
Epoch: 14, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5859041213989258
Epoch: 15, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.606285572052002
Epoch: 16, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6136689186096191
Epoch: 17, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5489246845245361
Epoch: 18, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6156930923461914
Epoch: 19, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6184296607971191
Epoch: 20, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5853793621063232
Epoch: 21, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 386900
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.505100727081299
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.331 Vali Acc: 0.450 Test Loss: 1.331 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.6898689270019531
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.232 Vali Acc: 0.550 Test Loss: 1.232 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 0.7303342819213867
Epoch: 3, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.695920467376709
Epoch: 4, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.000 Vali Acc: 0.575 Test Loss: 1.000 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7332682609558105
Epoch: 5, Steps: 3 | Train Loss: 0.967 Vali Loss: 0.891 Vali Acc: 0.650 Test Loss: 0.891 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649991).  Saving model ...
Epoch: 6 cost time: 0.6688566207885742
Epoch: 6, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
Validation loss decreased (-0.649991 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 0.6478259563446045
Epoch: 7, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849993).  Saving model ...
Epoch: 8 cost time: 0.6912229061126709
Epoch: 8, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.600 Vali Acc: 0.950 Test Loss: 0.600 Test Acc: 0.950
Validation loss decreased (-0.849993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.6768519878387451
Epoch: 9, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.539 Vali Acc: 0.950 Test Loss: 0.539 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.6613049507141113
Epoch: 10, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.508 Vali Acc: 0.975 Test Loss: 0.508 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.7186470031738281
Epoch: 11, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7112772464752197
Epoch: 12, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.407 Vali Acc: 0.950 Test Loss: 0.407 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6577050685882568
Epoch: 13, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.723797082901001
Epoch: 14, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6043102741241455
Epoch: 15, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6832914352416992
Epoch: 16, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6483776569366455
Epoch: 17, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6501359939575195
Epoch: 18, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6237266063690186
Epoch: 19, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6771879196166992
Epoch: 20, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 386900
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1859588623046875
Epoch: 1, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.355 Vali Acc: 0.450 Test Loss: 1.355 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.6786024570465088
Epoch: 2, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.265 Vali Acc: 0.525 Test Loss: 1.265 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.7033350467681885
Epoch: 3, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.588221549987793
Epoch: 4, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.041 Vali Acc: 0.625 Test Loss: 1.041 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 0.6369800567626953
Epoch: 5, Steps: 3 | Train Loss: 0.957 Vali Loss: 0.926 Vali Acc: 0.725 Test Loss: 0.926 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724991).  Saving model ...
Epoch: 6 cost time: 0.6020565032958984
Epoch: 6, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 7 cost time: 0.5655667781829834
Epoch: 7, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.708 Vali Acc: 0.925 Test Loss: 0.708 Test Acc: 0.925
Validation loss decreased (-0.749992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.5698306560516357
Epoch: 8, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.620 Vali Acc: 0.925 Test Loss: 0.620 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 0.6536464691162109
Epoch: 9, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.553 Vali Acc: 0.950 Test Loss: 0.553 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.6093471050262451
Epoch: 10, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.520 Vali Acc: 0.950 Test Loss: 0.520 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.6235141754150391
Epoch: 11, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.484 Vali Acc: 0.950 Test Loss: 0.484 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.7146553993225098
Epoch: 12, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.5823895931243896
Epoch: 13, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6091735363006592
Epoch: 14, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.603689432144165
Epoch: 15, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.5986037254333496
Epoch: 16, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5978875160217285
Epoch: 17, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5785582065582275
Epoch: 18, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6617088317871094
Epoch: 19, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6690104007720947
Epoch: 20, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6658387184143066
Epoch: 21, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6235771179199219
Epoch: 22, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5978038311004639
Epoch: 23, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5617742538452148
Epoch: 24, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5791146755218506
Epoch: 25, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 386900
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1609673500061035
Epoch: 1, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.404 Vali Acc: 0.350 Test Loss: 1.404 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5984282493591309
Epoch: 2, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.322 Vali Acc: 0.425 Test Loss: 1.322 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.6423835754394531
Epoch: 3, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.6475088596343994
Epoch: 4, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.097 Vali Acc: 0.675 Test Loss: 1.097 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.6780505180358887
Epoch: 5, Steps: 3 | Train Loss: 0.935 Vali Loss: 0.981 Vali Acc: 0.775 Test Loss: 0.981 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 0.7111668586730957
Epoch: 6, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.863 Vali Acc: 0.875 Test Loss: 0.863 Test Acc: 0.875
Validation loss decreased (-0.774990 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.672752857208252
Epoch: 7, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.752 Vali Acc: 0.925 Test Loss: 0.752 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924992).  Saving model ...
Epoch: 8 cost time: 0.7241060733795166
Epoch: 8, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.654 Vali Acc: 0.975 Test Loss: 0.654 Test Acc: 0.975
Validation loss decreased (-0.924992 --> -0.974993).  Saving model ...
Epoch: 9 cost time: 0.6875214576721191
Epoch: 9, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.572 Vali Acc: 0.950 Test Loss: 0.572 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.697077751159668
Epoch: 10, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.523 Vali Acc: 0.975 Test Loss: 0.523 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.6662867069244385
Epoch: 11, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.475 Vali Acc: 0.950 Test Loss: 0.475 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7277083396911621
Epoch: 12, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.429 Vali Acc: 0.950 Test Loss: 0.429 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7020540237426758
Epoch: 13, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6857681274414062
Epoch: 14, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.323 Vali Acc: 0.975 Test Loss: 0.323 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.7391858100891113
Epoch: 15, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7307028770446777
Epoch: 16, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6800782680511475
Epoch: 17, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6479394435882568
Epoch: 18, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6554098129272461
Epoch: 19, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6424641609191895
Epoch: 20, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.643216609954834
Epoch: 21, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5751996040344238
Epoch: 22, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.695732831954956
Epoch: 23, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6670000553131104
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 386900
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.515937328338623
Epoch: 1, Steps: 3 | Train Loss: 1.554 Vali Loss: 1.480 Vali Acc: 0.225 Test Loss: 1.480 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.6126770973205566
Epoch: 2, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.379 Vali Acc: 0.225 Test Loss: 1.379 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.6732556819915771
Epoch: 3, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.239 Vali Acc: 0.300 Test Loss: 1.239 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299988).  Saving model ...
Epoch: 4 cost time: 0.6892297267913818
Epoch: 4, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.113 Vali Acc: 0.525 Test Loss: 1.113 Test Acc: 0.525
Validation loss decreased (-0.299988 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.5942251682281494
Epoch: 5, Steps: 3 | Train Loss: 0.978 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
Validation loss decreased (-0.524989 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 0.6308574676513672
Epoch: 6, Steps: 3 | Train Loss: 0.875 Vali Loss: 0.891 Vali Acc: 0.800 Test Loss: 0.891 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.6236763000488281
Epoch: 7, Steps: 3 | Train Loss: 0.765 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 0.6145591735839844
Epoch: 8, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.673 Vali Acc: 0.900 Test Loss: 0.673 Test Acc: 0.900
Validation loss decreased (-0.799992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.6390976905822754
Epoch: 9, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.609 Vali Acc: 0.900 Test Loss: 0.609 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.6466588973999023
Epoch: 10, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7031204700469971
Epoch: 11, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.556 Vali Acc: 0.875 Test Loss: 0.556 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.658320426940918
Epoch: 12, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7017769813537598
Epoch: 13, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6377947330474854
Epoch: 14, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6623611450195312
Epoch: 15, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 0.6717512607574463
Epoch: 16, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.6419968605041504
Epoch: 17, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.6543855667114258
Epoch: 18, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7190389633178711
Epoch: 19, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7940759658813477
Epoch: 20, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6687915325164795
Epoch: 21, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6929717063903809
Epoch: 22, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7648985385894775
Epoch: 23, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6193122863769531
Epoch: 24, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.440 Vali Acc: 0.925 Test Loss: 0.440 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8102700710296631
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6403577327728271
Epoch: 26, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6595931053161621
Epoch: 27, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 255828
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.367577075958252
Epoch: 1, Steps: 3 | Train Loss: 1.562 Vali Loss: 1.456 Vali Acc: 0.150 Test Loss: 1.456 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.5951507091522217
Epoch: 2, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.361 Vali Acc: 0.250 Test Loss: 1.361 Test Acc: 0.250
Validation loss decreased (-0.149985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.6189110279083252
Epoch: 3, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.226 Vali Acc: 0.350 Test Loss: 1.226 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349988).  Saving model ...
Epoch: 4 cost time: 0.6287021636962891
Epoch: 4, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
Validation loss decreased (-0.349988 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 0.6300945281982422
Epoch: 5, Steps: 3 | Train Loss: 0.980 Vali Loss: 0.987 Vali Acc: 0.700 Test Loss: 0.987 Test Acc: 0.700
Validation loss decreased (-0.499989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 0.6625640392303467
Epoch: 6, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.879 Vali Acc: 0.800 Test Loss: 0.879 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.6779365539550781
Epoch: 7, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.765 Vali Acc: 0.875 Test Loss: 0.765 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.7138674259185791
Epoch: 8, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.662 Vali Acc: 0.900 Test Loss: 0.662 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.6755208969116211
Epoch: 9, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.6857633590698242
Epoch: 10, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6679389476776123
Epoch: 11, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6653704643249512
Epoch: 12, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6616611480712891
Epoch: 13, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6585605144500732
Epoch: 14, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.680316686630249
Epoch: 15, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7504889965057373
Epoch: 16, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 0.6633577346801758
Epoch: 17, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 0.6585593223571777
Epoch: 18, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.696688175201416
Epoch: 19, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6550002098083496
Epoch: 20, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6887495517730713
Epoch: 21, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6747126579284668
Epoch: 22, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.566765546798706
Epoch: 23, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6502375602722168
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6204187870025635
Epoch: 25, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6737759113311768
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.631197452545166
Epoch: 27, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 255828
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3453612327575684
Epoch: 1, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.639014720916748
Epoch: 2, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.359 Vali Acc: 0.300 Test Loss: 1.359 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.6873157024383545
Epoch: 3, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6712932586669922
Epoch: 4, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.112 Vali Acc: 0.575 Test Loss: 1.112 Test Acc: 0.575
Validation loss decreased (-0.399988 --> -0.574989).  Saving model ...
Epoch: 5 cost time: 0.6583738327026367
Epoch: 5, Steps: 3 | Train Loss: 0.963 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
Validation loss decreased (-0.574989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 0.700955867767334
Epoch: 6, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.879 Vali Acc: 0.825 Test Loss: 0.879 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 0.7087292671203613
Epoch: 7, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.764 Vali Acc: 0.900 Test Loss: 0.764 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 8 cost time: 0.704345703125
Epoch: 8, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.654 Vali Acc: 0.975 Test Loss: 0.654 Test Acc: 0.975
Validation loss decreased (-0.899992 --> -0.974993).  Saving model ...
Epoch: 9 cost time: 0.6927297115325928
Epoch: 9, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.575 Vali Acc: 0.950 Test Loss: 0.575 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7128236293792725
Epoch: 10, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.520 Vali Acc: 0.950 Test Loss: 0.520 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7338571548461914
Epoch: 11, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6731553077697754
Epoch: 12, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6595413684844971
Epoch: 13, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7170932292938232
Epoch: 14, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7455155849456787
Epoch: 15, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.752077579498291
Epoch: 16, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7324235439300537
Epoch: 17, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.6921892166137695
Epoch: 18, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.645380973815918
Epoch: 19, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6041405200958252
Epoch: 20, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6087279319763184
Epoch: 21, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.69284987449646
Epoch: 22, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6852238178253174
Epoch: 23, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7043612003326416
Epoch: 24, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6403801441192627
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6492652893066406
Epoch: 26, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6348190307617188
Epoch: 27, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.667832612991333
Epoch: 28, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 255828
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.496690034866333
Epoch: 1, Steps: 3 | Train Loss: 1.518 Vali Loss: 1.415 Vali Acc: 0.200 Test Loss: 1.415 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.6100468635559082
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.341 Vali Acc: 0.275 Test Loss: 1.341 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.6307525634765625
Epoch: 3, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
Validation loss decreased (-0.274987 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6501595973968506
Epoch: 4, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
Validation loss decreased (-0.399988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.749394416809082
Epoch: 5, Steps: 3 | Train Loss: 0.969 Vali Loss: 0.988 Vali Acc: 0.825 Test Loss: 0.988 Test Acc: 0.825
Validation loss decreased (-0.674989 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.6602473258972168
Epoch: 6, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.874 Vali Acc: 0.925 Test Loss: 0.874 Test Acc: 0.925
Validation loss decreased (-0.824990 --> -0.924991).  Saving model ...
Epoch: 7 cost time: 0.6356916427612305
Epoch: 7, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.759 Vali Acc: 0.950 Test Loss: 0.759 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949992).  Saving model ...
Epoch: 8 cost time: 0.6542057991027832
Epoch: 8, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.655 Vali Acc: 0.975 Test Loss: 0.655 Test Acc: 0.975
Validation loss decreased (-0.949992 --> -0.974993).  Saving model ...
Epoch: 9 cost time: 0.7120585441589355
Epoch: 9, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.571 Vali Acc: 0.975 Test Loss: 0.571 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 10 cost time: 0.703549861907959
Epoch: 10, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.505 Vali Acc: 0.950 Test Loss: 0.505 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7019634246826172
Epoch: 11, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.446 Vali Acc: 0.950 Test Loss: 0.446 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6945734024047852
Epoch: 12, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.387 Vali Acc: 0.975 Test Loss: 0.387 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.6290187835693359
Epoch: 13, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.343 Vali Acc: 0.975 Test Loss: 0.343 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.6666195392608643
Epoch: 14, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.307 Vali Acc: 0.975 Test Loss: 0.307 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.746549129486084
Epoch: 15, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.6943645477294922
Epoch: 16, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.7422425746917725
Epoch: 17, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.7052102088928223
Epoch: 18, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.5465168952941895
Epoch: 19, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.6476461887359619
Epoch: 20, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.6732480525970459
Epoch: 21, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.6951107978820801
Epoch: 22, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.706275224685669
Epoch: 23, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.7165882587432861
Epoch: 24, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.6992385387420654
Epoch: 25, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7920598983764648
Epoch: 26, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.733551025390625
Epoch: 27, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6494336128234863
Epoch: 28, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.6297519207000732
Epoch: 29, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.7536418437957764
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.7205584049224854
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.8591859340667725
Epoch: 32, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.75870680809021
Epoch: 33, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.709033727645874
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.719494104385376
Epoch: 35, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.6796512603759766
Epoch: 36, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.7136890888214111
Epoch: 37, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.6434106826782227
Epoch: 38, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.7104222774505615
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6651241779327393
Epoch: 40, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.726569652557373
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.771392822265625
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.6948585510253906
Epoch: 43, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.6653075218200684
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.7374086380004883
Epoch: 45, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.6449389457702637
Epoch: 46, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.6316931247711182
Epoch: 47, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.7164027690887451
Epoch: 48, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7120893001556396
Epoch: 49, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.629652738571167
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 51 cost time: 0.5692417621612549
Epoch: 51, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 52 cost time: 0.6336216926574707
Epoch: 52, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 53 cost time: 0.7101230621337891
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 54 cost time: 0.7131443023681641
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6978857517242432
Epoch: 55, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 56 cost time: 0.7010226249694824
Epoch: 56, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 57 cost time: 0.7019789218902588
Epoch: 57, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 58 cost time: 0.6896538734436035
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 59 cost time: 0.73785400390625
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 60 cost time: 0.8787484169006348
Epoch: 60, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 61 cost time: 0.7949225902557373
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 62 cost time: 0.741553544998169
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 63 cost time: 0.7126531600952148
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 64 cost time: 0.7638375759124756
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 65 cost time: 0.727543830871582
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.815255880355835
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 67 cost time: 0.8050811290740967
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 68 cost time: 0.7164287567138672
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 69 cost time: 0.6601393222808838
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 70 cost time: 0.6790452003479004
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 71 cost time: 0.6525723934173584
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 72 cost time: 0.6097838878631592
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 73 cost time: 0.6449546813964844
Epoch: 73, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 74 cost time: 0.6036980152130127
Epoch: 74, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 75 cost time: 0.7200794219970703
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 76 cost time: 0.6117370128631592
Epoch: 76, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.6168322563171387
Epoch: 77, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 78 cost time: 0.6024057865142822
Epoch: 78, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.5795590877532959
Epoch: 79, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.6788103580474854
Epoch: 80, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 81 cost time: 0.6767268180847168
Epoch: 81, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 82 cost time: 0.6071567535400391
Epoch: 82, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 83 cost time: 0.5932481288909912
Epoch: 83, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.6409039497375488
Epoch: 84, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.6204345226287842
Epoch: 85, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.631263017654419
Epoch: 86, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.5980608463287354
Epoch: 87, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.6192584037780762
Epoch: 88, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.654874324798584
Epoch: 89, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.7531130313873291
Epoch: 90, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 91 cost time: 0.6060662269592285
Epoch: 91, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 92 cost time: 0.7220070362091064
Epoch: 92, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 93 cost time: 0.6869592666625977
Epoch: 93, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 94 cost time: 0.6412808895111084
Epoch: 94, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 95 cost time: 0.6161189079284668
Epoch: 95, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 96 cost time: 0.606128454208374
Epoch: 96, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 97 cost time: 0.6282784938812256
Epoch: 97, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 98 cost time: 0.6447088718414307
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 99 cost time: 0.7243282794952393
Epoch: 99, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 100 cost time: 0.7822866439819336
Epoch: 100, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 255828
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3146278858184814
Epoch: 1, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.351 Vali Acc: 0.325 Test Loss: 1.351 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5502758026123047
Epoch: 2, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.265 Vali Acc: 0.450 Test Loss: 1.265 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.5514628887176514
Epoch: 3, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.152 Vali Acc: 0.475 Test Loss: 1.152 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.5409257411956787
Epoch: 4, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.048 Vali Acc: 0.500 Test Loss: 1.048 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499990).  Saving model ...
Epoch: 5 cost time: 0.5592999458312988
Epoch: 5, Steps: 3 | Train Loss: 1.047 Vali Loss: 0.946 Vali Acc: 0.700 Test Loss: 0.946 Test Acc: 0.700
Validation loss decreased (-0.499990 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 0.4828958511352539
Epoch: 6, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 7 cost time: 0.5237979888916016
Epoch: 7, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
Validation loss decreased (-0.749992 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.6012380123138428
Epoch: 8, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.5915331840515137
Epoch: 9, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.5772356986999512
Epoch: 10, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.530 Vali Acc: 0.925 Test Loss: 0.530 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 0.5164024829864502
Epoch: 11, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.482 Vali Acc: 0.950 Test Loss: 0.482 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.5833425521850586
Epoch: 12, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6124441623687744
Epoch: 13, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.6129705905914307
Epoch: 14, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.557889461517334
Epoch: 15, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.5963382720947266
Epoch: 16, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.6246724128723145
Epoch: 17, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6293249130249023
Epoch: 18, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6399943828582764
Epoch: 19, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6362967491149902
Epoch: 20, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6748940944671631
Epoch: 21, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6172306537628174
Epoch: 22, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6523981094360352
Epoch: 23, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6627261638641357
Epoch: 24, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6768457889556885
Epoch: 25, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6923482418060303
Epoch: 26, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 190292
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1760101318359375
Epoch: 1, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.369 Vali Acc: 0.350 Test Loss: 1.369 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6246955394744873
Epoch: 2, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.6067028045654297
Epoch: 3, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.177 Vali Acc: 0.600 Test Loss: 1.177 Test Acc: 0.600
Validation loss decreased (-0.399987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.6075077056884766
Epoch: 4, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.073 Vali Acc: 0.550 Test Loss: 1.073 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6538121700286865
Epoch: 5, Steps: 3 | Train Loss: 1.045 Vali Loss: 0.966 Vali Acc: 0.625 Test Loss: 0.966 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.6106357574462891
Epoch: 6, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.624990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.6325759887695312
Epoch: 7, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.6547520160675049
Epoch: 8, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.6539556980133057
Epoch: 9, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.585 Vali Acc: 0.900 Test Loss: 0.585 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.6150844097137451
Epoch: 10, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.519 Vali Acc: 0.950 Test Loss: 0.519 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.5776543617248535
Epoch: 11, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.475 Vali Acc: 0.950 Test Loss: 0.475 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.6650948524475098
Epoch: 12, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.6794452667236328
Epoch: 13, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.5929992198944092
Epoch: 14, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.7778458595275879
Epoch: 15, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.7905378341674805
Epoch: 16, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.6847748756408691
Epoch: 17, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.713620662689209
Epoch: 18, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.6981978416442871
Epoch: 19, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.675666093826294
Epoch: 20, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7530276775360107
Epoch: 21, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7055199146270752
Epoch: 22, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7003021240234375
Epoch: 23, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6396987438201904
Epoch: 24, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7186949253082275
Epoch: 25, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6737432479858398
Epoch: 26, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6549510955810547
Epoch: 27, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.709000825881958
Epoch: 28, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6461043357849121
Epoch: 29, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 190292
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4993183612823486
Epoch: 1, Steps: 3 | Train Loss: 1.558 Vali Loss: 1.409 Vali Acc: 0.375 Test Loss: 1.409 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6200268268585205
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.5850083827972412
Epoch: 3, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.6375324726104736
Epoch: 4, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 0.6252660751342773
Epoch: 5, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.010 Vali Acc: 0.575 Test Loss: 1.010 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574990).  Saving model ...
Epoch: 6 cost time: 0.6610405445098877
Epoch: 6, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
Validation loss decreased (-0.574990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 0.5942142009735107
Epoch: 7, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.787 Vali Acc: 0.875 Test Loss: 0.787 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.6223440170288086
Epoch: 8, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.686 Vali Acc: 0.875 Test Loss: 0.686 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 0.5924415588378906
Epoch: 9, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.599 Vali Acc: 0.950 Test Loss: 0.599 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.5718815326690674
Epoch: 10, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.527 Vali Acc: 0.950 Test Loss: 0.527 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.6509339809417725
Epoch: 11, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.477 Vali Acc: 0.950 Test Loss: 0.477 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.6124868392944336
Epoch: 12, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.7333483695983887
Epoch: 13, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.6964821815490723
Epoch: 14, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.6710412502288818
Epoch: 15, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6962237358093262
Epoch: 16, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.7313823699951172
Epoch: 17, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.6875345706939697
Epoch: 18, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.7907710075378418
Epoch: 19, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6282429695129395
Epoch: 20, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7340507507324219
Epoch: 21, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7062435150146484
Epoch: 22, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.79388427734375
Epoch: 23, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6660885810852051
Epoch: 24, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7299289703369141
Epoch: 25, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7239551544189453
Epoch: 26, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6483943462371826
Epoch: 27, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7045090198516846
Epoch: 28, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 190292
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.188336133956909
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.426 Vali Acc: 0.250 Test Loss: 1.426 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5283401012420654
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.356 Vali Acc: 0.325 Test Loss: 1.356 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5564854145050049
Epoch: 3, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.254 Vali Acc: 0.425 Test Loss: 1.254 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.5632712841033936
Epoch: 4, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.141 Vali Acc: 0.650 Test Loss: 1.141 Test Acc: 0.650
Validation loss decreased (-0.424987 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 0.5473546981811523
Epoch: 5, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.024 Vali Acc: 0.800 Test Loss: 1.024 Test Acc: 0.800
Validation loss decreased (-0.649989 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.5545716285705566
Epoch: 6, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.907 Vali Acc: 0.925 Test Loss: 0.907 Test Acc: 0.925
Validation loss decreased (-0.799990 --> -0.924991).  Saving model ...
Epoch: 7 cost time: 0.567434549331665
Epoch: 7, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.795 Vali Acc: 0.950 Test Loss: 0.795 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949992).  Saving model ...
Epoch: 8 cost time: 0.5416312217712402
Epoch: 8, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.690 Vali Acc: 0.950 Test Loss: 0.690 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 9 cost time: 0.5178401470184326
Epoch: 9, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.605 Vali Acc: 0.925 Test Loss: 0.605 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6358752250671387
Epoch: 10, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.526 Vali Acc: 0.950 Test Loss: 0.526 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.5903384685516357
Epoch: 11, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.5891556739807129
Epoch: 12, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.5649926662445068
Epoch: 13, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.5670945644378662
Epoch: 14, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.5853433609008789
Epoch: 15, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.5758087635040283
Epoch: 16, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.6234142780303955
Epoch: 17, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 0.6426131725311279
Epoch: 18, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 0.6458323001861572
Epoch: 19, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.5266587734222412
Epoch: 20, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.5761475563049316
Epoch: 21, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.5955164432525635
Epoch: 22, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.5443260669708252
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.6201043128967285
Epoch: 24, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.606360673904419
Epoch: 25, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.6080775260925293
Epoch: 26, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.603550910949707
Epoch: 27, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.6969010829925537
Epoch: 28, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.6182193756103516
Epoch: 29, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.6131384372711182
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.7142038345336914
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.555757999420166
Epoch: 32, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.6254105567932129
Epoch: 33, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.6026599407196045
Epoch: 34, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.6025941371917725
Epoch: 35, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.596574068069458
Epoch: 36, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5989029407501221
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.5968995094299316
Epoch: 38, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.6037607192993164
Epoch: 39, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.5677449703216553
Epoch: 40, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.6204712390899658
Epoch: 41, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 42 cost time: 0.5846436023712158
Epoch: 42, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 43 cost time: 0.6002533435821533
Epoch: 43, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 44 cost time: 0.5568943023681641
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 45 cost time: 0.6037459373474121
Epoch: 45, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.625032901763916
Epoch: 46, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.6122894287109375
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.6416540145874023
Epoch: 48, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.6402599811553955
Epoch: 49, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.612907886505127
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6156957149505615
Epoch: 51, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6395068168640137
Epoch: 52, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.6260135173797607
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.6537632942199707
Epoch: 54, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.6053884029388428
Epoch: 55, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6481492519378662
Epoch: 56, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.7269456386566162
Epoch: 57, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.6053266525268555
Epoch: 58, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 190292
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3858954906463623
Epoch: 1, Steps: 3 | Train Loss: 1.546 Vali Loss: 1.345 Vali Acc: 0.275 Test Loss: 1.345 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.6668820381164551
Epoch: 2, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.244 Vali Acc: 0.375 Test Loss: 1.244 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374988).  Saving model ...
Epoch: 3 cost time: 0.6174032688140869
Epoch: 3, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.114 Vali Acc: 0.425 Test Loss: 1.114 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424989).  Saving model ...
Epoch: 4 cost time: 0.623748779296875
Epoch: 4, Steps: 3 | Train Loss: 1.083 Vali Loss: 0.982 Vali Acc: 0.750 Test Loss: 0.982 Test Acc: 0.750
Validation loss decreased (-0.424989 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 0.5890638828277588
Epoch: 5, Steps: 3 | Train Loss: 1.030 Vali Loss: 0.860 Vali Acc: 0.900 Test Loss: 0.860 Test Acc: 0.900
Validation loss decreased (-0.749990 --> -0.899991).  Saving model ...
Epoch: 6 cost time: 0.5873782634735107
Epoch: 6, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.751 Vali Acc: 0.950 Test Loss: 0.751 Test Acc: 0.950
Validation loss decreased (-0.899991 --> -0.949992).  Saving model ...
Epoch: 7 cost time: 0.617077112197876
Epoch: 7, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.659 Vali Acc: 0.925 Test Loss: 0.659 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5908710956573486
Epoch: 8, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.596 Vali Acc: 0.950 Test Loss: 0.596 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.5467665195465088
Epoch: 9, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.549 Vali Acc: 0.925 Test Loss: 0.549 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6154015064239502
Epoch: 10, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.499 Vali Acc: 0.925 Test Loss: 0.499 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6645567417144775
Epoch: 11, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.453 Vali Acc: 0.925 Test Loss: 0.453 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6283104419708252
Epoch: 12, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.597898006439209
Epoch: 13, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5650248527526855
Epoch: 14, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5741913318634033
Epoch: 15, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6230528354644775
Epoch: 16, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.5832526683807373
Epoch: 17, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6718909740447998
Epoch: 18, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.719557523727417
Epoch: 19, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6633510589599609
Epoch: 20, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6795496940612793
Epoch: 21, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6925399303436279
Epoch: 22, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6571807861328125
Epoch: 23, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5838572978973389
Epoch: 24, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6122891902923584
Epoch: 25, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5476558208465576
Epoch: 26, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 157524
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4204719066619873
Epoch: 1, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5283057689666748
Epoch: 2, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.288 Vali Acc: 0.325 Test Loss: 1.288 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.5888493061065674
Epoch: 3, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6228811740875244
Epoch: 4, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.028 Vali Acc: 0.625 Test Loss: 1.028 Test Acc: 0.625
Validation loss decreased (-0.399988 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 0.5626955032348633
Epoch: 5, Steps: 3 | Train Loss: 0.993 Vali Loss: 0.899 Vali Acc: 0.850 Test Loss: 0.899 Test Acc: 0.850
Validation loss decreased (-0.624990 --> -0.849991).  Saving model ...
Epoch: 6 cost time: 0.5805137157440186
Epoch: 6, Steps: 3 | Train Loss: 0.809 Vali Loss: 0.784 Vali Acc: 0.925 Test Loss: 0.784 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924992).  Saving model ...
Epoch: 7 cost time: 0.5494475364685059
Epoch: 7, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.688 Vali Acc: 0.925 Test Loss: 0.688 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.5726840496063232
Epoch: 8, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.619 Vali Acc: 0.950 Test Loss: 0.619 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.6096453666687012
Epoch: 9, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.562 Vali Acc: 0.950 Test Loss: 0.562 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.6575438976287842
Epoch: 10, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5946869850158691
Epoch: 11, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6117327213287354
Epoch: 12, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6005961894989014
Epoch: 13, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5725796222686768
Epoch: 14, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7129969596862793
Epoch: 15, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6242129802703857
Epoch: 16, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6271183490753174
Epoch: 17, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6659443378448486
Epoch: 18, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7011599540710449
Epoch: 19, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 157524
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.344099521636963
Epoch: 1, Steps: 3 | Train Loss: 1.531 Vali Loss: 1.400 Vali Acc: 0.325 Test Loss: 1.400 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6513381004333496
Epoch: 2, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.6258482933044434
Epoch: 3, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.205 Vali Acc: 0.450 Test Loss: 1.205 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.6909260749816895
Epoch: 4, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.078 Vali Acc: 0.525 Test Loss: 1.078 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.7292628288269043
Epoch: 5, Steps: 3 | Train Loss: 0.974 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
Validation loss decreased (-0.524989 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.6728401184082031
Epoch: 6, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.830 Vali Acc: 0.875 Test Loss: 0.830 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.7027976512908936
Epoch: 7, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.726 Vali Acc: 0.925 Test Loss: 0.726 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.6765239238739014
Epoch: 8, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 0.7228431701660156
Epoch: 9, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.575 Vali Acc: 0.925 Test Loss: 0.575 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.7719278335571289
Epoch: 10, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8169772624969482
Epoch: 11, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6264326572418213
Epoch: 12, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6754958629608154
Epoch: 13, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.6283707618713379
Epoch: 14, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.6940176486968994
Epoch: 15, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 0.6654014587402344
Epoch: 16, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.6638062000274658
Epoch: 17, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 0.6264638900756836
Epoch: 18, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7047593593597412
Epoch: 19, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6278226375579834
Epoch: 20, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6231803894042969
Epoch: 21, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6456174850463867
Epoch: 22, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6028428077697754
Epoch: 23, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6920943260192871
Epoch: 24, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7103383541107178
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6711819171905518
Epoch: 26, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7303190231323242
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 157524
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5011487007141113
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.412 Vali Acc: 0.350 Test Loss: 1.412 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6056308746337891
Epoch: 2, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.6050300598144531
Epoch: 3, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.236 Vali Acc: 0.475 Test Loss: 1.236 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.5549981594085693
Epoch: 4, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
Validation loss decreased (-0.474988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.5459308624267578
Epoch: 5, Steps: 3 | Train Loss: 0.955 Vali Loss: 0.988 Vali Acc: 0.800 Test Loss: 0.988 Test Acc: 0.800
Validation loss decreased (-0.624989 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.646813154220581
Epoch: 6, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.868 Vali Acc: 0.875 Test Loss: 0.868 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.7507405281066895
Epoch: 7, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.760 Vali Acc: 0.875 Test Loss: 0.760 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.5688815116882324
Epoch: 8, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.669 Vali Acc: 0.900 Test Loss: 0.669 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.7115542888641357
Epoch: 9, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.592 Vali Acc: 0.900 Test Loss: 0.592 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.5887320041656494
Epoch: 10, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 0.5871429443359375
Epoch: 11, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 0.5692741870880127
Epoch: 12, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 0.5015666484832764
Epoch: 13, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.6332104206085205
Epoch: 14, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.6241483688354492
Epoch: 15, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 0.533562183380127
Epoch: 16, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.6083180904388428
Epoch: 17, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5948481559753418
Epoch: 18, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4805283546447754
Epoch: 19, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5871798992156982
Epoch: 20, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5285730361938477
Epoch: 21, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5931475162506104
Epoch: 22, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6038579940795898
Epoch: 23, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5710442066192627
Epoch: 24, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6057541370391846
Epoch: 25, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6793298721313477
Epoch: 26, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5699002742767334
Epoch: 27, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 157524
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5250649452209473
Epoch: 1, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.387 Vali Acc: 0.325 Test Loss: 1.387 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6159906387329102
Epoch: 2, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.6199514865875244
Epoch: 3, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.263 Vali Acc: 0.375 Test Loss: 1.263 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6644420623779297
Epoch: 4, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.187 Vali Acc: 0.525 Test Loss: 1.187 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.6134307384490967
Epoch: 5, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.107 Vali Acc: 0.600 Test Loss: 1.107 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.603280782699585
Epoch: 6, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.033 Vali Acc: 0.675 Test Loss: 1.033 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 7 cost time: 0.6326456069946289
Epoch: 7, Steps: 3 | Train Loss: 0.956 Vali Loss: 0.955 Vali Acc: 0.825 Test Loss: 0.955 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824990).  Saving model ...
Epoch: 8 cost time: 0.6394195556640625
Epoch: 8, Steps: 3 | Train Loss: 0.861 Vali Loss: 0.891 Vali Acc: 0.825 Test Loss: 0.891 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.6346232891082764
Epoch: 9, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.822 Vali Acc: 0.875 Test Loss: 0.822 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.682736873626709
Epoch: 10, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.651705265045166
Epoch: 11, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.715 Vali Acc: 0.875 Test Loss: 0.715 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.6496009826660156
Epoch: 12, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.673 Vali Acc: 0.900 Test Loss: 0.673 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.6300070285797119
Epoch: 13, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.641 Vali Acc: 0.900 Test Loss: 0.641 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.653491735458374
Epoch: 14, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.6228063106536865
Epoch: 15, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.568 Vali Acc: 0.900 Test Loss: 0.568 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.6001260280609131
Epoch: 16, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.526 Vali Acc: 0.900 Test Loss: 0.526 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.6755621433258057
Epoch: 17, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.560565710067749
Epoch: 18, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.5565567016601562
Epoch: 19, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.594149112701416
Epoch: 20, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.5971672534942627
Epoch: 21, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.6752409934997559
Epoch: 22, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.640913724899292
Epoch: 23, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.6629955768585205
Epoch: 24, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6758289337158203
Epoch: 25, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.6085169315338135
Epoch: 26, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6463112831115723
Epoch: 27, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5630068778991699
Epoch: 28, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5926446914672852
Epoch: 29, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5719883441925049
Epoch: 30, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7469170093536377
Epoch: 31, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7040562629699707
Epoch: 32, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5786154270172119
Epoch: 33, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7135734558105469
Epoch: 34, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7118985652923584
Epoch: 35, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 36 cost time: 0.620244026184082
Epoch: 36, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 0.7301919460296631
Epoch: 37, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 0.696984052658081
Epoch: 38, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 0.7047874927520752
Epoch: 39, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 40 cost time: 0.7010107040405273
Epoch: 40, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6357936859130859
Epoch: 41, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6008858680725098
Epoch: 42, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6175670623779297
Epoch: 43, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6102266311645508
Epoch: 44, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6780595779418945
Epoch: 45, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6653833389282227
Epoch: 46, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.64154052734375
Epoch: 47, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6615965366363525
Epoch: 48, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6745078563690186
Epoch: 49, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 0.6100146770477295
Epoch: 50, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 51 cost time: 0.6711146831512451
Epoch: 51, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 52 cost time: 0.6305885314941406
Epoch: 52, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6280648708343506
Epoch: 53, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6654045581817627
Epoch: 54, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6190891265869141
Epoch: 55, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.6373565196990967
Epoch: 56, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.6328880786895752
Epoch: 57, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 58 cost time: 0.6105382442474365
Epoch: 58, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 59 cost time: 0.614426851272583
Epoch: 59, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 60 cost time: 0.6225180625915527
Epoch: 60, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 61 cost time: 0.6023681163787842
Epoch: 61, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 62 cost time: 0.5615715980529785
Epoch: 62, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 63 cost time: 0.6124148368835449
Epoch: 63, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6053454875946045
Epoch: 64, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5795352458953857
Epoch: 65, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5515322685241699
Epoch: 66, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.5937979221343994
Epoch: 67, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.6817567348480225
Epoch: 68, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.6531343460083008
Epoch: 69, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.5778181552886963
Epoch: 70, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.6487057209014893
Epoch: 71, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.6213617324829102
Epoch: 72, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 570324
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3616445064544678
Epoch: 1, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.435 Vali Acc: 0.300 Test Loss: 1.435 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.615532398223877
Epoch: 2, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.379 Vali Acc: 0.325 Test Loss: 1.379 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.659867525100708
Epoch: 3, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.6237235069274902
Epoch: 4, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.237 Vali Acc: 0.525 Test Loss: 1.237 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.5957386493682861
Epoch: 5, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.157 Vali Acc: 0.575 Test Loss: 1.157 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 0.6085405349731445
Epoch: 6, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.6304807662963867
Epoch: 7, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.004 Vali Acc: 0.775 Test Loss: 1.004 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.6297838687896729
Epoch: 8, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.930 Vali Acc: 0.825 Test Loss: 0.930 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.6823971271514893
Epoch: 9, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.859 Vali Acc: 0.850 Test Loss: 0.859 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.5732765197753906
Epoch: 10, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.794 Vali Acc: 0.850 Test Loss: 0.794 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.6226930618286133
Epoch: 11, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.739 Vali Acc: 0.900 Test Loss: 0.739 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.6367936134338379
Epoch: 12, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.691 Vali Acc: 0.900 Test Loss: 0.691 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.5621378421783447
Epoch: 13, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.651 Vali Acc: 0.900 Test Loss: 0.651 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 14 cost time: 0.558945894241333
Epoch: 14, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.614 Vali Acc: 0.900 Test Loss: 0.614 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.61850905418396
Epoch: 15, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.6205613613128662
Epoch: 16, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.530 Vali Acc: 0.900 Test Loss: 0.530 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.6084017753601074
Epoch: 17, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.5440165996551514
Epoch: 18, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.6290793418884277
Epoch: 19, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.6350810527801514
Epoch: 20, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.5825746059417725
Epoch: 21, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.5565199851989746
Epoch: 22, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.6402506828308105
Epoch: 23, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.6254875659942627
Epoch: 24, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.6644301414489746
Epoch: 25, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.6588165760040283
Epoch: 26, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6500864028930664
Epoch: 27, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5978307723999023
Epoch: 28, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6341166496276855
Epoch: 29, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6464636325836182
Epoch: 30, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.577491044998169
Epoch: 31, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6703577041625977
Epoch: 32, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6623125076293945
Epoch: 33, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 0.5812218189239502
Epoch: 34, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 0.6453342437744141
Epoch: 35, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 36 cost time: 0.7101545333862305
Epoch: 36, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5829050540924072
Epoch: 37, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 0.6718430519104004
Epoch: 38, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 39 cost time: 0.5979723930358887
Epoch: 39, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 0.642122745513916
Epoch: 40, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6004667282104492
Epoch: 41, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 42 cost time: 0.6924867630004883
Epoch: 42, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6635124683380127
Epoch: 43, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6657924652099609
Epoch: 44, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6276688575744629
Epoch: 45, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6662123203277588
Epoch: 46, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6919524669647217
Epoch: 47, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.615772008895874
Epoch: 48, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6688690185546875
Epoch: 49, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.5992333889007568
Epoch: 50, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.67803955078125
Epoch: 51, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 570324
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2668333053588867
Epoch: 1, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.388 Vali Acc: 0.200 Test Loss: 1.388 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5967254638671875
Epoch: 2, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.339 Vali Acc: 0.225 Test Loss: 1.339 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.6747658252716064
Epoch: 3, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.282 Vali Acc: 0.325 Test Loss: 1.282 Test Acc: 0.325
Validation loss decreased (-0.224987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.6180417537689209
Epoch: 4, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.218 Vali Acc: 0.375 Test Loss: 1.218 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.687281608581543
Epoch: 5, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
Validation loss decreased (-0.374988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.6233892440795898
Epoch: 6, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.075 Vali Acc: 0.625 Test Loss: 1.075 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.6656839847564697
Epoch: 7, Steps: 3 | Train Loss: 0.953 Vali Loss: 0.999 Vali Acc: 0.775 Test Loss: 0.999 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.6523079872131348
Epoch: 8, Steps: 3 | Train Loss: 0.868 Vali Loss: 0.926 Vali Acc: 0.825 Test Loss: 0.926 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.677966833114624
Epoch: 9, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.855 Vali Acc: 0.850 Test Loss: 0.855 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.6561744213104248
Epoch: 10, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.791 Vali Acc: 0.900 Test Loss: 0.791 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.6297624111175537
Epoch: 11, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.730 Vali Acc: 0.900 Test Loss: 0.730 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.6693670749664307
Epoch: 12, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.6545815467834473
Epoch: 13, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.639 Vali Acc: 0.900 Test Loss: 0.639 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.7386128902435303
Epoch: 14, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.6297638416290283
Epoch: 15, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.7518963813781738
Epoch: 16, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.6836752891540527
Epoch: 17, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.7404015064239502
Epoch: 18, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.601569414138794
Epoch: 19, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.6981632709503174
Epoch: 20, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.653702974319458
Epoch: 21, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6784977912902832
Epoch: 22, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6169452667236328
Epoch: 23, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.626145601272583
Epoch: 24, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5765829086303711
Epoch: 25, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.520143985748291
Epoch: 26, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5776829719543457
Epoch: 27, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5715155601501465
Epoch: 28, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5378422737121582
Epoch: 29, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.597606897354126
Epoch: 30, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.5721232891082764
Epoch: 31, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.5833847522735596
Epoch: 32, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.5695767402648926
Epoch: 33, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5002892017364502
Epoch: 34, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.5809745788574219
Epoch: 35, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.5555639266967773
Epoch: 36, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 0.5977728366851807
Epoch: 37, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.592012882232666
Epoch: 38, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.6159157752990723
Epoch: 39, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 0.6129899024963379
Epoch: 40, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 41 cost time: 0.620894193649292
Epoch: 41, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 0.662224292755127
Epoch: 42, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 0.6293437480926514
Epoch: 43, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 0.6091735363006592
Epoch: 44, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6422297954559326
Epoch: 45, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5956151485443115
Epoch: 46, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6562371253967285
Epoch: 47, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6476469039916992
Epoch: 48, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6013457775115967
Epoch: 49, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6853024959564209
Epoch: 50, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5505905151367188
Epoch: 51, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6773030757904053
Epoch: 52, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6358921527862549
Epoch: 53, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 570324
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.352299451828003
Epoch: 1, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.383 Vali Acc: 0.275 Test Loss: 1.383 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5739796161651611
Epoch: 2, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.342 Vali Acc: 0.325 Test Loss: 1.342 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.6142220497131348
Epoch: 3, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.292 Vali Acc: 0.375 Test Loss: 1.292 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.5604898929595947
Epoch: 4, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.6483159065246582
Epoch: 5, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.6141986846923828
Epoch: 6, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.090 Vali Acc: 0.750 Test Loss: 1.090 Test Acc: 0.750
Validation loss decreased (-0.599988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.4642064571380615
Epoch: 7, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.018 Vali Acc: 0.800 Test Loss: 1.018 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.5777535438537598
Epoch: 8, Steps: 3 | Train Loss: 0.874 Vali Loss: 0.948 Vali Acc: 0.825 Test Loss: 0.948 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.5577402114868164
Epoch: 9, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.876 Vali Acc: 0.900 Test Loss: 0.876 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899991).  Saving model ...
Epoch: 10 cost time: 0.5614461898803711
Epoch: 10, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.810 Vali Acc: 0.925 Test Loss: 0.810 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.5740010738372803
Epoch: 11, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.751 Vali Acc: 0.925 Test Loss: 0.751 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 12 cost time: 0.628211498260498
Epoch: 12, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.694 Vali Acc: 0.925 Test Loss: 0.694 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.6486735343933105
Epoch: 13, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.649 Vali Acc: 0.925 Test Loss: 0.649 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.6227991580963135
Epoch: 14, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6451668739318848
Epoch: 15, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.557 Vali Acc: 0.925 Test Loss: 0.557 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 16 cost time: 0.6150963306427002
Epoch: 16, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.512 Vali Acc: 0.925 Test Loss: 0.512 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.6022238731384277
Epoch: 17, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.6729154586791992
Epoch: 18, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.6488583087921143
Epoch: 19, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.7717640399932861
Epoch: 20, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.6655309200286865
Epoch: 21, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.6629409790039062
Epoch: 22, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.6269190311431885
Epoch: 23, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.6918644905090332
Epoch: 24, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.7053625583648682
Epoch: 25, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.7066903114318848
Epoch: 26, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.6273660659790039
Epoch: 27, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.6928048133850098
Epoch: 28, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.6741108894348145
Epoch: 29, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.6704699993133545
Epoch: 30, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.7116119861602783
Epoch: 31, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.6474483013153076
Epoch: 32, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.7107620239257812
Epoch: 33, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.6979506015777588
Epoch: 34, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.629176139831543
Epoch: 35, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.6435501575469971
Epoch: 36, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5819971561431885
Epoch: 37, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.6150553226470947
Epoch: 38, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.6249926090240479
Epoch: 39, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.6578764915466309
Epoch: 40, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.6437673568725586
Epoch: 41, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.6923315525054932
Epoch: 42, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.6386966705322266
Epoch: 43, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.6242766380310059
Epoch: 44, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.7441291809082031
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.7148897647857666
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.6749303340911865
Epoch: 47, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.7053840160369873
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.719334602355957
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7101223468780518
Epoch: 50, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 51 cost time: 0.6958353519439697
Epoch: 51, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 52 cost time: 0.6848928928375244
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6987786293029785
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 54 cost time: 0.6291472911834717
Epoch: 54, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 55 cost time: 0.6039507389068604
Epoch: 55, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 56 cost time: 0.7051103115081787
Epoch: 56, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 0.6266429424285889
Epoch: 57, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 0.693673849105835
Epoch: 58, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 59 cost time: 0.6542222499847412
Epoch: 59, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 60 cost time: 0.607961893081665
Epoch: 60, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 61 cost time: 0.6392481327056885
Epoch: 61, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 62 cost time: 0.7085645198822021
Epoch: 62, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 63 cost time: 0.6602191925048828
Epoch: 63, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 64 cost time: 0.5710563659667969
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 65 cost time: 0.5840880870819092
Epoch: 65, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 66 cost time: 0.6564457416534424
Epoch: 66, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 67 cost time: 0.7032279968261719
Epoch: 67, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6612691879272461
Epoch: 68, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5940349102020264
Epoch: 69, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6208446025848389
Epoch: 70, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6629965305328369
Epoch: 71, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.5581061840057373
Epoch: 72, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.5356264114379883
Epoch: 73, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.6320188045501709
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 75 cost time: 0.5648212432861328
Epoch: 75, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 76 cost time: 0.5602526664733887
Epoch: 76, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 77 cost time: 0.614227294921875
Epoch: 77, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 78 cost time: 0.6258299350738525
Epoch: 78, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 79 cost time: 0.6224424839019775
Epoch: 79, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 80 cost time: 0.6068217754364014
Epoch: 80, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 81 cost time: 0.6088058948516846
Epoch: 81, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 82 cost time: 0.5891053676605225
Epoch: 82, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6513829231262207
Epoch: 83, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 84 cost time: 0.6407160758972168
Epoch: 84, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 85 cost time: 0.5975453853607178
Epoch: 85, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.6127781867980957
Epoch: 86, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 87 cost time: 0.64581298828125
Epoch: 87, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 88 cost time: 0.5930101871490479
Epoch: 88, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 89 cost time: 0.6726202964782715
Epoch: 89, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 90 cost time: 0.6559410095214844
Epoch: 90, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 91 cost time: 0.580467939376831
Epoch: 91, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.6361100673675537
Epoch: 92, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.6054651737213135
Epoch: 93, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.6955118179321289
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.6118659973144531
Epoch: 95, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.7272095680236816
Epoch: 96, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 97 cost time: 0.6628413200378418
Epoch: 97, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.6127772331237793
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 99 cost time: 0.6585826873779297
Epoch: 99, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 100 cost time: 0.6541168689727783
Epoch: 100, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 570324
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0544638633728027
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.446 Vali Acc: 0.200 Test Loss: 1.446 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5465447902679443
Epoch: 2, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.386 Vali Acc: 0.275 Test Loss: 1.386 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6016829013824463
Epoch: 3, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.315 Vali Acc: 0.275 Test Loss: 1.315 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.584989070892334
Epoch: 4, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.234 Vali Acc: 0.325 Test Loss: 1.234 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324988).  Saving model ...
Epoch: 5 cost time: 0.6228110790252686
Epoch: 5, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.152 Vali Acc: 0.350 Test Loss: 1.152 Test Acc: 0.350
Validation loss decreased (-0.324988 --> -0.349988).  Saving model ...
Epoch: 6 cost time: 0.5953702926635742
Epoch: 6, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.068 Vali Acc: 0.450 Test Loss: 1.068 Test Acc: 0.450
Validation loss decreased (-0.349988 --> -0.449989).  Saving model ...
Epoch: 7 cost time: 0.608020544052124
Epoch: 7, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.990 Vali Acc: 0.575 Test Loss: 0.990 Test Acc: 0.575
Validation loss decreased (-0.449989 --> -0.574990).  Saving model ...
Epoch: 8 cost time: 0.6008234024047852
Epoch: 8, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.907 Vali Acc: 0.625 Test Loss: 0.907 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624991).  Saving model ...
Epoch: 9 cost time: 0.5938553810119629
Epoch: 9, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.835 Vali Acc: 0.825 Test Loss: 0.835 Test Acc: 0.825
Validation loss decreased (-0.624991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.6133303642272949
Epoch: 10, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.770 Vali Acc: 0.900 Test Loss: 0.770 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.6229290962219238
Epoch: 11, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.719 Vali Acc: 0.925 Test Loss: 0.719 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.6580328941345215
Epoch: 12, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.676 Vali Acc: 0.900 Test Loss: 0.676 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6761207580566406
Epoch: 13, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.636 Vali Acc: 0.900 Test Loss: 0.636 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6112337112426758
Epoch: 14, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.599 Vali Acc: 0.900 Test Loss: 0.599 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5558276176452637
Epoch: 15, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.549 Vali Acc: 0.925 Test Loss: 0.549 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.5884337425231934
Epoch: 16, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.487 Vali Acc: 0.925 Test Loss: 0.487 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.6180601119995117
Epoch: 17, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.447 Vali Acc: 0.950 Test Loss: 0.447 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.6173179149627686
Epoch: 18, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6480650901794434
Epoch: 19, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6132376194000244
Epoch: 20, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6393723487854004
Epoch: 21, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5778913497924805
Epoch: 22, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6608729362487793
Epoch: 23, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6326603889465332
Epoch: 24, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6140034198760986
Epoch: 25, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5940656661987305
Epoch: 26, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6018803119659424
Epoch: 27, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 308180
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.282102346420288
Epoch: 1, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.400 Vali Acc: 0.225 Test Loss: 1.400 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.6401562690734863
Epoch: 2, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.343 Vali Acc: 0.225 Test Loss: 1.343 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.6438858509063721
Epoch: 3, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.277 Vali Acc: 0.275 Test Loss: 1.277 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.6122086048126221
Epoch: 4, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.199 Vali Acc: 0.325 Test Loss: 1.199 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324988).  Saving model ...
Epoch: 5 cost time: 0.702517032623291
Epoch: 5, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.123 Vali Acc: 0.375 Test Loss: 1.123 Test Acc: 0.375
Validation loss decreased (-0.324988 --> -0.374989).  Saving model ...
Epoch: 6 cost time: 0.6718378067016602
Epoch: 6, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.045 Vali Acc: 0.550 Test Loss: 1.045 Test Acc: 0.550
Validation loss decreased (-0.374989 --> -0.549990).  Saving model ...
Epoch: 7 cost time: 0.6955389976501465
Epoch: 7, Steps: 3 | Train Loss: 0.897 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.549990 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.5728607177734375
Epoch: 8, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.885 Vali Acc: 0.800 Test Loss: 0.885 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.6506929397583008
Epoch: 9, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.810 Vali Acc: 0.875 Test Loss: 0.810 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.5564486980438232
Epoch: 10, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.740 Vali Acc: 0.925 Test Loss: 0.740 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.6844358444213867
Epoch: 11, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.688 Vali Acc: 0.950 Test Loss: 0.688 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.532900333404541
Epoch: 12, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.645 Vali Acc: 0.950 Test Loss: 0.645 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.6003584861755371
Epoch: 13, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.613 Vali Acc: 0.925 Test Loss: 0.613 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6297569274902344
Epoch: 14, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.571 Vali Acc: 0.925 Test Loss: 0.571 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5860764980316162
Epoch: 15, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6379060745239258
Epoch: 16, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.6308078765869141
Epoch: 17, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.6463725566864014
Epoch: 18, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.6231045722961426
Epoch: 19, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.6456992626190186
Epoch: 20, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.359 Vali Acc: 0.975 Test Loss: 0.359 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.6543245315551758
Epoch: 21, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6476104259490967
Epoch: 22, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.710498571395874
Epoch: 23, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6406350135803223
Epoch: 24, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6549038887023926
Epoch: 25, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6383025646209717
Epoch: 26, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6826326847076416
Epoch: 27, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6277956962585449
Epoch: 28, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6538324356079102
Epoch: 29, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.661536455154419
Epoch: 30, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 308180
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2763078212738037
Epoch: 1, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.406 Vali Acc: 0.250 Test Loss: 1.406 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5827236175537109
Epoch: 2, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.359 Vali Acc: 0.250 Test Loss: 1.359 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.579991340637207
Epoch: 3, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.300 Vali Acc: 0.300 Test Loss: 1.300 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.5961556434631348
Epoch: 4, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.227 Vali Acc: 0.375 Test Loss: 1.227 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.6105163097381592
Epoch: 5, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.151 Vali Acc: 0.425 Test Loss: 1.151 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 0.6442675590515137
Epoch: 6, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.424988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.5683574676513672
Epoch: 7, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.5445780754089355
Epoch: 8, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.921 Vali Acc: 0.700 Test Loss: 0.921 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 0.5799527168273926
Epoch: 9, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.844 Vali Acc: 0.850 Test Loss: 0.844 Test Acc: 0.850
Validation loss decreased (-0.699991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.5466506481170654
Epoch: 10, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.773 Vali Acc: 0.925 Test Loss: 0.773 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.5744283199310303
Epoch: 11, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.715 Vali Acc: 0.900 Test Loss: 0.715 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6431093215942383
Epoch: 12, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.669 Vali Acc: 0.900 Test Loss: 0.669 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6593656539916992
Epoch: 13, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.628 Vali Acc: 0.900 Test Loss: 0.628 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5805413722991943
Epoch: 14, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.582 Vali Acc: 0.925 Test Loss: 0.582 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.5460596084594727
Epoch: 15, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.528 Vali Acc: 0.950 Test Loss: 0.528 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.6395225524902344
Epoch: 16, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6251692771911621
Epoch: 17, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.6593992710113525
Epoch: 18, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.6254785060882568
Epoch: 19, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.617274284362793
Epoch: 20, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.359 Vali Acc: 0.975 Test Loss: 0.359 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.6169109344482422
Epoch: 21, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.354 Vali Acc: 0.975 Test Loss: 0.354 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 22 cost time: 0.6449716091156006
Epoch: 22, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.630774736404419
Epoch: 23, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6114673614501953
Epoch: 24, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6671192646026611
Epoch: 25, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6266977787017822
Epoch: 26, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6507241725921631
Epoch: 27, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6355757713317871
Epoch: 28, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6260864734649658
Epoch: 29, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6075770854949951
Epoch: 30, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6125202178955078
Epoch: 31, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 308180
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.36602520942688
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.418 Vali Acc: 0.275 Test Loss: 1.418 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5541203022003174
Epoch: 2, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.376 Vali Acc: 0.350 Test Loss: 1.376 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.5694868564605713
Epoch: 3, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.322 Vali Acc: 0.375 Test Loss: 1.322 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.5414400100708008
Epoch: 4, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.252 Vali Acc: 0.425 Test Loss: 1.252 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.6082870960235596
Epoch: 5, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.176 Vali Acc: 0.450 Test Loss: 1.176 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.5620119571685791
Epoch: 6, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.101 Vali Acc: 0.550 Test Loss: 1.101 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.585150957107544
Epoch: 7, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.021 Vali Acc: 0.725 Test Loss: 1.021 Test Acc: 0.725
Validation loss decreased (-0.549989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.5658223628997803
Epoch: 8, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.940 Vali Acc: 0.775 Test Loss: 0.940 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.5612988471984863
Epoch: 9, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.863 Vali Acc: 0.825 Test Loss: 0.863 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 10 cost time: 0.6058261394500732
Epoch: 10, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.791 Vali Acc: 0.925 Test Loss: 0.791 Test Acc: 0.925
Validation loss decreased (-0.824991 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.5889430046081543
Epoch: 11, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.735 Vali Acc: 0.950 Test Loss: 0.735 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.6032893657684326
Epoch: 12, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.687 Vali Acc: 0.950 Test Loss: 0.687 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 13 cost time: 0.6257364749908447
Epoch: 13, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.645 Vali Acc: 0.950 Test Loss: 0.645 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.5707838535308838
Epoch: 14, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.603 Vali Acc: 0.950 Test Loss: 0.603 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.6431653499603271
Epoch: 15, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.565 Vali Acc: 0.950 Test Loss: 0.565 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 16 cost time: 0.6368691921234131
Epoch: 16, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.514 Vali Acc: 0.950 Test Loss: 0.514 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.6409502029418945
Epoch: 17, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.6062359809875488
Epoch: 18, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.598801851272583
Epoch: 19, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.6505985260009766
Epoch: 20, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.5820226669311523
Epoch: 21, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.5948119163513184
Epoch: 22, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.356 Vali Acc: 0.975 Test Loss: 0.356 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.6316468715667725
Epoch: 23, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.5976259708404541
Epoch: 24, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.321 Vali Acc: 0.975 Test Loss: 0.321 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.5678524971008301
Epoch: 25, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.642786979675293
Epoch: 26, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.6256439685821533
Epoch: 27, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6286747455596924
Epoch: 28, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.284 Vali Acc: 0.975 Test Loss: 0.284 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.5518829822540283
Epoch: 29, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.6513102054595947
Epoch: 30, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.6626567840576172
Epoch: 31, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.7145628929138184
Epoch: 32, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.6213488578796387
Epoch: 33, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.5531787872314453
Epoch: 34, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.5919654369354248
Epoch: 35, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.6160874366760254
Epoch: 36, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.5875060558319092
Epoch: 37, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.6055052280426025
Epoch: 38, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.6680881977081299
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.5656764507293701
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.5889458656311035
Epoch: 41, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.6625673770904541
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.6292510032653809
Epoch: 43, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.6117935180664062
Epoch: 44, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.5597584247589111
Epoch: 45, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.6627578735351562
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.6815071105957031
Epoch: 47, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.6547431945800781
Epoch: 48, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.6681602001190186
Epoch: 49, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.6110265254974365
Epoch: 50, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 51 cost time: 0.559417724609375
Epoch: 51, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 52 cost time: 0.7116515636444092
Epoch: 52, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 53 cost time: 0.6626484394073486
Epoch: 53, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 54 cost time: 0.576671838760376
Epoch: 54, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 55 cost time: 0.616309404373169
Epoch: 55, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 56 cost time: 0.5895707607269287
Epoch: 56, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 57 cost time: 0.627335786819458
Epoch: 57, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 58 cost time: 0.5812699794769287
Epoch: 58, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 59 cost time: 0.683429479598999
Epoch: 59, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 60 cost time: 0.6357095241546631
Epoch: 60, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 61 cost time: 0.667952299118042
Epoch: 61, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 62 cost time: 0.6195595264434814
Epoch: 62, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5865099430084229
Epoch: 63, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 64 cost time: 0.6730473041534424
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 65 cost time: 0.652911901473999
Epoch: 65, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 66 cost time: 0.6785926818847656
Epoch: 66, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 67 cost time: 0.6284134387969971
Epoch: 67, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 68 cost time: 0.6194531917572021
Epoch: 68, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 69 cost time: 0.7290859222412109
Epoch: 69, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 70 cost time: 0.553044319152832
Epoch: 70, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 71 cost time: 0.6474990844726562
Epoch: 71, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 72 cost time: 0.6137096881866455
Epoch: 72, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 73 cost time: 0.5962803363800049
Epoch: 73, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 74 cost time: 0.553335428237915
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 75 cost time: 0.5511898994445801
Epoch: 75, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 76 cost time: 0.6512598991394043
Epoch: 76, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 77 cost time: 0.5562164783477783
Epoch: 77, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 78 cost time: 0.5738153457641602
Epoch: 78, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.7068169116973877
Epoch: 79, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.6574580669403076
Epoch: 80, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 81 cost time: 0.6458859443664551
Epoch: 81, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 82 cost time: 0.6750903129577637
Epoch: 82, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6506919860839844
Epoch: 83, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.5870945453643799
Epoch: 84, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.6929717063903809
Epoch: 85, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.7659971714019775
Epoch: 86, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.6441521644592285
Epoch: 87, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.6304318904876709
Epoch: 88, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.6908731460571289
Epoch: 89, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.6382606029510498
Epoch: 90, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 91 cost time: 0.6607606410980225
Epoch: 91, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 92 cost time: 0.6363258361816406
Epoch: 92, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 93 cost time: 0.6827061176300049
Epoch: 93, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 94 cost time: 0.7349708080291748
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 95 cost time: 0.6724483966827393
Epoch: 95, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 96 cost time: 0.670708417892456
Epoch: 96, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 97 cost time: 0.6978826522827148
Epoch: 97, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 98 cost time: 0.666309118270874
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 99 cost time: 0.5976691246032715
Epoch: 99, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 100 cost time: 0.5890121459960938
Epoch: 100, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 308180
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4416894912719727
Epoch: 1, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.406 Vali Acc: 0.275 Test Loss: 1.406 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5794041156768799
Epoch: 2, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.319 Vali Acc: 0.325 Test Loss: 1.319 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.599254846572876
Epoch: 3, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.230 Vali Acc: 0.325 Test Loss: 1.230 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324988).  Saving model ...
Epoch: 4 cost time: 0.6645262241363525
Epoch: 4, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.324988 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 0.6288838386535645
Epoch: 5, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.050 Vali Acc: 0.625 Test Loss: 1.050 Test Acc: 0.625
Validation loss decreased (-0.499989 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.6363937854766846
Epoch: 6, Steps: 3 | Train Loss: 1.086 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 0.6843318939208984
Epoch: 7, Steps: 3 | Train Loss: 0.973 Vali Loss: 0.888 Vali Acc: 0.800 Test Loss: 0.888 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.7616991996765137
Epoch: 8, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.816 Vali Acc: 0.850 Test Loss: 0.816 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.7287213802337646
Epoch: 9, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 0.7075717449188232
Epoch: 10, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.683 Vali Acc: 0.925 Test Loss: 0.683 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.6960594654083252
Epoch: 11, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.630 Vali Acc: 0.900 Test Loss: 0.630 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6700129508972168
Epoch: 12, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.6681129932403564
Epoch: 13, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.556 Vali Acc: 0.925 Test Loss: 0.556 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.6085710525512695
Epoch: 14, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.7016599178314209
Epoch: 15, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.486 Vali Acc: 0.925 Test Loss: 0.486 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.6038343906402588
Epoch: 16, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.455 Vali Acc: 0.950 Test Loss: 0.455 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.6419661045074463
Epoch: 17, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.416 Vali Acc: 0.950 Test Loss: 0.416 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.6749930381774902
Epoch: 18, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.6648364067077637
Epoch: 19, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.5810108184814453
Epoch: 20, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.5674078464508057
Epoch: 21, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5523397922515869
Epoch: 22, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6127123832702637
Epoch: 23, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6134355068206787
Epoch: 24, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6606323719024658
Epoch: 25, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6293337345123291
Epoch: 26, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.691124439239502
Epoch: 27, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6010921001434326
Epoch: 28, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5907912254333496
Epoch: 29, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6717305183410645
Epoch: 30, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 177108
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.33107590675354
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.412 Vali Acc: 0.300 Test Loss: 1.412 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6113111972808838
Epoch: 2, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.332 Vali Acc: 0.300 Test Loss: 1.332 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.5395395755767822
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.249 Vali Acc: 0.375 Test Loss: 1.249 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.5911579132080078
Epoch: 4, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.161 Vali Acc: 0.525 Test Loss: 1.161 Test Acc: 0.525
Validation loss decreased (-0.374988 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.551297664642334
Epoch: 5, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.073 Vali Acc: 0.725 Test Loss: 1.073 Test Acc: 0.725
Validation loss decreased (-0.524988 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 0.6262922286987305
Epoch: 6, Steps: 3 | Train Loss: 1.052 Vali Loss: 0.992 Vali Acc: 0.825 Test Loss: 0.992 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824990).  Saving model ...
Epoch: 7 cost time: 0.6111876964569092
Epoch: 7, Steps: 3 | Train Loss: 0.971 Vali Loss: 0.910 Vali Acc: 0.850 Test Loss: 0.910 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 8 cost time: 0.6362221240997314
Epoch: 8, Steps: 3 | Train Loss: 0.810 Vali Loss: 0.837 Vali Acc: 0.850 Test Loss: 0.837 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.5670120716094971
Epoch: 9, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.767 Vali Acc: 0.875 Test Loss: 0.767 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.6201181411743164
Epoch: 10, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 0.6281731128692627
Epoch: 11, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.647 Vali Acc: 0.875 Test Loss: 0.647 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 0.6403942108154297
Epoch: 12, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.605 Vali Acc: 0.875 Test Loss: 0.605 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.6033868789672852
Epoch: 13, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.575 Vali Acc: 0.875 Test Loss: 0.575 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.5392117500305176
Epoch: 14, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.540 Vali Acc: 0.925 Test Loss: 0.540 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.6201655864715576
Epoch: 15, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5281062126159668
Epoch: 16, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.467 Vali Acc: 0.950 Test Loss: 0.467 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.5726978778839111
Epoch: 17, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.556452751159668
Epoch: 18, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.551262378692627
Epoch: 19, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.5932140350341797
Epoch: 20, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.5487489700317383
Epoch: 21, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.5608913898468018
Epoch: 22, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5149307250976562
Epoch: 23, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5524296760559082
Epoch: 24, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6116125583648682
Epoch: 25, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5190880298614502
Epoch: 26, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5891566276550293
Epoch: 27, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5812332630157471
Epoch: 28, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5630271434783936
Epoch: 29, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5825557708740234
Epoch: 30, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6065614223480225
Epoch: 31, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 177108
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3447954654693604
Epoch: 1, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.389 Vali Acc: 0.325 Test Loss: 1.389 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6622192859649658
Epoch: 2, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.7466466426849365
Epoch: 3, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.6590349674224854
Epoch: 4, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.166 Vali Acc: 0.650 Test Loss: 1.166 Test Acc: 0.650
Validation loss decreased (-0.499988 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.6312255859375
Epoch: 5, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.084 Vali Acc: 0.725 Test Loss: 1.084 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 0.6202442646026611
Epoch: 6, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.006 Vali Acc: 0.825 Test Loss: 1.006 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824990).  Saving model ...
Epoch: 7 cost time: 0.6524837017059326
Epoch: 7, Steps: 3 | Train Loss: 0.993 Vali Loss: 0.928 Vali Acc: 0.825 Test Loss: 0.928 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 8 cost time: 0.6287069320678711
Epoch: 8, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.849 Vali Acc: 0.900 Test Loss: 0.849 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 9 cost time: 0.6895656585693359
Epoch: 9, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.783 Vali Acc: 0.900 Test Loss: 0.783 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.6122767925262451
Epoch: 10, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.715 Vali Acc: 0.900 Test Loss: 0.715 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.5922443866729736
Epoch: 11, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.663 Vali Acc: 0.925 Test Loss: 0.663 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.6177928447723389
Epoch: 12, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.617 Vali Acc: 0.900 Test Loss: 0.617 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7258939743041992
Epoch: 13, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6729915142059326
Epoch: 14, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.541 Vali Acc: 0.950 Test Loss: 0.541 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.6036961078643799
Epoch: 15, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5564019680023193
Epoch: 16, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.5648808479309082
Epoch: 17, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.434 Vali Acc: 0.950 Test Loss: 0.434 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.6288011074066162
Epoch: 18, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.6087265014648438
Epoch: 19, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.6753695011138916
Epoch: 20, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.7067379951477051
Epoch: 21, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.6527292728424072
Epoch: 22, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.5959019660949707
Epoch: 23, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6054501533508301
Epoch: 24, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.543828010559082
Epoch: 25, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6997129917144775
Epoch: 26, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6344959735870361
Epoch: 27, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6458213329315186
Epoch: 28, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.665921688079834
Epoch: 29, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7152361869812012
Epoch: 30, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7900161743164062
Epoch: 31, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6215963363647461
Epoch: 32, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 177108
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.178723096847534
Epoch: 1, Steps: 3 | Train Loss: 1.501 Vali Loss: 1.410 Vali Acc: 0.300 Test Loss: 1.410 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5814249515533447
Epoch: 2, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.357 Vali Acc: 0.375 Test Loss: 1.357 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.5610260963439941
Epoch: 3, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.649803876876831
Epoch: 4, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.223 Vali Acc: 0.700 Test Loss: 1.223 Test Acc: 0.700
Validation loss decreased (-0.499987 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 0.6072914600372314
Epoch: 5, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.147 Vali Acc: 0.750 Test Loss: 1.147 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 0.6005115509033203
Epoch: 6, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.068 Vali Acc: 0.750 Test Loss: 1.068 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.5782914161682129
Epoch: 7, Steps: 3 | Train Loss: 0.933 Vali Loss: 0.992 Vali Acc: 0.800 Test Loss: 0.992 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.5716407299041748
Epoch: 8, Steps: 3 | Train Loss: 0.807 Vali Loss: 0.923 Vali Acc: 0.800 Test Loss: 0.923 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.5169901847839355
Epoch: 9, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.852 Vali Acc: 0.825 Test Loss: 0.852 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 10 cost time: 0.5661633014678955
Epoch: 10, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.784 Vali Acc: 0.850 Test Loss: 0.784 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.5483450889587402
Epoch: 11, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.729 Vali Acc: 0.875 Test Loss: 0.729 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.526148796081543
Epoch: 12, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.684 Vali Acc: 0.875 Test Loss: 0.684 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.5227756500244141
Epoch: 13, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.648 Vali Acc: 0.900 Test Loss: 0.648 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.4989757537841797
Epoch: 14, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.612 Vali Acc: 0.875 Test Loss: 0.612 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5456669330596924
Epoch: 15, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.565483570098877
Epoch: 16, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.537 Vali Acc: 0.875 Test Loss: 0.537 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5640659332275391
Epoch: 17, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.44811129570007324
Epoch: 18, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 0.5618140697479248
Epoch: 19, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.5049057006835938
Epoch: 20, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.5058627128601074
Epoch: 21, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.5143771171569824
Epoch: 22, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.5616123676300049
Epoch: 23, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5459768772125244
Epoch: 24, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5467960834503174
Epoch: 25, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.5998139381408691
Epoch: 26, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.576826810836792
Epoch: 27, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.5852618217468262
Epoch: 28, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.5201356410980225
Epoch: 29, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.6207230091094971
Epoch: 30, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.5861780643463135
Epoch: 31, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.528815507888794
Epoch: 32, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5750281810760498
Epoch: 33, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5312981605529785
Epoch: 34, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.5278332233428955
Epoch: 35, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.5255577564239502
Epoch: 36, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.587756872177124
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.5444285869598389
Epoch: 38, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.5615835189819336
Epoch: 39, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.5913095474243164
Epoch: 40, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.6425924301147461
Epoch: 41, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.5670366287231445
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.5445423126220703
Epoch: 43, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.5722272396087646
Epoch: 44, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.6297416687011719
Epoch: 45, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.5677921772003174
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.601407527923584
Epoch: 47, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.5641429424285889
Epoch: 48, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.5225646495819092
Epoch: 49, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.5781404972076416
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 51 cost time: 0.5965604782104492
Epoch: 51, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 52 cost time: 0.6209380626678467
Epoch: 52, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 53 cost time: 0.6438992023468018
Epoch: 53, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 54 cost time: 0.6884686946868896
Epoch: 54, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7350220680236816
Epoch: 55, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6811647415161133
Epoch: 56, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 0.67531418800354
Epoch: 57, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 0.6455013751983643
Epoch: 58, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 59 cost time: 0.6427731513977051
Epoch: 59, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 60 cost time: 0.5852944850921631
Epoch: 60, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 61 cost time: 0.6058425903320312
Epoch: 61, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 62 cost time: 0.6068329811096191
Epoch: 62, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 63 cost time: 0.5897774696350098
Epoch: 63, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 64 cost time: 0.6036181449890137
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 65 cost time: 0.5617501735687256
Epoch: 65, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 66 cost time: 0.5587723255157471
Epoch: 66, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 67 cost time: 0.5582072734832764
Epoch: 67, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 68 cost time: 0.6035559177398682
Epoch: 68, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 0.6094043254852295
Epoch: 69, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 70 cost time: 0.5700881481170654
Epoch: 70, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 71 cost time: 0.5469264984130859
Epoch: 71, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6422610282897949
Epoch: 72, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6169712543487549
Epoch: 73, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 74 cost time: 0.6900410652160645
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 75 cost time: 0.598055362701416
Epoch: 75, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 76 cost time: 0.629805326461792
Epoch: 76, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 77 cost time: 0.6247348785400391
Epoch: 77, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 78 cost time: 0.5945520401000977
Epoch: 78, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 79 cost time: 0.632652997970581
Epoch: 79, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 80 cost time: 0.6059730052947998
Epoch: 80, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 81 cost time: 0.6626229286193848
Epoch: 81, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 82 cost time: 0.609661340713501
Epoch: 82, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 83 cost time: 0.5897347927093506
Epoch: 83, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 84 cost time: 0.6883187294006348
Epoch: 84, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 85 cost time: 0.6514632701873779
Epoch: 85, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.6223850250244141
Epoch: 86, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 87 cost time: 0.5521163940429688
Epoch: 87, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 88 cost time: 0.668586254119873
Epoch: 88, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 89 cost time: 0.591170072555542
Epoch: 89, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 90 cost time: 0.646420955657959
Epoch: 90, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 91 cost time: 0.5413422584533691
Epoch: 91, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 92 cost time: 0.5124270915985107
Epoch: 92, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 93 cost time: 0.5744140148162842
Epoch: 93, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.553504228591919
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.5694866180419922
Epoch: 95, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.6092677116394043
Epoch: 96, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 97 cost time: 0.5466516017913818
Epoch: 97, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 98 cost time: 0.5708584785461426
Epoch: 98, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 99 cost time: 0.550849199295044
Epoch: 99, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 100 cost time: 0.5710306167602539
Epoch: 100, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 177108
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3960413932800293
Epoch: 1, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.441 Vali Acc: 0.225 Test Loss: 1.441 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5580296516418457
Epoch: 2, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.364 Vali Acc: 0.300 Test Loss: 1.364 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5936775207519531
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.279 Vali Acc: 0.275 Test Loss: 1.279 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6654417514801025
Epoch: 4, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.185 Vali Acc: 0.300 Test Loss: 1.185 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299988).  Saving model ...
Epoch: 5 cost time: 0.581507682800293
Epoch: 5, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.101 Vali Acc: 0.350 Test Loss: 1.101 Test Acc: 0.350
Validation loss decreased (-0.299988 --> -0.349989).  Saving model ...
Epoch: 6 cost time: 0.5961742401123047
Epoch: 6, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.023 Vali Acc: 0.425 Test Loss: 1.023 Test Acc: 0.425
Validation loss decreased (-0.349989 --> -0.424990).  Saving model ...
Epoch: 7 cost time: 0.6425943374633789
Epoch: 7, Steps: 3 | Train Loss: 0.984 Vali Loss: 0.944 Vali Acc: 0.575 Test Loss: 0.944 Test Acc: 0.575
Validation loss decreased (-0.424990 --> -0.574991).  Saving model ...
Epoch: 8 cost time: 0.7045094966888428
Epoch: 8, Steps: 3 | Train Loss: 0.830 Vali Loss: 0.868 Vali Acc: 0.675 Test Loss: 0.868 Test Acc: 0.675
Validation loss decreased (-0.574991 --> -0.674991).  Saving model ...
Epoch: 9 cost time: 0.6351447105407715
Epoch: 9, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.794 Vali Acc: 0.775 Test Loss: 0.794 Test Acc: 0.775
Validation loss decreased (-0.674991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 0.5804553031921387
Epoch: 10, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.728 Vali Acc: 0.850 Test Loss: 0.728 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.5866105556488037
Epoch: 11, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.671 Vali Acc: 0.900 Test Loss: 0.671 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.5822188854217529
Epoch: 12, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.618 Vali Acc: 0.900 Test Loss: 0.618 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.586345911026001
Epoch: 13, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.568 Vali Acc: 0.900 Test Loss: 0.568 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.5450191497802734
Epoch: 14, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.5686767101287842
Epoch: 15, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.6684911251068115
Epoch: 16, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 0.643704891204834
Epoch: 17, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.5801811218261719
Epoch: 18, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.5829670429229736
Epoch: 19, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.6054937839508057
Epoch: 20, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.6138322353363037
Epoch: 21, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.5705592632293701
Epoch: 22, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.5764992237091064
Epoch: 23, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6836485862731934
Epoch: 24, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5647854804992676
Epoch: 25, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6152176856994629
Epoch: 26, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6657216548919678
Epoch: 27, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6765410900115967
Epoch: 28, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6418616771697998
Epoch: 29, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5692603588104248
Epoch: 30, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5546348094940186
Epoch: 31, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5875532627105713
Epoch: 32, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 111572
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4422945976257324
Epoch: 1, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.463 Vali Acc: 0.300 Test Loss: 1.463 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.616370677947998
Epoch: 2, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.391 Vali Acc: 0.325 Test Loss: 1.391 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.597273588180542
Epoch: 3, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.309 Vali Acc: 0.350 Test Loss: 1.309 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.6213943958282471
Epoch: 4, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.214 Vali Acc: 0.375 Test Loss: 1.214 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.5850286483764648
Epoch: 5, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.127 Vali Acc: 0.450 Test Loss: 1.127 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449989).  Saving model ...
Epoch: 6 cost time: 0.6618633270263672
Epoch: 6, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.045 Vali Acc: 0.450 Test Loss: 1.045 Test Acc: 0.450
Validation loss decreased (-0.449989 --> -0.449990).  Saving model ...
Epoch: 7 cost time: 0.6049835681915283
Epoch: 7, Steps: 3 | Train Loss: 0.995 Vali Loss: 0.966 Vali Acc: 0.625 Test Loss: 0.966 Test Acc: 0.625
Validation loss decreased (-0.449990 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 0.6755914688110352
Epoch: 8, Steps: 3 | Train Loss: 0.861 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.624990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.6216065883636475
Epoch: 9, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.811 Vali Acc: 0.825 Test Loss: 0.811 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.6087214946746826
Epoch: 10, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.742 Vali Acc: 0.875 Test Loss: 0.742 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 0.5856451988220215
Epoch: 11, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.683 Vali Acc: 0.875 Test Loss: 0.683 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.5396585464477539
Epoch: 12, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.628 Vali Acc: 0.875 Test Loss: 0.628 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.6024899482727051
Epoch: 13, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.5469496250152588
Epoch: 14, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.534 Vali Acc: 0.950 Test Loss: 0.534 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.5975663661956787
Epoch: 15, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.6020667552947998
Epoch: 16, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.5185739994049072
Epoch: 17, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5404949188232422
Epoch: 18, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.395 Vali Acc: 0.975 Test Loss: 0.395 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.5809688568115234
Epoch: 19, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.6154851913452148
Epoch: 20, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.5929975509643555
Epoch: 21, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.60882568359375
Epoch: 22, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6067397594451904
Epoch: 23, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6162571907043457
Epoch: 24, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6445481777191162
Epoch: 25, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5956041812896729
Epoch: 26, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6553387641906738
Epoch: 27, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6318552494049072
Epoch: 28, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6182236671447754
Epoch: 29, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.627345085144043
Epoch: 30, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6199924945831299
Epoch: 31, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 111572
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.325153112411499
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.470 Vali Acc: 0.225 Test Loss: 1.470 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.5401923656463623
Epoch: 2, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.406 Vali Acc: 0.250 Test Loss: 1.406 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.630669355392456
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.331 Vali Acc: 0.275 Test Loss: 1.331 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.7313354015350342
Epoch: 4, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.241 Vali Acc: 0.375 Test Loss: 1.241 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.5741159915924072
Epoch: 5, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.154 Vali Acc: 0.425 Test Loss: 1.154 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 0.5834119319915771
Epoch: 6, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.071 Vali Acc: 0.575 Test Loss: 1.071 Test Acc: 0.575
Validation loss decreased (-0.424988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.6028001308441162
Epoch: 7, Steps: 3 | Train Loss: 0.982 Vali Loss: 0.989 Vali Acc: 0.675 Test Loss: 0.989 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.615868330001831
Epoch: 8, Steps: 3 | Train Loss: 0.882 Vali Loss: 0.907 Vali Acc: 0.800 Test Loss: 0.907 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.6148209571838379
Epoch: 9, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.7081353664398193
Epoch: 10, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.763 Vali Acc: 0.900 Test Loss: 0.763 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.5298173427581787
Epoch: 11, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.706 Vali Acc: 0.900 Test Loss: 0.706 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.5910975933074951
Epoch: 12, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.652 Vali Acc: 0.900 Test Loss: 0.652 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.6509103775024414
Epoch: 13, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.604 Vali Acc: 0.925 Test Loss: 0.604 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.6232397556304932
Epoch: 14, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.563 Vali Acc: 0.925 Test Loss: 0.563 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.5721096992492676
Epoch: 15, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.517 Vali Acc: 0.950 Test Loss: 0.517 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5724883079528809
Epoch: 16, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.483 Vali Acc: 0.950 Test Loss: 0.483 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.6334335803985596
Epoch: 17, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5584220886230469
Epoch: 18, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.404 Vali Acc: 0.975 Test Loss: 0.404 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.5919299125671387
Epoch: 19, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.5869462490081787
Epoch: 20, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.6070003509521484
Epoch: 21, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5699312686920166
Epoch: 22, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.7015235424041748
Epoch: 23, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.657731294631958
Epoch: 24, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6156752109527588
Epoch: 25, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6261308193206787
Epoch: 26, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6366062164306641
Epoch: 27, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6410870552062988
Epoch: 28, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6686136722564697
Epoch: 29, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6152939796447754
Epoch: 30, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.675696611404419
Epoch: 31, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7211563587188721
Epoch: 32, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.663844108581543
Epoch: 33, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 111572
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.030325174331665
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.405 Vali Acc: 0.200 Test Loss: 1.405 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5463824272155762
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.354 Vali Acc: 0.275 Test Loss: 1.354 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5363967418670654
Epoch: 3, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
Validation loss decreased (-0.274986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5633981227874756
Epoch: 4, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.217 Vali Acc: 0.550 Test Loss: 1.217 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.5970954895019531
Epoch: 5, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.141 Vali Acc: 0.650 Test Loss: 1.141 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 0.5809836387634277
Epoch: 6, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.063 Vali Acc: 0.750 Test Loss: 1.063 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.5553469657897949
Epoch: 7, Steps: 3 | Train Loss: 0.985 Vali Loss: 0.985 Vali Acc: 0.850 Test Loss: 0.985 Test Acc: 0.850
Validation loss decreased (-0.749989 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 0.610236406326294
Epoch: 8, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.909 Vali Acc: 0.850 Test Loss: 0.909 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.6283044815063477
Epoch: 9, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.835 Vali Acc: 0.900 Test Loss: 0.835 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.6434521675109863
Epoch: 10, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.768 Vali Acc: 0.900 Test Loss: 0.768 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.5965621471405029
Epoch: 11, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.710 Vali Acc: 0.900 Test Loss: 0.710 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.7027914524078369
Epoch: 12, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.656 Vali Acc: 0.900 Test Loss: 0.656 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.6394064426422119
Epoch: 13, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.605 Vali Acc: 0.925 Test Loss: 0.605 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.6210653781890869
Epoch: 14, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.563 Vali Acc: 0.950 Test Loss: 0.563 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.5976345539093018
Epoch: 15, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.521 Vali Acc: 0.975 Test Loss: 0.521 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.5973412990570068
Epoch: 16, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.491 Vali Acc: 0.975 Test Loss: 0.491 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.6318509578704834
Epoch: 17, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.458 Vali Acc: 0.975 Test Loss: 0.458 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 0.6373050212860107
Epoch: 18, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.421 Vali Acc: 0.975 Test Loss: 0.421 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.7017178535461426
Epoch: 19, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.6021270751953125
Epoch: 20, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.356 Vali Acc: 0.975 Test Loss: 0.356 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.647158145904541
Epoch: 21, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6354110240936279
Epoch: 22, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6607036590576172
Epoch: 23, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6904706954956055
Epoch: 24, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6935083866119385
Epoch: 25, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6172046661376953
Epoch: 26, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6897170543670654
Epoch: 27, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6514708995819092
Epoch: 28, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.779334545135498
Epoch: 29, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5838863849639893
Epoch: 30, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 111572
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.26460862159729
Epoch: 1, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.246 Vali Acc: 0.175 Test Loss: 1.246 Test Acc: 0.175
Validation loss decreased (inf --> -0.174988).  Saving model ...
Epoch: 2 cost time: 0.6137847900390625
Epoch: 2, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.196 Vali Acc: 0.275 Test Loss: 1.196 Test Acc: 0.275
Validation loss decreased (-0.174988 --> -0.274988).  Saving model ...
Epoch: 3 cost time: 0.5545196533203125
Epoch: 3, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.139 Vali Acc: 0.425 Test Loss: 1.139 Test Acc: 0.425
Validation loss decreased (-0.274988 --> -0.424989).  Saving model ...
Epoch: 4 cost time: 0.636805534362793
Epoch: 4, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.071 Vali Acc: 0.550 Test Loss: 1.071 Test Acc: 0.550
Validation loss decreased (-0.424989 --> -0.549989).  Saving model ...
Epoch: 5 cost time: 0.5864672660827637
Epoch: 5, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 0.6208364963531494
Epoch: 6, Steps: 3 | Train Loss: 0.975 Vali Loss: 0.942 Vali Acc: 0.700 Test Loss: 0.942 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 7 cost time: 0.5787012577056885
Epoch: 7, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.871 Vali Acc: 0.775 Test Loss: 0.871 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 0.7083268165588379
Epoch: 8, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.808 Vali Acc: 0.825 Test Loss: 0.808 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.549126386642456
Epoch: 9, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.748 Vali Acc: 0.875 Test Loss: 0.748 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 10 cost time: 0.5529978275299072
Epoch: 10, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.691 Vali Acc: 0.900 Test Loss: 0.691 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.6375894546508789
Epoch: 11, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.638 Vali Acc: 0.900 Test Loss: 0.638 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.5907597541809082
Epoch: 12, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.592 Vali Acc: 0.900 Test Loss: 0.592 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.6098916530609131
Epoch: 13, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.556 Vali Acc: 0.925 Test Loss: 0.556 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.5996465682983398
Epoch: 14, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.512 Vali Acc: 0.925 Test Loss: 0.512 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.5081932544708252
Epoch: 15, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.619370698928833
Epoch: 16, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5650649070739746
Epoch: 17, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.5918819904327393
Epoch: 18, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.5360345840454102
Epoch: 19, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.619206428527832
Epoch: 20, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.6155529022216797
Epoch: 21, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 0.5659666061401367
Epoch: 22, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 0.599606990814209
Epoch: 23, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 0.5752058029174805
Epoch: 24, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6276395320892334
Epoch: 25, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5287387371063232
Epoch: 26, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5517642498016357
Epoch: 27, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5564639568328857
Epoch: 28, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5402603149414062
Epoch: 29, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5927445888519287
Epoch: 30, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6063792705535889
Epoch: 31, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5745422840118408
Epoch: 32, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6141040325164795
Epoch: 33, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 78804
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5639939308166504
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.204 Vali Acc: 0.250 Test Loss: 1.204 Test Acc: 0.250
Validation loss decreased (inf --> -0.249988).  Saving model ...
Epoch: 2 cost time: 0.5999133586883545
Epoch: 2, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.155 Vali Acc: 0.275 Test Loss: 1.155 Test Acc: 0.275
Validation loss decreased (-0.249988 --> -0.274988).  Saving model ...
Epoch: 3 cost time: 0.6413266658782959
Epoch: 3, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.098 Vali Acc: 0.450 Test Loss: 1.098 Test Acc: 0.450
Validation loss decreased (-0.274988 --> -0.449989).  Saving model ...
Epoch: 4 cost time: 0.5786869525909424
Epoch: 4, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.034 Vali Acc: 0.550 Test Loss: 1.034 Test Acc: 0.550
Validation loss decreased (-0.449989 --> -0.549990).  Saving model ...
Epoch: 5 cost time: 0.6083695888519287
Epoch: 5, Steps: 3 | Train Loss: 1.026 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
Validation loss decreased (-0.549990 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 0.6089131832122803
Epoch: 6, Steps: 3 | Train Loss: 1.017 Vali Loss: 0.910 Vali Acc: 0.675 Test Loss: 0.910 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7523317337036133
Epoch: 7, Steps: 3 | Train Loss: 0.875 Vali Loss: 0.843 Vali Acc: 0.825 Test Loss: 0.843 Test Acc: 0.825
Validation loss decreased (-0.699990 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.5611135959625244
Epoch: 8, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.779 Vali Acc: 0.925 Test Loss: 0.779 Test Acc: 0.925
Validation loss decreased (-0.824992 --> -0.924992).  Saving model ...
Epoch: 9 cost time: 0.6258037090301514
Epoch: 9, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.718 Vali Acc: 0.950 Test Loss: 0.718 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 10 cost time: 0.5807311534881592
Epoch: 10, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.663 Vali Acc: 0.950 Test Loss: 0.663 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 11 cost time: 0.6251583099365234
Epoch: 11, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.604 Vali Acc: 0.950 Test Loss: 0.604 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.5922942161560059
Epoch: 12, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.554 Vali Acc: 0.950 Test Loss: 0.554 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.6685073375701904
Epoch: 13, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.512 Vali Acc: 0.950 Test Loss: 0.512 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.6305820941925049
Epoch: 14, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.470 Vali Acc: 0.950 Test Loss: 0.470 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.6223838329315186
Epoch: 15, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.436 Vali Acc: 0.975 Test Loss: 0.436 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 16 cost time: 0.5884618759155273
Epoch: 16, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.411 Vali Acc: 0.975 Test Loss: 0.411 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.6008996963500977
Epoch: 17, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6410858631134033
Epoch: 18, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6519100666046143
Epoch: 19, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6331045627593994
Epoch: 20, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6066989898681641
Epoch: 21, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6110396385192871
Epoch: 22, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6210980415344238
Epoch: 23, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5911085605621338
Epoch: 24, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5882925987243652
Epoch: 25, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6859266757965088
Epoch: 26, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 78804
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4433693885803223
Epoch: 1, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.239 Vali Acc: 0.225 Test Loss: 1.239 Test Acc: 0.225
Validation loss decreased (inf --> -0.224988).  Saving model ...
Epoch: 2 cost time: 0.6512324810028076
Epoch: 2, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.193 Vali Acc: 0.275 Test Loss: 1.193 Test Acc: 0.275
Validation loss decreased (-0.224988 --> -0.274988).  Saving model ...
Epoch: 3 cost time: 0.6967103481292725
Epoch: 3, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.274988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.709003210067749
Epoch: 4, Steps: 3 | Train Loss: 1.142 Vali Loss: 1.080 Vali Acc: 0.475 Test Loss: 1.080 Test Acc: 0.475
Validation loss decreased (-0.399989 --> -0.474989).  Saving model ...
Epoch: 5 cost time: 0.613264799118042
Epoch: 5, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.474989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.7136025428771973
Epoch: 6, Steps: 3 | Train Loss: 1.025 Vali Loss: 0.955 Vali Acc: 0.700 Test Loss: 0.955 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.7311136722564697
Epoch: 7, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.885 Vali Acc: 0.825 Test Loss: 0.885 Test Acc: 0.825
Validation loss decreased (-0.699990 --> -0.824991).  Saving model ...
Epoch: 8 cost time: 0.685004711151123
Epoch: 8, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.818 Vali Acc: 0.925 Test Loss: 0.818 Test Acc: 0.925
Validation loss decreased (-0.824991 --> -0.924992).  Saving model ...
Epoch: 9 cost time: 0.7019937038421631
Epoch: 9, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.754 Vali Acc: 0.950 Test Loss: 0.754 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949992).  Saving model ...
Epoch: 10 cost time: 0.6686170101165771
Epoch: 10, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.692 Vali Acc: 0.975 Test Loss: 0.692 Test Acc: 0.975
Validation loss decreased (-0.949992 --> -0.974993).  Saving model ...
Epoch: 11 cost time: 0.6745152473449707
Epoch: 11, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.634 Vali Acc: 0.975 Test Loss: 0.634 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 12 cost time: 0.7499063014984131
Epoch: 12, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.579 Vali Acc: 0.975 Test Loss: 0.579 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.7951478958129883
Epoch: 13, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.538 Vali Acc: 0.950 Test Loss: 0.538 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7833371162414551
Epoch: 14, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.499 Vali Acc: 0.950 Test Loss: 0.499 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7203202247619629
Epoch: 15, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.467 Vali Acc: 0.975 Test Loss: 0.467 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.6821067333221436
Epoch: 16, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.6370272636413574
Epoch: 17, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6356673240661621
Epoch: 18, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7208194732666016
Epoch: 19, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6365063190460205
Epoch: 20, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5991308689117432
Epoch: 21, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5956182479858398
Epoch: 22, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.5921967029571533
Epoch: 23, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.6213188171386719
Epoch: 24, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.603158712387085
Epoch: 25, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5764448642730713
Epoch: 26, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6469087600708008
Epoch: 27, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6258630752563477
Epoch: 28, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7104282379150391
Epoch: 29, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5955088138580322
Epoch: 30, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7115418910980225
Epoch: 31, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7073111534118652
Epoch: 32, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6244902610778809
Epoch: 33, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 78804
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5005784034729004
Epoch: 1, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.259 Vali Acc: 0.250 Test Loss: 1.259 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.6767125129699707
Epoch: 2, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.220 Vali Acc: 0.275 Test Loss: 1.220 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274988).  Saving model ...
Epoch: 3 cost time: 0.599113941192627
Epoch: 3, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.174 Vali Acc: 0.325 Test Loss: 1.174 Test Acc: 0.325
Validation loss decreased (-0.274988 --> -0.324988).  Saving model ...
Epoch: 4 cost time: 0.6219620704650879
Epoch: 4, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.324988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.6631059646606445
Epoch: 5, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.056 Vali Acc: 0.800 Test Loss: 1.056 Test Acc: 0.800
Validation loss decreased (-0.599989 --> -0.799989).  Saving model ...
Epoch: 6 cost time: 0.6176857948303223
Epoch: 6, Steps: 3 | Train Loss: 1.003 Vali Loss: 0.990 Vali Acc: 0.850 Test Loss: 0.990 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 7 cost time: 0.6622264385223389
Epoch: 7, Steps: 3 | Train Loss: 0.910 Vali Loss: 0.923 Vali Acc: 0.900 Test Loss: 0.923 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 8 cost time: 0.5690200328826904
Epoch: 8, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.859 Vali Acc: 0.975 Test Loss: 0.859 Test Acc: 0.975
Validation loss decreased (-0.899991 --> -0.974991).  Saving model ...
Epoch: 9 cost time: 0.5903794765472412
Epoch: 9, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.797 Vali Acc: 0.975 Test Loss: 0.797 Test Acc: 0.975
Validation loss decreased (-0.974991 --> -0.974992).  Saving model ...
Epoch: 10 cost time: 0.5765421390533447
Epoch: 10, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.734 Vali Acc: 0.975 Test Loss: 0.734 Test Acc: 0.975
Validation loss decreased (-0.974992 --> -0.974993).  Saving model ...
Epoch: 11 cost time: 0.6043486595153809
Epoch: 11, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.675 Vali Acc: 0.975 Test Loss: 0.675 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974993).  Saving model ...
Epoch: 12 cost time: 0.6059732437133789
Epoch: 12, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.621 Vali Acc: 0.975 Test Loss: 0.621 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.6052546501159668
Epoch: 13, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.578 Vali Acc: 0.925 Test Loss: 0.578 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6173458099365234
Epoch: 14, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5899896621704102
Epoch: 15, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.499 Vali Acc: 0.950 Test Loss: 0.499 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6674141883850098
Epoch: 16, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.470 Vali Acc: 0.950 Test Loss: 0.470 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5559930801391602
Epoch: 17, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6301393508911133
Epoch: 18, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6930813789367676
Epoch: 19, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.382 Vali Acc: 0.975 Test Loss: 0.382 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.6315555572509766
Epoch: 20, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.350 Vali Acc: 0.975 Test Loss: 0.350 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.6143577098846436
Epoch: 21, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.324 Vali Acc: 0.975 Test Loss: 0.324 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.6916873455047607
Epoch: 22, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.6526575088500977
Epoch: 23, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.6359553337097168
Epoch: 24, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.6397864818572998
Epoch: 25, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.6668031215667725
Epoch: 26, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.6407642364501953
Epoch: 27, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.6185505390167236
Epoch: 28, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.6842710971832275
Epoch: 29, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.6577496528625488
Epoch: 30, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.6758759021759033
Epoch: 31, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.6661677360534668
Epoch: 32, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.6464691162109375
Epoch: 33, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.6717424392700195
Epoch: 34, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.5522871017456055
Epoch: 35, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6533894538879395
Epoch: 36, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6677005290985107
Epoch: 37, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6221063137054443
Epoch: 38, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6169071197509766
Epoch: 39, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6270463466644287
Epoch: 40, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6467254161834717
Epoch: 41, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6636579036712646
Epoch: 42, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5903949737548828
Epoch: 43, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.6590800285339355
Epoch: 44, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.655048131942749
Epoch: 45, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.7425613403320312
Epoch: 46, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.5970954895019531
Epoch: 47, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.6775782108306885
Epoch: 48, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.6110961437225342
Epoch: 49, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.6398077011108398
Epoch: 50, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 51 cost time: 0.675276517868042
Epoch: 51, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6927261352539062
Epoch: 52, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.651787281036377
Epoch: 53, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 54 cost time: 0.6187043190002441
Epoch: 54, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 55 cost time: 0.6707181930541992
Epoch: 55, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 56 cost time: 0.6209063529968262
Epoch: 56, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 57 cost time: 0.6652429103851318
Epoch: 57, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7285237312316895
Epoch: 58, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 59 cost time: 0.7087793350219727
Epoch: 59, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 60 cost time: 0.6223399639129639
Epoch: 60, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 61 cost time: 0.7162928581237793
Epoch: 61, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 62 cost time: 0.6493992805480957
Epoch: 62, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7013676166534424
Epoch: 63, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.733726978302002
Epoch: 64, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.6638493537902832
Epoch: 65, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.6512670516967773
Epoch: 66, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.7270283699035645
Epoch: 67, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.7224578857421875
Epoch: 68, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.7041382789611816
Epoch: 69, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.6245517730712891
Epoch: 70, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 71 cost time: 0.5866823196411133
Epoch: 71, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 72 cost time: 0.600759744644165
Epoch: 72, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 73 cost time: 0.6462149620056152
Epoch: 73, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 74 cost time: 0.7065696716308594
Epoch: 74, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 75 cost time: 0.5364115238189697
Epoch: 75, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 76 cost time: 0.6564946174621582
Epoch: 76, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 77 cost time: 0.5679807662963867
Epoch: 77, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 78 cost time: 0.6041779518127441
Epoch: 78, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.6222996711730957
Epoch: 79, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.5533945560455322
Epoch: 80, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.6924076080322266
Epoch: 81, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.5970382690429688
Epoch: 82, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.6852285861968994
Epoch: 83, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.6727373600006104
Epoch: 84, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.6223373413085938
Epoch: 85, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.5660045146942139
Epoch: 86, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.7135002613067627
Epoch: 87, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.6547260284423828
Epoch: 88, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 78804
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4155008792877197
Epoch: 1, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.358 Vali Acc: 0.300 Test Loss: 1.358 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.604363203048706
Epoch: 2, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.275 Vali Acc: 0.375 Test Loss: 1.275 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.6057167053222656
Epoch: 3, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.6398370265960693
Epoch: 4, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.081 Vali Acc: 0.525 Test Loss: 1.081 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.649212121963501
Epoch: 5, Steps: 3 | Train Loss: 1.083 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.6995162963867188
Epoch: 6, Steps: 3 | Train Loss: 1.047 Vali Loss: 0.913 Vali Acc: 0.725 Test Loss: 0.913 Test Acc: 0.725
Validation loss decreased (-0.599990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 0.6514725685119629
Epoch: 7, Steps: 3 | Train Loss: 0.921 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 0.6462342739105225
Epoch: 8, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.772 Vali Acc: 0.875 Test Loss: 0.772 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874992).  Saving model ...
Epoch: 9 cost time: 0.6426117420196533
Epoch: 9, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.708 Vali Acc: 0.900 Test Loss: 0.708 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 10 cost time: 0.6011877059936523
Epoch: 10, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.649 Vali Acc: 0.900 Test Loss: 0.649 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 0.5375657081604004
Epoch: 11, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.605 Vali Acc: 0.925 Test Loss: 0.605 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 0.6510465145111084
Epoch: 12, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.565 Vali Acc: 0.925 Test Loss: 0.565 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.5684421062469482
Epoch: 13, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.6142849922180176
Epoch: 14, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.5982162952423096
Epoch: 15, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.6142990589141846
Epoch: 16, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 0.6067392826080322
Epoch: 17, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5665643215179443
Epoch: 18, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.638263463973999
Epoch: 19, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7061150074005127
Epoch: 20, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6822860240936279
Epoch: 21, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6691513061523438
Epoch: 22, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6708323955535889
Epoch: 23, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6785390377044678
Epoch: 24, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6968402862548828
Epoch: 25, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6593151092529297
Epoch: 26, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 62420
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2749433517456055
Epoch: 1, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.358 Vali Acc: 0.300 Test Loss: 1.358 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6009047031402588
Epoch: 2, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.280 Vali Acc: 0.375 Test Loss: 1.280 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.6320276260375977
Epoch: 3, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.5961809158325195
Epoch: 4, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.099 Vali Acc: 0.525 Test Loss: 1.099 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.7071735858917236
Epoch: 5, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.011 Vali Acc: 0.550 Test Loss: 1.011 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 0.5932543277740479
Epoch: 6, Steps: 3 | Train Loss: 1.051 Vali Loss: 0.928 Vali Acc: 0.775 Test Loss: 0.928 Test Acc: 0.775
Validation loss decreased (-0.549990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 0.6304545402526855
Epoch: 7, Steps: 3 | Train Loss: 0.935 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.6311342716217041
Epoch: 8, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.5259995460510254
Epoch: 9, Steps: 3 | Train Loss: 0.738 Vali Loss: 0.717 Vali Acc: 0.925 Test Loss: 0.717 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 10 cost time: 0.7024884223937988
Epoch: 10, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.657 Vali Acc: 0.925 Test Loss: 0.657 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.5963373184204102
Epoch: 11, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.607 Vali Acc: 0.925 Test Loss: 0.607 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 0.5826632976531982
Epoch: 12, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.567 Vali Acc: 0.925 Test Loss: 0.567 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.5772085189819336
Epoch: 13, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.600736141204834
Epoch: 14, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.476 Vali Acc: 0.925 Test Loss: 0.476 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.6050319671630859
Epoch: 15, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.5671741962432861
Epoch: 16, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 0.5673553943634033
Epoch: 17, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.5713787078857422
Epoch: 18, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.5957248210906982
Epoch: 19, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.5381636619567871
Epoch: 20, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5758109092712402
Epoch: 21, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.579242467880249
Epoch: 22, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6357686519622803
Epoch: 23, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6828017234802246
Epoch: 24, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5897328853607178
Epoch: 25, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6863431930541992
Epoch: 26, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6479039192199707
Epoch: 27, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5813808441162109
Epoch: 28, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6157701015472412
Epoch: 29, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 62420
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4424469470977783
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.396 Vali Acc: 0.275 Test Loss: 1.396 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6721494197845459
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.327 Vali Acc: 0.325 Test Loss: 1.327 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.6486926078796387
Epoch: 3, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.250 Vali Acc: 0.400 Test Loss: 1.250 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6310629844665527
Epoch: 4, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.6610558032989502
Epoch: 5, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.079 Vali Acc: 0.500 Test Loss: 1.079 Test Acc: 0.500
Validation loss decreased (-0.399988 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.7069587707519531
Epoch: 6, Steps: 3 | Train Loss: 1.034 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
Validation loss decreased (-0.499989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.7122845649719238
Epoch: 7, Steps: 3 | Train Loss: 0.930 Vali Loss: 0.919 Vali Acc: 0.775 Test Loss: 0.919 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 0.6904950141906738
Epoch: 8, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.841 Vali Acc: 0.850 Test Loss: 0.841 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.6689634323120117
Epoch: 9, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.771 Vali Acc: 0.900 Test Loss: 0.771 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.6313855648040771
Epoch: 10, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.709 Vali Acc: 0.900 Test Loss: 0.709 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.6629893779754639
Epoch: 11, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.652 Vali Acc: 0.950 Test Loss: 0.652 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.6041305065155029
Epoch: 12, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.602 Vali Acc: 0.950 Test Loss: 0.602 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.6554117202758789
Epoch: 13, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.555 Vali Acc: 0.925 Test Loss: 0.555 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6009042263031006
Epoch: 14, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.508 Vali Acc: 0.950 Test Loss: 0.508 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.5816078186035156
Epoch: 15, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.466 Vali Acc: 0.925 Test Loss: 0.466 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5914828777313232
Epoch: 16, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.433 Vali Acc: 0.975 Test Loss: 0.433 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.6469149589538574
Epoch: 17, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.401 Vali Acc: 0.975 Test Loss: 0.401 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.6421713829040527
Epoch: 18, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6200411319732666
Epoch: 19, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6406395435333252
Epoch: 20, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6937811374664307
Epoch: 21, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6767003536224365
Epoch: 22, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.280 Vali Acc: 0.975 Test Loss: 0.280 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.6421568393707275
Epoch: 23, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7092182636260986
Epoch: 24, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7134871482849121
Epoch: 25, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6479270458221436
Epoch: 26, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6789112091064453
Epoch: 27, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6933133602142334
Epoch: 28, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6679625511169434
Epoch: 29, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7084722518920898
Epoch: 30, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.626495361328125
Epoch: 31, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6438238620758057
Epoch: 32, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 62420
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.173764705657959
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.423 Vali Acc: 0.100 Test Loss: 1.423 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.5251262187957764
Epoch: 2, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.368 Vali Acc: 0.275 Test Loss: 1.368 Test Acc: 0.275
Validation loss decreased (-0.099986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5634429454803467
Epoch: 3, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.303 Vali Acc: 0.300 Test Loss: 1.303 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.5015203952789307
Epoch: 4, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.226 Vali Acc: 0.375 Test Loss: 1.226 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.5781776905059814
Epoch: 5, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.143 Vali Acc: 0.525 Test Loss: 1.143 Test Acc: 0.525
Validation loss decreased (-0.374988 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 0.5747439861297607
Epoch: 6, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.060 Vali Acc: 0.675 Test Loss: 1.060 Test Acc: 0.675
Validation loss decreased (-0.524989 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.49345970153808594
Epoch: 7, Steps: 3 | Train Loss: 0.980 Vali Loss: 0.980 Vali Acc: 0.850 Test Loss: 0.980 Test Acc: 0.850
Validation loss decreased (-0.674989 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 0.5467627048492432
Epoch: 8, Steps: 3 | Train Loss: 0.859 Vali Loss: 0.901 Vali Acc: 0.925 Test Loss: 0.901 Test Acc: 0.925
Validation loss decreased (-0.849990 --> -0.924991).  Saving model ...
Epoch: 9 cost time: 0.549429178237915
Epoch: 9, Steps: 3 | Train Loss: 0.766 Vali Loss: 0.827 Vali Acc: 0.925 Test Loss: 0.827 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 10 cost time: 0.61767578125
Epoch: 10, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.758 Vali Acc: 0.925 Test Loss: 0.758 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.5388612747192383
Epoch: 11, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.698 Vali Acc: 0.975 Test Loss: 0.698 Test Acc: 0.975
Validation loss decreased (-0.924992 --> -0.974993).  Saving model ...
Epoch: 12 cost time: 0.5863423347473145
Epoch: 12, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.644 Vali Acc: 0.975 Test Loss: 0.644 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.5603587627410889
Epoch: 13, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.594 Vali Acc: 0.975 Test Loss: 0.594 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.7057530879974365
Epoch: 14, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.551 Vali Acc: 0.975 Test Loss: 0.551 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 15 cost time: 0.665299654006958
Epoch: 15, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.510 Vali Acc: 0.975 Test Loss: 0.510 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.7312889099121094
Epoch: 16, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.480 Vali Acc: 0.975 Test Loss: 0.480 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.6588072776794434
Epoch: 17, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.450 Vali Acc: 0.975 Test Loss: 0.450 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.7043066024780273
Epoch: 18, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.427 Vali Acc: 0.975 Test Loss: 0.427 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.7055177688598633
Epoch: 19, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.398 Vali Acc: 0.975 Test Loss: 0.398 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.6786239147186279
Epoch: 20, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.5984702110290527
Epoch: 21, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5797333717346191
Epoch: 22, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.6545794010162354
Epoch: 23, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.5623173713684082
Epoch: 24, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.6558113098144531
Epoch: 25, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.6409664154052734
Epoch: 26, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.6491522789001465
Epoch: 27, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.6314492225646973
Epoch: 28, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.638972282409668
Epoch: 29, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.6717498302459717
Epoch: 30, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.5883903503417969
Epoch: 31, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.5627763271331787
Epoch: 32, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.5739672183990479
Epoch: 33, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.532421350479126
Epoch: 34, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.5720188617706299
Epoch: 35, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.5888121128082275
Epoch: 36, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.5247054100036621
Epoch: 37, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.6743016242980957
Epoch: 38, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.6737394332885742
Epoch: 39, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.6130719184875488
Epoch: 40, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.6509289741516113
Epoch: 41, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.6243734359741211
Epoch: 42, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.6548140048980713
Epoch: 43, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7077732086181641
Epoch: 44, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.7231583595275879
Epoch: 45, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.6895599365234375
Epoch: 46, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.6454982757568359
Epoch: 47, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.6789290904998779
Epoch: 48, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.640221118927002
Epoch: 49, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.6163289546966553
Epoch: 50, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 51 cost time: 0.6730391979217529
Epoch: 51, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 52 cost time: 0.6136071681976318
Epoch: 52, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 53 cost time: 0.6152153015136719
Epoch: 53, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 54 cost time: 0.7308499813079834
Epoch: 54, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 55 cost time: 0.6933646202087402
Epoch: 55, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 56 cost time: 0.7251644134521484
Epoch: 56, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 57 cost time: 0.7406995296478271
Epoch: 57, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 58 cost time: 0.6475963592529297
Epoch: 58, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 59 cost time: 0.6534698009490967
Epoch: 59, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6860568523406982
Epoch: 60, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6745061874389648
Epoch: 61, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 62 cost time: 0.7191338539123535
Epoch: 62, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 63 cost time: 0.649970293045044
Epoch: 63, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 64 cost time: 0.6354236602783203
Epoch: 64, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 65 cost time: 0.5559413433074951
Epoch: 65, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 66 cost time: 0.5921158790588379
Epoch: 66, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 67 cost time: 0.6192693710327148
Epoch: 67, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 68 cost time: 0.556267499923706
Epoch: 68, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 69 cost time: 0.5279316902160645
Epoch: 69, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 70 cost time: 0.5390200614929199
Epoch: 70, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 71 cost time: 0.6547544002532959
Epoch: 71, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 72 cost time: 0.6134326457977295
Epoch: 72, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.5950503349304199
Epoch: 73, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.5733470916748047
Epoch: 74, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.6138255596160889
Epoch: 75, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 76 cost time: 0.6364414691925049
Epoch: 76, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.6976971626281738
Epoch: 77, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 78 cost time: 0.6333098411560059
Epoch: 78, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.6258971691131592
Epoch: 79, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.6277153491973877
Epoch: 80, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 81 cost time: 0.6932156085968018
Epoch: 81, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 82 cost time: 0.6390869617462158
Epoch: 82, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 83 cost time: 0.6705617904663086
Epoch: 83, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.5854933261871338
Epoch: 84, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.6648168563842773
Epoch: 85, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.6276230812072754
Epoch: 86, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.6295919418334961
Epoch: 87, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.6224164962768555
Epoch: 88, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.5862646102905273
Epoch: 89, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.6365563869476318
Epoch: 90, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 91 cost time: 0.6104803085327148
Epoch: 91, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 92 cost time: 0.6443605422973633
Epoch: 92, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 93 cost time: 0.6569626331329346
Epoch: 93, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 94 cost time: 0.6338722705841064
Epoch: 94, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 95 cost time: 0.6107158660888672
Epoch: 95, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 96 cost time: 0.5526437759399414
Epoch: 96, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 97 cost time: 0.6213648319244385
Epoch: 97, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 98 cost time: 0.528327226638794
Epoch: 98, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.5664675235748291
Epoch: 99, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.6014468669891357
Epoch: 100, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 62420
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3067145347595215
Epoch: 1, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.372 Vali Acc: 0.275 Test Loss: 1.372 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5931761264801025
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.342 Vali Acc: 0.300 Test Loss: 1.342 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.6344645023345947
Epoch: 3, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.309 Vali Acc: 0.350 Test Loss: 1.309 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.5986366271972656
Epoch: 4, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.270 Vali Acc: 0.325 Test Loss: 1.270 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5824394226074219
Epoch: 5, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.232 Vali Acc: 0.350 Test Loss: 1.232 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349988).  Saving model ...
Epoch: 6 cost time: 0.6706759929656982
Epoch: 6, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.191 Vali Acc: 0.375 Test Loss: 1.191 Test Acc: 0.375
Validation loss decreased (-0.349988 --> -0.374988).  Saving model ...
Epoch: 7 cost time: 0.6029543876647949
Epoch: 7, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.147 Vali Acc: 0.450 Test Loss: 1.147 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449989).  Saving model ...
Epoch: 8 cost time: 0.5925681591033936
Epoch: 8, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.104 Vali Acc: 0.450 Test Loss: 1.104 Test Acc: 0.450
Validation loss decreased (-0.449989 --> -0.449989).  Saving model ...
Epoch: 9 cost time: 0.5273604393005371
Epoch: 9, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
Validation loss decreased (-0.449989 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 0.5169610977172852
Epoch: 10, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.024 Vali Acc: 0.550 Test Loss: 1.024 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549990).  Saving model ...
Epoch: 11 cost time: 0.595308780670166
Epoch: 11, Steps: 3 | Train Loss: 0.883 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
Validation loss decreased (-0.549990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.5793156623840332
Epoch: 12, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.939 Vali Acc: 0.625 Test Loss: 0.939 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624991).  Saving model ...
Epoch: 13 cost time: 0.580303430557251
Epoch: 13, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.894 Vali Acc: 0.650 Test Loss: 0.894 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 14 cost time: 0.5659215450286865
Epoch: 14, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.853 Vali Acc: 0.825 Test Loss: 0.853 Test Acc: 0.825
Validation loss decreased (-0.649991 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.6113429069519043
Epoch: 15, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.811 Vali Acc: 0.850 Test Loss: 0.811 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 0.662524938583374
Epoch: 16, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.779 Vali Acc: 0.875 Test Loss: 0.779 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.6295723915100098
Epoch: 17, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5804417133331299
Epoch: 18, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6311666965484619
Epoch: 19, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.700 Vali Acc: 0.850 Test Loss: 0.700 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6262414455413818
Epoch: 20, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.670 Vali Acc: 0.825 Test Loss: 0.670 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5627257823944092
Epoch: 21, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.647 Vali Acc: 0.825 Test Loss: 0.647 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.635655403137207
Epoch: 22, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.616 Vali Acc: 0.825 Test Loss: 0.616 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5522165298461914
Epoch: 23, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.591 Vali Acc: 0.875 Test Loss: 0.591 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.5148181915283203
Epoch: 24, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.572 Vali Acc: 0.925 Test Loss: 0.572 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.6206264495849609
Epoch: 25, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.552 Vali Acc: 0.925 Test Loss: 0.552 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 0.6057693958282471
Epoch: 26, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.538 Vali Acc: 0.925 Test Loss: 0.538 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.5944633483886719
Epoch: 27, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.523 Vali Acc: 0.925 Test Loss: 0.523 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.5735158920288086
Epoch: 28, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6087296009063721
Epoch: 29, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5774819850921631
Epoch: 30, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5281937122344971
Epoch: 31, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.561180591583252
Epoch: 32, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.581268310546875
Epoch: 33, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5749666690826416
Epoch: 34, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5983998775482178
Epoch: 35, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6125280857086182
Epoch: 36, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5859377384185791
Epoch: 37, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 281108
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2881646156311035
Epoch: 1, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.401 Vali Acc: 0.225 Test Loss: 1.401 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.6943833827972412
Epoch: 2, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.375 Vali Acc: 0.225 Test Loss: 1.375 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.5589795112609863
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.341 Vali Acc: 0.250 Test Loss: 1.341 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.6317028999328613
Epoch: 4, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.303 Vali Acc: 0.300 Test Loss: 1.303 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.6011009216308594
Epoch: 5, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.262 Vali Acc: 0.350 Test Loss: 1.262 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.6538879871368408
Epoch: 6, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6105709075927734
Epoch: 7, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.6850459575653076
Epoch: 8, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.134 Vali Acc: 0.450 Test Loss: 1.134 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449989).  Saving model ...
Epoch: 9 cost time: 0.6413753032684326
Epoch: 9, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.089 Vali Acc: 0.475 Test Loss: 1.089 Test Acc: 0.475
Validation loss decreased (-0.449989 --> -0.474989).  Saving model ...
Epoch: 10 cost time: 0.5835916996002197
Epoch: 10, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.047 Vali Acc: 0.500 Test Loss: 1.047 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499990).  Saving model ...
Epoch: 11 cost time: 0.6201903820037842
Epoch: 11, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.010 Vali Acc: 0.575 Test Loss: 1.010 Test Acc: 0.575
Validation loss decreased (-0.499990 --> -0.574990).  Saving model ...
Epoch: 12 cost time: 0.6416704654693604
Epoch: 12, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.5659530162811279
Epoch: 13, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.927 Vali Acc: 0.700 Test Loss: 0.927 Test Acc: 0.700
Validation loss decreased (-0.599990 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.6019976139068604
Epoch: 14, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.886 Vali Acc: 0.750 Test Loss: 0.886 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.6081080436706543
Epoch: 15, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 0.5809569358825684
Epoch: 16, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.808 Vali Acc: 0.825 Test Loss: 0.808 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.5800247192382812
Epoch: 17, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.770 Vali Acc: 0.850 Test Loss: 0.770 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 0.5365703105926514
Epoch: 18, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.738 Vali Acc: 0.800 Test Loss: 0.738 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5845184326171875
Epoch: 19, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.709 Vali Acc: 0.825 Test Loss: 0.709 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5688591003417969
Epoch: 20, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 0.6255507469177246
Epoch: 21, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 0.5650367736816406
Epoch: 22, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.6395928859710693
Epoch: 23, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.606 Vali Acc: 0.900 Test Loss: 0.606 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.6285603046417236
Epoch: 24, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6255064010620117
Epoch: 25, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5882968902587891
Epoch: 26, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.547 Vali Acc: 0.875 Test Loss: 0.547 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6126041412353516
Epoch: 27, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.5486433506011963
Epoch: 28, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6052060127258301
Epoch: 29, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5916705131530762
Epoch: 30, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6375362873077393
Epoch: 31, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6233534812927246
Epoch: 32, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5906517505645752
Epoch: 33, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.465 Vali Acc: 0.825 Test Loss: 0.465 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6142609119415283
Epoch: 34, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.453 Vali Acc: 0.825 Test Loss: 0.453 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6246628761291504
Epoch: 35, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.579160213470459
Epoch: 36, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.573096752166748
Epoch: 37, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 281108
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.256052017211914
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.406 Vali Acc: 0.250 Test Loss: 1.406 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5166540145874023
Epoch: 2, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.380 Vali Acc: 0.275 Test Loss: 1.380 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5193309783935547
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.352 Vali Acc: 0.325 Test Loss: 1.352 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.4956355094909668
Epoch: 4, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.316 Vali Acc: 0.350 Test Loss: 1.316 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.5207149982452393
Epoch: 5, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.274 Vali Acc: 0.375 Test Loss: 1.274 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5537960529327393
Epoch: 6, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.228 Vali Acc: 0.425 Test Loss: 1.228 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.6024725437164307
Epoch: 7, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.183 Vali Acc: 0.475 Test Loss: 1.183 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.5303757190704346
Epoch: 8, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.141 Vali Acc: 0.550 Test Loss: 1.141 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.48430585861206055
Epoch: 9, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.096 Vali Acc: 0.575 Test Loss: 1.096 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.48514604568481445
Epoch: 10, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.049 Vali Acc: 0.575 Test Loss: 1.049 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 11 cost time: 0.5302236080169678
Epoch: 11, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
Validation loss decreased (-0.574990 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 0.5602481365203857
Epoch: 12, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.960 Vali Acc: 0.700 Test Loss: 0.960 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.547508716583252
Epoch: 13, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.5539140701293945
Epoch: 14, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.873 Vali Acc: 0.800 Test Loss: 0.873 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 0.546973705291748
Epoch: 15, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.835 Vali Acc: 0.800 Test Loss: 0.835 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 0.6375176906585693
Epoch: 16, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.800 Vali Acc: 0.825 Test Loss: 0.800 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.6571316719055176
Epoch: 17, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.771 Vali Acc: 0.825 Test Loss: 0.771 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.6578280925750732
Epoch: 18, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.736 Vali Acc: 0.825 Test Loss: 0.736 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 19 cost time: 0.640916109085083
Epoch: 19, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.703 Vali Acc: 0.825 Test Loss: 0.703 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 0.642087459564209
Epoch: 20, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 0.559354305267334
Epoch: 21, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.647 Vali Acc: 0.900 Test Loss: 0.647 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.6415615081787109
Epoch: 22, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.620 Vali Acc: 0.900 Test Loss: 0.620 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.6649036407470703
Epoch: 23, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 0.6440796852111816
Epoch: 24, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.562 Vali Acc: 0.925 Test Loss: 0.562 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6258273124694824
Epoch: 25, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7021737098693848
Epoch: 26, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6395275592803955
Epoch: 27, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6182541847229004
Epoch: 28, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6377511024475098
Epoch: 29, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5837762355804443
Epoch: 30, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6166038513183594
Epoch: 31, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6344993114471436
Epoch: 32, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6416826248168945
Epoch: 33, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.391 Vali Acc: 0.975 Test Loss: 0.391 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.5995688438415527
Epoch: 34, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.375 Vali Acc: 0.975 Test Loss: 0.375 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.694882869720459
Epoch: 35, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.369 Vali Acc: 0.975 Test Loss: 0.369 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.6484055519104004
Epoch: 36, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.359 Vali Acc: 0.975 Test Loss: 0.359 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.6684000492095947
Epoch: 37, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.6294589042663574
Epoch: 38, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.5723989009857178
Epoch: 39, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.6338174343109131
Epoch: 40, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6127698421478271
Epoch: 41, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5686461925506592
Epoch: 42, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6535365581512451
Epoch: 43, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6561226844787598
Epoch: 44, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5883915424346924
Epoch: 45, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5692660808563232
Epoch: 46, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6191473007202148
Epoch: 47, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6365430355072021
Epoch: 48, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6734356880187988
Epoch: 49, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.6514217853546143
Epoch: 50, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 51 cost time: 0.6128790378570557
Epoch: 51, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 52 cost time: 0.6613600254058838
Epoch: 52, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 53 cost time: 0.6405925750732422
Epoch: 53, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.268 Vali Acc: 1.000 Test Loss: 0.268 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 281108
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.291842460632324
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.402 Vali Acc: 0.250 Test Loss: 1.402 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5683407783508301
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.378 Vali Acc: 0.275 Test Loss: 1.378 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5792949199676514
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.351 Vali Acc: 0.300 Test Loss: 1.351 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5807576179504395
Epoch: 4, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.6146066188812256
Epoch: 5, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.274 Vali Acc: 0.475 Test Loss: 1.274 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.6190707683563232
Epoch: 6, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.224 Vali Acc: 0.575 Test Loss: 1.224 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.6401422023773193
Epoch: 7, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 0.6129717826843262
Epoch: 8, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.121 Vali Acc: 0.650 Test Loss: 1.121 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.6142902374267578
Epoch: 9, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.072 Vali Acc: 0.700 Test Loss: 1.072 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.6184430122375488
Epoch: 10, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.022 Vali Acc: 0.900 Test Loss: 1.022 Test Acc: 0.900
Validation loss decreased (-0.699989 --> -0.899990).  Saving model ...
Epoch: 11 cost time: 0.6152544021606445
Epoch: 11, Steps: 3 | Train Loss: 0.841 Vali Loss: 0.962 Vali Acc: 0.925 Test Loss: 0.962 Test Acc: 0.925
Validation loss decreased (-0.899990 --> -0.924990).  Saving model ...
Epoch: 12 cost time: 0.5301387310028076
Epoch: 12, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.918 Vali Acc: 0.925 Test Loss: 0.918 Test Acc: 0.925
Validation loss decreased (-0.924990 --> -0.924991).  Saving model ...
Epoch: 13 cost time: 0.5695908069610596
Epoch: 13, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.862 Vali Acc: 0.925 Test Loss: 0.862 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924991).  Saving model ...
Epoch: 14 cost time: 0.5173306465148926
Epoch: 14, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.810 Vali Acc: 0.925 Test Loss: 0.810 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 15 cost time: 0.567192554473877
Epoch: 15, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.762 Vali Acc: 0.925 Test Loss: 0.762 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 16 cost time: 0.6516401767730713
Epoch: 16, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.723 Vali Acc: 0.900 Test Loss: 0.723 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6237008571624756
Epoch: 17, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.678 Vali Acc: 0.900 Test Loss: 0.678 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5532763004302979
Epoch: 18, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.628 Vali Acc: 0.950 Test Loss: 0.628 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949994).  Saving model ...
Epoch: 19 cost time: 0.5332670211791992
Epoch: 19, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6443424224853516
Epoch: 20, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.546 Vali Acc: 0.925 Test Loss: 0.546 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.70670485496521
Epoch: 21, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.513 Vali Acc: 0.950 Test Loss: 0.513 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 22 cost time: 0.5961930751800537
Epoch: 22, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.482 Vali Acc: 0.950 Test Loss: 0.482 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 23 cost time: 0.6643917560577393
Epoch: 23, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.453 Vali Acc: 0.950 Test Loss: 0.453 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.6698410511016846
Epoch: 24, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.432 Vali Acc: 0.950 Test Loss: 0.432 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.6209146976470947
Epoch: 25, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.6824169158935547
Epoch: 26, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.6680624485015869
Epoch: 27, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.6979358196258545
Epoch: 28, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.330 Vali Acc: 1.000 Test Loss: 0.330 Test Acc: 1.000
Validation loss decreased (-0.949996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 281108
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4379682540893555
Epoch: 1, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.499 Vali Acc: 0.200 Test Loss: 1.499 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6507923603057861
Epoch: 2, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.451 Vali Acc: 0.175 Test Loss: 1.451 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6084933280944824
Epoch: 3, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.408 Vali Acc: 0.200 Test Loss: 1.408 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.5309290885925293
Epoch: 4, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.357 Vali Acc: 0.250 Test Loss: 1.357 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.5450634956359863
Epoch: 5, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.306 Vali Acc: 0.250 Test Loss: 1.306 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.4838719367980957
Epoch: 6, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.249 Vali Acc: 0.275 Test Loss: 1.249 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274988).  Saving model ...
Epoch: 7 cost time: 0.6016933917999268
Epoch: 7, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.200 Vali Acc: 0.325 Test Loss: 1.200 Test Acc: 0.325
Validation loss decreased (-0.274988 --> -0.324988).  Saving model ...
Epoch: 8 cost time: 0.5647447109222412
Epoch: 8, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.154 Vali Acc: 0.550 Test Loss: 1.154 Test Acc: 0.550
Validation loss decreased (-0.324988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.5252339839935303
Epoch: 9, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.5463128089904785
Epoch: 10, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.065 Vali Acc: 0.650 Test Loss: 1.065 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.54522705078125
Epoch: 11, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.018 Vali Acc: 0.725 Test Loss: 1.018 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.5348861217498779
Epoch: 12, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.972 Vali Acc: 0.750 Test Loss: 0.972 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.5643527507781982
Epoch: 13, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.922 Vali Acc: 0.775 Test Loss: 0.922 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.554659366607666
Epoch: 14, Steps: 3 | Train Loss: 0.765 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 0.6129698753356934
Epoch: 15, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.841 Vali Acc: 0.825 Test Loss: 0.841 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.5842008590698242
Epoch: 16, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.804 Vali Acc: 0.825 Test Loss: 0.804 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.6029436588287354
Epoch: 17, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.770 Vali Acc: 0.825 Test Loss: 0.770 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.6236560344696045
Epoch: 18, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.739 Vali Acc: 0.850 Test Loss: 0.739 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.5854654312133789
Epoch: 19, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.5476715564727783
Epoch: 20, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.698 Vali Acc: 0.825 Test Loss: 0.698 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6118133068084717
Epoch: 21, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.679 Vali Acc: 0.800 Test Loss: 0.679 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5919983386993408
Epoch: 22, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6506555080413818
Epoch: 23, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.628516674041748
Epoch: 24, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6206614971160889
Epoch: 25, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6679258346557617
Epoch: 26, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 0.64223313331604
Epoch: 27, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.6035165786743164
Epoch: 28, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.6495585441589355
Epoch: 29, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.635242223739624
Epoch: 30, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.6368253231048584
Epoch: 31, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 0.6638648509979248
Epoch: 32, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 0.6042733192443848
Epoch: 33, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6525087356567383
Epoch: 34, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 35 cost time: 0.6286444664001465
Epoch: 35, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 36 cost time: 0.6907856464385986
Epoch: 36, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 0.5675044059753418
Epoch: 37, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 0.6412186622619629
Epoch: 38, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.566359281539917
Epoch: 39, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 40 cost time: 0.6762568950653076
Epoch: 40, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 41 cost time: 0.5367903709411621
Epoch: 41, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 42 cost time: 0.62349534034729
Epoch: 42, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 0.6334571838378906
Epoch: 43, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5966958999633789
Epoch: 44, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 0.6104199886322021
Epoch: 45, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 46 cost time: 0.5904409885406494
Epoch: 46, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5939760208129883
Epoch: 47, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 0.5335767269134521
Epoch: 48, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 0.6224770545959473
Epoch: 49, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6809213161468506
Epoch: 50, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5852255821228027
Epoch: 51, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6013717651367188
Epoch: 52, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.6493275165557861
Epoch: 53, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 0.642258882522583
Epoch: 54, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 0.650662899017334
Epoch: 55, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 0.5931265354156494
Epoch: 56, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 57 cost time: 0.6188631057739258
Epoch: 57, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 58 cost time: 0.6096553802490234
Epoch: 58, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 59 cost time: 0.6471953392028809
Epoch: 59, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 60 cost time: 0.581587553024292
Epoch: 60, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6496648788452148
Epoch: 61, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5892519950866699
Epoch: 62, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.6355736255645752
Epoch: 63, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.5322349071502686
Epoch: 64, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.6228022575378418
Epoch: 65, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.6022171974182129
Epoch: 66, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.5869977474212646
Epoch: 67, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.600116491317749
Epoch: 68, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.6166338920593262
Epoch: 69, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 150036
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2272250652313232
Epoch: 1, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.453 Vali Acc: 0.250 Test Loss: 1.453 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.5261416435241699
Epoch: 2, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.411 Vali Acc: 0.275 Test Loss: 1.411 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5190944671630859
Epoch: 3, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.374 Vali Acc: 0.250 Test Loss: 1.374 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6356201171875
Epoch: 4, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.326 Vali Acc: 0.325 Test Loss: 1.326 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.6394960880279541
Epoch: 5, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.277 Vali Acc: 0.325 Test Loss: 1.277 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.61012864112854
Epoch: 6, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.227 Vali Acc: 0.425 Test Loss: 1.227 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.5891146659851074
Epoch: 7, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.177 Vali Acc: 0.450 Test Loss: 1.177 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.587928295135498
Epoch: 8, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.133 Vali Acc: 0.550 Test Loss: 1.133 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.6804046630859375
Epoch: 9, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.5809364318847656
Epoch: 10, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.045 Vali Acc: 0.675 Test Loss: 1.045 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.5516214370727539
Epoch: 11, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.5641493797302246
Epoch: 12, Steps: 3 | Train Loss: 0.918 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.5859174728393555
Epoch: 13, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.5780172348022461
Epoch: 14, Steps: 3 | Train Loss: 0.760 Vali Loss: 0.864 Vali Acc: 0.850 Test Loss: 0.864 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849991).  Saving model ...
Epoch: 15 cost time: 0.638272762298584
Epoch: 15, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.829 Vali Acc: 0.850 Test Loss: 0.829 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 0.5555918216705322
Epoch: 16, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.796 Vali Acc: 0.850 Test Loss: 0.796 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.6404263973236084
Epoch: 17, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 0.5819685459136963
Epoch: 18, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.5894303321838379
Epoch: 19, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.6184482574462891
Epoch: 20, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 0.5791835784912109
Epoch: 21, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 0.6468348503112793
Epoch: 22, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.645 Vali Acc: 0.825 Test Loss: 0.645 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5707614421844482
Epoch: 23, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.629 Vali Acc: 0.825 Test Loss: 0.629 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5454516410827637
Epoch: 24, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6389424800872803
Epoch: 25, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5446138381958008
Epoch: 26, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.652735710144043
Epoch: 27, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 0.566680908203125
Epoch: 28, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.5459518432617188
Epoch: 29, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.5228028297424316
Epoch: 30, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 31 cost time: 0.5428776741027832
Epoch: 31, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 32 cost time: 0.545691967010498
Epoch: 32, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 0.5779681205749512
Epoch: 33, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 34 cost time: 0.5237152576446533
Epoch: 34, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5954861640930176
Epoch: 35, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5623869895935059
Epoch: 36, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5739290714263916
Epoch: 37, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5933592319488525
Epoch: 38, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5788836479187012
Epoch: 39, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 40 cost time: 0.7277026176452637
Epoch: 40, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6395893096923828
Epoch: 41, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 42 cost time: 0.7409868240356445
Epoch: 42, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 0.6630051136016846
Epoch: 43, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 0.6078402996063232
Epoch: 44, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 0.6907868385314941
Epoch: 45, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 0.6232268810272217
Epoch: 46, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.539050817489624
Epoch: 47, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6406426429748535
Epoch: 48, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6104738712310791
Epoch: 49, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6256732940673828
Epoch: 50, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.595954418182373
Epoch: 51, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6246812343597412
Epoch: 52, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.711989164352417
Epoch: 53, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 0.5663707256317139
Epoch: 54, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 0.654658317565918
Epoch: 55, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 0.6485903263092041
Epoch: 56, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 0.5850777626037598
Epoch: 57, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 0.5775330066680908
Epoch: 58, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 59 cost time: 0.5770950317382812
Epoch: 59, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6126465797424316
Epoch: 60, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.59806227684021
Epoch: 61, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5974690914154053
Epoch: 62, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.6273109912872314
Epoch: 63, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.5682685375213623
Epoch: 64, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 0.5614147186279297
Epoch: 65, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 66 cost time: 0.6132063865661621
Epoch: 66, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6035571098327637
Epoch: 67, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6088442802429199
Epoch: 68, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.6062395572662354
Epoch: 69, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.5820698738098145
Epoch: 70, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6086733341217041
Epoch: 71, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.5381090641021729
Epoch: 72, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5731377601623535
Epoch: 73, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.614814043045044
Epoch: 74, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.6226596832275391
Epoch: 75, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 150036
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.216996192932129
Epoch: 1, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.466 Vali Acc: 0.225 Test Loss: 1.466 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.6274926662445068
Epoch: 2, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.432 Vali Acc: 0.200 Test Loss: 1.432 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5458455085754395
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.400 Vali Acc: 0.250 Test Loss: 1.400 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.5626380443572998
Epoch: 4, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.357 Vali Acc: 0.250 Test Loss: 1.357 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.5987427234649658
Epoch: 5, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.312 Vali Acc: 0.325 Test Loss: 1.312 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.5389320850372314
Epoch: 6, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.543245792388916
Epoch: 7, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.5228593349456787
Epoch: 8, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.168 Vali Acc: 0.550 Test Loss: 1.168 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.5570027828216553
Epoch: 9, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.126 Vali Acc: 0.600 Test Loss: 1.126 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.6071858406066895
Epoch: 10, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.5362260341644287
Epoch: 11, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.030 Vali Acc: 0.675 Test Loss: 1.030 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.5071520805358887
Epoch: 12, Steps: 3 | Train Loss: 0.904 Vali Loss: 0.982 Vali Acc: 0.700 Test Loss: 0.982 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.521294355392456
Epoch: 13, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.935 Vali Acc: 0.725 Test Loss: 0.935 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.5663530826568604
Epoch: 14, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 0.5621898174285889
Epoch: 15, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.852 Vali Acc: 0.825 Test Loss: 0.852 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 16 cost time: 0.5250682830810547
Epoch: 16, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.815 Vali Acc: 0.825 Test Loss: 0.815 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.5554635524749756
Epoch: 17, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 0.6313657760620117
Epoch: 18, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.5806906223297119
Epoch: 19, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.711 Vali Acc: 0.900 Test Loss: 0.711 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.5172522068023682
Epoch: 20, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.687 Vali Acc: 0.900 Test Loss: 0.687 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.5820643901824951
Epoch: 21, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.665 Vali Acc: 0.925 Test Loss: 0.665 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 22 cost time: 0.5744271278381348
Epoch: 22, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.644 Vali Acc: 0.900 Test Loss: 0.644 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.542625904083252
Epoch: 23, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.621 Vali Acc: 0.900 Test Loss: 0.621 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5397450923919678
Epoch: 24, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6216135025024414
Epoch: 25, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.575 Vali Acc: 0.950 Test Loss: 0.575 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 0.5183043479919434
Epoch: 26, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.552 Vali Acc: 0.950 Test Loss: 0.552 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 27 cost time: 0.501220703125
Epoch: 27, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.523 Vali Acc: 0.975 Test Loss: 0.523 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 28 cost time: 0.5292818546295166
Epoch: 28, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.499 Vali Acc: 0.975 Test Loss: 0.499 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 29 cost time: 0.5356488227844238
Epoch: 29, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.477 Vali Acc: 0.975 Test Loss: 0.477 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 30 cost time: 0.524878978729248
Epoch: 30, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.464 Vali Acc: 0.975 Test Loss: 0.464 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 31 cost time: 0.5418167114257812
Epoch: 31, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.451 Vali Acc: 0.975 Test Loss: 0.451 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 32 cost time: 0.5764808654785156
Epoch: 32, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.437 Vali Acc: 0.975 Test Loss: 0.437 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.5204241275787354
Epoch: 33, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.428 Vali Acc: 0.975 Test Loss: 0.428 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.47217464447021484
Epoch: 34, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.420 Vali Acc: 0.975 Test Loss: 0.420 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.44417381286621094
Epoch: 35, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.412 Vali Acc: 0.975 Test Loss: 0.412 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.5666353702545166
Epoch: 36, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.409 Vali Acc: 0.975 Test Loss: 0.409 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.5294461250305176
Epoch: 37, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5378601551055908
Epoch: 38, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5743808746337891
Epoch: 39, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5702362060546875
Epoch: 40, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6286942958831787
Epoch: 41, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5957462787628174
Epoch: 42, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6059238910675049
Epoch: 43, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.61053466796875
Epoch: 44, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5948400497436523
Epoch: 45, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7083804607391357
Epoch: 46, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 150036
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3477725982666016
Epoch: 1, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.387 Vali Acc: 0.400 Test Loss: 1.387 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.6184525489807129
Epoch: 2, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.355 Vali Acc: 0.425 Test Loss: 1.355 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5585207939147949
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.328 Vali Acc: 0.425 Test Loss: 1.328 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.6071436405181885
Epoch: 4, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.288 Vali Acc: 0.475 Test Loss: 1.288 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.6538524627685547
Epoch: 5, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.245 Vali Acc: 0.550 Test Loss: 1.245 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.5712652206420898
Epoch: 6, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.199 Vali Acc: 0.625 Test Loss: 1.199 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.580350399017334
Epoch: 7, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.150 Vali Acc: 0.675 Test Loss: 1.150 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.6699926853179932
Epoch: 8, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.099 Vali Acc: 0.700 Test Loss: 1.099 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 0.5999977588653564
Epoch: 9, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.051 Vali Acc: 0.775 Test Loss: 1.051 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774989).  Saving model ...
Epoch: 10 cost time: 0.5632810592651367
Epoch: 10, Steps: 3 | Train Loss: 0.912 Vali Loss: 0.999 Vali Acc: 0.775 Test Loss: 0.999 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 11 cost time: 0.5358622074127197
Epoch: 11, Steps: 3 | Train Loss: 0.902 Vali Loss: 0.948 Vali Acc: 0.850 Test Loss: 0.948 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.6460428237915039
Epoch: 12, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.896 Vali Acc: 0.900 Test Loss: 0.896 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899991).  Saving model ...
Epoch: 13 cost time: 0.6483273506164551
Epoch: 13, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.853 Vali Acc: 0.900 Test Loss: 0.853 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.655827522277832
Epoch: 14, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.813 Vali Acc: 0.875 Test Loss: 0.813 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6253049373626709
Epoch: 15, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.765 Vali Acc: 0.900 Test Loss: 0.765 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.6466524600982666
Epoch: 16, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.721 Vali Acc: 0.900 Test Loss: 0.721 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.7579874992370605
Epoch: 17, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.680 Vali Acc: 0.900 Test Loss: 0.680 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.5907769203186035
Epoch: 18, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.638 Vali Acc: 0.900 Test Loss: 0.638 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.5818660259246826
Epoch: 19, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.598 Vali Acc: 0.925 Test Loss: 0.598 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.5982792377471924
Epoch: 20, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.566 Vali Acc: 0.925 Test Loss: 0.566 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.6690435409545898
Epoch: 21, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.535 Vali Acc: 0.925 Test Loss: 0.535 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 0.6351749897003174
Epoch: 22, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.508 Vali Acc: 0.925 Test Loss: 0.508 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.6552486419677734
Epoch: 23, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.484 Vali Acc: 0.950 Test Loss: 0.484 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.615818977355957
Epoch: 24, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.6740798950195312
Epoch: 25, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.436 Vali Acc: 0.950 Test Loss: 0.436 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.6463096141815186
Epoch: 26, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.6592438220977783
Epoch: 27, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.6797380447387695
Epoch: 28, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.6341943740844727
Epoch: 29, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.355 Vali Acc: 0.975 Test Loss: 0.355 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.6601476669311523
Epoch: 30, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.337 Vali Acc: 0.975 Test Loss: 0.337 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.5291094779968262
Epoch: 31, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.6659460067749023
Epoch: 32, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.300 Vali Acc: 0.975 Test Loss: 0.300 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.6405155658721924
Epoch: 33, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.284 Vali Acc: 0.975 Test Loss: 0.284 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.673999547958374
Epoch: 34, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.7132411003112793
Epoch: 35, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.7731449604034424
Epoch: 36, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.6135802268981934
Epoch: 37, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.5728147029876709
Epoch: 38, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.6834847927093506
Epoch: 39, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.6917343139648438
Epoch: 40, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.6236741542816162
Epoch: 41, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.6942367553710938
Epoch: 42, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6843585968017578
Epoch: 43, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.6338560581207275
Epoch: 44, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.6600418090820312
Epoch: 45, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.6045784950256348
Epoch: 46, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.659635066986084
Epoch: 47, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.7333383560180664
Epoch: 48, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6184251308441162
Epoch: 49, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6569254398345947
Epoch: 50, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6162283420562744
Epoch: 51, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.925 Test Loss: 0.214 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6149516105651855
Epoch: 52, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6856591701507568
Epoch: 53, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.8046646118164062
Epoch: 54, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.703761100769043
Epoch: 55, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.740283727645874
Epoch: 56, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.7563261985778809
Epoch: 57, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.925 Test Loss: 0.199 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 150036
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.021585702896118
Epoch: 1, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.507 Vali Acc: 0.350 Test Loss: 1.507 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 0.6628119945526123
Epoch: 2, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.462 Vali Acc: 0.350 Test Loss: 1.462 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 3 cost time: 0.6405782699584961
Epoch: 3, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.423 Vali Acc: 0.400 Test Loss: 1.423 Test Acc: 0.400
Validation loss decreased (-0.349985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.6777021884918213
Epoch: 4, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.370 Vali Acc: 0.425 Test Loss: 1.370 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.5783932209014893
Epoch: 5, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.320 Vali Acc: 0.475 Test Loss: 1.320 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.5662736892700195
Epoch: 6, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.266 Vali Acc: 0.525 Test Loss: 1.266 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.6498899459838867
Epoch: 7, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.220 Vali Acc: 0.525 Test Loss: 1.220 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.5881087779998779
Epoch: 8, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.172 Vali Acc: 0.575 Test Loss: 1.172 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.7267377376556396
Epoch: 9, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.126 Vali Acc: 0.575 Test Loss: 1.126 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.5822362899780273
Epoch: 10, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.088 Vali Acc: 0.575 Test Loss: 1.088 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.6172728538513184
Epoch: 11, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.042 Vali Acc: 0.575 Test Loss: 1.042 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 12 cost time: 0.6358153820037842
Epoch: 12, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.999 Vali Acc: 0.600 Test Loss: 0.999 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.6400437355041504
Epoch: 13, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.6227476596832275
Epoch: 14, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.916 Vali Acc: 0.600 Test Loss: 0.916 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599991).  Saving model ...
Epoch: 15 cost time: 0.592942476272583
Epoch: 15, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.879 Vali Acc: 0.600 Test Loss: 0.879 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 16 cost time: 0.6176671981811523
Epoch: 16, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.851 Vali Acc: 0.625 Test Loss: 0.851 Test Acc: 0.625
Validation loss decreased (-0.599991 --> -0.624991).  Saving model ...
Epoch: 17 cost time: 0.6854543685913086
Epoch: 17, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.818 Vali Acc: 0.700 Test Loss: 0.818 Test Acc: 0.700
Validation loss decreased (-0.624991 --> -0.699992).  Saving model ...
Epoch: 18 cost time: 0.6849019527435303
Epoch: 18, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.789 Vali Acc: 0.775 Test Loss: 0.789 Test Acc: 0.775
Validation loss decreased (-0.699992 --> -0.774992).  Saving model ...
Epoch: 19 cost time: 0.7227575778961182
Epoch: 19, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.756 Vali Acc: 0.825 Test Loss: 0.756 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 0.6155011653900146
Epoch: 20, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.725 Vali Acc: 0.825 Test Loss: 0.725 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 0.6942503452301025
Epoch: 21, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.701 Vali Acc: 0.825 Test Loss: 0.701 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 22 cost time: 0.5637648105621338
Epoch: 22, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 0.6049990653991699
Epoch: 23, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5536196231842041
Epoch: 24, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.645 Vali Acc: 0.825 Test Loss: 0.645 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 25 cost time: 0.5016040802001953
Epoch: 25, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 0.6441943645477295
Epoch: 26, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 0.46502113342285156
Epoch: 27, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 0.5711028575897217
Epoch: 28, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 29 cost time: 0.571035623550415
Epoch: 29, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 30 cost time: 0.5651605129241943
Epoch: 30, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 0.6099753379821777
Epoch: 31, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6356501579284668
Epoch: 32, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 0.795996904373169
Epoch: 33, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 34 cost time: 0.6228859424591064
Epoch: 34, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 0.6935784816741943
Epoch: 35, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6102707386016846
Epoch: 36, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6848452091217041
Epoch: 37, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.507 Vali Acc: 0.825 Test Loss: 0.507 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6289002895355225
Epoch: 38, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 39 cost time: 0.7098946571350098
Epoch: 39, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 40 cost time: 0.6707711219787598
Epoch: 40, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 0.7284657955169678
Epoch: 41, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 42 cost time: 0.6223571300506592
Epoch: 42, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 0.7001399993896484
Epoch: 43, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6725349426269531
Epoch: 44, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 0.6699752807617188
Epoch: 45, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6280269622802734
Epoch: 46, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.694364070892334
Epoch: 47, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5629174709320068
Epoch: 48, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6699223518371582
Epoch: 49, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 50 cost time: 0.6688880920410156
Epoch: 50, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 51 cost time: 0.662604808807373
Epoch: 51, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.6761825084686279
Epoch: 52, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 53 cost time: 0.671621561050415
Epoch: 53, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 0.7081968784332275
Epoch: 54, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6786601543426514
Epoch: 55, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6146800518035889
Epoch: 56, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.677248477935791
Epoch: 57, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6629323959350586
Epoch: 58, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.6373100280761719
Epoch: 59, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.6533088684082031
Epoch: 60, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.6999707221984863
Epoch: 61, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.7030837535858154
Epoch: 62, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.6836025714874268
Epoch: 63, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 84500
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6664867401123047
Epoch: 1, Steps: 3 | Train Loss: 1.544 Vali Loss: 1.520 Vali Acc: 0.325 Test Loss: 1.520 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.6299464702606201
Epoch: 2, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.478 Vali Acc: 0.325 Test Loss: 1.478 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.6755614280700684
Epoch: 3, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.442 Vali Acc: 0.350 Test Loss: 1.442 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.6712861061096191
Epoch: 4, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.391 Vali Acc: 0.325 Test Loss: 1.391 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6692831516265869
Epoch: 5, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.7023031711578369
Epoch: 6, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.6182289123535156
Epoch: 7, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.241 Vali Acc: 0.475 Test Loss: 1.241 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.6349399089813232
Epoch: 8, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.190 Vali Acc: 0.525 Test Loss: 1.190 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.7610378265380859
Epoch: 9, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.143 Vali Acc: 0.525 Test Loss: 1.143 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 0.8158183097839355
Epoch: 10, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.101 Vali Acc: 0.525 Test Loss: 1.101 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 11 cost time: 0.6692206859588623
Epoch: 11, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.058 Vali Acc: 0.550 Test Loss: 1.058 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 0.6926026344299316
Epoch: 12, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.014 Vali Acc: 0.550 Test Loss: 1.014 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 13 cost time: 0.721254825592041
Epoch: 13, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.976 Vali Acc: 0.575 Test Loss: 0.976 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 14 cost time: 0.6016261577606201
Epoch: 14, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.936 Vali Acc: 0.600 Test Loss: 0.936 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599991).  Saving model ...
Epoch: 15 cost time: 0.6572833061218262
Epoch: 15, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.895 Vali Acc: 0.600 Test Loss: 0.895 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 16 cost time: 0.6954538822174072
Epoch: 16, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.867 Vali Acc: 0.625 Test Loss: 0.867 Test Acc: 0.625
Validation loss decreased (-0.599991 --> -0.624991).  Saving model ...
Epoch: 17 cost time: 0.7176289558410645
Epoch: 17, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.839 Vali Acc: 0.700 Test Loss: 0.839 Test Acc: 0.700
Validation loss decreased (-0.624991 --> -0.699992).  Saving model ...
Epoch: 18 cost time: 0.6822011470794678
Epoch: 18, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.804 Vali Acc: 0.800 Test Loss: 0.804 Test Acc: 0.800
Validation loss decreased (-0.699992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.7134828567504883
Epoch: 19, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.6554751396179199
Epoch: 20, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 0.7023859024047852
Epoch: 21, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.715 Vali Acc: 0.800 Test Loss: 0.715 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 0.656545877456665
Epoch: 22, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 0.6831605434417725
Epoch: 23, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.678 Vali Acc: 0.800 Test Loss: 0.678 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 0.6263983249664307
Epoch: 24, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6056675910949707
Epoch: 25, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.639 Vali Acc: 0.775 Test Loss: 0.639 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6175131797790527
Epoch: 26, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 0.6025686264038086
Epoch: 27, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 0.6562764644622803
Epoch: 28, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 0.7629821300506592
Epoch: 29, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 0.6163771152496338
Epoch: 30, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6428415775299072
Epoch: 31, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.63299560546875
Epoch: 32, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7403144836425781
Epoch: 33, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6816918849945068
Epoch: 34, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7234580516815186
Epoch: 35, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7073841094970703
Epoch: 36, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6061680316925049
Epoch: 37, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5614604949951172
Epoch: 38, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6254777908325195
Epoch: 39, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 84500
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.645411491394043
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.500 Vali Acc: 0.300 Test Loss: 1.500 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.5427329540252686
Epoch: 2, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.464 Vali Acc: 0.275 Test Loss: 1.464 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5658178329467773
Epoch: 3, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.435 Vali Acc: 0.275 Test Loss: 1.435 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6339662075042725
Epoch: 4, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.392 Vali Acc: 0.325 Test Loss: 1.392 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6199264526367188
Epoch: 5, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.345 Vali Acc: 0.450 Test Loss: 1.345 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.6587123870849609
Epoch: 6, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.299 Vali Acc: 0.525 Test Loss: 1.299 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.6284258365631104
Epoch: 7, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.249 Vali Acc: 0.525 Test Loss: 1.249 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.5841970443725586
Epoch: 8, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.202 Vali Acc: 0.550 Test Loss: 1.202 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.6413590908050537
Epoch: 9, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.154 Vali Acc: 0.550 Test Loss: 1.154 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.6067941188812256
Epoch: 10, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.110 Vali Acc: 0.575 Test Loss: 1.110 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.5999891757965088
Epoch: 11, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.5629260540008545
Epoch: 12, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.6810457706451416
Epoch: 13, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.979 Vali Acc: 0.625 Test Loss: 0.979 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 0.5949304103851318
Epoch: 14, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.936 Vali Acc: 0.625 Test Loss: 0.936 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 15 cost time: 0.6389355659484863
Epoch: 15, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.894 Vali Acc: 0.675 Test Loss: 0.894 Test Acc: 0.675
Validation loss decreased (-0.624991 --> -0.674991).  Saving model ...
Epoch: 16 cost time: 0.5511236190795898
Epoch: 16, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.864 Vali Acc: 0.700 Test Loss: 0.864 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 0.6898629665374756
Epoch: 17, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.834 Vali Acc: 0.825 Test Loss: 0.834 Test Acc: 0.825
Validation loss decreased (-0.699991 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.6903536319732666
Epoch: 18, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.797 Vali Acc: 0.825 Test Loss: 0.797 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.6976335048675537
Epoch: 19, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.761 Vali Acc: 0.825 Test Loss: 0.761 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 0.5542562007904053
Epoch: 20, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 0.7345530986785889
Epoch: 21, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.703 Vali Acc: 0.825 Test Loss: 0.703 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 22 cost time: 0.6831517219543457
Epoch: 22, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.676 Vali Acc: 0.875 Test Loss: 0.676 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 0.6873388290405273
Epoch: 23, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.657 Vali Acc: 0.875 Test Loss: 0.657 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 0.7152736186981201
Epoch: 24, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.7191660404205322
Epoch: 25, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.7007496356964111
Epoch: 26, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.592 Vali Acc: 0.900 Test Loss: 0.592 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.6378281116485596
Epoch: 27, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.579 Vali Acc: 0.900 Test Loss: 0.579 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.7012348175048828
Epoch: 28, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.7112178802490234
Epoch: 29, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.667762041091919
Epoch: 30, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 31 cost time: 0.6476385593414307
Epoch: 31, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.546 Vali Acc: 0.925 Test Loss: 0.546 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 0.5727283954620361
Epoch: 32, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.538 Vali Acc: 0.925 Test Loss: 0.538 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 0.5111942291259766
Epoch: 33, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.530 Vali Acc: 0.925 Test Loss: 0.530 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.6309430599212646
Epoch: 34, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.517 Vali Acc: 0.925 Test Loss: 0.517 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.6163210868835449
Epoch: 35, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.509 Vali Acc: 0.925 Test Loss: 0.509 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.6216456890106201
Epoch: 36, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.498 Vali Acc: 0.925 Test Loss: 0.498 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.7011644840240479
Epoch: 37, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.488 Vali Acc: 0.925 Test Loss: 0.488 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 38 cost time: 0.709862232208252
Epoch: 38, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 39 cost time: 0.6249260902404785
Epoch: 39, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 40 cost time: 0.6549129486083984
Epoch: 40, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 41 cost time: 0.6050117015838623
Epoch: 41, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6804931163787842
Epoch: 42, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 43 cost time: 0.5958781242370605
Epoch: 43, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 44 cost time: 0.6570196151733398
Epoch: 44, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 0.6762664318084717
Epoch: 45, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 46 cost time: 0.6784026622772217
Epoch: 46, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 0.707585334777832
Epoch: 47, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 0.7425329685211182
Epoch: 48, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6669321060180664
Epoch: 49, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7774150371551514
Epoch: 50, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.604076623916626
Epoch: 51, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.736626386642456
Epoch: 52, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 0.5814557075500488
Epoch: 53, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 0.6565487384796143
Epoch: 54, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6637029647827148
Epoch: 55, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6399619579315186
Epoch: 56, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6688907146453857
Epoch: 57, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 58 cost time: 0.5824897289276123
Epoch: 58, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 59 cost time: 0.7556319236755371
Epoch: 59, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 60 cost time: 0.6422970294952393
Epoch: 60, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6164207458496094
Epoch: 61, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 62 cost time: 0.6513714790344238
Epoch: 62, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 63 cost time: 0.6257152557373047
Epoch: 63, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 64 cost time: 0.6112761497497559
Epoch: 64, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 65 cost time: 0.672539472579956
Epoch: 65, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 66 cost time: 0.6684119701385498
Epoch: 66, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 67 cost time: 0.638758659362793
Epoch: 67, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6667053699493408
Epoch: 68, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7112026214599609
Epoch: 69, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.7275207042694092
Epoch: 70, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6572697162628174
Epoch: 71, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6091403961181641
Epoch: 72, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.7342872619628906
Epoch: 73, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7327349185943604
Epoch: 74, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.6813864707946777
Epoch: 75, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6904213428497314
Epoch: 76, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 77 cost time: 0.6894049644470215
Epoch: 77, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 78 cost time: 0.6454787254333496
Epoch: 78, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 79 cost time: 0.6573452949523926
Epoch: 79, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 80 cost time: 0.6415877342224121
Epoch: 80, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 81 cost time: 0.7004337310791016
Epoch: 81, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.6196625232696533
Epoch: 82, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.691192626953125
Epoch: 83, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.6124029159545898
Epoch: 84, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.7665443420410156
Epoch: 85, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.6964499950408936
Epoch: 86, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.662968635559082
Epoch: 87, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 88 cost time: 0.7893238067626953
Epoch: 88, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 89 cost time: 0.6350412368774414
Epoch: 89, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 90 cost time: 0.8091330528259277
Epoch: 90, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 91 cost time: 0.6712229251861572
Epoch: 91, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 92 cost time: 0.6404688358306885
Epoch: 92, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.6710450649261475
Epoch: 93, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.7969062328338623
Epoch: 94, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.6453697681427002
Epoch: 95, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 0.6959726810455322
Epoch: 96, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 0.7041537761688232
Epoch: 97, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 98 cost time: 0.7373683452606201
Epoch: 98, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 99 cost time: 0.7498133182525635
Epoch: 99, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 100 cost time: 0.7546188831329346
Epoch: 100, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 84500
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6785500049591064
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.425 Vali Acc: 0.400 Test Loss: 1.425 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.6609394550323486
Epoch: 2, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.394 Vali Acc: 0.425 Test Loss: 1.394 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5318093299865723
Epoch: 3, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.366 Vali Acc: 0.425 Test Loss: 1.366 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.6874704360961914
Epoch: 4, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.327 Vali Acc: 0.475 Test Loss: 1.327 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.5821094512939453
Epoch: 5, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.284 Vali Acc: 0.475 Test Loss: 1.284 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.729804277420044
Epoch: 6, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.6853187084197998
Epoch: 7, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.192 Vali Acc: 0.575 Test Loss: 1.192 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.5672881603240967
Epoch: 8, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.7738618850708008
Epoch: 9, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.098 Vali Acc: 0.575 Test Loss: 1.098 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.585831880569458
Epoch: 10, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.049 Vali Acc: 0.625 Test Loss: 1.049 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.6555609703063965
Epoch: 11, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 0.6213648319244385
Epoch: 12, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.951 Vali Acc: 0.650 Test Loss: 0.951 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.6206564903259277
Epoch: 13, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.6512045860290527
Epoch: 14, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.865 Vali Acc: 0.850 Test Loss: 0.865 Test Acc: 0.850
Validation loss decreased (-0.724991 --> -0.849991).  Saving model ...
Epoch: 15 cost time: 0.6175398826599121
Epoch: 15, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.825 Vali Acc: 0.875 Test Loss: 0.825 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.5363140106201172
Epoch: 16, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.789 Vali Acc: 0.900 Test Loss: 0.789 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.6430444717407227
Epoch: 17, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.753 Vali Acc: 0.925 Test Loss: 0.753 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 18 cost time: 0.7205474376678467
Epoch: 18, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.715 Vali Acc: 0.925 Test Loss: 0.715 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.6648952960968018
Epoch: 19, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.679 Vali Acc: 0.925 Test Loss: 0.679 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.6936862468719482
Epoch: 20, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.648 Vali Acc: 0.925 Test Loss: 0.648 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.7395579814910889
Epoch: 21, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.617 Vali Acc: 0.925 Test Loss: 0.617 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.7074298858642578
Epoch: 22, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.594 Vali Acc: 0.925 Test Loss: 0.594 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.730302095413208
Epoch: 23, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.6249921321868896
Epoch: 24, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.545 Vali Acc: 0.925 Test Loss: 0.545 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.7217035293579102
Epoch: 25, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.514 Vali Acc: 0.925 Test Loss: 0.514 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.7102453708648682
Epoch: 26, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.486 Vali Acc: 0.950 Test Loss: 0.486 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.6591982841491699
Epoch: 27, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.462 Vali Acc: 0.950 Test Loss: 0.462 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.5852859020233154
Epoch: 28, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.442 Vali Acc: 0.950 Test Loss: 0.442 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.6609470844268799
Epoch: 29, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.7726240158081055
Epoch: 30, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.699460506439209
Epoch: 31, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.7116966247558594
Epoch: 32, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.7075023651123047
Epoch: 33, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.6438701152801514
Epoch: 34, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.6613240242004395
Epoch: 35, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.5964658260345459
Epoch: 36, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6995019912719727
Epoch: 37, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.6476261615753174
Epoch: 38, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.6329925060272217
Epoch: 39, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.6490979194641113
Epoch: 40, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.7311761379241943
Epoch: 41, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.7842910289764404
Epoch: 42, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.6928908824920654
Epoch: 43, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.6824808120727539
Epoch: 44, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.6895334720611572
Epoch: 45, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.6756792068481445
Epoch: 46, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.6070065498352051
Epoch: 47, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.6470732688903809
Epoch: 48, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.6837537288665771
Epoch: 49, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 0.6261963844299316
Epoch: 50, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 0.7010693550109863
Epoch: 51, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6782357692718506
Epoch: 52, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 53 cost time: 0.6839902400970459
Epoch: 53, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 54 cost time: 0.7357614040374756
Epoch: 54, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 55 cost time: 0.7208781242370605
Epoch: 55, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 56 cost time: 0.6943132877349854
Epoch: 56, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 0.5877759456634521
Epoch: 57, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 0.6785929203033447
Epoch: 58, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 59 cost time: 0.6714761257171631
Epoch: 59, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 60 cost time: 0.6742501258850098
Epoch: 60, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 61 cost time: 0.635106086730957
Epoch: 61, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 62 cost time: 0.7366232872009277
Epoch: 62, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 63 cost time: 0.7136244773864746
Epoch: 63, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 64 cost time: 0.7785968780517578
Epoch: 64, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6772005558013916
Epoch: 65, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 66 cost time: 0.7051115036010742
Epoch: 66, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 67 cost time: 0.5958547592163086
Epoch: 67, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 68 cost time: 0.6952710151672363
Epoch: 68, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 0.660675048828125
Epoch: 69, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 70 cost time: 0.658728837966919
Epoch: 70, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 71 cost time: 0.6315057277679443
Epoch: 71, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 72 cost time: 0.6960570812225342
Epoch: 72, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 73 cost time: 0.6094145774841309
Epoch: 73, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 74 cost time: 0.6814935207366943
Epoch: 74, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 75 cost time: 0.7367827892303467
Epoch: 75, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6285898685455322
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 77 cost time: 0.7046277523040771
Epoch: 77, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 78 cost time: 0.7520418167114258
Epoch: 78, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 79 cost time: 0.7406463623046875
Epoch: 79, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 80 cost time: 0.829540491104126
Epoch: 80, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 81 cost time: 0.7172553539276123
Epoch: 81, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 82 cost time: 0.693711519241333
Epoch: 82, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 83 cost time: 0.7090356349945068
Epoch: 83, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 84 cost time: 0.7134625911712646
Epoch: 84, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 85 cost time: 0.7512149810791016
Epoch: 85, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 86 cost time: 0.7662818431854248
Epoch: 86, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 87 cost time: 0.7170853614807129
Epoch: 87, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 88 cost time: 0.6495785713195801
Epoch: 88, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 89 cost time: 0.7014551162719727
Epoch: 89, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 90 cost time: 0.7135927677154541
Epoch: 90, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 91 cost time: 0.6534900665283203
Epoch: 91, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 92 cost time: 0.6423168182373047
Epoch: 92, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 93 cost time: 0.7740828990936279
Epoch: 93, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 94 cost time: 0.651355504989624
Epoch: 94, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.7505896091461182
Epoch: 95, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 96 cost time: 0.6984820365905762
Epoch: 96, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 1.000 Test Loss: 0.158 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 84500
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.492479085922241
Epoch: 1, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.414 Vali Acc: 0.225 Test Loss: 1.414 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.6615371704101562
Epoch: 2, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.373 Vali Acc: 0.325 Test Loss: 1.373 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.7996881008148193
Epoch: 3, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.7278141975402832
Epoch: 4, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.284 Vali Acc: 0.425 Test Loss: 1.284 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.7708628177642822
Epoch: 5, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.231 Vali Acc: 0.425 Test Loss: 1.231 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 0.677354097366333
Epoch: 6, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7195663452148438
Epoch: 7, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.7320089340209961
Epoch: 8, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.082 Vali Acc: 0.575 Test Loss: 1.082 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.7480807304382324
Epoch: 9, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.8194563388824463
Epoch: 10, Steps: 3 | Train Loss: 0.875 Vali Loss: 0.988 Vali Acc: 0.650 Test Loss: 0.988 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.7507941722869873
Epoch: 11, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.947 Vali Acc: 0.700 Test Loss: 0.947 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.8965387344360352
Epoch: 12, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.7699649333953857
Epoch: 13, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.714623212814331
Epoch: 14, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.845 Vali Acc: 0.800 Test Loss: 0.845 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.6600351333618164
Epoch: 15, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.815 Vali Acc: 0.850 Test Loss: 0.815 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 0.6373450756072998
Epoch: 16, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.784 Vali Acc: 0.875 Test Loss: 0.784 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.6753602027893066
Epoch: 17, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.757 Vali Acc: 0.875 Test Loss: 0.757 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.768519401550293
Epoch: 18, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.734 Vali Acc: 0.875 Test Loss: 0.734 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.6632108688354492
Epoch: 19, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.708 Vali Acc: 0.875 Test Loss: 0.708 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.7460901737213135
Epoch: 20, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.675 Vali Acc: 0.875 Test Loss: 0.675 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.680614709854126
Epoch: 21, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.649 Vali Acc: 0.900 Test Loss: 0.649 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.6661102771759033
Epoch: 22, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.624 Vali Acc: 0.900 Test Loss: 0.624 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.6458795070648193
Epoch: 23, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.599 Vali Acc: 0.900 Test Loss: 0.599 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.7218232154846191
Epoch: 24, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.578 Vali Acc: 0.925 Test Loss: 0.578 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.721017599105835
Epoch: 25, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7319808006286621
Epoch: 26, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.544 Vali Acc: 0.925 Test Loss: 0.544 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.5895211696624756
Epoch: 27, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.537 Vali Acc: 0.925 Test Loss: 0.537 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.6309218406677246
Epoch: 28, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.528 Vali Acc: 0.925 Test Loss: 0.528 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.7706990242004395
Epoch: 29, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.521 Vali Acc: 0.925 Test Loss: 0.521 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.651404619216919
Epoch: 30, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.517 Vali Acc: 0.925 Test Loss: 0.517 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.648082971572876
Epoch: 31, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.511 Vali Acc: 0.925 Test Loss: 0.511 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 0.7027013301849365
Epoch: 32, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.503 Vali Acc: 0.925 Test Loss: 0.503 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 0.6704983711242676
Epoch: 33, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.489 Vali Acc: 0.925 Test Loss: 0.489 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.6926627159118652
Epoch: 34, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.480 Vali Acc: 0.925 Test Loss: 0.480 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.6702103614807129
Epoch: 35, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.6521177291870117
Epoch: 36, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.633234977722168
Epoch: 37, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 38 cost time: 0.6856257915496826
Epoch: 38, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.6626560688018799
Epoch: 39, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6578378677368164
Epoch: 40, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.7763335704803467
Epoch: 41, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.7216641902923584
Epoch: 42, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.6770679950714111
Epoch: 43, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 0.6781134605407715
Epoch: 44, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 0.7776679992675781
Epoch: 45, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 46 cost time: 0.6787230968475342
Epoch: 46, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 0.6379091739654541
Epoch: 47, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 0.6005346775054932
Epoch: 48, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7366552352905273
Epoch: 49, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6392736434936523
Epoch: 50, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7403957843780518
Epoch: 51, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6938059329986572
Epoch: 52, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6393389701843262
Epoch: 53, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.717583417892456
Epoch: 54, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6677453517913818
Epoch: 55, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6982479095458984
Epoch: 56, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6760351657867432
Epoch: 57, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 51732
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7806804180145264
Epoch: 1, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.374 Vali Acc: 0.350 Test Loss: 1.374 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.626190185546875
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.6559910774230957
Epoch: 3, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.302 Vali Acc: 0.425 Test Loss: 1.302 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.6987450122833252
Epoch: 4, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.258 Vali Acc: 0.450 Test Loss: 1.258 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.6960489749908447
Epoch: 5, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.209 Vali Acc: 0.525 Test Loss: 1.209 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.664609432220459
Epoch: 6, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.160 Vali Acc: 0.550 Test Loss: 1.160 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.7699422836303711
Epoch: 7, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.110 Vali Acc: 0.550 Test Loss: 1.110 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.6636207103729248
Epoch: 8, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.063 Vali Acc: 0.550 Test Loss: 1.063 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.6485629081726074
Epoch: 9, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.728233814239502
Epoch: 10, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.974 Vali Acc: 0.650 Test Loss: 0.974 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.687598705291748
Epoch: 11, Steps: 3 | Train Loss: 0.866 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 0.7288088798522949
Epoch: 12, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 0.7144131660461426
Epoch: 13, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.857 Vali Acc: 0.875 Test Loss: 0.857 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.7310457229614258
Epoch: 14, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.825 Vali Acc: 0.875 Test Loss: 0.825 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.6223359107971191
Epoch: 15, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.793 Vali Acc: 0.850 Test Loss: 0.793 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8034429550170898
Epoch: 16, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.764 Vali Acc: 0.875 Test Loss: 0.764 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.7749404907226562
Epoch: 17, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.735 Vali Acc: 0.900 Test Loss: 0.735 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.6618144512176514
Epoch: 18, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.710 Vali Acc: 0.900 Test Loss: 0.710 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.7919666767120361
Epoch: 19, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.684 Vali Acc: 0.900 Test Loss: 0.684 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.7280097007751465
Epoch: 20, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.650 Vali Acc: 0.925 Test Loss: 0.650 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 21 cost time: 0.6356711387634277
Epoch: 21, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.627 Vali Acc: 0.925 Test Loss: 0.627 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.8016047477722168
Epoch: 22, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.602 Vali Acc: 0.950 Test Loss: 0.602 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.7664287090301514
Epoch: 23, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.574 Vali Acc: 0.950 Test Loss: 0.574 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 0.6474597454071045
Epoch: 24, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.546 Vali Acc: 0.950 Test Loss: 0.546 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.7642443180084229
Epoch: 25, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.523 Vali Acc: 0.950 Test Loss: 0.523 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.7664322853088379
Epoch: 26, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.509 Vali Acc: 0.950 Test Loss: 0.509 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.7258553504943848
Epoch: 27, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.497 Vali Acc: 0.950 Test Loss: 0.497 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.7897796630859375
Epoch: 28, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.491 Vali Acc: 0.950 Test Loss: 0.491 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.6945455074310303
Epoch: 29, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.487 Vali Acc: 0.950 Test Loss: 0.487 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.6200926303863525
Epoch: 30, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.475 Vali Acc: 0.950 Test Loss: 0.475 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.6794366836547852
Epoch: 31, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.470 Vali Acc: 0.950 Test Loss: 0.470 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.7156851291656494
Epoch: 32, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.464 Vali Acc: 0.950 Test Loss: 0.464 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.7202825546264648
Epoch: 33, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 34 cost time: 0.7449014186859131
Epoch: 34, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.441 Vali Acc: 0.950 Test Loss: 0.441 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.7285115718841553
Epoch: 35, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.6689574718475342
Epoch: 36, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.7431037425994873
Epoch: 37, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.7038767337799072
Epoch: 38, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.6804218292236328
Epoch: 39, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.6102745532989502
Epoch: 40, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7583682537078857
Epoch: 41, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.716494083404541
Epoch: 42, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.780123233795166
Epoch: 43, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7156975269317627
Epoch: 44, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6641871929168701
Epoch: 45, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7028980255126953
Epoch: 46, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6628029346466064
Epoch: 47, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6894509792327881
Epoch: 48, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6631779670715332
Epoch: 49, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 51732
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9282588958740234
Epoch: 1, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.346 Vali Acc: 0.375 Test Loss: 1.346 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.7491095066070557
Epoch: 2, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.83921217918396
Epoch: 3, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.283 Vali Acc: 0.475 Test Loss: 1.283 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.7962005138397217
Epoch: 4, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.243 Vali Acc: 0.550 Test Loss: 1.243 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.794203519821167
Epoch: 5, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.197 Vali Acc: 0.550 Test Loss: 1.197 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.6745269298553467
Epoch: 6, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.151 Vali Acc: 0.575 Test Loss: 1.151 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.6970996856689453
Epoch: 7, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.102 Vali Acc: 0.625 Test Loss: 1.102 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.7875456809997559
Epoch: 8, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 0.6506149768829346
Epoch: 9, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.005 Vali Acc: 0.725 Test Loss: 1.005 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 0.6887350082397461
Epoch: 10, Steps: 3 | Train Loss: 0.899 Vali Loss: 0.963 Vali Acc: 0.775 Test Loss: 0.963 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 11 cost time: 0.7171721458435059
Epoch: 11, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.921 Vali Acc: 0.825 Test Loss: 0.921 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 0.7633135318756104
Epoch: 12, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.883 Vali Acc: 0.850 Test Loss: 0.883 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.6739113330841064
Epoch: 13, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.842 Vali Acc: 0.875 Test Loss: 0.842 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 14 cost time: 0.6833076477050781
Epoch: 14, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.807 Vali Acc: 0.850 Test Loss: 0.807 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7132611274719238
Epoch: 15, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.772 Vali Acc: 0.900 Test Loss: 0.772 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.6786174774169922
Epoch: 16, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.740 Vali Acc: 0.900 Test Loss: 0.740 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.6816482543945312
Epoch: 17, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.709 Vali Acc: 0.900 Test Loss: 0.709 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.6886000633239746
Epoch: 18, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.684 Vali Acc: 0.900 Test Loss: 0.684 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.7029304504394531
Epoch: 19, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.6779859066009521
Epoch: 20, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.625 Vali Acc: 0.925 Test Loss: 0.625 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.700965166091919
Epoch: 21, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.601 Vali Acc: 0.925 Test Loss: 0.601 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.6839401721954346
Epoch: 22, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.572 Vali Acc: 0.925 Test Loss: 0.572 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.6133534908294678
Epoch: 23, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.546 Vali Acc: 0.950 Test Loss: 0.546 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.7373607158660889
Epoch: 24, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.524 Vali Acc: 0.950 Test Loss: 0.524 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.7137298583984375
Epoch: 25, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.502 Vali Acc: 0.950 Test Loss: 0.502 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.700566291809082
Epoch: 26, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.488 Vali Acc: 0.950 Test Loss: 0.488 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.6671738624572754
Epoch: 27, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.475 Vali Acc: 0.950 Test Loss: 0.475 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.7075212001800537
Epoch: 28, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6346373558044434
Epoch: 29, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7120933532714844
Epoch: 30, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6854569911956787
Epoch: 31, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.449 Vali Acc: 0.925 Test Loss: 0.449 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7145998477935791
Epoch: 32, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7040483951568604
Epoch: 33, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.429 Vali Acc: 0.925 Test Loss: 0.429 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6104745864868164
Epoch: 34, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.757089376449585
Epoch: 35, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7058217525482178
Epoch: 36, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7319533824920654
Epoch: 37, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 51732
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5493829250335693
Epoch: 1, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.356 Vali Acc: 0.450 Test Loss: 1.356 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.6704473495483398
Epoch: 2, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.328 Vali Acc: 0.450 Test Loss: 1.328 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.6500794887542725
Epoch: 3, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.300 Vali Acc: 0.475 Test Loss: 1.300 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.6607773303985596
Epoch: 4, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.264 Vali Acc: 0.525 Test Loss: 1.264 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.7217526435852051
Epoch: 5, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.223 Vali Acc: 0.525 Test Loss: 1.223 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.709810733795166
Epoch: 6, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.179 Vali Acc: 0.625 Test Loss: 1.179 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.7235958576202393
Epoch: 7, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.131 Vali Acc: 0.675 Test Loss: 1.131 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.7651288509368896
Epoch: 8, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.082 Vali Acc: 0.700 Test Loss: 1.082 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 0.688899040222168
Epoch: 9, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.033 Vali Acc: 0.775 Test Loss: 1.033 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.7344999313354492
Epoch: 10, Steps: 3 | Train Loss: 0.930 Vali Loss: 0.985 Vali Acc: 0.850 Test Loss: 0.985 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849990).  Saving model ...
Epoch: 11 cost time: 0.6472454071044922
Epoch: 11, Steps: 3 | Train Loss: 0.861 Vali Loss: 0.940 Vali Acc: 0.875 Test Loss: 0.940 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.6939032077789307
Epoch: 12, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.895 Vali Acc: 0.925 Test Loss: 0.895 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924991).  Saving model ...
Epoch: 13 cost time: 0.5750036239624023
Epoch: 13, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.853 Vali Acc: 0.925 Test Loss: 0.853 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924991).  Saving model ...
Epoch: 14 cost time: 0.6296787261962891
Epoch: 14, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.812 Vali Acc: 0.950 Test Loss: 0.812 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949992).  Saving model ...
Epoch: 15 cost time: 0.7021427154541016
Epoch: 15, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.775 Vali Acc: 0.950 Test Loss: 0.775 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 16 cost time: 0.6320745944976807
Epoch: 16, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.740 Vali Acc: 0.950 Test Loss: 0.740 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 17 cost time: 0.6338927745819092
Epoch: 17, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.706 Vali Acc: 0.950 Test Loss: 0.706 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 18 cost time: 0.6078131198883057
Epoch: 18, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.676 Vali Acc: 0.950 Test Loss: 0.676 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 19 cost time: 0.6200690269470215
Epoch: 19, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.642 Vali Acc: 0.950 Test Loss: 0.642 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 20 cost time: 0.6768326759338379
Epoch: 20, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.614 Vali Acc: 0.950 Test Loss: 0.614 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 21 cost time: 0.5786654949188232
Epoch: 21, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 22 cost time: 0.7251377105712891
Epoch: 22, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.564 Vali Acc: 0.975 Test Loss: 0.564 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 23 cost time: 0.6678729057312012
Epoch: 23, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.538 Vali Acc: 0.975 Test Loss: 0.538 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 24 cost time: 0.5634832382202148
Epoch: 24, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.512 Vali Acc: 0.975 Test Loss: 0.512 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 25 cost time: 0.6325788497924805
Epoch: 25, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.485 Vali Acc: 0.975 Test Loss: 0.485 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 0.7367994785308838
Epoch: 26, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.461 Vali Acc: 0.975 Test Loss: 0.461 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 0.6143784523010254
Epoch: 27, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.6352875232696533
Epoch: 28, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.426 Vali Acc: 0.975 Test Loss: 0.426 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.6039721965789795
Epoch: 29, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.414 Vali Acc: 0.975 Test Loss: 0.414 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.632272481918335
Epoch: 30, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.403 Vali Acc: 0.975 Test Loss: 0.403 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.6580731868743896
Epoch: 31, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.391 Vali Acc: 0.975 Test Loss: 0.391 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.578784704208374
Epoch: 32, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.379 Vali Acc: 0.975 Test Loss: 0.379 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.6540360450744629
Epoch: 33, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.365 Vali Acc: 0.975 Test Loss: 0.365 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.6059451103210449
Epoch: 34, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.6352713108062744
Epoch: 35, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.6589767932891846
Epoch: 36, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.657273530960083
Epoch: 37, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.6497724056243896
Epoch: 38, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.6637513637542725
Epoch: 39, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.772118091583252
Epoch: 40, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.5728127956390381
Epoch: 41, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.6119594573974609
Epoch: 42, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.6054584980010986
Epoch: 43, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.6226756572723389
Epoch: 44, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.7177426815032959
Epoch: 45, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.7110726833343506
Epoch: 46, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.6941931247711182
Epoch: 47, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.6867902278900146
Epoch: 48, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.645362138748169
Epoch: 49, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.7544980049133301
Epoch: 50, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 51 cost time: 0.7022738456726074
Epoch: 51, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 52 cost time: 0.7542989253997803
Epoch: 52, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8162360191345215
Epoch: 53, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 54 cost time: 0.6116693019866943
Epoch: 54, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 55 cost time: 0.7297258377075195
Epoch: 55, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 56 cost time: 0.6974027156829834
Epoch: 56, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 57 cost time: 0.7072689533233643
Epoch: 57, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 58 cost time: 0.6482622623443604
Epoch: 58, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 59 cost time: 0.6975219249725342
Epoch: 59, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 60 cost time: 0.6311559677124023
Epoch: 60, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 61 cost time: 0.7338781356811523
Epoch: 61, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 62 cost time: 0.6416842937469482
Epoch: 62, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 63 cost time: 0.752194881439209
Epoch: 63, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 64 cost time: 0.711615800857544
Epoch: 64, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 65 cost time: 0.7854433059692383
Epoch: 65, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 66 cost time: 0.7321209907531738
Epoch: 66, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 67 cost time: 0.7245519161224365
Epoch: 67, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 68 cost time: 0.7838938236236572
Epoch: 68, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 69 cost time: 0.660642147064209
Epoch: 69, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 70 cost time: 0.6516673564910889
Epoch: 70, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 71 cost time: 0.6391494274139404
Epoch: 71, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 72 cost time: 0.7448382377624512
Epoch: 72, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 73 cost time: 0.6790463924407959
Epoch: 73, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 74 cost time: 0.6855907440185547
Epoch: 74, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 75 cost time: 0.5775146484375
Epoch: 75, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 76 cost time: 0.616692066192627
Epoch: 76, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.6614482402801514
Epoch: 77, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 78 cost time: 0.794989824295044
Epoch: 78, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.6584644317626953
Epoch: 79, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.6238291263580322
Epoch: 80, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 81 cost time: 0.8502233028411865
Epoch: 81, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.7861835956573486
Epoch: 82, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 83 cost time: 0.7324512004852295
Epoch: 83, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.7693779468536377
Epoch: 84, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.7485330104827881
Epoch: 85, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.59490966796875
Epoch: 86, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.724968433380127
Epoch: 87, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.7779521942138672
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.688452959060669
Epoch: 89, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.7607412338256836
Epoch: 90, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 91 cost time: 0.6694686412811279
Epoch: 91, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.654360294342041
Epoch: 92, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 93 cost time: 0.7479202747344971
Epoch: 93, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 94 cost time: 0.7134735584259033
Epoch: 94, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 95 cost time: 0.6340508460998535
Epoch: 95, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 96 cost time: 0.6868023872375488
Epoch: 96, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 97 cost time: 0.680750846862793
Epoch: 97, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 98 cost time: 0.617659330368042
Epoch: 98, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 99 cost time: 0.7028601169586182
Epoch: 99, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 100 cost time: 0.6660678386688232
Epoch: 100, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 51732
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5661532878875732
Epoch: 1, Steps: 3 | Train Loss: 1.613 Vali Loss: 1.431 Vali Acc: 0.250 Test Loss: 1.431 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5287938117980957
Epoch: 2, Steps: 3 | Train Loss: 1.571 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.6649224758148193
Epoch: 3, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.343 Vali Acc: 0.275 Test Loss: 1.343 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.6197950839996338
Epoch: 4, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.291 Vali Acc: 0.300 Test Loss: 1.291 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.5621190071105957
Epoch: 5, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.233 Vali Acc: 0.350 Test Loss: 1.233 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349988).  Saving model ...
Epoch: 6 cost time: 0.7642557621002197
Epoch: 6, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.176 Vali Acc: 0.450 Test Loss: 1.176 Test Acc: 0.450
Validation loss decreased (-0.349988 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.6875154972076416
Epoch: 7, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.6958065032958984
Epoch: 8, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.079 Vali Acc: 0.575 Test Loss: 1.079 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.6565799713134766
Epoch: 9, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.040 Vali Acc: 0.525 Test Loss: 1.040 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6901907920837402
Epoch: 10, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.002 Vali Acc: 0.550 Test Loss: 1.002 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6618845462799072
Epoch: 11, Steps: 3 | Train Loss: 0.903 Vali Loss: 0.959 Vali Acc: 0.550 Test Loss: 0.959 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5867123603820801
Epoch: 12, Steps: 3 | Train Loss: 0.911 Vali Loss: 0.920 Vali Acc: 0.575 Test Loss: 0.920 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574991).  Saving model ...
Epoch: 13 cost time: 0.6182513236999512
Epoch: 13, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.875 Vali Acc: 0.600 Test Loss: 0.875 Test Acc: 0.600
Validation loss decreased (-0.574991 --> -0.599991).  Saving model ...
Epoch: 14 cost time: 0.7235801219940186
Epoch: 14, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.836 Vali Acc: 0.650 Test Loss: 0.836 Test Acc: 0.650
Validation loss decreased (-0.599991 --> -0.649992).  Saving model ...
Epoch: 15 cost time: 0.6665365695953369
Epoch: 15, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
Validation loss decreased (-0.649992 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.6058008670806885
Epoch: 16, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 0.6860952377319336
Epoch: 17, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 0.698153018951416
Epoch: 18, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.6969094276428223
Epoch: 19, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6812305450439453
Epoch: 20, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.661 Vali Acc: 0.825 Test Loss: 0.661 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7158389091491699
Epoch: 21, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.638 Vali Acc: 0.825 Test Loss: 0.638 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6661574840545654
Epoch: 22, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.611 Vali Acc: 0.875 Test Loss: 0.611 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.712623119354248
Epoch: 23, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.6291320323944092
Epoch: 24, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.72869873046875
Epoch: 25, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.541 Vali Acc: 0.925 Test Loss: 0.541 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.6803944110870361
Epoch: 26, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.520 Vali Acc: 0.925 Test Loss: 0.520 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.764941930770874
Epoch: 27, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7172908782958984
Epoch: 28, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6582374572753906
Epoch: 29, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.656001091003418
Epoch: 30, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7400877475738525
Epoch: 31, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6275894641876221
Epoch: 32, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6169729232788086
Epoch: 33, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6784698963165283
Epoch: 34, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.626676082611084
Epoch: 35, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6465346813201904
Epoch: 36, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 35348
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4760196208953857
Epoch: 1, Steps: 3 | Train Loss: 1.611 Vali Loss: 1.442 Vali Acc: 0.200 Test Loss: 1.442 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5525622367858887
Epoch: 2, Steps: 3 | Train Loss: 1.560 Vali Loss: 1.399 Vali Acc: 0.175 Test Loss: 1.399 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.59354567527771
Epoch: 3, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.359 Vali Acc: 0.225 Test Loss: 1.359 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.6416819095611572
Epoch: 4, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.309 Vali Acc: 0.250 Test Loss: 1.309 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.5882596969604492
Epoch: 5, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.251 Vali Acc: 0.325 Test Loss: 1.251 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.69380784034729
Epoch: 6, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.195 Vali Acc: 0.425 Test Loss: 1.195 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.5822963714599609
Epoch: 7, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
Validation loss decreased (-0.424988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.5477490425109863
Epoch: 8, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.101 Vali Acc: 0.625 Test Loss: 1.101 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.6006045341491699
Epoch: 9, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5832116603851318
Epoch: 10, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.019 Vali Acc: 0.550 Test Loss: 1.019 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.629157304763794
Epoch: 11, Steps: 3 | Train Loss: 0.908 Vali Loss: 0.976 Vali Acc: 0.550 Test Loss: 0.976 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5439963340759277
Epoch: 12, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.934 Vali Acc: 0.575 Test Loss: 0.934 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.600203275680542
Epoch: 13, Steps: 3 | Train Loss: 0.830 Vali Loss: 0.888 Vali Acc: 0.725 Test Loss: 0.888 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.6375148296356201
Epoch: 14, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.6465110778808594
Epoch: 15, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.6071996688842773
Epoch: 16, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.776 Vali Acc: 0.850 Test Loss: 0.776 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.5690951347351074
Epoch: 17, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.747 Vali Acc: 0.875 Test Loss: 0.747 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.5643284320831299
Epoch: 18, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.722 Vali Acc: 0.875 Test Loss: 0.722 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.7546687126159668
Epoch: 19, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.694 Vali Acc: 0.875 Test Loss: 0.694 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.6876018047332764
Epoch: 20, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.5636038780212402
Epoch: 21, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.648 Vali Acc: 0.875 Test Loss: 0.648 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 0.7068934440612793
Epoch: 22, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.683035135269165
Epoch: 23, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.595 Vali Acc: 0.875 Test Loss: 0.595 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.6767499446868896
Epoch: 24, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.568 Vali Acc: 0.875 Test Loss: 0.568 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.6151862144470215
Epoch: 25, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 0.6840348243713379
Epoch: 26, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 0.6328945159912109
Epoch: 27, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.513 Vali Acc: 0.875 Test Loss: 0.513 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.6713519096374512
Epoch: 28, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.6022462844848633
Epoch: 29, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.491 Vali Acc: 0.875 Test Loss: 0.491 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.7109196186065674
Epoch: 30, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.594437837600708
Epoch: 31, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 0.6946918964385986
Epoch: 32, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 0.7399733066558838
Epoch: 33, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 34 cost time: 0.6290879249572754
Epoch: 34, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.7080047130584717
Epoch: 35, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6479108333587646
Epoch: 36, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6170930862426758
Epoch: 37, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6862192153930664
Epoch: 38, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.6037158966064453
Epoch: 39, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7109019756317139
Epoch: 40, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6573996543884277
Epoch: 41, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.689892053604126
Epoch: 42, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.6770012378692627
Epoch: 43, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.7109081745147705
Epoch: 44, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6974260807037354
Epoch: 45, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.692108154296875
Epoch: 46, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5987918376922607
Epoch: 47, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.732750415802002
Epoch: 48, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7441127300262451
Epoch: 49, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7412815093994141
Epoch: 50, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6317408084869385
Epoch: 51, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6311979293823242
Epoch: 52, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6561005115509033
Epoch: 53, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 35348
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8916378021240234
Epoch: 1, Steps: 3 | Train Loss: 1.587 Vali Loss: 1.464 Vali Acc: 0.200 Test Loss: 1.464 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.7123477458953857
Epoch: 2, Steps: 3 | Train Loss: 1.545 Vali Loss: 1.424 Vali Acc: 0.225 Test Loss: 1.424 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.6338391304016113
Epoch: 3, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.7405529022216797
Epoch: 4, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.339 Vali Acc: 0.300 Test Loss: 1.339 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.7068524360656738
Epoch: 5, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.286 Vali Acc: 0.325 Test Loss: 1.286 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.6883411407470703
Epoch: 6, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6677989959716797
Epoch: 7, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.177 Vali Acc: 0.550 Test Loss: 1.177 Test Acc: 0.550
Validation loss decreased (-0.399988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.70485520362854
Epoch: 8, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.129 Vali Acc: 0.575 Test Loss: 1.129 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.6979529857635498
Epoch: 9, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.6431765556335449
Epoch: 10, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.6933794021606445
Epoch: 11, Steps: 3 | Train Loss: 0.916 Vali Loss: 0.996 Vali Acc: 0.625 Test Loss: 0.996 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 0.5835177898406982
Epoch: 12, Steps: 3 | Train Loss: 0.917 Vali Loss: 0.952 Vali Acc: 0.625 Test Loss: 0.952 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 0.6212174892425537
Epoch: 13, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.904 Vali Acc: 0.650 Test Loss: 0.904 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 14 cost time: 0.6354827880859375
Epoch: 14, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.861 Vali Acc: 0.675 Test Loss: 0.861 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 15 cost time: 0.7526767253875732
Epoch: 15, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.822 Vali Acc: 0.825 Test Loss: 0.822 Test Acc: 0.825
Validation loss decreased (-0.674991 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.7149612903594971
Epoch: 16, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.6228384971618652
Epoch: 17, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.750 Vali Acc: 0.875 Test Loss: 0.750 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.6960902214050293
Epoch: 18, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.719 Vali Acc: 0.875 Test Loss: 0.719 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.6601135730743408
Epoch: 19, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.6557576656341553
Epoch: 20, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.752795934677124
Epoch: 21, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 0.6720287799835205
Epoch: 22, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.619 Vali Acc: 0.875 Test Loss: 0.619 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.7179231643676758
Epoch: 23, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.596 Vali Acc: 0.875 Test Loss: 0.596 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.6912965774536133
Epoch: 24, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.570 Vali Acc: 0.875 Test Loss: 0.570 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.7218320369720459
Epoch: 25, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 0.665332555770874
Epoch: 26, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 0.6968390941619873
Epoch: 27, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.6302833557128906
Epoch: 28, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.492 Vali Acc: 0.875 Test Loss: 0.492 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.7552242279052734
Epoch: 29, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.6546320915222168
Epoch: 30, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.6520860195159912
Epoch: 31, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 0.7490239143371582
Epoch: 32, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.6900434494018555
Epoch: 33, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 0.7203624248504639
Epoch: 34, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.6881909370422363
Epoch: 35, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.7473182678222656
Epoch: 36, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.6904926300048828
Epoch: 37, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.7453453540802002
Epoch: 38, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.385 Vali Acc: 0.975 Test Loss: 0.385 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 39 cost time: 0.677905797958374
Epoch: 39, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7911009788513184
Epoch: 40, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7034976482391357
Epoch: 41, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7770142555236816
Epoch: 42, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7053585052490234
Epoch: 43, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7347323894500732
Epoch: 44, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6831891536712646
Epoch: 45, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6960506439208984
Epoch: 46, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7162740230560303
Epoch: 47, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6470651626586914
Epoch: 48, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 35348
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.18983793258667
Epoch: 1, Steps: 3 | Train Loss: 1.569 Vali Loss: 1.410 Vali Acc: 0.300 Test Loss: 1.410 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6273233890533447
Epoch: 2, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.379 Vali Acc: 0.350 Test Loss: 1.379 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.7856662273406982
Epoch: 3, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.6107208728790283
Epoch: 4, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.308 Vali Acc: 0.425 Test Loss: 1.308 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.6176915168762207
Epoch: 5, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.569694995880127
Epoch: 6, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.211 Vali Acc: 0.600 Test Loss: 1.211 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.637794017791748
Epoch: 7, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.162 Vali Acc: 0.750 Test Loss: 1.162 Test Acc: 0.750
Validation loss decreased (-0.599988 --> -0.749988).  Saving model ...
Epoch: 8 cost time: 0.5446739196777344
Epoch: 8, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.115 Vali Acc: 0.725 Test Loss: 1.115 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6751270294189453
Epoch: 9, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.069 Vali Acc: 0.775 Test Loss: 1.069 Test Acc: 0.775
Validation loss decreased (-0.749988 --> -0.774989).  Saving model ...
Epoch: 10 cost time: 0.6270751953125
Epoch: 10, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.023 Vali Acc: 0.825 Test Loss: 1.023 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.6656773090362549
Epoch: 11, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.977 Vali Acc: 0.850 Test Loss: 0.977 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 12 cost time: 0.6727001667022705
Epoch: 12, Steps: 3 | Train Loss: 0.881 Vali Loss: 0.929 Vali Acc: 0.900 Test Loss: 0.929 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 13 cost time: 0.6262550354003906
Epoch: 13, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.883 Vali Acc: 0.900 Test Loss: 0.883 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.6006343364715576
Epoch: 14, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.839 Vali Acc: 0.900 Test Loss: 0.839 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.6543092727661133
Epoch: 15, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.799 Vali Acc: 0.925 Test Loss: 0.799 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 16 cost time: 0.6812763214111328
Epoch: 16, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.761 Vali Acc: 0.925 Test Loss: 0.761 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 17 cost time: 0.6831564903259277
Epoch: 17, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.732 Vali Acc: 0.925 Test Loss: 0.732 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 0.6617443561553955
Epoch: 18, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.701 Vali Acc: 0.925 Test Loss: 0.701 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.6558809280395508
Epoch: 19, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.671 Vali Acc: 0.925 Test Loss: 0.671 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.6989419460296631
Epoch: 20, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.643 Vali Acc: 0.925 Test Loss: 0.643 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.6715259552001953
Epoch: 21, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.615 Vali Acc: 0.950 Test Loss: 0.615 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 22 cost time: 0.7873497009277344
Epoch: 22, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.586 Vali Acc: 0.950 Test Loss: 0.586 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.706946611404419
Epoch: 23, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 0.6985397338867188
Epoch: 24, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.532 Vali Acc: 0.950 Test Loss: 0.532 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.6919031143188477
Epoch: 25, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.508 Vali Acc: 0.950 Test Loss: 0.508 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.6654057502746582
Epoch: 26, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.483 Vali Acc: 0.950 Test Loss: 0.483 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.6827723979949951
Epoch: 27, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.462 Vali Acc: 0.950 Test Loss: 0.462 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.6886942386627197
Epoch: 28, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.441 Vali Acc: 0.950 Test Loss: 0.441 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.7129669189453125
Epoch: 29, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.6256937980651855
Epoch: 30, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.6249771118164062
Epoch: 31, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.6780929565429688
Epoch: 32, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.703845739364624
Epoch: 33, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.7087478637695312
Epoch: 34, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.7374188899993896
Epoch: 35, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.7427663803100586
Epoch: 36, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.8070895671844482
Epoch: 37, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.7604579925537109
Epoch: 38, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.7265253067016602
Epoch: 39, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.7213270664215088
Epoch: 40, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.7413291931152344
Epoch: 41, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.7052211761474609
Epoch: 42, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.300 Vali Acc: 0.975 Test Loss: 0.300 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.6971824169158936
Epoch: 43, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.6163082122802734
Epoch: 44, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.76932692527771
Epoch: 45, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.7084519863128662
Epoch: 46, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.766373872756958
Epoch: 47, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.6826367378234863
Epoch: 48, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.7260086536407471
Epoch: 49, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.6283836364746094
Epoch: 50, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 51 cost time: 0.7497556209564209
Epoch: 51, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 52 cost time: 0.734271764755249
Epoch: 52, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 53 cost time: 0.623765230178833
Epoch: 53, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 54 cost time: 0.7884325981140137
Epoch: 54, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 55 cost time: 0.7226574420928955
Epoch: 55, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 56 cost time: 0.6682698726654053
Epoch: 56, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 57 cost time: 0.7226111888885498
Epoch: 57, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 58 cost time: 0.8030393123626709
Epoch: 58, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 59 cost time: 0.7548177242279053
Epoch: 59, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 60 cost time: 0.7574470043182373
Epoch: 60, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 61 cost time: 0.7387597560882568
Epoch: 61, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 62 cost time: 0.8013474941253662
Epoch: 62, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 63 cost time: 0.7373740673065186
Epoch: 63, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 64 cost time: 0.7000992298126221
Epoch: 64, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 65 cost time: 0.7116258144378662
Epoch: 65, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7438311576843262
Epoch: 66, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 67 cost time: 0.7627847194671631
Epoch: 67, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 68 cost time: 0.7497568130493164
Epoch: 68, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 69 cost time: 0.7433652877807617
Epoch: 69, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 70 cost time: 0.7992804050445557
Epoch: 70, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7263727188110352
Epoch: 71, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 72 cost time: 0.7720692157745361
Epoch: 72, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 73 cost time: 0.6700003147125244
Epoch: 73, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7521860599517822
Epoch: 74, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 75 cost time: 0.739814043045044
Epoch: 75, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 76 cost time: 0.6341977119445801
Epoch: 76, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 77 cost time: 0.8227050304412842
Epoch: 77, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 78 cost time: 0.7605898380279541
Epoch: 78, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 79 cost time: 0.6806726455688477
Epoch: 79, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 80 cost time: 0.8236818313598633
Epoch: 80, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.7275378704071045
Epoch: 81, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.5984845161437988
Epoch: 82, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.6089434623718262
Epoch: 83, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 1.000 Test Loss: 0.176 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 35348
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7876384258270264
Epoch: 1, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.354 Vali Acc: 0.275 Test Loss: 1.354 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5543007850646973
Epoch: 2, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.314 Vali Acc: 0.350 Test Loss: 1.314 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.649956464767456
Epoch: 3, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.279 Vali Acc: 0.350 Test Loss: 1.279 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.5990931987762451
Epoch: 4, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.233 Vali Acc: 0.375 Test Loss: 1.233 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.6531848907470703
Epoch: 5, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.183 Vali Acc: 0.375 Test Loss: 1.183 Test Acc: 0.375
Validation loss decreased (-0.374988 --> -0.374988).  Saving model ...
Epoch: 6 cost time: 0.7336783409118652
Epoch: 6, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.652735710144043
Epoch: 7, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.093 Vali Acc: 0.450 Test Loss: 1.093 Test Acc: 0.450
Validation loss decreased (-0.399989 --> -0.449989).  Saving model ...
Epoch: 8 cost time: 0.6762332916259766
Epoch: 8, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.053 Vali Acc: 0.500 Test Loss: 1.053 Test Acc: 0.500
Validation loss decreased (-0.449989 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.7607560157775879
Epoch: 9, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.015 Vali Acc: 0.500 Test Loss: 1.015 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499990).  Saving model ...
Epoch: 10 cost time: 0.8105907440185547
Epoch: 10, Steps: 3 | Train Loss: 0.929 Vali Loss: 0.976 Vali Acc: 0.575 Test Loss: 0.976 Test Acc: 0.575
Validation loss decreased (-0.499990 --> -0.574990).  Saving model ...
Epoch: 11 cost time: 0.6214358806610107
Epoch: 11, Steps: 3 | Train Loss: 0.878 Vali Loss: 0.936 Vali Acc: 0.575 Test Loss: 0.936 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574991).  Saving model ...
Epoch: 12 cost time: 0.7135615348815918
Epoch: 12, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.899 Vali Acc: 0.675 Test Loss: 0.899 Test Acc: 0.675
Validation loss decreased (-0.574991 --> -0.674991).  Saving model ...
Epoch: 13 cost time: 0.6286704540252686
Epoch: 13, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.7858874797821045
Epoch: 14, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.830 Vali Acc: 0.800 Test Loss: 0.830 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.6696696281433105
Epoch: 15, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 0.6376626491546631
Epoch: 16, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.767 Vali Acc: 0.825 Test Loss: 0.767 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.7145297527313232
Epoch: 17, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.738 Vali Acc: 0.825 Test Loss: 0.738 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.6068003177642822
Epoch: 18, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.709 Vali Acc: 0.875 Test Loss: 0.709 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.6022439002990723
Epoch: 19, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.680 Vali Acc: 0.875 Test Loss: 0.680 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.5588998794555664
Epoch: 20, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.651 Vali Acc: 0.875 Test Loss: 0.651 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.6454331874847412
Epoch: 21, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 0.823570728302002
Epoch: 22, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.600 Vali Acc: 0.875 Test Loss: 0.600 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.6636831760406494
Epoch: 23, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.726940393447876
Epoch: 24, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.569 Vali Acc: 0.875 Test Loss: 0.569 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.7387990951538086
Epoch: 25, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 26 cost time: 0.6388654708862305
Epoch: 26, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.550 Vali Acc: 0.875 Test Loss: 0.550 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 0.7353515625
Epoch: 27, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.7273752689361572
Epoch: 28, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.6937897205352783
Epoch: 29, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.6563510894775391
Epoch: 30, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.500 Vali Acc: 0.875 Test Loss: 0.500 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 31 cost time: 0.6681628227233887
Epoch: 31, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 32 cost time: 0.6918673515319824
Epoch: 32, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.492 Vali Acc: 0.875 Test Loss: 0.492 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 33 cost time: 0.7005665302276611
Epoch: 33, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 34 cost time: 0.6610634326934814
Epoch: 34, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 35 cost time: 0.6732759475708008
Epoch: 35, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 36 cost time: 0.7169625759124756
Epoch: 36, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 37 cost time: 0.6660938262939453
Epoch: 37, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 38 cost time: 0.6097621917724609
Epoch: 38, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.6833186149597168
Epoch: 39, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.6181778907775879
Epoch: 40, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.6112411022186279
Epoch: 41, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.6739840507507324
Epoch: 42, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6330239772796631
Epoch: 43, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6512219905853271
Epoch: 44, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6415350437164307
Epoch: 45, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6562609672546387
Epoch: 46, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5751268863677979
Epoch: 47, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.664132833480835
Epoch: 48, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6851937770843506
Epoch: 49, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7935254573822021
Epoch: 50, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.432 Vali Acc: 0.825 Test Loss: 0.432 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.6155650615692139
Epoch: 51, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 27156
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6067943572998047
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.383 Vali Acc: 0.275 Test Loss: 1.383 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6756505966186523
Epoch: 2, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.347 Vali Acc: 0.250 Test Loss: 1.347 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6090631484985352
Epoch: 3, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.313 Vali Acc: 0.275 Test Loss: 1.313 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.7128520011901855
Epoch: 4, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.271 Vali Acc: 0.325 Test Loss: 1.271 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.686098575592041
Epoch: 5, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.222 Vali Acc: 0.375 Test Loss: 1.222 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 6 cost time: 0.7733194828033447
Epoch: 6, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.173 Vali Acc: 0.375 Test Loss: 1.173 Test Acc: 0.375
Validation loss decreased (-0.374988 --> -0.374988).  Saving model ...
Epoch: 7 cost time: 0.7132172584533691
Epoch: 7, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.130 Vali Acc: 0.525 Test Loss: 1.130 Test Acc: 0.525
Validation loss decreased (-0.374988 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.7065367698669434
Epoch: 8, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.8287904262542725
Epoch: 9, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.051 Vali Acc: 0.575 Test Loss: 1.051 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7364392280578613
Epoch: 10, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.7035245895385742
Epoch: 11, Steps: 3 | Train Loss: 0.898 Vali Loss: 0.970 Vali Acc: 0.650 Test Loss: 0.970 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 0.7597556114196777
Epoch: 12, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.931 Vali Acc: 0.700 Test Loss: 0.931 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.7871875762939453
Epoch: 13, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.8068416118621826
Epoch: 14, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 0.7008383274078369
Epoch: 15, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.815 Vali Acc: 0.875 Test Loss: 0.815 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.6799051761627197
Epoch: 16, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.791 Vali Acc: 0.850 Test Loss: 0.791 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7451863288879395
Epoch: 17, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.760 Vali Acc: 0.850 Test Loss: 0.760 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6940326690673828
Epoch: 18, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6754226684570312
Epoch: 19, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.699 Vali Acc: 0.875 Test Loss: 0.699 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.682431697845459
Epoch: 20, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.671 Vali Acc: 0.875 Test Loss: 0.671 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.6267704963684082
Epoch: 21, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 0.6251232624053955
Epoch: 22, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.6664736270904541
Epoch: 23, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.597 Vali Acc: 0.925 Test Loss: 0.597 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.7349622249603271
Epoch: 24, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.576 Vali Acc: 0.925 Test Loss: 0.576 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.6473300457000732
Epoch: 25, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.563 Vali Acc: 0.925 Test Loss: 0.563 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 0.7710762023925781
Epoch: 26, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.551 Vali Acc: 0.925 Test Loss: 0.551 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 27 cost time: 0.7519428730010986
Epoch: 27, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.545 Vali Acc: 0.925 Test Loss: 0.545 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.6727285385131836
Epoch: 28, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7504386901855469
Epoch: 29, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7640609741210938
Epoch: 30, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7563564777374268
Epoch: 31, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8566427230834961
Epoch: 32, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7091882228851318
Epoch: 33, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7832274436950684
Epoch: 34, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7780234813690186
Epoch: 35, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.474 Vali Acc: 0.925 Test Loss: 0.474 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.7426528930664062
Epoch: 36, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.7351388931274414
Epoch: 37, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.7621903419494629
Epoch: 38, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.6851942539215088
Epoch: 39, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.8574380874633789
Epoch: 40, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.7302143573760986
Epoch: 41, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.8030037879943848
Epoch: 42, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7768349647521973
Epoch: 43, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8773338794708252
Epoch: 44, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7783408164978027
Epoch: 45, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7037355899810791
Epoch: 46, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7464900016784668
Epoch: 47, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9115722179412842
Epoch: 48, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8085818290710449
Epoch: 49, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7528464794158936
Epoch: 50, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.7571167945861816
Epoch: 51, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 27156
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6065073013305664
Epoch: 1, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.380 Vali Acc: 0.200 Test Loss: 1.380 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.6615850925445557
Epoch: 2, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.346 Vali Acc: 0.200 Test Loss: 1.346 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.6038737297058105
Epoch: 3, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.315 Vali Acc: 0.225 Test Loss: 1.315 Test Acc: 0.225
Validation loss decreased (-0.199987 --> -0.224987).  Saving model ...
Epoch: 4 cost time: 0.6628246307373047
Epoch: 4, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.274 Vali Acc: 0.275 Test Loss: 1.274 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 0.6818904876708984
Epoch: 5, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.227 Vali Acc: 0.250 Test Loss: 1.227 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6260535717010498
Epoch: 6, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.179 Vali Acc: 0.375 Test Loss: 1.179 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374988).  Saving model ...
Epoch: 7 cost time: 0.6791133880615234
Epoch: 7, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.135 Vali Acc: 0.450 Test Loss: 1.135 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449989).  Saving model ...
Epoch: 8 cost time: 0.5724911689758301
Epoch: 8, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.091 Vali Acc: 0.550 Test Loss: 1.091 Test Acc: 0.550
Validation loss decreased (-0.449989 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.6360776424407959
Epoch: 9, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.050 Vali Acc: 0.600 Test Loss: 1.050 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.6798856258392334
Epoch: 10, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.6161267757415771
Epoch: 11, Steps: 3 | Train Loss: 0.915 Vali Loss: 0.963 Vali Acc: 0.625 Test Loss: 0.963 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 0.6570732593536377
Epoch: 12, Steps: 3 | Train Loss: 0.832 Vali Loss: 0.922 Vali Acc: 0.775 Test Loss: 0.922 Test Acc: 0.775
Validation loss decreased (-0.624990 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 0.7280170917510986
Epoch: 13, Steps: 3 | Train Loss: 0.805 Vali Loss: 0.883 Vali Acc: 0.875 Test Loss: 0.883 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.6863677501678467
Epoch: 14, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.846 Vali Acc: 0.875 Test Loss: 0.846 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.6230719089508057
Epoch: 15, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.809 Vali Acc: 0.875 Test Loss: 0.809 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.7246055603027344
Epoch: 16, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.776 Vali Acc: 0.850 Test Loss: 0.776 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.660811185836792
Epoch: 17, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.738 Vali Acc: 0.900 Test Loss: 0.738 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.7426652908325195
Epoch: 18, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.709 Vali Acc: 0.900 Test Loss: 0.709 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.7714285850524902
Epoch: 19, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.7385220527648926
Epoch: 20, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.652 Vali Acc: 0.900 Test Loss: 0.652 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.7480592727661133
Epoch: 21, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.7085740566253662
Epoch: 22, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.691370964050293
Epoch: 23, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.579 Vali Acc: 0.900 Test Loss: 0.579 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.7461888790130615
Epoch: 24, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.554 Vali Acc: 0.900 Test Loss: 0.554 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.6664164066314697
Epoch: 25, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.7799787521362305
Epoch: 26, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.523 Vali Acc: 0.925 Test Loss: 0.523 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.7730574607849121
Epoch: 27, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.512 Vali Acc: 0.925 Test Loss: 0.512 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.7389507293701172
Epoch: 28, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.503 Vali Acc: 0.925 Test Loss: 0.503 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.7229909896850586
Epoch: 29, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.493 Vali Acc: 0.925 Test Loss: 0.493 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.7716238498687744
Epoch: 30, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.479 Vali Acc: 0.925 Test Loss: 0.479 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.7808566093444824
Epoch: 31, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 0.6895196437835693
Epoch: 32, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 0.7407779693603516
Epoch: 33, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.447 Vali Acc: 0.925 Test Loss: 0.447 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 0.8077335357666016
Epoch: 34, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7730224132537842
Epoch: 35, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6940810680389404
Epoch: 36, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.5857815742492676
Epoch: 37, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.6528472900390625
Epoch: 38, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.408 Vali Acc: 0.950 Test Loss: 0.408 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.7363448143005371
Epoch: 39, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.7230789661407471
Epoch: 40, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.5980930328369141
Epoch: 41, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.698829174041748
Epoch: 42, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.6750500202178955
Epoch: 43, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.6455490589141846
Epoch: 44, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.7387561798095703
Epoch: 45, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.7155089378356934
Epoch: 46, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 0.7450368404388428
Epoch: 47, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7313926219940186
Epoch: 48, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6912293434143066
Epoch: 49, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6844992637634277
Epoch: 50, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7289724349975586
Epoch: 51, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.7893681526184082
Epoch: 52, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.6685492992401123
Epoch: 53, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7759580612182617
Epoch: 54, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7370791435241699
Epoch: 55, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.6360363960266113
Epoch: 56, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 27156
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.402157783508301
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.426 Vali Acc: 0.175 Test Loss: 1.426 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.6720585823059082
Epoch: 2, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.398 Vali Acc: 0.200 Test Loss: 1.398 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.6685082912445068
Epoch: 3, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.371 Vali Acc: 0.200 Test Loss: 1.371 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.6856422424316406
Epoch: 4, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.334 Vali Acc: 0.250 Test Loss: 1.334 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.6894204616546631
Epoch: 5, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.291 Vali Acc: 0.300 Test Loss: 1.291 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 6 cost time: 0.6390643119812012
Epoch: 6, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.248 Vali Acc: 0.350 Test Loss: 1.248 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349988).  Saving model ...
Epoch: 7 cost time: 0.6443657875061035
Epoch: 7, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.198 Vali Acc: 0.475 Test Loss: 1.198 Test Acc: 0.475
Validation loss decreased (-0.349988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.6922512054443359
Epoch: 8, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.6633918285369873
Epoch: 9, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.107 Vali Acc: 0.550 Test Loss: 1.107 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.6706750392913818
Epoch: 10, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.061 Vali Acc: 0.750 Test Loss: 1.061 Test Acc: 0.750
Validation loss decreased (-0.549989 --> -0.749989).  Saving model ...
Epoch: 11 cost time: 0.6602962017059326
Epoch: 11, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.018 Vali Acc: 0.800 Test Loss: 1.018 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 12 cost time: 0.6206200122833252
Epoch: 12, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.975 Vali Acc: 0.800 Test Loss: 0.975 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 13 cost time: 0.7053713798522949
Epoch: 13, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.926 Vali Acc: 0.825 Test Loss: 0.926 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 14 cost time: 0.5492942333221436
Epoch: 14, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.885 Vali Acc: 0.850 Test Loss: 0.885 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 15 cost time: 0.6113224029541016
Epoch: 15, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.844 Vali Acc: 0.875 Test Loss: 0.844 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.5152382850646973
Epoch: 16, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.804 Vali Acc: 0.850 Test Loss: 0.804 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5275876522064209
Epoch: 17, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.766 Vali Acc: 0.875 Test Loss: 0.766 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.6517198085784912
Epoch: 18, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.730 Vali Acc: 0.900 Test Loss: 0.730 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.6073331832885742
Epoch: 19, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.695 Vali Acc: 0.925 Test Loss: 0.695 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.577195405960083
Epoch: 20, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.668 Vali Acc: 0.950 Test Loss: 0.668 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 21 cost time: 0.6204285621643066
Epoch: 21, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.641 Vali Acc: 0.950 Test Loss: 0.641 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 22 cost time: 0.6418728828430176
Epoch: 22, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.616 Vali Acc: 0.925 Test Loss: 0.616 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7531306743621826
Epoch: 23, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.596 Vali Acc: 0.925 Test Loss: 0.596 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5852344036102295
Epoch: 24, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.574 Vali Acc: 0.925 Test Loss: 0.574 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6351926326751709
Epoch: 25, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.557 Vali Acc: 0.925 Test Loss: 0.557 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7061264514923096
Epoch: 26, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.534 Vali Acc: 0.950 Test Loss: 0.534 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.7830355167388916
Epoch: 27, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.518 Vali Acc: 0.950 Test Loss: 0.518 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.6149466037750244
Epoch: 28, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.504 Vali Acc: 0.950 Test Loss: 0.504 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.7057664394378662
Epoch: 29, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.486 Vali Acc: 0.950 Test Loss: 0.486 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.6446511745452881
Epoch: 30, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.470 Vali Acc: 0.950 Test Loss: 0.470 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.7145698070526123
Epoch: 31, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.462 Vali Acc: 0.950 Test Loss: 0.462 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.6246330738067627
Epoch: 32, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7030429840087891
Epoch: 33, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7210118770599365
Epoch: 34, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.6847817897796631
Epoch: 35, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7428145408630371
Epoch: 36, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.408 Vali Acc: 0.950 Test Loss: 0.408 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.6814117431640625
Epoch: 37, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.6671004295349121
Epoch: 38, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 39 cost time: 0.5917143821716309
Epoch: 39, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 40 cost time: 0.7270116806030273
Epoch: 40, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 41 cost time: 0.7089519500732422
Epoch: 41, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.6228811740875244
Epoch: 42, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.7349200248718262
Epoch: 43, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7106099128723145
Epoch: 44, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.7794759273529053
Epoch: 45, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.712444543838501
Epoch: 46, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.6778690814971924
Epoch: 47, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.709498405456543
Epoch: 48, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6515395641326904
Epoch: 49, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6866455078125
Epoch: 50, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6602897644042969
Epoch: 51, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.7286562919616699
Epoch: 52, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7017850875854492
Epoch: 53, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.6218686103820801
Epoch: 54, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.6720960140228271
Epoch: 55, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.6278469562530518
Epoch: 56, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 27156
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.456899881362915
Epoch: 1, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.323 Vali Acc: 0.175 Test Loss: 1.323 Test Acc: 0.175
Validation loss decreased (inf --> -0.174987).  Saving model ...
Epoch: 2 cost time: 0.7370233535766602
Epoch: 2, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.162 Vali Acc: 0.325 Test Loss: 1.162 Test Acc: 0.325
Validation loss decreased (-0.174987 --> -0.324988).  Saving model ...
Epoch: 3 cost time: 0.6498606204986572
Epoch: 3, Steps: 3 | Train Loss: 1.007 Vali Loss: 0.889 Vali Acc: 0.650 Test Loss: 0.889 Test Acc: 0.650
Validation loss decreased (-0.324988 --> -0.649991).  Saving model ...
Epoch: 4 cost time: 0.6245200634002686
Epoch: 4, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.641 Vali Acc: 0.950 Test Loss: 0.641 Test Acc: 0.950
Validation loss decreased (-0.649991 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 0.7161149978637695
Epoch: 5, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.5865387916564941
Epoch: 6, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.334 Vali Acc: 0.975 Test Loss: 0.334 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974997).  Saving model ...
Epoch: 7 cost time: 0.5746126174926758
Epoch: 7, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6464073657989502
Epoch: 8, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 0.5817615985870361
Epoch: 9, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6484825611114502
Epoch: 10, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6624443531036377
Epoch: 11, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5942156314849854
Epoch: 12, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5490419864654541
Epoch: 13, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5688674449920654
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6527044773101807
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6248068809509277
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5797319412231445
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6279630661010742
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2847788
model size : 20.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7096331119537354
Epoch: 1, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.314 Vali Acc: 0.200 Test Loss: 1.314 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.5261423587799072
Epoch: 2, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.153 Vali Acc: 0.325 Test Loss: 1.153 Test Acc: 0.325
Validation loss decreased (-0.199987 --> -0.324988).  Saving model ...
Epoch: 3 cost time: 0.5479536056518555
Epoch: 3, Steps: 3 | Train Loss: 1.009 Vali Loss: 0.881 Vali Acc: 0.675 Test Loss: 0.881 Test Acc: 0.675
Validation loss decreased (-0.324988 --> -0.674991).  Saving model ...
Epoch: 4 cost time: 0.6194639205932617
Epoch: 4, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.624 Vali Acc: 0.975 Test Loss: 0.624 Test Acc: 0.975
Validation loss decreased (-0.674991 --> -0.974994).  Saving model ...
Epoch: 5 cost time: 0.5565423965454102
Epoch: 5, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.451 Vali Acc: 0.975 Test Loss: 0.451 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 6 cost time: 0.6488547325134277
Epoch: 6, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974997).  Saving model ...
Epoch: 7 cost time: 0.6139328479766846
Epoch: 7, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.6112358570098877
Epoch: 8, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 0.5724377632141113
Epoch: 9, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5389163494110107
Epoch: 10, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5655031204223633
Epoch: 11, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.204 Vali Acc: 0.925 Test Loss: 0.204 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.568422794342041
Epoch: 12, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.5096893310546875
Epoch: 13, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5855741500854492
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.5925288200378418
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.925 Test Loss: 0.167 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5954995155334473
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.925 Test Loss: 0.173 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6590912342071533
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.925 Test Loss: 0.181 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5478887557983398
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.925 Test Loss: 0.190 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6147723197937012
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5252153873443604
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6240904331207275
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.925 Test Loss: 0.193 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.637664794921875
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.925 Test Loss: 0.191 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5333840847015381
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.925 Test Loss: 0.189 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.546058177947998
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.925 Test Loss: 0.188 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2847788
model size : 20.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6014814376831055
Epoch: 1, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.266 Vali Acc: 0.225 Test Loss: 1.266 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.6396825313568115
Epoch: 2, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.112 Vali Acc: 0.725 Test Loss: 1.112 Test Acc: 0.725
Validation loss decreased (-0.224987 --> -0.724989).  Saving model ...
Epoch: 3 cost time: 0.6372361183166504
Epoch: 3, Steps: 3 | Train Loss: 0.982 Vali Loss: 0.855 Vali Acc: 0.850 Test Loss: 0.855 Test Acc: 0.850
Validation loss decreased (-0.724989 --> -0.849991).  Saving model ...
Epoch: 4 cost time: 0.5790855884552002
Epoch: 4, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.607 Vali Acc: 1.000 Test Loss: 0.607 Test Acc: 1.000
Validation loss decreased (-0.849991 --> -0.999994).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2847788
model size : 20.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.334009885787964
Epoch: 1, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.299 Vali Acc: 0.275 Test Loss: 1.299 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.6678464412689209
Epoch: 2, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.157 Vali Acc: 0.575 Test Loss: 1.157 Test Acc: 0.575
Validation loss decreased (-0.274987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 0.6269025802612305
Epoch: 3, Steps: 3 | Train Loss: 0.979 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674991).  Saving model ...
Epoch: 4 cost time: 0.7143075466156006
Epoch: 4, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.694 Vali Acc: 0.975 Test Loss: 0.694 Test Acc: 0.975
Validation loss decreased (-0.674991 --> -0.974993).  Saving model ...
Epoch: 5 cost time: 0.7556009292602539
Epoch: 5, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.528 Vali Acc: 0.975 Test Loss: 0.528 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974995).  Saving model ...
Epoch: 6 cost time: 0.6476895809173584
Epoch: 6, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6269559860229492
Epoch: 7, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6782913208007812
Epoch: 8, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5838515758514404
Epoch: 9, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.664670467376709
Epoch: 10, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5997438430786133
Epoch: 11, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.697493314743042
Epoch: 12, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6975982189178467
Epoch: 13, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5309486389160156
Epoch: 14, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7148103713989258
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.609886884689331
Epoch: 16, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6304636001586914
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5786798000335693
Epoch: 18, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5766549110412598
Epoch: 19, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5855727195739746
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.607391357421875
Epoch: 21, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2847788
model size : 20.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4039814472198486
Epoch: 1, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.251 Vali Acc: 0.325 Test Loss: 1.251 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.6179368495941162
Epoch: 2, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.114 Vali Acc: 0.525 Test Loss: 1.114 Test Acc: 0.525
Validation loss decreased (-0.324987 --> -0.524989).  Saving model ...
Epoch: 3 cost time: 0.6872875690460205
Epoch: 3, Steps: 3 | Train Loss: 0.999 Vali Loss: 0.899 Vali Acc: 0.725 Test Loss: 0.899 Test Acc: 0.725
Validation loss decreased (-0.524989 --> -0.724991).  Saving model ...
Epoch: 4 cost time: 0.5171022415161133
Epoch: 4, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.644 Vali Acc: 0.900 Test Loss: 0.644 Test Acc: 0.900
Validation loss decreased (-0.724991 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 0.6333496570587158
Epoch: 5, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 0.6073625087738037
Epoch: 6, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 0.5645627975463867
Epoch: 7, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 8 cost time: 0.6027834415435791
Epoch: 8, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6777675151824951
Epoch: 9, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5820226669311523
Epoch: 10, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.270 Vali Acc: 0.875 Test Loss: 0.270 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5635061264038086
Epoch: 11, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924998).  Saving model ...
Epoch: 12 cost time: 0.6055238246917725
Epoch: 12, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 13 cost time: 0.6631126403808594
Epoch: 13, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6006288528442383
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6785025596618652
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6275765895843506
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5681345462799072
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6322927474975586
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6107442378997803
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5649752616882324
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6311101913452148
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6527690887451172
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1799212
model size : 16.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6230998039245605
Epoch: 1, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.245 Vali Acc: 0.375 Test Loss: 1.245 Test Acc: 0.375
Validation loss decreased (inf --> -0.374988).  Saving model ...
Epoch: 2 cost time: 0.6490705013275146
Epoch: 2, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.102 Vali Acc: 0.475 Test Loss: 1.102 Test Acc: 0.475
Validation loss decreased (-0.374988 --> -0.474989).  Saving model ...
Epoch: 3 cost time: 0.6279432773590088
Epoch: 3, Steps: 3 | Train Loss: 0.995 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.474989 --> -0.724991).  Saving model ...
Epoch: 4 cost time: 0.6223993301391602
Epoch: 4, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.628 Vali Acc: 0.925 Test Loss: 0.628 Test Acc: 0.925
Validation loss decreased (-0.724991 --> -0.924994).  Saving model ...
Epoch: 5 cost time: 0.5997133255004883
Epoch: 5, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 6 cost time: 0.618208646774292
Epoch: 6, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6393132209777832
Epoch: 7, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 0.6290547847747803
Epoch: 8, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6203346252441406
Epoch: 9, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5970790386199951
Epoch: 10, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6113557815551758
Epoch: 11, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 12 cost time: 0.5926039218902588
Epoch: 12, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.5588860511779785
Epoch: 13, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.49971675872802734
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.5815131664276123
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5182783603668213
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5348098278045654
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6361353397369385
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6131668090820312
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5843396186828613
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6060855388641357
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.593233585357666
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6334047317504883
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5978684425354004
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1799212
model size : 16.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5506627559661865
Epoch: 1, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.6162245273590088
Epoch: 2, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.128 Vali Acc: 0.600 Test Loss: 1.128 Test Acc: 0.600
Validation loss decreased (-0.399987 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.624443769454956
Epoch: 3, Steps: 3 | Train Loss: 1.005 Vali Loss: 0.890 Vali Acc: 0.825 Test Loss: 0.890 Test Acc: 0.825
Validation loss decreased (-0.599989 --> -0.824991).  Saving model ...
Epoch: 4 cost time: 0.6471881866455078
Epoch: 4, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.647 Vali Acc: 0.925 Test Loss: 0.647 Test Acc: 0.925
Validation loss decreased (-0.824991 --> -0.924994).  Saving model ...
Epoch: 5 cost time: 0.6465389728546143
Epoch: 5, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.6585462093353271
Epoch: 6, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.6194584369659424
Epoch: 7, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 0.631049394607544
Epoch: 8, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.576143741607666
Epoch: 9, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5999839305877686
Epoch: 10, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6294217109680176
Epoch: 11, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.184 Vali Acc: 0.925 Test Loss: 0.184 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5955314636230469
Epoch: 12, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.6742269992828369
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.5623245239257812
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6704628467559814
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6155588626861572
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6024940013885498
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.622995138168335
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5835800170898438
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6322674751281738
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5888655185699463
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.925 Test Loss: 0.169 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7197954654693604
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.925 Test Loss: 0.170 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5217962265014648
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.925 Test Loss: 0.171 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1799212
model size : 16.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5383718013763428
Epoch: 1, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.235 Vali Acc: 0.375 Test Loss: 1.235 Test Acc: 0.375
Validation loss decreased (inf --> -0.374988).  Saving model ...
Epoch: 2 cost time: 0.7064199447631836
Epoch: 2, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.103 Vali Acc: 0.550 Test Loss: 1.103 Test Acc: 0.550
Validation loss decreased (-0.374988 --> -0.549989).  Saving model ...
Epoch: 3 cost time: 0.7079551219940186
Epoch: 3, Steps: 3 | Train Loss: 0.984 Vali Loss: 0.882 Vali Acc: 0.900 Test Loss: 0.882 Test Acc: 0.900
Validation loss decreased (-0.549989 --> -0.899991).  Saving model ...
Epoch: 4 cost time: 0.5626399517059326
Epoch: 4, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.672 Vali Acc: 0.975 Test Loss: 0.672 Test Acc: 0.975
Validation loss decreased (-0.899991 --> -0.974993).  Saving model ...
Epoch: 5 cost time: 0.6070349216461182
Epoch: 5, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.513 Vali Acc: 0.900 Test Loss: 0.513 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.71673583984375
Epoch: 6, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6336512565612793
Epoch: 7, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6217710971832275
Epoch: 8, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7019743919372559
Epoch: 9, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.614163875579834
Epoch: 10, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6729271411895752
Epoch: 11, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.204 Vali Acc: 0.925 Test Loss: 0.204 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.58892822265625
Epoch: 12, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.198 Vali Acc: 0.925 Test Loss: 0.198 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6956942081451416
Epoch: 13, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.182 Vali Acc: 0.925 Test Loss: 0.182 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6482274532318115
Epoch: 14, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.925 Test Loss: 0.176 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1799212
model size : 16.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6458070278167725
Epoch: 1, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.372 Vali Acc: 0.350 Test Loss: 1.372 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.7539334297180176
Epoch: 2, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.192 Vali Acc: 0.550 Test Loss: 1.192 Test Acc: 0.550
Validation loss decreased (-0.349986 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 0.6191074848175049
Epoch: 3, Steps: 3 | Train Loss: 0.947 Vali Loss: 0.923 Vali Acc: 0.700 Test Loss: 0.923 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 0.7129096984863281
Epoch: 4, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
Validation loss decreased (-0.699991 --> -0.849993).  Saving model ...
Epoch: 5 cost time: 0.598228931427002
Epoch: 5, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 0.6645030975341797
Epoch: 6, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 0.6754534244537354
Epoch: 7, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.874995 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 0.6923985481262207
Epoch: 8, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 0.7646846771240234
Epoch: 9, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6534051895141602
Epoch: 10, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.644742488861084
Epoch: 11, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7549145221710205
Epoch: 12, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7153692245483398
Epoch: 13, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5790584087371826
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6250553131103516
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6891460418701172
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7145166397094727
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6466002464294434
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1274924
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.402703285217285
Epoch: 1, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.377 Vali Acc: 0.400 Test Loss: 1.377 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.6374611854553223
Epoch: 2, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.201 Vali Acc: 0.525 Test Loss: 1.201 Test Acc: 0.525
Validation loss decreased (-0.399986 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 0.6357378959655762
Epoch: 3, Steps: 3 | Train Loss: 0.972 Vali Loss: 0.922 Vali Acc: 0.750 Test Loss: 0.922 Test Acc: 0.750
Validation loss decreased (-0.524988 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 0.5796334743499756
Epoch: 4, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 0.6673853397369385
Epoch: 5, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.554 Vali Acc: 0.875 Test Loss: 0.554 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 0.6278603076934814
Epoch: 6, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.421 Vali Acc: 0.950 Test Loss: 0.421 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.623469352722168
Epoch: 7, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 0.6003186702728271
Epoch: 8, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 0.5805914402008057
Epoch: 9, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 0.6443841457366943
Epoch: 10, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5619058609008789
Epoch: 11, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6945269107818604
Epoch: 12, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.925 Test Loss: 0.198 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6549384593963623
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.925 Test Loss: 0.193 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.657806396484375
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6554365158081055
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.900 Test Loss: 0.204 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6587207317352295
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.925 Test Loss: 0.215 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6524407863616943
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.613288402557373
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.642676591873169
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1274924
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3946292400360107
Epoch: 1, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.360 Vali Acc: 0.475 Test Loss: 1.360 Test Acc: 0.475
Validation loss decreased (inf --> -0.474986).  Saving model ...
Epoch: 2 cost time: 0.667386531829834
Epoch: 2, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
Validation loss decreased (-0.474986 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 0.5719919204711914
Epoch: 3, Steps: 3 | Train Loss: 0.957 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
Validation loss decreased (-0.549988 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 0.6806519031524658
Epoch: 4, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.680 Vali Acc: 0.925 Test Loss: 0.680 Test Acc: 0.925
Validation loss decreased (-0.749991 --> -0.924993).  Saving model ...
Epoch: 5 cost time: 0.6967291831970215
Epoch: 5, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.507 Vali Acc: 0.950 Test Loss: 0.507 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.681870698928833
Epoch: 6, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.6371183395385742
Epoch: 7, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.307 Vali Acc: 0.975 Test Loss: 0.307 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.5288734436035156
Epoch: 8, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 9 cost time: 0.6574745178222656
Epoch: 9, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 0.6143233776092529
Epoch: 10, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.6162354946136475
Epoch: 11, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.617124080657959
Epoch: 12, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 13 cost time: 0.6387643814086914
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5517606735229492
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6226301193237305
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.925 Test Loss: 0.157 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6414406299591064
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.925 Test Loss: 0.161 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.636754035949707
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.925 Test Loss: 0.169 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6570298671722412
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.925 Test Loss: 0.174 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.709782600402832
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6246249675750732
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5187115669250488
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6874876022338867
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1274924
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5671286582946777
Epoch: 1, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.5847041606903076
Epoch: 2, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.178 Vali Acc: 0.550 Test Loss: 1.178 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 0.6214139461517334
Epoch: 3, Steps: 3 | Train Loss: 0.937 Vali Loss: 0.917 Vali Acc: 0.900 Test Loss: 0.917 Test Acc: 0.900
Validation loss decreased (-0.549988 --> -0.899991).  Saving model ...
Epoch: 4 cost time: 0.6019084453582764
Epoch: 4, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.699 Vali Acc: 0.975 Test Loss: 0.699 Test Acc: 0.975
Validation loss decreased (-0.899991 --> -0.974993).  Saving model ...
Epoch: 5 cost time: 0.5947065353393555
Epoch: 5, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.535 Vali Acc: 0.925 Test Loss: 0.535 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6433360576629639
Epoch: 6, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5787444114685059
Epoch: 7, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6097309589385986
Epoch: 8, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5848870277404785
Epoch: 9, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6168646812438965
Epoch: 10, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6359457969665527
Epoch: 11, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5824165344238281
Epoch: 12, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.925 Test Loss: 0.175 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5989642143249512
Epoch: 13, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.925 Test Loss: 0.180 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.578239917755127
Epoch: 14, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.925 Test Loss: 0.182 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1274924
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.215998649597168
Epoch: 1, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.330 Vali Acc: 0.625 Test Loss: 1.330 Test Acc: 0.625
Validation loss decreased (inf --> -0.624987).  Saving model ...
Epoch: 2 cost time: 0.6949732303619385
Epoch: 2, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.204 Vali Acc: 0.625 Test Loss: 1.204 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 0.6565561294555664
Epoch: 3, Steps: 3 | Train Loss: 0.957 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674990).  Saving model ...
Epoch: 4 cost time: 0.6836302280426025
Epoch: 4, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 0.6159584522247314
Epoch: 5, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.799993 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.6042525768280029
Epoch: 6, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 0.6955018043518066
Epoch: 7, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 0.6669480800628662
Epoch: 8, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.64259934425354
Epoch: 9, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6778020858764648
Epoch: 10, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.61460280418396
Epoch: 11, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6701822280883789
Epoch: 12, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6028728485107422
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 0.6491494178771973
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.7053711414337158
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6729538440704346
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7039401531219482
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6916458606719971
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6307272911071777
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7389359474182129
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5884144306182861
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7235393524169922
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6841485500335693
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6967120170593262
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1012780
model size : 13.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.850090503692627
Epoch: 1, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.285 Vali Acc: 0.600 Test Loss: 1.285 Test Acc: 0.600
Validation loss decreased (inf --> -0.599987).  Saving model ...
Epoch: 2 cost time: 0.6634905338287354
Epoch: 2, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.172 Vali Acc: 0.750 Test Loss: 1.172 Test Acc: 0.750
Validation loss decreased (-0.599987 --> -0.749988).  Saving model ...
Epoch: 3 cost time: 0.6175742149353027
Epoch: 3, Steps: 3 | Train Loss: 0.955 Vali Loss: 0.984 Vali Acc: 0.675 Test Loss: 0.984 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6484899520874023
Epoch: 4, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.684 Vali Acc: 0.875 Test Loss: 0.684 Test Acc: 0.875
Validation loss decreased (-0.749988 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 0.5994546413421631
Epoch: 5, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924995).  Saving model ...
Epoch: 6 cost time: 0.591933012008667
Epoch: 6, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 0.594214916229248
Epoch: 7, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 8 cost time: 0.579707145690918
Epoch: 8, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5829284191131592
Epoch: 9, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6213333606719971
Epoch: 10, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6799206733703613
Epoch: 11, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5611371994018555
Epoch: 12, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 0.5808453559875488
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 0.7062416076660156
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.607708215713501
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 16 cost time: 0.6468479633331299
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5439002513885498
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6194407939910889
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7312288284301758
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5600721836090088
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6464090347290039
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5441634654998779
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6330504417419434
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5803103446960449
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5744452476501465
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1012780
model size : 13.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6222169399261475
Epoch: 1, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.248 Vali Acc: 0.675 Test Loss: 1.248 Test Acc: 0.675
Validation loss decreased (inf --> -0.674988).  Saving model ...
Epoch: 2 cost time: 0.6497607231140137
Epoch: 2, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.139 Vali Acc: 0.725 Test Loss: 1.139 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 3 cost time: 0.7062289714813232
Epoch: 3, Steps: 3 | Train Loss: 0.977 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 0.6704792976379395
Epoch: 4, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.749991 --> -0.899993).  Saving model ...
Epoch: 5 cost time: 0.6900734901428223
Epoch: 5, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.6808950901031494
Epoch: 6, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.7067365646362305
Epoch: 7, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 0.6458370685577393
Epoch: 8, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 0.6540095806121826
Epoch: 9, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 10 cost time: 0.6506309509277344
Epoch: 10, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 11 cost time: 0.6268548965454102
Epoch: 11, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 12 cost time: 0.6366665363311768
Epoch: 12, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6560227870941162
Epoch: 13, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6552953720092773
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6404895782470703
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6044833660125732
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7295527458190918
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6313974857330322
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6155261993408203
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7100937366485596
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6692140102386475
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1012780
model size : 13.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1636950969696045
Epoch: 1, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.247 Vali Acc: 0.600 Test Loss: 1.247 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 0.5328559875488281
Epoch: 2, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.138 Vali Acc: 0.675 Test Loss: 1.138 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 3 cost time: 0.49829649925231934
Epoch: 3, Steps: 3 | Train Loss: 0.969 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 0.6502571105957031
Epoch: 4, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.713 Vali Acc: 0.925 Test Loss: 0.713 Test Acc: 0.925
Validation loss decreased (-0.699991 --> -0.924993).  Saving model ...
Epoch: 5 cost time: 0.6371212005615234
Epoch: 5, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.540 Vali Acc: 0.950 Test Loss: 0.540 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.6107132434844971
Epoch: 6, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6000831127166748
Epoch: 7, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6086649894714355
Epoch: 8, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 0.6286537647247314
Epoch: 9, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 10 cost time: 0.6078393459320068
Epoch: 10, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.603980302810669
Epoch: 11, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.925 Test Loss: 0.190 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6294898986816406
Epoch: 12, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.6577627658843994
Epoch: 13, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.925 Test Loss: 0.186 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6180102825164795
Epoch: 14, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6380922794342041
Epoch: 15, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7026562690734863
Epoch: 16, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7149994373321533
Epoch: 17, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6456997394561768
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.62799072265625
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6699261665344238
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.636305570602417
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6687543392181396
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.925 Test Loss: 0.232 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1012780
model size : 13.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.620051383972168
Epoch: 1, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.234 Vali Acc: 0.425 Test Loss: 1.234 Test Acc: 0.425
Validation loss decreased (inf --> -0.424988).  Saving model ...
Epoch: 2 cost time: 0.6827182769775391
Epoch: 2, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.101 Vali Acc: 0.475 Test Loss: 1.101 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474989).  Saving model ...
Epoch: 3 cost time: 0.7043414115905762
Epoch: 3, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.820 Vali Acc: 0.650 Test Loss: 0.820 Test Acc: 0.650
Validation loss decreased (-0.474989 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 0.6518607139587402
Epoch: 4, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.584 Vali Acc: 0.900 Test Loss: 0.584 Test Acc: 0.900
Validation loss decreased (-0.649992 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 0.7901642322540283
Epoch: 5, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.403 Vali Acc: 0.975 Test Loss: 0.403 Test Acc: 0.975
Validation loss decreased (-0.899994 --> -0.974996).  Saving model ...
Epoch: 6 cost time: 0.6108219623565674
Epoch: 6, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6263594627380371
Epoch: 7, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5953724384307861
Epoch: 8, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5926251411437988
Epoch: 9, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6078438758850098
Epoch: 10, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6348404884338379
Epoch: 11, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5591609477996826
Epoch: 12, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6641254425048828
Epoch: 13, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6394095420837402
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5872464179992676
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 881708
model size : 13.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7681539058685303
Epoch: 1, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.250 Vali Acc: 0.325 Test Loss: 1.250 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.6382782459259033
Epoch: 2, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.125 Vali Acc: 0.475 Test Loss: 1.125 Test Acc: 0.475
Validation loss decreased (-0.324987 --> -0.474989).  Saving model ...
Epoch: 3 cost time: 0.5806348323822021
Epoch: 3, Steps: 3 | Train Loss: 0.912 Vali Loss: 0.851 Vali Acc: 0.675 Test Loss: 0.851 Test Acc: 0.675
Validation loss decreased (-0.474989 --> -0.674991).  Saving model ...
Epoch: 4 cost time: 0.6167314052581787
Epoch: 4, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.608 Vali Acc: 0.925 Test Loss: 0.608 Test Acc: 0.925
Validation loss decreased (-0.674991 --> -0.924994).  Saving model ...
Epoch: 5 cost time: 0.6301705837249756
Epoch: 5, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 6 cost time: 0.5889804363250732
Epoch: 6, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5920121669769287
Epoch: 7, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.6352331638336182
Epoch: 8, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6312565803527832
Epoch: 9, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6997520923614502
Epoch: 10, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6888206005096436
Epoch: 11, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6062273979187012
Epoch: 12, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6999621391296387
Epoch: 13, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6114461421966553
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.267 Vali Acc: 0.875 Test Loss: 0.267 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6815567016601562
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.875 Test Loss: 0.259 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6282920837402344
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.258 Vali Acc: 0.875 Test Loss: 0.258 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5596179962158203
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.875 Test Loss: 0.257 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 881708
model size : 13.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.528866767883301
Epoch: 1, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.262 Vali Acc: 0.350 Test Loss: 1.262 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.6063919067382812
Epoch: 2, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.141 Vali Acc: 0.425 Test Loss: 1.141 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424989).  Saving model ...
Epoch: 3 cost time: 0.6664924621582031
Epoch: 3, Steps: 3 | Train Loss: 0.916 Vali Loss: 0.870 Vali Acc: 0.600 Test Loss: 0.870 Test Acc: 0.600
Validation loss decreased (-0.424989 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 0.5994076728820801
Epoch: 4, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.620 Vali Acc: 0.950 Test Loss: 0.620 Test Acc: 0.950
Validation loss decreased (-0.599991 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 0.5559353828430176
Epoch: 5, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.420 Vali Acc: 0.975 Test Loss: 0.420 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974996).  Saving model ...
Epoch: 6 cost time: 0.5599398612976074
Epoch: 6, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.604468584060669
Epoch: 7, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.6747646331787109
Epoch: 8, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5234959125518799
Epoch: 9, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6639645099639893
Epoch: 10, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5829150676727295
Epoch: 11, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6208450794219971
Epoch: 12, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6305062770843506
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6167001724243164
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5396788120269775
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.925 Test Loss: 0.216 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6494314670562744
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.925 Test Loss: 0.216 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6186609268188477
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.925 Test Loss: 0.215 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 881708
model size : 13.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.491302967071533
Epoch: 1, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.252 Vali Acc: 0.425 Test Loss: 1.252 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.6868798732757568
Epoch: 2, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549989).  Saving model ...
Epoch: 3 cost time: 0.6251158714294434
Epoch: 3, Steps: 3 | Train Loss: 0.929 Vali Loss: 0.888 Vali Acc: 0.725 Test Loss: 0.888 Test Acc: 0.725
Validation loss decreased (-0.549989 --> -0.724991).  Saving model ...
Epoch: 4 cost time: 0.6110434532165527
Epoch: 4, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.670 Vali Acc: 0.950 Test Loss: 0.670 Test Acc: 0.950
Validation loss decreased (-0.724991 --> -0.949993).  Saving model ...
Epoch: 5 cost time: 0.581695556640625
Epoch: 5, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6823234558105469
Epoch: 6, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5823240280151367
Epoch: 7, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5386509895324707
Epoch: 8, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 0.6299233436584473
Epoch: 9, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5405988693237305
Epoch: 10, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6081037521362305
Epoch: 11, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 12 cost time: 0.628699541091919
Epoch: 12, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.925 Test Loss: 0.208 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.644756555557251
Epoch: 13, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.925 Test Loss: 0.208 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6605536937713623
Epoch: 14, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6310977935791016
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.925 Test Loss: 0.217 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.616814374923706
Epoch: 16, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.900 Test Loss: 0.221 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5794022083282471
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6987571716308594
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6410665512084961
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6705806255340576
Epoch: 20, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5145962238311768
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.875 Test Loss: 0.222 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 881708
model size : 13.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6757450103759766
Epoch: 1, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.387 Vali Acc: 0.225 Test Loss: 1.387 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5500643253326416
Epoch: 2, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.219 Vali Acc: 0.425 Test Loss: 1.219 Test Acc: 0.425
Validation loss decreased (-0.224986 --> -0.424988).  Saving model ...
Epoch: 3 cost time: 0.596229076385498
Epoch: 3, Steps: 3 | Train Loss: 0.973 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
Validation loss decreased (-0.424988 --> -0.724990).  Saving model ...
Epoch: 4 cost time: 0.5616168975830078
Epoch: 4, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.699 Vali Acc: 0.900 Test Loss: 0.699 Test Acc: 0.900
Validation loss decreased (-0.724990 --> -0.899993).  Saving model ...
Epoch: 5 cost time: 0.6344904899597168
Epoch: 5, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 0.6230623722076416
Epoch: 6, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 0.5953097343444824
Epoch: 7, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6152379512786865
Epoch: 8, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.425 Vali Acc: 0.875 Test Loss: 0.425 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6500325202941895
Epoch: 9, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 10 cost time: 0.6159462928771973
Epoch: 10, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6446826457977295
Epoch: 11, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5959007740020752
Epoch: 12, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7385647296905518
Epoch: 13, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.7521326541900635
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.6338710784912109
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.662700891494751
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5645394325256348
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7333090305328369
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6709995269775391
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6606776714324951
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6804153919219971
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6194479465484619
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6458392143249512
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.723153829574585
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 816172
model size : 12.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.328981637954712
Epoch: 1, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.333 Vali Acc: 0.225 Test Loss: 1.333 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.5520114898681641
Epoch: 2, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.170 Vali Acc: 0.450 Test Loss: 1.170 Test Acc: 0.450
Validation loss decreased (-0.224987 --> -0.449988).  Saving model ...
Epoch: 3 cost time: 0.603717565536499
Epoch: 3, Steps: 3 | Train Loss: 0.974 Vali Loss: 0.935 Vali Acc: 0.775 Test Loss: 0.935 Test Acc: 0.775
Validation loss decreased (-0.449988 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 0.5711209774017334
Epoch: 4, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.663 Vali Acc: 0.900 Test Loss: 0.663 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899993).  Saving model ...
Epoch: 5 cost time: 0.5951254367828369
Epoch: 5, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.457 Vali Acc: 0.950 Test Loss: 0.457 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.5821807384490967
Epoch: 6, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5490779876708984
Epoch: 7, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6426587104797363
Epoch: 8, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5677640438079834
Epoch: 9, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6327173709869385
Epoch: 10, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6091213226318359
Epoch: 11, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.196 Vali Acc: 0.925 Test Loss: 0.196 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7842366695404053
Epoch: 12, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.6101288795471191
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.633538007736206
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.925 Test Loss: 0.161 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7757506370544434
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.925 Test Loss: 0.166 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6220011711120605
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.925 Test Loss: 0.174 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.705615758895874
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.61893630027771
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6138951778411865
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.925 Test Loss: 0.214 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6248743534088135
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6634514331817627
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.925 Test Loss: 0.236 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7035043239593506
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6514227390289307
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 816172
model size : 12.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5847537517547607
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.332 Vali Acc: 0.225 Test Loss: 1.332 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.6559474468231201
Epoch: 2, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.183 Vali Acc: 0.475 Test Loss: 1.183 Test Acc: 0.475
Validation loss decreased (-0.224987 --> -0.474988).  Saving model ...
Epoch: 3 cost time: 0.6110799312591553
Epoch: 3, Steps: 3 | Train Loss: 0.989 Vali Loss: 0.952 Vali Acc: 0.775 Test Loss: 0.952 Test Acc: 0.775
Validation loss decreased (-0.474988 --> -0.774990).  Saving model ...
Epoch: 4 cost time: 0.6558256149291992
Epoch: 4, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.690 Vali Acc: 0.900 Test Loss: 0.690 Test Acc: 0.900
Validation loss decreased (-0.774990 --> -0.899993).  Saving model ...
Epoch: 5 cost time: 0.6855363845825195
Epoch: 5, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.5670523643493652
Epoch: 6, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.386 Vali Acc: 0.975 Test Loss: 0.386 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 7 cost time: 0.7699124813079834
Epoch: 7, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6268479824066162
Epoch: 8, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6239326000213623
Epoch: 9, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6172471046447754
Epoch: 10, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6524345874786377
Epoch: 11, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.633650541305542
Epoch: 12, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.653792142868042
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5541141033172607
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.925 Test Loss: 0.154 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.66036057472229
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.925 Test Loss: 0.160 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6013247966766357
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.925 Test Loss: 0.166 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 816172
model size : 12.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7492616176605225
Epoch: 1, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.344 Vali Acc: 0.125 Test Loss: 1.344 Test Acc: 0.125
Validation loss decreased (inf --> -0.124987).  Saving model ...
Epoch: 2 cost time: 0.6647043228149414
Epoch: 2, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.212 Vali Acc: 0.675 Test Loss: 1.212 Test Acc: 0.675
Validation loss decreased (-0.124987 --> -0.674988).  Saving model ...
Epoch: 3 cost time: 0.6781890392303467
Epoch: 3, Steps: 3 | Train Loss: 0.986 Vali Loss: 0.988 Vali Acc: 0.800 Test Loss: 0.988 Test Acc: 0.800
Validation loss decreased (-0.674988 --> -0.799990).  Saving model ...
Epoch: 4 cost time: 0.6484618186950684
Epoch: 4, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.751 Vali Acc: 0.925 Test Loss: 0.751 Test Acc: 0.925
Validation loss decreased (-0.799990 --> -0.924992).  Saving model ...
Epoch: 5 cost time: 0.6440815925598145
Epoch: 5, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.557 Vali Acc: 0.925 Test Loss: 0.557 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924994).  Saving model ...
Epoch: 6 cost time: 0.6166119575500488
Epoch: 6, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 0.723853349685669
Epoch: 7, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 0.671776533126831
Epoch: 8, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 0.6801297664642334
Epoch: 9, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 10 cost time: 0.612328290939331
Epoch: 10, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.6714112758636475
Epoch: 11, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.6950638294219971
Epoch: 12, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.5982375144958496
Epoch: 13, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5681378841400146
Epoch: 14, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6220922470092773
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.709000825881958
Epoch: 16, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6641030311584473
Epoch: 17, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.628159761428833
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7765474319458008
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6299896240234375
Epoch: 20, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6212642192840576
Epoch: 21, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6540358066558838
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 816172
model size : 12.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.485560417175293
Epoch: 1, Steps: 3 | Train Loss: 1.634 Vali Loss: 1.619 Vali Acc: 0.200 Test Loss: 1.619 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.5538709163665771
Epoch: 2, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.453 Vali Acc: 0.275 Test Loss: 1.453 Test Acc: 0.275
Validation loss decreased (-0.199984 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.5388052463531494
Epoch: 3, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.225 Vali Acc: 0.375 Test Loss: 1.225 Test Acc: 0.375
Validation loss decreased (-0.274985 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.5474543571472168
Epoch: 4, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.374988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.5847597122192383
Epoch: 5, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
Validation loss decreased (-0.599989 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.6158478260040283
Epoch: 6, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.6491997241973877
Epoch: 7, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.514 Vali Acc: 0.925 Test Loss: 0.514 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 0.5373332500457764
Epoch: 8, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.447 Vali Acc: 0.925 Test Loss: 0.447 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 0.5560891628265381
Epoch: 9, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 0.652773380279541
Epoch: 10, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 0.6498262882232666
Epoch: 11, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 0.5376904010772705
Epoch: 12, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 0.5466113090515137
Epoch: 13, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 0.6304433345794678
Epoch: 14, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.5574817657470703
Epoch: 15, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 0.6108088493347168
Epoch: 16, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.593087911605835
Epoch: 17, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 0.6861188411712646
Epoch: 18, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5377676486968994
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5887844562530518
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5016818046569824
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6285655498504639
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5048191547393799
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5414993762969971
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6880521774291992
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5172953605651855
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5261821746826172
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1292844
model size : 9.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4895639419555664
Epoch: 1, Steps: 3 | Train Loss: 1.637 Vali Loss: 1.603 Vali Acc: 0.175 Test Loss: 1.603 Test Acc: 0.175
Validation loss decreased (inf --> -0.174984).  Saving model ...
Epoch: 2 cost time: 0.5299010276794434
Epoch: 2, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.444 Vali Acc: 0.275 Test Loss: 1.444 Test Acc: 0.275
Validation loss decreased (-0.174984 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6209173202514648
Epoch: 3, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.274986 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.5368351936340332
Epoch: 4, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.5668959617614746
Epoch: 5, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.907 Vali Acc: 0.775 Test Loss: 0.907 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.5226700305938721
Epoch: 6, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 0.6081628799438477
Epoch: 7, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.524 Vali Acc: 0.925 Test Loss: 0.524 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 0.538527250289917
Epoch: 8, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.434 Vali Acc: 0.950 Test Loss: 0.434 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.6255764961242676
Epoch: 9, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6753759384155273
Epoch: 10, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5870361328125
Epoch: 11, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6654825210571289
Epoch: 12, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5896055698394775
Epoch: 13, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6851089000701904
Epoch: 14, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5785317420959473
Epoch: 15, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6463203430175781
Epoch: 16, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6117844581604004
Epoch: 17, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6573965549468994
Epoch: 18, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1292844
model size : 9.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.485537528991699
Epoch: 1, Steps: 3 | Train Loss: 1.592 Vali Loss: 1.541 Vali Acc: 0.300 Test Loss: 1.541 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.5707879066467285
Epoch: 2, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.398 Vali Acc: 0.350 Test Loss: 1.398 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.599308967590332
Epoch: 3, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.190 Vali Acc: 0.575 Test Loss: 1.190 Test Acc: 0.575
Validation loss decreased (-0.349986 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.6027388572692871
Epoch: 4, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.6400139331817627
Epoch: 5, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.857 Vali Acc: 0.775 Test Loss: 0.857 Test Acc: 0.775
Validation loss decreased (-0.599990 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.5393881797790527
Epoch: 6, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 0.6276247501373291
Epoch: 7, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.502 Vali Acc: 0.950 Test Loss: 0.502 Test Acc: 0.950
Validation loss decreased (-0.824993 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.6260857582092285
Epoch: 8, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.589271068572998
Epoch: 9, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.352 Vali Acc: 0.975 Test Loss: 0.352 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 0.5868275165557861
Epoch: 10, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.7072360515594482
Epoch: 11, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.6190237998962402
Epoch: 12, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.657623291015625
Epoch: 13, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6087567806243896
Epoch: 14, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6470866203308105
Epoch: 15, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6167805194854736
Epoch: 16, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6191074848175049
Epoch: 17, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6098182201385498
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5872230529785156
Epoch: 19, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.669295072555542
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.925 Test Loss: 0.191 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.655585527420044
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1292844
model size : 9.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.589831829071045
Epoch: 1, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.496 Vali Acc: 0.275 Test Loss: 1.496 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.6965363025665283
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.378 Vali Acc: 0.425 Test Loss: 1.378 Test Acc: 0.425
Validation loss decreased (-0.274985 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5614190101623535
Epoch: 3, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.192 Vali Acc: 0.600 Test Loss: 1.192 Test Acc: 0.600
Validation loss decreased (-0.424986 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.5526444911956787
Epoch: 4, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674990).  Saving model ...
Epoch: 5 cost time: 0.5704867839813232
Epoch: 5, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774992).  Saving model ...
Epoch: 6 cost time: 0.6129076480865479
Epoch: 6, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.685 Vali Acc: 0.900 Test Loss: 0.685 Test Acc: 0.900
Validation loss decreased (-0.774992 --> -0.899993).  Saving model ...
Epoch: 7 cost time: 0.6156466007232666
Epoch: 7, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.562 Vali Acc: 0.950 Test Loss: 0.562 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.5618925094604492
Epoch: 8, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5609955787658691
Epoch: 9, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5182805061340332
Epoch: 10, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6008696556091309
Epoch: 11, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.309 Vali Acc: 0.975 Test Loss: 0.309 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.5729799270629883
Epoch: 12, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.5143241882324219
Epoch: 13, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.5341191291809082
Epoch: 14, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.5437133312225342
Epoch: 15, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6070067882537842
Epoch: 16, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6280031204223633
Epoch: 17, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.509044885635376
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6267774105072021
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.925 Test Loss: 0.192 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5981056690216064
Epoch: 20, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.925 Test Loss: 0.192 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5930557250976562
Epoch: 21, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.925 Test Loss: 0.191 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6740858554840088
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.925 Test Loss: 0.192 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5897700786590576
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6559543609619141
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1292844
model size : 9.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.336242198944092
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.372 Vali Acc: 0.225 Test Loss: 1.372 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5457396507263184
Epoch: 2, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.252 Vali Acc: 0.275 Test Loss: 1.252 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.6520397663116455
Epoch: 3, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.080 Vali Acc: 0.325 Test Loss: 1.080 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324989).  Saving model ...
Epoch: 4 cost time: 0.5448424816131592
Epoch: 4, Steps: 3 | Train Loss: 0.882 Vali Loss: 0.906 Vali Acc: 0.800 Test Loss: 0.906 Test Acc: 0.800
Validation loss decreased (-0.324989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.5160284042358398
Epoch: 5, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.724 Vali Acc: 0.875 Test Loss: 0.724 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 0.5468940734863281
Epoch: 6, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.562 Vali Acc: 0.950 Test Loss: 0.562 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 0.5532896518707275
Epoch: 7, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.451 Vali Acc: 0.950 Test Loss: 0.451 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.5140261650085449
Epoch: 8, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.5610580444335938
Epoch: 9, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5989372730255127
Epoch: 10, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5741019248962402
Epoch: 11, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5819103717803955
Epoch: 12, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5609452724456787
Epoch: 13, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6927013397216797
Epoch: 14, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.611854076385498
Epoch: 15, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7250630855560303
Epoch: 16, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5925600528717041
Epoch: 17, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6541173458099365
Epoch: 18, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 768556
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.463493824005127
Epoch: 1, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.373 Vali Acc: 0.225 Test Loss: 1.373 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.6381056308746338
Epoch: 2, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.257 Vali Acc: 0.325 Test Loss: 1.257 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.6249382495880127
Epoch: 3, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.084 Vali Acc: 0.450 Test Loss: 1.084 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449989).  Saving model ...
Epoch: 4 cost time: 0.6230313777923584
Epoch: 4, Steps: 3 | Train Loss: 0.909 Vali Loss: 0.910 Vali Acc: 0.825 Test Loss: 0.910 Test Acc: 0.825
Validation loss decreased (-0.449989 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 0.532470703125
Epoch: 5, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.729 Vali Acc: 0.875 Test Loss: 0.729 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 0.5506410598754883
Epoch: 6, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.567 Vali Acc: 0.950 Test Loss: 0.567 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 0.6407325267791748
Epoch: 7, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 0.6800456047058105
Epoch: 8, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.6451997756958008
Epoch: 9, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.5784952640533447
Epoch: 10, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.6083769798278809
Epoch: 11, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 12 cost time: 0.6150763034820557
Epoch: 12, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.214 Vali Acc: 0.925 Test Loss: 0.214 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.696230411529541
Epoch: 13, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.6061069965362549
Epoch: 14, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6017580032348633
Epoch: 15, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6649808883666992
Epoch: 16, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6671462059020996
Epoch: 17, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6130805015563965
Epoch: 18, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6319398880004883
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5764105319976807
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6598532199859619
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6246817111968994
Epoch: 22, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6241269111633301
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 768556
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5194547176361084
Epoch: 1, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.350 Vali Acc: 0.200 Test Loss: 1.350 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.6743001937866211
Epoch: 2, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.242 Vali Acc: 0.225 Test Loss: 1.242 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224988).  Saving model ...
Epoch: 3 cost time: 0.6216559410095215
Epoch: 3, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.078 Vali Acc: 0.525 Test Loss: 1.078 Test Acc: 0.525
Validation loss decreased (-0.224988 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 0.576829195022583
Epoch: 4, Steps: 3 | Train Loss: 0.929 Vali Loss: 0.908 Vali Acc: 0.800 Test Loss: 0.908 Test Acc: 0.800
Validation loss decreased (-0.524989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.6143531799316406
Epoch: 5, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.731 Vali Acc: 0.900 Test Loss: 0.731 Test Acc: 0.900
Validation loss decreased (-0.799991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.5939183235168457
Epoch: 6, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.572 Vali Acc: 0.975 Test Loss: 0.572 Test Acc: 0.975
Validation loss decreased (-0.899993 --> -0.974994).  Saving model ...
Epoch: 7 cost time: 0.7129223346710205
Epoch: 7, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.452 Vali Acc: 0.975 Test Loss: 0.452 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 0.5983438491821289
Epoch: 8, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.6499440670013428
Epoch: 9, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.326 Vali Acc: 0.975 Test Loss: 0.326 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.5945489406585693
Epoch: 10, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.677605390548706
Epoch: 11, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.6738131046295166
Epoch: 12, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7035720348358154
Epoch: 13, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6574931144714355
Epoch: 14, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7142491340637207
Epoch: 15, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6331143379211426
Epoch: 16, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6443984508514404
Epoch: 17, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7622005939483643
Epoch: 18, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.925 Test Loss: 0.175 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7253482341766357
Epoch: 19, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.925 Test Loss: 0.177 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6338479518890381
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.925 Test Loss: 0.179 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6341960430145264
Epoch: 21, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.925 Test Loss: 0.179 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 768556
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.480175495147705
Epoch: 1, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.356 Vali Acc: 0.225 Test Loss: 1.356 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5641844272613525
Epoch: 2, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.256 Vali Acc: 0.275 Test Loss: 1.256 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.6020779609680176
Epoch: 3, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.097 Vali Acc: 0.525 Test Loss: 1.097 Test Acc: 0.525
Validation loss decreased (-0.274987 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 0.5878703594207764
Epoch: 4, Steps: 3 | Train Loss: 0.903 Vali Loss: 0.929 Vali Acc: 0.800 Test Loss: 0.929 Test Acc: 0.800
Validation loss decreased (-0.524989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.6418666839599609
Epoch: 5, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 0.6656804084777832
Epoch: 6, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.626 Vali Acc: 0.875 Test Loss: 0.626 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 0.5745742321014404
Epoch: 7, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.5957541465759277
Epoch: 8, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.6504945755004883
Epoch: 9, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.6461391448974609
Epoch: 10, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6556069850921631
Epoch: 11, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.6136457920074463
Epoch: 12, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.63027024269104
Epoch: 13, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.6272199153900146
Epoch: 14, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.6616382598876953
Epoch: 15, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.6915085315704346
Epoch: 16, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.7042396068572998
Epoch: 17, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5869722366333008
Epoch: 18, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.181 Vali Acc: 0.925 Test Loss: 0.181 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7048115730285645
Epoch: 19, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6594858169555664
Epoch: 20, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6792068481445312
Epoch: 21, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6699631214141846
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.184 Vali Acc: 0.925 Test Loss: 0.184 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6947689056396484
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.925 Test Loss: 0.182 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7262070178985596
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.925 Test Loss: 0.182 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6375408172607422
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.925 Test Loss: 0.183 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.62766432762146
Epoch: 26, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.925 Test Loss: 0.183 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 768556
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4652998447418213
Epoch: 1, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.383 Vali Acc: 0.225 Test Loss: 1.383 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5726561546325684
Epoch: 2, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.249 Vali Acc: 0.375 Test Loss: 1.249 Test Acc: 0.375
Validation loss decreased (-0.224986 --> -0.374988).  Saving model ...
Epoch: 3 cost time: 0.5822489261627197
Epoch: 3, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.069 Vali Acc: 0.700 Test Loss: 1.069 Test Acc: 0.700
Validation loss decreased (-0.374988 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 0.6508622169494629
Epoch: 4, Steps: 3 | Train Loss: 0.838 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 0.6200747489929199
Epoch: 5, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.713 Vali Acc: 0.900 Test Loss: 0.713 Test Acc: 0.900
Validation loss decreased (-0.749991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.6450643539428711
Epoch: 6, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 0.5422213077545166
Epoch: 7, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 0.5505943298339844
Epoch: 8, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.5504059791564941
Epoch: 9, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5755059719085693
Epoch: 10, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.6500520706176758
Epoch: 11, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.5448415279388428
Epoch: 12, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.7324140071868896
Epoch: 13, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.556492805480957
Epoch: 14, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6650121212005615
Epoch: 15, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5956974029541016
Epoch: 16, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.5786995887756348
Epoch: 17, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 0.5698955059051514
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5950024127960205
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5795900821685791
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5913035869598389
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6820952892303467
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6179702281951904
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6107254028320312
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6357488632202148
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6517007350921631
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.66426682472229
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 506412
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5041728019714355
Epoch: 1, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.353 Vali Acc: 0.350 Test Loss: 1.353 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6103005409240723
Epoch: 2, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.221 Vali Acc: 0.525 Test Loss: 1.221 Test Acc: 0.525
Validation loss decreased (-0.349986 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 0.6014795303344727
Epoch: 3, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.043 Vali Acc: 0.775 Test Loss: 1.043 Test Acc: 0.775
Validation loss decreased (-0.524988 --> -0.774990).  Saving model ...
Epoch: 4 cost time: 0.5956554412841797
Epoch: 4, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.867 Vali Acc: 0.850 Test Loss: 0.867 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 0.706183671951294
Epoch: 5, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.697 Vali Acc: 0.900 Test Loss: 0.697 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.5828714370727539
Epoch: 6, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.536 Vali Acc: 0.950 Test Loss: 0.536 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 0.5823037624359131
Epoch: 7, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 0.5962402820587158
Epoch: 8, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.6442580223083496
Epoch: 9, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5918118953704834
Epoch: 10, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5696513652801514
Epoch: 11, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6185951232910156
Epoch: 12, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6648061275482178
Epoch: 13, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.6037523746490479
Epoch: 14, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.6037774085998535
Epoch: 15, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 16 cost time: 0.5969328880310059
Epoch: 16, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.5478873252868652
Epoch: 17, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.925 Test Loss: 0.168 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6087989807128906
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.925 Test Loss: 0.169 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5897624492645264
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.925 Test Loss: 0.173 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5176372528076172
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7047803401947021
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5936596393585205
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6853721141815186
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5330650806427002
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5988936424255371
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6475980281829834
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 506412
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4708945751190186
Epoch: 1, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.64512038230896
Epoch: 2, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.215 Vali Acc: 0.575 Test Loss: 1.215 Test Acc: 0.575
Validation loss decreased (-0.399987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 0.5719015598297119
Epoch: 3, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.044 Vali Acc: 0.775 Test Loss: 1.044 Test Acc: 0.775
Validation loss decreased (-0.574988 --> -0.774990).  Saving model ...
Epoch: 4 cost time: 0.5963151454925537
Epoch: 4, Steps: 3 | Train Loss: 0.881 Vali Loss: 0.876 Vali Acc: 0.850 Test Loss: 0.876 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 0.5798919200897217
Epoch: 5, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.706 Vali Acc: 0.900 Test Loss: 0.706 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.591625452041626
Epoch: 6, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.547 Vali Acc: 0.950 Test Loss: 0.547 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 0.5620806217193604
Epoch: 7, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 0.5818309783935547
Epoch: 8, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.552717924118042
Epoch: 9, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5912659168243408
Epoch: 10, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.5648839473724365
Epoch: 11, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6106560230255127
Epoch: 12, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.215 Vali Acc: 0.925 Test Loss: 0.215 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5743355751037598
Epoch: 13, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.6482086181640625
Epoch: 14, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.6007156372070312
Epoch: 15, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 16 cost time: 0.5589125156402588
Epoch: 16, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.5086402893066406
Epoch: 17, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.178 Vali Acc: 0.925 Test Loss: 0.178 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5899109840393066
Epoch: 18, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.179 Vali Acc: 0.925 Test Loss: 0.179 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5702557563781738
Epoch: 19, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.925 Test Loss: 0.180 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6407852172851562
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.181 Vali Acc: 0.925 Test Loss: 0.181 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6450634002685547
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.925 Test Loss: 0.182 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6308305263519287
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5439226627349854
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5699543952941895
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.925 Test Loss: 0.186 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6109654903411865
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6157345771789551
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 506412
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2081801891326904
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.5694620609283447
Epoch: 2, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.219 Vali Acc: 0.625 Test Loss: 1.219 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 0.49382662773132324
Epoch: 3, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.057 Vali Acc: 0.675 Test Loss: 1.057 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 4 cost time: 0.5776324272155762
Epoch: 4, Steps: 3 | Train Loss: 0.897 Vali Loss: 0.897 Vali Acc: 0.850 Test Loss: 0.897 Test Acc: 0.850
Validation loss decreased (-0.674989 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 0.5774664878845215
Epoch: 5, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.747 Vali Acc: 0.925 Test Loss: 0.747 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924993).  Saving model ...
Epoch: 6 cost time: 0.5786521434783936
Epoch: 6, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.608 Vali Acc: 0.925 Test Loss: 0.608 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.5053458213806152
Epoch: 7, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 0.6095218658447266
Epoch: 8, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5679714679718018
Epoch: 9, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.6112253665924072
Epoch: 10, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.5853068828582764
Epoch: 11, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6085057258605957
Epoch: 12, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6613361835479736
Epoch: 13, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6549346446990967
Epoch: 14, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.223 Vali Acc: 0.925 Test Loss: 0.223 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.543738603591919
Epoch: 15, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5646162033081055
Epoch: 16, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.205 Vali Acc: 0.925 Test Loss: 0.205 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5662977695465088
Epoch: 17, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.900 Test Loss: 0.205 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5873832702636719
Epoch: 18, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.900 Test Loss: 0.204 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5901527404785156
Epoch: 19, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.900 Test Loss: 0.202 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5847399234771729
Epoch: 20, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.900 Test Loss: 0.200 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 506412
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5993733406066895
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.247 Vali Acc: 0.450 Test Loss: 1.247 Test Acc: 0.450
Validation loss decreased (inf --> -0.449988).  Saving model ...
Epoch: 2 cost time: 0.6066787242889404
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.159 Vali Acc: 0.525 Test Loss: 1.159 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 0.6163802146911621
Epoch: 3, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.008 Vali Acc: 0.575 Test Loss: 1.008 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574990).  Saving model ...
Epoch: 4 cost time: 0.6577701568603516
Epoch: 4, Steps: 3 | Train Loss: 0.859 Vali Loss: 0.834 Vali Acc: 0.825 Test Loss: 0.834 Test Acc: 0.825
Validation loss decreased (-0.574990 --> -0.824992).  Saving model ...
Epoch: 5 cost time: 0.5711514949798584
Epoch: 5, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.666 Vali Acc: 0.925 Test Loss: 0.666 Test Acc: 0.925
Validation loss decreased (-0.824992 --> -0.924993).  Saving model ...
Epoch: 6 cost time: 0.6679461002349854
Epoch: 6, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.522 Vali Acc: 0.950 Test Loss: 0.522 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 0.6361401081085205
Epoch: 7, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 8 cost time: 0.6057441234588623
Epoch: 8, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.6046605110168457
Epoch: 9, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 0.6094927787780762
Epoch: 10, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5259053707122803
Epoch: 11, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.6629080772399902
Epoch: 12, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5841572284698486
Epoch: 13, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5435645580291748
Epoch: 14, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5507657527923584
Epoch: 15, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6022634506225586
Epoch: 16, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5202133655548096
Epoch: 17, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5280780792236328
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5990738868713379
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6178481578826904
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5929775238037109
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 375340
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.436286449432373
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (inf --> -0.474988).  Saving model ...
Epoch: 2 cost time: 0.5055315494537354
Epoch: 2, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.145 Vali Acc: 0.575 Test Loss: 1.145 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574989).  Saving model ...
Epoch: 3 cost time: 0.5242693424224854
Epoch: 3, Steps: 3 | Train Loss: 1.068 Vali Loss: 0.997 Vali Acc: 0.625 Test Loss: 0.997 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 0.6121647357940674
Epoch: 4, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
Validation loss decreased (-0.624990 --> -0.774992).  Saving model ...
Epoch: 5 cost time: 0.5435287952423096
Epoch: 5, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.662 Vali Acc: 0.900 Test Loss: 0.662 Test Acc: 0.900
Validation loss decreased (-0.774992 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.5699293613433838
Epoch: 6, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.518 Vali Acc: 0.950 Test Loss: 0.518 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 0.6070771217346191
Epoch: 7, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.429 Vali Acc: 0.975 Test Loss: 0.429 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 8 cost time: 0.5301151275634766
Epoch: 8, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.374 Vali Acc: 0.975 Test Loss: 0.374 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.5326070785522461
Epoch: 9, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.5438992977142334
Epoch: 10, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6086685657501221
Epoch: 11, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.49730539321899414
Epoch: 12, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.5948407649993896
Epoch: 13, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.204 Vali Acc: 0.925 Test Loss: 0.204 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6229655742645264
Epoch: 14, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6504502296447754
Epoch: 15, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5507164001464844
Epoch: 16, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5973737239837646
Epoch: 17, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5243699550628662
Epoch: 18, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.58176589012146
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6270830631256104
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6591286659240723
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5515079498291016
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 375340
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.419900417327881
Epoch: 1, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.299 Vali Acc: 0.475 Test Loss: 1.299 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.6032004356384277
Epoch: 2, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.207 Vali Acc: 0.575 Test Loss: 1.207 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 0.5654716491699219
Epoch: 3, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.053 Vali Acc: 0.625 Test Loss: 1.053 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 0.6300716400146484
Epoch: 4, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.876 Vali Acc: 0.850 Test Loss: 0.876 Test Acc: 0.850
Validation loss decreased (-0.624989 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 0.5998082160949707
Epoch: 5, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.708 Vali Acc: 0.900 Test Loss: 0.708 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.5684030055999756
Epoch: 6, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.559 Vali Acc: 0.925 Test Loss: 0.559 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.5763225555419922
Epoch: 7, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.466 Vali Acc: 0.975 Test Loss: 0.466 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 0.5325496196746826
Epoch: 8, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.396 Vali Acc: 0.975 Test Loss: 0.396 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.583223819732666
Epoch: 9, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.5388729572296143
Epoch: 10, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.586585283279419
Epoch: 11, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.586517333984375
Epoch: 12, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.563739538192749
Epoch: 13, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5616247653961182
Epoch: 14, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.196 Vali Acc: 0.925 Test Loss: 0.196 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5991654396057129
Epoch: 15, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7154867649078369
Epoch: 16, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5885357856750488
Epoch: 17, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6179831027984619
Epoch: 18, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6324846744537354
Epoch: 19, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.925 Test Loss: 0.217 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.660830020904541
Epoch: 20, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.900 Test Loss: 0.210 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5995309352874756
Epoch: 21, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.900 Test Loss: 0.205 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 375340
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9449961185455322
Epoch: 1, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.344 Vali Acc: 0.350 Test Loss: 1.344 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.6039736270904541
Epoch: 2, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.254 Vali Acc: 0.425 Test Loss: 1.254 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.714057445526123
Epoch: 3, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.096 Vali Acc: 0.475 Test Loss: 1.096 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474989).  Saving model ...
Epoch: 4 cost time: 0.6476037502288818
Epoch: 4, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.930 Vali Acc: 0.800 Test Loss: 0.930 Test Acc: 0.800
Validation loss decreased (-0.474989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.6230144500732422
Epoch: 5, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.772 Vali Acc: 0.900 Test Loss: 0.772 Test Acc: 0.900
Validation loss decreased (-0.799991 --> -0.899992).  Saving model ...
Epoch: 6 cost time: 0.5583336353302002
Epoch: 6, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6386508941650391
Epoch: 7, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6036193370819092
Epoch: 8, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6131925582885742
Epoch: 9, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 0.5441699028015137
Epoch: 10, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.5038719177246094
Epoch: 11, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5885820388793945
Epoch: 12, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5528419017791748
Epoch: 13, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5654253959655762
Epoch: 14, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.6007170677185059
Epoch: 15, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 16 cost time: 0.6438624858856201
Epoch: 16, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.5524630546569824
Epoch: 17, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 0.5726232528686523
Epoch: 18, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.925 Test Loss: 0.192 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5891356468200684
Epoch: 19, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.925 Test Loss: 0.191 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5340514183044434
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.900 Test Loss: 0.195 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5846621990203857
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.900 Test Loss: 0.200 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5549604892730713
Epoch: 22, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.900 Test Loss: 0.200 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5826904773712158
Epoch: 23, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.900 Test Loss: 0.199 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5871434211730957
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.900 Test Loss: 0.198 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6725728511810303
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.900 Test Loss: 0.197 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6157512664794922
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.900 Test Loss: 0.196 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5794670581817627
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.900 Test Loss: 0.193 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 375340
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5613324642181396
Epoch: 1, Steps: 3 | Train Loss: 1.579 Vali Loss: 1.446 Vali Acc: 0.250 Test Loss: 1.446 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5931079387664795
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.355 Vali Acc: 0.250 Test Loss: 1.355 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.727576732635498
Epoch: 3, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.171 Vali Acc: 0.375 Test Loss: 1.171 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.6612997055053711
Epoch: 4, Steps: 3 | Train Loss: 0.940 Vali Loss: 0.982 Vali Acc: 0.525 Test Loss: 0.982 Test Acc: 0.525
Validation loss decreased (-0.374988 --> -0.524990).  Saving model ...
Epoch: 5 cost time: 0.6105904579162598
Epoch: 5, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.802 Vali Acc: 0.825 Test Loss: 0.802 Test Acc: 0.825
Validation loss decreased (-0.524990 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 0.5666749477386475
Epoch: 6, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.657 Vali Acc: 0.875 Test Loss: 0.657 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.623281717300415
Epoch: 7, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.557 Vali Acc: 0.900 Test Loss: 0.557 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 8 cost time: 0.5674381256103516
Epoch: 8, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 9 cost time: 0.5571885108947754
Epoch: 9, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 0.5940549373626709
Epoch: 10, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 11 cost time: 0.7282016277313232
Epoch: 11, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 12 cost time: 0.5721559524536133
Epoch: 12, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 0.5612683296203613
Epoch: 13, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5639455318450928
Epoch: 14, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6092736721038818
Epoch: 15, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5425224304199219
Epoch: 16, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6246364116668701
Epoch: 17, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 0.5886144638061523
Epoch: 18, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 0.6285502910614014
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5751960277557373
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5823783874511719
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5717425346374512
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.530510425567627
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5767362117767334
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7255384922027588
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5581667423248291
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6166326999664307
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6834487915039062
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 309804
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5899698734283447
Epoch: 1, Steps: 3 | Train Loss: 1.557 Vali Loss: 1.451 Vali Acc: 0.250 Test Loss: 1.451 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.6569488048553467
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.368 Vali Acc: 0.275 Test Loss: 1.368 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6254491806030273
Epoch: 3, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.197 Vali Acc: 0.375 Test Loss: 1.197 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.6599612236022949
Epoch: 4, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.008 Vali Acc: 0.500 Test Loss: 1.008 Test Acc: 0.500
Validation loss decreased (-0.374988 --> -0.499990).  Saving model ...
Epoch: 5 cost time: 0.5562331676483154
Epoch: 5, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.817 Vali Acc: 0.850 Test Loss: 0.817 Test Acc: 0.850
Validation loss decreased (-0.499990 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 0.6693408489227295
Epoch: 6, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 7 cost time: 0.5710258483886719
Epoch: 7, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.7205407619476318
Epoch: 8, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 9 cost time: 0.6710948944091797
Epoch: 9, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.6806201934814453
Epoch: 10, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.6359529495239258
Epoch: 11, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.5949888229370117
Epoch: 12, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.6819877624511719
Epoch: 13, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.6991868019104004
Epoch: 14, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7196731567382812
Epoch: 15, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7583322525024414
Epoch: 16, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6307356357574463
Epoch: 17, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7011106014251709
Epoch: 18, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.925 Test Loss: 0.234 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6631274223327637
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.925 Test Loss: 0.232 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6696491241455078
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.232 Vali Acc: 0.925 Test Loss: 0.232 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6185336112976074
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6845383644104004
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6451101303100586
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 309804
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.564617872238159
Epoch: 1, Steps: 3 | Train Loss: 1.526 Vali Loss: 1.435 Vali Acc: 0.225 Test Loss: 1.435 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5595440864562988
Epoch: 2, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.351 Vali Acc: 0.275 Test Loss: 1.351 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5645196437835693
Epoch: 3, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
Validation loss decreased (-0.274986 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.7151041030883789
Epoch: 4, Steps: 3 | Train Loss: 0.962 Vali Loss: 0.991 Vali Acc: 0.550 Test Loss: 0.991 Test Acc: 0.550
Validation loss decreased (-0.399988 --> -0.549990).  Saving model ...
Epoch: 5 cost time: 0.5530543327331543
Epoch: 5, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.802 Vali Acc: 0.875 Test Loss: 0.802 Test Acc: 0.875
Validation loss decreased (-0.549990 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.5856499671936035
Epoch: 6, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.635 Vali Acc: 0.975 Test Loss: 0.635 Test Acc: 0.975
Validation loss decreased (-0.874992 --> -0.974994).  Saving model ...
Epoch: 7 cost time: 0.5843205451965332
Epoch: 7, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.528 Vali Acc: 0.975 Test Loss: 0.528 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 0.6122255325317383
Epoch: 8, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.435 Vali Acc: 0.975 Test Loss: 0.435 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.6427679061889648
Epoch: 9, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.569119930267334
Epoch: 10, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7235560417175293
Epoch: 11, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.625819206237793
Epoch: 12, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.661517858505249
Epoch: 13, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6142337322235107
Epoch: 14, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7022123336791992
Epoch: 15, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6587705612182617
Epoch: 16, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.636803150177002
Epoch: 17, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6605894565582275
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 309804
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.59708309173584
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.450 Vali Acc: 0.175 Test Loss: 1.450 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.5540242195129395
Epoch: 2, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.367 Vali Acc: 0.250 Test Loss: 1.367 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.6473314762115479
Epoch: 3, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
Validation loss decreased (-0.249986 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.6300079822540283
Epoch: 4, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.025 Vali Acc: 0.550 Test Loss: 1.025 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549990).  Saving model ...
Epoch: 5 cost time: 0.6228878498077393
Epoch: 5, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.848 Vali Acc: 0.875 Test Loss: 0.848 Test Acc: 0.875
Validation loss decreased (-0.549990 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.5811631679534912
Epoch: 6, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.703 Vali Acc: 0.875 Test Loss: 0.703 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.6628367900848389
Epoch: 7, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.589 Vali Acc: 0.925 Test Loss: 0.589 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 8 cost time: 0.6765038967132568
Epoch: 8, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.492 Vali Acc: 0.925 Test Loss: 0.492 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 9 cost time: 0.7652840614318848
Epoch: 9, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 0.6230950355529785
Epoch: 10, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 0.5670576095581055
Epoch: 11, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.5933170318603516
Epoch: 12, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.597813606262207
Epoch: 13, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.5695641040802002
Epoch: 14, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5980210304260254
Epoch: 15, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5593791007995605
Epoch: 16, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6475193500518799
Epoch: 17, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6823186874389648
Epoch: 18, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6334607601165771
Epoch: 19, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.217 Vali Acc: 0.925 Test Loss: 0.217 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6306705474853516
Epoch: 20, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6632952690124512
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.925 Test Loss: 0.214 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6903455257415771
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6239278316497803
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 309804
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6249380111694336
Epoch: 1, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.381 Vali Acc: 0.425 Test Loss: 1.381 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.548069953918457
Epoch: 2, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.242 Vali Acc: 0.425 Test Loss: 1.242 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424988).  Saving model ...
Epoch: 3 cost time: 0.6023674011230469
Epoch: 3, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.055 Vali Acc: 0.525 Test Loss: 1.055 Test Acc: 0.525
Validation loss decreased (-0.424988 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 0.5600831508636475
Epoch: 4, Steps: 3 | Train Loss: 0.859 Vali Loss: 0.879 Vali Acc: 0.800 Test Loss: 0.879 Test Acc: 0.800
Validation loss decreased (-0.524989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.6059684753417969
Epoch: 5, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.701 Vali Acc: 0.825 Test Loss: 0.701 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 0.6158797740936279
Epoch: 6, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.5168755054473877
Epoch: 7, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.484 Vali Acc: 0.925 Test Loss: 0.484 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 0.5820722579956055
Epoch: 8, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 0.5728724002838135
Epoch: 9, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6227612495422363
Epoch: 10, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5208930969238281
Epoch: 11, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.6130251884460449
Epoch: 12, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.5959439277648926
Epoch: 13, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6231296062469482
Epoch: 14, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.216 Vali Acc: 0.925 Test Loss: 0.216 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6236810684204102
Epoch: 15, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.925 Test Loss: 0.208 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6214756965637207
Epoch: 16, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6619274616241455
Epoch: 17, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5880625247955322
Epoch: 18, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6126391887664795
Epoch: 19, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5781223773956299
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5945441722869873
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5837054252624512
Epoch: 22, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 277036
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3584158420562744
Epoch: 1, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.344 Vali Acc: 0.425 Test Loss: 1.344 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.6411089897155762
Epoch: 2, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.216 Vali Acc: 0.525 Test Loss: 1.216 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 0.65474534034729
Epoch: 3, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.728837251663208
Epoch: 4, Steps: 3 | Train Loss: 0.841 Vali Loss: 0.857 Vali Acc: 0.850 Test Loss: 0.857 Test Acc: 0.850
Validation loss decreased (-0.599990 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 0.6718237400054932
Epoch: 5, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.683 Vali Acc: 0.875 Test Loss: 0.683 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 0.6894612312316895
Epoch: 6, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.743690013885498
Epoch: 7, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 0.7454736232757568
Epoch: 8, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.7128310203552246
Epoch: 9, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.6813931465148926
Epoch: 10, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.7209875583648682
Epoch: 11, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.6445727348327637
Epoch: 12, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.6867129802703857
Epoch: 13, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.701751708984375
Epoch: 14, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.805229663848877
Epoch: 15, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.189 Vali Acc: 0.925 Test Loss: 0.189 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7468187808990479
Epoch: 16, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.925 Test Loss: 0.186 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7471561431884766
Epoch: 17, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.925 Test Loss: 0.188 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6590771675109863
Epoch: 18, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.925 Test Loss: 0.192 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7882132530212402
Epoch: 19, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7359490394592285
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6725096702575684
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.925 Test Loss: 0.205 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6873748302459717
Epoch: 22, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.925 Test Loss: 0.208 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 277036
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.644282817840576
Epoch: 1, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.5733468532562256
Epoch: 2, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.6351273059844971
Epoch: 3, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.034 Vali Acc: 0.650 Test Loss: 1.034 Test Acc: 0.650
Validation loss decreased (-0.499988 --> -0.649990).  Saving model ...
Epoch: 4 cost time: 0.5609607696533203
Epoch: 4, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.860 Vali Acc: 0.875 Test Loss: 0.860 Test Acc: 0.875
Validation loss decreased (-0.649990 --> -0.874991).  Saving model ...
Epoch: 5 cost time: 0.6108639240264893
Epoch: 5, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.690 Vali Acc: 0.900 Test Loss: 0.690 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.60135817527771
Epoch: 6, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.559 Vali Acc: 0.925 Test Loss: 0.559 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.6987173557281494
Epoch: 7, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 0.6206851005554199
Epoch: 8, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.382 Vali Acc: 0.975 Test Loss: 0.382 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.6718175411224365
Epoch: 9, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.6655819416046143
Epoch: 10, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6522421836853027
Epoch: 11, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6496686935424805
Epoch: 12, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.234 Vali Acc: 0.925 Test Loss: 0.234 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6689732074737549
Epoch: 13, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6681663990020752
Epoch: 14, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6691384315490723
Epoch: 15, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6476871967315674
Epoch: 16, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5951814651489258
Epoch: 17, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.925 Test Loss: 0.186 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6166520118713379
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.925 Test Loss: 0.189 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5718908309936523
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.925 Test Loss: 0.193 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 277036
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.638662576675415
Epoch: 1, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.333 Vali Acc: 0.475 Test Loss: 1.333 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.6434385776519775
Epoch: 2, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.6675357818603516
Epoch: 3, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.062 Vali Acc: 0.625 Test Loss: 1.062 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 0.6407711505889893
Epoch: 4, Steps: 3 | Train Loss: 0.835 Vali Loss: 0.896 Vali Acc: 0.825 Test Loss: 0.896 Test Acc: 0.825
Validation loss decreased (-0.624989 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 0.6693272590637207
Epoch: 5, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.738 Vali Acc: 0.925 Test Loss: 0.738 Test Acc: 0.925
Validation loss decreased (-0.824991 --> -0.924993).  Saving model ...
Epoch: 6 cost time: 0.7035477161407471
Epoch: 6, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5914335250854492
Epoch: 7, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6058876514434814
Epoch: 8, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5600330829620361
Epoch: 9, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6293065547943115
Epoch: 10, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.6228280067443848
Epoch: 11, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.5912787914276123
Epoch: 12, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.6708006858825684
Epoch: 13, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.5821537971496582
Epoch: 14, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.6174831390380859
Epoch: 15, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.205 Vali Acc: 0.925 Test Loss: 0.205 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.641059160232544
Epoch: 16, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5621128082275391
Epoch: 17, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.196 Vali Acc: 0.925 Test Loss: 0.196 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6187214851379395
Epoch: 18, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.925 Test Loss: 0.191 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6094532012939453
Epoch: 19, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.189 Vali Acc: 0.925 Test Loss: 0.189 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5957763195037842
Epoch: 20, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.188 Vali Acc: 0.925 Test Loss: 0.188 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5756499767303467
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6341884136199951
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.925 Test Loss: 0.188 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5834124088287354
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.925 Test Loss: 0.189 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6490390300750732
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.6794064044952393
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.925 Test Loss: 0.193 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5948140621185303
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.925 Test Loss: 0.196 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5552301406860352
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6737427711486816
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.925 Test Loss: 0.198 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.675269603729248
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6152801513671875
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5805814266204834
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.925 Test Loss: 0.190 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6473612785339355
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6324763298034668
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.925 Test Loss: 0.186 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7396531105041504
Epoch: 34, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.925 Test Loss: 0.186 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 277036
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5515503883361816
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.365 Vali Acc: 0.275 Test Loss: 1.365 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6942141056060791
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.273 Vali Acc: 0.300 Test Loss: 1.273 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.5940418243408203
Epoch: 3, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.146 Vali Acc: 0.525 Test Loss: 1.146 Test Acc: 0.525
Validation loss decreased (-0.299987 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 0.63675856590271
Epoch: 4, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.024 Vali Acc: 0.625 Test Loss: 1.024 Test Acc: 0.625
Validation loss decreased (-0.524989 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 0.7342638969421387
Epoch: 5, Steps: 3 | Train Loss: 0.998 Vali Loss: 0.908 Vali Acc: 0.675 Test Loss: 0.908 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674991).  Saving model ...
Epoch: 6 cost time: 0.6416966915130615
Epoch: 6, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.674991 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.6972508430480957
Epoch: 7, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.605963945388794
Epoch: 8, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.591 Vali Acc: 0.950 Test Loss: 0.591 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.5700826644897461
Epoch: 9, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.511 Vali Acc: 0.950 Test Loss: 0.511 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.7070252895355225
Epoch: 10, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 0.5683326721191406
Epoch: 11, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.6248230934143066
Epoch: 12, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.5253527164459229
Epoch: 13, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.6068549156188965
Epoch: 14, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.6874423027038574
Epoch: 15, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.5985560417175293
Epoch: 16, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.6045010089874268
Epoch: 17, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.6338386535644531
Epoch: 18, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 0.6199870109558105
Epoch: 19, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.5564393997192383
Epoch: 20, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.5981945991516113
Epoch: 21, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.6105713844299316
Epoch: 22, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.7084755897521973
Epoch: 23, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.6309430599212646
Epoch: 24, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.6825108528137207
Epoch: 25, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.7195911407470703
Epoch: 26, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6335368156433105
Epoch: 27, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7208573818206787
Epoch: 28, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7140941619873047
Epoch: 29, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7334816455841064
Epoch: 30, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6040732860565186
Epoch: 31, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.696580171585083
Epoch: 32, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6183013916015625
Epoch: 33, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.5921609401702881
Epoch: 34, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.6543662548065186
Epoch: 35, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.615149736404419
Epoch: 36, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6925859451293945
Epoch: 37, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6293985843658447
Epoch: 38, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.5999891757965088
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.5501055717468262
Epoch: 40, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.6559875011444092
Epoch: 41, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.6499130725860596
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7040572166442871
Epoch: 43, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7003893852233887
Epoch: 44, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6623327732086182
Epoch: 45, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6827907562255859
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.6755855083465576
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.6402640342712402
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.6687188148498535
Epoch: 49, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6565439701080322
Epoch: 50, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6759049892425537
Epoch: 51, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7368674278259277
Epoch: 52, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.655646800994873
Epoch: 53, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.6580193042755127
Epoch: 54, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.6619715690612793
Epoch: 55, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.7131209373474121
Epoch: 56, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.6521201133728027
Epoch: 57, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.925 Test Loss: 0.199 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.6321296691894531
Epoch: 58, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 613676
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3316216468811035
Epoch: 1, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.416 Vali Acc: 0.150 Test Loss: 1.416 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.5540838241577148
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.327 Vali Acc: 0.200 Test Loss: 1.327 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.7115347385406494
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.202 Vali Acc: 0.325 Test Loss: 1.202 Test Acc: 0.325
Validation loss decreased (-0.199987 --> -0.324988).  Saving model ...
Epoch: 4 cost time: 0.6894006729125977
Epoch: 4, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.076 Vali Acc: 0.675 Test Loss: 1.076 Test Acc: 0.675
Validation loss decreased (-0.324988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.6056640148162842
Epoch: 5, Steps: 3 | Train Loss: 1.001 Vali Loss: 0.953 Vali Acc: 0.700 Test Loss: 0.953 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 0.5194876194000244
Epoch: 6, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.833 Vali Acc: 0.775 Test Loss: 0.833 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 0.5692524909973145
Epoch: 7, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.721 Vali Acc: 0.900 Test Loss: 0.721 Test Acc: 0.900
Validation loss decreased (-0.774992 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 0.5267055034637451
Epoch: 8, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.620 Vali Acc: 0.925 Test Loss: 0.620 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 0.6328651905059814
Epoch: 9, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.537 Vali Acc: 0.975 Test Loss: 0.537 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 0.570563793182373
Epoch: 10, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.463 Vali Acc: 0.975 Test Loss: 0.463 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.6221513748168945
Epoch: 11, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.5869982242584229
Epoch: 12, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6273519992828369
Epoch: 13, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5446529388427734
Epoch: 14, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5489554405212402
Epoch: 15, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5941979885101318
Epoch: 16, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6145617961883545
Epoch: 17, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5522992610931396
Epoch: 18, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6131582260131836
Epoch: 19, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.53086256980896
Epoch: 20, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.584038257598877
Epoch: 21, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.6755228042602539
Epoch: 22, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.5947220325469971
Epoch: 23, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.66983962059021
Epoch: 24, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.6066315174102783
Epoch: 25, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7126133441925049
Epoch: 26, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6122055053710938
Epoch: 27, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.6196081638336182
Epoch: 28, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6127851009368896
Epoch: 29, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6266622543334961
Epoch: 30, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.6330990791320801
Epoch: 31, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.6259605884552002
Epoch: 32, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.6747715473175049
Epoch: 33, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.6922767162322998
Epoch: 34, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.6910820007324219
Epoch: 35, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.6123092174530029
Epoch: 36, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.6427218914031982
Epoch: 37, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.6515064239501953
Epoch: 38, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.6859931945800781
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.637017011642456
Epoch: 40, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.6326758861541748
Epoch: 41, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.6238830089569092
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.6647999286651611
Epoch: 43, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.5483226776123047
Epoch: 44, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.6209719181060791
Epoch: 45, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.6152429580688477
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.6679012775421143
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.6348598003387451
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.6368579864501953
Epoch: 49, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.5501072406768799
Epoch: 50, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6213507652282715
Epoch: 51, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 52 cost time: 0.5881800651550293
Epoch: 52, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 53 cost time: 0.6316351890563965
Epoch: 53, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5421967506408691
Epoch: 54, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 55 cost time: 0.5577189922332764
Epoch: 55, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7014977931976318
Epoch: 56, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6679096221923828
Epoch: 57, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5922973155975342
Epoch: 58, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 59 cost time: 0.6112017631530762
Epoch: 59, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 60 cost time: 0.6358907222747803
Epoch: 60, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 61 cost time: 0.7146613597869873
Epoch: 61, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 62 cost time: 0.5961017608642578
Epoch: 62, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 63 cost time: 0.6192770004272461
Epoch: 63, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6618335247039795
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5866012573242188
Epoch: 65, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 66 cost time: 0.7034072875976562
Epoch: 66, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 67 cost time: 0.6889755725860596
Epoch: 67, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 68 cost time: 0.7166991233825684
Epoch: 68, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7078487873077393
Epoch: 69, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.6952381134033203
Epoch: 70, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.6797304153442383
Epoch: 71, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.6241781711578369
Epoch: 72, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.7020847797393799
Epoch: 73, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.7550108432769775
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.643465518951416
Epoch: 75, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.7802896499633789
Epoch: 76, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.6522693634033203
Epoch: 77, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 613676
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4120094776153564
Epoch: 1, Steps: 3 | Train Loss: 1.578 Vali Loss: 1.389 Vali Acc: 0.200 Test Loss: 1.389 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.595076322555542
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.308 Vali Acc: 0.250 Test Loss: 1.308 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.5915102958679199
Epoch: 3, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.192 Vali Acc: 0.375 Test Loss: 1.192 Test Acc: 0.375
Validation loss decreased (-0.249987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.6113660335540771
Epoch: 4, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.073 Vali Acc: 0.675 Test Loss: 1.073 Test Acc: 0.675
Validation loss decreased (-0.374988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.5953359603881836
Epoch: 5, Steps: 3 | Train Loss: 1.017 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 0.6016664505004883
Epoch: 6, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.836 Vali Acc: 0.800 Test Loss: 0.836 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.5305371284484863
Epoch: 7, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.727 Vali Acc: 0.900 Test Loss: 0.727 Test Acc: 0.900
Validation loss decreased (-0.799992 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 0.5887246131896973
Epoch: 8, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.624 Vali Acc: 0.975 Test Loss: 0.624 Test Acc: 0.975
Validation loss decreased (-0.899993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.5241506099700928
Epoch: 9, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.542 Vali Acc: 0.975 Test Loss: 0.542 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 0.6603317260742188
Epoch: 10, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.473 Vali Acc: 0.975 Test Loss: 0.473 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.5731585025787354
Epoch: 11, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.422 Vali Acc: 0.975 Test Loss: 0.422 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.6485042572021484
Epoch: 12, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.5842583179473877
Epoch: 13, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5546731948852539
Epoch: 14, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5714137554168701
Epoch: 15, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6195836067199707
Epoch: 16, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.6042642593383789
Epoch: 17, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.7455413341522217
Epoch: 18, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.6120216846466064
Epoch: 19, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.6523001194000244
Epoch: 20, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.6084988117218018
Epoch: 21, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6090524196624756
Epoch: 22, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6045384407043457
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6070291996002197
Epoch: 24, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6817429065704346
Epoch: 25, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5937058925628662
Epoch: 26, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5229055881500244
Epoch: 27, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4897797107696533
Epoch: 28, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6060657501220703
Epoch: 29, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5482041835784912
Epoch: 30, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 613676
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5122385025024414
Epoch: 1, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.607696533203125
Epoch: 2, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.5242085456848145
Epoch: 3, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.221 Vali Acc: 0.525 Test Loss: 1.221 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.5195407867431641
Epoch: 4, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.5804998874664307
Epoch: 5, Steps: 3 | Train Loss: 0.961 Vali Loss: 0.994 Vali Acc: 0.725 Test Loss: 0.994 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 0.5545370578765869
Epoch: 6, Steps: 3 | Train Loss: 0.848 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 0.554847002029419
Epoch: 7, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.787 Vali Acc: 0.850 Test Loss: 0.787 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 0.48313212394714355
Epoch: 8, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.693 Vali Acc: 0.925 Test Loss: 0.693 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 0.611290693283081
Epoch: 9, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.615 Vali Acc: 0.925 Test Loss: 0.615 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.47384214401245117
Epoch: 10, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.5998973846435547
Epoch: 11, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.635373592376709
Epoch: 12, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 13 cost time: 0.4921894073486328
Epoch: 13, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4534487724304199
Epoch: 14, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6126444339752197
Epoch: 15, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.525017499923706
Epoch: 16, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.5017733573913574
Epoch: 17, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 0.4982922077178955
Epoch: 18, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 0.49013257026672363
Epoch: 19, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.5166394710540771
Epoch: 20, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.5148084163665771
Epoch: 21, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 22 cost time: 0.500401496887207
Epoch: 22, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 23 cost time: 0.6443727016448975
Epoch: 23, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 24 cost time: 0.5958154201507568
Epoch: 24, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 25 cost time: 0.5715861320495605
Epoch: 25, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 26 cost time: 0.5635523796081543
Epoch: 26, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.215 Vali Acc: 0.925 Test Loss: 0.215 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 27 cost time: 0.5383129119873047
Epoch: 27, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 28 cost time: 0.5443072319030762
Epoch: 28, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 29 cost time: 0.5662791728973389
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.925 Test Loss: 0.205 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 30 cost time: 0.5794885158538818
Epoch: 30, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 31 cost time: 0.564678430557251
Epoch: 31, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.203 Vali Acc: 0.900 Test Loss: 0.203 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5714960098266602
Epoch: 32, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.201 Vali Acc: 0.900 Test Loss: 0.201 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6504275798797607
Epoch: 33, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.900 Test Loss: 0.199 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5535893440246582
Epoch: 34, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.196 Vali Acc: 0.900 Test Loss: 0.196 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.518552303314209
Epoch: 35, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.193 Vali Acc: 0.900 Test Loss: 0.193 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6321737766265869
Epoch: 36, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.189 Vali Acc: 0.900 Test Loss: 0.189 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5547482967376709
Epoch: 37, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.188 Vali Acc: 0.900 Test Loss: 0.188 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5652000904083252
Epoch: 38, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.900 Test Loss: 0.186 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.537036657333374
Epoch: 39, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.900 Test Loss: 0.185 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5221207141876221
Epoch: 40, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.182 Vali Acc: 0.900 Test Loss: 0.182 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 613676
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.492313861846924
Epoch: 1, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.294 Vali Acc: 0.350 Test Loss: 1.294 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.5556516647338867
Epoch: 2, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.226 Vali Acc: 0.350 Test Loss: 1.226 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 0.5918886661529541
Epoch: 3, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.124 Vali Acc: 0.475 Test Loss: 1.124 Test Acc: 0.475
Validation loss decreased (-0.349988 --> -0.474989).  Saving model ...
Epoch: 4 cost time: 0.6740822792053223
Epoch: 4, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.021 Vali Acc: 0.525 Test Loss: 1.021 Test Acc: 0.525
Validation loss decreased (-0.474989 --> -0.524990).  Saving model ...
Epoch: 5 cost time: 0.6476027965545654
Epoch: 5, Steps: 3 | Train Loss: 0.935 Vali Loss: 0.933 Vali Acc: 0.600 Test Loss: 0.933 Test Acc: 0.600
Validation loss decreased (-0.524990 --> -0.599991).  Saving model ...
Epoch: 6 cost time: 0.601494312286377
Epoch: 6, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.852 Vali Acc: 0.625 Test Loss: 0.852 Test Acc: 0.625
Validation loss decreased (-0.599991 --> -0.624991).  Saving model ...
Epoch: 7 cost time: 0.6010744571685791
Epoch: 7, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
Validation loss decreased (-0.624991 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.565054178237915
Epoch: 8, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
Validation loss decreased (-0.749993 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.4595987796783447
Epoch: 9, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.544 Vali Acc: 0.925 Test Loss: 0.544 Test Acc: 0.925
Validation loss decreased (-0.824994 --> -0.924995).  Saving model ...
Epoch: 10 cost time: 0.5380604267120361
Epoch: 10, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.5273158550262451
Epoch: 11, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.551154613494873
Epoch: 12, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.5315003395080566
Epoch: 13, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5073611736297607
Epoch: 14, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4991495609283447
Epoch: 15, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5671162605285645
Epoch: 16, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.5954959392547607
Epoch: 17, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5134382247924805
Epoch: 18, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5933725833892822
Epoch: 19, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.559481143951416
Epoch: 20, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5447385311126709
Epoch: 21, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5100221633911133
Epoch: 22, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6240732669830322
Epoch: 23, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5643310546875
Epoch: 24, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6607558727264404
Epoch: 25, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6264934539794922
Epoch: 26, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6173269748687744
Epoch: 27, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6003262996673584
Epoch: 28, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5576934814453125
Epoch: 29, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 351532
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.425389289855957
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.330 Vali Acc: 0.250 Test Loss: 1.330 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.5463683605194092
Epoch: 2, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.264 Vali Acc: 0.325 Test Loss: 1.264 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.6263589859008789
Epoch: 3, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.161 Vali Acc: 0.425 Test Loss: 1.161 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.6590113639831543
Epoch: 4, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.055 Vali Acc: 0.425 Test Loss: 1.055 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424989).  Saving model ...
Epoch: 5 cost time: 0.6241717338562012
Epoch: 5, Steps: 3 | Train Loss: 0.936 Vali Loss: 0.959 Vali Acc: 0.475 Test Loss: 0.959 Test Acc: 0.475
Validation loss decreased (-0.424989 --> -0.474990).  Saving model ...
Epoch: 6 cost time: 0.6963450908660889
Epoch: 6, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.870 Vali Acc: 0.600 Test Loss: 0.870 Test Acc: 0.600
Validation loss decreased (-0.474990 --> -0.599991).  Saving model ...
Epoch: 7 cost time: 0.6421923637390137
Epoch: 7, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.763 Vali Acc: 0.875 Test Loss: 0.763 Test Acc: 0.875
Validation loss decreased (-0.599991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.6629025936126709
Epoch: 8, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.652 Vali Acc: 0.925 Test Loss: 0.652 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 0.5824356079101562
Epoch: 9, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.560 Vali Acc: 0.950 Test Loss: 0.560 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.6629741191864014
Epoch: 10, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.494 Vali Acc: 0.975 Test Loss: 0.494 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.6315450668334961
Epoch: 11, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.441 Vali Acc: 0.975 Test Loss: 0.441 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.6247870922088623
Epoch: 12, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6201815605163574
Epoch: 13, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5409455299377441
Epoch: 14, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6120889186859131
Epoch: 15, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5488700866699219
Epoch: 16, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5823421478271484
Epoch: 17, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5927350521087646
Epoch: 18, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5948221683502197
Epoch: 19, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5376250743865967
Epoch: 20, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4793736934661865
Epoch: 21, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 351532
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4152424335479736
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.329 Vali Acc: 0.275 Test Loss: 1.329 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.5569443702697754
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.267 Vali Acc: 0.350 Test Loss: 1.267 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5974781513214111
Epoch: 3, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.171 Vali Acc: 0.425 Test Loss: 1.171 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.662163257598877
Epoch: 4, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.069 Vali Acc: 0.525 Test Loss: 1.069 Test Acc: 0.525
Validation loss decreased (-0.424988 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.5998380184173584
Epoch: 5, Steps: 3 | Train Loss: 0.946 Vali Loss: 0.978 Vali Acc: 0.550 Test Loss: 0.978 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 0.5036063194274902
Epoch: 6, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.891 Vali Acc: 0.700 Test Loss: 0.891 Test Acc: 0.700
Validation loss decreased (-0.549990 --> -0.699991).  Saving model ...
Epoch: 7 cost time: 0.5880486965179443
Epoch: 7, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.784 Vali Acc: 0.850 Test Loss: 0.784 Test Acc: 0.850
Validation loss decreased (-0.699991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 0.7263538837432861
Epoch: 8, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.673 Vali Acc: 0.925 Test Loss: 0.673 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 0.5710527896881104
Epoch: 9, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.578 Vali Acc: 0.950 Test Loss: 0.578 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.5624260902404785
Epoch: 10, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.508 Vali Acc: 0.975 Test Loss: 0.508 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.5234346389770508
Epoch: 11, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.449 Vali Acc: 0.975 Test Loss: 0.449 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.6000449657440186
Epoch: 12, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.404 Vali Acc: 0.975 Test Loss: 0.404 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.656745433807373
Epoch: 13, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5497679710388184
Epoch: 14, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5715851783752441
Epoch: 15, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5684680938720703
Epoch: 16, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6080071926116943
Epoch: 17, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6282587051391602
Epoch: 18, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6406958103179932
Epoch: 19, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6831569671630859
Epoch: 20, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6543936729431152
Epoch: 21, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6384356021881104
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 351532
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.354353904724121
Epoch: 1, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.312 Vali Acc: 0.275 Test Loss: 1.312 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.5710735321044922
Epoch: 2, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.260 Vali Acc: 0.300 Test Loss: 1.260 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.5992374420166016
Epoch: 3, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.299987 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6277079582214355
Epoch: 4, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.077 Vali Acc: 0.525 Test Loss: 1.077 Test Acc: 0.525
Validation loss decreased (-0.399988 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.5727753639221191
Epoch: 5, Steps: 3 | Train Loss: 0.934 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.6463303565979004
Epoch: 6, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.899 Vali Acc: 0.650 Test Loss: 0.899 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 0.6011030673980713
Epoch: 7, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.806 Vali Acc: 0.825 Test Loss: 0.806 Test Acc: 0.825
Validation loss decreased (-0.649991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.5901236534118652
Epoch: 8, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.710 Vali Acc: 0.925 Test Loss: 0.710 Test Acc: 0.925
Validation loss decreased (-0.824992 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 0.5794482231140137
Epoch: 9, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.628 Vali Acc: 0.950 Test Loss: 0.628 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.5519232749938965
Epoch: 10, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.559 Vali Acc: 0.925 Test Loss: 0.559 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6027085781097412
Epoch: 11, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.504 Vali Acc: 0.925 Test Loss: 0.504 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6449568271636963
Epoch: 12, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.456 Vali Acc: 0.925 Test Loss: 0.456 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.614370584487915
Epoch: 13, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.416 Vali Acc: 0.950 Test Loss: 0.416 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.5677492618560791
Epoch: 14, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.6612961292266846
Epoch: 15, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6553130149841309
Epoch: 16, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.6110813617706299
Epoch: 17, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.6644132137298584
Epoch: 18, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.6702451705932617
Epoch: 19, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.6504251956939697
Epoch: 20, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.6466219425201416
Epoch: 21, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.6520559787750244
Epoch: 22, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.6543397903442383
Epoch: 23, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6547069549560547
Epoch: 24, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6747341156005859
Epoch: 25, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.6246752738952637
Epoch: 26, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.6539440155029297
Epoch: 27, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.232 Vali Acc: 0.925 Test Loss: 0.232 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.606536865234375
Epoch: 28, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.5917232036590576
Epoch: 29, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5891592502593994
Epoch: 30, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.66451096534729
Epoch: 31, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.925 Test Loss: 0.224 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7012534141540527
Epoch: 32, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5732178688049316
Epoch: 33, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6400911808013916
Epoch: 34, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6060328483581543
Epoch: 35, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6224915981292725
Epoch: 36, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.875 Test Loss: 0.219 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5597975254058838
Epoch: 37, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6210591793060303
Epoch: 38, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 351532
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2511489391326904
Epoch: 1, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.375 Vali Acc: 0.225 Test Loss: 1.375 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.6037063598632812
Epoch: 2, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.311 Vali Acc: 0.225 Test Loss: 1.311 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.571739673614502
Epoch: 3, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.216 Vali Acc: 0.250 Test Loss: 1.216 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249988).  Saving model ...
Epoch: 4 cost time: 0.6086373329162598
Epoch: 4, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.105 Vali Acc: 0.350 Test Loss: 1.105 Test Acc: 0.350
Validation loss decreased (-0.249988 --> -0.349989).  Saving model ...
Epoch: 5 cost time: 0.5074963569641113
Epoch: 5, Steps: 3 | Train Loss: 0.940 Vali Loss: 0.994 Vali Acc: 0.525 Test Loss: 0.994 Test Acc: 0.525
Validation loss decreased (-0.349989 --> -0.524990).  Saving model ...
Epoch: 6 cost time: 0.5510053634643555
Epoch: 6, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
Validation loss decreased (-0.524990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.5015573501586914
Epoch: 7, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.747 Vali Acc: 0.900 Test Loss: 0.747 Test Acc: 0.900
Validation loss decreased (-0.799991 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 0.5236227512359619
Epoch: 8, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.634 Vali Acc: 0.950 Test Loss: 0.634 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.5655355453491211
Epoch: 9, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.557 Vali Acc: 0.975 Test Loss: 0.557 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 10 cost time: 0.5417518615722656
Epoch: 10, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.510 Vali Acc: 0.975 Test Loss: 0.510 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.5206260681152344
Epoch: 11, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.453 Vali Acc: 0.975 Test Loss: 0.453 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 12 cost time: 0.578209400177002
Epoch: 12, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.403 Vali Acc: 0.975 Test Loss: 0.403 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.6435024738311768
Epoch: 13, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.606785774230957
Epoch: 14, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.319 Vali Acc: 0.975 Test Loss: 0.319 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.5996763706207275
Epoch: 15, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.5039718151092529
Epoch: 16, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5742549896240234
Epoch: 17, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6101839542388916
Epoch: 18, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6249985694885254
Epoch: 19, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6737277507781982
Epoch: 20, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5499222278594971
Epoch: 21, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5647234916687012
Epoch: 22, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5806097984313965
Epoch: 23, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5858068466186523
Epoch: 24, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5834903717041016
Epoch: 25, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 220460
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3178417682647705
Epoch: 1, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.364 Vali Acc: 0.225 Test Loss: 1.364 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.573056697845459
Epoch: 2, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.298 Vali Acc: 0.250 Test Loss: 1.298 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.6327598094940186
Epoch: 3, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.199 Vali Acc: 0.375 Test Loss: 1.199 Test Acc: 0.375
Validation loss decreased (-0.249987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.5436151027679443
Epoch: 4, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.084 Vali Acc: 0.525 Test Loss: 1.084 Test Acc: 0.525
Validation loss decreased (-0.374988 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 0.577721357345581
Epoch: 5, Steps: 3 | Train Loss: 0.916 Vali Loss: 0.970 Vali Acc: 0.550 Test Loss: 0.970 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 0.5333573818206787
Epoch: 6, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.853 Vali Acc: 0.875 Test Loss: 0.853 Test Acc: 0.875
Validation loss decreased (-0.549990 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.5733847618103027
Epoch: 7, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.732 Vali Acc: 0.925 Test Loss: 0.732 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.5870258808135986
Epoch: 8, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.622 Vali Acc: 0.975 Test Loss: 0.622 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.5941910743713379
Epoch: 9, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.543 Vali Acc: 0.975 Test Loss: 0.543 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 0.5230197906494141
Epoch: 10, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.486 Vali Acc: 0.975 Test Loss: 0.486 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.6474096775054932
Epoch: 11, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.426 Vali Acc: 0.975 Test Loss: 0.426 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.5672645568847656
Epoch: 12, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.6340610980987549
Epoch: 13, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.5048730373382568
Epoch: 14, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.5965573787689209
Epoch: 15, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5577561855316162
Epoch: 16, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5432431697845459
Epoch: 17, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5438106060028076
Epoch: 18, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6839385032653809
Epoch: 19, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6286227703094482
Epoch: 20, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6386477947235107
Epoch: 21, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.580909252166748
Epoch: 22, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6770617961883545
Epoch: 23, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5424325466156006
Epoch: 24, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 220460
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.538710832595825
Epoch: 1, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.376 Vali Acc: 0.225 Test Loss: 1.376 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5596182346343994
Epoch: 2, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.314 Vali Acc: 0.225 Test Loss: 1.314 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.5984418392181396
Epoch: 3, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.216 Vali Acc: 0.350 Test Loss: 1.216 Test Acc: 0.350
Validation loss decreased (-0.224987 --> -0.349988).  Saving model ...
Epoch: 4 cost time: 0.6097667217254639
Epoch: 4, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.100 Vali Acc: 0.475 Test Loss: 1.100 Test Acc: 0.475
Validation loss decreased (-0.349988 --> -0.474989).  Saving model ...
Epoch: 5 cost time: 0.5326368808746338
Epoch: 5, Steps: 3 | Train Loss: 0.920 Vali Loss: 0.983 Vali Acc: 0.575 Test Loss: 0.983 Test Acc: 0.575
Validation loss decreased (-0.474989 --> -0.574990).  Saving model ...
Epoch: 6 cost time: 0.604907751083374
Epoch: 6, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.866 Vali Acc: 0.850 Test Loss: 0.866 Test Acc: 0.850
Validation loss decreased (-0.574990 --> -0.849991).  Saving model ...
Epoch: 7 cost time: 0.5411534309387207
Epoch: 7, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.745 Vali Acc: 0.925 Test Loss: 0.745 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.5865302085876465
Epoch: 8, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.637 Vali Acc: 0.975 Test Loss: 0.637 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.6086037158966064
Epoch: 9, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.553 Vali Acc: 0.975 Test Loss: 0.553 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 10 cost time: 0.6083576679229736
Epoch: 10, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.487 Vali Acc: 0.975 Test Loss: 0.487 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.5900332927703857
Epoch: 11, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.424 Vali Acc: 0.975 Test Loss: 0.424 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.6212544441223145
Epoch: 12, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.6462981700897217
Epoch: 13, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.5273008346557617
Epoch: 14, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.5568084716796875
Epoch: 15, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.6113955974578857
Epoch: 16, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.5601580142974854
Epoch: 17, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.5979387760162354
Epoch: 18, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.5918912887573242
Epoch: 19, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5931692123413086
Epoch: 20, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.5397648811340332
Epoch: 21, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.5882325172424316
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.599907636642456
Epoch: 23, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.6289529800415039
Epoch: 24, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6902217864990234
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7017743587493896
Epoch: 26, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6164932250976562
Epoch: 27, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5554311275482178
Epoch: 28, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5745761394500732
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6189734935760498
Epoch: 30, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6232728958129883
Epoch: 31, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5586931705474854
Epoch: 32, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6392624378204346
Epoch: 33, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 220460
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.433842420578003
Epoch: 1, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.370 Vali Acc: 0.275 Test Loss: 1.370 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6068663597106934
Epoch: 2, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.311 Vali Acc: 0.325 Test Loss: 1.311 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.6741271018981934
Epoch: 3, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.221 Vali Acc: 0.425 Test Loss: 1.221 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.587604284286499
Epoch: 4, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
Validation loss decreased (-0.424988 --> -0.549989).  Saving model ...
Epoch: 5 cost time: 0.6593790054321289
Epoch: 5, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.001 Vali Acc: 0.675 Test Loss: 1.001 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.6343023777008057
Epoch: 6, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.893 Vali Acc: 0.950 Test Loss: 0.893 Test Acc: 0.950
Validation loss decreased (-0.674990 --> -0.949991).  Saving model ...
Epoch: 7 cost time: 0.6726257801055908
Epoch: 7, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.788 Vali Acc: 0.900 Test Loss: 0.788 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6247973442077637
Epoch: 8, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.695 Vali Acc: 0.900 Test Loss: 0.695 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6877479553222656
Epoch: 9, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.616 Vali Acc: 0.925 Test Loss: 0.616 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6776385307312012
Epoch: 10, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6510813236236572
Epoch: 11, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.491 Vali Acc: 0.925 Test Loss: 0.491 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7589428424835205
Epoch: 12, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6038334369659424
Epoch: 13, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.646491289138794
Epoch: 14, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.5643877983093262
Epoch: 15, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.5999846458435059
Epoch: 16, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.5938260555267334
Epoch: 17, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.6519501209259033
Epoch: 18, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.6340689659118652
Epoch: 19, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.5889227390289307
Epoch: 20, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6687602996826172
Epoch: 21, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.6188960075378418
Epoch: 22, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.6016864776611328
Epoch: 23, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6192774772644043
Epoch: 24, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5732736587524414
Epoch: 25, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.55281662940979
Epoch: 26, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5284931659698486
Epoch: 27, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.5189363956451416
Epoch: 28, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5809566974639893
Epoch: 29, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.5937812328338623
Epoch: 30, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.6333193778991699
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.6007733345031738
Epoch: 32, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5423660278320312
Epoch: 33, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5668315887451172
Epoch: 34, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.582592248916626
Epoch: 35, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5066628456115723
Epoch: 36, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5554399490356445
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.925 Test Loss: 0.191 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5718669891357422
Epoch: 38, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.925 Test Loss: 0.189 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5252470970153809
Epoch: 39, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5969500541687012
Epoch: 40, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6537716388702393
Epoch: 41, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.925 Test Loss: 0.183 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 220460
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.673823118209839
Epoch: 1, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.382 Vali Acc: 0.325 Test Loss: 1.382 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.669154167175293
Epoch: 2, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.303 Vali Acc: 0.375 Test Loss: 1.303 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.7068350315093994
Epoch: 3, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6439309120178223
Epoch: 4, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.077 Vali Acc: 0.450 Test Loss: 1.077 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449989).  Saving model ...
Epoch: 5 cost time: 0.7268576622009277
Epoch: 5, Steps: 3 | Train Loss: 0.918 Vali Loss: 0.962 Vali Acc: 0.725 Test Loss: 0.962 Test Acc: 0.725
Validation loss decreased (-0.449989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 0.6662952899932861
Epoch: 6, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.847 Vali Acc: 0.875 Test Loss: 0.847 Test Acc: 0.875
Validation loss decreased (-0.724990 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.6652569770812988
Epoch: 7, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.732 Vali Acc: 0.950 Test Loss: 0.732 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 0.6359193325042725
Epoch: 8, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.635 Vali Acc: 0.975 Test Loss: 0.635 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.7034850120544434
Epoch: 9, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.568 Vali Acc: 0.950 Test Loss: 0.568 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6762638092041016
Epoch: 10, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.502 Vali Acc: 0.950 Test Loss: 0.502 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6249666213989258
Epoch: 11, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.462 Vali Acc: 0.950 Test Loss: 0.462 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6488392353057861
Epoch: 12, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.587761402130127
Epoch: 13, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6346569061279297
Epoch: 14, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6299459934234619
Epoch: 15, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6366469860076904
Epoch: 16, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6618630886077881
Epoch: 17, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6971356868743896
Epoch: 18, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 154924
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4331483840942383
Epoch: 1, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.360 Vali Acc: 0.350 Test Loss: 1.360 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.485187292098999
Epoch: 2, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.287 Vali Acc: 0.425 Test Loss: 1.287 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.5169162750244141
Epoch: 3, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.176 Vali Acc: 0.450 Test Loss: 1.176 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.5016508102416992
Epoch: 4, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.064 Vali Acc: 0.500 Test Loss: 1.064 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 0.5499136447906494
Epoch: 5, Steps: 3 | Train Loss: 0.911 Vali Loss: 0.948 Vali Acc: 0.650 Test Loss: 0.948 Test Acc: 0.650
Validation loss decreased (-0.499989 --> -0.649991).  Saving model ...
Epoch: 6 cost time: 0.49714231491088867
Epoch: 6, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.835 Vali Acc: 0.925 Test Loss: 0.835 Test Acc: 0.925
Validation loss decreased (-0.649991 --> -0.924992).  Saving model ...
Epoch: 7 cost time: 0.5405128002166748
Epoch: 7, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.724 Vali Acc: 0.950 Test Loss: 0.724 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 0.5233054161071777
Epoch: 8, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.629 Vali Acc: 0.975 Test Loss: 0.629 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.5994536876678467
Epoch: 9, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.562 Vali Acc: 0.975 Test Loss: 0.562 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 10 cost time: 0.5680067539215088
Epoch: 10, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.522496223449707
Epoch: 11, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.463 Vali Acc: 0.950 Test Loss: 0.463 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5841450691223145
Epoch: 12, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5766863822937012
Epoch: 13, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5401606559753418
Epoch: 14, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6074607372283936
Epoch: 15, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6111934185028076
Epoch: 16, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5956478118896484
Epoch: 17, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5600166320800781
Epoch: 18, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5597784519195557
Epoch: 19, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 154924
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.487920045852661
Epoch: 1, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.344 Vali Acc: 0.425 Test Loss: 1.344 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.6464993953704834
Epoch: 2, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5985739231109619
Epoch: 3, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.171 Vali Acc: 0.525 Test Loss: 1.171 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.6655178070068359
Epoch: 4, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.6587417125701904
Epoch: 5, Steps: 3 | Train Loss: 0.914 Vali Loss: 0.948 Vali Acc: 0.625 Test Loss: 0.948 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624991).  Saving model ...
Epoch: 6 cost time: 0.6721820831298828
Epoch: 6, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.838 Vali Acc: 0.900 Test Loss: 0.838 Test Acc: 0.900
Validation loss decreased (-0.624991 --> -0.899992).  Saving model ...
Epoch: 7 cost time: 0.6754522323608398
Epoch: 7, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.732 Vali Acc: 0.950 Test Loss: 0.732 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 0.6590006351470947
Epoch: 8, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.638 Vali Acc: 0.975 Test Loss: 0.638 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.7072052955627441
Epoch: 9, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.568 Vali Acc: 0.975 Test Loss: 0.568 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 10 cost time: 0.5917279720306396
Epoch: 10, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.502 Vali Acc: 0.975 Test Loss: 0.502 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.5786688327789307
Epoch: 11, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.453 Vali Acc: 0.975 Test Loss: 0.453 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 12 cost time: 0.6574108600616455
Epoch: 12, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.401 Vali Acc: 0.975 Test Loss: 0.401 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.5447092056274414
Epoch: 13, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.356 Vali Acc: 0.975 Test Loss: 0.356 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.6399991512298584
Epoch: 14, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.5763437747955322
Epoch: 15, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.5992777347564697
Epoch: 16, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.6172068119049072
Epoch: 17, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.6117813587188721
Epoch: 18, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.6532649993896484
Epoch: 19, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6198327541351318
Epoch: 20, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6580464839935303
Epoch: 21, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.221 Vali Acc: 0.925 Test Loss: 0.221 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6852242946624756
Epoch: 22, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.584641695022583
Epoch: 23, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6458346843719482
Epoch: 24, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.925 Test Loss: 0.221 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7851333618164062
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.925 Test Loss: 0.221 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7000627517700195
Epoch: 26, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6713461875915527
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6576588153839111
Epoch: 28, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.217 Vali Acc: 0.925 Test Loss: 0.217 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 154924
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.429023504257202
Epoch: 1, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.343 Vali Acc: 0.350 Test Loss: 1.343 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.6934542655944824
Epoch: 2, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.6311094760894775
Epoch: 3, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.190 Vali Acc: 0.600 Test Loss: 1.190 Test Acc: 0.600
Validation loss decreased (-0.399987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.6102750301361084
Epoch: 4, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.6779873371124268
Epoch: 5, Steps: 3 | Train Loss: 0.921 Vali Loss: 0.981 Vali Acc: 0.675 Test Loss: 0.981 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.585716724395752
Epoch: 6, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.875 Vali Acc: 0.900 Test Loss: 0.875 Test Acc: 0.900
Validation loss decreased (-0.674990 --> -0.899991).  Saving model ...
Epoch: 7 cost time: 0.5827021598815918
Epoch: 7, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.777 Vali Acc: 0.925 Test Loss: 0.777 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 8 cost time: 0.6272015571594238
Epoch: 8, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.691 Vali Acc: 0.875 Test Loss: 0.691 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6242156028747559
Epoch: 9, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.621 Vali Acc: 0.875 Test Loss: 0.621 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6222443580627441
Epoch: 10, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.557 Vali Acc: 0.925 Test Loss: 0.557 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.6281862258911133
Epoch: 11, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.507 Vali Acc: 0.950 Test Loss: 0.507 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.6891043186187744
Epoch: 12, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.457 Vali Acc: 0.950 Test Loss: 0.457 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.6413848400115967
Epoch: 13, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.5392043590545654
Epoch: 14, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.5403406620025635
Epoch: 15, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6012110710144043
Epoch: 16, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.5208189487457275
Epoch: 17, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5945932865142822
Epoch: 18, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5770866870880127
Epoch: 19, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.676410436630249
Epoch: 20, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5722148418426514
Epoch: 21, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.5122480392456055
Epoch: 22, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.5301940441131592
Epoch: 23, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.5539374351501465
Epoch: 24, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.5887975692749023
Epoch: 25, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.5372824668884277
Epoch: 26, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.5943763256072998
Epoch: 27, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.236 Vali Acc: 0.925 Test Loss: 0.236 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5421664714813232
Epoch: 28, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5538673400878906
Epoch: 29, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5467612743377686
Epoch: 30, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5263972282409668
Epoch: 31, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.925 Test Loss: 0.223 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.64190673828125
Epoch: 32, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6853635311126709
Epoch: 33, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6456055641174316
Epoch: 34, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.925 Test Loss: 0.216 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5652024745941162
Epoch: 35, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.925 Test Loss: 0.215 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5838959217071533
Epoch: 36, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 154924
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3911988735198975
Epoch: 1, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.352 Vali Acc: 0.275 Test Loss: 1.352 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.663149356842041
Epoch: 2, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.265 Vali Acc: 0.325 Test Loss: 1.265 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.5956020355224609
Epoch: 3, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.147 Vali Acc: 0.425 Test Loss: 1.147 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424989).  Saving model ...
Epoch: 4 cost time: 0.5914523601531982
Epoch: 4, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.029 Vali Acc: 0.475 Test Loss: 1.029 Test Acc: 0.475
Validation loss decreased (-0.424989 --> -0.474990).  Saving model ...
Epoch: 5 cost time: 0.6175243854522705
Epoch: 5, Steps: 3 | Train Loss: 0.910 Vali Loss: 0.918 Vali Acc: 0.650 Test Loss: 0.918 Test Acc: 0.650
Validation loss decreased (-0.474990 --> -0.649991).  Saving model ...
Epoch: 6 cost time: 0.6181900501251221
Epoch: 6, Steps: 3 | Train Loss: 0.805 Vali Loss: 0.809 Vali Acc: 0.675 Test Loss: 0.809 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674992).  Saving model ...
Epoch: 7 cost time: 0.5372927188873291
Epoch: 7, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.701 Vali Acc: 0.700 Test Loss: 0.701 Test Acc: 0.700
Validation loss decreased (-0.674992 --> -0.699993).  Saving model ...
Epoch: 8 cost time: 0.5593035221099854
Epoch: 8, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
Validation loss decreased (-0.699993 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 0.6501486301422119
Epoch: 9, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 10 cost time: 0.5592889785766602
Epoch: 10, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.473 Vali Acc: 0.950 Test Loss: 0.473 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.662677526473999
Epoch: 11, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6385760307312012
Epoch: 12, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6180565357208252
Epoch: 13, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5935237407684326
Epoch: 14, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6794006824493408
Epoch: 15, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5054094791412354
Epoch: 16, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5677909851074219
Epoch: 17, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5796129703521729
Epoch: 18, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6014702320098877
Epoch: 19, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5190403461456299
Epoch: 20, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 122156
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4614953994750977
Epoch: 1, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.343 Vali Acc: 0.300 Test Loss: 1.343 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.6044223308563232
Epoch: 2, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
Validation loss decreased (-0.299987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.6143453121185303
Epoch: 3, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.152 Vali Acc: 0.425 Test Loss: 1.152 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.650376558303833
Epoch: 4, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.039 Vali Acc: 0.475 Test Loss: 1.039 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474990).  Saving model ...
Epoch: 5 cost time: 0.6837310791015625
Epoch: 5, Steps: 3 | Train Loss: 0.921 Vali Loss: 0.931 Vali Acc: 0.625 Test Loss: 0.931 Test Acc: 0.625
Validation loss decreased (-0.474990 --> -0.624991).  Saving model ...
Epoch: 6 cost time: 0.7358191013336182
Epoch: 6, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.822 Vali Acc: 0.650 Test Loss: 0.822 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649992).  Saving model ...
Epoch: 7 cost time: 0.5949018001556396
Epoch: 7, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.712 Vali Acc: 0.675 Test Loss: 0.712 Test Acc: 0.675
Validation loss decreased (-0.649992 --> -0.674993).  Saving model ...
Epoch: 8 cost time: 0.6305263042449951
Epoch: 8, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.618 Vali Acc: 0.875 Test Loss: 0.618 Test Acc: 0.875
Validation loss decreased (-0.674993 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 0.5719656944274902
Epoch: 9, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.542 Vali Acc: 0.925 Test Loss: 0.542 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 10 cost time: 0.6027014255523682
Epoch: 10, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.476 Vali Acc: 0.925 Test Loss: 0.476 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 0.616708517074585
Epoch: 11, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 0.5594744682312012
Epoch: 12, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 0.6211762428283691
Epoch: 13, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.6555631160736084
Epoch: 14, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.6992387771606445
Epoch: 15, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6138734817504883
Epoch: 16, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.6751246452331543
Epoch: 17, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5912342071533203
Epoch: 18, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5919036865234375
Epoch: 19, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.654210090637207
Epoch: 20, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.658557653427124
Epoch: 21, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7185733318328857
Epoch: 22, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.6415107250213623
Epoch: 23, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.6241927146911621
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.232 Vali Acc: 0.925 Test Loss: 0.232 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6236963272094727
Epoch: 25, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6208779811859131
Epoch: 26, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7739598751068115
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6693198680877686
Epoch: 28, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6539657115936279
Epoch: 29, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6902012825012207
Epoch: 30, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6157863140106201
Epoch: 31, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7038519382476807
Epoch: 32, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6541051864624023
Epoch: 33, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 122156
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.091661214828491
Epoch: 1, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.311 Vali Acc: 0.275 Test Loss: 1.311 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.6213192939758301
Epoch: 2, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
Validation loss decreased (-0.274987 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.539790153503418
Epoch: 3, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.131 Vali Acc: 0.475 Test Loss: 1.131 Test Acc: 0.475
Validation loss decreased (-0.399988 --> -0.474989).  Saving model ...
Epoch: 4 cost time: 0.6739840507507324
Epoch: 4, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.018 Vali Acc: 0.550 Test Loss: 1.018 Test Acc: 0.550
Validation loss decreased (-0.474989 --> -0.549990).  Saving model ...
Epoch: 5 cost time: 0.5312817096710205
Epoch: 5, Steps: 3 | Train Loss: 0.911 Vali Loss: 0.909 Vali Acc: 0.650 Test Loss: 0.909 Test Acc: 0.650
Validation loss decreased (-0.549990 --> -0.649991).  Saving model ...
Epoch: 6 cost time: 0.6044223308563232
Epoch: 6, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.798 Vali Acc: 0.700 Test Loss: 0.798 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 0.6218822002410889
Epoch: 7, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
Validation loss decreased (-0.699992 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.6356034278869629
Epoch: 8, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.601 Vali Acc: 0.925 Test Loss: 0.601 Test Acc: 0.925
Validation loss decreased (-0.799993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 0.6527926921844482
Epoch: 9, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.528 Vali Acc: 0.975 Test Loss: 0.528 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 0.5728268623352051
Epoch: 10, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.463 Vali Acc: 0.975 Test Loss: 0.463 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.5865004062652588
Epoch: 11, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.421 Vali Acc: 0.975 Test Loss: 0.421 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.7010238170623779
Epoch: 12, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.585662841796875
Epoch: 13, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.345 Vali Acc: 0.975 Test Loss: 0.345 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.6688172817230225
Epoch: 14, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6233057975769043
Epoch: 15, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6467318534851074
Epoch: 16, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.6082627773284912
Epoch: 17, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.6334829330444336
Epoch: 18, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.688849925994873
Epoch: 19, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.6878538131713867
Epoch: 20, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5990347862243652
Epoch: 21, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5867276191711426
Epoch: 22, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7105977535247803
Epoch: 23, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6793324947357178
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6554532051086426
Epoch: 25, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6801848411560059
Epoch: 26, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6769936084747314
Epoch: 27, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.925 Test Loss: 0.199 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6950113773345947
Epoch: 28, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.900 Test Loss: 0.198 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6163101196289062
Epoch: 29, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.900 Test Loss: 0.199 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 122156
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2250757217407227
Epoch: 1, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.352 Vali Acc: 0.250 Test Loss: 1.352 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5317473411560059
Epoch: 2, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.289 Vali Acc: 0.275 Test Loss: 1.289 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.5333709716796875
Epoch: 3, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.274987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.5621011257171631
Epoch: 4, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.080 Vali Acc: 0.625 Test Loss: 1.080 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.6549181938171387
Epoch: 5, Steps: 3 | Train Loss: 0.886 Vali Loss: 0.971 Vali Acc: 0.650 Test Loss: 0.971 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 0.5435068607330322
Epoch: 6, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.865 Vali Acc: 0.800 Test Loss: 0.865 Test Acc: 0.800
Validation loss decreased (-0.649990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.5574424266815186
Epoch: 7, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 0.5527641773223877
Epoch: 8, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.682 Vali Acc: 0.950 Test Loss: 0.682 Test Acc: 0.950
Validation loss decreased (-0.849992 --> -0.949993).  Saving model ...
Epoch: 9 cost time: 0.6490871906280518
Epoch: 9, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.609 Vali Acc: 0.925 Test Loss: 0.609 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5287883281707764
Epoch: 10, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5702588558197021
Epoch: 11, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5837118625640869
Epoch: 12, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5662980079650879
Epoch: 13, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.6251285076141357
Epoch: 14, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.5807583332061768
Epoch: 15, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.6501188278198242
Epoch: 16, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.6205785274505615
Epoch: 17, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.6453747749328613
Epoch: 18, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5909750461578369
Epoch: 19, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.5793037414550781
Epoch: 20, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.711958646774292
Epoch: 21, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.6607778072357178
Epoch: 22, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5705122947692871
Epoch: 23, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5567119121551514
Epoch: 24, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5998313426971436
Epoch: 25, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5784711837768555
Epoch: 26, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.236 Vali Acc: 0.925 Test Loss: 0.236 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6269726753234863
Epoch: 27, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.6250019073486328
Epoch: 28, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.6400420665740967
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.6810920238494873
Epoch: 30, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.633206844329834
Epoch: 31, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6222624778747559
Epoch: 32, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6321566104888916
Epoch: 33, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6682002544403076
Epoch: 34, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6371395587921143
Epoch: 35, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6418399810791016
Epoch: 36, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6434307098388672
Epoch: 37, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5742635726928711
Epoch: 38, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5277855396270752
Epoch: 39, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.900 Test Loss: 0.210 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 122156
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.417341709136963
Epoch: 1, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.6066477298736572
Epoch: 2, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.197 Vali Acc: 0.600 Test Loss: 1.197 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 0.5855915546417236
Epoch: 3, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.082 Vali Acc: 0.650 Test Loss: 1.082 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 0.6698880195617676
Epoch: 4, Steps: 3 | Train Loss: 1.026 Vali Loss: 0.981 Vali Acc: 0.700 Test Loss: 0.981 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 0.6692912578582764
Epoch: 5, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.6242008209228516
Epoch: 6, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.796 Vali Acc: 0.775 Test Loss: 0.796 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 0.6368610858917236
Epoch: 7, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849993).  Saving model ...
Epoch: 8 cost time: 0.6695113182067871
Epoch: 8, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 0.7172503471374512
Epoch: 9, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.542 Vali Acc: 0.925 Test Loss: 0.542 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 10 cost time: 0.635350227355957
Epoch: 10, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.6328508853912354
Epoch: 11, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.6915040016174316
Epoch: 12, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.5995306968688965
Epoch: 13, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.335 Vali Acc: 0.975 Test Loss: 0.335 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.6186039447784424
Epoch: 14, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.6645512580871582
Epoch: 15, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.300 Vali Acc: 0.975 Test Loss: 0.300 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.634113073348999
Epoch: 16, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.67704176902771
Epoch: 17, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.6423814296722412
Epoch: 18, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.6299598217010498
Epoch: 19, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.6358990669250488
Epoch: 20, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.6465370655059814
Epoch: 21, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.7183644771575928
Epoch: 22, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.656745433807373
Epoch: 23, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.637528657913208
Epoch: 24, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6936237812042236
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6004095077514648
Epoch: 26, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7110509872436523
Epoch: 27, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5972025394439697
Epoch: 28, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6597640514373779
Epoch: 29, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6161506175994873
Epoch: 30, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5488307476043701
Epoch: 31, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 105772
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0989511013031006
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.290 Vali Acc: 0.525 Test Loss: 1.290 Test Acc: 0.525
Validation loss decreased (inf --> -0.524987).  Saving model ...
Epoch: 2 cost time: 0.5535910129547119
Epoch: 2, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.203 Vali Acc: 0.650 Test Loss: 1.203 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649988).  Saving model ...
Epoch: 3 cost time: 0.5905137062072754
Epoch: 3, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.087 Vali Acc: 0.750 Test Loss: 1.087 Test Acc: 0.750
Validation loss decreased (-0.649988 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 0.4574620723724365
Epoch: 4, Steps: 3 | Train Loss: 1.029 Vali Loss: 0.982 Vali Acc: 0.800 Test Loss: 0.982 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 5 cost time: 0.5157816410064697
Epoch: 5, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.890 Vali Acc: 0.825 Test Loss: 0.890 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 6 cost time: 0.6682193279266357
Epoch: 6, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 0.6380698680877686
Epoch: 7, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 0.588871955871582
Epoch: 8, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.6902945041656494
Epoch: 9, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.524 Vali Acc: 0.950 Test Loss: 0.524 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.6648457050323486
Epoch: 10, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.449 Vali Acc: 0.975 Test Loss: 0.449 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 0.5843966007232666
Epoch: 11, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.396 Vali Acc: 0.975 Test Loss: 0.396 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.6214802265167236
Epoch: 12, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.352 Vali Acc: 0.975 Test Loss: 0.352 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.6803383827209473
Epoch: 13, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.6735808849334717
Epoch: 14, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.6570236682891846
Epoch: 15, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.689678430557251
Epoch: 16, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.5896079540252686
Epoch: 17, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.6181020736694336
Epoch: 18, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.6825470924377441
Epoch: 19, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.7127718925476074
Epoch: 20, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.6055479049682617
Epoch: 21, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6677467823028564
Epoch: 22, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7004365921020508
Epoch: 23, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.6265170574188232
Epoch: 24, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.6616396903991699
Epoch: 25, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.6200392246246338
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6460897922515869
Epoch: 27, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.199 Vali Acc: 0.925 Test Loss: 0.199 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.684459924697876
Epoch: 28, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6376633644104004
Epoch: 29, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6701064109802246
Epoch: 30, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5888278484344482
Epoch: 31, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.900 Test Loss: 0.192 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6238341331481934
Epoch: 32, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.190 Vali Acc: 0.925 Test Loss: 0.190 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6303577423095703
Epoch: 33, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.188 Vali Acc: 0.925 Test Loss: 0.188 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6500430107116699
Epoch: 34, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5572006702423096
Epoch: 35, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.925 Test Loss: 0.188 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 105772
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.244811773300171
Epoch: 1, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.340 Vali Acc: 0.425 Test Loss: 1.340 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.5484652519226074
Epoch: 2, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.260 Vali Acc: 0.625 Test Loss: 1.260 Test Acc: 0.625
Validation loss decreased (-0.424987 --> -0.624987).  Saving model ...
Epoch: 3 cost time: 0.5637831687927246
Epoch: 3, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.145 Vali Acc: 0.700 Test Loss: 1.145 Test Acc: 0.700
Validation loss decreased (-0.624987 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 0.6292102336883545
Epoch: 4, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.033 Vali Acc: 0.725 Test Loss: 1.033 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 5 cost time: 0.5853903293609619
Epoch: 5, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.934 Vali Acc: 0.775 Test Loss: 0.934 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.5817430019378662
Epoch: 6, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.825 Vali Acc: 0.850 Test Loss: 0.825 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 0.5831880569458008
Epoch: 7, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.716 Vali Acc: 0.950 Test Loss: 0.716 Test Acc: 0.950
Validation loss decreased (-0.849992 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 0.6534082889556885
Epoch: 8, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.618 Vali Acc: 0.950 Test Loss: 0.618 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.5749638080596924
Epoch: 9, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.551 Vali Acc: 0.950 Test Loss: 0.551 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.7118608951568604
Epoch: 10, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.477 Vali Acc: 0.975 Test Loss: 0.477 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.6347477436065674
Epoch: 11, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.423 Vali Acc: 0.975 Test Loss: 0.423 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.6113266944885254
Epoch: 12, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.626786470413208
Epoch: 13, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.341 Vali Acc: 0.975 Test Loss: 0.341 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.6630113124847412
Epoch: 14, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.58400559425354
Epoch: 15, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6453771591186523
Epoch: 16, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.569774866104126
Epoch: 17, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6417434215545654
Epoch: 18, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.5725159645080566
Epoch: 19, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5896708965301514
Epoch: 20, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.631352424621582
Epoch: 21, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.634566068649292
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5612421035766602
Epoch: 23, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6663384437561035
Epoch: 24, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6329810619354248
Epoch: 25, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6094882488250732
Epoch: 26, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6268234252929688
Epoch: 27, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5570473670959473
Epoch: 28, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6662461757659912
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6203267574310303
Epoch: 30, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 105772
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.302973747253418
Epoch: 1, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.48737072944641113
Epoch: 2, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.282 Vali Acc: 0.575 Test Loss: 1.282 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574987).  Saving model ...
Epoch: 3 cost time: 0.5486423969268799
Epoch: 3, Steps: 3 | Train Loss: 1.121 Vali Loss: 1.181 Vali Acc: 0.650 Test Loss: 1.181 Test Acc: 0.650
Validation loss decreased (-0.574987 --> -0.649988).  Saving model ...
Epoch: 4 cost time: 0.4731483459472656
Epoch: 4, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.072 Vali Acc: 0.775 Test Loss: 1.072 Test Acc: 0.775
Validation loss decreased (-0.649988 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 0.4560093879699707
Epoch: 5, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.967 Vali Acc: 0.850 Test Loss: 0.967 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849990).  Saving model ...
Epoch: 6 cost time: 0.48150062561035156
Epoch: 6, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.863 Vali Acc: 0.900 Test Loss: 0.863 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 7 cost time: 0.5033535957336426
Epoch: 7, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.765 Vali Acc: 0.875 Test Loss: 0.765 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5979263782501221
Epoch: 8, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.676 Vali Acc: 0.925 Test Loss: 0.676 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 0.5504965782165527
Epoch: 9, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.611 Vali Acc: 0.900 Test Loss: 0.611 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5326855182647705
Epoch: 10, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5411450862884521
Epoch: 11, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.5623948574066162
Epoch: 12, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 0.5294802188873291
Epoch: 13, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.6003243923187256
Epoch: 14, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 0.5431311130523682
Epoch: 15, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5823993682861328
Epoch: 16, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5285580158233643
Epoch: 17, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5201864242553711
Epoch: 18, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5323586463928223
Epoch: 19, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.6577162742614746
Epoch: 20, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.4979724884033203
Epoch: 21, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.5165133476257324
Epoch: 22, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.5150399208068848
Epoch: 23, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5327069759368896
Epoch: 24, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5365486145019531
Epoch: 25, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4343137741088867
Epoch: 26, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.49128174781799316
Epoch: 27, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.5021955966949463
Epoch: 28, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5188848972320557
Epoch: 29, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.49680662155151367
Epoch: 30, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5518312454223633
Epoch: 31, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5536644458770752
Epoch: 32, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4721994400024414
Epoch: 33, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.4852640628814697
Epoch: 34, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.44684720039367676
Epoch: 35, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5167050361633301
Epoch: 36, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.4823143482208252
Epoch: 37, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.925 Test Loss: 0.198 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.46189212799072266
Epoch: 38, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 105772
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.221113443374634
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.262 Vali Acc: 0.475 Test Loss: 1.262 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.4980173110961914
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.218 Vali Acc: 0.575 Test Loss: 1.218 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 0.4630892276763916
Epoch: 3, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.5095856189727783
Epoch: 4, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.098 Vali Acc: 0.675 Test Loss: 1.098 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.4918210506439209
Epoch: 5, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.030 Vali Acc: 0.775 Test Loss: 1.030 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 0.5263185501098633
Epoch: 6, Steps: 3 | Train Loss: 0.941 Vali Loss: 0.957 Vali Acc: 0.875 Test Loss: 0.957 Test Acc: 0.875
Validation loss decreased (-0.774990 --> -0.874990).  Saving model ...
Epoch: 7 cost time: 0.5547122955322266
Epoch: 7, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.885 Vali Acc: 0.875 Test Loss: 0.885 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 8 cost time: 0.5555019378662109
Epoch: 8, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.813 Vali Acc: 0.875 Test Loss: 0.813 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 9 cost time: 0.5773437023162842
Epoch: 9, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.747 Vali Acc: 0.875 Test Loss: 0.747 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 10 cost time: 0.5736370086669922
Epoch: 10, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.678 Vali Acc: 0.900 Test Loss: 0.678 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.5297191143035889
Epoch: 11, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.5500020980834961
Epoch: 12, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.571 Vali Acc: 0.950 Test Loss: 0.571 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.5699701309204102
Epoch: 13, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.532 Vali Acc: 0.950 Test Loss: 0.532 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.5463974475860596
Epoch: 14, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5607855319976807
Epoch: 15, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.471 Vali Acc: 0.925 Test Loss: 0.471 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6179451942443848
Epoch: 16, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5504772663116455
Epoch: 17, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6075098514556885
Epoch: 18, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5722918510437012
Epoch: 19, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.566939115524292
Epoch: 20, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5920662879943848
Epoch: 21, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5726475715637207
Epoch: 22, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5290398597717285
Epoch: 23, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 298668
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3957083225250244
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.273 Vali Acc: 0.450 Test Loss: 1.273 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.5484437942504883
Epoch: 2, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.5880403518676758
Epoch: 3, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.178 Vali Acc: 0.575 Test Loss: 1.178 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.5748598575592041
Epoch: 4, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.110 Vali Acc: 0.675 Test Loss: 1.110 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.6634752750396729
Epoch: 5, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.047 Vali Acc: 0.750 Test Loss: 1.047 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 0.5933783054351807
Epoch: 6, Steps: 3 | Train Loss: 0.976 Vali Loss: 0.976 Vali Acc: 0.800 Test Loss: 0.976 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 7 cost time: 0.6134543418884277
Epoch: 7, Steps: 3 | Train Loss: 0.902 Vali Loss: 0.903 Vali Acc: 0.850 Test Loss: 0.903 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 8 cost time: 0.6711239814758301
Epoch: 8, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.829 Vali Acc: 0.875 Test Loss: 0.829 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 9 cost time: 0.6575613021850586
Epoch: 9, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.756 Vali Acc: 0.900 Test Loss: 0.756 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.7378904819488525
Epoch: 10, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.687 Vali Acc: 0.925 Test Loss: 0.687 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.638115644454956
Epoch: 11, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.629 Vali Acc: 0.950 Test Loss: 0.629 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.7066068649291992
Epoch: 12, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.579 Vali Acc: 0.975 Test Loss: 0.579 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.6122584342956543
Epoch: 13, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.536 Vali Acc: 0.975 Test Loss: 0.536 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 0.5633959770202637
Epoch: 14, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6083407402038574
Epoch: 15, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6760232448577881
Epoch: 16, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.440 Vali Acc: 0.925 Test Loss: 0.440 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6800441741943359
Epoch: 17, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6470851898193359
Epoch: 18, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6873598098754883
Epoch: 19, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6982424259185791
Epoch: 20, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6654403209686279
Epoch: 21, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6917085647583008
Epoch: 22, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6865220069885254
Epoch: 23, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 298668
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5429351329803467
Epoch: 1, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.303 Vali Acc: 0.425 Test Loss: 1.303 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.6083722114562988
Epoch: 2, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.265 Vali Acc: 0.475 Test Loss: 1.265 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.5887374877929688
Epoch: 3, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.218 Vali Acc: 0.575 Test Loss: 1.218 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.6294734477996826
Epoch: 4, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.160 Vali Acc: 0.650 Test Loss: 1.160 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.632688045501709
Epoch: 5, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 0.613480806350708
Epoch: 6, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.026 Vali Acc: 0.775 Test Loss: 1.026 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 7 cost time: 0.6217515468597412
Epoch: 7, Steps: 3 | Train Loss: 0.903 Vali Loss: 0.952 Vali Acc: 0.825 Test Loss: 0.952 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 8 cost time: 0.5956528186798096
Epoch: 8, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.877 Vali Acc: 0.875 Test Loss: 0.877 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.6461808681488037
Epoch: 9, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.801 Vali Acc: 0.900 Test Loss: 0.801 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.7173986434936523
Epoch: 10, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.728 Vali Acc: 0.925 Test Loss: 0.728 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.5740551948547363
Epoch: 11, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.664 Vali Acc: 0.925 Test Loss: 0.664 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.5678231716156006
Epoch: 12, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.612 Vali Acc: 0.925 Test Loss: 0.612 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.648200511932373
Epoch: 13, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.564 Vali Acc: 0.950 Test Loss: 0.564 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.637753963470459
Epoch: 14, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.519 Vali Acc: 0.950 Test Loss: 0.519 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.5795700550079346
Epoch: 15, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.489 Vali Acc: 0.950 Test Loss: 0.489 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5529019832611084
Epoch: 16, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.463 Vali Acc: 0.950 Test Loss: 0.463 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.628131628036499
Epoch: 17, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.6032953262329102
Epoch: 18, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.6408255100250244
Epoch: 19, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.6650576591491699
Epoch: 20, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.6643974781036377
Epoch: 21, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.5841796398162842
Epoch: 22, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.6307313442230225
Epoch: 23, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.5627985000610352
Epoch: 24, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5751509666442871
Epoch: 25, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.6226198673248291
Epoch: 26, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.6239845752716064
Epoch: 27, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.616309642791748
Epoch: 28, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5983495712280273
Epoch: 29, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5706193447113037
Epoch: 30, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6416764259338379
Epoch: 31, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6168186664581299
Epoch: 32, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6068024635314941
Epoch: 33, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6248548030853271
Epoch: 34, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.695624828338623
Epoch: 35, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6254675388336182
Epoch: 36, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 298668
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3125405311584473
Epoch: 1, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.6426718235015869
Epoch: 2, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.298 Vali Acc: 0.425 Test Loss: 1.298 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.55855393409729
Epoch: 3, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.253 Vali Acc: 0.600 Test Loss: 1.253 Test Acc: 0.600
Validation loss decreased (-0.424987 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.5448076725006104
Epoch: 4, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.194 Vali Acc: 0.625 Test Loss: 1.194 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.5658993721008301
Epoch: 5, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.127 Vali Acc: 0.675 Test Loss: 1.127 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.5477168560028076
Epoch: 6, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.060 Vali Acc: 0.750 Test Loss: 1.060 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.5416948795318604
Epoch: 7, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.991 Vali Acc: 0.800 Test Loss: 0.991 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.5530903339385986
Epoch: 8, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.923 Vali Acc: 0.850 Test Loss: 0.923 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.5788724422454834
Epoch: 9, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.858 Vali Acc: 0.875 Test Loss: 0.858 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 0.543856143951416
Epoch: 10, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.794 Vali Acc: 0.900 Test Loss: 0.794 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.5197451114654541
Epoch: 11, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.738 Vali Acc: 0.900 Test Loss: 0.738 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.6517734527587891
Epoch: 12, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.688 Vali Acc: 0.900 Test Loss: 0.688 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.5061964988708496
Epoch: 13, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.644 Vali Acc: 0.900 Test Loss: 0.644 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.5931706428527832
Epoch: 14, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.5319480895996094
Epoch: 15, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.570 Vali Acc: 0.900 Test Loss: 0.570 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.5703320503234863
Epoch: 16, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5767426490783691
Epoch: 17, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.5704803466796875
Epoch: 18, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.5458431243896484
Epoch: 19, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 0.57293701171875
Epoch: 20, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5824329853057861
Epoch: 21, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6154792308807373
Epoch: 22, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.597224235534668
Epoch: 23, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.5273301601409912
Epoch: 24, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.5217154026031494
Epoch: 25, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.514718770980835
Epoch: 26, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5456786155700684
Epoch: 27, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.6302378177642822
Epoch: 28, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.550666332244873
Epoch: 29, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.574042797088623
Epoch: 30, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5913701057434082
Epoch: 31, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6461031436920166
Epoch: 32, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.657529354095459
Epoch: 33, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5625908374786377
Epoch: 34, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6956570148468018
Epoch: 35, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.572216272354126
Epoch: 36, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5859951972961426
Epoch: 37, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6586015224456787
Epoch: 38, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 298668
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.431546926498413
Epoch: 1, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.301 Vali Acc: 0.300 Test Loss: 1.301 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.5958573818206787
Epoch: 2, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.259 Vali Acc: 0.350 Test Loss: 1.259 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.6017999649047852
Epoch: 3, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.206 Vali Acc: 0.425 Test Loss: 1.206 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.6275746822357178
Epoch: 4, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.137 Vali Acc: 0.475 Test Loss: 1.137 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474989).  Saving model ...
Epoch: 5 cost time: 0.6071810722351074
Epoch: 5, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.060 Vali Acc: 0.700 Test Loss: 1.060 Test Acc: 0.700
Validation loss decreased (-0.474989 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 0.6483964920043945
Epoch: 6, Steps: 3 | Train Loss: 0.997 Vali Loss: 0.981 Vali Acc: 0.800 Test Loss: 0.981 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799990).  Saving model ...
Epoch: 7 cost time: 0.6368367671966553
Epoch: 7, Steps: 3 | Train Loss: 0.954 Vali Loss: 0.903 Vali Acc: 0.800 Test Loss: 0.903 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.5987696647644043
Epoch: 8, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.825 Vali Acc: 0.850 Test Loss: 0.825 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.6628656387329102
Epoch: 9, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.750 Vali Acc: 0.875 Test Loss: 0.750 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.7179062366485596
Epoch: 10, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.680 Vali Acc: 0.925 Test Loss: 0.680 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.5718977451324463
Epoch: 11, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.617 Vali Acc: 0.925 Test Loss: 0.617 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 0.6098265647888184
Epoch: 12, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.7197613716125488
Epoch: 13, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.507 Vali Acc: 0.950 Test Loss: 0.507 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.6867241859436035
Epoch: 14, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.458 Vali Acc: 0.950 Test Loss: 0.458 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.7565937042236328
Epoch: 15, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.6065809726715088
Epoch: 16, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.6547436714172363
Epoch: 17, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.6448767185211182
Epoch: 18, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.7052876949310303
Epoch: 19, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.6363186836242676
Epoch: 20, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.7092850208282471
Epoch: 21, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.6875910758972168
Epoch: 22, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.765322208404541
Epoch: 23, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.7080755233764648
Epoch: 24, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.6759035587310791
Epoch: 25, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.7323968410491943
Epoch: 26, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.7729222774505615
Epoch: 27, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.7925238609313965
Epoch: 28, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.6985540390014648
Epoch: 29, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.7506413459777832
Epoch: 30, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.6516289710998535
Epoch: 31, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.6179156303405762
Epoch: 32, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.6789259910583496
Epoch: 33, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.6431360244750977
Epoch: 34, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.6919453144073486
Epoch: 35, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.5668952465057373
Epoch: 36, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5821056365966797
Epoch: 37, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.5548779964447021
Epoch: 38, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.5976235866546631
Epoch: 39, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.7116978168487549
Epoch: 40, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.5851335525512695
Epoch: 41, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.7295408248901367
Epoch: 42, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.5965785980224609
Epoch: 43, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.6402866840362549
Epoch: 44, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.5750761032104492
Epoch: 45, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.6199202537536621
Epoch: 46, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.5837752819061279
Epoch: 47, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.6005120277404785
Epoch: 48, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.6091187000274658
Epoch: 49, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.6954870223999023
Epoch: 50, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 51 cost time: 0.6832096576690674
Epoch: 51, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 52 cost time: 0.6544239521026611
Epoch: 52, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 53 cost time: 0.7169110774993896
Epoch: 53, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7098338603973389
Epoch: 54, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6925539970397949
Epoch: 55, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7322251796722412
Epoch: 56, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.654693603515625
Epoch: 57, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6464695930480957
Epoch: 58, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6211857795715332
Epoch: 59, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.7038826942443848
Epoch: 60, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.639930248260498
Epoch: 61, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 62 cost time: 0.5650382041931152
Epoch: 62, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 63 cost time: 0.7344865798950195
Epoch: 63, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 64 cost time: 0.6960151195526123
Epoch: 64, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 65 cost time: 0.6904706954956055
Epoch: 65, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6711447238922119
Epoch: 66, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 67 cost time: 0.688852071762085
Epoch: 67, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 68 cost time: 0.6700963973999023
Epoch: 68, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 0.7762942314147949
Epoch: 69, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 70 cost time: 0.7149264812469482
Epoch: 70, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 71 cost time: 0.6523857116699219
Epoch: 71, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 72 cost time: 0.6654841899871826
Epoch: 72, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.6354992389678955
Epoch: 73, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.6490144729614258
Epoch: 74, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.740858793258667
Epoch: 75, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 76 cost time: 0.6091833114624023
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.5830371379852295
Epoch: 77, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 78 cost time: 0.5767700672149658
Epoch: 78, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.678492546081543
Epoch: 79, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.6206052303314209
Epoch: 80, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 81 cost time: 0.5720345973968506
Epoch: 81, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 82 cost time: 0.5930917263031006
Epoch: 82, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 83 cost time: 0.7031223773956299
Epoch: 83, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7031946182250977
Epoch: 84, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7373003959655762
Epoch: 85, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.7444722652435303
Epoch: 86, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.7342619895935059
Epoch: 87, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.7965426445007324
Epoch: 88, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.7067897319793701
Epoch: 89, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.6676375865936279
Epoch: 90, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.6878671646118164
Epoch: 91, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.6727199554443359
Epoch: 92, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 167596
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.601679563522339
Epoch: 1, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.325 Vali Acc: 0.300 Test Loss: 1.325 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.6317031383514404
Epoch: 2, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.285 Vali Acc: 0.350 Test Loss: 1.285 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.6225624084472656
Epoch: 3, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.233 Vali Acc: 0.475 Test Loss: 1.233 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.5950524806976318
Epoch: 4, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.6786110401153564
Epoch: 5, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.087 Vali Acc: 0.625 Test Loss: 1.087 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.6426208019256592
Epoch: 6, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.623222827911377
Epoch: 7, Steps: 3 | Train Loss: 0.948 Vali Loss: 0.925 Vali Acc: 0.750 Test Loss: 0.925 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 0.697211742401123
Epoch: 8, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.6521809101104736
Epoch: 9, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.765 Vali Acc: 0.900 Test Loss: 0.765 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.6078898906707764
Epoch: 10, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.695 Vali Acc: 0.950 Test Loss: 0.695 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949993).  Saving model ...
Epoch: 11 cost time: 0.6885862350463867
Epoch: 11, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.632 Vali Acc: 0.950 Test Loss: 0.632 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.618619441986084
Epoch: 12, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.572 Vali Acc: 0.950 Test Loss: 0.572 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.5380618572235107
Epoch: 13, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.523 Vali Acc: 0.950 Test Loss: 0.523 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.6432676315307617
Epoch: 14, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.6354093551635742
Epoch: 15, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.430 Vali Acc: 0.950 Test Loss: 0.430 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.5776669979095459
Epoch: 16, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.6084246635437012
Epoch: 17, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5614509582519531
Epoch: 18, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.6206169128417969
Epoch: 19, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.6800277233123779
Epoch: 20, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.7065651416778564
Epoch: 21, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.7500929832458496
Epoch: 22, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.637042760848999
Epoch: 23, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.6475830078125
Epoch: 24, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.6207375526428223
Epoch: 25, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7089250087738037
Epoch: 26, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.683784008026123
Epoch: 27, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6532220840454102
Epoch: 28, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5840504169464111
Epoch: 29, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6594483852386475
Epoch: 30, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6489481925964355
Epoch: 31, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6562361717224121
Epoch: 32, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6108653545379639
Epoch: 33, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6979048252105713
Epoch: 34, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 167596
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.553926706314087
Epoch: 1, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5795629024505615
Epoch: 2, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.311 Vali Acc: 0.375 Test Loss: 1.311 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.5305964946746826
Epoch: 3, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.259 Vali Acc: 0.425 Test Loss: 1.259 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.6306197643280029
Epoch: 4, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.5579555034637451
Epoch: 5, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.114 Vali Acc: 0.575 Test Loss: 1.114 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.5360894203186035
Epoch: 6, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
Validation loss decreased (-0.574989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.5084075927734375
Epoch: 7, Steps: 3 | Train Loss: 0.943 Vali Loss: 0.954 Vali Acc: 0.775 Test Loss: 0.954 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.5387356281280518
Epoch: 8, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.872 Vali Acc: 0.850 Test Loss: 0.872 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.5198624134063721
Epoch: 9, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.793 Vali Acc: 0.925 Test Loss: 0.793 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924992).  Saving model ...
Epoch: 10 cost time: 0.5779318809509277
Epoch: 10, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.720 Vali Acc: 0.950 Test Loss: 0.720 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 11 cost time: 0.5863473415374756
Epoch: 11, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.654 Vali Acc: 0.950 Test Loss: 0.654 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.5507252216339111
Epoch: 12, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.593 Vali Acc: 0.950 Test Loss: 0.593 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.6062819957733154
Epoch: 13, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.542 Vali Acc: 0.950 Test Loss: 0.542 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.6189150810241699
Epoch: 14, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.495 Vali Acc: 0.950 Test Loss: 0.495 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.5425963401794434
Epoch: 15, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5554559230804443
Epoch: 16, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.5563466548919678
Epoch: 17, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5543568134307861
Epoch: 18, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.609522819519043
Epoch: 19, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.6253395080566406
Epoch: 20, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5109140872955322
Epoch: 21, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.6409482955932617
Epoch: 22, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.6071810722351074
Epoch: 23, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.6704823970794678
Epoch: 24, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5690362453460693
Epoch: 25, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.5813958644866943
Epoch: 26, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.5187587738037109
Epoch: 27, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.6084473133087158
Epoch: 28, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.5440974235534668
Epoch: 29, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.6216797828674316
Epoch: 30, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.6173970699310303
Epoch: 31, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.5944604873657227
Epoch: 32, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5539083480834961
Epoch: 33, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.5505824089050293
Epoch: 34, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.5695807933807373
Epoch: 35, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.5407588481903076
Epoch: 36, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5640404224395752
Epoch: 37, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.567180871963501
Epoch: 38, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.6270794868469238
Epoch: 39, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.5600857734680176
Epoch: 40, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.6636979579925537
Epoch: 41, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.5897061824798584
Epoch: 42, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.5711605548858643
Epoch: 43, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.6140618324279785
Epoch: 44, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.5411570072174072
Epoch: 45, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.5574951171875
Epoch: 46, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.561042308807373
Epoch: 47, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.5652554035186768
Epoch: 48, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.5685179233551025
Epoch: 49, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.6792504787445068
Epoch: 50, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 51 cost time: 0.541212797164917
Epoch: 51, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 52 cost time: 0.5668554306030273
Epoch: 52, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6125962734222412
Epoch: 53, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5201189517974854
Epoch: 54, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6359753608703613
Epoch: 55, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 56 cost time: 0.7443604469299316
Epoch: 56, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 0.6998190879821777
Epoch: 57, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 0.6805369853973389
Epoch: 58, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 59 cost time: 0.6056737899780273
Epoch: 59, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 60 cost time: 0.588972806930542
Epoch: 60, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 61 cost time: 0.6588852405548096
Epoch: 61, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 62 cost time: 0.6268773078918457
Epoch: 62, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 63 cost time: 0.7126953601837158
Epoch: 63, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6471495628356934
Epoch: 64, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 65 cost time: 0.6702876091003418
Epoch: 65, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 66 cost time: 0.5971651077270508
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 67 cost time: 0.6046569347381592
Epoch: 67, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 68 cost time: 0.6546823978424072
Epoch: 68, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 0.6134922504425049
Epoch: 69, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 70 cost time: 0.6418797969818115
Epoch: 70, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.72776198387146
Epoch: 71, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 72 cost time: 0.6321721076965332
Epoch: 72, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7221329212188721
Epoch: 73, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 74 cost time: 0.7539675235748291
Epoch: 74, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.6717495918273926
Epoch: 75, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 76 cost time: 0.7044539451599121
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 77 cost time: 0.6770725250244141
Epoch: 77, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 78 cost time: 0.6661462783813477
Epoch: 78, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6177332401275635
Epoch: 79, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.5713832378387451
Epoch: 80, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.5764510631561279
Epoch: 81, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.5352168083190918
Epoch: 82, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.5867536067962646
Epoch: 83, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.5857799053192139
Epoch: 84, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.6314675807952881
Epoch: 85, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.5739953517913818
Epoch: 86, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.5280134677886963
Epoch: 87, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 167596
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4450161457061768
Epoch: 1, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5510010719299316
Epoch: 2, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.323 Vali Acc: 0.425 Test Loss: 1.323 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.6622908115386963
Epoch: 3, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.279 Vali Acc: 0.475 Test Loss: 1.279 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.587212324142456
Epoch: 4, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.6057829856872559
Epoch: 5, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.156 Vali Acc: 0.525 Test Loss: 1.156 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.5442690849304199
Epoch: 6, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.086 Vali Acc: 0.575 Test Loss: 1.086 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.587867021560669
Epoch: 7, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
Validation loss decreased (-0.574989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.5046155452728271
Epoch: 8, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.946 Vali Acc: 0.800 Test Loss: 0.946 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.5726726055145264
Epoch: 9, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.881 Vali Acc: 0.875 Test Loss: 0.881 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 0.6328060626983643
Epoch: 10, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.820 Vali Acc: 0.925 Test Loss: 0.820 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.619370698928833
Epoch: 11, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.764 Vali Acc: 0.925 Test Loss: 0.764 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 12 cost time: 0.5842618942260742
Epoch: 12, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.712 Vali Acc: 0.875 Test Loss: 0.712 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5460898876190186
Epoch: 13, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5885822772979736
Epoch: 14, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6443283557891846
Epoch: 15, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.558229923248291
Epoch: 16, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.549 Vali Acc: 0.875 Test Loss: 0.549 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5748460292816162
Epoch: 17, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5931801795959473
Epoch: 18, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6360044479370117
Epoch: 19, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.625483512878418
Epoch: 20, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6026017665863037
Epoch: 21, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 167596
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2498245239257812
Epoch: 1, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.367 Vali Acc: 0.150 Test Loss: 1.367 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.6275322437286377
Epoch: 2, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.316 Vali Acc: 0.200 Test Loss: 1.316 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.5827479362487793
Epoch: 3, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.254 Vali Acc: 0.350 Test Loss: 1.254 Test Acc: 0.350
Validation loss decreased (-0.199987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.6432445049285889
Epoch: 4, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.184 Vali Acc: 0.375 Test Loss: 1.184 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.6745340824127197
Epoch: 5, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.114 Vali Acc: 0.425 Test Loss: 1.114 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424989).  Saving model ...
Epoch: 6 cost time: 0.5552675724029541
Epoch: 6, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.042 Vali Acc: 0.525 Test Loss: 1.042 Test Acc: 0.525
Validation loss decreased (-0.424989 --> -0.524990).  Saving model ...
Epoch: 7 cost time: 0.7030348777770996
Epoch: 7, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.962 Vali Acc: 0.700 Test Loss: 0.962 Test Acc: 0.700
Validation loss decreased (-0.524990 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.6787965297698975
Epoch: 8, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.887 Vali Acc: 0.850 Test Loss: 0.887 Test Acc: 0.850
Validation loss decreased (-0.699990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.6584537029266357
Epoch: 9, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.804 Vali Acc: 0.900 Test Loss: 0.804 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.639564037322998
Epoch: 10, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.727 Vali Acc: 0.900 Test Loss: 0.727 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.6190102100372314
Epoch: 11, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.660 Vali Acc: 0.900 Test Loss: 0.660 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.5743153095245361
Epoch: 12, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.604 Vali Acc: 0.900 Test Loss: 0.604 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.7131006717681885
Epoch: 13, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6653876304626465
Epoch: 14, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.6720366477966309
Epoch: 15, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.7602481842041016
Epoch: 16, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.439 Vali Acc: 0.950 Test Loss: 0.439 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.6698763370513916
Epoch: 17, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.6968693733215332
Epoch: 18, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.6745288372039795
Epoch: 19, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6304254531860352
Epoch: 20, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6930904388427734
Epoch: 21, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7220847606658936
Epoch: 22, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6730833053588867
Epoch: 23, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.7668318748474121
Epoch: 24, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7030103206634521
Epoch: 25, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7395577430725098
Epoch: 26, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7015419006347656
Epoch: 27, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7025320529937744
Epoch: 28, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.662391185760498
Epoch: 29, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6480185985565186
Epoch: 30, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7440698146820068
Epoch: 31, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.674736499786377
Epoch: 32, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5947420597076416
Epoch: 33, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 102060
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5078845024108887
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.368 Vali Acc: 0.250 Test Loss: 1.368 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5777711868286133
Epoch: 2, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.319 Vali Acc: 0.300 Test Loss: 1.319 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.5785067081451416
Epoch: 3, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.262 Vali Acc: 0.375 Test Loss: 1.262 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.6286756992340088
Epoch: 4, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.5858495235443115
Epoch: 5, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.127 Vali Acc: 0.450 Test Loss: 1.127 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449989).  Saving model ...
Epoch: 6 cost time: 0.6194775104522705
Epoch: 6, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.057 Vali Acc: 0.575 Test Loss: 1.057 Test Acc: 0.575
Validation loss decreased (-0.449989 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.6492252349853516
Epoch: 7, Steps: 3 | Train Loss: 0.901 Vali Loss: 0.978 Vali Acc: 0.800 Test Loss: 0.978 Test Acc: 0.800
Validation loss decreased (-0.574989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.6393616199493408
Epoch: 8, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.906 Vali Acc: 0.850 Test Loss: 0.906 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.6118900775909424
Epoch: 9, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.823 Vali Acc: 0.900 Test Loss: 0.823 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.6124646663665771
Epoch: 10, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.745 Vali Acc: 0.925 Test Loss: 0.745 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.6290128231048584
Epoch: 11, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.674 Vali Acc: 0.900 Test Loss: 0.674 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6469497680664062
Epoch: 12, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.613 Vali Acc: 0.925 Test Loss: 0.613 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.656296968460083
Epoch: 13, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.567 Vali Acc: 0.950 Test Loss: 0.567 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.6547834873199463
Epoch: 14, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.521 Vali Acc: 0.950 Test Loss: 0.521 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.662029504776001
Epoch: 15, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.482 Vali Acc: 0.975 Test Loss: 0.482 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.6305279731750488
Epoch: 16, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6648921966552734
Epoch: 17, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6766345500946045
Epoch: 18, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6379129886627197
Epoch: 19, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6576452255249023
Epoch: 20, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6517801284790039
Epoch: 21, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6598978042602539
Epoch: 22, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6427860260009766
Epoch: 23, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6385514736175537
Epoch: 24, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5808930397033691
Epoch: 25, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 102060
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.421241044998169
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.388 Vali Acc: 0.200 Test Loss: 1.388 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.6666257381439209
Epoch: 2, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.342 Vali Acc: 0.275 Test Loss: 1.342 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.5195481777191162
Epoch: 3, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.289 Vali Acc: 0.250 Test Loss: 1.289 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5530977249145508
Epoch: 4, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.225 Vali Acc: 0.325 Test Loss: 1.225 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324988).  Saving model ...
Epoch: 5 cost time: 0.4561948776245117
Epoch: 5, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.158 Vali Acc: 0.475 Test Loss: 1.158 Test Acc: 0.475
Validation loss decreased (-0.324988 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.509026288986206
Epoch: 6, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
Validation loss decreased (-0.474988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.5194182395935059
Epoch: 7, Steps: 3 | Train Loss: 0.894 Vali Loss: 1.011 Vali Acc: 0.775 Test Loss: 1.011 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.5203940868377686
Epoch: 8, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.939 Vali Acc: 0.825 Test Loss: 0.939 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.4815099239349365
Epoch: 9, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.861 Vali Acc: 0.900 Test Loss: 0.861 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899991).  Saving model ...
Epoch: 10 cost time: 0.5290331840515137
Epoch: 10, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.783 Vali Acc: 0.925 Test Loss: 0.783 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.45314717292785645
Epoch: 11, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.711 Vali Acc: 0.900 Test Loss: 0.711 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5323805809020996
Epoch: 12, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.648 Vali Acc: 0.900 Test Loss: 0.648 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5082738399505615
Epoch: 13, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.597 Vali Acc: 0.925 Test Loss: 0.597 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.5267629623413086
Epoch: 14, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.549 Vali Acc: 0.925 Test Loss: 0.549 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.5186200141906738
Epoch: 15, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.507 Vali Acc: 0.925 Test Loss: 0.507 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.5535967350006104
Epoch: 16, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.470 Vali Acc: 0.950 Test Loss: 0.470 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.4794900417327881
Epoch: 17, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5290055274963379
Epoch: 18, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.49458956718444824
Epoch: 19, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.512880802154541
Epoch: 20, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.493091344833374
Epoch: 21, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.5237870216369629
Epoch: 22, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.5686378479003906
Epoch: 23, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.5825495719909668
Epoch: 24, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5422356128692627
Epoch: 25, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.5053501129150391
Epoch: 26, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.5689353942871094
Epoch: 27, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.5308566093444824
Epoch: 28, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5654616355895996
Epoch: 29, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5315799713134766
Epoch: 30, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5389614105224609
Epoch: 31, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5440006256103516
Epoch: 32, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5008563995361328
Epoch: 33, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5971291065216064
Epoch: 34, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5535609722137451
Epoch: 35, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5304474830627441
Epoch: 36, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.48204803466796875
Epoch: 37, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 102060
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4698123931884766
Epoch: 1, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5874307155609131
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.347 Vali Acc: 0.275 Test Loss: 1.347 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.5561795234680176
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.298 Vali Acc: 0.275 Test Loss: 1.298 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.5762732028961182
Epoch: 4, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
Validation loss decreased (-0.274987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.6372084617614746
Epoch: 5, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.167 Vali Acc: 0.475 Test Loss: 1.167 Test Acc: 0.475
Validation loss decreased (-0.399988 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.6348168849945068
Epoch: 6, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.101 Vali Acc: 0.525 Test Loss: 1.101 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.5755720138549805
Epoch: 7, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.033 Vali Acc: 0.800 Test Loss: 1.033 Test Acc: 0.800
Validation loss decreased (-0.524989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.5789992809295654
Epoch: 8, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.967 Vali Acc: 0.875 Test Loss: 0.967 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874990).  Saving model ...
Epoch: 9 cost time: 0.5447869300842285
Epoch: 9, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.899 Vali Acc: 0.850 Test Loss: 0.899 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.529402494430542
Epoch: 10, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.834 Vali Acc: 0.900 Test Loss: 0.834 Test Acc: 0.900
Validation loss decreased (-0.874990 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.5855011940002441
Epoch: 11, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.773 Vali Acc: 0.875 Test Loss: 0.773 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5187063217163086
Epoch: 12, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5436885356903076
Epoch: 13, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5471782684326172
Epoch: 14, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.616 Vali Acc: 0.900 Test Loss: 0.616 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.5958676338195801
Epoch: 15, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.576 Vali Acc: 0.950 Test Loss: 0.576 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 16 cost time: 0.5515885353088379
Epoch: 16, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.540 Vali Acc: 0.950 Test Loss: 0.540 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.6140828132629395
Epoch: 17, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.509 Vali Acc: 0.950 Test Loss: 0.509 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.5708038806915283
Epoch: 18, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.483 Vali Acc: 0.950 Test Loss: 0.483 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 0.5416157245635986
Epoch: 19, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 20 cost time: 0.5184798240661621
Epoch: 20, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.5386004447937012
Epoch: 21, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.429 Vali Acc: 0.950 Test Loss: 0.429 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.6594574451446533
Epoch: 22, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5748343467712402
Epoch: 23, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6734180450439453
Epoch: 24, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5668847560882568
Epoch: 25, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5850179195404053
Epoch: 26, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6387996673583984
Epoch: 27, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.676816463470459
Epoch: 28, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5707759857177734
Epoch: 29, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5447442531585693
Epoch: 30, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.592017650604248
Epoch: 31, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 102060
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5374937057495117
Epoch: 1, Steps: 3 | Train Loss: 1.571 Vali Loss: 1.328 Vali Acc: 0.175 Test Loss: 1.328 Test Acc: 0.175
Validation loss decreased (inf --> -0.174987).  Saving model ...
Epoch: 2 cost time: 0.6950688362121582
Epoch: 2, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.285 Vali Acc: 0.175 Test Loss: 1.285 Test Acc: 0.175
Validation loss decreased (-0.174987 --> -0.174987).  Saving model ...
Epoch: 3 cost time: 0.6165320873260498
Epoch: 3, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.226 Vali Acc: 0.275 Test Loss: 1.226 Test Acc: 0.275
Validation loss decreased (-0.174987 --> -0.274988).  Saving model ...
Epoch: 4 cost time: 0.5754563808441162
Epoch: 4, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.160 Vali Acc: 0.325 Test Loss: 1.160 Test Acc: 0.325
Validation loss decreased (-0.274988 --> -0.324988).  Saving model ...
Epoch: 5 cost time: 0.6166775226593018
Epoch: 5, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.085 Vali Acc: 0.375 Test Loss: 1.085 Test Acc: 0.375
Validation loss decreased (-0.324988 --> -0.374989).  Saving model ...
Epoch: 6 cost time: 0.6847779750823975
Epoch: 6, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.010 Vali Acc: 0.625 Test Loss: 1.010 Test Acc: 0.625
Validation loss decreased (-0.374989 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.6008081436157227
Epoch: 7, Steps: 3 | Train Loss: 0.946 Vali Loss: 0.934 Vali Acc: 0.725 Test Loss: 0.934 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 0.60247802734375
Epoch: 8, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.852 Vali Acc: 0.900 Test Loss: 0.852 Test Acc: 0.900
Validation loss decreased (-0.724991 --> -0.899991).  Saving model ...
Epoch: 9 cost time: 0.6534671783447266
Epoch: 9, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.770 Vali Acc: 0.900 Test Loss: 0.770 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.5725491046905518
Epoch: 10, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.703 Vali Acc: 0.900 Test Loss: 0.703 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.5502786636352539
Epoch: 11, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 0.5596065521240234
Epoch: 12, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.590 Vali Acc: 0.925 Test Loss: 0.590 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.543039083480835
Epoch: 13, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.535 Vali Acc: 0.975 Test Loss: 0.535 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 0.4754002094268799
Epoch: 14, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.486 Vali Acc: 0.975 Test Loss: 0.486 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.5772924423217773
Epoch: 15, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.451 Vali Acc: 0.975 Test Loss: 0.451 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.5486128330230713
Epoch: 16, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.412 Vali Acc: 0.975 Test Loss: 0.412 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.5057575702667236
Epoch: 17, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.380 Vali Acc: 0.975 Test Loss: 0.380 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.6016840934753418
Epoch: 18, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.5781111717224121
Epoch: 19, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.6063065528869629
Epoch: 20, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.48862457275390625
Epoch: 21, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.6591334342956543
Epoch: 22, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.5945186614990234
Epoch: 23, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.5692830085754395
Epoch: 24, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.536609411239624
Epoch: 25, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.5663704872131348
Epoch: 26, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.5236406326293945
Epoch: 27, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5825023651123047
Epoch: 28, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5895345211029053
Epoch: 29, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5842833518981934
Epoch: 30, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6071770191192627
Epoch: 31, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5154154300689697
Epoch: 32, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6110067367553711
Epoch: 33, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5392656326293945
Epoch: 34, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.549135684967041
Epoch: 35, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5655562877655029
Epoch: 36, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 69292
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4365646839141846
Epoch: 1, Steps: 3 | Train Loss: 1.550 Vali Loss: 1.341 Vali Acc: 0.150 Test Loss: 1.341 Test Acc: 0.150
Validation loss decreased (inf --> -0.149987).  Saving model ...
Epoch: 2 cost time: 0.6687023639678955
Epoch: 2, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
Validation loss decreased (-0.149987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.6329784393310547
Epoch: 3, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.242 Vali Acc: 0.250 Test Loss: 1.242 Test Acc: 0.250
Validation loss decreased (-0.199987 --> -0.249988).  Saving model ...
Epoch: 4 cost time: 0.6258015632629395
Epoch: 4, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.174 Vali Acc: 0.300 Test Loss: 1.174 Test Acc: 0.300
Validation loss decreased (-0.249988 --> -0.299988).  Saving model ...
Epoch: 5 cost time: 0.6875841617584229
Epoch: 5, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.100 Vali Acc: 0.350 Test Loss: 1.100 Test Acc: 0.350
Validation loss decreased (-0.299988 --> -0.349989).  Saving model ...
Epoch: 6 cost time: 0.7023963928222656
Epoch: 6, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.025 Vali Acc: 0.625 Test Loss: 1.025 Test Acc: 0.625
Validation loss decreased (-0.349989 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.6778826713562012
Epoch: 7, Steps: 3 | Train Loss: 0.945 Vali Loss: 0.947 Vali Acc: 0.800 Test Loss: 0.947 Test Acc: 0.800
Validation loss decreased (-0.624990 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.6360325813293457
Epoch: 8, Steps: 3 | Train Loss: 0.894 Vali Loss: 0.866 Vali Acc: 0.925 Test Loss: 0.866 Test Acc: 0.925
Validation loss decreased (-0.799991 --> -0.924991).  Saving model ...
Epoch: 9 cost time: 0.5997297763824463
Epoch: 9, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.784 Vali Acc: 0.925 Test Loss: 0.784 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 10 cost time: 0.6658244132995605
Epoch: 10, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.715 Vali Acc: 0.925 Test Loss: 0.715 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.5888509750366211
Epoch: 11, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.656 Vali Acc: 0.975 Test Loss: 0.656 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974993).  Saving model ...
Epoch: 12 cost time: 0.6600537300109863
Epoch: 12, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.600 Vali Acc: 0.975 Test Loss: 0.600 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.6121413707733154
Epoch: 13, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.544 Vali Acc: 0.975 Test Loss: 0.544 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 0.5987708568572998
Epoch: 14, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.493 Vali Acc: 0.975 Test Loss: 0.493 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.724912166595459
Epoch: 15, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.455 Vali Acc: 0.975 Test Loss: 0.455 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.69173264503479
Epoch: 16, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.417 Vali Acc: 0.975 Test Loss: 0.417 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.6888446807861328
Epoch: 17, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.389 Vali Acc: 0.975 Test Loss: 0.389 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.693556547164917
Epoch: 18, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.646357536315918
Epoch: 19, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6525430679321289
Epoch: 20, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7353448867797852
Epoch: 21, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6073825359344482
Epoch: 22, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6545255184173584
Epoch: 23, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6395909786224365
Epoch: 24, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6996443271636963
Epoch: 25, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5769946575164795
Epoch: 26, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6232647895812988
Epoch: 27, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 69292
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3194704055786133
Epoch: 1, Steps: 3 | Train Loss: 1.520 Vali Loss: 1.347 Vali Acc: 0.200 Test Loss: 1.347 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.6331257820129395
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.306 Vali Acc: 0.300 Test Loss: 1.306 Test Acc: 0.300
Validation loss decreased (-0.199987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.5564768314361572
Epoch: 3, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.254 Vali Acc: 0.300 Test Loss: 1.254 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.5773143768310547
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.189 Vali Acc: 0.325 Test Loss: 1.189 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324988).  Saving model ...
Epoch: 5 cost time: 0.5773546695709229
Epoch: 5, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.116 Vali Acc: 0.450 Test Loss: 1.116 Test Acc: 0.450
Validation loss decreased (-0.324988 --> -0.449989).  Saving model ...
Epoch: 6 cost time: 0.5466780662536621
Epoch: 6, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.039 Vali Acc: 0.675 Test Loss: 1.039 Test Acc: 0.675
Validation loss decreased (-0.449989 --> -0.674990).  Saving model ...
Epoch: 7 cost time: 0.5685207843780518
Epoch: 7, Steps: 3 | Train Loss: 0.956 Vali Loss: 0.962 Vali Acc: 0.825 Test Loss: 0.962 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824990).  Saving model ...
Epoch: 8 cost time: 0.5968062877655029
Epoch: 8, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.882 Vali Acc: 0.925 Test Loss: 0.882 Test Acc: 0.925
Validation loss decreased (-0.824990 --> -0.924991).  Saving model ...
Epoch: 9 cost time: 0.5938682556152344
Epoch: 9, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.804 Vali Acc: 0.950 Test Loss: 0.804 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949992).  Saving model ...
Epoch: 10 cost time: 0.5387916564941406
Epoch: 10, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.738 Vali Acc: 0.950 Test Loss: 0.738 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 11 cost time: 0.5426080226898193
Epoch: 11, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.676 Vali Acc: 0.950 Test Loss: 0.676 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.5461294651031494
Epoch: 12, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.619 Vali Acc: 0.975 Test Loss: 0.619 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.6107845306396484
Epoch: 13, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.563 Vali Acc: 0.975 Test Loss: 0.563 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.578603982925415
Epoch: 14, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.513 Vali Acc: 0.975 Test Loss: 0.513 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.5449323654174805
Epoch: 15, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.476 Vali Acc: 0.975 Test Loss: 0.476 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.5592575073242188
Epoch: 16, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.440 Vali Acc: 0.975 Test Loss: 0.440 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.5518150329589844
Epoch: 17, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.411 Vali Acc: 0.975 Test Loss: 0.411 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.5506839752197266
Epoch: 18, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.391 Vali Acc: 0.975 Test Loss: 0.391 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.5589754581451416
Epoch: 19, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.634448766708374
Epoch: 20, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.354 Vali Acc: 0.975 Test Loss: 0.354 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.5955688953399658
Epoch: 21, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5872514247894287
Epoch: 22, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.309 Vali Acc: 0.975 Test Loss: 0.309 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.5668134689331055
Epoch: 23, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5687427520751953
Epoch: 24, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6254169940948486
Epoch: 25, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5965883731842041
Epoch: 26, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6218605041503906
Epoch: 27, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.49224185943603516
Epoch: 28, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5316646099090576
Epoch: 29, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5668110847473145
Epoch: 30, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.639113187789917
Epoch: 31, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5190691947937012
Epoch: 32, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 69292
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3351380825042725
Epoch: 1, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.344 Vali Acc: 0.250 Test Loss: 1.344 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.5419259071350098
Epoch: 2, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.311 Vali Acc: 0.275 Test Loss: 1.311 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.5941207408905029
Epoch: 3, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.265 Vali Acc: 0.275 Test Loss: 1.265 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.5792155265808105
Epoch: 4, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.211 Vali Acc: 0.350 Test Loss: 1.211 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349988).  Saving model ...
Epoch: 5 cost time: 0.5953459739685059
Epoch: 5, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.349988 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5280847549438477
Epoch: 6, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.086 Vali Acc: 0.725 Test Loss: 1.086 Test Acc: 0.725
Validation loss decreased (-0.399989 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.5583052635192871
Epoch: 7, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.019 Vali Acc: 0.800 Test Loss: 1.019 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.5750319957733154
Epoch: 8, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.948 Vali Acc: 0.900 Test Loss: 0.948 Test Acc: 0.900
Validation loss decreased (-0.799990 --> -0.899991).  Saving model ...
Epoch: 9 cost time: 0.5793719291687012
Epoch: 9, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.883 Vali Acc: 0.925 Test Loss: 0.883 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924991).  Saving model ...
Epoch: 10 cost time: 0.5187468528747559
Epoch: 10, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.825 Vali Acc: 0.950 Test Loss: 0.825 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949992).  Saving model ...
Epoch: 11 cost time: 0.5270044803619385
Epoch: 11, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.772 Vali Acc: 0.950 Test Loss: 0.772 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 12 cost time: 0.5500369071960449
Epoch: 12, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.721 Vali Acc: 0.900 Test Loss: 0.721 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5590033531188965
Epoch: 13, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5581328868865967
Epoch: 14, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.546532154083252
Epoch: 15, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.594 Vali Acc: 0.875 Test Loss: 0.594 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5413079261779785
Epoch: 16, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.554 Vali Acc: 0.900 Test Loss: 0.554 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5680344104766846
Epoch: 17, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.520 Vali Acc: 0.925 Test Loss: 0.520 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5772716999053955
Epoch: 18, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5784444808959961
Epoch: 19, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.474 Vali Acc: 0.925 Test Loss: 0.474 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5601036548614502
Epoch: 20, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.562140941619873
Epoch: 21, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 69292
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.559605836868286
Epoch: 1, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.341 Vali Acc: 0.425 Test Loss: 1.341 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.6892495155334473
Epoch: 2, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.290 Vali Acc: 0.475 Test Loss: 1.290 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.5965955257415771
Epoch: 3, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.5866653919219971
Epoch: 4, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.155 Vali Acc: 0.525 Test Loss: 1.155 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.6563572883605957
Epoch: 5, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.082 Vali Acc: 0.625 Test Loss: 1.082 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.6862707138061523
Epoch: 6, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.011 Vali Acc: 0.750 Test Loss: 1.011 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 0.6688385009765625
Epoch: 7, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.941 Vali Acc: 0.850 Test Loss: 0.941 Test Acc: 0.850
Validation loss decreased (-0.749990 --> -0.849991).  Saving model ...
Epoch: 8 cost time: 0.6137878894805908
Epoch: 8, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.863 Vali Acc: 0.875 Test Loss: 0.863 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.5904946327209473
Epoch: 9, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.779 Vali Acc: 0.900 Test Loss: 0.779 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.6570115089416504
Epoch: 10, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.699 Vali Acc: 0.950 Test Loss: 0.699 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949993).  Saving model ...
Epoch: 11 cost time: 0.591850757598877
Epoch: 11, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.627 Vali Acc: 0.975 Test Loss: 0.627 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 12 cost time: 0.6193373203277588
Epoch: 12, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.570 Vali Acc: 0.975 Test Loss: 0.570 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.5775120258331299
Epoch: 13, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.527 Vali Acc: 0.975 Test Loss: 0.527 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 0.651500940322876
Epoch: 14, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.493 Vali Acc: 0.950 Test Loss: 0.493 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6801362037658691
Epoch: 15, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.457 Vali Acc: 0.950 Test Loss: 0.457 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6806082725524902
Epoch: 16, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6728839874267578
Epoch: 17, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6457476615905762
Epoch: 18, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6735091209411621
Epoch: 19, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6249873638153076
Epoch: 20, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7022697925567627
Epoch: 21, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6035335063934326
Epoch: 22, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6101553440093994
Epoch: 23, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 52908
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.331519603729248
Epoch: 1, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6034767627716064
Epoch: 2, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.325 Vali Acc: 0.450 Test Loss: 1.325 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.6074366569519043
Epoch: 3, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.275 Vali Acc: 0.475 Test Loss: 1.275 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.5883119106292725
Epoch: 4, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.204 Vali Acc: 0.550 Test Loss: 1.204 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.54591965675354
Epoch: 5, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.133 Vali Acc: 0.675 Test Loss: 1.133 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.6091704368591309
Epoch: 6, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.064 Vali Acc: 0.775 Test Loss: 1.064 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.628410816192627
Epoch: 7, Steps: 3 | Train Loss: 0.884 Vali Loss: 0.989 Vali Acc: 0.850 Test Loss: 0.989 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 0.52864670753479
Epoch: 8, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.909 Vali Acc: 0.850 Test Loss: 0.909 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.5521612167358398
Epoch: 9, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.828 Vali Acc: 0.850 Test Loss: 0.828 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.5619029998779297
Epoch: 10, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.751 Vali Acc: 0.875 Test Loss: 0.751 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 0.5583117008209229
Epoch: 11, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.680 Vali Acc: 0.900 Test Loss: 0.680 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.597571849822998
Epoch: 12, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.619 Vali Acc: 0.925 Test Loss: 0.619 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.5977773666381836
Epoch: 13, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.572 Vali Acc: 0.950 Test Loss: 0.572 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.6021943092346191
Epoch: 14, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.535 Vali Acc: 0.950 Test Loss: 0.535 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.5647015571594238
Epoch: 15, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.497 Vali Acc: 0.950 Test Loss: 0.497 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5841500759124756
Epoch: 16, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.6117820739746094
Epoch: 17, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.436 Vali Acc: 0.950 Test Loss: 0.436 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5174767971038818
Epoch: 18, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.5903785228729248
Epoch: 19, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.6386570930480957
Epoch: 20, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5345573425292969
Epoch: 21, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.628288745880127
Epoch: 22, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5685672760009766
Epoch: 23, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6057424545288086
Epoch: 24, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.567194938659668
Epoch: 25, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.5666792392730713
Epoch: 26, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5352599620819092
Epoch: 27, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.5668959617614746
Epoch: 28, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.5659101009368896
Epoch: 29, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.5630464553833008
Epoch: 30, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.5467097759246826
Epoch: 31, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.551201343536377
Epoch: 32, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5549197196960449
Epoch: 33, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5600793361663818
Epoch: 34, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5701353549957275
Epoch: 35, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6909658908843994
Epoch: 36, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5309720039367676
Epoch: 37, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.5622973442077637
Epoch: 38, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5667483806610107
Epoch: 39, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6452419757843018
Epoch: 40, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5723047256469727
Epoch: 41, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.6748697757720947
Epoch: 42, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.6489779949188232
Epoch: 43, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.5913958549499512
Epoch: 44, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.6123368740081787
Epoch: 45, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.5268924236297607
Epoch: 46, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.6137266159057617
Epoch: 47, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5277993679046631
Epoch: 48, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.6363692283630371
Epoch: 49, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.574042558670044
Epoch: 50, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.581662654876709
Epoch: 51, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.925 Test Loss: 0.236 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6748473644256592
Epoch: 52, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5540521144866943
Epoch: 53, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5997540950775146
Epoch: 54, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5641112327575684
Epoch: 55, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5965671539306641
Epoch: 56, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5859920978546143
Epoch: 57, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.5439937114715576
Epoch: 58, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.6503841876983643
Epoch: 59, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.925 Test Loss: 0.224 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 52908
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2019596099853516
Epoch: 1, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.379 Vali Acc: 0.450 Test Loss: 1.379 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.5346612930297852
Epoch: 2, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.333 Vali Acc: 0.450 Test Loss: 1.333 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.5407180786132812
Epoch: 3, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.280 Vali Acc: 0.475 Test Loss: 1.280 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.6422929763793945
Epoch: 4, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.211 Vali Acc: 0.575 Test Loss: 1.211 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.5695638656616211
Epoch: 5, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.140 Vali Acc: 0.650 Test Loss: 1.140 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 0.5693867206573486
Epoch: 6, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.070 Vali Acc: 0.750 Test Loss: 1.070 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.5399112701416016
Epoch: 7, Steps: 3 | Train Loss: 0.906 Vali Loss: 0.996 Vali Acc: 0.800 Test Loss: 0.996 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.6722278594970703
Epoch: 8, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.918 Vali Acc: 0.825 Test Loss: 0.918 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.7300746440887451
Epoch: 9, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.841 Vali Acc: 0.875 Test Loss: 0.841 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.5324420928955078
Epoch: 10, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.763 Vali Acc: 0.950 Test Loss: 0.763 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949992).  Saving model ...
Epoch: 11 cost time: 0.5976529121398926
Epoch: 11, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.690 Vali Acc: 0.975 Test Loss: 0.690 Test Acc: 0.975
Validation loss decreased (-0.949992 --> -0.974993).  Saving model ...
Epoch: 12 cost time: 0.5679552555084229
Epoch: 12, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.628 Vali Acc: 0.975 Test Loss: 0.628 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.6279263496398926
Epoch: 13, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.580 Vali Acc: 0.975 Test Loss: 0.580 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.5726103782653809
Epoch: 14, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.538 Vali Acc: 0.975 Test Loss: 0.538 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.5372743606567383
Epoch: 15, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.501 Vali Acc: 0.975 Test Loss: 0.501 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.619654655456543
Epoch: 16, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.468 Vali Acc: 0.975 Test Loss: 0.468 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.5548088550567627
Epoch: 17, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6125891208648682
Epoch: 18, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5942628383636475
Epoch: 19, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.5015401840209961
Epoch: 20, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6713283061981201
Epoch: 21, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6434552669525146
Epoch: 22, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6720445156097412
Epoch: 23, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7418301105499268
Epoch: 24, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6011419296264648
Epoch: 25, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6005260944366455
Epoch: 26, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.627485990524292
Epoch: 27, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6153411865234375
Epoch: 28, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6321530342102051
Epoch: 29, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 52908
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.362576723098755
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.344 Vali Acc: 0.450 Test Loss: 1.344 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.5406861305236816
Epoch: 2, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.306 Vali Acc: 0.450 Test Loss: 1.306 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.5318968296051025
Epoch: 3, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.263 Vali Acc: 0.525 Test Loss: 1.263 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.5348742008209229
Epoch: 4, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.206 Vali Acc: 0.650 Test Loss: 1.206 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.5765037536621094
Epoch: 5, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.145 Vali Acc: 0.725 Test Loss: 1.145 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 0.5662238597869873
Epoch: 6, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.082 Vali Acc: 0.775 Test Loss: 1.082 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.5400094985961914
Epoch: 7, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.016 Vali Acc: 0.825 Test Loss: 1.016 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824990).  Saving model ...
Epoch: 8 cost time: 0.5752971172332764
Epoch: 8, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.949 Vali Acc: 0.875 Test Loss: 0.949 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.4983820915222168
Epoch: 9, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.883 Vali Acc: 0.875 Test Loss: 0.883 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 0.5793149471282959
Epoch: 10, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.819 Vali Acc: 0.900 Test Loss: 0.819 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.6323494911193848
Epoch: 11, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.760 Vali Acc: 0.900 Test Loss: 0.760 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 0.6005456447601318
Epoch: 12, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.709 Vali Acc: 0.925 Test Loss: 0.709 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.5709919929504395
Epoch: 13, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.663 Vali Acc: 0.925 Test Loss: 0.663 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 14 cost time: 0.6580548286437988
Epoch: 14, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.625 Vali Acc: 0.950 Test Loss: 0.625 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.5974676609039307
Epoch: 15, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.591 Vali Acc: 0.925 Test Loss: 0.591 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6249873638153076
Epoch: 16, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.560 Vali Acc: 0.950 Test Loss: 0.560 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 17 cost time: 0.5661437511444092
Epoch: 17, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.530 Vali Acc: 0.950 Test Loss: 0.530 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.574913501739502
Epoch: 18, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.506 Vali Acc: 0.925 Test Loss: 0.506 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6182105541229248
Epoch: 19, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5840039253234863
Epoch: 20, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6123104095458984
Epoch: 21, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5690574645996094
Epoch: 22, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5733959674835205
Epoch: 23, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5789749622344971
Epoch: 24, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5957598686218262
Epoch: 25, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6096079349517822
Epoch: 26, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.6760404109954834
Epoch: 27, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.641460657119751
Epoch: 28, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.610816478729248
Epoch: 29, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.5672917366027832
Epoch: 30, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6195359230041504
Epoch: 31, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6541070938110352
Epoch: 32, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6194303035736084
Epoch: 33, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6093318462371826
Epoch: 34, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6939504146575928
Epoch: 35, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6276514530181885
Epoch: 36, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.611952543258667
Epoch: 37, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6668190956115723
Epoch: 38, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6588127613067627
Epoch: 39, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 52908
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3655383586883545
Epoch: 1, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.389 Vali Acc: 0.350 Test Loss: 1.389 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6082680225372314
Epoch: 2, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.342 Vali Acc: 0.350 Test Loss: 1.342 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.6524994373321533
Epoch: 3, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.286 Vali Acc: 0.450 Test Loss: 1.286 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.6247496604919434
Epoch: 4, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.216 Vali Acc: 0.600 Test Loss: 1.216 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.5544753074645996
Epoch: 5, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.149 Vali Acc: 0.675 Test Loss: 1.149 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.5617687702178955
Epoch: 6, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.087 Vali Acc: 0.775 Test Loss: 1.087 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.6269071102142334
Epoch: 7, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.005 Vali Acc: 0.775 Test Loss: 1.005 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.5854151248931885
Epoch: 8, Steps: 3 | Train Loss: 0.861 Vali Loss: 0.920 Vali Acc: 0.775 Test Loss: 0.920 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.5779852867126465
Epoch: 9, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.841 Vali Acc: 0.825 Test Loss: 0.841 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.5889730453491211
Epoch: 10, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.766 Vali Acc: 0.875 Test Loss: 0.766 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 0.7008233070373535
Epoch: 11, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.702 Vali Acc: 0.925 Test Loss: 0.702 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.6477377414703369
Epoch: 12, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.646 Vali Acc: 0.925 Test Loss: 0.646 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.7137095928192139
Epoch: 13, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.595 Vali Acc: 0.950 Test Loss: 0.595 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.5678024291992188
Epoch: 14, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.554 Vali Acc: 0.950 Test Loss: 0.554 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.5791008472442627
Epoch: 15, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6385385990142822
Epoch: 16, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.734311580657959
Epoch: 17, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6278455257415771
Epoch: 18, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.5914037227630615
Epoch: 19, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.6903173923492432
Epoch: 20, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6683428287506104
Epoch: 21, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7163009643554688
Epoch: 22, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.615307092666626
Epoch: 23, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5901806354522705
Epoch: 24, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.639052152633667
Epoch: 25, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6801693439483643
Epoch: 26, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6612110137939453
Epoch: 27, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6576976776123047
Epoch: 28, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5814619064331055
Epoch: 29, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6002600193023682
Epoch: 30, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.627159833908081
Epoch: 31, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5697300434112549
Epoch: 32, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 44716
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.323348045349121
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.425 Vali Acc: 0.400 Test Loss: 1.425 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5161290168762207
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.378 Vali Acc: 0.425 Test Loss: 1.378 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.6029305458068848
Epoch: 3, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.324 Vali Acc: 0.475 Test Loss: 1.324 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.5224721431732178
Epoch: 4, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.255 Vali Acc: 0.575 Test Loss: 1.255 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574987).  Saving model ...
Epoch: 5 cost time: 0.550530195236206
Epoch: 5, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.189 Vali Acc: 0.675 Test Loss: 1.189 Test Acc: 0.675
Validation loss decreased (-0.574987 --> -0.674988).  Saving model ...
Epoch: 6 cost time: 0.55678391456604
Epoch: 6, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.127 Vali Acc: 0.725 Test Loss: 1.127 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.6129016876220703
Epoch: 7, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.045 Vali Acc: 0.750 Test Loss: 1.045 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.5714726448059082
Epoch: 8, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.958 Vali Acc: 0.775 Test Loss: 0.958 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 0.6044774055480957
Epoch: 9, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.6644878387451172
Epoch: 10, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.795 Vali Acc: 0.875 Test Loss: 0.795 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 0.5932319164276123
Epoch: 11, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.731 Vali Acc: 0.875 Test Loss: 0.731 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.5749351978302002
Epoch: 12, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.674 Vali Acc: 0.875 Test Loss: 0.674 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.5987093448638916
Epoch: 13, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6447732448577881
Epoch: 14, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5561501979827881
Epoch: 15, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.5889108180999756
Epoch: 16, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.5000813007354736
Epoch: 17, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.551051139831543
Epoch: 18, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.5693843364715576
Epoch: 19, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.5724313259124756
Epoch: 20, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.5880937576293945
Epoch: 21, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.5300338268280029
Epoch: 22, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 0.6402978897094727
Epoch: 23, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 0.613152265548706
Epoch: 24, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.6911771297454834
Epoch: 25, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 0.6034166812896729
Epoch: 26, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 0.6100139617919922
Epoch: 27, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.6716439723968506
Epoch: 28, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.659942626953125
Epoch: 29, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 0.5641233921051025
Epoch: 30, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6110234260559082
Epoch: 31, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5850181579589844
Epoch: 32, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5128636360168457
Epoch: 33, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.576636552810669
Epoch: 34, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5705661773681641
Epoch: 35, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6148474216461182
Epoch: 36, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6265523433685303
Epoch: 37, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6540813446044922
Epoch: 38, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5412247180938721
Epoch: 39, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 44716
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5993614196777344
Epoch: 1, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.369 Vali Acc: 0.450 Test Loss: 1.369 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.607189416885376
Epoch: 2, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.6158773899078369
Epoch: 3, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.5995512008666992
Epoch: 4, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.212 Vali Acc: 0.600 Test Loss: 1.212 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.6398844718933105
Epoch: 5, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.146 Vali Acc: 0.675 Test Loss: 1.146 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.6303198337554932
Epoch: 6, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.083 Vali Acc: 0.700 Test Loss: 1.083 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 0.5875463485717773
Epoch: 7, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.6538171768188477
Epoch: 8, Steps: 3 | Train Loss: 0.841 Vali Loss: 0.930 Vali Acc: 0.825 Test Loss: 0.930 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.5807318687438965
Epoch: 9, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.851 Vali Acc: 0.850 Test Loss: 0.851 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.5666546821594238
Epoch: 10, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.775 Vali Acc: 0.875 Test Loss: 0.775 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 0.5900256633758545
Epoch: 11, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.713 Vali Acc: 0.925 Test Loss: 0.713 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.6078722476959229
Epoch: 12, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6251306533813477
Epoch: 13, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6492035388946533
Epoch: 14, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5129587650299072
Epoch: 15, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6235983371734619
Epoch: 16, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.476 Vali Acc: 0.875 Test Loss: 0.476 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5734829902648926
Epoch: 17, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5435585975646973
Epoch: 18, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6237149238586426
Epoch: 19, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6080605983734131
Epoch: 20, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6352124214172363
Epoch: 21, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 0.6083712577819824
Epoch: 22, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 0.6358985900878906
Epoch: 23, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 0.573899507522583
Epoch: 24, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.6167058944702148
Epoch: 25, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5301065444946289
Epoch: 26, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5760765075683594
Epoch: 27, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5984196662902832
Epoch: 28, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6060154438018799
Epoch: 29, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5268821716308594
Epoch: 30, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5478832721710205
Epoch: 31, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5475752353668213
Epoch: 32, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5338468551635742
Epoch: 33, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5614562034606934
Epoch: 34, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 44716
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.310492992401123
Epoch: 1, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.357 Vali Acc: 0.375 Test Loss: 1.357 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6064469814300537
Epoch: 2, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.322 Vali Acc: 0.450 Test Loss: 1.322 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.4992060661315918
Epoch: 3, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.518580436706543
Epoch: 4, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.220 Vali Acc: 0.550 Test Loss: 1.220 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.6383352279663086
Epoch: 5, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.159 Vali Acc: 0.625 Test Loss: 1.159 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.6016976833343506
Epoch: 6, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.100 Vali Acc: 0.650 Test Loss: 1.100 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.6187217235565186
Epoch: 7, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.034 Vali Acc: 0.675 Test Loss: 1.034 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.5329821109771729
Epoch: 8, Steps: 3 | Train Loss: 0.841 Vali Loss: 0.967 Vali Acc: 0.750 Test Loss: 0.967 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.4803624153137207
Epoch: 9, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.900 Vali Acc: 0.775 Test Loss: 0.900 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.549203634262085
Epoch: 10, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.835 Vali Acc: 0.825 Test Loss: 0.835 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.5400805473327637
Epoch: 11, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.783 Vali Acc: 0.875 Test Loss: 0.783 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.6032593250274658
Epoch: 12, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.5609467029571533
Epoch: 13, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.690 Vali Acc: 0.875 Test Loss: 0.690 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.525681734085083
Epoch: 14, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.647 Vali Acc: 0.875 Test Loss: 0.647 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.5663290023803711
Epoch: 15, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.610 Vali Acc: 0.875 Test Loss: 0.610 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.5371568202972412
Epoch: 16, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.575 Vali Acc: 0.875 Test Loss: 0.575 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.5632615089416504
Epoch: 17, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.5485610961914062
Epoch: 18, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.6063148975372314
Epoch: 19, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.5738296508789062
Epoch: 20, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5785810947418213
Epoch: 21, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6042318344116211
Epoch: 22, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 0.5590317249298096
Epoch: 23, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 0.5419642925262451
Epoch: 24, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 0.5539634227752686
Epoch: 25, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.48630309104919434
Epoch: 26, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5943458080291748
Epoch: 27, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 0.6320114135742188
Epoch: 28, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 29 cost time: 0.4896368980407715
Epoch: 29, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 30 cost time: 0.4436047077178955
Epoch: 30, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 0.4834005832672119
Epoch: 31, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 32 cost time: 0.5242648124694824
Epoch: 32, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 33 cost time: 0.5092852115631104
Epoch: 33, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 34 cost time: 0.5159049034118652
Epoch: 34, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 35 cost time: 0.551133394241333
Epoch: 35, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 36 cost time: 0.4754500389099121
Epoch: 36, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 37 cost time: 0.5753157138824463
Epoch: 37, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 38 cost time: 0.5672271251678467
Epoch: 38, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 39 cost time: 0.5826570987701416
Epoch: 39, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 0.5814657211303711
Epoch: 40, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5154938697814941
Epoch: 41, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5842409133911133
Epoch: 42, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5927813053131104
Epoch: 43, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5297718048095703
Epoch: 44, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5999307632446289
Epoch: 45, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5784130096435547
Epoch: 46, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 0.5681643486022949
Epoch: 47, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 0.649885892868042
Epoch: 48, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 49 cost time: 0.5749385356903076
Epoch: 49, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 50 cost time: 0.6508047580718994
Epoch: 50, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6230518817901611
Epoch: 51, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 52 cost time: 0.607856273651123
Epoch: 52, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 53 cost time: 0.6068837642669678
Epoch: 53, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 54 cost time: 0.6224942207336426
Epoch: 54, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 55 cost time: 0.60532546043396
Epoch: 55, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 56 cost time: 0.642998456954956
Epoch: 56, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 57 cost time: 0.6300725936889648
Epoch: 57, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 58 cost time: 0.5939421653747559
Epoch: 58, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7069363594055176
Epoch: 59, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6337039470672607
Epoch: 60, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6557416915893555
Epoch: 61, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5918178558349609
Epoch: 62, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 63 cost time: 0.589407205581665
Epoch: 63, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 64 cost time: 0.6051349639892578
Epoch: 64, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 65 cost time: 0.6687760353088379
Epoch: 65, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 66 cost time: 0.5984847545623779
Epoch: 66, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 67 cost time: 0.5719339847564697
Epoch: 67, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.627967357635498
Epoch: 68, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5411174297332764
Epoch: 69, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 70 cost time: 0.6105968952178955
Epoch: 70, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.5779886245727539
Epoch: 71, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 72 cost time: 0.595787525177002
Epoch: 72, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 73 cost time: 0.6135063171386719
Epoch: 73, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 74 cost time: 0.6302270889282227
Epoch: 74, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 75 cost time: 0.5527477264404297
Epoch: 75, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.565718412399292
Epoch: 76, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.5936810970306396
Epoch: 77, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.5585062503814697
Epoch: 78, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.5230741500854492
Epoch: 79, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 80 cost time: 0.53731369972229
Epoch: 80, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.6182448863983154
Epoch: 81, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 82 cost time: 0.5932357311248779
Epoch: 82, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6300806999206543
Epoch: 83, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.6076602935791016
Epoch: 84, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.6297035217285156
Epoch: 85, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.6546995639801025
Epoch: 86, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.6022958755493164
Epoch: 87, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.6574995517730713
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.6391253471374512
Epoch: 89, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.6553549766540527
Epoch: 90, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.7086474895477295
Epoch: 91, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 44716
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2545363903045654
Epoch: 1, Steps: 3 | Train Loss: 1.594 Vali Loss: 1.509 Vali Acc: 0.225 Test Loss: 1.509 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.5983171463012695
Epoch: 2, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.467 Vali Acc: 0.225 Test Loss: 1.467 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 0.5653562545776367
Epoch: 3, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.427 Vali Acc: 0.275 Test Loss: 1.427 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.5113372802734375
Epoch: 4, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.380 Vali Acc: 0.275 Test Loss: 1.380 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.528876543045044
Epoch: 5, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.331 Vali Acc: 0.325 Test Loss: 1.331 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.6372449398040771
Epoch: 6, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5628941059112549
Epoch: 7, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.225 Vali Acc: 0.425 Test Loss: 1.225 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 0.5464239120483398
Epoch: 8, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
Validation loss decreased (-0.424988 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.5513944625854492
Epoch: 9, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.123 Vali Acc: 0.650 Test Loss: 1.123 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.5423071384429932
Epoch: 10, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.5477166175842285
Epoch: 11, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.026 Vali Acc: 0.700 Test Loss: 1.026 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.5893473625183105
Epoch: 12, Steps: 3 | Train Loss: 0.859 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.5849101543426514
Epoch: 13, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.5813357830047607
Epoch: 14, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.5617356300354004
Epoch: 15, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.5743942260742188
Epoch: 16, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.5400915145874023
Epoch: 17, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 0.5828957557678223
Epoch: 18, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.6305539608001709
Epoch: 19, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.715 Vali Acc: 0.875 Test Loss: 0.715 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.5135993957519531
Epoch: 20, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.689 Vali Acc: 0.900 Test Loss: 0.689 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.7274270057678223
Epoch: 21, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.667 Vali Acc: 0.875 Test Loss: 0.667 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6622092723846436
Epoch: 22, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.646 Vali Acc: 0.900 Test Loss: 0.646 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.6985809803009033
Epoch: 23, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.630 Vali Acc: 0.900 Test Loss: 0.630 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.6894071102142334
Epoch: 24, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.7231433391571045
Epoch: 25, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.672609806060791
Epoch: 26, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.7510659694671631
Epoch: 27, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.7575533390045166
Epoch: 28, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.521 Vali Acc: 0.900 Test Loss: 0.521 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.6993908882141113
Epoch: 29, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.6980423927307129
Epoch: 30, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.658301830291748
Epoch: 31, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 0.6732208728790283
Epoch: 32, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 0.7395968437194824
Epoch: 33, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.8282051086425781
Epoch: 34, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.7079007625579834
Epoch: 35, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6851043701171875
Epoch: 36, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7610085010528564
Epoch: 37, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7821002006530762
Epoch: 38, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6419873237609863
Epoch: 39, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7003769874572754
Epoch: 40, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.6875550746917725
Epoch: 41, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.6767656803131104
Epoch: 42, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.7063078880310059
Epoch: 43, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 0.6483666896820068
Epoch: 44, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 0.6355032920837402
Epoch: 45, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6268677711486816
Epoch: 46, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6830737590789795
Epoch: 47, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7201707363128662
Epoch: 48, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7402575016021729
Epoch: 49, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6343717575073242
Epoch: 50, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6541388034820557
Epoch: 51, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6644093990325928
Epoch: 52, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6910383701324463
Epoch: 53, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.6597208976745605
Epoch: 54, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 147308
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2939820289611816
Epoch: 1, Steps: 3 | Train Loss: 1.576 Vali Loss: 1.486 Vali Acc: 0.200 Test Loss: 1.486 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.6043562889099121
Epoch: 2, Steps: 3 | Train Loss: 1.541 Vali Loss: 1.449 Vali Acc: 0.200 Test Loss: 1.449 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.58502197265625
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.412 Vali Acc: 0.200 Test Loss: 1.412 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.5697917938232422
Epoch: 4, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
Validation loss decreased (-0.199986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.6033203601837158
Epoch: 5, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.321 Vali Acc: 0.325 Test Loss: 1.321 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.6757369041442871
Epoch: 6, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5839054584503174
Epoch: 7, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.218 Vali Acc: 0.450 Test Loss: 1.218 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.5669183731079102
Epoch: 8, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.168 Vali Acc: 0.600 Test Loss: 1.168 Test Acc: 0.600
Validation loss decreased (-0.449988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.545036792755127
Epoch: 9, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.5821139812469482
Epoch: 10, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.071 Vali Acc: 0.700 Test Loss: 1.071 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.5750846862792969
Epoch: 11, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.027 Vali Acc: 0.725 Test Loss: 1.027 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.5641388893127441
Epoch: 12, Steps: 3 | Train Loss: 0.871 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.5495345592498779
Epoch: 13, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.6004927158355713
Epoch: 14, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.890 Vali Acc: 0.750 Test Loss: 0.890 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.6115095615386963
Epoch: 15, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 0.6238234043121338
Epoch: 16, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.806 Vali Acc: 0.775 Test Loss: 0.806 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.6737332344055176
Epoch: 17, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.6198296546936035
Epoch: 18, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.735 Vali Acc: 0.825 Test Loss: 0.735 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 19 cost time: 0.6439363956451416
Epoch: 19, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.705 Vali Acc: 0.850 Test Loss: 0.705 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.713292121887207
Epoch: 20, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.680 Vali Acc: 0.875 Test Loss: 0.680 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.5868823528289795
Epoch: 21, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.655 Vali Acc: 0.875 Test Loss: 0.655 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 0.5343923568725586
Epoch: 22, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.638 Vali Acc: 0.875 Test Loss: 0.638 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.6601557731628418
Epoch: 23, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.5974223613739014
Epoch: 24, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.589 Vali Acc: 0.925 Test Loss: 0.589 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.5591394901275635
Epoch: 25, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.565 Vali Acc: 0.950 Test Loss: 0.565 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 0.593543529510498
Epoch: 26, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.544 Vali Acc: 0.950 Test Loss: 0.544 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.5142452716827393
Epoch: 27, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.524 Vali Acc: 0.950 Test Loss: 0.524 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.5331041812896729
Epoch: 28, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.503 Vali Acc: 0.950 Test Loss: 0.503 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.5642526149749756
Epoch: 29, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.490 Vali Acc: 0.950 Test Loss: 0.490 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.4751269817352295
Epoch: 30, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.476 Vali Acc: 0.975 Test Loss: 0.476 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 31 cost time: 0.5024285316467285
Epoch: 31, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.464 Vali Acc: 0.975 Test Loss: 0.464 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 32 cost time: 0.5509300231933594
Epoch: 32, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.453 Vali Acc: 0.975 Test Loss: 0.453 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 33 cost time: 0.4760925769805908
Epoch: 33, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5411713123321533
Epoch: 34, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.441 Vali Acc: 0.950 Test Loss: 0.441 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5086548328399658
Epoch: 35, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5111453533172607
Epoch: 36, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5980620384216309
Epoch: 37, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5271234512329102
Epoch: 38, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5477292537689209
Epoch: 39, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5702829360961914
Epoch: 40, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5890457630157471
Epoch: 41, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5476491451263428
Epoch: 42, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 147308
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5468389987945557
Epoch: 1, Steps: 3 | Train Loss: 1.540 Vali Loss: 1.438 Vali Acc: 0.175 Test Loss: 1.438 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.5997114181518555
Epoch: 2, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.403 Vali Acc: 0.225 Test Loss: 1.403 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.6705148220062256
Epoch: 3, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.370 Vali Acc: 0.250 Test Loss: 1.370 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.6539571285247803
Epoch: 4, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.329 Vali Acc: 0.300 Test Loss: 1.329 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.6785562038421631
Epoch: 5, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.284 Vali Acc: 0.350 Test Loss: 1.284 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.6420681476593018
Epoch: 6, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6433131694793701
Epoch: 7, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.186 Vali Acc: 0.475 Test Loss: 1.186 Test Acc: 0.475
Validation loss decreased (-0.399988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.6204636096954346
Epoch: 8, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.136 Vali Acc: 0.650 Test Loss: 1.136 Test Acc: 0.650
Validation loss decreased (-0.474988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.624382734298706
Epoch: 9, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.5691628456115723
Epoch: 10, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.040 Vali Acc: 0.725 Test Loss: 1.040 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.5925657749176025
Epoch: 11, Steps: 3 | Train Loss: 0.985 Vali Loss: 0.995 Vali Acc: 0.800 Test Loss: 0.995 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799990).  Saving model ...
Epoch: 12 cost time: 0.6618578433990479
Epoch: 12, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.950 Vali Acc: 0.800 Test Loss: 0.950 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.5906293392181396
Epoch: 13, Steps: 3 | Train Loss: 0.835 Vali Loss: 0.903 Vali Acc: 0.800 Test Loss: 0.903 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.6409943103790283
Epoch: 14, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.858 Vali Acc: 0.825 Test Loss: 0.858 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.6370086669921875
Epoch: 15, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.815 Vali Acc: 0.825 Test Loss: 0.815 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.5784192085266113
Epoch: 16, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.775 Vali Acc: 0.875 Test Loss: 0.775 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.6318831443786621
Epoch: 17, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.5565433502197266
Epoch: 18, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.707 Vali Acc: 0.900 Test Loss: 0.707 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.7168357372283936
Epoch: 19, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.680 Vali Acc: 0.900 Test Loss: 0.680 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.5996677875518799
Epoch: 20, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.656 Vali Acc: 0.900 Test Loss: 0.656 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.643885612487793
Epoch: 21, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.637 Vali Acc: 0.900 Test Loss: 0.637 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.6291606426239014
Epoch: 22, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.623 Vali Acc: 0.900 Test Loss: 0.623 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.649677038192749
Epoch: 23, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.607 Vali Acc: 0.900 Test Loss: 0.607 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.6795132160186768
Epoch: 24, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.586 Vali Acc: 0.900 Test Loss: 0.586 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.7061440944671631
Epoch: 25, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.565 Vali Acc: 0.900 Test Loss: 0.565 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.6688227653503418
Epoch: 26, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.6738624572753906
Epoch: 27, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.6761574745178223
Epoch: 28, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.7356574535369873
Epoch: 29, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.7126731872558594
Epoch: 30, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.467 Vali Acc: 0.950 Test Loss: 0.467 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.7533054351806641
Epoch: 31, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.455 Vali Acc: 0.950 Test Loss: 0.455 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.62735915184021
Epoch: 32, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.442 Vali Acc: 0.950 Test Loss: 0.442 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.7584743499755859
Epoch: 33, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.432 Vali Acc: 0.950 Test Loss: 0.432 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.7089583873748779
Epoch: 34, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.6717443466186523
Epoch: 35, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.6565427780151367
Epoch: 36, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.7672290802001953
Epoch: 37, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.6924600601196289
Epoch: 38, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.7183792591094971
Epoch: 39, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.6666920185089111
Epoch: 40, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.6995234489440918
Epoch: 41, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.6730062961578369
Epoch: 42, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.6781742572784424
Epoch: 43, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.6806731224060059
Epoch: 44, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.6959183216094971
Epoch: 45, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.6339764595031738
Epoch: 46, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 0.5856015682220459
Epoch: 47, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.6548266410827637
Epoch: 48, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.5743799209594727
Epoch: 49, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.522982120513916
Epoch: 50, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5917797088623047
Epoch: 51, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 0.6239237785339355
Epoch: 52, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 0.6752324104309082
Epoch: 53, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 0.7251873016357422
Epoch: 54, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 0.6026160717010498
Epoch: 55, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 0.7901594638824463
Epoch: 56, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 0.6614384651184082
Epoch: 57, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 58 cost time: 0.6787395477294922
Epoch: 58, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 59 cost time: 0.6565284729003906
Epoch: 59, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 60 cost time: 0.6152706146240234
Epoch: 60, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 61 cost time: 0.6989116668701172
Epoch: 61, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 62 cost time: 0.7042932510375977
Epoch: 62, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7341170310974121
Epoch: 63, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.752244234085083
Epoch: 64, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.6748359203338623
Epoch: 65, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.7153246402740479
Epoch: 66, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.7278242111206055
Epoch: 67, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 68 cost time: 0.695911169052124
Epoch: 68, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8613784313201904
Epoch: 69, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.6501598358154297
Epoch: 70, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.6928274631500244
Epoch: 71, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 72 cost time: 0.6634831428527832
Epoch: 72, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7094979286193848
Epoch: 73, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.6231462955474854
Epoch: 74, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.6113972663879395
Epoch: 75, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.6488921642303467
Epoch: 76, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.604017972946167
Epoch: 77, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.6720128059387207
Epoch: 78, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.7161197662353516
Epoch: 79, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.6375994682312012
Epoch: 80, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.6362309455871582
Epoch: 81, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 147308
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1841723918914795
Epoch: 1, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.450 Vali Acc: 0.150 Test Loss: 1.450 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.527360200881958
Epoch: 2, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.421 Vali Acc: 0.200 Test Loss: 1.421 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.6182565689086914
Epoch: 3, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.392 Vali Acc: 0.200 Test Loss: 1.392 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.560861349105835
Epoch: 4, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.355 Vali Acc: 0.225 Test Loss: 1.355 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.5770359039306641
Epoch: 5, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.314 Vali Acc: 0.225 Test Loss: 1.314 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224987).  Saving model ...
Epoch: 6 cost time: 0.49323439598083496
Epoch: 6, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.269 Vali Acc: 0.275 Test Loss: 1.269 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 7 cost time: 0.4992790222167969
Epoch: 7, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.222 Vali Acc: 0.325 Test Loss: 1.222 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324988).  Saving model ...
Epoch: 8 cost time: 0.5321509838104248
Epoch: 8, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.172 Vali Acc: 0.575 Test Loss: 1.172 Test Acc: 0.575
Validation loss decreased (-0.324988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.6107721328735352
Epoch: 9, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.5760319232940674
Epoch: 10, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.074 Vali Acc: 0.700 Test Loss: 1.074 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.5971155166625977
Epoch: 11, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.027 Vali Acc: 0.750 Test Loss: 1.027 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 0.5774757862091064
Epoch: 12, Steps: 3 | Train Loss: 0.841 Vali Loss: 0.981 Vali Acc: 0.725 Test Loss: 0.981 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.593034029006958
Epoch: 13, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.936 Vali Acc: 0.725 Test Loss: 0.936 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6152603626251221
Epoch: 14, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.5897476673126221
Epoch: 15, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.636481523513794
Epoch: 16, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.820 Vali Acc: 0.775 Test Loss: 0.820 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.545811653137207
Epoch: 17, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.5685570240020752
Epoch: 18, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.757 Vali Acc: 0.850 Test Loss: 0.757 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 19 cost time: 0.5090484619140625
Epoch: 19, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.730 Vali Acc: 0.900 Test Loss: 0.730 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.574204683303833
Epoch: 20, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.703 Vali Acc: 0.925 Test Loss: 0.703 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 21 cost time: 0.5923347473144531
Epoch: 21, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.680 Vali Acc: 0.950 Test Loss: 0.680 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 22 cost time: 0.5609467029571533
Epoch: 22, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.660 Vali Acc: 0.975 Test Loss: 0.660 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974993).  Saving model ...
Epoch: 23 cost time: 0.6125857830047607
Epoch: 23, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.639 Vali Acc: 0.950 Test Loss: 0.639 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5326070785522461
Epoch: 24, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.617 Vali Acc: 0.950 Test Loss: 0.617 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6051905155181885
Epoch: 25, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5922338962554932
Epoch: 26, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.574 Vali Acc: 0.900 Test Loss: 0.574 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5858275890350342
Epoch: 27, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.541304349899292
Epoch: 28, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5469691753387451
Epoch: 29, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4903392791748047
Epoch: 30, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.545020341873169
Epoch: 31, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6081502437591553
Epoch: 32, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 147308
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5412464141845703
Epoch: 1, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.319 Vali Acc: 0.175 Test Loss: 1.319 Test Acc: 0.175
Validation loss decreased (inf --> -0.174987).  Saving model ...
Epoch: 2 cost time: 0.547626256942749
Epoch: 2, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.294 Vali Acc: 0.200 Test Loss: 1.294 Test Acc: 0.200
Validation loss decreased (-0.174987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.5119102001190186
Epoch: 3, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.5019292831420898
Epoch: 4, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.231 Vali Acc: 0.250 Test Loss: 1.231 Test Acc: 0.250
Validation loss decreased (-0.199987 --> -0.249988).  Saving model ...
Epoch: 5 cost time: 0.5427017211914062
Epoch: 5, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.192 Vali Acc: 0.300 Test Loss: 1.192 Test Acc: 0.300
Validation loss decreased (-0.249988 --> -0.299988).  Saving model ...
Epoch: 6 cost time: 0.48221421241760254
Epoch: 6, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.149 Vali Acc: 0.525 Test Loss: 1.149 Test Acc: 0.525
Validation loss decreased (-0.299988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 0.5281491279602051
Epoch: 7, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.109 Vali Acc: 0.575 Test Loss: 1.109 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.5689797401428223
Epoch: 8, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.067 Vali Acc: 0.575 Test Loss: 1.067 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.5364668369293213
Epoch: 9, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.024 Vali Acc: 0.725 Test Loss: 1.024 Test Acc: 0.725
Validation loss decreased (-0.574989 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 0.5455467700958252
Epoch: 10, Steps: 3 | Train Loss: 0.948 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.5775880813598633
Epoch: 11, Steps: 3 | Train Loss: 0.923 Vali Loss: 0.936 Vali Acc: 0.725 Test Loss: 0.936 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.5844871997833252
Epoch: 12, Steps: 3 | Train Loss: 0.864 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.5488307476043701
Epoch: 13, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.5765392780303955
Epoch: 14, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.815 Vali Acc: 0.775 Test Loss: 0.815 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.546086311340332
Epoch: 15, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.777 Vali Acc: 0.825 Test Loss: 0.777 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.6223158836364746
Epoch: 16, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.739 Vali Acc: 0.850 Test Loss: 0.739 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 0.6068000793457031
Epoch: 17, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 0.6219968795776367
Epoch: 18, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.6409399509429932
Epoch: 19, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.638 Vali Acc: 0.950 Test Loss: 0.638 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 20 cost time: 0.5945179462432861
Epoch: 20, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.610 Vali Acc: 0.950 Test Loss: 0.610 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 21 cost time: 0.6194813251495361
Epoch: 21, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.583 Vali Acc: 0.950 Test Loss: 0.583 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 22 cost time: 0.5504047870635986
Epoch: 22, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.562 Vali Acc: 0.950 Test Loss: 0.562 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.571662187576294
Epoch: 23, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.539 Vali Acc: 0.975 Test Loss: 0.539 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 24 cost time: 0.5294137001037598
Epoch: 24, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.519 Vali Acc: 0.975 Test Loss: 0.519 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 25 cost time: 0.5941081047058105
Epoch: 25, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.499 Vali Acc: 0.975 Test Loss: 0.499 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 0.5038671493530273
Epoch: 26, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.482 Vali Acc: 0.950 Test Loss: 0.482 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5310549736022949
Epoch: 27, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6151418685913086
Epoch: 28, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.456 Vali Acc: 0.925 Test Loss: 0.456 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.542888879776001
Epoch: 29, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5582418441772461
Epoch: 30, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.441 Vali Acc: 0.975 Test Loss: 0.441 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.5636186599731445
Epoch: 31, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.435 Vali Acc: 0.975 Test Loss: 0.435 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.5538551807403564
Epoch: 32, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.423 Vali Acc: 0.975 Test Loss: 0.423 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.5072081089019775
Epoch: 33, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.412 Vali Acc: 0.975 Test Loss: 0.412 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.564523458480835
Epoch: 34, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.401 Vali Acc: 0.975 Test Loss: 0.401 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.5852644443511963
Epoch: 35, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.392 Vali Acc: 0.975 Test Loss: 0.392 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.57132887840271
Epoch: 36, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.379 Vali Acc: 0.975 Test Loss: 0.379 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.5041220188140869
Epoch: 37, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.369 Vali Acc: 0.975 Test Loss: 0.369 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 38 cost time: 0.6076171398162842
Epoch: 38, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 39 cost time: 0.547938346862793
Epoch: 39, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4999403953552246
Epoch: 40, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.45937681198120117
Epoch: 41, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.48047852516174316
Epoch: 42, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.47603273391723633
Epoch: 43, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5059268474578857
Epoch: 44, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5038976669311523
Epoch: 45, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5049903392791748
Epoch: 46, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.524036169052124
Epoch: 47, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.46802783012390137
Epoch: 48, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 81772
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5138185024261475
Epoch: 1, Steps: 3 | Train Loss: 1.490 Vali Loss: 1.316 Vali Acc: 0.225 Test Loss: 1.316 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.5774462223052979
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.293 Vali Acc: 0.250 Test Loss: 1.293 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.6493752002716064
Epoch: 3, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.266 Vali Acc: 0.275 Test Loss: 1.266 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.5258729457855225
Epoch: 4, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.230 Vali Acc: 0.275 Test Loss: 1.230 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274988).  Saving model ...
Epoch: 5 cost time: 0.595543384552002
Epoch: 5, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.192 Vali Acc: 0.300 Test Loss: 1.192 Test Acc: 0.300
Validation loss decreased (-0.274988 --> -0.299988).  Saving model ...
Epoch: 6 cost time: 0.5489180088043213
Epoch: 6, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.299988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.5599491596221924
Epoch: 7, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.112 Vali Acc: 0.575 Test Loss: 1.112 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.697319507598877
Epoch: 8, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.070 Vali Acc: 0.625 Test Loss: 1.070 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.5773892402648926
Epoch: 9, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.027 Vali Acc: 0.675 Test Loss: 1.027 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 0.5504105091094971
Epoch: 10, Steps: 3 | Train Loss: 0.971 Vali Loss: 0.986 Vali Acc: 0.675 Test Loss: 0.986 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.614586353302002
Epoch: 11, Steps: 3 | Train Loss: 0.916 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.6021628379821777
Epoch: 12, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.895 Vali Acc: 0.750 Test Loss: 0.895 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.5543813705444336
Epoch: 13, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.854 Vali Acc: 0.750 Test Loss: 0.854 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.5935287475585938
Epoch: 14, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.539015531539917
Epoch: 15, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.783 Vali Acc: 0.775 Test Loss: 0.783 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 0.6790971755981445
Epoch: 16, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 17 cost time: 0.6091878414154053
Epoch: 17, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.710 Vali Acc: 0.825 Test Loss: 0.710 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.6612365245819092
Epoch: 18, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.6455433368682861
Epoch: 19, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.641 Vali Acc: 0.925 Test Loss: 0.641 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.5852265357971191
Epoch: 20, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.612 Vali Acc: 0.925 Test Loss: 0.612 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.583575963973999
Epoch: 21, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.581 Vali Acc: 0.925 Test Loss: 0.581 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.5663118362426758
Epoch: 22, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.562 Vali Acc: 0.925 Test Loss: 0.562 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.622553825378418
Epoch: 23, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.541 Vali Acc: 0.925 Test Loss: 0.541 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.5230298042297363
Epoch: 24, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.5542435646057129
Epoch: 25, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.499 Vali Acc: 0.925 Test Loss: 0.499 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.564532995223999
Epoch: 26, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.481 Vali Acc: 0.950 Test Loss: 0.481 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.49532008171081543
Epoch: 27, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.5457677841186523
Epoch: 28, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.6174008846282959
Epoch: 29, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.447 Vali Acc: 0.950 Test Loss: 0.447 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.571012020111084
Epoch: 30, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.5607433319091797
Epoch: 31, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5367166996002197
Epoch: 32, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5742738246917725
Epoch: 33, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.406 Vali Acc: 0.975 Test Loss: 0.406 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.5304100513458252
Epoch: 34, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.395 Vali Acc: 0.975 Test Loss: 0.395 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.5697169303894043
Epoch: 35, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6059548854827881
Epoch: 36, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.6656911373138428
Epoch: 37, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 38 cost time: 0.6418516635894775
Epoch: 38, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6113114356994629
Epoch: 39, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6625204086303711
Epoch: 40, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6162126064300537
Epoch: 41, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5750868320465088
Epoch: 42, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6696102619171143
Epoch: 43, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6146788597106934
Epoch: 44, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5666677951812744
Epoch: 45, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5961940288543701
Epoch: 46, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6154592037200928
Epoch: 47, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 81772
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.428166389465332
Epoch: 1, Steps: 3 | Train Loss: 1.501 Vali Loss: 1.353 Vali Acc: 0.150 Test Loss: 1.353 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.6380536556243896
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.329 Vali Acc: 0.150 Test Loss: 1.329 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149987).  Saving model ...
Epoch: 3 cost time: 0.580817699432373
Epoch: 3, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.302 Vali Acc: 0.200 Test Loss: 1.302 Test Acc: 0.200
Validation loss decreased (-0.149987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.6578593254089355
Epoch: 4, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.266 Vali Acc: 0.250 Test Loss: 1.266 Test Acc: 0.250
Validation loss decreased (-0.199987 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.5708892345428467
Epoch: 5, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.227 Vali Acc: 0.275 Test Loss: 1.227 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274988).  Saving model ...
Epoch: 6 cost time: 0.5459320545196533
Epoch: 6, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.274988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.5673770904541016
Epoch: 7, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.143 Vali Acc: 0.600 Test Loss: 1.143 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.6420719623565674
Epoch: 8, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.098 Vali Acc: 0.650 Test Loss: 1.098 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.6305351257324219
Epoch: 9, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.053 Vali Acc: 0.650 Test Loss: 1.053 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.5941503047943115
Epoch: 10, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.007 Vali Acc: 0.675 Test Loss: 1.007 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.5603601932525635
Epoch: 11, Steps: 3 | Train Loss: 0.929 Vali Loss: 0.962 Vali Acc: 0.700 Test Loss: 0.962 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.6137862205505371
Epoch: 12, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.5931189060211182
Epoch: 13, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.5606176853179932
Epoch: 14, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.5255701541900635
Epoch: 15, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 0.6037030220031738
Epoch: 16, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.763 Vali Acc: 0.850 Test Loss: 0.763 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.5261337757110596
Epoch: 17, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.728 Vali Acc: 0.875 Test Loss: 0.728 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.598790168762207
Epoch: 18, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.5684089660644531
Epoch: 19, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.661 Vali Acc: 0.925 Test Loss: 0.661 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.4988718032836914
Epoch: 20, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.633 Vali Acc: 0.925 Test Loss: 0.633 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.6277644634246826
Epoch: 21, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.601 Vali Acc: 0.950 Test Loss: 0.601 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 22 cost time: 0.6187288761138916
Epoch: 22, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.580 Vali Acc: 0.950 Test Loss: 0.580 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.5566086769104004
Epoch: 23, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 0.5691103935241699
Epoch: 24, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.537 Vali Acc: 0.950 Test Loss: 0.537 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.5458972454071045
Epoch: 25, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.515 Vali Acc: 0.950 Test Loss: 0.515 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.5889027118682861
Epoch: 26, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.5615534782409668
Epoch: 27, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.477 Vali Acc: 0.950 Test Loss: 0.477 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.5755400657653809
Epoch: 28, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.464 Vali Acc: 0.950 Test Loss: 0.464 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.5766496658325195
Epoch: 29, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.5663113594055176
Epoch: 30, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.446 Vali Acc: 0.975 Test Loss: 0.446 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.5432348251342773
Epoch: 31, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.438 Vali Acc: 0.975 Test Loss: 0.438 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.6569693088531494
Epoch: 32, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.424 Vali Acc: 0.975 Test Loss: 0.424 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.5731587409973145
Epoch: 33, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.412 Vali Acc: 0.975 Test Loss: 0.412 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.5345363616943359
Epoch: 34, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.399 Vali Acc: 0.975 Test Loss: 0.399 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.5782167911529541
Epoch: 35, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.387 Vali Acc: 0.975 Test Loss: 0.387 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.5352025032043457
Epoch: 36, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.5979986190795898
Epoch: 37, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 38 cost time: 0.5547828674316406
Epoch: 38, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.361 Vali Acc: 0.975 Test Loss: 0.361 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 39 cost time: 0.5241374969482422
Epoch: 39, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.355 Vali Acc: 0.975 Test Loss: 0.355 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 40 cost time: 0.5538539886474609
Epoch: 40, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.345 Vali Acc: 0.975 Test Loss: 0.345 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.6020350456237793
Epoch: 41, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.5569519996643066
Epoch: 42, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.5619754791259766
Epoch: 43, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.321 Vali Acc: 0.975 Test Loss: 0.321 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.5430119037628174
Epoch: 44, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.6259269714355469
Epoch: 45, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.5459177494049072
Epoch: 46, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.6001098155975342
Epoch: 47, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.5111637115478516
Epoch: 48, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.5719707012176514
Epoch: 49, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.5150899887084961
Epoch: 50, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 51 cost time: 0.5331301689147949
Epoch: 51, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 52 cost time: 0.4932119846343994
Epoch: 52, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 53 cost time: 0.6620209217071533
Epoch: 53, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 54 cost time: 0.5571157932281494
Epoch: 54, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 55 cost time: 0.5777015686035156
Epoch: 55, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 56 cost time: 0.5533261299133301
Epoch: 56, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 57 cost time: 0.495499849319458
Epoch: 57, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.49009203910827637
Epoch: 58, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.48873114585876465
Epoch: 59, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.46602439880371094
Epoch: 60, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.46390461921691895
Epoch: 61, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5167102813720703
Epoch: 62, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.5419085025787354
Epoch: 63, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 64 cost time: 0.5549542903900146
Epoch: 64, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 65 cost time: 0.4961271286010742
Epoch: 65, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 66 cost time: 0.6131646633148193
Epoch: 66, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 67 cost time: 0.5745296478271484
Epoch: 67, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 68 cost time: 0.5402147769927979
Epoch: 68, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5268642902374268
Epoch: 69, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.5058348178863525
Epoch: 70, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5585153102874756
Epoch: 71, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.5193264484405518
Epoch: 72, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5454862117767334
Epoch: 73, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.6332857608795166
Epoch: 74, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.6125738620758057
Epoch: 75, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.6677277088165283
Epoch: 76, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.6554396152496338
Epoch: 77, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 81772
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.349895477294922
Epoch: 1, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.359 Vali Acc: 0.200 Test Loss: 1.359 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5666885375976562
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.337 Vali Acc: 0.225 Test Loss: 1.337 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.6242461204528809
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.313 Vali Acc: 0.225 Test Loss: 1.313 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 4 cost time: 0.549163818359375
Epoch: 4, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.279 Vali Acc: 0.425 Test Loss: 1.279 Test Acc: 0.425
Validation loss decreased (-0.224987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.5981531143188477
Epoch: 5, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.242 Vali Acc: 0.550 Test Loss: 1.242 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.5785198211669922
Epoch: 6, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.202 Vali Acc: 0.625 Test Loss: 1.202 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.580977201461792
Epoch: 7, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.160 Vali Acc: 0.625 Test Loss: 1.160 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 0.5658822059631348
Epoch: 8, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.117 Vali Acc: 0.650 Test Loss: 1.117 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.5273146629333496
Epoch: 9, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.5836496353149414
Epoch: 10, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.034 Vali Acc: 0.650 Test Loss: 1.034 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.6383171081542969
Epoch: 11, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.991 Vali Acc: 0.675 Test Loss: 0.991 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.6422479152679443
Epoch: 12, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.950 Vali Acc: 0.725 Test Loss: 0.950 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.5203468799591064
Epoch: 13, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.910 Vali Acc: 0.725 Test Loss: 0.910 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.5651857852935791
Epoch: 14, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.873 Vali Acc: 0.750 Test Loss: 0.873 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.5749936103820801
Epoch: 15, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.6083521842956543
Epoch: 16, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.803 Vali Acc: 0.800 Test Loss: 0.803 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 0.539198637008667
Epoch: 17, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.5227251052856445
Epoch: 18, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.5309219360351562
Epoch: 19, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.710 Vali Acc: 0.850 Test Loss: 0.710 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.5463392734527588
Epoch: 20, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6182384490966797
Epoch: 21, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 0.5558507442474365
Epoch: 22, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6344265937805176
Epoch: 23, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 0.6630458831787109
Epoch: 24, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.6277058124542236
Epoch: 25, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7107319831848145
Epoch: 26, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6204993724822998
Epoch: 27, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5851428508758545
Epoch: 28, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.5976343154907227
Epoch: 29, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.506 Vali Acc: 0.875 Test Loss: 0.506 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.6112520694732666
Epoch: 30, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.6181812286376953
Epoch: 31, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 0.5907597541809082
Epoch: 32, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 0.565345048904419
Epoch: 33, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.5772354602813721
Epoch: 34, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.5791745185852051
Epoch: 35, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.440 Vali Acc: 0.925 Test Loss: 0.440 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 0.5509867668151855
Epoch: 36, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5887222290039062
Epoch: 37, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5456490516662598
Epoch: 38, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5765109062194824
Epoch: 39, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5529212951660156
Epoch: 40, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.628410816192627
Epoch: 41, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5690522193908691
Epoch: 42, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5911886692047119
Epoch: 43, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5557289123535156
Epoch: 44, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5826153755187988
Epoch: 45, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 81772
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.345203161239624
Epoch: 1, Steps: 3 | Train Loss: 1.594 Vali Loss: 1.439 Vali Acc: 0.400 Test Loss: 1.439 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.45863795280456543
Epoch: 2, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.392 Vali Acc: 0.425 Test Loss: 1.392 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5377256870269775
Epoch: 3, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.5578570365905762
Epoch: 4, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.292 Vali Acc: 0.550 Test Loss: 1.292 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.582984209060669
Epoch: 5, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.231 Vali Acc: 0.600 Test Loss: 1.231 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.48560667037963867
Epoch: 6, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.174 Vali Acc: 0.650 Test Loss: 1.174 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 0.555534839630127
Epoch: 7, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.527167558670044
Epoch: 8, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.075 Vali Acc: 0.800 Test Loss: 1.075 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.534653902053833
Epoch: 9, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.028 Vali Acc: 0.800 Test Loss: 1.028 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.5523555278778076
Epoch: 10, Steps: 3 | Train Loss: 0.974 Vali Loss: 0.980 Vali Acc: 0.800 Test Loss: 0.980 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 11 cost time: 0.5553383827209473
Epoch: 11, Steps: 3 | Train Loss: 0.884 Vali Loss: 0.933 Vali Acc: 0.850 Test Loss: 0.933 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.6189424991607666
Epoch: 12, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.890 Vali Acc: 0.850 Test Loss: 0.890 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.582165002822876
Epoch: 13, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.846 Vali Acc: 0.875 Test Loss: 0.846 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 14 cost time: 0.5568568706512451
Epoch: 14, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.807 Vali Acc: 0.875 Test Loss: 0.807 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.5925452709197998
Epoch: 15, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.773 Vali Acc: 0.875 Test Loss: 0.773 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.5790500640869141
Epoch: 16, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.736 Vali Acc: 0.900 Test Loss: 0.736 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.5218963623046875
Epoch: 17, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.704 Vali Acc: 0.900 Test Loss: 0.704 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.5805032253265381
Epoch: 18, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.675 Vali Acc: 0.900 Test Loss: 0.675 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.5019044876098633
Epoch: 19, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.647 Vali Acc: 0.900 Test Loss: 0.647 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 0.5665321350097656
Epoch: 20, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 0.5655238628387451
Epoch: 21, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.596 Vali Acc: 0.925 Test Loss: 0.596 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.5924274921417236
Epoch: 22, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.576 Vali Acc: 0.925 Test Loss: 0.576 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.5778369903564453
Epoch: 23, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.552 Vali Acc: 0.925 Test Loss: 0.552 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.5199277400970459
Epoch: 24, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.535 Vali Acc: 0.925 Test Loss: 0.535 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.5596365928649902
Epoch: 25, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.524 Vali Acc: 0.925 Test Loss: 0.524 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.599158525466919
Epoch: 26, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.5777215957641602
Epoch: 27, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.563176155090332
Epoch: 28, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.474 Vali Acc: 0.925 Test Loss: 0.474 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.5932023525238037
Epoch: 29, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.5427219867706299
Epoch: 30, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 0.5025210380554199
Epoch: 31, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.5489246845245361
Epoch: 32, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 0.5569918155670166
Epoch: 33, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 0.591925859451294
Epoch: 34, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.5590999126434326
Epoch: 35, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 0.6234080791473389
Epoch: 36, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.6014876365661621
Epoch: 37, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.5552139282226562
Epoch: 38, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.5462217330932617
Epoch: 39, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.5012528896331787
Epoch: 40, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.5441527366638184
Epoch: 41, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 0.5575964450836182
Epoch: 42, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 0.5475311279296875
Epoch: 43, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5926783084869385
Epoch: 44, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5142569541931152
Epoch: 45, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5898110866546631
Epoch: 46, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5597665309906006
Epoch: 47, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5433118343353271
Epoch: 48, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5509600639343262
Epoch: 49, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5544240474700928
Epoch: 50, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.51155686378479
Epoch: 51, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.571533203125
Epoch: 52, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 49004
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.370389699935913
Epoch: 1, Steps: 3 | Train Loss: 1.549 Vali Loss: 1.409 Vali Acc: 0.375 Test Loss: 1.409 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6182875633239746
Epoch: 2, Steps: 3 | Train Loss: 1.501 Vali Loss: 1.368 Vali Acc: 0.425 Test Loss: 1.368 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5224630832672119
Epoch: 3, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.327 Vali Acc: 0.450 Test Loss: 1.327 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.613187313079834
Epoch: 4, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.276 Vali Acc: 0.525 Test Loss: 1.276 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.55954909324646
Epoch: 5, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.220 Vali Acc: 0.675 Test Loss: 1.220 Test Acc: 0.675
Validation loss decreased (-0.524987 --> -0.674988).  Saving model ...
Epoch: 6 cost time: 0.6483514308929443
Epoch: 6, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.164 Vali Acc: 0.675 Test Loss: 1.164 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.5927884578704834
Epoch: 7, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.115 Vali Acc: 0.700 Test Loss: 1.115 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.5832784175872803
Epoch: 8, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.069 Vali Acc: 0.750 Test Loss: 1.069 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 0.5877394676208496
Epoch: 9, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.022 Vali Acc: 0.775 Test Loss: 1.022 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.6287071704864502
Epoch: 10, Steps: 3 | Train Loss: 0.964 Vali Loss: 0.977 Vali Acc: 0.800 Test Loss: 0.977 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 11 cost time: 0.6083662509918213
Epoch: 11, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.931 Vali Acc: 0.850 Test Loss: 0.931 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.624504566192627
Epoch: 12, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.888 Vali Acc: 0.850 Test Loss: 0.888 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.6619071960449219
Epoch: 13, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.846 Vali Acc: 0.825 Test Loss: 0.846 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5943465232849121
Epoch: 14, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6100611686706543
Epoch: 15, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.774 Vali Acc: 0.825 Test Loss: 0.774 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6569929122924805
Epoch: 16, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.738 Vali Acc: 0.875 Test Loss: 0.738 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.5890860557556152
Epoch: 17, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.703 Vali Acc: 0.925 Test Loss: 0.703 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 0.5551130771636963
Epoch: 18, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.672 Vali Acc: 0.925 Test Loss: 0.672 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.5305066108703613
Epoch: 19, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.645 Vali Acc: 0.925 Test Loss: 0.645 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.5949904918670654
Epoch: 20, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.614 Vali Acc: 0.925 Test Loss: 0.614 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.5899162292480469
Epoch: 21, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.593 Vali Acc: 0.925 Test Loss: 0.593 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.6203312873840332
Epoch: 22, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.5217573642730713
Epoch: 23, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.553 Vali Acc: 0.925 Test Loss: 0.553 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.5182976722717285
Epoch: 24, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.5224001407623291
Epoch: 25, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.5815353393554688
Epoch: 26, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.514 Vali Acc: 0.925 Test Loss: 0.514 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.5477790832519531
Epoch: 27, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.498 Vali Acc: 0.925 Test Loss: 0.498 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.55838942527771
Epoch: 28, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.477 Vali Acc: 0.950 Test Loss: 0.477 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.47777485847473145
Epoch: 29, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.458 Vali Acc: 0.950 Test Loss: 0.458 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.5067181587219238
Epoch: 30, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5096759796142578
Epoch: 31, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.49278926849365234
Epoch: 32, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5908684730529785
Epoch: 33, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.5784857273101807
Epoch: 34, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.5222132205963135
Epoch: 35, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.6226348876953125
Epoch: 36, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.5331792831420898
Epoch: 37, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.6298255920410156
Epoch: 38, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.5553975105285645
Epoch: 39, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.5197222232818604
Epoch: 40, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.5485296249389648
Epoch: 41, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.6143887042999268
Epoch: 42, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.6846530437469482
Epoch: 43, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.6882264614105225
Epoch: 44, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5892219543457031
Epoch: 45, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.668799877166748
Epoch: 46, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6475937366485596
Epoch: 47, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.6435444355010986
Epoch: 48, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5583248138427734
Epoch: 49, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.647268533706665
Epoch: 50, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6102941036224365
Epoch: 51, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6475515365600586
Epoch: 52, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6490345001220703
Epoch: 53, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.7009425163269043
Epoch: 54, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.556105375289917
Epoch: 55, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.5866332054138184
Epoch: 56, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 0.5731759071350098
Epoch: 57, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6237404346466064
Epoch: 58, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5674471855163574
Epoch: 59, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5874712467193604
Epoch: 60, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.6429128646850586
Epoch: 61, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5610301494598389
Epoch: 62, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.6073184013366699
Epoch: 63, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.5495145320892334
Epoch: 64, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.5519626140594482
Epoch: 65, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.4817681312561035
Epoch: 66, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 49004
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4646236896514893
Epoch: 1, Steps: 3 | Train Loss: 1.520 Vali Loss: 1.432 Vali Acc: 0.375 Test Loss: 1.432 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.5196695327758789
Epoch: 2, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.394 Vali Acc: 0.375 Test Loss: 1.394 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.5681803226470947
Epoch: 3, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.5242056846618652
Epoch: 4, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.307 Vali Acc: 0.450 Test Loss: 1.307 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.5702939033508301
Epoch: 5, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.254 Vali Acc: 0.575 Test Loss: 1.254 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.574469804763794
Epoch: 6, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.202 Vali Acc: 0.625 Test Loss: 1.202 Test Acc: 0.625
Validation loss decreased (-0.574987 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.7166857719421387
Epoch: 7, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.152 Vali Acc: 0.700 Test Loss: 1.152 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 0.749312162399292
Epoch: 8, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.104 Vali Acc: 0.750 Test Loss: 1.104 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 0.8254389762878418
Epoch: 9, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.056 Vali Acc: 0.750 Test Loss: 1.056 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 10 cost time: 0.6278893947601318
Epoch: 10, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.009 Vali Acc: 0.800 Test Loss: 1.009 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 11 cost time: 0.6038780212402344
Epoch: 11, Steps: 3 | Train Loss: 0.877 Vali Loss: 0.961 Vali Acc: 0.825 Test Loss: 0.961 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 12 cost time: 0.6750872135162354
Epoch: 12, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.917 Vali Acc: 0.850 Test Loss: 0.917 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.6375513076782227
Epoch: 13, Steps: 3 | Train Loss: 0.821 Vali Loss: 0.871 Vali Acc: 0.850 Test Loss: 0.871 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 14 cost time: 0.6994259357452393
Epoch: 14, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 15 cost time: 0.6802542209625244
Epoch: 15, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.795 Vali Acc: 0.875 Test Loss: 0.795 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.7090559005737305
Epoch: 16, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.754 Vali Acc: 0.900 Test Loss: 0.754 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.6156744956970215
Epoch: 17, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.722 Vali Acc: 0.925 Test Loss: 0.722 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 0.6623327732086182
Epoch: 18, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.690 Vali Acc: 0.900 Test Loss: 0.690 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6253256797790527
Epoch: 19, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.659 Vali Acc: 0.900 Test Loss: 0.659 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6330156326293945
Epoch: 20, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.626 Vali Acc: 0.925 Test Loss: 0.626 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.6650629043579102
Epoch: 21, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.604 Vali Acc: 0.975 Test Loss: 0.604 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974994).  Saving model ...
Epoch: 22 cost time: 0.6197755336761475
Epoch: 22, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.584 Vali Acc: 0.975 Test Loss: 0.584 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 23 cost time: 0.5184273719787598
Epoch: 23, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.561 Vali Acc: 0.975 Test Loss: 0.561 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 24 cost time: 0.576697587966919
Epoch: 24, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.542 Vali Acc: 0.975 Test Loss: 0.542 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 25 cost time: 0.6095266342163086
Epoch: 25, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.524 Vali Acc: 0.975 Test Loss: 0.524 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 0.6166000366210938
Epoch: 26, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.505 Vali Acc: 0.975 Test Loss: 0.505 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 0.6551799774169922
Epoch: 27, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.486 Vali Acc: 0.975 Test Loss: 0.486 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 28 cost time: 0.6007885932922363
Epoch: 28, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.464 Vali Acc: 0.975 Test Loss: 0.464 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 29 cost time: 0.5660722255706787
Epoch: 29, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.445 Vali Acc: 0.975 Test Loss: 0.445 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.5306930541992188
Epoch: 30, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.430 Vali Acc: 0.975 Test Loss: 0.430 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.6850290298461914
Epoch: 31, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.417 Vali Acc: 0.975 Test Loss: 0.417 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.6252543926239014
Epoch: 32, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.405 Vali Acc: 0.975 Test Loss: 0.405 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.6206676959991455
Epoch: 33, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.394 Vali Acc: 0.975 Test Loss: 0.394 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.6313574314117432
Epoch: 34, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.615231990814209
Epoch: 35, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.370 Vali Acc: 0.975 Test Loss: 0.370 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.7221460342407227
Epoch: 36, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.7111988067626953
Epoch: 37, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.6110589504241943
Epoch: 38, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.334 Vali Acc: 0.975 Test Loss: 0.334 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.6144773960113525
Epoch: 39, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.323 Vali Acc: 0.975 Test Loss: 0.323 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.659942626953125
Epoch: 40, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.6350886821746826
Epoch: 41, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7971384525299072
Epoch: 42, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7338764667510986
Epoch: 43, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.728630781173706
Epoch: 44, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.307 Vali Acc: 0.975 Test Loss: 0.307 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.7640590667724609
Epoch: 45, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.307 Vali Acc: 0.975 Test Loss: 0.307 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7327446937561035
Epoch: 46, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7976429462432861
Epoch: 47, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7742133140563965
Epoch: 48, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7745909690856934
Epoch: 49, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.7275090217590332
Epoch: 50, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 51 cost time: 0.8087553977966309
Epoch: 51, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 52 cost time: 0.795464277267456
Epoch: 52, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 53 cost time: 0.7957918643951416
Epoch: 53, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 54 cost time: 0.8359503746032715
Epoch: 54, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.280 Vali Acc: 0.975 Test Loss: 0.280 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 55 cost time: 0.8020689487457275
Epoch: 55, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 56 cost time: 0.7932033538818359
Epoch: 56, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7682297229766846
Epoch: 57, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.833585262298584
Epoch: 58, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7569589614868164
Epoch: 59, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8577060699462891
Epoch: 60, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7818324565887451
Epoch: 61, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.7966036796569824
Epoch: 62, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.7550680637359619
Epoch: 63, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.7579288482666016
Epoch: 64, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.7635383605957031
Epoch: 65, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 49004
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.809192419052124
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.421 Vali Acc: 0.400 Test Loss: 1.421 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5397970676422119
Epoch: 2, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.392 Vali Acc: 0.375 Test Loss: 1.392 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6391651630401611
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.363 Vali Acc: 0.375 Test Loss: 1.363 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6302697658538818
Epoch: 4, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.325 Vali Acc: 0.400 Test Loss: 1.325 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.5905332565307617
Epoch: 5, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.281 Vali Acc: 0.475 Test Loss: 1.281 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.6224110126495361
Epoch: 6, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.5876545906066895
Epoch: 7, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.189 Vali Acc: 0.550 Test Loss: 1.189 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.6075339317321777
Epoch: 8, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.7218689918518066
Epoch: 9, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.7398505210876465
Epoch: 10, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.7547318935394287
Epoch: 11, Steps: 3 | Train Loss: 0.832 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.6081829071044922
Epoch: 12, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 0.6268773078918457
Epoch: 13, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.921 Vali Acc: 0.725 Test Loss: 0.921 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.6736373901367188
Epoch: 14, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.7202572822570801
Epoch: 15, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.845 Vali Acc: 0.750 Test Loss: 0.845 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.68255615234375
Epoch: 16, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.6171863079071045
Epoch: 17, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.7298195362091064
Epoch: 18, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 19 cost time: 0.7512950897216797
Epoch: 19, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.723 Vali Acc: 0.875 Test Loss: 0.723 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.7358286380767822
Epoch: 20, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.696 Vali Acc: 0.875 Test Loss: 0.696 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.636336088180542
Epoch: 21, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.675 Vali Acc: 0.875 Test Loss: 0.675 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 0.6301651000976562
Epoch: 22, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 0.6225612163543701
Epoch: 23, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.633 Vali Acc: 0.900 Test Loss: 0.633 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.7061810493469238
Epoch: 24, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.615 Vali Acc: 0.900 Test Loss: 0.615 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.5854077339172363
Epoch: 25, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.6525650024414062
Epoch: 26, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.6446442604064941
Epoch: 27, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.6483776569366455
Epoch: 28, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.557 Vali Acc: 0.900 Test Loss: 0.557 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.6375181674957275
Epoch: 29, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.6645603179931641
Epoch: 30, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.7138431072235107
Epoch: 31, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6795291900634766
Epoch: 32, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6915721893310547
Epoch: 33, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7517070770263672
Epoch: 34, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 35 cost time: 0.6493232250213623
Epoch: 35, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 36 cost time: 0.6191997528076172
Epoch: 36, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 0.7064707279205322
Epoch: 37, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 0.7720024585723877
Epoch: 38, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.6898388862609863
Epoch: 39, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6676361560821533
Epoch: 40, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7253572940826416
Epoch: 41, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.680492639541626
Epoch: 42, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.591484785079956
Epoch: 43, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6753206253051758
Epoch: 44, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.584571361541748
Epoch: 45, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6186192035675049
Epoch: 46, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6286933422088623
Epoch: 47, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6356010437011719
Epoch: 48, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 49004
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.587712049484253
Epoch: 1, Steps: 3 | Train Loss: 1.562 Vali Loss: 1.358 Vali Acc: 0.325 Test Loss: 1.358 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6379990577697754
Epoch: 2, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.313 Vali Acc: 0.350 Test Loss: 1.313 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.6822283267974854
Epoch: 3, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.272 Vali Acc: 0.350 Test Loss: 1.272 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.7120208740234375
Epoch: 4, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.7772135734558105
Epoch: 5, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.172 Vali Acc: 0.525 Test Loss: 1.172 Test Acc: 0.525
Validation loss decreased (-0.399988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.7435026168823242
Epoch: 6, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.750636100769043
Epoch: 7, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.078 Vali Acc: 0.650 Test Loss: 1.078 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 0.7047860622406006
Epoch: 8, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.036 Vali Acc: 0.675 Test Loss: 1.036 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.7110929489135742
Epoch: 9, Steps: 3 | Train Loss: 0.966 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.7610199451446533
Epoch: 10, Steps: 3 | Train Loss: 0.940 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.7515063285827637
Epoch: 11, Steps: 3 | Train Loss: 0.861 Vali Loss: 0.924 Vali Acc: 0.725 Test Loss: 0.924 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.6491496562957764
Epoch: 12, Steps: 3 | Train Loss: 0.821 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.7410781383514404
Epoch: 13, Steps: 3 | Train Loss: 0.738 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.6820499897003174
Epoch: 14, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.807 Vali Acc: 0.800 Test Loss: 0.807 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.7043683528900146
Epoch: 15, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.6855514049530029
Epoch: 16, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.731 Vali Acc: 0.900 Test Loss: 0.731 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.7153549194335938
Epoch: 17, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.697 Vali Acc: 0.925 Test Loss: 0.697 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 0.7486472129821777
Epoch: 18, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.666 Vali Acc: 0.925 Test Loss: 0.666 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.7733774185180664
Epoch: 19, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.641 Vali Acc: 0.925 Test Loss: 0.641 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.6807396411895752
Epoch: 20, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.619 Vali Acc: 0.925 Test Loss: 0.619 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.6778473854064941
Epoch: 21, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.602 Vali Acc: 0.925 Test Loss: 0.602 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.7138309478759766
Epoch: 22, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.583 Vali Acc: 0.925 Test Loss: 0.583 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.6687536239624023
Epoch: 23, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.560 Vali Acc: 0.925 Test Loss: 0.560 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.6184728145599365
Epoch: 24, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.538 Vali Acc: 0.925 Test Loss: 0.538 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.6522126197814941
Epoch: 25, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.698836088180542
Epoch: 26, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.7074735164642334
Epoch: 27, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.484 Vali Acc: 0.925 Test Loss: 0.484 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.6782433986663818
Epoch: 28, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.7106287479400635
Epoch: 29, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.6059424877166748
Epoch: 30, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7014117240905762
Epoch: 31, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7385413646697998
Epoch: 32, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6771392822265625
Epoch: 33, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7377564907073975
Epoch: 34, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.771007776260376
Epoch: 35, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7212896347045898
Epoch: 36, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6646120548248291
Epoch: 37, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.7436058521270752
Epoch: 38, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.8375406265258789
Epoch: 39, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.8518407344818115
Epoch: 40, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.7142698764801025
Epoch: 41, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.7220234870910645
Epoch: 42, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.6710214614868164
Epoch: 43, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 0.713580846786499
Epoch: 44, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 0.7271661758422852
Epoch: 45, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6962847709655762
Epoch: 46, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.781874418258667
Epoch: 47, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7088112831115723
Epoch: 48, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6725444793701172
Epoch: 49, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7131328582763672
Epoch: 50, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7056999206542969
Epoch: 51, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.7338337898254395
Epoch: 52, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6779580116271973
Epoch: 53, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.7390069961547852
Epoch: 54, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 32620
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8419458866119385
Epoch: 1, Steps: 3 | Train Loss: 1.582 Vali Loss: 1.365 Vali Acc: 0.325 Test Loss: 1.365 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.7200572490692139
Epoch: 2, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.323 Vali Acc: 0.325 Test Loss: 1.323 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.7692029476165771
Epoch: 3, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.284 Vali Acc: 0.375 Test Loss: 1.284 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.8171417713165283
Epoch: 4, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.235 Vali Acc: 0.450 Test Loss: 1.235 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 0.8765420913696289
Epoch: 5, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.185 Vali Acc: 0.550 Test Loss: 1.185 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.7596962451934814
Epoch: 6, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.134 Vali Acc: 0.725 Test Loss: 1.134 Test Acc: 0.725
Validation loss decreased (-0.549988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.8530871868133545
Epoch: 7, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.086 Vali Acc: 0.725 Test Loss: 1.086 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 8 cost time: 0.6881718635559082
Epoch: 8, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.042 Vali Acc: 0.725 Test Loss: 1.042 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.8247842788696289
Epoch: 9, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 0.9326729774475098
Epoch: 10, Steps: 3 | Train Loss: 0.943 Vali Loss: 0.970 Vali Acc: 0.725 Test Loss: 0.970 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.7535943984985352
Epoch: 11, Steps: 3 | Train Loss: 0.857 Vali Loss: 0.931 Vali Acc: 0.725 Test Loss: 0.931 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.8677847385406494
Epoch: 12, Steps: 3 | Train Loss: 0.821 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.7519869804382324
Epoch: 13, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.8509244918823242
Epoch: 14, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.7724215984344482
Epoch: 15, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.773 Vali Acc: 0.875 Test Loss: 0.773 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.7734980583190918
Epoch: 16, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.738 Vali Acc: 0.900 Test Loss: 0.738 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.7434682846069336
Epoch: 17, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.703 Vali Acc: 0.900 Test Loss: 0.703 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.7856049537658691
Epoch: 18, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.670 Vali Acc: 0.900 Test Loss: 0.670 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.8387665748596191
Epoch: 19, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.7068102359771729
Epoch: 20, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.623 Vali Acc: 0.925 Test Loss: 0.623 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.8944721221923828
Epoch: 21, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.604 Vali Acc: 0.925 Test Loss: 0.604 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.8376553058624268
Epoch: 22, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.8338570594787598
Epoch: 23, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.566 Vali Acc: 0.925 Test Loss: 0.566 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.8156163692474365
Epoch: 24, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.545 Vali Acc: 0.925 Test Loss: 0.545 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.726555585861206
Epoch: 25, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.524 Vali Acc: 0.925 Test Loss: 0.524 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.817802906036377
Epoch: 26, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.502 Vali Acc: 0.925 Test Loss: 0.502 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.653451681137085
Epoch: 27, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.7917230129241943
Epoch: 28, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.466 Vali Acc: 0.925 Test Loss: 0.466 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.7549288272857666
Epoch: 29, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.7027709484100342
Epoch: 30, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 0.7284808158874512
Epoch: 31, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.7316443920135498
Epoch: 32, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 0.8735899925231934
Epoch: 33, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 0.8368496894836426
Epoch: 34, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.8511373996734619
Epoch: 35, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 0.7291932106018066
Epoch: 36, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.8249123096466064
Epoch: 37, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.8680071830749512
Epoch: 38, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.8285412788391113
Epoch: 39, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.7418262958526611
Epoch: 40, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.6813263893127441
Epoch: 41, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.8152210712432861
Epoch: 42, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.7322177886962891
Epoch: 43, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 0.7561659812927246
Epoch: 44, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 0.7710661888122559
Epoch: 45, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8348484039306641
Epoch: 46, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7913739681243896
Epoch: 47, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8508765697479248
Epoch: 48, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8031599521636963
Epoch: 49, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7487339973449707
Epoch: 50, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.8314323425292969
Epoch: 51, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.7257640361785889
Epoch: 52, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.8255531787872314
Epoch: 53, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.8591272830963135
Epoch: 54, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 32620
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.748884677886963
Epoch: 1, Steps: 3 | Train Loss: 1.551 Vali Loss: 1.381 Vali Acc: 0.300 Test Loss: 1.381 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.9066014289855957
Epoch: 2, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.345 Vali Acc: 0.300 Test Loss: 1.345 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.7318928241729736
Epoch: 3, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.309 Vali Acc: 0.425 Test Loss: 1.309 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.6997230052947998
Epoch: 4, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.267 Vali Acc: 0.450 Test Loss: 1.267 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.6658692359924316
Epoch: 5, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.7755703926086426
Epoch: 6, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.170 Vali Acc: 0.725 Test Loss: 1.170 Test Acc: 0.725
Validation loss decreased (-0.549988 --> -0.724988).  Saving model ...
Epoch: 7 cost time: 0.6808207035064697
Epoch: 7, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.124 Vali Acc: 0.750 Test Loss: 1.124 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749989).  Saving model ...
Epoch: 8 cost time: 0.6150860786437988
Epoch: 8, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.080 Vali Acc: 0.775 Test Loss: 1.080 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 9 cost time: 0.68448805809021
Epoch: 9, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.039 Vali Acc: 0.775 Test Loss: 1.039 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.6475763320922852
Epoch: 10, Steps: 3 | Train Loss: 0.960 Vali Loss: 0.999 Vali Acc: 0.825 Test Loss: 0.999 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.6920106410980225
Epoch: 11, Steps: 3 | Train Loss: 0.868 Vali Loss: 0.958 Vali Acc: 0.850 Test Loss: 0.958 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 12 cost time: 0.7447006702423096
Epoch: 12, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.920 Vali Acc: 0.850 Test Loss: 0.920 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.6513767242431641
Epoch: 13, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.879 Vali Acc: 0.850 Test Loss: 0.879 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 14 cost time: 0.7036099433898926
Epoch: 14, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.837 Vali Acc: 0.875 Test Loss: 0.837 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.7809500694274902
Epoch: 15, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.798 Vali Acc: 0.875 Test Loss: 0.798 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.7035293579101562
Epoch: 16, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.759 Vali Acc: 0.900 Test Loss: 0.759 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.695904016494751
Epoch: 17, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.723 Vali Acc: 0.875 Test Loss: 0.723 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6818015575408936
Epoch: 18, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.688 Vali Acc: 0.875 Test Loss: 0.688 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.733018159866333
Epoch: 19, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.659 Vali Acc: 0.925 Test Loss: 0.659 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.6721324920654297
Epoch: 20, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.636 Vali Acc: 0.925 Test Loss: 0.636 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.809086799621582
Epoch: 21, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.616 Vali Acc: 0.900 Test Loss: 0.616 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8329586982727051
Epoch: 22, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.599 Vali Acc: 0.900 Test Loss: 0.599 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8044295310974121
Epoch: 23, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6798253059387207
Epoch: 24, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9057760238647461
Epoch: 25, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.543 Vali Acc: 0.900 Test Loss: 0.543 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8372547626495361
Epoch: 26, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7943918704986572
Epoch: 27, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.500 Vali Acc: 0.925 Test Loss: 0.500 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.8292200565338135
Epoch: 28, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.8107314109802246
Epoch: 29, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.7820415496826172
Epoch: 30, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.8614468574523926
Epoch: 31, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.7749147415161133
Epoch: 32, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 0.810960054397583
Epoch: 33, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.421 Vali Acc: 0.950 Test Loss: 0.421 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.7872781753540039
Epoch: 34, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.413 Vali Acc: 0.975 Test Loss: 0.413 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.7341883182525635
Epoch: 35, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.406 Vali Acc: 0.975 Test Loss: 0.406 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.8162097930908203
Epoch: 36, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.393 Vali Acc: 0.975 Test Loss: 0.393 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.8172872066497803
Epoch: 37, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 38 cost time: 0.7481594085693359
Epoch: 38, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.870375394821167
Epoch: 39, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8900904655456543
Epoch: 40, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6869394779205322
Epoch: 41, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8609259128570557
Epoch: 42, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8620014190673828
Epoch: 43, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6581182479858398
Epoch: 44, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7547464370727539
Epoch: 45, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.777024507522583
Epoch: 46, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.740302562713623
Epoch: 47, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 32620
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6319215297698975
Epoch: 1, Steps: 3 | Train Loss: 1.558 Vali Loss: 1.359 Vali Acc: 0.300 Test Loss: 1.359 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5642478466033936
Epoch: 2, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.329 Vali Acc: 0.300 Test Loss: 1.329 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.6384341716766357
Epoch: 3, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.299 Vali Acc: 0.300 Test Loss: 1.299 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.5877275466918945
Epoch: 4, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.260 Vali Acc: 0.375 Test Loss: 1.260 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.49027299880981445
Epoch: 5, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.219 Vali Acc: 0.475 Test Loss: 1.219 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.6646971702575684
Epoch: 6, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.176 Vali Acc: 0.575 Test Loss: 1.176 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.7635965347290039
Epoch: 7, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.133 Vali Acc: 0.750 Test Loss: 1.133 Test Acc: 0.750
Validation loss decreased (-0.574988 --> -0.749989).  Saving model ...
Epoch: 8 cost time: 0.6004931926727295
Epoch: 8, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.090 Vali Acc: 0.750 Test Loss: 1.090 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 0.6348977088928223
Epoch: 9, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.049 Vali Acc: 0.800 Test Loss: 1.049 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.5394988059997559
Epoch: 10, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.009 Vali Acc: 0.825 Test Loss: 1.009 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.5860092639923096
Epoch: 11, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.969 Vali Acc: 0.800 Test Loss: 0.969 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6695966720581055
Epoch: 12, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.931 Vali Acc: 0.800 Test Loss: 0.931 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5687077045440674
Epoch: 13, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.892 Vali Acc: 0.875 Test Loss: 0.892 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.5591459274291992
Epoch: 14, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.853 Vali Acc: 0.875 Test Loss: 0.853 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 15 cost time: 0.7133171558380127
Epoch: 15, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.817 Vali Acc: 0.875 Test Loss: 0.817 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.5274608135223389
Epoch: 16, Steps: 3 | Train Loss: 0.648 Vali Loss: 0.784 Vali Acc: 0.875 Test Loss: 0.784 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.5626213550567627
Epoch: 17, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7391877174377441
Epoch: 18, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.724 Vali Acc: 0.850 Test Loss: 0.724 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6315402984619141
Epoch: 19, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.700 Vali Acc: 0.850 Test Loss: 0.700 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5429592132568359
Epoch: 20, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6283912658691406
Epoch: 21, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.6316275596618652
Epoch: 22, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.639 Vali Acc: 0.900 Test Loss: 0.639 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.6526305675506592
Epoch: 23, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.620 Vali Acc: 0.925 Test Loss: 0.620 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.6141822338104248
Epoch: 24, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6371374130249023
Epoch: 25, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.580 Vali Acc: 0.900 Test Loss: 0.580 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6184847354888916
Epoch: 26, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.560 Vali Acc: 0.900 Test Loss: 0.560 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7148725986480713
Epoch: 27, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6802835464477539
Epoch: 28, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7527518272399902
Epoch: 29, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.514 Vali Acc: 0.875 Test Loss: 0.514 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6458384990692139
Epoch: 30, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6090633869171143
Epoch: 31, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6537990570068359
Epoch: 32, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5913681983947754
Epoch: 33, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.8553674221038818
Epoch: 34, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 35 cost time: 0.6412889957427979
Epoch: 35, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.447 Vali Acc: 0.950 Test Loss: 0.447 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.673708438873291
Epoch: 36, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.6604504585266113
Epoch: 37, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.7370178699493408
Epoch: 38, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7891924381256104
Epoch: 39, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7769713401794434
Epoch: 40, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7148103713989258
Epoch: 41, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.58968186378479
Epoch: 42, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8949782848358154
Epoch: 43, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7285377979278564
Epoch: 44, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7380969524383545
Epoch: 45, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6579887866973877
Epoch: 46, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6722919940948486
Epoch: 47, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 32620
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5964009761810303
Epoch: 1, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.426 Vali Acc: 0.200 Test Loss: 1.426 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.6827301979064941
Epoch: 2, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.396 Vali Acc: 0.200 Test Loss: 1.396 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.6750204563140869
Epoch: 3, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.364 Vali Acc: 0.250 Test Loss: 1.364 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.6926791667938232
Epoch: 4, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.323 Vali Acc: 0.275 Test Loss: 1.323 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 0.6368193626403809
Epoch: 5, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.282 Vali Acc: 0.350 Test Loss: 1.282 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.7702255249023438
Epoch: 6, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.7629601955413818
Epoch: 7, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.187 Vali Acc: 0.475 Test Loss: 1.187 Test Acc: 0.475
Validation loss decreased (-0.399988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.7286474704742432
Epoch: 8, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.137 Vali Acc: 0.525 Test Loss: 1.137 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 9 cost time: 0.6983804702758789
Epoch: 9, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.5753891468048096
Epoch: 10, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.035 Vali Acc: 0.625 Test Loss: 1.035 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.7960836887359619
Epoch: 11, Steps: 3 | Train Loss: 0.871 Vali Loss: 0.991 Vali Acc: 0.675 Test Loss: 0.991 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.6671264171600342
Epoch: 12, Steps: 3 | Train Loss: 0.828 Vali Loss: 0.947 Vali Acc: 0.775 Test Loss: 0.947 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 0.7548093795776367
Epoch: 13, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.909 Vali Acc: 0.875 Test Loss: 0.909 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.7539758682250977
Epoch: 14, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.870 Vali Acc: 0.875 Test Loss: 0.870 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 15 cost time: 0.6190757751464844
Epoch: 15, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.832 Vali Acc: 0.900 Test Loss: 0.832 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.7957923412322998
Epoch: 16, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.799 Vali Acc: 0.875 Test Loss: 0.799 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7634468078613281
Epoch: 17, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.766 Vali Acc: 0.900 Test Loss: 0.766 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 18 cost time: 0.7341084480285645
Epoch: 18, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.735 Vali Acc: 0.900 Test Loss: 0.735 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.738623857498169
Epoch: 19, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.708 Vali Acc: 0.900 Test Loss: 0.708 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.7441303730010986
Epoch: 20, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.9516973495483398
Epoch: 21, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.656 Vali Acc: 0.900 Test Loss: 0.656 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.7058403491973877
Epoch: 22, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.640 Vali Acc: 0.900 Test Loss: 0.640 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.6890513896942139
Epoch: 23, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.626 Vali Acc: 0.900 Test Loss: 0.626 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.7596418857574463
Epoch: 24, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.7846009731292725
Epoch: 25, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.600 Vali Acc: 0.900 Test Loss: 0.600 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.8652915954589844
Epoch: 26, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.6997768878936768
Epoch: 27, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.562 Vali Acc: 0.900 Test Loss: 0.562 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.6749529838562012
Epoch: 28, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.833437442779541
Epoch: 29, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.8144912719726562
Epoch: 30, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.515 Vali Acc: 0.925 Test Loss: 0.515 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.8369715213775635
Epoch: 31, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.506 Vali Acc: 0.925 Test Loss: 0.506 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 0.7446386814117432
Epoch: 32, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 0.8485612869262695
Epoch: 33, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.7293763160705566
Epoch: 34, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.8108012676239014
Epoch: 35, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.7379100322723389
Epoch: 36, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.9138147830963135
Epoch: 37, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 38 cost time: 0.9140253067016602
Epoch: 38, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.466 Vali Acc: 0.925 Test Loss: 0.466 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 39 cost time: 0.82564377784729
Epoch: 39, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.462 Vali Acc: 0.925 Test Loss: 0.462 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 40 cost time: 0.8536708354949951
Epoch: 40, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 41 cost time: 0.746248722076416
Epoch: 41, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.8615279197692871
Epoch: 42, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7614281177520752
Epoch: 43, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7472710609436035
Epoch: 44, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8287482261657715
Epoch: 45, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.739506721496582
Epoch: 46, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9051847457885742
Epoch: 47, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8601808547973633
Epoch: 48, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6527009010314941
Epoch: 49, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7422733306884766
Epoch: 50, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.7018451690673828
Epoch: 51, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 24428
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1288492679595947
Epoch: 1, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.409 Vali Acc: 0.250 Test Loss: 1.409 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.7659974098205566
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.379 Vali Acc: 0.250 Test Loss: 1.379 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.69338059425354
Epoch: 3, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.348 Vali Acc: 0.275 Test Loss: 1.348 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.7910149097442627
Epoch: 4, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.308 Vali Acc: 0.325 Test Loss: 1.308 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.9464175701141357
Epoch: 5, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.266 Vali Acc: 0.375 Test Loss: 1.266 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.7185862064361572
Epoch: 6, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7426981925964355
Epoch: 7, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.173 Vali Acc: 0.575 Test Loss: 1.173 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.7323920726776123
Epoch: 8, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.7517471313476562
Epoch: 9, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.077 Vali Acc: 0.675 Test Loss: 1.077 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.7883286476135254
Epoch: 10, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.029 Vali Acc: 0.725 Test Loss: 1.029 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.737393856048584
Epoch: 11, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.986 Vali Acc: 0.825 Test Loss: 0.986 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824990).  Saving model ...
Epoch: 12 cost time: 0.7369122505187988
Epoch: 12, Steps: 3 | Train Loss: 0.843 Vali Loss: 0.940 Vali Acc: 0.875 Test Loss: 0.940 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.7867121696472168
Epoch: 13, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.899 Vali Acc: 0.925 Test Loss: 0.899 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924991).  Saving model ...
Epoch: 14 cost time: 0.6638259887695312
Epoch: 14, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.858 Vali Acc: 0.950 Test Loss: 0.858 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949991).  Saving model ...
Epoch: 15 cost time: 0.7956125736236572
Epoch: 15, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.822 Vali Acc: 0.950 Test Loss: 0.822 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949992).  Saving model ...
Epoch: 16 cost time: 0.7693119049072266
Epoch: 16, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.786 Vali Acc: 0.950 Test Loss: 0.786 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 17 cost time: 0.7181837558746338
Epoch: 17, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.751 Vali Acc: 0.950 Test Loss: 0.751 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 18 cost time: 0.7887682914733887
Epoch: 18, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.716 Vali Acc: 0.925 Test Loss: 0.716 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7195172309875488
Epoch: 19, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.684 Vali Acc: 0.925 Test Loss: 0.684 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7434055805206299
Epoch: 20, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.654 Vali Acc: 0.925 Test Loss: 0.654 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7916169166564941
Epoch: 21, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.625 Vali Acc: 0.925 Test Loss: 0.625 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7327337265014648
Epoch: 22, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.606 Vali Acc: 0.925 Test Loss: 0.606 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7410609722137451
Epoch: 23, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.591 Vali Acc: 0.925 Test Loss: 0.591 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6845200061798096
Epoch: 24, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.581 Vali Acc: 0.925 Test Loss: 0.581 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7367513179779053
Epoch: 25, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.570 Vali Acc: 0.925 Test Loss: 0.570 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8102447986602783
Epoch: 26, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.556 Vali Acc: 0.925 Test Loss: 0.556 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8221795558929443
Epoch: 27, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.539 Vali Acc: 0.925 Test Loss: 0.539 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 24428
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8226609230041504
Epoch: 1, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.387 Vali Acc: 0.225 Test Loss: 1.387 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.754035472869873
Epoch: 2, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.359 Vali Acc: 0.250 Test Loss: 1.359 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.6749012470245361
Epoch: 3, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.331 Vali Acc: 0.300 Test Loss: 1.331 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.6145720481872559
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.294 Vali Acc: 0.300 Test Loss: 1.294 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.7410745620727539
Epoch: 5, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.254 Vali Acc: 0.425 Test Loss: 1.254 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.7829256057739258
Epoch: 6, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.8781859874725342
Epoch: 7, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.164 Vali Acc: 0.550 Test Loss: 1.164 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.8076238632202148
Epoch: 8, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.7999858856201172
Epoch: 9, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.071 Vali Acc: 0.725 Test Loss: 1.071 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 0.7905895709991455
Epoch: 10, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.024 Vali Acc: 0.825 Test Loss: 1.024 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.7299256324768066
Epoch: 11, Steps: 3 | Train Loss: 0.928 Vali Loss: 0.980 Vali Acc: 0.900 Test Loss: 0.980 Test Acc: 0.900
Validation loss decreased (-0.824990 --> -0.899990).  Saving model ...
Epoch: 12 cost time: 0.6779971122741699
Epoch: 12, Steps: 3 | Train Loss: 0.852 Vali Loss: 0.936 Vali Acc: 0.925 Test Loss: 0.936 Test Acc: 0.925
Validation loss decreased (-0.899990 --> -0.924991).  Saving model ...
Epoch: 13 cost time: 0.9019701480865479
Epoch: 13, Steps: 3 | Train Loss: 0.826 Vali Loss: 0.895 Vali Acc: 0.925 Test Loss: 0.895 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924991).  Saving model ...
Epoch: 14 cost time: 0.7375073432922363
Epoch: 14, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.857 Vali Acc: 0.925 Test Loss: 0.857 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924991).  Saving model ...
Epoch: 15 cost time: 0.6925077438354492
Epoch: 15, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.823 Vali Acc: 0.925 Test Loss: 0.823 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 16 cost time: 0.6207771301269531
Epoch: 16, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.789 Vali Acc: 0.950 Test Loss: 0.789 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949992).  Saving model ...
Epoch: 17 cost time: 0.7068746089935303
Epoch: 17, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.755 Vali Acc: 0.925 Test Loss: 0.755 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8254427909851074
Epoch: 18, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.716 Vali Acc: 0.925 Test Loss: 0.716 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6731181144714355
Epoch: 19, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.683 Vali Acc: 0.925 Test Loss: 0.683 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7318360805511475
Epoch: 20, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.650 Vali Acc: 0.925 Test Loss: 0.650 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.686549186706543
Epoch: 21, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.622 Vali Acc: 0.925 Test Loss: 0.622 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7416253089904785
Epoch: 22, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.598 Vali Acc: 0.950 Test Loss: 0.598 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.7452597618103027
Epoch: 23, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.580 Vali Acc: 0.950 Test Loss: 0.580 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 0.7052838802337646
Epoch: 24, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.566 Vali Acc: 0.950 Test Loss: 0.566 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 25 cost time: 0.7199840545654297
Epoch: 25, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.551 Vali Acc: 0.950 Test Loss: 0.551 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 0.7815792560577393
Epoch: 26, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.535 Vali Acc: 0.950 Test Loss: 0.535 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.768683910369873
Epoch: 27, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.517 Vali Acc: 0.950 Test Loss: 0.517 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.7369632720947266
Epoch: 28, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.7331547737121582
Epoch: 29, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.486 Vali Acc: 0.950 Test Loss: 0.486 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.7629311084747314
Epoch: 30, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.7460627555847168
Epoch: 31, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.8392763137817383
Epoch: 32, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.446 Vali Acc: 0.950 Test Loss: 0.446 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.7924048900604248
Epoch: 33, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.7781369686126709
Epoch: 34, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.416 Vali Acc: 0.950 Test Loss: 0.416 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.8333101272583008
Epoch: 35, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.406 Vali Acc: 0.950 Test Loss: 0.406 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.8278176784515381
Epoch: 36, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.7803404331207275
Epoch: 37, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.7816152572631836
Epoch: 38, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.8325157165527344
Epoch: 39, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.720740795135498
Epoch: 40, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.8181324005126953
Epoch: 41, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.7804560661315918
Epoch: 42, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.6735231876373291
Epoch: 43, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.740412712097168
Epoch: 44, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.6474409103393555
Epoch: 45, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.8219387531280518
Epoch: 46, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9428050518035889
Epoch: 47, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7370707988739014
Epoch: 48, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8234076499938965
Epoch: 49, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7478599548339844
Epoch: 50, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8878123760223389
Epoch: 51, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.7834513187408447
Epoch: 52, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 0.8345112800598145
Epoch: 53, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7822034358978271
Epoch: 54, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8249154090881348
Epoch: 55, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 0.9585134983062744
Epoch: 56, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 0.7966554164886475
Epoch: 57, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.707897424697876
Epoch: 58, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7597999572753906
Epoch: 59, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8893814086914062
Epoch: 60, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8058836460113525
Epoch: 61, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9223482608795166
Epoch: 62, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.8885171413421631
Epoch: 63, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.8660500049591064
Epoch: 64, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.871222734451294
Epoch: 65, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.8442955017089844
Epoch: 66, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 24428
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.88942551612854
Epoch: 1, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.470 Vali Acc: 0.125 Test Loss: 1.470 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 0.8134310245513916
Epoch: 2, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.443 Vali Acc: 0.150 Test Loss: 1.443 Test Acc: 0.150
Validation loss decreased (-0.124985 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.7575700283050537
Epoch: 3, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.415 Vali Acc: 0.200 Test Loss: 1.415 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.925039529800415
Epoch: 4, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.378 Vali Acc: 0.300 Test Loss: 1.378 Test Acc: 0.300
Validation loss decreased (-0.199986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.9264531135559082
Epoch: 5, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.338 Vali Acc: 0.350 Test Loss: 1.338 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.8276855945587158
Epoch: 6, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.292 Vali Acc: 0.350 Test Loss: 1.292 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.9362425804138184
Epoch: 7, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.246 Vali Acc: 0.425 Test Loss: 1.246 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 0.9007899761199951
Epoch: 8, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.198 Vali Acc: 0.475 Test Loss: 1.198 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.7557370662689209
Epoch: 9, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.149 Vali Acc: 0.475 Test Loss: 1.149 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 10 cost time: 0.8288359642028809
Epoch: 10, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.101 Vali Acc: 0.550 Test Loss: 1.101 Test Acc: 0.550
Validation loss decreased (-0.474989 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.7322399616241455
Epoch: 11, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.056 Vali Acc: 0.775 Test Loss: 1.056 Test Acc: 0.775
Validation loss decreased (-0.549989 --> -0.774989).  Saving model ...
Epoch: 12 cost time: 0.7881507873535156
Epoch: 12, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.011 Vali Acc: 0.800 Test Loss: 1.011 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799990).  Saving model ...
Epoch: 13 cost time: 0.9737288951873779
Epoch: 13, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.966 Vali Acc: 0.875 Test Loss: 0.966 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874990).  Saving model ...
Epoch: 14 cost time: 0.8412086963653564
Epoch: 14, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.922 Vali Acc: 0.850 Test Loss: 0.922 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7718877792358398
Epoch: 15, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.885 Vali Acc: 0.850 Test Loss: 0.885 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8182277679443359
Epoch: 16, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.848 Vali Acc: 0.850 Test Loss: 0.848 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8881032466888428
Epoch: 17, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.811 Vali Acc: 0.875 Test Loss: 0.811 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.8335654735565186
Epoch: 18, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.777 Vali Acc: 0.875 Test Loss: 0.777 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 0.7566430568695068
Epoch: 19, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8066830635070801
Epoch: 20, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.717 Vali Acc: 0.825 Test Loss: 0.717 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8209736347198486
Epoch: 21, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9581999778747559
Epoch: 22, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.667 Vali Acc: 0.875 Test Loss: 0.667 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 0.767646074295044
Epoch: 23, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.646 Vali Acc: 0.875 Test Loss: 0.646 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.7802226543426514
Epoch: 24, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.7669754028320312
Epoch: 25, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.609 Vali Acc: 0.875 Test Loss: 0.609 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 26 cost time: 0.858100414276123
Epoch: 26, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.592 Vali Acc: 0.875 Test Loss: 0.592 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 0.8963453769683838
Epoch: 27, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.8277757167816162
Epoch: 28, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.7718462944030762
Epoch: 29, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.545 Vali Acc: 0.925 Test Loss: 0.545 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.7071406841278076
Epoch: 30, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.530 Vali Acc: 0.900 Test Loss: 0.530 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7707412242889404
Epoch: 31, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7361776828765869
Epoch: 32, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7166228294372559
Epoch: 33, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.490 Vali Acc: 0.875 Test Loss: 0.490 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7597675323486328
Epoch: 34, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8854575157165527
Epoch: 35, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0336098670959473
Epoch: 36, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8675549030303955
Epoch: 37, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9605138301849365
Epoch: 38, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.8118162155151367
Epoch: 39, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.9324343204498291
Epoch: 40, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.831608772277832
Epoch: 41, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.743319034576416
Epoch: 42, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.7617719173431396
Epoch: 43, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8242690563201904
Epoch: 44, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7866091728210449
Epoch: 45, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7834994792938232
Epoch: 46, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7017290592193604
Epoch: 47, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8090670108795166
Epoch: 48, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7574520111083984
Epoch: 49, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8140287399291992
Epoch: 50, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 0.7280302047729492
Epoch: 51, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 0.7472522258758545
Epoch: 52, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 0.8069274425506592
Epoch: 53, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7111325263977051
Epoch: 54, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9642438888549805
Epoch: 55, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9052715301513672
Epoch: 56, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8601768016815186
Epoch: 57, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.8168787956237793
Epoch: 58, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.7809152603149414
Epoch: 59, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.8117678165435791
Epoch: 60, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.7197730541229248
Epoch: 61, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.7845063209533691
Epoch: 62, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 24428
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.114743232727051
Epoch: 1, Steps: 3 | Train Loss: 1.513 Vali Loss: 1.342 Vali Acc: 0.275 Test Loss: 1.342 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.7390732765197754
Epoch: 2, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.312 Vali Acc: 0.350 Test Loss: 1.312 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5888011455535889
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.279 Vali Acc: 0.425 Test Loss: 1.279 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.6701498031616211
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.238 Vali Acc: 0.450 Test Loss: 1.238 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 0.7860751152038574
Epoch: 5, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.193 Vali Acc: 0.475 Test Loss: 1.193 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.7766733169555664
Epoch: 6, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.149 Vali Acc: 0.550 Test Loss: 1.149 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.6938114166259766
Epoch: 7, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.101 Vali Acc: 0.625 Test Loss: 1.101 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.7110519409179688
Epoch: 8, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.057 Vali Acc: 0.725 Test Loss: 1.057 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 0.7084498405456543
Epoch: 9, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7186646461486816
Epoch: 10, Steps: 3 | Train Loss: 0.958 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7663319110870361
Epoch: 11, Steps: 3 | Train Loss: 0.866 Vali Loss: 0.933 Vali Acc: 0.725 Test Loss: 0.933 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.6819863319396973
Epoch: 12, Steps: 3 | Train Loss: 0.841 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.755030632019043
Epoch: 13, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.7473704814910889
Epoch: 14, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7430450916290283
Epoch: 15, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.787 Vali Acc: 0.850 Test Loss: 0.787 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 0.6664681434631348
Epoch: 16, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.749 Vali Acc: 0.875 Test Loss: 0.749 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.7130680084228516
Epoch: 17, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.717 Vali Acc: 0.875 Test Loss: 0.717 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.853705644607544
Epoch: 18, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.687 Vali Acc: 0.900 Test Loss: 0.687 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.6457607746124268
Epoch: 19, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.8135290145874023
Epoch: 20, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.624 Vali Acc: 0.900 Test Loss: 0.624 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 0.7223250865936279
Epoch: 21, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.604 Vali Acc: 0.900 Test Loss: 0.604 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.6920485496520996
Epoch: 22, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6244444847106934
Epoch: 23, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7339920997619629
Epoch: 24, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7915458679199219
Epoch: 25, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8187711238861084
Epoch: 26, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.6896934509277344
Epoch: 27, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.6982529163360596
Epoch: 28, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.7083332538604736
Epoch: 29, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8084731101989746
Epoch: 30, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.436 Vali Acc: 0.950 Test Loss: 0.436 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.6053202152252197
Epoch: 31, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.7733418941497803
Epoch: 32, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7250282764434814
Epoch: 33, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7511558532714844
Epoch: 34, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8082625865936279
Epoch: 35, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7451827526092529
Epoch: 36, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8057742118835449
Epoch: 37, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7449052333831787
Epoch: 38, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8164167404174805
Epoch: 39, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6327791213989258
Epoch: 40, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6756958961486816
Epoch: 41, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 20332
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8629443645477295
Epoch: 1, Steps: 3 | Train Loss: 1.522 Vali Loss: 1.340 Vali Acc: 0.350 Test Loss: 1.340 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.6950163841247559
Epoch: 2, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.311 Vali Acc: 0.375 Test Loss: 1.311 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.7475473880767822
Epoch: 3, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.279 Vali Acc: 0.425 Test Loss: 1.279 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.7679131031036377
Epoch: 4, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.239 Vali Acc: 0.550 Test Loss: 1.239 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.7910664081573486
Epoch: 5, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.7944624423980713
Epoch: 6, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.152 Vali Acc: 0.650 Test Loss: 1.152 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 0.7786104679107666
Epoch: 7, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.7762689590454102
Epoch: 8, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.062 Vali Acc: 0.725 Test Loss: 1.062 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 0.7308452129364014
Epoch: 9, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.020 Vali Acc: 0.700 Test Loss: 1.020 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7561650276184082
Epoch: 10, Steps: 3 | Train Loss: 0.977 Vali Loss: 0.978 Vali Acc: 0.725 Test Loss: 0.978 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.7176957130432129
Epoch: 11, Steps: 3 | Train Loss: 0.886 Vali Loss: 0.937 Vali Acc: 0.800 Test Loss: 0.937 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799991).  Saving model ...
Epoch: 12 cost time: 0.8044774532318115
Epoch: 12, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.896 Vali Acc: 0.850 Test Loss: 0.896 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.8542630672454834
Epoch: 13, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.858 Vali Acc: 0.875 Test Loss: 0.858 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.6738207340240479
Epoch: 14, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.826 Vali Acc: 0.875 Test Loss: 0.826 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.784996509552002
Epoch: 15, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.794 Vali Acc: 0.875 Test Loss: 0.794 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.7090611457824707
Epoch: 16, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.757 Vali Acc: 0.900 Test Loss: 0.757 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.8115115165710449
Epoch: 17, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.722 Vali Acc: 0.925 Test Loss: 0.722 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 0.788360595703125
Epoch: 18, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.694 Vali Acc: 0.950 Test Loss: 0.694 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 19 cost time: 0.9584567546844482
Epoch: 19, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.661 Vali Acc: 0.950 Test Loss: 0.661 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 20 cost time: 0.7423923015594482
Epoch: 20, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.632 Vali Acc: 0.925 Test Loss: 0.632 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8566653728485107
Epoch: 21, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.611 Vali Acc: 0.925 Test Loss: 0.611 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8111495971679688
Epoch: 22, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.592 Vali Acc: 0.925 Test Loss: 0.592 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7594032287597656
Epoch: 23, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.570 Vali Acc: 0.925 Test Loss: 0.570 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9417598247528076
Epoch: 24, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.544 Vali Acc: 0.925 Test Loss: 0.544 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9153413772583008
Epoch: 25, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.514 Vali Acc: 0.925 Test Loss: 0.514 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8467826843261719
Epoch: 26, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9034309387207031
Epoch: 27, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8366086483001709
Epoch: 28, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8479411602020264
Epoch: 29, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 20332
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.5809874534606934
Epoch: 1, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.362 Vali Acc: 0.275 Test Loss: 1.362 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.9423234462738037
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.335 Vali Acc: 0.325 Test Loss: 1.335 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.7493114471435547
Epoch: 3, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.306 Vali Acc: 0.450 Test Loss: 1.306 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.6741161346435547
Epoch: 4, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.268 Vali Acc: 0.525 Test Loss: 1.268 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.8679769039154053
Epoch: 5, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.6556248664855957
Epoch: 6, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.184 Vali Acc: 0.600 Test Loss: 1.184 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.6528339385986328
Epoch: 7, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.140 Vali Acc: 0.650 Test Loss: 1.140 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 0.9141421318054199
Epoch: 8, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 0.7039852142333984
Epoch: 9, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.054 Vali Acc: 0.725 Test Loss: 1.054 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 0.7245948314666748
Epoch: 10, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.011 Vali Acc: 0.750 Test Loss: 1.011 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 11 cost time: 0.7718241214752197
Epoch: 11, Steps: 3 | Train Loss: 0.883 Vali Loss: 0.968 Vali Acc: 0.800 Test Loss: 0.968 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 12 cost time: 0.7527782917022705
Epoch: 12, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.928 Vali Acc: 0.800 Test Loss: 0.928 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.7625946998596191
Epoch: 13, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.889 Vali Acc: 0.800 Test Loss: 0.889 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.8774189949035645
Epoch: 14, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.857 Vali Acc: 0.825 Test Loss: 0.857 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.7758665084838867
Epoch: 15, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.822 Vali Acc: 0.850 Test Loss: 0.822 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 0.7424163818359375
Epoch: 16, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.786 Vali Acc: 0.875 Test Loss: 0.786 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.7691023349761963
Epoch: 17, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.749 Vali Acc: 0.925 Test Loss: 0.749 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 0.8034579753875732
Epoch: 18, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.716 Vali Acc: 0.925 Test Loss: 0.716 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.8265037536621094
Epoch: 19, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.685 Vali Acc: 0.925 Test Loss: 0.685 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.6906745433807373
Epoch: 20, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.654 Vali Acc: 0.925 Test Loss: 0.654 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 21 cost time: 0.7426526546478271
Epoch: 21, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.630 Vali Acc: 0.925 Test Loss: 0.630 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.7336933612823486
Epoch: 22, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.607 Vali Acc: 0.925 Test Loss: 0.607 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.8395047187805176
Epoch: 23, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8465988636016846
Epoch: 24, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.557 Vali Acc: 0.900 Test Loss: 0.557 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6336748600006104
Epoch: 25, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.527 Vali Acc: 0.925 Test Loss: 0.527 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.802379846572876
Epoch: 26, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.508 Vali Acc: 0.950 Test Loss: 0.508 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.756382942199707
Epoch: 27, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.491 Vali Acc: 0.950 Test Loss: 0.491 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.7698616981506348
Epoch: 28, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.479 Vali Acc: 0.950 Test Loss: 0.479 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.8400452136993408
Epoch: 29, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.463 Vali Acc: 0.950 Test Loss: 0.463 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.780921459197998
Epoch: 30, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.7368555068969727
Epoch: 31, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.437 Vali Acc: 0.950 Test Loss: 0.437 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.7335917949676514
Epoch: 32, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.7824594974517822
Epoch: 33, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.879753589630127
Epoch: 34, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.7758054733276367
Epoch: 35, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.823042631149292
Epoch: 36, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.950568675994873
Epoch: 37, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.8141083717346191
Epoch: 38, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.9109985828399658
Epoch: 39, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.8305654525756836
Epoch: 40, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.7896487712860107
Epoch: 41, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.873375415802002
Epoch: 42, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.8508145809173584
Epoch: 43, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.8840939998626709
Epoch: 44, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.8583400249481201
Epoch: 45, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.9987096786499023
Epoch: 46, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.7100551128387451
Epoch: 47, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.7848997116088867
Epoch: 48, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.8935942649841309
Epoch: 49, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 0.8682582378387451
Epoch: 50, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 0.820634126663208
Epoch: 51, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 0.759279727935791
Epoch: 52, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 0.8218994140625
Epoch: 53, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 0.8463513851165771
Epoch: 54, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 0.7800700664520264
Epoch: 55, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 0.7740085124969482
Epoch: 56, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 0.7753651142120361
Epoch: 57, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 58 cost time: 0.9039556980133057
Epoch: 58, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 59 cost time: 0.7363543510437012
Epoch: 59, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 60 cost time: 0.7578747272491455
Epoch: 60, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 61 cost time: 0.7926292419433594
Epoch: 61, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7769303321838379
Epoch: 62, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8867816925048828
Epoch: 63, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8906340599060059
Epoch: 64, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 65 cost time: 0.8509092330932617
Epoch: 65, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 66 cost time: 0.8113465309143066
Epoch: 66, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 67 cost time: 0.7776961326599121
Epoch: 67, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 68 cost time: 0.8124384880065918
Epoch: 68, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8361318111419678
Epoch: 69, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8259131908416748
Epoch: 70, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7447733879089355
Epoch: 71, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.8388750553131104
Epoch: 72, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.7956604957580566
Epoch: 73, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.7411942481994629
Epoch: 74, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.7658145427703857
Epoch: 75, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.7762160301208496
Epoch: 76, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.7527725696563721
Epoch: 77, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 20332
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4855587482452393
Epoch: 1, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.329 Vali Acc: 0.225 Test Loss: 1.329 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.7679057121276855
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.306 Vali Acc: 0.275 Test Loss: 1.306 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.7573590278625488
Epoch: 3, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.282 Vali Acc: 0.350 Test Loss: 1.282 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.756805419921875
Epoch: 4, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.249 Vali Acc: 0.425 Test Loss: 1.249 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424988).  Saving model ...
Epoch: 5 cost time: 0.8288159370422363
Epoch: 5, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.714343786239624
Epoch: 6, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.171 Vali Acc: 0.600 Test Loss: 1.171 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.7461264133453369
Epoch: 7, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.129 Vali Acc: 0.675 Test Loss: 1.129 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.6821548938751221
Epoch: 8, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.087 Vali Acc: 0.725 Test Loss: 1.087 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 0.769167423248291
Epoch: 9, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.044 Vali Acc: 0.800 Test Loss: 1.044 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.7366423606872559
Epoch: 10, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.000 Vali Acc: 0.825 Test Loss: 1.000 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.8237082958221436
Epoch: 11, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.959 Vali Acc: 0.850 Test Loss: 0.959 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 12 cost time: 0.683276891708374
Epoch: 12, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.918 Vali Acc: 0.850 Test Loss: 0.918 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.8292801380157471
Epoch: 13, Steps: 3 | Train Loss: 0.738 Vali Loss: 0.881 Vali Acc: 0.925 Test Loss: 0.881 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924991).  Saving model ...
Epoch: 14 cost time: 0.799645185470581
Epoch: 14, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.849 Vali Acc: 0.950 Test Loss: 0.849 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949992).  Saving model ...
Epoch: 15 cost time: 0.8995342254638672
Epoch: 15, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.818 Vali Acc: 0.950 Test Loss: 0.818 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 16 cost time: 0.8719809055328369
Epoch: 16, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.787 Vali Acc: 0.950 Test Loss: 0.787 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 17 cost time: 0.7919340133666992
Epoch: 17, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.757 Vali Acc: 0.925 Test Loss: 0.757 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7374022006988525
Epoch: 18, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.729 Vali Acc: 0.900 Test Loss: 0.729 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7521440982818604
Epoch: 19, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.702 Vali Acc: 0.875 Test Loss: 0.702 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9892368316650391
Epoch: 20, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.676 Vali Acc: 0.875 Test Loss: 0.676 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7196688652038574
Epoch: 21, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7902228832244873
Epoch: 22, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.635 Vali Acc: 0.875 Test Loss: 0.635 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7502470016479492
Epoch: 23, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.609 Vali Acc: 0.875 Test Loss: 0.609 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7396636009216309
Epoch: 24, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.737278938293457
Epoch: 25, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7178266048431396
Epoch: 26, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ETSformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 20332
model size : 0.70MB
